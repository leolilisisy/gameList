window.__require=function e(t,i,s){function n(a,r){if(!i[a]){if(!t[a]){var c=a.split("/");if(c=c[c.length-1],!t[c]){var l="function"==typeof __require&&__require;if(!r&&l)return l(c,!0);if(o)return o(c,!0);throw new Error("Cannot find module '"+a+"'")}a=c}var h=i[a]={exports:{}};t[a][0].call(h.exports,function(e){return n(t[a][1][e]||e)},h,h.exports,e,t,i,s)}return i[a].exports}for(var o="function"==typeof __require&&__require,a=0;a<s.length;a++)n(s[a]);return n}({ActivityController:[function(e,t,i){"use strict";cc._RF.push(t,"06242nUKDtKI7wg2iwifSS2","ActivityController"),Object.defineProperty(i,"__esModule",{value:!0}),i.ActivityController=void 0;const s=e("../../ListenID"),n=e("../../frame/MVC"),o=e("../../frame/Notifier"),a=e("./ActivityModel"),r=e("../../CallID"),c=e("../../frame/UIManager"),l=e("../../frame/NotifyID");i.ActivityController=class extends n.MVC.BaseController{constructor(){super("ActivityController"),this._model=a.default.getInstance,this.changeListener(!0)}reset(){}changeListener(e){o.Notifier.changeListener(e,s.ListenID.Activity_OpenSignView,this.onOpenSignView,this),o.Notifier.changeListener(e,s.ListenID.Activity_CloseSignView,this.onCloseSignView,this),o.Notifier.changeListener(e,s.ListenID.Activity_OpenDrawView,this.onOpenDrawView,this),o.Notifier.changeListener(e,s.ListenID.Activity_CloseDrawView,this.onCloseRewardView,this),o.Notifier.changeListener(e,s.ListenID.Activity_OpenDrawReward,this.onOpenDrawReward,this),o.Notifier.changeListener(e,s.ListenID.Activity_OpenGiftView,this.onOpenGiftView,this),o.Notifier.changeListener(e,s.ListenID.Activity_OpenBoxView,this.onOpenBoxView,this),o.Notifier.changeListener(e,s.ListenID.Activity_OpenInviteView,this.onOpenInviteView,this),o.Notifier.changeListener(e,s.ListenID.Activity_OpenWelfareView,this.onOpenWelfareView,this),o.Notifier.changeListener(e,s.ListenID.Activity_GetBoxTank,this.getBoxTank,this),o.Notifier.changeListener(e,s.ListenID.Activity_SetBoxCountDown,this.setBoxCountDown,this),o.Notifier.changeListener(e,s.ListenID.Game_PauseBoxSchedule,this.onPauseSchedule,this),o.Notifier.changeListener(e,s.ListenID.Game_ResumeBoxSchedule,this.onResumeSchedule,this),o.Notifier.changeListener(e,l.NotifyID.Game_OnShow,this.onResumeSchedule,this),o.Notifier.changeListener(e,l.NotifyID.Game_OnHide,this.onPauseSchedule,this),o.Notifier.changeListener(e,l.NotifyID.Game_Update,this.updateBoxTime,this),o.Notifier.changeCall(e,r.CallID.Activity_IsSigned,this.isSignedDay,this),o.Notifier.changeCall(e,r.CallID.Activity_CanDraw,this.canDraw,this),o.Notifier.changeCall(e,r.CallID.Activity_CanGift,this.canGift,this),o.Notifier.changeCall(e,r.CallID.Activity_ShouldOpenSignView,this.shouldOpenSignView,this),o.Notifier.changeCall(e,r.CallID.Activity_ShouldOpenDrawView,this.shouldOpenDrawView,this)}onOpenSignView(e,t,i){c.UIManager.Open("ui/activity/SignView",t,e,i)}onCloseSignView(){c.UIManager.Close("ui/activity/SignView")}onOpenDrawView(e,t,i){c.UIManager.Open("ui/activity/DrawView",t,e,i)}onCloseRewardView(){c.UIManager.Close("ui/activity/DrawView")}onOpenDrawReward(e,t,i){c.UIManager.Open("ui/activity/DrawReward",t,e,i)}onOpenGiftView(e,t,i){c.UIManager.Open("ui/activity/GiftView",t,e,i)}onOpenBoxView(e,t,i){c.UIManager.Open("ui/activity/BoxView",t,e,i)}onOpenInviteView(e,t,i){c.UIManager.Open("ui/activity/InviteView",t,e,i)}onOpenWelfareView(e,t,i){c.UIManager.Open("ui/activity/WelfareView",t,e,i)}isSignedDay(){return this._model.isSignedTheDay()}canDraw(){return this._model.canDraw()}canGift(){return this._model.canGift()}shouldOpenSignView(){return this._model.shouldOpenSignView()}shouldOpenDrawView(){return this._model.shouldOpenDrawView()}updateBoxTime(e){this._model.updateBoxTime(e)}onPauseSchedule(){this._model.setStatus(!1)}onResumeSchedule(){this._model.setStatus(!0)}getBoxTank(){this._model.getBoxTank()}setBoxCountDown(e){this._model.setBoxCountDown(e)}},cc._RF.pop()},{"../../CallID":"CallID","../../ListenID":"ListenID","../../frame/MVC":"MVC","../../frame/Notifier":"Notifier","../../frame/NotifyID":"NotifyID","../../frame/UIManager":"UIManager","./ActivityModel":"ActivityModel"}],ActivityModel:[function(e,t,i){"use strict";cc._RF.push(t,"af0e0/0BulPS5PrcTUu6vxh","ActivityModel"),Object.defineProperty(i,"__esModule",{value:!0});const s=e("../../frame/MVC"),n=e("../../manager/GameVoManager"),o=e("../../config/Cfg"),a=e("../../frame/Notifier"),r=e("../../CallID"),c=e("../../config/Const"),l=e("../../ListenID"),h=e("../compose/ComposeModel");let d=[1,100],u=[1,2,3,333,4,5,6,666],m={1:{desc:"\u91d1\u5e01",spriteindex:0,reward:300},3:{desc:"\u91d1\u5e01",spriteindex:2,reward:300},5:{desc:"\u91d1\u5e01",spriteindex:5,reward:300},2:{desc:"\u94bb\u77f3",spriteindex:1,reward:100},4:{desc:"\u94bb\u77f3",spriteindex:4,reward:200},6:{desc:"\u94bb\u77f3",spriteindex:6,reward:500},333:{desc:"\u4e0b\u6b213\u500d",spriteindex:3,reward:3},666:{desc:"\u4e0b\u6b216\u500d",spriteindex:7,reward:6}},g=(()=>{class e extends s.MVC.BaseModel{constructor(){super(),this.refreshBoxTime=0,this.status=!0,this.boxCountDown=!0,null==e._instance&&(e._instance=this)}reset(){}setBoxCountDown(e){this.boxCountDown=e}static get getInstance(){return null==e._instance&&(e._instance=new e),e._instance}isSignedTheDay(){return!(n.GameVoManager.getInstance.myUserVo.day!=n.GameVoManager.getInstance.myUserVo.lastSignDay&&n.GameVoManager.getInstance.myUserVo.signDay%7<7)}shouldOpenSignView(){return!n.GameVoManager.getInstance.myUserVo.showSign&&n.GameVoManager.getInstance.myUserVo.topLevel>1&&!this.isSignedTheDay()}shouldOpenDrawView(){return!n.GameVoManager.getInstance.myUserVo.showDraw&&n.GameVoManager.getInstance.myUserVo.topLevel>2}isDrawDoubleReward(){let e=null;if(!(e=n.GameVoManager.getInstance.myUserVo.getDrawTimes-1<=0?o.Cfg.TurnTable.get(n.GameVoManager.getInstance.myUserVo.getDrawTimes):o.Cfg.TurnTable.get(n.GameVoManager.getInstance.myUserVo.getDrawTimes-1))){let t=(n.GameVoManager.getInstance.myUserVo.getDrawTimes-1)%(d[1]-d[0]+1);t+=d[0],e=o.Cfg.TurnTable.get(t)}let t=0;return 333!=e.luckyNum&&666!=e.luckyNum||!n.GameVoManager.getInstance.myUserVo.isDrawDouble||(t=e.luckyNum),t}getRewardList(){return u}getIndexByRewardId(e){let t=0;for(let i=0;i<u.length;i++)u[i]==e&&(t=i);return t}getRewardId(){let e=o.Cfg.TurnTable.get(n.GameVoManager.getInstance.myUserVo.getDrawTimes);if(!e){let t=(n.GameVoManager.getInstance.myUserVo.getDrawTimes-1)%(d[1]-d[0]+1);t+=d[0],e=o.Cfg.TurnTable.get(t)}return e.luckyNum}getRewardNumById(e){if(e>100)return 1;if(e%2==0){let t=50;return n.GameVoManager.getInstance.myUserVo.topTankId>5?t=o.Cfg.Compose.get(n.GameVoManager.getInstance.myUserVo.topTankId-2).buyDiamond*(e/2):t*=e/2,t}{let t=m[e].reward,i=h.default.getInstance.getCurBetterBuyInfo()[1];return a.Notifier.call(r.CallID.Compose_GetRewardByTime,t)+((e-e%2)/2+1)*i}}updateBoxTime(e){if(1==n.GameVoManager.getInstance.myUserVo.boxNum&&n.GameVoManager.getInstance.myUserVo.boxCountdown>0){if(n.GameVoManager.getInstance.myUserVo.boxTankNum>0)return;if(!this.status)return;if(!this.boxCountDown)return}else this.refreshBoxTime+=e,this.refreshBoxTime>=c.Const.refreshBoxTime&&!n.GameVoManager.getInstance.myUserVo.boxFirstShow?(n.GameVoManager.getInstance.myUserVo.boxFirstShow=!0,this.refreshBoxTime=0,n.GameVoManager.getInstance.setBoxNum(1)):this.refreshBoxTime>=c.Const.refreshBoxTime2&&n.GameVoManager.getInstance.myUserVo.boxFirstShow&&(this.refreshBoxTime=0,n.GameVoManager.getInstance.setBoxNum(1))}getBoxTank(){let e=h.default.getInstance.getEmptyGridIndex(),t=n.GameVoManager.getInstance.myUserVo.topTankId,i=Math.ceil(6*Math.random())+t-9,s=i<1?1:i;n.GameVoManager.getInstance.myUserVo.boxTankNum--,n.GameVoManager.getInstance.myUserVo.boxTankNum<=0&&n.GameVoManager.getInstance.setBoxNum(-1),a.Notifier.send(l.ListenID.Invite_GetTank,e,s),a.Notifier.send(l.ListenID.Activity_RefreshBoxTankPoint)}setStatus(e){this.status=e}getRewardDescById(e){return m[e].desc}getRewardIconSpriteIndex(e){return m[e].spriteindex}canDraw(){return n.GameVoManager.getInstance.myUserVo.drawTimes>0}canGift(){return c.Const.GiftNum-n.GameVoManager.getInstance.myUserVo.giftNum>0}}return e._instance=null,e})();i.default=g,cc._RF.pop()},{"../../CallID":"CallID","../../ListenID":"ListenID","../../config/Cfg":"Cfg","../../config/Const":"Const","../../frame/MVC":"MVC","../../frame/Notifier":"Notifier","../../manager/GameVoManager":"GameVoManager","../compose/ComposeModel":"ComposeModel"}],AlertManager:[function(e,t,i){"use strict";cc._RF.push(t,"0527dqIlOdKJarn2BhLuzyZ","AlertManager"),Object.defineProperty(i,"__esModule",{value:!0}),i.AlertManager=i.AlertType=void 0;const s=e("./NormalTips"),n=e("../frame/MVC"),o=e("../frame/UIManager"),a=e("./CurrencyTips"),r=e("../manager/Manager");var c;(function(e){e[e.COMMON=0]="COMMON",e[e.HELP=1]="HELP",e[e.NET_ERROR=2]="NET_ERROR",e[e.LESS_CAPACAITY=3]="LESS_CAPACAITY"})(c=i.AlertType||(i.AlertType={}));let l=(()=>{class e{static showNormalTips(e,t=null,i=1,a=50,c=cc.Vec2.ZERO){let l=this.tipPool.get(),h=r=>{r.getComponent(s.default).setText(e),r.position=c,r.opacity=20;let l=cc.moveBy(i,cc.v2(0,a)),h=cc.fadeOut(1),d=cc.fadeIn(.5),u=cc.spawn(l,d),m=cc.spawn(h,l);r.group="UI",t&&cc.isValid(t)?r.parent=t:r.setParent(o.UIManager.layerRoots(n.MVC.eUILayer.Tips)),cc.tween(r).then(u).delay(.5).then(m).call(()=>{this.tipPool.put(r)}).start()};l?h(l):r.Manager.loader.loadPrefab("ui/common/alert/tip").then(e=>{h(e)})}static showNormalTipsOnce(t,i=null,a=.7,c=50,l=cc.Vec2.ZERO){if(!e.canShow)return;e.canShow=!1;let h=this.tipPool.get(),d=r=>{r.getComponent(s.default).setText(t),r.position=l,r.opacity=20;let h=cc.moveBy(a,cc.v2(0,c)),d=cc.fadeOut(a),u=cc.fadeIn(.4),m=cc.spawn(h,u),g=cc.spawn(d,h);r.group="UI",i&&cc.isValid(i)?r.parent=i:r.setParent(o.UIManager.layerRoots(n.MVC.eUILayer.Tips)),cc.tween(r).then(m).delay(.5).then(g).call(()=>{this.tipPool.put(r),e.canShow=!0}).start()};h?d(h):r.Manager.loader.loadPrefab("ui/common/alert/tip").then(e=>{d(e)})}static showCurrency(e,t,i=null,s=.7,c=cc.Vec2.ZERO){let l=this.currencyPool.get(),h=r=>{r.getComponent(a.default).setText(t,e),r.position=c,r.opacity=20;let l=cc.moveBy(s,cc.v2(0,50)),h=cc.fadeOut(s),d=cc.fadeIn(.4),u=cc.spawn(l,d),m=cc.spawn(h,l);r.group="UI",i&&cc.isValid(i)?r.parent=i:r.setParent(o.UIManager.layerRoots(n.MVC.eUILayer.Tips)),cc.tween(r).then(u).delay(.5).then(m).call(()=>{this.currencyPool.put(r)}).start()};l?h(l):r.Manager.loader.loadPrefab("ui/common/alert/CurrencyTip").then(e=>{h(e)})}static showOutPutTips(t,i=null,a=.5,c=60,l=cc.Vec3.ZERO,h=0){if(e.outlist[h])return;e.outlist[h]=!0;let d=this.OutputtipPool.get(),u=r=>{r.getComponent(s.default).setText("+"+t),r.position=l,r.opacity=20;let d=cc.moveBy(a,cc.v2(0,c)),u=cc.fadeOut(a),m=cc.fadeIn(a),g=cc.spawn(d,m),p=cc.spawn(u,d);r.group="UI",i&&cc.isValid(i)?r.parent=i:r.setParent(o.UIManager.layerRoots(n.MVC.eUILayer.Panel)),cc.tween(r).then(g).delay(.2).then(p).call(()=>{e.outlist[h]=!1,this.OutputtipPool.put(r)}).start()};d?u(d):r.Manager.loader.loadPrefab("ui/common/alert/OutputTip").then(e=>{u(e)})}static showAlert(e,t){e==c.COMMON?o.UIManager.Open("ui/common/alert/CommonAlert",n.MVC.eTransition.Default,n.MVC.eUILayer.Loading,t):e==c.NET_ERROR?o.UIManager.Open("ui/common/alert/NetErrorAlert",n.MVC.eTransition.Default,n.MVC.eUILayer.Loading,t):e==c.LESS_CAPACAITY&&o.UIManager.Open("ui/common/alert/LessCapacityAlert",n.MVC.eTransition.Default,n.MVC.eUILayer.Tips,t)}}return e.tipPool=new cc.NodePool("NormalTips"),e.OutputtipPool=new cc.NodePool,e.currencyPool=new cc.NodePool,e.canShow=!0,e.outlist=[],e})();i.AlertManager=l,cc._RF.pop()},{"../frame/MVC":"MVC","../frame/UIManager":"UIManager","../manager/Manager":"Manager","./CurrencyTips":"CurrencyTips","./NormalTips":"NormalTips"}],AmbushBarrierCfg:[function(e,t,i){"use strict";cc._RF.push(t,"7deecQ3l+lK+rmTuS5C9zM1","AmbushBarrierCfg"),Object.defineProperty(i,"__esModule",{value:!0}),i.AmbushBarrierCfgReader=void 0;const s=e("./TConfig");i.AmbushBarrierCfgReader=class extends s.TConfig{constructor(){super(...arguments),this._name="AmbushBarrier"}},cc._RF.pop()},{"./TConfig":"TConfig"}],AmbushDiamonModeView:[function(e,t,i){"use strict";cc._RF.push(t,"dc61cwFz2JGNLDMAI6sjx6P","AmbushDiamonModeView");var s=this&&this.__decorate||function(e,t,i,s){var n,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});const n=e("../../frame/MVC"),o=e("../../frame/Notifier"),a=e("../../ListenID"),r=e("../../utils/Util"),c=e("../../manager/Manager"),l=e("./FightModel"),{ccclass:h,property:d}=cc._decorator;let u=(()=>{let e=class extends n.MVC.BaseView{constructor(){super(...arguments),this.goldReward=null,this.targetScore=null}changeListener(e){}onOpen(e){super.onOpen(e),this.targetScore.string=`${l.default.getInstance.scoreInAmbush}`,this.goldReward.string=r.Util.goldFormat(l.default.getInstance.goldInCome),o.Notifier.send(a.ListenID.Fight_ResetCameraPos)}onClose(){this._isClosed||(o.Notifier.send(a.ListenID.HideBanner),c.Manager.audio.playAudio(104),super.onClose(),o.Notifier.send(a.ListenID.Fight_Pause,!1))}onGoDiamond(){this.onClose(),o.Notifier.send(a.ListenID.Fight_StartDiamonMode)}};return s([d(cc.Label)],e.prototype,"goldReward",void 0),s([d(cc.Label)],e.prototype,"targetScore",void 0),e=s([h],e)})();i.default=u,cc._RF.pop()},{"../../ListenID":"ListenID","../../frame/MVC":"MVC","../../frame/Notifier":"Notifier","../../manager/Manager":"Manager","../../utils/Util":"Util","./FightModel":"FightModel"}],AmbushEnemyCfg:[function(e,t,i){"use strict";cc._RF.push(t,"660b4KJAgtHDYMHR9Ou34Qo","AmbushEnemyCfg"),Object.defineProperty(i,"__esModule",{value:!0}),i.AmbushEnemyCfgReader=void 0;const s=e("./TConfig");i.AmbushEnemyCfgReader=class extends s.TConfig{constructor(){super(...arguments),this._name="AmbushEnemy"}},cc._RF.pop()},{"./TConfig":"TConfig"}],AmbushEnemyPoolCfg:[function(e,t,i){"use strict";cc._RF.push(t,"bf102HicM9CT7lOQ4RV3uyi","AmbushEnemyPoolCfg"),Object.defineProperty(i,"__esModule",{value:!0}),i.AmbushEnemyPoolCfgReader=void 0;const s=e("./TConfig");i.AmbushEnemyPoolCfgReader=class extends s.TConfig{constructor(){super(...arguments),this._name="AmbushEnemyPool"}},cc._RF.pop()},{"./TConfig":"TConfig"}],AmbushGuideView:[function(e,t,i){"use strict";cc._RF.push(t,"52114T/aUxL55mZeM0YpoPk","AmbushGuideView");var s=this&&this.__decorate||function(e,t,i,s){var n,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});const n=e("../../frame/MVC"),o=e("../../frame/Notifier"),a=e("../../ListenID"),r=e("../../manager/Manager"),{ccclass:c,property:l}=cc._decorator;let h=(()=>{let e=class extends n.MVC.BaseView{changeListener(e){}onOpen(e){super.onOpen(e),o.Notifier.send(a.ListenID.Fight_Pause,!0)}onClose(){this._isClosed||(r.Manager.audio.playAudio(104),super.onClose(),o.Notifier.send(a.ListenID.Fight_Pause,!1))}};return e=s([c],e)})();i.default=h,cc._RF.pop()},{"../../ListenID":"ListenID","../../frame/MVC":"MVC","../../frame/Notifier":"Notifier","../../manager/Manager":"Manager"}],AnimTransition:[function(e,t,i){"use strict";cc._RF.push(t,"86b61CSSGZJAqHgGXWUizXJ","AnimTransition"),Object.defineProperty(i,"__esModule",{value:!0}),i.AnimTransition=void 0;i.AnimTransition=class{constructor(){this.isClean=!1}init(e,t){this._node=e,this.isClean=t,this.m_animator=e.getComponent(cc.Animation)}show(){return new Promise((e,t)=>{null!=this.m_animator&&(this.m_animator.play("Show"),e())})}hide(){null!=this.m_animator&&this.m_animator.play("Hide")}},cc._RF.pop()},{}],AnimateManager:[function(e,t,i){"use strict";cc._RF.push(t,"2371aSZ8OpBCaglXrAYuxOy","AnimateManager"),Object.defineProperty(i,"__esModule",{value:!0}),i.AnimateManager=void 0;const s=e("./Manager");class n{constructor(e){this.id=e}}i.AnimateManager=class{constructor(){this._clips={}}getFireAnimationClip(e){let t=this;return new Promise((i,o)=>{let a=t._clips[e];if(null==a){t._clips[e]=new n(e);let o="fireEffect/"+e;s.Manager.loader.loadRes("fireEffect/"+e,cc.AnimationClip,(e,s)=>{e||(t._clips[o].clip=s,i(t._clips[o].clip))})}else i(a.clip)})}getHitAnimationClip(e){let t=this;return new Promise((i,o)=>{let a=t._clips[e];if(null==a){a=new n(e),t._clips[e]=a;let o="hitEffect/"+e;s.Manager.loader.loadRes("hitEffect/"+e,cc.AnimationClip,(e,s)=>{e||(t._clips[o].clip=s,i(t._clips[o].clip))})}else i(a.clip)})}getBoomAnimationClip(e){let t=this;return new Promise((i,o)=>{let a=t._clips[e];if(null==a){a=new n(e),t._clips[e]=a;let o="boomEffect/"+e;s.Manager.loader.loadRes("boomEffect/"+e,cc.AnimationClip,(e,s)=>{t._clips[o].clip=s,i(t._clips[o].clip)})}else i(a.clip)})}},cc._RF.pop()},{"./Manager":"Manager"}],AppLife:[function(e,t,i){"use strict";cc._RF.push(t,"78672VkVbhO36SH9qeJyV0+","AppLife"),Object.defineProperty(i,"__esModule",{value:!0});const s=e("./manager/GameVoManager"),n=e("./manager/Manager"),o=e("./frame/Notifier"),a=e("./frame/NotifyID");cc.game.on(cc.game.EVENT_SHOW,e=>{o.Notifier.send(a.NotifyID.Game_OnShow)}),cc.game.on(cc.game.EVENT_HIDE,e=>{s.GameVoManager.getInstance.saveData(),o.Notifier.send(a.NotifyID.Game_OnHide),n.Manager.audio.stopAllGunSources()}),cc._RF.pop()},{"./frame/Notifier":"Notifier","./frame/NotifyID":"NotifyID","./manager/GameVoManager":"GameVoManager","./manager/Manager":"Manager"}],AssetLoader:[function(e,t,i){"use strict";cc._RF.push(t,"adf93PqftBG2Keh5/kOraQz","AssetLoader"),Object.defineProperty(i,"__esModule",{value:!0}),i.assetLoader=i.LoadResArgs=void 0;const s=e("./ResKeeper");class n{}i.LoadResArgs=n;let o=cc.js.isChildClassOf;o||(o=cc.isChildClassOf);class a{constructor(){this._resKeeper=null}static makeLoadResArgs(){if(arguments.length<1)return cc.error(`_makeLoadResArgs error ${arguments}`),null;if(1==arguments.length&&arguments[0]instanceof n)return arguments[0];let e={};if("string"==typeof arguments[0])e.url=arguments[0];else{if(!(arguments[0]instanceof Array))return cc.error(`_makeLoadResArgs error ${arguments}`),null;e.urls=arguments[0]}for(let t=1;t<arguments.length;++t)1==t&&o(arguments[t],cc.Asset)?e.type=arguments[t]:t==arguments.length-1&&arguments[t]instanceof cc.AssetManager.Bundle?e.bundle=arguments[t]:"function"==typeof arguments[t]&&(arguments.length>t+1&&"function"==typeof arguments[t+1]?e.onProgess=arguments[t]:e.onCompleted=arguments[t]);return e.bundle||(e.bundle=cc.resources),e}_finishItem(e,t,i,s){}loadRes(){let e=a.makeLoadResArgs.apply(this,arguments),t=(t,i)=>{t||this._finishItem(e.url,e.type,e.use,void 0),e.onCompleted&&e.onCompleted(t,i)},i=e.bundle.get(e.url,e.type);i?t(null,i):e.url.startsWith("https:")?cc.assetManager.loadRemote(e.url,t):e.bundle.load(e.url,e.type,e.onProgess,t)}preloadRes(){let e=a.makeLoadResArgs.apply(this,arguments),t=(t,i)=>{t||this._finishItem(e.url,e.type,e.use,void 0),e.onCompleted&&e.onCompleted(t,i)},i=e.bundle.get(e.url,e.type);i?t(null,i):e.bundle.preload(e.url,e.type,e.onProgess,t)}loadArray(){let e=a.makeLoadResArgs.apply(this,arguments);e.bundle.load(e.urls,e.type,e.onProgess,(t,i,s)=>{if(!t)for(let t=0;t<e.urls.length;++t)this._finishItem(e.urls[t],e.type,e.use,void 0);e.onCompleted&&e.onCompleted(t,i)})}loadResDir(){let e=a.makeLoadResArgs.apply(this,arguments);e.bundle.loadDir(e.url,e.type,e.onProgess,(t,i)=>{let s=e.bundle.getDirWithPath(e.url,e.type);!t&&s&&s.map(t=>{this._finishItem(t.path,e.type,e.use,void 0)}),e.onCompleted&&e.onCompleted(t,i)})}releaseAsset(e){e&&cc.assetManager.releaseAsset(e)}getResKeeper(){return this._resKeeper||(this._resKeeper=new s.default),this._resKeeper}}i.default=a,i.assetLoader=new a,cc._RF.pop()},{"./ResKeeper":"ResKeeper"}],AttackVo:[function(e,t,i){"use strict";cc._RF.push(t,"80c87JEA05B8qJy/f5bAwtA","AttackVo"),Object.defineProperty(i,"__esModule",{value:!0}),cc._RF.pop()},{}],AudioManager:[function(e,t,i){"use strict";cc._RF.push(t,"85a27U7TvJCL4qpAVMXWQcu","AudioManager");var s=this&&this.__awaiter||function(e,t,i,s){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function a(e){try{c(s.next(e))}catch(e){o(e)}}function r(e){try{c(s.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):n(e.value).then(a,r)}c((s=s.apply(e,t||[])).next())})};Object.defineProperty(i,"__esModule",{value:!0}),i.AudioManager=i.AudioType=void 0;const n=e("../config/Cfg"),o=e("./Manager"),a=e("../module/setting/SettingModel"),r=e("../frame/Notifier"),c=e("../frame/NotifyID");window.wx;class l{constructor(e){this.id=e}}var h;(function(e){e[e.UI=0]="UI",e[e.Gun=1]="Gun",e[e.MyTalk=2]="MyTalk",e[e.EnemyTalk=3]="EnemyTalk",e[e.BeHit=4]="BeHit",e[e.Talk=5]="Talk",e[e.Dead=6]="Dead",e[e.Move=7]="Move",e[e.Time=8]="Time",e[e.Music=9]="Music",e[e.Max=9]="Max"})(h=i.AudioType||(i.AudioType={}));i.AudioManager=class{constructor(){this._clips={},this._audioGunSources=cc.js.createMap(),this._audioSources=[],this._musicSettingVolume=1,this._musicConfigVolume=1,this._musicFadeVolume=1,this._muteMusic=!0,this._muteAudio=!0,this._audioSettingVolume=1,this._audioConfigVolumes=[],this.countGunType=1,this.countHitDeadType=6,this.audionum=0,this.audioHitNum=0,this.audioUINum=0;const e=cc.director.getScene();let t=new cc.Node("_AudioManager"),i=new cc.Node("_testManager");cc.game.addPersistRootNode(t),cc.game.addPersistRootNode(i),t.parent=e,i.parent=e,this._root=t,this._testroot=i,this._musicSource=t.addComponent(cc.AudioSource),this._musicSource.loop=!0;for(let e=0;e<h.Max;e++)this.addAudioSource();r.Notifier.addListener(c.NotifyID.App_Pause,this.OnAppPause,this)}addAudioSource(){let e=this._root.addComponent(cc.AudioSource);this._audioSources.push(e),this._audioConfigVolumes.push(1)}setMusicVolume(e){this._musicSettingVolume=e,cc.audioEngine.setMusicVolume(e),null!=this._musicSource&&(this._musicSource.volume=this._musicSettingVolume*this._musicConfigVolume*this._musicFadeVolume)}setMusicConfigVolume(e){this._musicConfigVolume=e,cc.audioEngine.setMusicVolume(e),null!=this._musicSource&&(this._musicSource.volume=this._musicSettingVolume*this._musicConfigVolume*this._musicFadeVolume)}setMusicFadeVolume(e){this._musicFadeVolume=e}doPlayMusic(e){null!=e.clip?(this._musicSource.clip=e.clip,this._musicSource.play()):cc.warn("DoPlayMusic clip null")}playMusic(e,t=!0,i=!0){if(!i&&null!=this._musicClip&&this._musicClip.id==e)return void cc.log("skip the same music:",e);if(null!=this._musicClip&&e==this._musicClip.id)return;if(!a.default.getInstance.muteMusic)return;let s=n.Cfg.Sound.get(e);if(null==s)return void cc.error("PlayMusic error config id:",e);s.volume<=0&&(cc.error("soundCfg volume error id:",e),s.volume=1),this.setMusicConfigVolume(s.volume),this._musicSource.loop=t;let r=this._clips[e];if(null==r){let t=s.path,i=e;o.Manager.loader.loadRes(t,cc.AudioClip,(e,t)=>{e||(this._clips[i]||(this._clips[i]=new l(i),this._clips[i].clip=t),this.doPlayMusic(this._clips[i]))})}else this._musicClip=r,this.doPlayMusic(r)}stopMusic(){cc.audioEngine.stopMusic(),this._musicSource.stop(),this._musicClip=null}pauseMusic(){this._musicSource.pause(),cc.audioEngine.pauseMusic()}resumeMusic(){a.default.getInstance.muteMusic&&this._musicSource.resume()}muteMusic(e,t){a.default.getInstance.muteMusic?this._musicClip?this.resumeMusic():this.playMusic(t,!0):this.pauseMusic()}preloadMusic(e,t=null,i=null){return s(this,void 0,void 0,function*(){})}musicVolume(){return this._musicSettingVolume}setAudioVolume(e){}setAudioClip(e,t){this._clips[e]||(this._clips[e]=new l(e)),this._clips[e].clip=t}setAudioConfigVolume(e,t=h.UI){}doPlayAudio(e,t,i=1,s){if(null!=e.clip){let i=t;this._audioSources[i].clip=e.clip,this._audioSources[i].play()}else cc.warn("DoPlayAudio clip null")}playAudio(e,t=h.UI,i=1){let s=n.Cfg.Sound.get(e);if(null==s)return void cc.error("PlayAudio error config id:",e);if(!this._muteAudio)return;s.volume<=0&&(cc.error("soundCfg volume error id:",e),s.volume=1),401==e&&console.log(s.loop),this._audioSources[t].loop=!1;let a=this._clips[e];if(null==a){this._clips[e]=new l(e);let n=s.path,a=e+"";o.Manager.loader.loadRes(n,cc.AudioClip,(o,r)=>{if(o)return;let c=Number(a);this._clips[c].clip=r,s.loop?(console.log("realid",c,a,r,n),this.doPlayLoopFire(this._clips[c].clip,e,s.volume)):this.doPlayAudio(this._clips[c],t,i,s.volume)})}else s.loop?this.doPlayLoopFire(a.clip,e,s.volume):this.doPlayAudio(a,t,i,s.volume)}stopAudio(e=h.UI){this._audioSources[e].stop()}muteAudio(e,t=h.UI){this._muteAudio=e}audioVolume(){return this._audioSettingVolume}OnAppPause(e){!e&&cc.sys.os==cc.sys.OS_ANDROID&&window.wx&&this.playAudio(104)}stopAllGunSources(){for(let e in this._audioGunSources)this._audioGunSources[e]&&this._audioGunSources[e].pause()}stopLoopAudio(e){this._audioGunSources[e]&&this._audioGunSources[e].pause()}doPlayLoopFire(e,t,i){if(this._audioGunSources[t])this._audioGunSources[t].clip?this._audioGunSources[t].isPlaying||this._audioGunSources[t].resume():(this._audioGunSources[t].clip=e,this._audioGunSources[t].play());else{let s=this._testroot.addComponent(cc.AudioSource);this._audioGunSources[t]=s,this._audioGunSources[t].clip=e,this._audioGunSources[t].volume=i,this._audioGunSources[t].loop=!0,this._audioGunSources[t].play()}}OnGamePause(e){e?o.Manager.audio.pauseMusic():o.Manager.audio.resumeMusic()}},cc._RF.pop()},{"../config/Cfg":"Cfg","../frame/Notifier":"Notifier","../frame/NotifyID":"NotifyID","../module/setting/SettingModel":"SettingModel","./Manager":"Manager"}],BannerController:[function(e,t,i){"use strict";cc._RF.push(t,"8c39d/vh6xHdr8tR1BuTZqd","BannerController"),Object.defineProperty(i,"__esModule",{value:!0}),i.BannerController=void 0;const s=e("../ListenID"),n=e("../frame/Notifier"),o=e("../frame/MVC");i.BannerController=class extends o.MVC.BaseController{constructor(){super("BannerController"),this._panel="",this._showBoxNum=0,this._showResultNum=0,this._showNum=0,this.changeListener(!0)}reset(){}changeListener(e){n.Notifier.changeListener(e,s.ListenID.ShowBanner,this.showBanner,this),n.Notifier.changeListener(e,s.ListenID.HideBanner,this.hideBanner,this),n.Notifier.changeListener(e,s.ListenID.HideBanner_2,this.hideBanner2,this),n.Notifier.changeListener(e,s.ListenID.ClickBanner,this.clickFunc,this)}showBanner(e,t="",i=!1){this._panel=t,this._showNum++}hideBanner(){}hideBanner2(){}showNum(){}showNum2(){}clickFunc(){}},cc._RF.pop()},{"../ListenID":"ListenID","../frame/MVC":"MVC","../frame/Notifier":"Notifier"}],BarrierCfg:[function(e,t,i){"use strict";cc._RF.push(t,"7a7c60smPxDKbDFlRbi3dlW","BarrierCfg"),Object.defineProperty(i,"__esModule",{value:!0}),i.BarrierCfgReader=void 0;const s=e("./TConfig");i.BarrierCfgReader=class extends s.TConfig{constructor(){super(...arguments),this._name="Barrier"}},cc._RF.pop()},{"./TConfig":"TConfig"}],BaseNet:[function(e,t,i){"use strict";cc._RF.push(t,"195b54zRyVK9KVIDC/lkOey","BaseNet"),Object.defineProperty(i,"__esModule",{value:!0});const s=console,n=window.wx;let o=(()=>{class e{static httpPost(e,t,i){return this._http("POST",e,t,i)}static httpGet(e,t,i){return this._http("GET",e,t,i)}static httpDelete(e,t,i){return this._http("DELETE",e,t,i)}static httpPut(e,t,i){return this._http("PUT",e,t,i)}static get directHttp(){return this.__http||(this.__http=(()=>this._isWechat()?this._wxHttp:this._webHttp)()),this.__http}static _isWechat(){return!(void 0===n)}static _http(e,t,i,n){return new Promise((o,a)=>{this.directHttp(e,t,i,n).then(n=>{n.err&&0!=n.err||n.code&&0!=n.code?(s.warn(`request ${e} ${t} ${i} res error res.err = ${n.err}, res.msg = ${n.msg}`),a(n)):o(n.data)}).catch(n=>{s.warn(`request ${e} ${t} ${i} error ${n}`),a(n)})})}static _wxHttp(e,t,i,s){return new Promise((o,a)=>{n.request({url:t,data:i,method:e,header:{"content-type":"application/json",Authorization:s},success:e=>{var t=e.data.code;let i=e.data.err;0==t||0==i?o(e.data):a(e.data)},fail:e=>{a({code:-1,msg:"request\u8bf7\u6c42\u5931\u8d25",data:e})}})})}static _webHttp(e,t,i,n,o="json"){return new Promise((a,r)=>{let c=new XMLHttpRequest;if(c.timeout=7e3,"GET"==e&&i){let e="?";for(let t in i)"?"!=e&&(e+="&"),e+=t+"="+i[t];t+=e}switch(c.open(e,t),c.onreadystatechange=function(){4==c.readyState?200==c.status?a("json"==o?JSON.parse(c.responseText):c.response):r({code:-1,msg:Error(`xmlHttp status = ${c.status}`),data:{}}):s.debug(`xmlhttp readystate ${c.readyState}`)},c.onerror=function(){r({code:-1,msg:Error("xmlhttp something error"),data:{}})},o){case"json":c.setRequestHeader("content-type","application/json"),c.setRequestHeader("Authorization",n)}"blob"!=o&&"arraybuffer"!=o||(c.responseType=o),c.send(i?JSON.stringify(i):"")})}}return e.__http=null,e})();i.default=o,cc._RF.pop()},{}],BoxView:[function(e,t,i){"use strict";cc._RF.push(t,"abc1eHWL5VAqI+Xi5R0fFsQ","BoxView");var s=this&&this.__decorate||function(e,t,i,s){var n,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});const n=e("../../frame/MVC"),o=e("../../config/Const"),a=e("../../manager/GameVoManager"),r=e("../../manager/Manager"),c=e("../../alert/AlertManager"),l=e("../../frame/Notifier"),h=e("../../ListenID"),d=e("../compose/ComposeModel"),{ccclass:u,property:m}=cc._decorator;let g=(()=>{let e=class extends n.MVC.BaseView{changeListener(e){}onOpen(e){l.Notifier.send(h.ListenID.ShowBanner,0),super.onOpen(e),this.initUI()}onClose(){l.Notifier.send(h.ListenID.HideBanner),r.Manager.audio.playAudio(104),super.onClose()}initUI(){this.node.getChildByName("text_1").active=1==a.GameVoManager.getInstance.myUserVo.boxType,this.node.getChildByName("text_2").active=2==a.GameVoManager.getInstance.myUserVo.boxType,this.node.getChildByName("btnFreeGet").active=!a.GameVoManager.getInstance.myUserVo.boxFirstReward||a.GameVoManager.getInstance.myUserVo.boxTankNum>0,this.node.getChildByName("btnNormalGet").active=a.GameVoManager.getInstance.myUserVo.boxFirstReward&&a.GameVoManager.getInstance.myUserVo.boxTankNum<=0}onFreeReward(){c.AlertManager.showNormalTipsOnce("\u9886\u53d6\u6210\u529f\uff01"),a.GameVoManager.getInstance.myUserVo.boxFirstReward=!0,a.GameVoManager.getInstance.myUserVo.boxTankNum+=6,super.onClose(),l.Notifier.send(h.ListenID.HideBanner),l.Notifier.send(h.ListenID.Activity_RefreshBoxTankPoint),l.Notifier.send(h.ListenID.ShowBoxGuide),a.GameVoManager.getInstance.saveData()}onVideoReward(){if(r.Manager.audio.playAudio(104),1==a.GameVoManager.getInstance.myUserVo.boxType)l.Notifier.send(h.ListenID.Activity_SetBoxCountDown,!1),c.AlertManager.showNormalTipsOnce("\u9886\u53d6\u6210\u529f\uff01"),a.GameVoManager.getInstance.myUserVo.boxTankNum+=6,super.onClose(),l.Notifier.send(h.ListenID.Activity_RefreshBoxTankPoint),l.Notifier.send(h.ListenID.HideBanner),l.Notifier.send(h.ListenID.Activity_SetBoxCountDown,!0),a.GameVoManager.getInstance.saveData();else if(2==a.GameVoManager.getInstance.myUserVo.boxType){if(a.GameVoManager.getInstance.myUserVo.speedUpTime>o.Const.MaxSpeedUpTime-59)return void c.AlertManager.showNormalTipsOnce("\u52a0\u901f\u5df2\u8fbe\u4e0a\u9650");c.AlertManager.showNormalTipsOnce("\u53cc\u500d\u6536\u76ca\u65f6\u95f4+120\u79d2"),a.GameVoManager.getInstance.myUserVo.speedUpTime<=0&&d.default.getInstance.setSpeedUpRadio(.33),a.GameVoManager.getInstance.setSpeedUpTime(120),a.GameVoManager.getInstance.setBoxNum(-1),a.GameVoManager.getInstance.saveData(),super.onClose(),l.Notifier.send(h.ListenID.HideBanner)}}onShareReward_1(){c.AlertManager.showNormalTipsOnce("\u9886\u53d6\u6210\u529f\uff01"),a.GameVoManager.getInstance.myUserVo.boxTankNum+=6,super.onClose(),l.Notifier.send(h.ListenID.Activity_RefreshBoxTankPoint),l.Notifier.send(h.ListenID.HideBanner),a.GameVoManager.getInstance.saveData()}onShareReward_2(){c.AlertManager.showNormalTipsOnce("\u53cc\u500d\u6536\u76ca\u65f6\u95f4+120\u79d2"),a.GameVoManager.getInstance.myUserVo.speedUpTime<=0&&d.default.getInstance.setSpeedUpRadio(.33),a.GameVoManager.getInstance.setSpeedUpTime(120),a.GameVoManager.getInstance.setBoxNum(-1),a.GameVoManager.getInstance.saveData(),super.onClose(),l.Notifier.send(h.ListenID.HideBanner)}onClickGet(){r.Manager.audio.playAudio(104);let e=d.default.getInstance.getEmptyGridIndex();if(-1!=e){let t=a.GameVoManager.getInstance.myUserVo.topTankId;l.Notifier.send(h.ListenID.Invite_GetTank,e,t),l.Notifier.send(h.ListenID.Compose_OpenUnLockView,n.MVC.eUILayer.Popup,n.MVC.eTransition.EaseScale,{unLockId:t,getDiamond:!1}),a.GameVoManager.getInstance.myUserVo.inviteReward++}else c.AlertManager.showNormalTipsOnce("\u6570\u91cf\u5df2\u6ee1\uff0c\u8bf7\u5408\u6210\u6216\u56de\u6536")}};return e=s([u],e)})();i.default=g,cc._RF.pop()},{"../../ListenID":"ListenID","../../alert/AlertManager":"AlertManager","../../config/Const":"Const","../../frame/MVC":"MVC","../../frame/Notifier":"Notifier","../../manager/GameVoManager":"GameVoManager","../../manager/Manager":"Manager","../compose/ComposeModel":"ComposeModel"}],CallID:[function(e,t,i){"use strict";cc._RF.push(t,"3747aUv97xP2aHl8k6crFK1","CallID"),Object.defineProperty(i,"__esModule",{value:!0}),i.CallID=void 0,function(e){e[e._Start=999]="_Start",e[e.Setting_IsMuteMusic=1e3]="Setting_IsMuteMusic",e[e.Setting_IsMuteAudio=1001]="Setting_IsMuteAudio",e[e.Setting_IsBlockShake=1002]="Setting_IsBlockShake",e[e.Setting_IsHurtShow=1003]="Setting_IsHurtShow",e[e.Setting_GetRealDesignSize=1004]="Setting_GetRealDesignSize",e[e.Compose_GetIndexPos=1005]="Compose_GetIndexPos",e[e.Compose_isInCompose=1006]="Compose_isInCompose",e[e.Compose_GetRewardByTime=1007]="Compose_GetRewardByTime",e[e.Compose_OfflineReward=1008]="Compose_OfflineReward",e[e.Fight_GetExpanSize=1009]="Fight_GetExpanSize",e[e.Fight_CameraPos=1010]="Fight_CameraPos",e[e.Power_GetPowerCountTime=1011]="Power_GetPowerCountTime",e[e.Activity_IsSigned=1012]="Activity_IsSigned",e[e.Activity_CanDraw=1013]="Activity_CanDraw",e[e.Activity_CanGift=1014]="Activity_CanGift",e[e.Activity_ShouldOpenSignView=1015]="Activity_ShouldOpenSignView",e[e.Activity_ShouldOpenDrawView=1016]="Activity_ShouldOpenDrawView",e[e.Guide_GetCurStep=1017]="Guide_GetCurStep",e[e.Guide_isAllComplete=1018]="Guide_isAllComplete"}(i.CallID||(i.CallID={})),cc._RF.pop()},{}],CameraManager:[function(e,t,i){"use strict";cc._RF.push(t,"e8df4zIhRVOWL4OJYQTExum","CameraManager"),Object.defineProperty(i,"__esModule",{value:!0}),i.CameraManager=void 0;const s=e("../frame/Notifier"),n=e("../frame/NotifyID"),o=e("../frame/Time");i.CameraManager=class{constructor(){this._zoomStart=!1,this._zoomOffset=cc.v2(0,0),this._zoomRatio=1,this._zoomSpeed=1,this._shakeStart=!1,this._shakeStrength=1,this._shakeDura=1,this._shakeTimeout=1,this._shakeSpeed=100,this._rawPosition=cc.Vec2.ZERO,s.Notifier.addListener(n.NotifyID.Game_Update,this.onUpdate,this)}onSceneSwitchFinish(){this.initCamera(!0)}initCamera(e=!1){(e||null==this._cameraNode)&&(this._cameraNode=cc.find("Canvas/Main Camera"),null!=this._cameraNode&&(this._camera=this._cameraNode.getComponent(cc.Camera)))}get camera(){return this._camera}get node(){return this._cameraNode}setTarget(e){this.initCamera(!1),this._target=e}setZoom(e,t){this._zoomStart=!0,this._zoomRatio=e,this._zoomSpeed=t,this.initCamera(!1)}setShake(e,t,i){this._shakeStart=!0,this._shakeStrength=e,this._shakeDura=i,this._shakeTimeout=o.Time.time+i,this._shakeSpeed=t,this.initCamera(!1),this._cameraNode&&(this._rawPosition=this._cameraNode.position)}onUpdate(){this.follow(),this.zoom(),this.shake()}follow(){if(null==this._target)return;if(null==this._cameraNode)return void cc.error("CameraManager.follow _cameraNode null");let e=this._zoomOffset,t=this._target.position.add(e);this._cameraNode.setPosition(t)}zoom(){if(!this._zoomStart)return;if(null==this._camera)return void cc.error("CameraManager.zoom _camera null");let e=this._camera.zoomRatio,t=this._zoomRatio;this._camera.zoomRatio=Math.lerp(e,t,this._zoomSpeed*o.Time.deltaTime),Math.abs(this._camera.zoomRatio-t)<.005&&(this._zoomStart=!1,this._camera.zoomRatio=t),this._zoomOffset.x=1334*(1-this._camera.zoomRatio)/5}shake(){if(!this._shakeStart)return;if(null==this._cameraNode)return void cc.error("CameraManager.shake _cameraNode null");if(this._shakeTimeout<o.Time.time)return this._shakeStart=!1,void(null==this._target&&this._cameraNode.setPosition(this._rawPosition));let e,t=Math.lerp(0,this._shakeStrength,(this._shakeTimeout-o.Time.time)/this._shakeDura),i=cc.v2(Math.sin(o.Time.time*this._shakeSpeed)*t,Math.cos(o.Time.time*this._shakeSpeed)*t);e=(e=null==this._target?this._rawPosition:this._cameraNode.position).add(i),this._cameraNode.setPosition(e)}screenShot(e=null){this.initCamera(!1),null!=this._camera||cc.error("CameraManager.screenShot _camera null")}},cc._RF.pop()},{"../frame/Notifier":"Notifier","../frame/NotifyID":"NotifyID","../frame/Time":"Time"}],Cfg:[function(e,t,i){"use strict";cc._RF.push(t,"7c618yXUq1ErrUW0gVdSjud","Cfg");var s=this&&this.__awaiter||function(e,t,i,s){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function a(e){try{c(s.next(e))}catch(e){o(e)}}function r(e){try{c(s.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):n(e.value).then(a,r)}c((s=s.apply(e,t||[])).next())})};Object.defineProperty(i,"__esModule",{value:!0}),i.Cfg=void 0;const n=e("./AmbushBarrierCfg"),o=e("./AmbushEnemyPoolCfg"),a=e("./AmbushEnemyCfg"),r=e("./BarrierCfg"),c=e("./ComposeCfg"),l=e("./EnemyPoolCfg"),h=e("./EnemyCfg"),d=e("./SoundCfg"),u=e("./TankCfg"),m=e("./TurnTableCfg"),g=e("./Const");let p=(()=>{class e{constructor(){this._AmbushBarrier=new n.AmbushBarrierCfgReader,this._AmbushEnemyPool=new o.AmbushEnemyPoolCfgReader,this._AmbushEnemy=new a.AmbushEnemyCfgReader,this._Barrier=new r.BarrierCfgReader,this._Compose=new c.ComposeCfgReader,this._EnemyPool=new l.EnemyPoolCfgReader,this._Enemy=new h.EnemyCfgReader,this._Sound=new d.SoundCfgReader,this._Tank=new u.TankCfgReader,this._TurnTable=new m.TurnTableCfgReader}get AmbushBarrier(){return this._AmbushBarrier}get AmbushEnemyPool(){return this._AmbushEnemyPool}get AmbushEnemy(){return this._AmbushEnemy}get Barrier(){return this._Barrier}get Compose(){return this._Compose}get EnemyPool(){return this._EnemyPool}get Enemy(){return this._Enemy}get Sound(){return this._Sound}get Tank(){return this._Tank}get TurnTable(){return this._TurnTable}initByMergeJson(){return s(this,void 0,void 0,function*(){return new Promise((e,t)=>{cc.resources.load("config/GameJsonCfg",cc.JsonAsset,function(i,s){if(i)return cc.error("Cfg.initByMergeJson error",i),void t();const n=s.json;for(const e in n){if(!this.hasOwnProperty("_"+e)){cc.warn("Cfg.initByMergeJson null, "+e);continue}this["_"+e].initByMap(n[e])}e(null)}.bind(this))})})}initBySingleJson(){return s(this,void 0,void 0,function*(){return new Promise((e,t)=>{cc.resources.loadDir("config",function(i,s,n){if(i)return cc.error("Cfg.initBySingleJson error",i),void t();for(let e=0;e<s.length;e++){const t=s[e],i=t.name;if(!this.hasOwnProperty("_"+i)){cc.warn("Cfg.initBySingleJson null, "+i);continue}this["_"+i].initByMap(t.json)}e(null)}.bind(this))})})}initRemoteJson(t,i,n){return s(this,void 0,void 0,function*(){let s=this;return new Promise((o,a)=>{cc.assetManager.loadRemote(g.Const.JsonRemoteUrl+t+".json",function(r,c){if(r)cc.resources.load("config/"+t,cc.JsonAsset,function(t,r){t&&a("err");const c=r.name;s.hasOwnProperty("_"+c)||(cc.warn("Cfg.initRemoteJson null, "+c),a("err")),s["_"+c].initByMap(r.json),e.cfgLoadNum+=1,i&&(i.string=`${e.cfgLoadNum>10?10:e.cfgLoadNum}%`),n&&(n.progress=(e.cfgLoadNum>10?10:e.cfgLoadNum)/100),o(null)});else{s.hasOwnProperty("_"+t)||(cc.warn("Cfg.initRemoteJson null, "+t),a("err")),s["_"+t].initByMap(c),o(null),e.cfgLoadNum+=1,i&&(i.string=`${e.cfgLoadNum>10?10:e.cfgLoadNum}%`),n&&(n.progress=(e.cfgLoadNum>10?10:e.cfgLoadNum)/100)}})})})}initLocalJson(t,i,n){return s(this,void 0,void 0,function*(){let s=this;return new Promise((o,a)=>{cc.resources.load("config/"+t,cc.JsonAsset,function(t,r){t&&a("err");const c=r.name;s.hasOwnProperty("_"+c)||(cc.warn("Cfg.initRemoteJson null, "+c),a("err")),s["_"+c].initByMap(r.json),e.cfgLoadNum+=1,i&&(i.string=`${e.cfgLoadNum>10?10:e.cfgLoadNum}%`),n&&(n.progress=(e.cfgLoadNum>10?10:e.cfgLoadNum)/100),o(null)})})})}HasTag(e,t){return null!=e.tags&&e.tags.indexOf(t)>=0}selectArray(e,t,i,s){const n=e[t];return null==n?s:n[i]||s}}return e.cfgLoadNum=0,e})();i.Cfg=new p,cc._RF.pop()},{"./AmbushBarrierCfg":"AmbushBarrierCfg","./AmbushEnemyCfg":"AmbushEnemyCfg","./AmbushEnemyPoolCfg":"AmbushEnemyPoolCfg","./BarrierCfg":"BarrierCfg","./ComposeCfg":"ComposeCfg","./Const":"Const","./EnemyCfg":"EnemyCfg","./EnemyPoolCfg":"EnemyPoolCfg","./SoundCfg":"SoundCfg","./TankCfg":"TankCfg","./TurnTableCfg":"TurnTableCfg"}],CheatView:[function(e,t,i){"use strict";cc._RF.push(t,"8c4b7ejMkBCDI8GHrGLWb4u","CheatView");var s=this&&this.__decorate||function(e,t,i,s){var n,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});const n=e("../../frame/MVC"),o=e("../../manager/GameVoManager"),a=e("../../shareData/UserVo"),r=e("../../alert/AlertManager"),c=e("../fight/FightModel"),{ccclass:l,property:h}=cc._decorator;let d=(()=>{let e=class extends n.MVC.BaseView{constructor(){super(...arguments),this.cheatNode=null,this.desc=null,this.times=null,this.editlevel=null}changeListener(e){}onOpen(e){super.onOpen(e),this.updateTimes()}updateTimes(){let e="";for(let t=1;t<=50;t++){let i=o.GameVoManager.getInstance.myUserVo.clickBuyTimes[t];i||(i=0);let s=o.GameVoManager.getInstance.myUserVo.shopBuyTimesDiamond[t];s||(s=0),e+=`${t}:${i} ${s}  ${t%2==0?"<br/>":""}`}this.times.string=e}onClose(){super.onClose()}onClearTimes(){o.GameVoManager.getInstance.myUserVo.clickBuyTimes={},o.GameVoManager.getInstance.myUserVo.shopBuyTimesDiamond={}}onCheatClick(){this.cheatNode.active=!this.cheatNode.active,this.desc.string=this.cheatNode.active?"\u5173\u95ed":"\u79d8\u7c4d",this.cheatNode.active&&this.updateTimes()}resetUserVo(){let e=new a.UserVo;e.isGetData=!0,o.GameVoManager.getInstance.myUserVo.updatetUserVo(e),o.GameVoManager.getInstance.saveData()}addMoney(){o.GameVoManager.getInstance.setGold(1e19),o.GameVoManager.getInstance.setDiamond(1e5)}addAmbush(){o.GameVoManager.getInstance.myUserVo.ambushTimes=0}changeLevel(){let e=Number(this.editlevel.string);e?(o.GameVoManager.getInstance.myUserVo.topLevel=e,o.GameVoManager.getInstance.myUserVo.curLevel=o.GameVoManager.getInstance.myUserVo.topLevel+1,c.default.getInstance.initLevelCfg(o.GameVoManager.getInstance.myUserVo.curLevel),r.AlertManager.showNormalTips("\u9009\u62e9"+e+"\u5173\u5361\u6210\u529f")):r.AlertManager.showNormalTips("\u5173\u5361\u6570\u51fa\u9519")}switchoffset(e,t){}onPowerReduce(){o.GameVoManager.getInstance.setPower(1,2)}onPowerAdd(){o.GameVoManager.getInstance.setPower(1,1)}onAddDay(){o.GameVoManager.getInstance.myUserVo.day+=86400,r.AlertManager.showNormalTips("\u52a0\u4e00\u5929")}};return s([h(cc.Node)],e.prototype,"cheatNode",void 0),s([h(cc.Label)],e.prototype,"desc",void 0),s([h(cc.RichText)],e.prototype,"times",void 0),s([h(cc.EditBox)],e.prototype,"editlevel",void 0),e=s([l],e)})();i.default=d,cc._RF.pop()},{"../../alert/AlertManager":"AlertManager","../../frame/MVC":"MVC","../../manager/GameVoManager":"GameVoManager","../../shareData/UserVo":"UserVo","../fight/FightModel":"FightModel"}],CommonAlert:[function(e,t,i){"use strict";cc._RF.push(t,"cfebdeTINNDvJP97wBfR9pc","CommonAlert");var s=this&&this.__decorate||function(e,t,i,s){var n,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});const n=e("../manager/Manager"),o=e("../frame/MVC"),{ccclass:a,property:r}=cc._decorator;let c=(()=>{let e=class extends o.MVC.BaseView{constructor(){super(...arguments),this.desc=null,this.cbConfirm=null}start(){}changeListener(e){}onOpen(e){super.onOpen(e),this.desc.string=e.desc?e.desc:"",this.desc.node.parent.height=this.desc.node.height+250,this.cbConfirm=e&&e.errorcb}onClose(){n.Manager.audio.playAudio(104),super.onClose(),this.cbConfirm&&this.cbConfirm()}};return s([r(cc.RichText)],e.prototype,"desc",void 0),e=s([a],e)})();i.default=c,cc._RF.pop()},{"../frame/MVC":"MVC","../manager/Manager":"Manager"}],Common_Define:[function(e,t,i){"use strict";cc._RF.push(t,"7db72QlW+pMjIB7V0U+nAYc","Common_Define"),cc._RF.pop()},{}],ComposeCfg:[function(e,t,i){"use strict";cc._RF.push(t,"cc51b+tUJVOdYduBFMkJJ8D","ComposeCfg"),Object.defineProperty(i,"__esModule",{value:!0}),i.ComposeCfgReader=void 0;const s=e("./TConfig");i.ComposeCfgReader=class extends s.TConfig{constructor(){super(...arguments),this._name="Compose"}},cc._RF.pop()},{"./TConfig":"TConfig"}],ComposeController:[function(e,t,i){"use strict";cc._RF.push(t,"a3ec8P0DZ5I3aWeOXlWAhwd","ComposeController"),Object.defineProperty(i,"__esModule",{value:!0}),i.ComposeController=void 0;const s=e("../../ListenID"),n=e("../../frame/MVC"),o=e("../../frame/Notifier"),a=e("./ComposeModel"),r=e("../../CallID"),c=e("../../frame/UIManager"),l=e("../../frame/NotifyID"),h=e("../../manager/GameVoManager");i.ComposeController=class extends n.MVC.BaseController{constructor(){super("ComposeController"),this.isActive=!1,this._model=a.default.getInstance,cc.game.setFrameRate(60),this.changeListener(!0),this.isActive=!0}reset(){}changeListener(e){o.Notifier.changeListener(e,s.ListenID.Compose_OpenView,this.onOpenView,this),o.Notifier.changeListener(e,s.ListenID.Compose_CloseView,this.onCloseView,this),o.Notifier.changeListener(e,s.ListenID.Compose_OpenUnLockView,this.onOpenUnLockView,this),o.Notifier.changeListener(e,s.ListenID.Compose_CloseUnLockView,this.onCloseUnLockView,this),o.Notifier.changeListener(e,s.ListenID.Compose_OpenExtraRewardView,this.onOpenExtraRewardView,this),o.Notifier.changeListener(e,s.ListenID.Compose_CloseExtraRewardView,this.onCloseExtraRewardView,this),o.Notifier.changeListener(e,s.ListenID.Compose_OpenSelectTankView,this.onOpenSelectTankView,this),o.Notifier.changeListener(e,s.ListenID.Compose_CloseSelectTankView,this.onCloseSelectTankView,this),o.Notifier.changeListener(e,s.ListenID.Compose_OpenGetGoldView,this.onOpenGetGoldView,this),o.Notifier.changeListener(e,s.ListenID.Compose_CloseGetGoldView,this.onCloseGetGoldView,this),o.Notifier.changeListener(e,s.ListenID.Compose_OpenSpeedUpView,this.onOpenSpeedUpView,this),o.Notifier.changeListener(e,s.ListenID.Compose_CloseSpeedUpView,this.onCloseSpeedUpView,this),o.Notifier.changeListener(e,s.ListenID.Compose_OpenOfflineView,this.onOpenOfflineView,this),o.Notifier.changeListener(e,s.ListenID.Compose_OpenShopView,this.onOpenShopView,this),o.Notifier.changeListener(e,s.ListenID.Compose_CloseShopView,this.onCloseShopView,this),o.Notifier.changeListener(e,s.ListenID.Compose_StartOutPut,this.initOutPutGold,this),o.Notifier.changeListener(e,s.ListenID.Compose_OpenFreeUpView,this.openFreeUpView,this),o.Notifier.changeListener(e,l.NotifyID.Game_Update,this.updateModel,this),o.Notifier.changeListener(e,s.ListenID.Compose_SignCompose,this.signCompose,this),o.Notifier.changeListener(e,s.ListenID.Game_RefreshTime,this.refreshPowerTime,this),o.Notifier.changeListener(e,s.ListenID.Game_OpenCheatView,this.openCheatView,this),o.Notifier.changeListener(e,l.NotifyID.Game_OnShow,this.onShow,this),o.Notifier.changeListener(e,l.NotifyID.Game_OnHide,this.onHide,this),o.Notifier.changeCall(e,r.CallID.Compose_isInCompose,this.isInCompose,this),o.Notifier.changeCall(e,r.CallID.Compose_GetRewardByTime,this.getRewardByTime,this),o.Notifier.changeCall(e,r.CallID.Compose_OfflineReward,this.getOfflineReward,this)}getRewardByTime(e){return this._model.getRewardByTime(e)}getGridPosByIndex(e){return this._model.getPosByIndex(e)}openCheatView(e,t,i){c.UIManager.Open("ui/cheat/CheatView",t,e,i)}onOpenView(e,t,i){c.UIManager.Open("ui/compose/ComposeView",t,e,i)}onCloseView(){c.UIManager.Close("ui/compose/ComposeView")}onOpenShopView(e,t,i){c.UIManager.Open("ui/compose/ComposeShopView",t,e,i)}onCloseShopView(){c.UIManager.Close("ui/compose/ComposeShopView")}openFreeUpView(e,t,i){c.UIManager.Open("ui/compose/FreeUpView",t,e,i)}initOutPutGold(){this._model.initOutPutGold()}updateModel(e){if(this.isActive){let t=this._model.updateOutputGold(e);t&&t.length>0&&o.Notifier.send(s.ListenID.Compose_OutPutGold,t)}}onShow(){this.isActive=!0}onHide(){this.isActive=!1}isInCompose(){return this._model.isInCompose}signCompose(e){this._model.isInCompose=!!e}refreshPowerTime(){h.GameVoManager.getInstance.myUserVo.isGetData&&this._model.refreshPowerTime()}getOfflineReward(){return this._model.getOfflineReward()}onOpenUnLockView(e,t,i){c.UIManager.Open("ui/compose/UnLockView",t,e,i)}onCloseUnLockView(){c.UIManager.Close("ui/compose/UnLockView")}onOpenSpeedUpView(e,t,i){c.UIManager.Open("ui/compose/SpeedUpView",t,e,i)}onCloseSpeedUpView(){c.UIManager.Close("ui/compose/SpeedUpView")}onOpenOfflineView(e,t,i){c.UIManager.Open("ui/compose/OfflineView",t,e,i)}onOpenExtraRewardView(e,t,i){c.UIManager.Open("ui/compose/ExtraRewardView",t,e,i)}onCloseExtraRewardView(){c.UIManager.Close("ui/compose/ExtraRewardView")}onOpenSelectTankView(e,t,i){c.UIManager.Open("ui/compose/SelectTankView",t,e,i)}onCloseSelectTankView(){c.UIManager.Close("ui/compose/SelectTankView")}onOpenGetGoldView(e,t,i){c.UIManager.Open("ui/compose/GetGoldPanel",t,e,i)}onCloseGetGoldView(){c.UIManager.Close("ui/compose/GetGoldPanel")}},cc._RF.pop()},{"../../CallID":"CallID","../../ListenID":"ListenID","../../frame/MVC":"MVC","../../frame/Notifier":"Notifier","../../frame/NotifyID":"NotifyID","../../frame/UIManager":"UIManager","../../manager/GameVoManager":"GameVoManager","./ComposeModel":"ComposeModel"}],ComposeModel:[function(e,t,i){"use strict";cc._RF.push(t,"38f6fS1CHRBwIaEZf0OyfPn","ComposeModel"),Object.defineProperty(i,"__esModule",{value:!0});const s=e("../../frame/MVC"),n=e("../../manager/GameVoManager"),o=e("../../config/Cfg"),a=e("../../config/Const"),r=e("../../frame/Time"),c=e("../../utils/Util");let l=(()=>{class e extends s.MVC.BaseModel{constructor(){super(),this.startCountDelta=0,this.startRecoverTime=0,this.speedUpRatio=1,this.offlineReward=0,this.isInCompose=!1,this.gridPoss=[[-250,-69.6],[-80,-69.6],[90,-69.6],[260,-69.6],[-250,-219.605],[-80,-219.605],[90,-219.605],[260,-219.605],[-250,-369.605],[-80,-369.605],[90,-369.605],[260,-369.605]],this.buyArea=[],this.startServerTime=r.Time.serverTimeMs,this.startSpeedUpTime=r.Time.serverTimeMs,this.isSpeedUp=!1,null==e._instance&&(e._instance=this),this.tankItemPool=new cc.NodePool,this.startCountDelta=0,this.startRecoverTime=0,this.speedUpRatio=1,this.buyArea=[[],[1,1],[1,1],[1,1],[1,1],[1,2],[1,3],[1,4],[1,5],[1,6],[2,7]]}reset(){}static get getInstance(){return null==e._instance&&(e._instance=new e),e._instance}getComposeTankInfoById(e){return this.ComposeConfig.get(e)}initOutPutGold(){this.goldInterValList=[],this.ComposeConfig||(this.ComposeConfig=o.Cfg.Compose);let e=n.GameVoManager.getInstance.myUserVo.composeInfo;this.startServerTime=r.Time.serverTimeMs;let t=this.startServerTime;for(let i=0;i<e.length;i++){this.goldInterValList[i]={startCount:!1,nextOutPutTime:0,outputGold:0,goldDelta:100};let s=e[i];if(s){let e=this.ComposeConfig.get(s);e&&(this.goldInterValList[i].startCount=!0,this.goldInterValList[i].nextOutPutTime=t+e.goldInterval*this.speedUpRatio,this.goldInterValList[i].outputGold=e.outputGold,this.goldInterValList[i].goldDelta=e.goldInterval)}}this.startCountDelta=.1,n.GameVoManager.getInstance.myUserVo.isfristOutPut?this.offlineReward=0:this.offlineReward=this.calOfflineReward(),n.GameVoManager.getInstance.myUserVo.speedUpTime>0&&this.setSpeedUpRadio(.33)}setSpeedUpRadio(e){if(this.speedUpRatio=e,this.isSpeedUp=1!=this.speedUpRatio,1!=this.speedUpRatio){this.startSpeedUpTime=r.Time.serverTimeMs;let e=this.goldInterValList.length;for(let t=0;t<e;t++)this.goldInterValList[t].startCount&&(this.goldInterValList[t].nextOutPutTime-=this.goldInterValList[t].goldDelta*this.speedUpRatio)}}changeOutPutTank(e,t){[this.goldInterValList[e],this.goldInterValList[t]]=[this.goldInterValList[t],this.goldInterValList[e]]}getOutPutGoldByIndex(e){return this.goldInterValList[e]&&this.goldInterValList[e].startCount?this.goldInterValList[e].outputGold:0}getPosByIndex(e){let t=this.gridPoss[e];return t?cc.v3(t[0],t[1]):cc.Vec3.ZERO}getGridPosList(){return this.gridPoss}popTankItem(){return this.tankItemPool.get()}putTankItem(e){if(this.tankItemPool.put(e),this.tankItemPool.size()>20){this.tankItemPool.get().destroy()}}getLifeProceedSpeed(){let e=n.GameVoManager.getInstance.myUserVo.composeInfo,t=0;for(let i=0;i<e.length;i++){let s=e[i];if(s){let e=o.Cfg.Compose.get(s);e&&(t+=e.outputGoldSecond)}}return t}updateOutputGold(e){let t=[],i=0;if(this.startCountDelta){this.startCountDelta+=e,this.startRecoverTime+=e;let s=this.goldInterValList.length;for(let e=0;e<s;e++)this.goldInterValList[e].startCount&&this.goldInterValList[e].nextOutPutTime<=r.Time.serverTimeMs&&(i+=this.goldInterValList[e].outputGold,t.push(e),this.goldInterValList[e].nextOutPutTime+=this.goldInterValList[e].goldDelta*this.speedUpRatio);this.startRecoverTime>=1&&(n.GameVoManager.getInstance.myUserVo.outputRecoverTime=r.Time.serverTimeMs,this.startRecoverTime=0,this.isSpeedUp&&this.startSpeedUpTime+1e3<=r.Time.serverTimeMs&&(n.GameVoManager.getInstance.myUserVo.speedUpTime>0?n.GameVoManager.getInstance.setSpeedUpTime(-1):this.setSpeedUpRadio(1)))}return t.length>0&&n.GameVoManager.getInstance.setGold(i,a.Const.GoldUse.GetDefault),t}offGridOutPut(e){this.goldInterValList[e]&&(this.goldInterValList[e].startCount=!1)}onGridOutPut(e){if(this.goldInterValList[e]){let t=n.GameVoManager.getInstance.myUserVo.composeInfo[e];if(t){let i=this.ComposeConfig.get(t);i&&(this.goldInterValList[e].startCount=!0,this.goldInterValList[e].nextOutPutTime=r.Time.serverTimeMs+i.goldInterval*this.speedUpRatio,this.goldInterValList[e].outputGold=i.outputGold,this.goldInterValList[e].goldDelta=i.goldInterval)}}}getUserTankIconRes(){this.ComposeConfig||(this.ComposeConfig=o.Cfg.Compose);let e=this.ComposeConfig.get(n.GameVoManager.getInstance.myUserVo.useTankId);return e&&e.icon}getShopCanBuyTopTankId(){return this.ComposeConfig||(this.ComposeConfig=o.Cfg.Compose),this.ComposeConfig.get(n.GameVoManager.getInstance.myUserVo.topTankId).unlockBuyGoldLevel}getCurBetterBuyInfo(){let e=this.buyArea[n.GameVoManager.getInstance.myUserVo.topTankId];e||(e=[n.GameVoManager.getInstance.myUserVo.topTankId-10,n.GameVoManager.getInstance.myUserVo.topTankId-3]);let t=0,i=0,s=0,o="",a=0,r=0,c="",l=!1;for(let h=e[0];h<=e[1];h++){let e=this.ComposeConfig.get(h),d=Math.floor(Math.pow(e.addGold,n.GameVoManager.getInstance.getClickBuyTimesById(h))*e.buyGold);if(0==t)t=h,i=d,s=d/Math.pow(2,h),o=e.icon,a=d,r=h,c=e.icon;else{let u=d/Math.pow(2,h);s>=u&&n.GameVoManager.getInstance.myUserVo.gold>=d?(l=!0,s=u,t=h,i=d,o=e.icon):a>d&&(r=h,a=d,c=e.icon)}}return l?[t,i,o]:[r,a,c]}getEmptyGridIndex(){let e=-1,t=n.GameVoManager.getInstance.myUserVo.composeInfo;for(let i=0;i<t.length;i++)if(0==t[i]){e=i;break}return e}getEmptyGridNum(){let e=0,t=n.GameVoManager.getInstance.myUserVo.composeInfo;for(let i=0;i<t.length;i++)0==t[i]&&e++;return e}composeTank(e,t){n.GameVoManager.getInstance.myUserVo.composeInfo[e]+=1,n.GameVoManager.getInstance.myUserVo.composeInfo[t]=0,this.onGridOutPut(e),this.offGridOutPut(t)}getRewardByTime(e){let t=0,i=e,s=this.goldInterValList.length;for(let e=0;e<s;e++)this.goldInterValList[e].startCount&&(t+=this.goldInterValList[e].outputGold*Math.floor(i/(this.goldInterValList[e].goldDelta/1e3*1)));return t}calOfflineReward(){let e=(r.Time.serverTimeMs-n.GameVoManager.getInstance.myUserVo.outputRecoverTime)/1e3;this.startRecoverTime=0,n.GameVoManager.getInstance.myUserVo.outputRecoverTime=r.Time.serverTimeMs,e>a.Const.MaxOfflineTime&&(e=a.Const.MaxOfflineTime);let t=this.goldInterValList.length,i=e-n.GameVoManager.getInstance.myUserVo.speedUpTime;i<0&&(i=0);let s=Math.floor(e-i),o=0;for(let e=0;e<t;e++)this.goldInterValList[e].startCount&&(o+=this.goldInterValList[e].outputGold*Math.floor(s/(this.goldInterValList[e].goldDelta/1e3*this.speedUpRatio)),o+=this.goldInterValList[e].outputGold*Math.floor(i/(this.goldInterValList[e].goldDelta/1e3*1)));return s>0&&(n.GameVoManager.getInstance.setSpeedUpTime(-s),n.GameVoManager.getInstance.myUserVo.speedUpTime<=0&&this.setSpeedUpRadio(1)),o}refreshPowerTime(){let e=this.calOfflineReward();e>0&&n.GameVoManager.getInstance.setGold(e,a.Const.GoldUse.GetDefault)}getOfflineReward(){return this.offlineReward}setOfflineReward(e){this.offlineReward=e}getTopTankInfo(){return this.toptankInfo&&this.toptankInfo.id==n.GameVoManager.getInstance.myUserVo.topTankId||(this.toptankInfo=o.Cfg.Compose.get(n.GameVoManager.getInstance.myUserVo.topTankId)),this.toptankInfo}getShopCostById(e,t){return t==a.Const.CurrencyType.Gold?(n.GameVoManager.getInstance.myUserVo.clickBuyTimes[e]||(n.GameVoManager.getInstance.myUserVo.clickBuyTimes[e]=0),n.GameVoManager.getInstance.myUserVo.clickBuyTimes[e]):t==a.Const.CurrencyType.Diamond?(n.GameVoManager.getInstance.myUserVo.shopBuyTimesDiamond[e]||(n.GameVoManager.getInstance.myUserVo.shopBuyTimesDiamond[e]=0),n.GameVoManager.getInstance.myUserVo.shopBuyTimesDiamond[e]):void 0}updateShopBuyTimes(e,t,i){t==a.Const.CurrencyType.Gold?(n.GameVoManager.getInstance.myUserVo.clickBuyTimes[e]||(n.GameVoManager.getInstance.myUserVo.clickBuyTimes[e]=0),n.GameVoManager.getInstance.myUserVo.clickBuyTimes[e]+=i):t==a.Const.CurrencyType.Diamond&&(n.GameVoManager.getInstance.myUserVo.shopBuyTimesDiamond[e]||(n.GameVoManager.getInstance.myUserVo.shopBuyTimesDiamond[e]=0),n.GameVoManager.getInstance.myUserVo.shopBuyTimesDiamond[e]+=i)}getTankInfoById(e){return o.Cfg.Tank.get(e)}tankCapacitynotEnough(e,t){let i=0,s=0;if(1==e){let e=c.Util.getRealLevel(t),a=o.Cfg.Barrier.get(e);a&&(i=a.recommend-n.GameVoManager.getInstance.myUserVo.useTankId,s=a.recommend)}else if(2==e){let e=o.Cfg.AmbushBarrier.get(t);e?(i=e.recommend-n.GameVoManager.getInstance.myUserVo.useTankId,s=e.recommend):(i=(e=o.Cfg.AmbushBarrier.get(n.GameVoManager.getInstance.myUserVo.ambushBarrierLength)).recommend-n.GameVoManager.getInstance.myUserVo.useTankId,s=e.recommend)}return i>0?s:0}}return e._instance=null,e})();i.default=l,cc._RF.pop()},{"../../config/Cfg":"Cfg","../../config/Const":"Const","../../frame/MVC":"MVC","../../frame/Time":"Time","../../manager/GameVoManager":"GameVoManager","../../utils/Util":"Util"}],ComposeShopItem:[function(e,t,i){"use strict";cc._RF.push(t,"e30078qpTJFHrgdezTHNrG2","ComposeShopItem");var s=this&&this.__decorate||function(e,t,i,s){var n,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});const n=e("../../../frame/MVC"),o=e("../ComposeModel"),a=e("../../../manager/Manager"),r=e("../../../config/Const"),c=e("../../../utils/Util"),l=e("../../../manager/GameVoManager"),h=e("../../../alert/AlertManager"),d=e("../../../frame/Notifier"),u=e("../../../ListenID"),{ccclass:m,property:g}=cc._decorator;let p=(()=>{let e=class extends cc.Component{constructor(){super(...arguments),this.goldicongray=null,this.levelId=null,this.tankIcon=null,this.btnBuy=null,this.numLabel=null,this.goldIcon=null,this.diamondIcon=null,this.tankName=null,this.btnVideo=null,this._itemId=0,this.costNum=0}start(){}initDataItem(e,t){this._itemId=t,this.levelId=this.node.getChildByName("level").getComponent(cc.Label),this.tankIcon=this.node.getChildByName("tankIcon").getComponent(cc.Sprite),this.btnBuy=this.node.getChildByName("btnBuy"),this.numLabel=cc.find("Background/Label",this.btnBuy).getComponent(cc.Label),this.goldIcon=cc.find("Background/goldicon",this.btnBuy),this.diamondIcon=cc.find("Background/diamondIcon",this.btnBuy),this.tankName=this.node.getChildByName("tankName").getComponent(cc.Label),this.btnVideo=this.node.getChildByName("btnVideo"),this.updateData(t)}updateItem(e,t){this._itemId=t,this.updateData(t)}updateData(e){let t=o.default.getInstance.getComposeTankInfoById(e);this.composedata=t;let i=o.default.getInstance.getTopTankInfo();if(t){if(this.showVideoItem(t.id),t.id<=i.unlockBuyGoldLevel?(this.useType=r.Const.CurrencyType.Gold,this.islock=!1):t.id<=i.unlockBuyDiamondLevel&&0!=i.unlockBuyDiamondLevel?(this.useType=r.Const.CurrencyType.Diamond,this.islock=!1):(this.useType=r.Const.CurrencyType.Gold,this.islock=!0),this.goldIcon.active=this.useType==r.Const.CurrencyType.Gold&&!this.islock,this.goldicongray.active=this.islock,this.diamondIcon.active=this.useType==r.Const.CurrencyType.Diamond,this.btnBuy.getComponent(cc.Button).interactable=!this.islock,this.islock)this.numLabel.string="!",this.tankIcon.node.color=cc.Color.BLACK,this.costNum=9216;else{let e=o.default.getInstance.getShopCostById(t.id,this.useType);this.useType==r.Const.CurrencyType.Gold?this.costNum=Math.floor(Math.pow(t.addGold,e)*t.buyGold):this.costNum=t.addDiamond*e+t.buyDiamond,this.tankIcon.node.color=cc.Color.WHITE,this.numLabel.string=c.Util.goldFormat(this.costNum),this.costNum>l.GameVoManager.getInstance.myUserVo.gold&&(this.btnBuy.getComponent(cc.Button).interactable=!1)}this.levelId.string=`${t.id}`,this.tankName.string=t.name,a.Manager.spAtlas.getTankIconByResPath(t.icon).then(e=>{e&&this.tankIcon&&(this.tankIcon.spriteFrame=e)})}}showVideoItem(e){l.GameVoManager.getInstance.myUserVo.videoItemId&&e==l.GameVoManager.getInstance.myUserVo.videoItemId?this.btnVideo.active=!0:this.btnVideo.active=!1}updateSelf(){this.updateData(this._itemId)}get itemID(){return this._itemId}buyTank(){-1!=o.default.getInstance.getEmptyGridIndex()?(a.Manager.audio.playAudio(102),this.useType==r.Const.CurrencyType.Gold?this.costNum<=l.GameVoManager.getInstance.myUserVo.gold?(l.GameVoManager.getInstance.setGold(-this.costNum,r.Const.GoldUse.CostShopBuy),h.AlertManager.showNormalTipsOnce("\u8d2d\u4e70\u6210\u529f"),o.default.getInstance.updateShopBuyTimes(this.composedata.id,this.useType,1),this.updateCost(),d.Notifier.send(u.ListenID.Compose_ShopBuy,this.composedata.id)):h.AlertManager.showNormalTipsOnce("\u91d1\u5e01\u4e0d\u8db3"):this.useType==r.Const.CurrencyType.Diamond&&(this.costNum<=l.GameVoManager.getInstance.myUserVo.diamond?(l.GameVoManager.getInstance.setDiamond(-this.costNum,r.Const.DiamondUse.CostShopBuy),o.default.getInstance.updateShopBuyTimes(this.composedata.id,this.useType,1),h.AlertManager.showNormalTipsOnce("\u8d2d\u4e70\u6210\u529f"),this.updateCost(),d.Notifier.send(u.ListenID.Compose_ShopBuy,this.composedata.id)):h.AlertManager.showNormalTipsOnce("\u94bb\u77f3\u4e0d\u8db3"))):h.AlertManager.showNormalTipsOnce("\u6570\u91cf\u5df2\u6ee1\uff0c\u8bf7\u5408\u6210\u6216\u56de\u6536")}updateCost(){let e=this.composedata,t=o.default.getInstance.getTopTankInfo();if(e){e.id<=t.unlockBuyGoldLevel?this.useType=r.Const.CurrencyType.Gold:e.id<=t.unlockBuyDiamondLevel&&0!=t.unlockBuyDiamondLevel?this.useType=r.Const.CurrencyType.Diamond:this.useType=r.Const.CurrencyType.Gold;let i=o.default.getInstance.getShopCostById(e.id,this.useType);this.useType==r.Const.CurrencyType.Gold?this.costNum=Math.floor(Math.pow(e.addGold,i)*e.buyGold):this.costNum=e.addDiamond*i+e.buyDiamond,this.numLabel.string=c.Util.goldFormat(this.costNum)}}onVideoClick(){let e=o.default.getInstance.getEmptyGridIndex();if(-1==e)return void h.AlertManager.showNormalTipsOnce("\u6570\u91cf\u5df2\u6ee1\uff0c\u8bf7\u5408\u6210\u6216\u56de\u6536");let t=l.GameVoManager.getInstance.myUserVo.videoItemId;d.Notifier.send(u.ListenID.Invite_GetTank,e,t),d.Notifier.send(u.ListenID.Compose_OpenUnLockView,n.MVC.eUILayer.Popup,n.MVC.eTransition.EaseScale,{unLockId:t,type:2}),l.GameVoManager.getInstance.myUserVo.videoItemId=0,l.GameVoManager.getInstance.myUserVo.openShopTimes=0,this.btnVideo.active=!1,l.GameVoManager.getInstance.saveData()}onShareGetTiems(){let e=o.default.getInstance.getEmptyGridIndex(),t=l.GameVoManager.getInstance.myUserVo.videoItemId;d.Notifier.send(u.ListenID.Invite_GetTank,e,t),d.Notifier.send(u.ListenID.Compose_OpenUnLockView,n.MVC.eUILayer.Popup,n.MVC.eTransition.EaseScale,{unLockId:t,type:2}),l.GameVoManager.getInstance.myUserVo.videoItemId=0,l.GameVoManager.getInstance.myUserVo.openShopTimes=0,this.btnVideo.active=!1,l.GameVoManager.getInstance.saveData()}};return s([g(cc.Node)],e.prototype,"goldicongray",void 0),e=s([m],e)})();i.default=p,cc._RF.pop()},{"../../../ListenID":"ListenID","../../../alert/AlertManager":"AlertManager","../../../config/Const":"Const","../../../frame/MVC":"MVC","../../../frame/Notifier":"Notifier","../../../manager/GameVoManager":"GameVoManager","../../../manager/Manager":"Manager","../../../utils/Util":"Util","../ComposeModel":"ComposeModel"}],ComposeShopView:[function(e,t,i){"use strict";cc._RF.push(t,"c09a8Pja2VPb7C2jwb27fBb","ComposeShopView");var s=this&&this.__decorate||function(e,t,i,s){var n,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});const n=e("../../frame/MVC"),o=e("../../manager/GameVoManager"),a=e("./item/ComposeShopItem"),r=e("./ComposeModel"),c=e("../../manager/Manager"),l=e("../../frame/Notifier"),h=e("../../ListenID"),{ccclass:d,property:u}=cc._decorator;let m=(()=>{let e=class extends n.MVC.BaseView{constructor(){super(...arguments),this.itemShopItem=null,this.scrollView=null,this.totalCount=0,this.spawnCount=6,this.spacing=7,this.bufferZone=450,this.lastContentPosY=0,this.content=null,this.items=[],this.delta=.1}changeListener(e){l.Notifier.changeListener(e,h.ListenID.Game_UpdateGold,this.onUpdateGold,this)}onLoad(){this.content=this.scrollView.content,this.items=[],this.lastContentPosY=0}onOpen(e){super.onOpen(e),l.Notifier.send(h.ListenID.ShowBanner,0),this.videoItem(),this.initData()}onClose(){l.Notifier.send(h.ListenID.HideBanner),c.Manager.audio.playAudio(104),super.onClose()}videoItem(){if(o.GameVoManager.getInstance.myUserVo.openShopTimes++,o.GameVoManager.getInstance.myUserVo.openShopTimes>=3&&!o.GameVoManager.getInstance.myUserVo.videoItemId){let e=r.default.getInstance.getTopTankInfo(),t=1;e.unlockBuyGoldLevel>1&&(t=e.unlockBuyGoldLevel-Math.floor(2*Math.random())),o.GameVoManager.getInstance.myUserVo.videoItemId=t}}initData(){this.totalCount=o.GameVoManager.getInstance.myUserVo.tankAllNum,this.totalCount<this.spawnCount&&(this.totalCount=this.spawnCount),this.content.height=this.totalCount*(this.itemShopItem.height+this.spacing)+this.spacing;for(let e=0;e<this.spawnCount;++e){let t=cc.instantiate(this.itemShopItem);t.active=!0,this.content.addChild(t),t.setPosition(0,-t.height*(.5+e)-this.spacing*(e+1)),t.getComponent(a.default).initDataItem(e,e+1),this.items.push(t)}this.scrollView.scrollToPercentVertical(1-(r.default.getInstance.getShopCanBuyTopTankId()-1)/this.totalCount,.1)}onUpdateGold(){let e=this.items.length;for(let t=0;t<e;t++)this.items[t].getComponent(a.default).updateSelf()}getPositionInView(e){let t=e.parent.convertToWorldSpaceAR(e.position);return this.scrollView.node.convertToNodeSpaceAR(t)}scrollEvent(e,t){}update(e){this.delta-=e,this.delta<0&&(this.adjustScrollData(),this.delta=.1)}adjustScrollData(){let e=this.items,t=this.bufferZone,i=this.scrollView.content.y<this.lastContentPosY,s=(this.itemShopItem.height+this.spacing)*e.length;for(let n=0;n<e.length;++n){let o=this.getPositionInView(e[n]);if(i){if(o.y<-t&&e[n].y+s<0){e[n].y=e[n].y+s;let t=e[n].getComponent(a.default),i=t.itemID-e.length;t.updateItem(n,i)}}else if(o.y>t&&e[n].y-s>-this.content.height){e[n].y=e[n].y-s;let t=e[n].getComponent(a.default),i=t.itemID+e.length;t.updateItem(n,i)}}this.lastContentPosY=this.scrollView.content.y}};return s([u(cc.Node)],e.prototype,"itemShopItem",void 0),s([u(cc.ScrollView)],e.prototype,"scrollView",void 0),e=s([d],e)})();i.default=m,cc._RF.pop()},{"../../ListenID":"ListenID","../../frame/MVC":"MVC","../../frame/Notifier":"Notifier","../../manager/GameVoManager":"GameVoManager","../../manager/Manager":"Manager","./ComposeModel":"ComposeModel","./item/ComposeShopItem":"ComposeShopItem"}],ComposeView:[function(e,t,i){"use strict";cc._RF.push(t,"c6b10huiLRHMaAFUBUvkOjA","ComposeView");var s=this&&this.__decorate||function(e,t,i,s){var n,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});const n=e("../../frame/MVC"),o=e("./ComposeModel"),a=e("../../manager/GameVoManager"),r=e("./item/TankItem"),c=e("../../utils/Util"),l=e("../../frame/Notifier"),h=e("../../ListenID"),d=e("../../alert/AlertManager"),u=e("../../manager/Manager"),m=e("../../config/Const"),g=e("../../CallID"),p=e("../../frame/Time"),f=e("../../frame/NotifyID"),y=e("../../config/Cfg");let C=cc.v3();const{ccclass:_,property:I}=cc._decorator;let M=(()=>{let e=class extends n.MVC.BaseView{constructor(){super(...arguments),this.levelLabel=null,this.brightlist=null,this.speedUpIconName=null,this.normalWarnLabel=null,this.ambushWarnLabel=null,this.ambushTimeLabel=null,this.ambushVideoIcon=null,this.ambushfightSp=null,this.componseNode=null,this.levelLabelNode=null,this.selectTankNode=null,this.touchlayer=null,this.tankItem=null,this.wasteBasket=null,this.tankNodeList=[],this.tankLevelNode=[],this.tankLevelIcon=[],this.goldLabelNum=null,this.goldSecond=null,this.goldSecondNum=null,this.goldSecondStr="",this.isCanBuy=!0,this.tankIcon=null,this.btnTankIcon=null,this.btnBuyLabelGold=null,this.powerLabel=null,this.diamondLabel=null,this.signPoint=null,this.drawPoint=null,this.giftPoint=null,this.invitePoint=null,this.inviteRedPoint=null,this.speedUpLabel=null,this.tankbg=null,this.btnStartGame=null,this.showGoldRewardNode=null,this.btnBox=null,this.boxCountDown=null,this.effect=null,this.dspColorBg=null,this.testPlayPoint=null,this.btnTestPlayDsp=null,this.boxTankPoint=null,this.lbBoxTankNum=null,this.boxtips=null,this.boxGuide=null,this.boxEffect=null,this.guideBuy=null,this.brightNodeList=[],this.openList=[],this.offsetY=0,this.ambushState=0,this.curBuyTankId=0,this.curBuyTankGold=0,this._captureId=-1,this._touchId=-1,this.moveNode=null,this.iscanmove=!0}changeListener(e){l.Notifier.changeListener(e,h.ListenID.Compose_TankChange,this.tankChangeCall,this),l.Notifier.changeListener(e,h.ListenID.Game_UpdateGold,this.updateGold,this),l.Notifier.changeListener(e,h.ListenID.Compose_OutPutGold,this.updateTankOutput,this),l.Notifier.changeListener(e,h.ListenID.Compose_UpdateModel,this.changeUseTank,this),l.Notifier.changeListener(e,h.ListenID.Game_UpdatePower,this.updatePower,this),l.Notifier.changeListener(e,h.ListenID.Game_UpdateDiamond,this.updateDiamond,this),l.Notifier.changeListener(e,h.ListenID.Game_UpdateBox,this.updateBox,this),l.Notifier.changeListener(e,h.ListenID.Game_UpdateBoxCountDown,this.updateBoxCountDown,this),l.Notifier.changeListener(e,h.ListenID.Activity_RefreshSignPoint,this.updateSignPoint,this),l.Notifier.changeListener(e,h.ListenID.Activity_RefreshDrawPoint,this.updateDrawPoint,this),l.Notifier.changeListener(e,h.ListenID.Activity_RefreshGiftPoint,this.updateGiftPoint,this),l.Notifier.changeListener(e,h.ListenID.Activity_RefreshBoxTankPoint,this.updateBoxTankPoint,this),l.Notifier.changeListener(e,h.ListenID.DSP_RefreshTestPlayPoint,this.updateTestPlayPoint,this),l.Notifier.changeListener(e,h.ListenID.Activity_RefreshInvitePoint,this.updateInvitePoint,this),l.Notifier.changeListener(e,h.ListenID.Compose_UpdateSpeedUpTime,this.updateSpeedUpTime,this),l.Notifier.changeListener(e,h.ListenID.ShowBoxGuide,this.showBoxGuide,this),l.Notifier.changeListener(e,h.ListenID.CloseBoxGuide,this.closeBoxGuide,this),l.Notifier.changeListener(e,h.ListenID.CloseGuideBuy,this.closeGuideBuy,this),l.Notifier.changeListener(e,h.ListenID.Compose_ShopBuy,this.shopBuy,this),l.Notifier.changeListener(e,h.ListenID.Guide_CheckGuide,this.checkGuide,this),l.Notifier.changeListener(e,h.ListenID.FreeUpTank,this.freeUpTank,this),l.Notifier.changeListener(e,h.ListenID.Invite_GetTank,this.putATankInGrid,this),l.Notifier.changeListener(e,h.ListenID.ShowDspPanel,this.onClickDspPanel,this),l.Notifier.changeListener(e,f.NotifyID.Game_OnShow,this.gameOnShow,this)}gameOnShow(){""!=a.GameVoManager.getInstance.myUserVo.jumpAppid&&a.GameVoManager.getInstance.myUserVo.jumpTime>0&&((p.Time.serverTimeMs-a.GameVoManager.getInstance.myUserVo.jumpTime)/1e3>=10?(l.Notifier.send(h.ListenID.Compose_OpenExtraRewardView,n.MVC.eUILayer.Popup,n.MVC.eTransition.EaseScale,{rewardNum:m.Const.jumpGameDiamond,GetRewardType:m.Const.GetRewardType.Free,rewardType:m.Const.CurrencyType.Diamond}),a.GameVoManager.getInstance.myUserVo.jumpRewardAppidList.push(a.GameVoManager.getInstance.myUserVo.jumpAppid),a.GameVoManager.getInstance.myUserVo.jumpAppid="",a.GameVoManager.getInstance.myUserVo.jumpTime=0,a.GameVoManager.getInstance.saveData(),this.updateTestPlayPoint()):d.AlertManager.showNormalTips("\u6ce8\u610f\uff01\u8bd5\u73a9\u9700\u8d85\u8fc710\u79d2"))}onOpen(e){super.onOpen(e),o.default.getInstance.isInCompose=!0,u.Manager.audio.stopMusic(),this.showInterstitial(e),this.initNode(),this.initView(),this.registerTouchOperate(),this.checkGuide(),l.Notifier.send(h.ListenID.Game_ResumeBoxSchedule)}onClose(){l.Notifier.send(h.ListenID.Guide_CloseGuide),super.onClose()}initNode(){this.componseNode=this.node.getChildByName("componseNode"),this.showGoldRewardNode=this.node.getChildByName("showGoldRewardNode"),this.levelLabelNode=this.node.getChildByName("levelLabelNode"),this.tankbg=this.node.getChildByName("tankbg"),this.touchlayer=this.node.getChildByName("bg"),this.tankItem=this.componseNode.getChildByName("tankItem"),this.wasteBasket=this.componseNode.getChildByName("wasteBasket"),this.goldLabelNum=this.node.getChildByName("goldNum").getComponent(cc.Label),this.goldSecond=this.node.getChildByName("goldSecond").getComponent(cc.Label),this.selectTankNode=this.node.getChildByName("selectTank"),this.tankIcon=this.selectTankNode.getChildByName("tankIcon").getComponent(cc.Sprite);let e=this.tankbg.getChildByName("btnBuyTank");this.btnTankIcon=cc.find("Background/tankIcon",e).getComponent(cc.Sprite),this.btnBuyLabelGold=cc.find("Background/costTime",e).getComponent(cc.Label),this.powerLabel=this.node.getChildByName("powerNum").getComponent(cc.Label),this.diamondLabel=this.node.getChildByName("diamondNum").getComponent(cc.Label),this.signPoint=this.node.getChildByName("signPoint"),this.drawPoint=this.node.getChildByName("drawPoint"),this.giftPoint=this.node.getChildByName("giftPoint"),this.invitePoint=this.node.getChildByName("invitePoint"),this.inviteRedPoint=this.node.getChildByName("inviteRedPoint"),this.btnStartGame=this.tankbg.getChildByName("btnStartGame"),this.speedUpLabel=this.node.getChildByName("SpeedUpTime").getComponent(cc.Label),this.effect=this.showGoldRewardNode.getChildByName("effect").getComponent(cc.Animation),this.btnBox=this.tankbg.getChildByName("btnBox"),this.boxCountDown=this.btnBox.getChildByName("lbCountDown").getComponent(cc.Label),this.dspColorBg=this.node.getChildByName("dspColorBg"),this.testPlayPoint=this.node.getChildByName("testPlayPoint"),this.btnTestPlayDsp=this.node.getChildByName("btnTestPlayDsp"),this.boxTankPoint=this.tankbg.getChildByName("boxTankPoint"),this.boxtips=this.tankbg.getChildByName("boxtips"),this.boxGuide=this.tankbg.getChildByName("guidenode"),this.guideBuy=this.tankbg.getChildByName("guideBuy"),this.boxEffect=this.tankbg.getChildByName("boxEffect"),this.lbBoxTankNum=this.boxTankPoint.getChildByName("lbnum").getComponent(cc.Label);const t=this.brightlist.childrenCount;for(let e=0;e<t;e++)this.brightNodeList[e]=this.brightlist.children[e]}checkTankCapacity(){let e=o.default.getInstance.tankCapacitynotEnough(1,a.GameVoManager.getInstance.myUserVo.topLevel+1);e>0?(this.normalWarnLabel.node.parent.active=!0,this.normalWarnLabel.string=`\u63a8\u8350${e}\u7ea7\u5766\u514b`):this.normalWarnLabel.node.parent.active=!1;let t=o.default.getInstance.tankCapacitynotEnough(2,a.GameVoManager.getInstance.myUserVo.ambushTopLevel+1);t>0?(this.ambushWarnLabel.node.parent.active=!0,this.ambushWarnLabel.string=`\u63a8\u8350${t}\u7ea7\u5766\u514b`):this.ambushWarnLabel.node.parent.active=!1}initView(){let e=a.GameVoManager.getInstance.myUserVo.composeInfo,t=l.Notifier.call(g.CallID.Setting_GetRealDesignSize);this.offsetY=.5*(t.height-m.Const.designHeight),this.componseNode.y-=this.offsetY,this.showGoldRewardNode.y-=this.offsetY,this.levelLabelNode.y-=this.offsetY,this.tankbg.y-=this.offsetY,this.speedUpLabel.node.y-=this.offsetY;for(let t=0;t<e.length;t++){let i=this.levelLabelNode.getChildByName("gridLevel"+(t+1)),s=this.levelLabelNode.getChildByName("levelicon"+(t+1));if(this.tankLevelIcon[t]=s,this.tankLevelNode[t]=i.getComponent(cc.Label),e[t]){let i=o.default.getInstance.popTankItem();i||((i=cc.instantiate(this.tankItem)).active=!0),i.parent=this.componseNode,i.getComponent(r.default).initTank(e[t]);let s=o.default.getInstance.getPosByIndex(t);i.setPosition(s),this.tankNodeList[t]=i,this.tankLevelNode[t].node.active=!0,this.tankLevelNode[t].string=i.getComponent(r.default).tankLevel+"",this.tankLevelIcon[t].active=!0}else this.tankNodeList[t]=null,this.tankLevelNode[t].node.active=!1,this.tankLevelIcon[t].active=!1}this.levelLabel.string=`\u7b2c${a.GameVoManager.getInstance.myUserVo.topLevel+1}\u5173`,this.initInviteList(),this.updateShowModel(),this.updateProceeds(),this.updateGold(),this.updateCurBuyTank(),this.updatePower(),this.updateDiamond(),this.updateSignPoint(),this.updateDrawPoint(),this.updateSpeedUpTime(),this.updateDspBtnShow(),this.updateBox(),this.updateTestPlayPoint(),this.updateBoxTankPoint(),this.showSignView(),this.showDrawView(),this.showTestPlayBtn(),this.checkTankCapacity(),this.updateInviteRedPoint(),this.showGuideBuy(),this.updateAmbushState()}showInterstitial(e){}showSignView(){l.Notifier.call(g.CallID.Activity_ShouldOpenSignView)&&(a.GameVoManager.getInstance.myUserVo.showSign=!0,l.Notifier.send(h.ListenID.Activity_OpenSignView,n.MVC.eUILayer.Popup,n.MVC.eTransition.EaseScale))}showDrawView(){l.Notifier.call(g.CallID.Activity_ShouldOpenDrawView)&&(a.GameVoManager.getInstance.myUserVo.showDraw=!0,l.Notifier.send(h.ListenID.Activity_OpenDrawView,n.MVC.eUILayer.Popup,n.MVC.eTransition.EaseScale))}showTestPlayBtn(){this.btnTestPlayDsp.active=a.GameVoManager.getInstance.gameSwitchVo.testplay,this.testPlayPoint.active=a.GameVoManager.getInstance.gameSwitchVo.testplay&&a.GameVoManager.getInstance.myUserVo.DSPData&&a.GameVoManager.getInstance.myUserVo.DSPData.home_try&&a.GameVoManager.getInstance.myUserVo.DSPData.home_try.length>a.GameVoManager.getInstance.myUserVo.jumpRewardAppidList.length}showGuideBuy(){this.guideBuy.active=!a.GameVoManager.getInstance.myUserVo.gameResult}updateDspBtnShow(){}updateAmbushState(){a.GameVoManager.getInstance.myUserVo.ambushTimes>=3&&a.GameVoManager.getInstance.myUserVo.ambushTimes<5?(this.ambushTimeLabel.string=`${5-a.GameVoManager.getInstance.myUserVo.ambushTimes}\u6b21`,this.ambushVideoIcon.active=!0,this.ambushState=1):a.GameVoManager.getInstance.myUserVo.ambushTimes<3?(this.ambushTimeLabel.string=`\u5269\u4f59${3-a.GameVoManager.getInstance.myUserVo.ambushTimes}\u6b21`,this.ambushVideoIcon.active=!1,this.ambushState=0):a.GameVoManager.getInstance.myUserVo.ambushTimes>=5&&(this.ambushTimeLabel.string="0\u70b9\u5237\u65b0",this.ambushVideoIcon.active=!1,this.ambushState=2,this.ambushTimeLabel.node.parent.getChildByName("title").getComponent(cc.Sprite).spriteFrame=this.ambushfightSp)}updateProceeds(){this.goldSecondNum=o.default.getInstance.getLifeProceedSpeed(),this.goldSecondStr=c.Util.goldFormat(this.goldSecondNum),this.goldSecond.string=`+${this.goldSecondStr}/s`}updateGold(){this.goldLabelNum&&(this.goldLabelNum.string=`${c.Util.goldFormat(a.GameVoManager.getInstance.myUserVo.gold)}`)}updateShowModel(){u.Manager.spAtlas.getTankBigIconByResPath(o.default.getInstance.getUserTankIconRes()).then(e=>{this.tankIcon&&(this.tankIcon.spriteFrame=e)})}updateTankOutput(e){if(e&&e.length>0)for(let t=0;t<e.length;t++){let i=o.default.getInstance.getOutPutGoldByIndex(e[t]),s=o.default.getInstance.getPosByIndex(e[t]);d.AlertManager.showOutPutTips(c.Util.goldFormat(i),null,1,70,s.add(this.showGoldRewardNode.position),e[t])}}updateCurBuyTank(){let e=o.default.getInstance.getCurBetterBuyInfo();this.curBuyTankGold=e[1],this.curBuyTankId=e[0],u.Manager.spAtlas.getTankIconByResPath(e[2]).then(e=>{this.btnTankIcon&&(this.btnTankIcon.spriteFrame=e)}),this.btnBuyLabelGold.string=`${c.Util.goldFormat(this.curBuyTankGold)}`}tankChangeCall(){this.updateProceeds()}registerTouchOperate(){this.touchlayer.on(cc.Node.EventType.TOUCH_START,this.touchStart,this),this.touchlayer.on(cc.Node.EventType.TOUCH_MOVE,this.touchMove,this),this.touchlayer.on(cc.Node.EventType.TOUCH_END,this.touchEnd,this),this.touchlayer.on(cc.Node.EventType.TOUCH_CANCEL,this.touchEnd,this),this.selectTankNode.on(cc.Node.EventType.TOUCH_END,this.selectTankEnd,this)}unregisterTouchOperate(){this.touchlayer.off(cc.Node.EventType.TOUCH_START,this.touchStart,this),this.touchlayer.off(cc.Node.EventType.TOUCH_MOVE,this.touchMove,this),this.touchlayer.off(cc.Node.EventType.TOUCH_END,this.touchEnd,this),this.touchlayer.off(cc.Node.EventType.TOUCH_CANCEL,this.touchEnd,this),this.selectTankNode.off(cc.Node.EventType.TOUCH_END,this.selectTankEnd,this)}touchStart(e){if(this._touchId>=0)return;this._touchId=e.getID();let t=e.getLocation(),i=this.componseNode.convertToNodeSpaceAR(t),s=this.getTouchIndexInfo(i);s>=0&&this.tankNodeList[s]&&this.iscanmove&&(this._captureId=s,this.handlerTouchStart(s))}touchMove(e){if(this._touchId==e.getID()){let t=e.getLocation(),i=this.componseNode.convertToNodeSpaceAR(t);this.iscanmove&&this.handlerTouchMove(i)}}touchEnd(e){if(this._touchId==e.getID()){let t=e.getLocation(),i=this.componseNode.convertToNodeSpaceAR(t);this.iscanmove&&this.handlerTouchEnd(i),this._touchId=-1,this._captureId=-1}}selectTankEnd(){u.Manager.audio.playAudio(104),l.Notifier.send(h.ListenID.DSP_CloseDSPMainView),l.Notifier.send(h.ListenID.Compose_OpenSelectTankView,n.MVC.eUILayer.Panel,null,{useTankId:a.GameVoManager.getInstance.myUserVo.useTankId}),this.onClose()}resetBrightNode(){let e=this.brightNodeList.length;for(let t=0;t<e;t++){this.brightNodeList[t].getActionByTag(1)&&this.brightNodeList[t].stopActionByTag(1),this.brightNodeList[t].opacity=0}}getTouchIndexInfo(e){let t=o.default.getInstance.getGridPosList(),i=-1;for(let s=0;s<t.length;s++){let n=cc.v2(t[s][0],t[s][1]);if(e.sub(n).mag()<=75){i=s;break}}return i}handlerTouchStart(e){let t=this.tankNodeList[e];if(t&&cc.isValid(t)){this.moveNode=cc.instantiate(t),t.opacity=125,this.moveNode.parent=this.componseNode;let i=this.checkSameTankIndexList(e,t.getComponent(r.default).tankId);for(let e=0;e<i.length;e++){this.brightNodeList[i[e]].opacity=20;let t=cc.repeatForever(cc.sequence(cc.fadeTo(.5,70),cc.fadeTo(.5,20)));t.setTag(1),cc.tween(this.brightNodeList[i[e]]).then(t).start()}}}checkSameTankIndexList(e,t){let i=this.tankNodeList.length,s=[];for(let n=0;n<i;n++)n!=e&&this.tankNodeList[n]&&this.tankNodeList[n].getComponent(r.default).tankId==t&&s.push(n);return s}handlerTouchMove(e){this.moveNode&&cc.isValid(this.moveNode)&&this.moveNode.setPosition(e)}handlerTouchEnd(e){if(this.moveNode&&cc.isValid(this.moveNode)){this.resetBrightNode();let t=this.getTouchIndexInfo(e);if(t==this._captureId&&(t=-1),cc.Vec3.set(C,e.x,e.y,0),cc.Vec3.subtract(C,this.wasteBasket.position,C),t<=-1&&C.mag()<=75&&(t=12,this.recycleTank(this._captureId),o.default.getInstance.putTankItem(this.moveNode),this.moveNode=null),cc.Vec3.set(C,e.x,e.y,0),cc.Vec3.subtract(C,this.selectTankNode.position,C),t<=-1&&C.mag()<=150){t=13,this.changeUseTank(a.GameVoManager.getInstance.myUserVo.composeInfo[this._captureId]);let e=this.tankNodeList[this._captureId];e&&(e.opacity=255),o.default.getInstance.putTankItem(this.moveNode),this.moveNode=null}if(t>=0&&t<=11)a.GameVoManager.getInstance.myUserVo.composeTimes++,this.handlerCompose(t,this._captureId),o.default.getInstance.putTankItem(this.moveNode),this.moveNode=null;else if(-1==t){let e=this.tankNodeList[this._captureId];e&&(e.opacity=255),o.default.getInstance.putTankItem(this.moveNode),this.moveNode=null}l.Notifier.send(h.ListenID.Guide_CloseGuide)}}recycleTank(e){let t=this.tankNodeList[e];if(t&&cc.isValid(t)){let i=t.getComponent(r.default).sellGold;d.AlertManager.showCurrency(i,m.Const.CurrencyType.Gold),a.GameVoManager.getInstance.setGold(i,m.Const.GoldUse.GetDefault),o.default.getInstance.putTankItem(t),this.tankNodeList[e]=null,this.tankLevelIcon[e].active=!1,this.tankLevelNode[e].node.active=!1,a.GameVoManager.getInstance.updateComposeTankByIndex(e,0),o.default.getInstance.offGridOutPut(e),this.tankChangeCall()}}changeUseTank(e){a.GameVoManager.getInstance.myUserVo.useTankId=e,this.checkTankCapacity(),this.updateShowModel()}updatePower(){if(a.GameVoManager.getInstance.myUserVo.power>0)this.unschedule(this.schedulePower),this.powerLabel.string=`${a.GameVoManager.getInstance.myUserVo.power}/${m.Const.MaxPower}`;else{this.unschedule(this.schedulePower);let e=l.Notifier.call(g.CallID.Power_GetPowerCountTime);this.powerLabel.string=c.Util.timeFormat(Math.ceil(e),2),this.schedule(this.schedulePower.bind(this),1,0,0)}}updateDiamond(){this.diamondLabel.string=`${c.Util.goldFormat(a.GameVoManager.getInstance.myUserVo.diamond)}`}updateBox(e=0){this.btnBox.getComponent(cc.Animation).stop(),this.btnBox.angle=0,1==e?(u.Manager.audio.playAudio(321),this.btnBox.active=!1,this.boxEffect.active=!0,this.boxEffect.getComponent(cc.Animation).play(),this.boxEffect.getComponent(cc.Animation).on("finished",()=>{this.boxEffect.active=!1,this.btnBox.active=!0,this.btnBox.stopAllActions(),cc.tween(this.btnBox).by(.1,{y:10}).by(.1,{y:-10}).start()})):this.btnBox.active=1==a.GameVoManager.getInstance.myUserVo.boxNum}updateBoxCountDown(){this.boxCountDown.string=`${Math.ceil(a.GameVoManager.getInstance.myUserVo.boxCountdown)}\u79d2\u540e\u6d88\u5931`}updateSignPoint(){this.signPoint.active=!l.Notifier.call(g.CallID.Activity_IsSigned)}updateDrawPoint(){this.drawPoint.active=l.Notifier.call(g.CallID.Activity_CanDraw)}updateGiftPoint(){this.giftPoint.active=l.Notifier.call(g.CallID.Activity_CanGift)}updateInviteRedPoint(){this.inviteRedPoint.active=a.GameVoManager.getInstance.myUserVo.inviteRedPoint}updateInvitePoint(){this.invitePoint.active=a.GameVoManager.getInstance.myUserVo.inviteRewardList.indexOf(1)>-1,this.inviteRedPoint.active=!this.invitePoint.active&&a.GameVoManager.getInstance.myUserVo.inviteRedPoint}showBoxGuide(){a.GameVoManager.getInstance.myUserVo.boxShowTips=!0,this.boxtips.active=!0,this.boxGuide.active=!0}closeBoxGuide(){this.boxGuide.active=!1}closeGuideBuy(){this.guideBuy.active=!1}updateBoxTankPoint(){this.btnBox.getComponent(cc.Animation).stop(),this.boxTankPoint.active=a.GameVoManager.getInstance.myUserVo.boxTankNum>0,this.lbBoxTankNum.string=`${a.GameVoManager.getInstance.myUserVo.boxTankNum}`,this.boxCountDown.node.active=!1,a.GameVoManager.getInstance.myUserVo.boxTankNum>0?(this.btnBox.getComponent(cc.Animation).play(),this.boxtips.active=!0):(this.btnBox.getComponent(cc.Animation).stop(),this.boxtips.active=!1)}updateTestPlayPoint(){this.testPlayPoint.active=a.GameVoManager.getInstance.myUserVo.DSPData&&a.GameVoManager.getInstance.myUserVo.DSPData.home_try&&a.GameVoManager.getInstance.myUserVo.DSPData.home_try.length>a.GameVoManager.getInstance.myUserVo.jumpRewardAppidList.length,a.GameVoManager.getInstance.myUserVo.DSPData&&a.GameVoManager.getInstance.myUserVo.DSPData.home_try&&(this.testPlayPoint.getChildByName("lbnum").getComponent(cc.Label).string=""+(a.GameVoManager.getInstance.myUserVo.DSPData.home_try.length-a.GameVoManager.getInstance.myUserVo.jumpRewardAppidList.length))}updateSpeedUpTime(){a.GameVoManager.getInstance.myUserVo.speedUpTime>0?(this.speedUpLabel.node.active=!0,this.speedUpLabel.string=c.Util.timeFormat(Math.ceil(a.GameVoManager.getInstance.myUserVo.speedUpTime),2),this.speedUpIconName.active=!1):(this.speedUpLabel.node.active=!1,this.speedUpIconName.active=!0)}schedulePower(){this.updatePower()}freeUpTank(e){let t=a.GameVoManager.getInstance.myUserVo.composeInfo;this.tankNodeList[e].getComponent(r.default).updateTank(t[e]),this.tankLevelNode[e].string=`${t[e]}`}handlerCompose(e,t){let i=a.GameVoManager.getInstance.myUserVo.composeInfo;if(i[e]==i[t]&&i[e]<a.GameVoManager.getInstance.myUserVo.tankAllNum){this.iscanmove=!1,this.isCanBuy=!1,o.default.getInstance.composeTank(e,t);let s=o.default.getInstance.getPosByIndex(e);this.tankNodeList[t].position=s,this.tankNodeList[t].opacity=255,cc.tween(this.tankNodeList[t]).then(cc.sequence(cc.moveBy(.12,150,0),cc.moveTo(.12,s.x,s.y),cc.callFunc(()=>{o.default.getInstance.putTankItem(this.tankNodeList[t]),this.tankNodeList[t]=null}))).start(),u.Manager.audio.playAudio(105),cc.tween(this.tankNodeList[e]).then(cc.sequence(cc.moveBy(.12,-150,0),cc.moveTo(.12,s.x,s.y),cc.callFunc(()=>{let t=this.tankNodeList[e].getComponent(r.default);this.effect.node.position=s,this.effect.play(),t.updateTank(i[e]),this.tankLevelNode[e].string=t.tankLevel+"",this.tankLevelIcon[e].active=!0,i[e]>a.GameVoManager.getInstance.myUserVo.topTankId?(a.GameVoManager.getInstance.myUserVo.topTankId=i[e],this.changeUseTank(a.GameVoManager.getInstance.myUserVo.topTankId),l.Notifier.send(h.ListenID.Compose_OpenUnLockView,n.MVC.eUILayer.Popup,n.MVC.eTransition.EaseScale,{unLockId:i[e]}),a.GameVoManager.getInstance.saveData()):i[e]<a.GameVoManager.getInstance.myUserVo.topTankId&&a.GameVoManager.getInstance.myUserVo.composeTimes>=m.Const.ComposeTimes&&l.Notifier.send(h.ListenID.Compose_OpenFreeUpView,n.MVC.eUILayer.Popup,n.MVC.eTransition.EaseScale,{id:i[e],targetIndex:e}),this.iscanmove=!0,this.isCanBuy=!0}))).start(),this.tankLevelNode[t].node.active=!1,this.tankLevelIcon[t].active=!1}else{[a.GameVoManager.getInstance.myUserVo.composeInfo[e],a.GameVoManager.getInstance.myUserVo.composeInfo[t]]=[a.GameVoManager.getInstance.myUserVo.composeInfo[t],a.GameVoManager.getInstance.myUserVo.composeInfo[e]],[this.tankNodeList[e],this.tankNodeList[t]]=[this.tankNodeList[t],this.tankNodeList[e]],o.default.getInstance.putTankItem(this.moveNode),o.default.getInstance.changeOutPutTank(e,t),this.moveNode=null;let i=this.tankNodeList[e],s=this.tankNodeList[t];i&&(i.opacity=255),i&&(i.position=o.default.getInstance.getPosByIndex(e)),s&&(s.opacity=255),s&&(s.position=o.default.getInstance.getPosByIndex(t)),i?(this.tankLevelNode[e].node.active=!0,this.tankLevelNode[e].string=i.getComponent(r.default).tankLevel+"",this.tankLevelIcon[e].active=!0):(this.tankLevelNode[e].node.active=!1,this.tankLevelIcon[e].active=!1),s?(this.tankLevelNode[t].node.active=!0,this.tankLevelIcon[t].active=!0,this.tankLevelNode[t].string=s.getComponent(r.default).tankLevel+""):(this.tankLevelNode[t].node.active=!1,this.tankLevelIcon[t].active=!1)}}onClickBuy(){if(this.isCanBuy)if(u.Manager.audio.playAudio(102),l.Notifier.send(h.ListenID.Guide_CloseGuide),a.GameVoManager.getInstance.myUserVo.gold>=this.curBuyTankGold){let e=o.default.getInstance.getEmptyGridIndex();if(-1==e)return void d.AlertManager.showNormalTipsOnce("\u6570\u91cf\u5df2\u6ee1\uff0c\u8bf7\u5408\u6210\u6216\u56de\u6536");a.GameVoManager.getInstance.addClickBuyTimesById(this.curBuyTankId),a.GameVoManager.getInstance.setGold(-this.curBuyTankGold,m.Const.GoldUse.CostClickBuy),this.putATankInGrid(e,this.curBuyTankId)}else d.AlertManager.showNormalTipsOnce("\u91d1\u5e01\u4e0d\u8db3\uff0c\u65e0\u6cd5\u8d2d\u4e70"),a.GameVoManager.getInstance.gameSwitchVo.homegold&&l.Notifier.send(h.ListenID.Compose_OpenGetGoldView,n.MVC.eUILayer.Popup,n.MVC.eTransition.EaseScale,{gold:this.curBuyTankGold})}shopBuy(e){let t=o.default.getInstance.getEmptyGridIndex();-1!=t?this.putATankInGrid(t,e):d.AlertManager.showNormalTipsOnce("\u6570\u91cf\u5df2\u6ee1\uff0c\u8bf7\u5408\u6210\u6216\u56de\u6536")}checkGuide(){let e=l.Notifier.call(g.CallID.Guide_GetCurStep);e<3?l.Notifier.send(h.ListenID.Guide_ShowGuide,{step:3}):e>=4&&l.Notifier.send(h.ListenID.Guide_ShowGuide,{step:5})}putATankInGrid(e,t){let i=o.default.getInstance.popTankItem();i||((i=cc.instantiate(this.tankItem)).active=!0);let s=o.default.getInstance.getPosByIndex(e);i.opacity=10,i.position=cc.v3(s.x-50,s.y-50),i.parent=this.componseNode,i.getComponent(r.default).initTank(t),cc.tween(i).then(cc.spawn(cc.fadeIn(.2),cc.moveTo(.2,s.x,s.y))).start(),this.tankNodeList[e]=i,this.tankLevelNode[e].node.active=!0,this.tankLevelNode[e].string=i.getComponent(r.default).tankLevel+"",this.tankLevelIcon[e].active=!0,a.GameVoManager.getInstance.updateComposeTankByIndex(e,t),o.default.getInstance.onGridOutPut(e),this.tankChangeCall(),this.updateCurBuyTank()}onStartGame(){if(l.Notifier.send(h.ListenID.Guide_CloseGuide),l.Notifier.send(h.ListenID.HideBanner_2),u.Manager.audio.playAudio(104),a.GameVoManager.getInstance.myUserVo.power>=m.Const.PowerCost){let e=()=>{a.GameVoManager.getInstance.setPower(m.Const.PowerCost,2);let e=this.getSceneId(1);a.GameVoManager.getInstance.myUserVo.lastSceneId!=e?(a.GameVoManager.getInstance.myUserVo.lastSceneId=e,l.Notifier.send(h.ListenID.Fight_StartGame,e,!0,1)):l.Notifier.send(h.ListenID.Fight_StartGame,e,!1,1),l.Notifier.send(h.ListenID.Game_PauseBoxSchedule),l.Notifier.send(h.ListenID.DSP_CloseDSPMainView)},t=o.default.getInstance.tankCapacitynotEnough(1,a.GameVoManager.getInstance.myUserVo.topLevel+1);t>0?d.AlertManager.showAlert(d.AlertType.LESS_CAPACAITY,{level:t,confirmCall:e}):e()}else d.AlertManager.showNormalTipsOnce("\u4f53\u529b\u4e0d\u8db3"),l.Notifier.send(h.ListenID.Power_OpenBuyView,n.MVC.eUILayer.Popup,n.MVC.eTransition.EaseScale,2)}startAmBush(){if(a.GameVoManager.getInstance.myUserVo.topLevel<3)return void d.AlertManager.showNormalTipsOnce("\u95ef\u5173\u7b2c3\u5173\u540e\u53ef\u8fdb\u5165\uff01");l.Notifier.send(h.ListenID.Guide_CloseGuide),l.Notifier.send(h.ListenID.HideBanner_2),u.Manager.audio.playAudio(104);let e=()=>{this.ambushState,this.godoAmbush()};if(this.ambushState>=2)return void d.AlertManager.showNormalTipsOnce("\u6b21\u6570\u4e0d\u8db3\uff0c0\u70b9\u5237\u65b0");let t=o.default.getInstance.tankCapacitynotEnough(2,a.GameVoManager.getInstance.myUserVo.ambushTopLevel+1);t>0?d.AlertManager.showAlert(d.AlertType.LESS_CAPACAITY,{level:t,confirmCall:e}):e()}godoAmbush(){a.GameVoManager.getInstance.myUserVo.ambushTimes++;let e=this.getSceneId(2);a.GameVoManager.getInstance.myUserVo.lastSceneId!=e?(a.GameVoManager.getInstance.myUserVo.lastSceneId=e,l.Notifier.send(h.ListenID.Fight_StartGame,e,!0,2)):l.Notifier.send(h.ListenID.Fight_StartGame,e,!1,2),l.Notifier.send(h.ListenID.Game_PauseBoxSchedule),l.Notifier.send(h.ListenID.DSP_CloseDSPMainView)}getSceneId(e){if(1==e){let e=a.GameVoManager.getInstance.myUserVo.topLevel+1,t=y.Cfg.Barrier.get(c.Util.getRealLevel(e));return t?t.sceneId:1}return 2==e?9:1}onClickTestPlayDsp(){u.Manager.audio.playAudio(104),l.Notifier.send(h.ListenID.Guide_CloseGuide),l.Notifier.send(h.ListenID.DSP_OpenTestPlayView,n.MVC.eUILayer.Popup,n.MVC.eTransition.EaseScale)}onClickAddPower(){u.Manager.audio.playAudio(104),a.GameVoManager.getInstance.myUserVo.power>=m.Const.MaxPower?d.AlertManager.showNormalTipsOnce("\u4f53\u529b\u5df2\u8fbe\u4e0a\u9650"):(l.Notifier.send(h.ListenID.Guide_CloseGuide),l.Notifier.send(h.ListenID.Power_OpenBuyView,n.MVC.eUILayer.Popup,n.MVC.eTransition.EaseScale,1))}onClickAddGold(){u.Manager.audio.playAudio(104),l.Notifier.send(h.ListenID.Guide_CloseGuide),l.Notifier.send(h.ListenID.Activity_OpenDrawView,n.MVC.eUILayer.Popup,n.MVC.eTransition.EaseScale)}onCLickAddDiamond(){u.Manager.audio.playAudio(104),l.Notifier.call(g.CallID.Activity_IsSigned)?(l.Notifier.send(h.ListenID.Guide_CloseGuide),l.Notifier.send(h.ListenID.Activity_OpenDrawView,n.MVC.eUILayer.Popup,n.MVC.eTransition.EaseScale)):this.onClickSign()}onClickDraw(){u.Manager.audio.playAudio(104),l.Notifier.send(h.ListenID.Guide_CloseGuide),l.Notifier.send(h.ListenID.Activity_OpenDrawView,n.MVC.eUILayer.Popup,n.MVC.eTransition.EaseScale)}onClickSign(){u.Manager.audio.playAudio(104),l.Notifier.send(h.ListenID.Guide_CloseGuide),l.Notifier.send(h.ListenID.Activity_OpenSignView,n.MVC.eUILayer.Popup,n.MVC.eTransition.EaseScale)}onClickGift(){u.Manager.audio.playAudio(104),l.Notifier.send(h.ListenID.Guide_CloseGuide),l.Notifier.send(h.ListenID.Activity_OpenGiftView,n.MVC.eUILayer.Popup,n.MVC.eTransition.EaseScale)}onClickInvite(){u.Manager.audio.playAudio(104),a.GameVoManager.getInstance.myUserVo.inviteRedPoint&&(this.inviteRedPoint.active=!1,a.GameVoManager.getInstance.myUserVo.inviteRedPoint=!1),l.Notifier.send(h.ListenID.Guide_CloseGuide),l.Notifier.send(h.ListenID.Activity_OpenInviteView,n.MVC.eUILayer.Popup,n.MVC.eTransition.EaseScale)}onClickBox(){if(u.Manager.audio.playAudio(104),a.GameVoManager.getInstance.myUserVo.boxTankNum>0){if(o.default.getInstance.getEmptyGridNum()<1)return void d.AlertManager.showNormalTipsOnce("\u6570\u91cf\u5df2\u6ee1\uff0c\u8bf7\u5408\u6210\u6216\u56de\u6536");l.Notifier.send(h.ListenID.Guide_CloseGuide),l.Notifier.send(h.ListenID.Activity_GetBoxTank)}else l.Notifier.send(h.ListenID.Guide_CloseGuide),l.Notifier.send(h.ListenID.Activity_OpenBoxView,n.MVC.eUILayer.Popup,n.MVC.eTransition.EaseScale)}onClickDspPanel(){}onClickDsp(){u.Manager.audio.playAudio(104),l.Notifier.send(h.ListenID.Guide_CloseGuide)}onClickWelfare(){u.Manager.audio.playAudio(104),l.Notifier.send(h.ListenID.Guide_CloseGuide),l.Notifier.send(h.ListenID.Activity_OpenWelfareView,n.MVC.eUILayer.Popup,n.MVC.eTransition.EaseScale)}onClickSpeedUp(){u.Manager.audio.playAudio(104),l.Notifier.send(h.ListenID.Guide_CloseGuide),l.Notifier.send(h.ListenID.Compose_OpenSpeedUpView,n.MVC.eUILayer.Popup,n.MVC.eTransition.EaseScale)}onOpenShop(){u.Manager.audio.playAudio(104),l.Notifier.send(h.ListenID.Guide_CloseGuide),l.Notifier.send(h.ListenID.Compose_OpenShopView,n.MVC.eUILayer.Popup,n.MVC.eTransition.EaseScale)}onOpenRank(){u.Manager.audio.playAudio(104),l.Notifier.send(h.ListenID.Guide_CloseGuide)}initInviteList(){}};return s([I(cc.Label)],e.prototype,"levelLabel",void 0),s([I(cc.Node)],e.prototype,"brightlist",void 0),s([I(cc.Node)],e.prototype,"speedUpIconName",void 0),s([I(cc.Label)],e.prototype,"normalWarnLabel",void 0),s([I(cc.Label)],e.prototype,"ambushWarnLabel",void 0),s([I(cc.Label)],e.prototype,"ambushTimeLabel",void 0),s([I(cc.Node)],e.prototype,"ambushVideoIcon",void 0),s([I(cc.SpriteFrame)],e.prototype,"ambushfightSp",void 0),e=s([_],e)})();i.default=M,cc._RF.pop()},{"../../CallID":"CallID","../../ListenID":"ListenID","../../alert/AlertManager":"AlertManager","../../config/Cfg":"Cfg","../../config/Const":"Const","../../frame/MVC":"MVC","../../frame/Notifier":"Notifier","../../frame/NotifyID":"NotifyID","../../frame/Time":"Time","../../manager/GameVoManager":"GameVoManager","../../manager/Manager":"Manager","../../utils/Util":"Util","./ComposeModel":"ComposeModel","./item/TankItem":"TankItem"}],Const:[function(e,t,i){"use strict";cc._RF.push(t,"aab5eKdfDBDobMhIkbQt6Ym","Const"),Object.defineProperty(i,"__esModule",{value:!0}),i.Const=void 0,function(e){let t;e.APP_ID="wxc93ee93882288748",e.designWidth=720,e.designHeight=1280,e.GAME_SCENENAME="GameScene",e.GameName="\u5766\u514b\u5de5\u5382",e.SHOW_LOG=!0,e.STORAGE_SETTING="setting",e.STORAGE_NEWUSER="newuser",e.STORAGE_LOADMENU="loadmenu",e.JsonRemoteUrl="https://cdn.heidong.fun/gameres/t3/p2/release/wechat/1.0.0/config/",e.GroupDefault="Default",e.GroupUI="UI",function(e){e[e.Player=0]="Player",e[e.Enemy=1]="Enemy"}(t=e.GunBelong||(e.GunBelong={}));let i,s,n,o,a=(()=>{class e{}return e.tankunlock="tankunlock",e.regular="regular",e.homegold="homegold",e.relive="relive",e.result="result",e.checkin="checkin",e.switch="switch",e.turntable="turntable",e.offline="offline",e.accelerate="accelerate",e.rank_result="rank_result",e})();e.ShareCode=a,e.loopStageRange=[96,100],e.MaxPower=10,e.PowerRecoverTime=600,e.PowerCost=1,function(e){e[e.GetDefault=0]="GetDefault",e[e.GetRecycle=1]="GetRecycle",e[e.CostClickBuy=2]="CostClickBuy",e[e.CostShopBuy=3]="CostShopBuy",e[e.GetFreeGold=4]="GetFreeGold",e[e.GetKill=5]="GetKill",e[e.GetPass=6]="GetPass",e[e.GetDraw=7]="GetDraw",e[e.GetOffline=8]="GetOffline",e[e.GetAmbush=9]="GetAmbush"}(i=e.GoldUse||(e.GoldUse={})),function(e){e[e.GetDefault=0]="GetDefault",e[e.CostRelive=1]="CostRelive",e[e.GetPass=2]="GetPass",e[e.CostBuyPower=3]="CostBuyPower",e[e.GetSign=4]="GetSign",e[e.GetDraw=5]="GetDraw",e[e.CostSpeedUp=6]="CostSpeedUp",e[e.CostShopBuy=7]="CostShopBuy",e[e.GetAmbush=8]="GetAmbush"}(s=e.DiamondUse||(e.DiamondUse={})),function(e){e[e.Gold=0]="Gold",e[e.Diamond=1]="Diamond",e[e.Power=2]="Power"}(n=e.CurrencyType||(e.CurrencyType={})),function(e){e[e.Free=0]="Free",e[e.Share=1]="Share",e[e.Video=2]="Video"}(o=e.GetRewardType||(e.GetRewardType={})),e.DrawShareTimes=5,e.DrawFreeTimes=2,e.MaxSpeedUpTime=1800,e.MaxOfflineTime=7200,e.GiftNum=3,e.WelfareReward=100,e.CommonShareTimes=3,e.ComposeTimes=20,e.refreshSceneCount=5,e.showInterstitialMaxTimes=4,e.jumpGameDiamond=100,e.refreshBoxTime=180,e.refreshBoxTime2=300,e.guideEnemyInfo=[[100,7,0],[100,8,0],[100,9,0]],e.ambushFightTime=60,e.defaultSceneId=8}(i.Const||(i.Const={})),cc._RF.pop()},{}],CurrencyTips:[function(e,t,i){"use strict";cc._RF.push(t,"e1877N+hXRFHrLDYENWJYUP","CurrencyTips");var s=this&&this.__decorate||function(e,t,i,s){var n,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});const n=e("../config/Const"),o=e("../utils/Util"),{ccclass:a,property:r}=cc._decorator;let c=(()=>{let e=class extends cc.Component{constructor(){super(...arguments),this.label=null,this.bg=null,this.spriteframes=[],this.currency=null}start(){}setText(e,t){let i="+";e==n.Const.CurrencyType.Diamond?this.currency.spriteFrame=this.spriteframes[1]:e==n.Const.CurrencyType.Power?this.currency.spriteFrame=this.spriteframes[2]:this.currency.spriteFrame=this.spriteframes[0],t<0&&(i="-"),this.label.string=i+o.Util.goldFormat(Math.abs(t))}};return s([r(cc.Label)],e.prototype,"label",void 0),s([r(cc.Node)],e.prototype,"bg",void 0),s([r([cc.SpriteFrame])],e.prototype,"spriteframes",void 0),s([r(cc.Sprite)],e.prototype,"currency",void 0),e=s([a],e)})();i.default=c,cc._RF.pop()},{"../config/Const":"Const","../utils/Util":"Util"}],DefaultTransition:[function(e,t,i){"use strict";cc._RF.push(t,"c59a3Gw4EFB77iVTywANLi1","DefaultTransition"),Object.defineProperty(i,"__esModule",{value:!0}),i.DefaultTransition=void 0;i.DefaultTransition=class{constructor(){this.isClean=!1}init(e,t){this._node=e,this.isClean=t}show(){return new Promise(e=>{null!=this._node&&(this._node.active=!0,e())})}hide(){null!=this._node&&(this.isClean?this._node.destroy():this._node.active=!1)}},cc._RF.pop()},{}],DiamonModeFailView:[function(e,t,i){"use strict";cc._RF.push(t,"1e9c9/dGEtGgqVyX61PB0yd","DiamonModeFailView");var s=this&&this.__decorate||function(e,t,i,s){var n,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});const n=e("../../frame/MVC"),o=e("../../frame/Notifier"),a=e("../../ListenID"),r=e("../../utils/Util"),c=e("../../alert/AlertManager"),l=e("../../manager/Manager"),h=e("./FightModel"),d=e("../../config/Const"),u=e("../../manager/GameVoManager"),{ccclass:m,property:g}=cc._decorator;let p=(()=>{let e=class extends n.MVC.BaseView{constructor(){super(...arguments),this.goldReward=null}changeListener(e){}onOpen(e){super.onOpen(e),this.goldReward.string=r.Util.goldFormat(h.default.getInstance.goldInCome)}onClose(){this._isClosed||(o.Notifier.send(a.ListenID.HideBanner),l.Manager.audio.playAudio(104),u.GameVoManager.getInstance.saveData(),super.onClose())}doubleReward(){let e=2*h.default.getInstance.goldInCome;u.GameVoManager.getInstance.setGold(e,d.Const.GoldUse.GetAmbush),c.AlertManager.showCurrency(e,d.Const.CurrencyType.Gold),r.Util.showGoldEffect(null,e,cc.Vec2.ZERO,cc.v2(-323,550),.1,0,d.Const.CurrencyType.Gold),this.onClose(),o.Notifier.send(a.ListenID.Fight_BackToCompose,!0),o.Notifier.send(a.ListenID.Fight_CloseView)}shareReward(){this.doubleReward()}onGetDoubleReward(){this.doubleReward()}onGetReward(){let e=h.default.getInstance.goldInCome;u.GameVoManager.getInstance.setGold(e,d.Const.GoldUse.GetAmbush),r.Util.showGoldEffect(null,e,cc.Vec2.ZERO,cc.v2(-323,550),.1,0,d.Const.CurrencyType.Gold),c.AlertManager.showCurrency(e,d.Const.CurrencyType.Gold),this.onClose(),o.Notifier.send(a.ListenID.Fight_BackToCompose,!0),o.Notifier.send(a.ListenID.Fight_CloseView)}};return s([g(cc.Label)],e.prototype,"goldReward",void 0),e=s([m],e)})();i.default=p,cc._RF.pop()},{"../../ListenID":"ListenID","../../alert/AlertManager":"AlertManager","../../config/Const":"Const","../../frame/MVC":"MVC","../../frame/Notifier":"Notifier","../../manager/GameVoManager":"GameVoManager","../../manager/Manager":"Manager","../../utils/Util":"Util","./FightModel":"FightModel"}],DiamonModeSuccessView:[function(e,t,i){"use strict";cc._RF.push(t,"014a8oD+F1Pw6TAJ2Hxml5D","DiamonModeSuccessView");var s=this&&this.__decorate||function(e,t,i,s){var n,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});const n=e("../../frame/MVC"),o=e("../../frame/Notifier"),a=e("../../ListenID"),r=e("../../utils/Util"),c=e("../../alert/AlertManager"),l=e("../../manager/Manager"),h=e("./FightModel"),d=e("../../config/Const"),u=e("../../manager/GameVoManager"),m=e("../../frame/Time"),{ccclass:g,property:p}=cc._decorator;let f=(()=>{let e=class extends n.MVC.BaseView{constructor(){super(...arguments),this.goldReward=null,this.diamonReward=null,this.sign=null,this.nocompletesign=null,this.targetScore=null,this.curScore=null,this.diamonNum=0,this.isWinScore=!1}changeListener(e){}onOpen(e){if(super.onOpen(e),o.Notifier.send(a.ListenID.DSP_OpenDSPResultView,n.MVC.eUILayer.Popup),this.goldReward.string=r.Util.goldFormat(h.default.getInstance.goldInCome),this.targetScore.string=`${h.default.getInstance.ambushTargetScore}`,this.curScore.string=`${h.default.getInstance.scoreInAmbush}`,this.isWinScore=!0,h.default.getInstance.scoreInAmbush<h.default.getInstance.ambushTargetScore){this.sign.spriteFrame=this.nocompletesign,this.isWinScore=!1;Math.ceil(1e3*m.Time.gameTime)}else{Math.ceil(1e3*m.Time.gameTime)}this.sign.node.opacity=10,this.sign.node.scale=.1,cc.tween(this.sign.node).then(cc.spawn(cc.scaleTo(.4,1),cc.fadeIn(.4))).start(),this.diamonNum=e||0,this.diamonReward.string=`${this.diamonNum}`}onClose(){this._isClosed||(o.Notifier.send(a.ListenID.HideBanner),l.Manager.audio.playAudio(104),o.Notifier.send(a.ListenID.DSP_CloseDSPResultView),u.GameVoManager.getInstance.saveData(),super.onClose())}doubleReward(){let e=2*h.default.getInstance.goldInCome,t=2*this.diamonNum;this.isWinScore,u.GameVoManager.getInstance.setGold(e,d.Const.GoldUse.GetAmbush),c.AlertManager.showCurrency(e,d.Const.CurrencyType.Gold),r.Util.showGoldEffect(null,e,cc.Vec2.ZERO,cc.v2(-323,550),.1,0,d.Const.CurrencyType.Gold),u.GameVoManager.getInstance.setDiamond(t,d.Const.DiamondUse.GetAmbush),setTimeout(()=>{c.AlertManager.showCurrency(t,d.Const.CurrencyType.Diamond),r.Util.showGoldEffect(null,t,cc.Vec2.ZERO,cc.v2(-166,602),.1,0,d.Const.CurrencyType.Diamond)},1200),this.onClose(),o.Notifier.send(a.ListenID.Fight_BackToCompose,!0),o.Notifier.send(a.ListenID.Fight_CloseView)}shareReward(){this.doubleReward()}onGetDoubleReward(){this.doubleReward()}onGetReward(){let e=h.default.getInstance.goldInCome,t=this.diamonNum;u.GameVoManager.getInstance.setGold(e,d.Const.GoldUse.GetAmbush),c.AlertManager.showCurrency(e,d.Const.CurrencyType.Gold),r.Util.showGoldEffect(null,e,cc.Vec2.ZERO,cc.v2(-323,550),.1,0,d.Const.CurrencyType.Gold),u.GameVoManager.getInstance.setDiamond(t,d.Const.DiamondUse.GetAmbush),setTimeout(()=>{c.AlertManager.showCurrency(t,d.Const.CurrencyType.Diamond),r.Util.showGoldEffect(null,t,cc.Vec2.ZERO,cc.v2(-166,602),.1,0,d.Const.CurrencyType.Diamond)},1200),this.onClose(),o.Notifier.send(a.ListenID.Fight_BackToCompose,!0),o.Notifier.send(a.ListenID.Fight_CloseView)}};return s([p(cc.Label)],e.prototype,"goldReward",void 0),s([p(cc.Label)],e.prototype,"diamonReward",void 0),s([p(cc.Sprite)],e.prototype,"sign",void 0),s([p(cc.SpriteFrame)],e.prototype,"nocompletesign",void 0),s([p(cc.Label)],e.prototype,"targetScore",void 0),s([p(cc.Label)],e.prototype,"curScore",void 0),e=s([g],e)})();i.default=f,cc._RF.pop()},{"../../ListenID":"ListenID","../../alert/AlertManager":"AlertManager","../../config/Const":"Const","../../frame/MVC":"MVC","../../frame/Notifier":"Notifier","../../frame/Time":"Time","../../manager/GameVoManager":"GameVoManager","../../manager/Manager":"Manager","../../utils/Util":"Util","./FightModel":"FightModel"}],DrawReward:[function(e,t,i){"use strict";cc._RF.push(t,"765b4BbzN9M57v4NKxRpKX1","DrawReward");var s=this&&this.__decorate||function(e,t,i,s){var n,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});const n=e("../../frame/MVC"),o=e("../../config/Const"),a=e("../../manager/GameVoManager"),r=e("./ActivityModel"),c=e("../../utils/Util"),l=e("../../frame/Notifier"),h=e("../../ListenID"),d=e("../../manager/Manager"),{ccclass:u,property:m}=cc._decorator;let g=(()=>{let e=class extends n.MVC.BaseView{constructor(){super(...arguments),this.rewardIcons=[],this.btnClose=null,this.btnShare=null,this.btnNormal=null,this.rewardNum=null,this.rewardType=null,this.rewardNum2=null,this.luckyNum=0,this.isdoubleReward=1}changeListener(e){}onOpen(e){super.onOpen(e),this.initNode(),this.initView(e)}onClose(){d.Manager.audio.playAudio(104),super.onClose()}initNode(){this.btnClose=this.node.getChildByName("btnClose"),this.btnShare=this.node.getChildByName("btnShareGet"),this.btnNormal=this.node.getChildByName("btnNormalGet"),this.rewardNum=this.node.getChildByName("rewardNum").getComponent(cc.Label),this.rewardNum2=this.node.getChildByName("rewardNum2").getComponent(cc.Label),this.rewardType=this.node.getChildByName("rewardType").getComponent(cc.Sprite)}initView(e){this.isdoubleReward=e&&e.isDouble,this.luckyNum=e&&e.luckyNum,this.btnShare.active=a.GameVoManager.getInstance.gameSwitchVo.switch&&this.luckyNum>100,this.btnClose.active=a.GameVoManager.getInstance.gameSwitchVo.switch&&this.luckyNum>100,this.btnNormal.active=!a.GameVoManager.getInstance.gameSwitchVo.switch||this.luckyNum<100;let t=r.default.getInstance.getRewardIconSpriteIndex(this.luckyNum);this.rewardIcons[t]&&(this.rewardType.spriteFrame=this.rewardIcons[t]);let i=r.default.getInstance.getRewardDescById(this.luckyNum);this.luckyNum<100?(i=c.Util.goldFormat(r.default.getInstance.getRewardNumById(this.luckyNum)*this.isdoubleReward),this.rewardNum.string=i,this.rewardNum2.string=""):(this.rewardNum2.string=i,this.rewardNum.string="")}onClickGet(){d.Manager.audio.playAudio(104);let e=r.default.getInstance.getRewardNumById(this.luckyNum);1==e?a.GameVoManager.getInstance.myUserVo.isDrawDouble=1:(this.luckyNum%2!=0?(a.GameVoManager.getInstance.setGold(e*this.isdoubleReward,o.Const.GoldUse.GetDraw),c.Util.showGoldEffect(null,e,cc.Vec2.ZERO,cc.v2(-323,550),.1,0,o.Const.CurrencyType.Gold)):(a.GameVoManager.getInstance.setDiamond(e*this.isdoubleReward,o.Const.GoldUse.GetDraw),c.Util.showGoldEffect(null,e,cc.Vec2.ZERO,cc.v2(-166,602),.1,0,o.Const.CurrencyType.Diamond)),a.GameVoManager.getInstance.myUserVo.isDrawDouble=0),a.GameVoManager.getInstance.saveData(),this.onClose(),l.Notifier.send(h.ListenID.Activity_UpdateDrawView)}onShareClick(){this.onClickGet()}onVideoReward(){d.Manager.audio.playAudio(104),this.onClickGet()}};return s([m([cc.SpriteFrame])],e.prototype,"rewardIcons",void 0),e=s([u],e)})();i.default=g,cc._RF.pop()},{"../../ListenID":"ListenID","../../config/Const":"Const","../../frame/MVC":"MVC","../../frame/Notifier":"Notifier","../../manager/GameVoManager":"GameVoManager","../../manager/Manager":"Manager","../../utils/Util":"Util","./ActivityModel":"ActivityModel"}],DrawView:[function(e,t,i){"use strict";cc._RF.push(t,"03af3baqspHTLcwBpTMHOCO","DrawView");var s=this&&this.__decorate||function(e,t,i,s){var n,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});const n=e("../../frame/MVC"),o=e("../../manager/GameVoManager"),a=e("./ActivityModel"),r=e("../../alert/AlertManager"),c=e("../../frame/Notifier"),l=e("../../ListenID"),h=e("../../manager/Manager"),{ccclass:d,property:u}=cc._decorator;let m=(()=>{let e=class extends n.MVC.BaseView{constructor(){super(...arguments),this.btnBg2=null,this.icon=null,this.iconSpriteFrams=[],this.type=1,this.leftTimeLabel=null,this.doubleRewardNum=1,this.isDoubleNode=null,this.btnNormalGet=null,this.shareNode=null,this.draw=null,this._index=0,this.rewardid=0}changeListener(e){c.Notifier.changeListener(e,l.ListenID.Activity_UpdateDrawView,this.onUpdate,this)}onOpen(e){super.onOpen(e),c.Notifier.send(l.ListenID.ShowBanner,1),this.initNode(),this.initView(e)}onClose(){h.Manager.audio.playAudio(104),c.Notifier.send(l.ListenID.HideBanner,0),super.onClose()}initNode(){this.leftTimeLabel=this.node.getChildByName("drawTimes").getComponent(cc.Label),this.isDoubleNode=this.node.getChildByName("isdoubleReward"),this.btnNormalGet=this.node.getChildByName("btnNormalGet"),this.shareNode=this.node.getChildByName("btnShare"),this.draw=this.node.getChildByName("draw")}initView(e){this.updateTimes(),this.updateDoubleReward(),this.updateShareBtn(),this.isclick=!1}onUpdate(){this.updateDoubleReward()}updateTimes(){this.leftTimeLabel.string=`\u5269\u4f59\u6b21\u6570\uff1a${o.GameVoManager.getInstance.myUserVo.drawTimes}`,this.btnBg2.active=!o.GameVoManager.getInstance.myUserVo.drawTimes,o.GameVoManager.getInstance.gameSwitchVo.unite&&(this.icon.spriteFrame=o.GameVoManager.getInstance.myUserVo.commonShareTimes>0?this.iconSpriteFrams[0]:this.iconSpriteFrams[1],o.GameVoManager.getInstance.myUserVo.commonShareTimes>0?this.type=0:this.type=1)}updateDoubleReward(){let e=a.default.getInstance.isDrawDoubleReward();this.doubleRewardNum=e%10,0==this.doubleRewardNum&&(this.doubleRewardNum=1),this.isDoubleNode.active=!!e,this.isDoubleNode.getComponent(cc.Label).string=`\u672c\u6b21\u5956\u52b1${e%10}\u500d`}updateShareBtn(){this.shareNode.active=o.GameVoManager.getInstance.myUserVo.shareTime>0&&o.GameVoManager.getInstance.gameSwitchVo.turntable&&0==o.GameVoManager.getInstance.myUserVo.drawTimes,this.btnNormalGet.active=!this.shareNode.active}onClickGet(){this.isclick||(h.Manager.audio.playAudio(104),o.GameVoManager.getInstance.myUserVo.drawTimes<=0?r.AlertManager.showNormalTipsOnce("\u8f6c\u76d8\u5269\u4f59\u6b21\u6570\u4e0d\u8db3"):this.rundrawAction())}onReward(){o.GameVoManager.getInstance.myUserVo.drawTimes--,o.GameVoManager.getInstance.myUserVo.getDrawTimes+=1,this.updateTimes(),this.updateShareBtn(),c.Notifier.send(l.ListenID.Activity_OpenDrawReward,n.MVC.eUILayer.Popup,n.MVC.eTransition.EaseScale,{isDouble:this.doubleRewardNum,luckyNum:this.rewardid}),c.Notifier.send(l.ListenID.Activity_RefreshDrawPoint),this.isclick=!1}onShareGetTiems(){o.GameVoManager.getInstance.myUserVo.commonShareTimes--,o.GameVoManager.getInstance.myUserVo.drawTimes+=2,this.updateTimes(),this.updateShareBtn()}onVideoReward(){h.Manager.audio.playAudio(104),1==this.type?(o.GameVoManager.getInstance.myUserVo.shareTime--,o.GameVoManager.getInstance.myUserVo.drawTimes+=2,this.updateTimes(),this.updateShareBtn()):this.onShareGetTiems()}rundrawAction(){this.draw&&(this.isclick=!0,this.rewardid=a.default.getInstance.getRewardId(),this._index=a.default.getInstance.getIndexByRewardId(this.rewardid),this.draw.stopAllActions(),this.draw.angle=this.draw.angle%360,cc.tween(this.draw).then(cc.sequence(cc.rotateTo(5,-(45*this._index+2520)).easing(cc.easeCubicActionInOut()),cc.callFunc(()=>{this.onReward()}))).start())}};return s([u(cc.Node)],e.prototype,"btnBg2",void 0),s([u(cc.Sprite)],e.prototype,"icon",void 0),s([u(cc.SpriteFrame)],e.prototype,"iconSpriteFrams",void 0),e=s([d],e)})();i.default=m,cc._RF.pop()},{"../../ListenID":"ListenID","../../alert/AlertManager":"AlertManager","../../frame/MVC":"MVC","../../frame/Notifier":"Notifier","../../manager/GameVoManager":"GameVoManager","../../manager/Manager":"Manager","./ActivityModel":"ActivityModel"}],EaseScaleTransition:[function(e,t,i){"use strict";cc._RF.push(t,"5bbd4cNi9RIT4pIep17jHQV","EaseScaleTransition"),Object.defineProperty(i,"__esModule",{value:!0}),i.EaseScaleTransition=void 0;i.EaseScaleTransition=class{constructor(){this._animInSpeed=.3,this._animOutSpeed=.3,this.isClean=!1}init(e,t){this._node=e,this.isClean=t;var i=cc.callFunc(this.onFadeOutFinish,this),s=cc.callFunc(this.onFadeInFinish,this);this._scaleInAct=cc.sequence(cc.scaleTo(this._animInSpeed,1).easing(cc.easeBackOut()),s),this._scaleOutAct=cc.sequence(cc.scaleTo(this._animOutSpeed,0).easing(cc.easeBackIn()),i)}show(){return new Promise(e=>{null!=this._node&&(this._node.active=!0,this._node.scale=.1,cc.tween(this._node).then(cc.sequence(this._scaleInAct,cc.callFunc(()=>{e(null)}))).start())})}hide(){null!=this._node&&cc.tween(this._node).then(this._scaleOutAct).start()}onFadeInFinish(){}onFadeOutFinish(){this.isClean?this._node.destroy():this._node.active=!1}},cc._RF.pop()},{}],EnemyCfg:[function(e,t,i){"use strict";cc._RF.push(t,"6667dqImqREj5OmaMsRc8Bp","EnemyCfg"),Object.defineProperty(i,"__esModule",{value:!0}),i.EnemyCfgReader=void 0;const s=e("./TConfig");i.EnemyCfgReader=class extends s.TConfig{constructor(){super(...arguments),this._name="Enemy"}},cc._RF.pop()},{"./TConfig":"TConfig"}],EnemyPoolCfg:[function(e,t,i){"use strict";cc._RF.push(t,"441c5WtdYlGp60Rb7TshQwi","EnemyPoolCfg"),Object.defineProperty(i,"__esModule",{value:!0}),i.EnemyPoolCfgReader=void 0;const s=e("./TConfig");i.EnemyPoolCfgReader=class extends s.TConfig{constructor(){super(...arguments),this._name="EnemyPool"}},cc._RF.pop()},{"./TConfig":"TConfig"}],Enemy:[function(e,t,i){"use strict";cc._RF.push(t,"0b332Ssr9lPj6WDO9LF42zi","Enemy"),Object.defineProperty(i,"__esModule",{value:!0});const s=e("./Role"),n=e("./Gun"),o=e("../../../config/Const"),a=e("../../../config/Cfg"),r=e("../FightModel"),c=e("../../../manager/GameVoManager"),l=e("../../../manager/Manager"),h=e("../../../manager/AudioManager"),d=e("../../../utils/Util"),u=e("../../../frame/Notifier"),m=e("../../../ListenID"),g=e("../FightDamageDisplay");let p=.003,f={1001:1},y=[[-105,4,275,202,119,-2,156,192],[-105,4,275,202,119,-2,156,192],[-92,-24,262,167,119,-2,156,192],[-92,-24,262,167,119,-24,156,192],[-92,-24,262,167,119,-24,156,192],[-90,-24,292,167,14,-11,156,192],[-90,-46,292,100,14,-11,156,192],[-90,-46,292,100,173,-38,256,162],[-111,-66,292,100,159,-68,256,100]];i.default=class extends s.default{constructor(){super(),this.moveDis=0,this.moveDir=null,this.roleTypeId=0,this.hitOrigin1=null,this.hitOrigin2=null,this.hitBox1=null,this.hitBox2=null,this.hitNormalBox=null,this.hitDoubleBox=null,this.bronPosId=0,this.enemyConfig=null,this.behitDoubleHit=!1,this.scaleNode=null,this.hpNode=null,this.hpLabel=null,this.showHurtDisplay=null,this.bloodbg=null,this.bloodwarn=null,this.blood=null,this.hpwidth=0,this.shadow=null,this.fireup=null,this.playflyup=!1,this.boom=null,this.firstMoveDis=0,this.isPlane=!1,this.roadIndex=0,this.enemyForm=0,this.startShowHurt=0,this.startwarnhp=0,this.warnspeed=100,this.isfirstMove=!1,this.moveSpeed=cc.Vec2.ZERO,this.moveDelta=0,this.curdeadTime=0,this.deadType=0,this.deadTime=0,this.changeListener(!0),this.gunObject=new n.default(o.Const.GunBelong.Enemy,this)}changeListener(e){}init(e,t){if(this.roleId=e,this.node=t.node,this.startwarnhp=0,this.node){this.scaleNode=this.node.getChildByName("scaleNode"),this.hpNode=this.node.getChildByName("hpNode"),this.shadow=this.scaleNode.getChildByName("tankshadow"),this.shadow.active=!1,this.boom=this.scaleNode.getChildByName("boom"),this.fireup=this.scaleNode.getChildByName("fireup").getComponent(cc.Animation),this.fireup&&(this.fireup.node.active=!1),this.hpLabel=this.hpNode.getChildByName("hpLabel").getComponent(cc.Label),this.showHurtDisplay=this.hpNode.getChildByName("showHurt").getComponent(cc.Label),this.showHurtDisplay.node.active=!1;let e=this.scaleNode.getChildByName("hitBox1");this.bloodbg=this.hpNode.getChildByName("bloodbg"),this.bloodwarn=this.hpNode.getChildByName("bloodwarn"),this.blood=this.hpNode.getChildByName("blood"),this.hpwidth=this.bloodbg.width-4,this.hitOrigin1=e.position,this.hitBox1?(this.hitBox1.width=e.width,this.hitBox1.height=e.height):this.hitBox1=new cc.Size(e.width,e.height);let t=this.scaleNode.getChildByName("hitBox2");this.hitOrigin2=t.position,this.hitBox2?(this.hitBox2.width=t.width,this.hitBox2.height=t.height):this.hitBox2=new cc.Size(t.width,t.height),this.enemyForm=-1,this.scaleNode.angle=0}this.playflyup=!1,this.roleTypeId=t.roleTypeId||100,this.enemyConfig=a.Cfg.Enemy.get(this.roleTypeId),this.isPlane=-1!=this.enemyConfig.enemyRes.indexOf("plane"),this.initHp(t.hp||100),this.node.position=t.bronPos,this.moveDis=t.movedis||0,this.roadIndex=t.roadIndex||0,this.firstMoveDis=this.moveDis,this.bronPosId=t.bronPosId||0,this.moveDir=t.movedir?t.movedir.normalize():cc.Vec2.ZERO,this.playaudioState=0,this.behitDoubleHit=!1,this.attackNum=t.attackNum||0,this.gunObject.setGunInfo(this.roleTypeId),this.registerFSM(),f[this.enemyConfig.id]?this.doTransform(1):this.tranforms(this.node.y),this.isDead=!1}getRoleId(){return this.roleId}beSelected(e){this.shadow.active!=e&&(this.shadow.active=e)}setScale(e){}canHeadShoot(){return!this.isPlane}initHp(e){this.curHp=e,this.allHp=e,this.hpLabel.string=d.Util.goldFormat(this.curHp),this.bloodwarn.width=this.hpwidth,this.blood.width=this.hpwidth,this.startwarnhp=0,this.playaudioState=0}tranforms(e){let t=1-p*e;this.isPlane&&(t=1-.5*p*e),t<0&&(t=0),this.scaleNode.scale=t;let i=this.hitOrigin1.x*this.scaleNode.scaleX+this.node.x,s=this.hitOrigin1.y*this.scaleNode.scaleY+this.node.y,n=this.hitBox1.width*this.scaleNode.scaleX,o=this.hitBox1.height*this.scaleNode.scaleY;this.hitNormalBox?(this.hitNormalBox.x=i-.5*n,this.hitNormalBox.y=s-.5*o,this.hitNormalBox.width=n,this.hitNormalBox.height=o):this.hitNormalBox=new cc.Rect(i-.5*n,s-.5*o,n,o);let a=this.hitOrigin2.x*this.scaleNode.scaleX+this.node.x,r=this.hitOrigin2.y*this.scaleNode.scaleY+this.node.y,c=this.hitBox2.width*this.scaleNode.scaleX,l=this.hitBox2.height*this.scaleNode.scaleY;this.hitDoubleBox?(this.hitDoubleBox.x=a-.5*c,this.hitDoubleBox.y=r-.5*l,this.hitDoubleBox.width=c,this.hitDoubleBox.height=l):this.hitDoubleBox=new cc.Rect(a-.5*c,r-.5*l,c,l)}update(e){this._gameStateMachine&&this._gameStateMachine.update(e),this.startShowHurt>0&&(this.startShowHurt-=e,this.startShowHurt<=0&&(this.showHurtDisplay.string="",this.showHurtDisplay.node.active=!1)),this.startwarnhp>0&&(this.startwarnhp-=e,this.bloodwarn.width-=e*this.warnspeed,this.startwarnhp<=0&&(this.bloodwarn.width=this.curHp/this.allHp*this.hpwidth)),this.gunObject.update(e)}reduceHp(e,t,i=1){this.startWarnHpAction(e,t);let s=this.curHp;if(this.curHp-=t,this.curHp<0&&(this.curHp=0),2==r.default.getInstance.fightType){let e=s-this.curHp;if(2==this.enemyConfig.type[0]||5==this.enemyConfig.type[0]){let s=e*this.enemyConfig.type[1];if(this.curHp<=0){let e=Math.ceil(t*this.enemyConfig.type[1]);s+=e,u.Notifier.send(m.ListenID.Fight_KillExtraRewardInAmbush,e)}u.Notifier.send(m.ListenID.Fight_AmbushUpdateScore,s),u.Notifier.send(m.ListenID.Game_UpdateGold,s*r.default.getInstance.ambushGoldRatio,o.Const.GoldUse.GetKill),g.FightDamageDisplay.getInstance.showScore(e*this.enemyConfig.type[1],this.node.position.add(cc.v2(30,.5*this.getBoundingBox().height)),this.node.parent.parent,i>=2)}else 3==this.enemyConfig.type[0]?(u.Notifier.send(m.ListenID.Fight_HitWarnCar),u.Notifier.send(m.ListenID.Fight_EndGame,!1,1)):4==this.enemyConfig.type[0]&&(u.Notifier.send(m.ListenID.Fight_AddAmbushTime,this.enemyConfig.type[1]),g.FightDamageDisplay.getInstance.showTime(this.enemyConfig.type[1],this.node.position.add(cc.v2(30,.5*this.getBoundingBox().height)),this.node.parent.parent))}this.blood.width=this.curHp/this.allHp*this.hpwidth,this.hpLabel.string=d.Util.goldFormat(this.curHp),this.showHurtDisplay.node.active=!0,this.showHurtDisplay.string="-"+d.Util.goldFormat(t),this.startShowHurt=1}startWarnHpAction(e,t){let i=e>t?t:e;this.bloodwarn.width=e/this.allHp*this.hpwidth,this.startwarnhp=i*this.hpwidth/this.allHp/100}doTransform(e){e>.85&&this.enemyForm<0?(this.enemyForm=0,this.scaleNode.getComponent(cc.Animation).play(`Form${this.enemyConfig.id}${this.enemyForm}`),this.resetHitInfo(y[this.enemyForm])):e>.7&&e<=.85&&this.enemyForm<1?(this.enemyForm=1,this.scaleNode.getComponent(cc.Animation).play(`Form${this.enemyConfig.id}${this.enemyForm}`),this.resetHitInfo(y[this.enemyForm])):e>.55&&e<=.7&&this.enemyForm<2?(this.enemyForm=2,this.scaleNode.getComponent(cc.Animation).play(`Form${this.enemyConfig.id}${this.enemyForm}`),this.resetHitInfo(y[this.enemyForm])):e>.4&&e<=.55&&this.enemyForm<3?(this.enemyForm=3,this.scaleNode.getComponent(cc.Animation).play(`Form${this.enemyConfig.id}${this.enemyForm}`),this.resetHitInfo(y[this.enemyForm])):e>.25&&e<=.4&&this.enemyForm<4?(this.enemyForm=4,this.scaleNode.getComponent(cc.Animation).play(`Form${this.enemyConfig.id}${this.enemyForm}`),this.resetHitInfo(y[this.enemyForm])):e>.1&&e<=.25&&this.enemyForm<5?(this.enemyForm=5,this.scaleNode.getComponent(cc.Animation).play(`Form${this.enemyConfig.id}${this.enemyForm}`),this.resetHitInfo(y[this.enemyForm])):e<=.1&&this.enemyForm<6&&(this.enemyForm=6,this.scaleNode.getComponent(cc.Animation).play(`Form${this.enemyConfig.id}${this.enemyForm}`),this.resetHitInfo(y[this.enemyForm]))}resetHitInfo(e){this.hitOrigin1=cc.v2(e[0],e[1]),this.hitBox1?(this.hitBox1.height=e[3],this.hitBox1.width=e[2]):this.hitBox1=new cc.Size(e[2],e[3]),this.hitOrigin2=cc.v2(e[4],e[5]),this.hitBox2?(this.hitBox2.height=e[7],this.hitBox2.width=e[6]):this.hitBox2=new cc.Size(e[6],e[7]),this.tranforms(this.node.y)}beHit(e){if(this.isDead)return void console.log("bthit is dead",this.roleId);let t=this.curHp;this.reduceHp(t,e.attackNum,e.defenseArea);let i=this.curHp/this.allHp;f[this.enemyConfig.id]&&(this.doTransform(i),d.Util.showGoldEffect(null,1,cc.Vec2.ZERO,cc.v2(0,602),.1,0,o.Const.CurrencyType.Diamond)),i<.6&&this.curHp>0&&!this.playflyup&&(this.fireup&&(this.fireup.node.active=!0),this.playflyup=!0,this.fireup&&this.fireup.play()),e.defenseArea&&e.defenseArea>=2&&!this.behitDoubleHit&&this.curHp>0?(this.behitDoubleHit=!0,l.Manager.audio.playAudio(312,h.AudioType.EnemyTalk)):this.playHitAudio(i),this.curHp<=0&&!this.isDead?(this.isDead=!0,this._gameStateMachine.changeState(s.RoleState.DEAD),2!=r.default.getInstance.fightType&&c.GameVoManager.getInstance.setGold(this.enemyConfig.deadReward,o.Const.GoldUse.GetKill)):2!=this.enemyConfig.actionId[0]||this.isfirstMove||this.actionMove(this.enemyConfig.actionId[0],this.enemyConfig.actionId[1])}actionMove(e,t){if(2==e){let e=d.Util.random(0,1e3)>500?1:-1,i=r.default.getInstance.getMoveBox(),n=this.node.x+e*t;(n<i.min.x||n>i.max.x)&&(e*=-1,n=this.node.x+e*t),this.moveDir=cc.v2(e,0),n=cc.misc.clampf(n,i.min.x,i.max.x),this.moveDis=Math.abs(n-this.node.x),this._gameStateMachine.changeState(s.RoleState.MOVE)}else 1==e&&(this.moveDis=this.firstMoveDis*t,this.moveDir=this.moveDir.rotate(Math.PI),this._gameStateMachine.changeState(s.RoleState.MOVE))}firecb(){1!=this.enemyConfig.actionId[0]||this.isfirstMove||this.actionMove(this.enemyConfig.actionId[0],this.enemyConfig.actionId[1])}playHitAudio(e){this.playaudioState<=0&&e<.6&&e>=.3?(this.playaudioState=1,l.Manager.audio.playAudio(this.getAudioId(this.playaudioState),h.AudioType.EnemyTalk)):this.playaudioState<=1&&e<.3&&e>0&&(this.playaudioState=2,l.Manager.audio.playAudio(this.getAudioId(this.playaudioState),h.AudioType.EnemyTalk))}getAudioId(e){let t=d.Util.random(0,999);return 1==e?t>500?307:311:2==e?t>500?308:310:0}startAction(){this.isfirstMove=!0,this._gameStateMachine.changeState(s.RoleState.MOVE)}registerFSM(){super.registerFSM();let e=this._gameStateMachine.createState(s.RoleState.ATTACk);e.setCallbackAsMultiFuctions(()=>{this.attackEnterFunc()},e=>{this.attackUpdateFunc(e)},()=>{this.attackExitFunc()}),e.can_re_enter=!0}getBoundingBox(){let e=this.node.x,t=this.node.y,i=this.scaleNode.width*this.scaleNode.scaleX,s=this.scaleNode.height*this.scaleNode.scaleY;return this.boxRect?(this.boxRect.x=e-.5*this.boxRect.width,this.boxRect.y=t-.5*this.boxRect.height):this.boxRect=new cc.Rect(e-.5*i,t-.5*s,i,s),this.boxRect}moveEnterFunc(){this.moveSpeed=this.moveDir.mul(this.enemyConfig.moveSpeed),this.isPlane&&!this.isfirstMove&&(this.moveDir.x>0?this.scaleNode&&(this.scaleNode.angle=-15):this.scaleNode&&(this.scaleNode.angle=15)),this.enemyConfig.moveSpeed>0?this.moveDelta=this.moveDis/this.enemyConfig.moveSpeed:this.moveDelta=0}moveUpdateFunc(e){this.moveDelta-=e,this.node.position=this.node.position.add(this.moveSpeed.mul(e)),this.tranforms(this.node.y),this.moveDelta<=0&&!f[this.enemyConfig.id]&&(2==r.default.getInstance.fightType?r.default.getInstance.removeEnemy(this.roleId,this.roleTypeId):(this.isfirstMove=!1,this.scaleNode.angle=0,this._gameStateMachine.changeState(s.RoleState.ATTACk)))}moveExitFunc(){}attackEnterFunc(){this.attackDelta=this.enemyConfig.fireDelta}attackUpdateFunc(e){this.attackDelta-=e,this.attackDelta<=0&&(this.attackDelta=this.enemyConfig.fireDelta,this.attackFunc())}attackExitFunc(){}attackFunc(){this.gunObject.onFire(0,0,this.roleId)}deadEnterFunc(){this.curdeadTime=0,this.deadTime=.2;let e=this.boom.x*this.scaleNode.scaleX+this.node.x,t=this.boom.y*this.scaleNode.scaleY+this.node.y;l.Manager.audio.playAudio(309,h.AudioType.Dead),u.Notifier.send(m.ListenID.Fight_ShowEffect,0,{position:cc.v2(e,t),bronPosId:this.bronPosId,scale:this.scaleNode.scale})}deadUpdateFunc(e){this.curdeadTime+=e,this.curdeadTime>=this.deadTime&&(f[this.enemyConfig.id]&&u.Notifier.send(m.ListenID.Fight_EndGame,!0,r.default.getInstance.ambushCfg.diamond),r.default.getInstance.removeEnemy(this.roleId,this.roleTypeId))}deadExitFunc(){}},cc._RF.pop()},{"../../../ListenID":"ListenID","../../../config/Cfg":"Cfg","../../../config/Const":"Const","../../../frame/Notifier":"Notifier","../../../manager/AudioManager":"AudioManager","../../../manager/GameVoManager":"GameVoManager","../../../manager/Manager":"Manager","../../../utils/Util":"Util","../FightDamageDisplay":"FightDamageDisplay","../FightModel":"FightModel","./Gun":"Gun","./Role":"Role"}],ExtraRewardView:[function(e,t,i){"use strict";cc._RF.push(t,"4dd08l/qPhHk7j/9flOBdGb","ExtraRewardView");var s=this&&this.__decorate||function(e,t,i,s){var n,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});const n=e("../../frame/MVC"),o=e("../../manager/Manager"),a=e("../../utils/Util"),r=e("../../config/Const"),c=e("../../manager/GameVoManager"),l=e("../../frame/Notifier"),h=e("../../ListenID"),{ccclass:d,property:u}=cc._decorator;let m=(()=>{let e=class extends n.MVC.BaseView{constructor(){super(...arguments),this.rewardIcon=null,this.rewardName=null,this.btnclose=null,this.rewardNum=0,this.rewardType=0,this.getRewardType=0,this.normalIcon=null,this.shareIcon=null,this.title=null,this.isreward=!1}changeListener(e){}onOpen(e){super.onOpen(e),l.Notifier.send(h.ListenID.Guide_ShowGuide,{step:4}),l.Notifier.send(h.ListenID.ShowBanner,0),this.initNode(),this.initView(e)}onClose(){o.Manager.audio.playAudio(104),l.Notifier.send(h.ListenID.HideBanner),l.Notifier.send(h.ListenID.Guide_CloseGuide),l.Notifier.send(h.ListenID.Guide_CheckGuide),super.onClose()}initNode(){this.rewardIcon=this.node.getChildByName("rewardIcon").getComponent(cc.Sprite),this.rewardName=this.node.getChildByName("rewardName").getComponent(cc.Label),this.btnclose=this.node.getChildByName("btnClose"),this.title=this.node.getChildByName("title");let e=this.node.getChildByName("btnConfirm");this.normalIcon=cc.find("Background/icon",e),this.shareIcon=cc.find("Background/shareicon",e)}initView(e){this.isreward=!1,o.Manager.audio.playAudio(103),e&&e.rewardNum&&(this.rewardNum=e.rewardNum,this.rewardType=e.rewardType,this.getRewardType=e.GetRewardType,this.rewardName.string=a.Util.goldFormat(this.rewardNum),this.btnclose.active=this.getRewardType!=r.Const.GetRewardType.Free&&c.GameVoManager.getInstance.gameSwitchVo.tankunlock,this.normalIcon.active=!this.btnclose.active,this.shareIcon.active=!this.normalIcon.active,e.title&&1==e.title?(this.title.getChildByName("titleicon").active=!1,this.title.getChildByName("titleicon_1").active=!0):(this.title.getChildByName("titleicon").active=!0,this.title.getChildByName("titleicon_1").active=!1))}getReward(){this.isreward||(this.getRewardType!=r.Const.GetRewardType.Free&&c.GameVoManager.getInstance.gameSwitchVo.tankunlock?c.GameVoManager.getInstance.gameSwitchVo.tankunlock&&this.getRewardType==r.Const.GetRewardType.Share?(c.GameVoManager.getInstance.setDiamond(this.rewardNum,r.Const.DiamondUse.GetDefault),a.Util.showGoldEffect(null,this.rewardNum,cc.Vec2.ZERO,cc.v2(-166,602),.1,0,this.rewardType),this.isreward=!0,this.onClose()):this.getRewardType==r.Const.GetRewardType.Video&&(o.Manager.audio.playAudio(104),c.GameVoManager.getInstance.setDiamond(this.rewardNum,r.Const.DiamondUse.GetDefault),a.Util.showGoldEffect(null,this.rewardNum,cc.Vec2.ZERO,cc.v2(-166,602),.1,0,this.rewardType),this.isreward=!0,this.onClose()):(this.rewardType==r.Const.CurrencyType.Diamond?(c.GameVoManager.getInstance.setDiamond(this.rewardNum,r.Const.DiamondUse.GetDefault),a.Util.showGoldEffect(null,this.rewardNum,cc.Vec2.ZERO,cc.v2(-166,602),.1,0,this.rewardType)):console.log("this.rewardType = ",this.rewardType),this.onClose(),this.isreward=!0))}onShareGetTiems(){c.GameVoManager.getInstance.setDiamond(this.rewardNum,r.Const.DiamondUse.GetDefault),a.Util.showGoldEffect(null,this.rewardNum,cc.Vec2.ZERO,cc.v2(-166,602),.1,0,this.rewardType),this.isreward=!0,this.onClose()}};return e=s([d],e)})();i.default=m,cc._RF.pop()},{"../../ListenID":"ListenID","../../config/Const":"Const","../../frame/MVC":"MVC","../../frame/Notifier":"Notifier","../../manager/GameVoManager":"GameVoManager","../../manager/Manager":"Manager","../../utils/Util":"Util"}],FightController:[function(e,t,i){"use strict";cc._RF.push(t,"37c2fOBCFVD442hg3Suy1EI","FightController"),Object.defineProperty(i,"__esModule",{value:!0}),i.FightController=void 0;const s=e("../../ListenID"),n=e("../../frame/MVC"),o=e("../../frame/Notifier"),a=e("./FightModel"),r=e("../../frame/UIManager"),c=e("../../frame/NotifyID"),l=e("../../frame/Time"),h=e("../../manager/GameVoManager"),d=e("../../config/Const"),u=e("../../manager/Manager");i.FightController=class extends n.MVC.BaseController{constructor(){super("FightController"),this._model=a.default.getInstance,this.changeListener(!0)}reset(){}changeListener(e){o.Notifier.changeListener(e,s.ListenID.Fight_OpenView,this.onOpenView,this),o.Notifier.changeListener(e,s.ListenID.Fight_CloseView,this.onCloseView,this),o.Notifier.changeListener(e,c.NotifyID.Game_Update,this.updateModel,this),o.Notifier.changeListener(e,s.ListenID.Fight_StartGame,this.startGame,this),o.Notifier.changeListener(e,s.ListenID.Fight_EndGame,this.endGame,this),o.Notifier.changeListener(e,s.ListenID.Game_UpdateGold,this.calGold,this),o.Notifier.changeListener(e,s.ListenID.Fight_AmbushUpdateScore,this.calAmbushScore,this),o.Notifier.changeListener(e,s.ListenID.Fight_AddEnemyPrefab,this.addEnemeyPrefabById,this),o.Notifier.changeListener(e,s.ListenID.Fight_Pause,this.gamePause,this),o.Notifier.changeListener(e,s.ListenID.Fight_OpenReliveView,this.onOpenReliveView,this),o.Notifier.changeListener(e,s.ListenID.Fight_CloseReliveView,this.onCloseReliveView,this),o.Notifier.changeListener(e,s.ListenID.Fight_OpenPauseView,this.onOpenPauseView,this),o.Notifier.changeListener(e,s.ListenID.Fight_ClosePauseView,this.onClosePauseView,this),o.Notifier.changeListener(e,s.ListenID.Fight_ReliveSuccess,this.reliveSuccess,this),o.Notifier.changeListener(e,s.ListenID.Fight_BackToCompose,this.backToCompose,this),o.Notifier.changeListener(e,s.ListenID.Fight_UpdateGameScore,this.postGameScore,this),o.Notifier.changeListener(e,s.ListenID.Guide_ActionFinish,this.actionFinish,this),o.Notifier.changeListener(e,s.ListenID.Fight_openDiamonModeView,this.onOpenDiamonView,this),o.Notifier.changeListener(e,s.ListenID.Fight_loadScene,this.onOpenLoadScene,this),o.Notifier.changeListener(e,s.ListenID.Fight_loadSceneFinish,this.onCloseLoadScene,this),o.Notifier.changeListener(e,s.ListenID.Fight_OpenAmbushGuideView,this.onOpenAmbushGuideView,this)}onOpenView(e,t,i){r.UIManager.Open("ui/fight/FightUI",t,e,i)}onCloseView(){r.UIManager.Close("ui/fight/FightUI")}onOpenReliveView(e,t,i){r.UIManager.Open("ui/fight/ReliveView",t,e,i)}onCloseReliveView(){r.UIManager.Close("ui/fight/ReliveView")}onOpenResultView(e,t,i){r.UIManager.Open("ui/fight/ResultView",t,e,i)}onCloseResultView(){r.UIManager.Close("ui/fight/ResultView")}onOpenPauseView(e,t,i){r.UIManager.Open("ui/fight/PauseView",t,e,i)}onClosePauseView(){r.UIManager.Close("ui/fight/PauseView")}onOpenDiamonView(e,t,i){r.UIManager.Open("ui/fight/AmbushDiamonModeView",t,e,i)}onOpenAmbushFailView(e,t,i){r.UIManager.Open("ui/fight/DiamonModeFailView",t,e,i)}onOpenAmbushSuccessView(e,t,i){r.UIManager.Open("ui/fight/DiamonModeSuccessView",t,e,i)}onOpenLoadScene(e){r.UIManager.Open("ui/fight/loadSceneCloud",n.MVC.eTransition.Anim,n.MVC.eUILayer.Loading,e)}onCloseLoadScene(){r.UIManager.Close("ui/fight/loadSceneCloud")}onOpenAmbushGuideView(e,t,i){r.UIManager.Open("ui/fight/AmbushGuideView",t,e,i)}startDiamonMode(){}backToCompose(e){this._model.resetGame(),this._model.isFighting=!1,this._model.tankAutoMove=!1,this.onCloseView(),this._model.goldInCome=0,this._model.scoreInAmbush=0,o.Notifier.send(s.ListenID.Compose_OpenView,n.MVC.eUILayer.Panel,null,e)}startGame(){this._model.gameState=1,this._model.isFighting=!0,this._model.goldInCome=0,this._model.scoreInAmbush=0}endGame(e,t){if(this._model.isFighting=!1,this._model.gameState=2,1==this._model.fightType){let i="SUCCESS";e?(h.GameVoManager.getInstance.myUserVo.curLevel>h.GameVoManager.getInstance.myUserVo.topLevel&&(h.GameVoManager.getInstance.myUserVo.topLevel+=1,this.postGameScore(h.GameVoManager.getInstance.myUserVo.topLevel)),h.GameVoManager.getInstance.saveData()):i="FAIL",this.postGameKill(),Math.ceil(1e3*l.Time.gameTime),e?(u.Manager.audio.playAudio(108),l.Time.delay(2,()=>{o.Notifier.send(s.ListenID.Guide_OpenActionView,n.MVC.eUILayer.Guide,n.MVC.eTransition.Default,{type:1,reward:t,isWin:e})})):l.Time.delay(.5,()=>{this.onOpenResultView(n.MVC.eUILayer.Popup,null,{reward:t,isWin:e,errorcb:()=>{o.Notifier.send(s.ListenID.Rank_CloseSurpassView),o.Notifier.send(s.ListenID.Guide_CloseGuide),o.Notifier.send(s.ListenID.Compose_OpenView,n.MVC.eUILayer.Panel,null,!0),o.Notifier.send(s.ListenID.Fight_CloseView),this.onCloseResultView()}})})}else e?(u.Manager.audio.playAudio(108),l.Time.delay(1,()=>{this.onOpenAmbushSuccessView(n.MVC.eUILayer.Popup,n.MVC.eTransition.EaseScale,t)})):(Math.ceil(1e3*l.Time.gameTime),l.Time.delay(1,()=>{this.onOpenAmbushFailView(n.MVC.eUILayer.Popup,n.MVC.eTransition.EaseScale)}))}actionFinish(e){1==e.type&&this.onOpenResultView(n.MVC.eUILayer.Popup,null,{reward:e.reward,isWin:e.isWin,errorcb:()=>{o.Notifier.send(s.ListenID.Rank_CloseSurpassView),o.Notifier.send(s.ListenID.Guide_CloseGuide),o.Notifier.send(s.ListenID.Compose_OpenView,n.MVC.eUILayer.Panel,null,!0),o.Notifier.send(s.ListenID.Fight_CloseView),this.onCloseResultView()}})}postGameScore(e){let t={avatarUrl:h.GameVoManager.getInstance.myUserVo.avatarUrl,nickName:h.GameVoManager.getInstance.myUserVo.nickName};h.GameVoManager.getInstance.myUserVo.topLevel,JSON.stringify(t)}postGameKill(){let e={avatarUrl:h.GameVoManager.getInstance.myUserVo.avatarUrl,nickName:h.GameVoManager.getInstance.myUserVo.nickName};h.GameVoManager.getInstance.myUserVo.killNum,JSON.stringify(e)}updateModel(e){this._model.update(e)}addEnemeyPrefabById(e,t){this._model.addMonsterPrefabByType(e,t)}gamePause(e){this._model.gamePause(e)}reliveSuccess(){this._model.resetMainRole()}calGold(e,t){t==d.Const.GoldUse.GetKill&&(this._model.goldInCome+=e,2==this._model.fightType&&o.Notifier.send(s.ListenID.Fight_UpdateGold,1))}calAmbushScore(e){this._model.scoreInAmbush+=Math.ceil(e),2==this._model.fightType&&o.Notifier.send(s.ListenID.Fight_UpdateGold,2)}},cc._RF.pop()},{"../../ListenID":"ListenID","../../config/Const":"Const","../../frame/MVC":"MVC","../../frame/Notifier":"Notifier","../../frame/NotifyID":"NotifyID","../../frame/Time":"Time","../../frame/UIManager":"UIManager","../../manager/GameVoManager":"GameVoManager","../../manager/Manager":"Manager","./FightModel":"FightModel"}],FightDamageDisplay:[function(e,t,i){"use strict";cc._RF.push(t,"71574RyK7dOq7ZFOQgsaleO","FightDamageDisplay"),Object.defineProperty(i,"__esModule",{value:!0}),i.FightDamageDisplay=void 0;const s=e("../../manager/Manager");class n{constructor(){this.hurtCountList={},this.hurtpos=100,this.vec=cc.v2(0,100),this._objectPool=new cc.NodePool,this._timePool=new cc.NodePool,this._scorePool=new cc.NodePool}static get getInstance(){return null==n._instance&&(n._instance=new n),n._instance}resetCount(){this.hurtCountList={}}showHurt(e,t,i,n,o=!1){let a=this._objectPool.get();a?this._showHurt(a,e,t,i,n,o):s.Manager.loader.loadPrefab("ui/fight/hurt").then(s=>{this._showHurt(s,e,t,i,n,o)})}_showHurt(e,t,i,s,n,o=!1){this.hurtCountList[n]||(this.hurtCountList[n]=0),this.hurtCountList[n]+=1,this.hurtCountList[n]>7&&(this.hurtCountList[n]=7),e.setParent(s),e.setPosition(i),e.y+=25*(this.hurtCountList[n]-1),e.color=t>=0?cc.Color.WHITE.fromHEX("#8fd900"):cc.Color.WHITE.fromHEX("#e25744");let a=1;if(e.opacity=255,e.scale=.1,o){e.getComponent(cc.Label).string=`#${Math.abs(t)}`,e.color=cc.Color.WHITE.fromHEX("#ff9921"),a=2;let i=cc.moveBy(.3,this.vec),s=cc.scaleTo(.2,a),o=cc.spawn(i,s),r=cc.fadeOut(.3),c=cc.scaleTo(.2,1.7);cc.tween(e).then(cc.sequence(o,c,r,cc.callFunc(()=>{this.hurtCountList[n]--,this.hurtCountList[n]<0&&(this.hurtCountList[n]=0),this._objectPool.put(e)}))).start()}else{e.getComponent(cc.Label).string=`${t}`;let i=cc.moveBy(.4,this.vec),s=cc.scaleTo(.4,a).easing(cc.easeOut(3)),o=cc.spawn(i,s),r=cc.fadeOut(.3);cc.tween(e).then(cc.sequence(o,r,cc.callFunc(()=>{this.hurtCountList[n]--,this.hurtCountList[n]<0&&(this.hurtCountList[n]=0),this._objectPool.put(e)}))).start()}}showMiss(e,t){let i=this._objectPool.get();i?this._showMiss(i,e,t):s.Manager.loader.loadPrefab("ui/fight/hurt").then(i=>{this._showMiss(i,e,t)})}_showMiss(e,t,i){e.setParent(i),e.setPosition(t);e.opacity=255,e.scale=.1,e.getComponent(cc.Label).string="$";let s=cc.moveBy(.5,this.vec),n=cc.scaleTo(.5,1).easing(cc.easeOut(3)),o=cc.spawn(s,n),a=cc.spawn(cc.scaleTo(.3,.1),cc.fadeOut(.3));cc.tween(e).then(cc.sequence(o,a,cc.callFunc(()=>{this._objectPool.put(e)}))).start()}showTime(e,t,i){let n=this._timePool.get();n?this._showTime(n,Math.ceil(e),t,i):s.Manager.loader.loadPrefab("ui/fight/timehurt").then(s=>{this._showTime(s,Math.ceil(e),t,i)})}showScore(e,t,i,n=!1){let o=this._scorePool.get();o?this._showScore(o,Math.ceil(e),t,i,n):s.Manager.loader.loadPrefab("ui/fight/scorehurt").then(s=>{this._showScore(s,Math.ceil(e),t,i,n)})}_showScore(e,t,i,s,n=!1){e.setParent(s),e.setPosition(i);e.opacity=255,e.scale=.1;let o=`+${t}f`;e.getChildByName("label").getComponent(cc.Label).string=o,e.getChildByName("icon").active=n;let a=cc.moveBy(.5,this.vec),r=cc.scaleTo(.5,1).easing(cc.easeOut(3)),c=cc.spawn(a,r),l=cc.spawn(cc.scaleTo(.3,.1),cc.fadeOut(.3));cc.tween(e).then(cc.sequence(c,cc.delayTime(.5),l,cc.callFunc(()=>{this._scorePool.put(e)}))).start()}_showTime(e,t,i,s){e.setParent(s),e.setPosition(i);e.opacity=255,e.scale=.1,e.getComponent(cc.Label).string=`+${t}s`;let n=cc.moveBy(.5,this.vec),o=cc.scaleTo(.5,1).easing(cc.easeOut(3)),a=cc.spawn(n,o),r=cc.spawn(cc.scaleTo(.3,.1),cc.fadeOut(.3));cc.tween(e).then(cc.sequence(a,cc.delayTime(.5),r,cc.callFunc(()=>{this._timePool.put(e)}))).start()}}i.FightDamageDisplay=n,cc._RF.pop()},{"../../manager/Manager":"Manager"}],FightModel:[function(e,t,i){"use strict";cc._RF.push(t,"ea9f241sG9BvbdyWIuRUDPS","FightModel"),Object.defineProperty(i,"__esModule",{value:!0});const s=e("../../frame/MVC"),n=e("./component/MainRole"),o=e("../../manager/GameVoManager"),a=e("./component/Enemy"),r=e("../../frame/collections/ObjectPool"),c=e("../../config/Const"),l=e("../../config/Cfg"),h=e("../../frame/Notifier"),d=e("../../ListenID"),u=e("../../alert/AlertManager"),m=e("../../utils/Util"),g=e("../../CallID"),p=e("../../manager/Manager");let f=function(){var e=1;return function(){return e+=1}}(),y=[{},{bronPosInfo:[[cc.v2(-471,160),cc.v2(1,0),1],[cc.v2(-256,50),cc.v2(1,0),1],[cc.v2(355,50),cc.v2(-1,0),1],[cc.v2(473,120),cc.v2(-1,0),1],[cc.v2(-548,-66),cc.v2(1,0),2],[cc.v2(574,-106),cc.v2(-1,0),2],[cc.v2(574,-106),cc.v2(-1,.2),2],[cc.v2(-548,-66),cc.v2(1,.1),2],[cc.v2(434,418),cc.v2(-1,-.5),2],[cc.v2(750,14),cc.v2(1,0),2],[cc.v2(1390,60),cc.v2(-1,0),1],[cc.v2(1588,60),cc.v2(1,0),1],[cc.v2(1937,-29),cc.v2(-1,0),2],[cc.v2(784,-128),cc.v2(1,0),3],[cc.v2(2292,-126),cc.v2(-1,0),3],[cc.v2(2214,126),cc.v2(1,0),2],[cc.v2(2462,21),cc.v2(1,0),2],[cc.v2(3404,90),cc.v2(-1,0),1],[cc.v2(3336,-25),cc.v2(-1,0),2],[cc.v2(2037,-126),cc.v2(1,0),3],[cc.v2(3675,-207),cc.v2(-1,0),3],[cc.v2(-478,333),cc.v2(1,0),1],[cc.v2(-350,534),cc.v2(1,-.4),3],[cc.v2(200,560),cc.v2(0,-1),3],[cc.v2(1470,500),cc.v2(-1,-1),1],[cc.v2(687,205),cc.v2(1,0),2],[cc.v2(1242,615),cc.v2(1,-.5),2],[cc.v2(2425,473),cc.v2(1,-1),3],[cc.v2(2425,626),cc.v2(1,-.5),3],[cc.v2(3651,376),cc.v2(-1,0),3]],blockInfo:[cc.rect(449,-215,360,200),cc.rect(240,0,520,90),cc.rect(-720,-171,310,110),cc.rect(-689,-4,490,150),cc.rect(1270,30,360,60),cc.rect(1941,-45,590,135),cc.rect(2809,12,800,50),cc.rect(3270,-50,800,300)]},{bronPosInfo:[[cc.v2(-424,190),cc.v2(1,0),1],[cc.v2(-267,72),cc.v2(1,0),1],[cc.v2(248,72),cc.v2(-1,0),1],[cc.v2(453,173),cc.v2(-1,0),1],[cc.v2(493,-49),cc.v2(-1,0),2],[cc.v2(-612,-190),cc.v2(1,0),3],[cc.v2(1030,171),cc.v2(1,0),1],[cc.v2(1956,108),cc.v2(-1,0),1],[cc.v2(894,-47),cc.v2(1,.1),2],[cc.v2(1903,-41),cc.v2(-1,0),2],[cc.v2(885,-216),cc.v2(1,0),3],[cc.v2(1848,-242),cc.v2(-1,.2),3],[cc.v2(2859,168),cc.v2(-1,0),1],[cc.v2(2859,168),cc.v2(1,0),1],[cc.v2(2384,114),cc.v2(1,-.3),2],[cc.v2(2450,-69),cc.v2(1,0),2],[cc.v2(3373,-252),cc.v2(-1,0),3],[cc.v2(2367,-219),cc.v2(1,0),3],[cc.v2(-379,749),cc.v2(1,-1),1],[cc.v2(1791,749),cc.v2(-1,-1),1],[cc.v2(2512,749),cc.v2(1,-1),1]],blockInfo:[cc.rect(700,30,500,140),cc.rect(184,33,1080,130),cc.rect(2085,45,200,130),cc.rect(456,-107,420,100),cc.rect(1807,-144,700,150),cc.rect(-719,-360,340,120),cc.rect(3197,-416,400,140)]},{bronPosInfo:[[cc.v2(172,12),cc.v2(-1,0),1],[cc.v2(-176,10),cc.v2(-1,0),1],[cc.v2(-491,155),cc.v2(1,0),1],[cc.v2(610,134),cc.v2(-1,0),1],[cc.v2(-499,-141),cc.v2(1,0),2],[cc.v2(556,-255),cc.v2(-1,0),2],[cc.v2(-454,759),cc.v2(1,-3),2],[cc.v2(691,279),cc.v2(-1,.1),1],[cc.v2(507,725),cc.v2(-1,-1),1]],blockInfo:[cc.rect(-250,-48,220,50),cc.rect(113,-36,60,60),cc.rect(198,-36,130,80),cc.rect(-719,128,250,100)]},{bronPosInfo:[[cc.v2(-270,150),cc.v2(1,0),1],[cc.v2(0,90),cc.v2(1,0),1],[cc.v2(-364,85),cc.v2(1,-.1),2],[cc.v2(263,36),cc.v2(-1,0),2],[cc.v2(-553,-105),cc.v2(1,.1),3],[cc.v2(-412,408),cc.v2(1,-.1),1],[cc.v2(437,295),cc.v2(-1,0),1]],blockInfo:[cc.rect(-302,81,280,50),cc.rect(183,-41,150,80),cc.rect(-250,-15,120,60),cc.rect(-576,43,200,60)]},{bronPosInfo:[[cc.v2(-486,36),cc.v2(1,-.1),1],[cc.v2(-37,91),cc.v2(1,0),1],[cc.v2(245,10),cc.v2(-1,0),2],[cc.v2(457,-139),cc.v2(-1,0),3],[cc.v2(-440,-270),cc.v2(1,0),3],[cc.v2(495,244),cc.v2(-1,.1),1],[cc.v2(-439,580),cc.v2(1,-.5),1]],blockInfo:[cc.rect(-124,-21,120,80),cc.rect(-673,-8,200,100),cc.rect(163,-60,300,90)]},{bronPosInfo:[[cc.v2(-420,102),cc.v2(1,-.5),2],[cc.v2(-152,77),cc.v2(1,0),1],[cc.v2(332,77),cc.v2(-1,0),1],[cc.v2(-490,-158),cc.v2(1,0),3],[cc.v2(438,-50),cc.v2(-1,0),3],[cc.v2(-442,534),cc.v2(1,-.2),3],[cc.v2(283,644),cc.v2(0,-1),3]],blockInfo:[cc.rect(209,0,360,90),cc.rect(-176,0,100,90),cc.rect(-720,0,300,90)]},{bronPosInfo:[[cc.v2(59,122),cc.v2(-1,0),1],[cc.v2(180,122),cc.v2(1,0),1],[cc.v2(-406,10),cc.v2(1,0),2],[cc.v2(498,-40),cc.v2(-1,0),2],[cc.v2(-523,-206),cc.v2(1,0),3],[cc.v2(-377,483),cc.v2(1,0),1],[cc.v2(360,332),cc.v2(-1,0),1]],blockInfo:[cc.rect(-139,52,400,80),cc.rect(-636,-45,300,80),cc.rect(425,-98,300,100)]},{bronPosInfo:[[cc.v2(-36,151),cc.v2(-1,0),1],[cc.v2(259,93),cc.v2(1,0),1],[cc.v2(-362,27),cc.v2(1,0),2],[cc.v2(544,-111),cc.v2(-1,0),2],[cc.v2(-488,-233),cc.v2(1,0),3],[cc.v2(-415,378),cc.v2(1,0),1],[cc.v2(334,272),cc.v2(-1,0),1],[cc.v2(250,0),cc.v2(0,0),3],[cc.v2(-150,0),cc.v2(0,0),3],[cc.v2(0,0),cc.v2(0,0),3]],blockInfo:[cc.rect(-104,86,370,100),cc.rect(-658,-5,370,100),cc.rect(423,54,300,100),cc.rect(465,-158,250,100)]},{bronPosInfo:[[cc.v2(-359,77),cc.v2(1,0),1],[cc.v2(446,77),cc.v2(-1,0),1],[cc.v2(-547,-26),cc.v2(1,0),2],[cc.v2(598,-26),cc.v2(-1,0),2],[cc.v2(-552,-157),cc.v2(1,0),3],[cc.v2(552,-157),cc.v2(-1,0),3],[cc.v2(0,-26),cc.v2(-1,0),2]],blockInfo:[cc.rect(-718,-222,200,400),cc.rect(-541,81,200,100),cc.rect(558,-51,200,300),cc.rect(379,64,150,300)]}],C=[{paoposx:0,fireEffectInfo:[0,237,1]},{paoposx:0,fireEffectInfo:[2.5,245,1]},{paoposx:0,fireEffectInfo:[5.9,4,1.5]},{paoposx:11,fireEffectInfo:[-5,266,1]},{paoposx:0,fireEffectInfo:[-6,167,1]},{paoposx:0,fireEffectInfo:[-6,250,1]},{paoposx:0,fireEffectInfo:[-6,258,1]},{paoposx:-8,fireEffectInfo:[-6,258,1]},{paoposx:0,fireEffectInfo:[-9,276,1]},{paoposx:10,fireEffectInfo:[-6,261,1]},{paoposx:0,fireEffectInfo:[-3,266,1]},{paoposx:0,fireEffectInfo:[-4,257,1]},{paoposx:0,fireEffectInfo:[-5,252,1]},{paoposx:0,fireEffectInfo:[-5,252,1]},{paoposx:0,fireEffectInfo:[-3,282,1]},{paoposx:-10,fireEffectInfo:[-9,282,1]},{paoposx:0,fireEffectInfo:[-4,268,1]},{paoposx:0,fireEffectInfo:[-10,265,1]},{paoposx:0,fireEffectInfo:[-6,271,1]},{paoposx:0,fireEffectInfo:[-4,265,1]},{paoposx:0,fireEffectInfo:[-5,263,1]},{paoposx:0,fireEffectInfo:[-5,263,1]},{paoposx:0,fireEffectInfo:[-4,227,1]},{paoposx:0,fireEffectInfo:[-9,280,1]},{paoposx:0,fireEffectInfo:[-2,273,1]},{paoposx:8,fireEffectInfo:[-8,290,1]},{paoposx:7,fireEffectInfo:[-10,288,1]},{paoposx:0,fireEffectInfo:[-8,279,1]},{paoposx:0,fireEffectInfo:[-11,264,1]},{paoposx:0,fireEffectInfo:[-10,265,1]},{paoposx:10,fireEffectInfo:[-11,245,1]},{paoposx:4,fireEffectInfo:[-6,271,1]},{paoposx:10,fireEffectInfo:[-5,266,1]},{paoposx:0,fireEffectInfo:[-6,281,1]},{paoposx:0,fireEffectInfo:[-3,270,1]},{paoposx:0,fireEffectInfo:[-1,249,1]},{paoposx:0,fireEffectInfo:[-3,290,1]},{paoposx:10,fireEffectInfo:[-3,265,1]},{paoposx:0,fireEffectInfo:[-3,265,1]},{paoposx:0,fireEffectInfo:[-4,271,1]},{paoposx:0,fireEffectInfo:[-5,262,1]},{paoposx:2,fireEffectInfo:[-5,306,1]},{paoposx:-10,fireEffectInfo:[-3,303,1]},{paoposx:0,fireEffectInfo:[-6,121,1]},{paoposx:0,fireEffectInfo:[-6,282,1]},{paoposx:0,fireEffectInfo:[-3,288,1]},{paoposx:0,fireEffectInfo:[0,256,1]},{paoposx:0,fireEffectInfo:[-4,254,1]},{paoposx:10,fireEffectInfo:[-2,278,1]},{paoposx:10,fireEffectInfo:[-2,278,1]}],_=(()=>{class e extends s.MVC.BaseModel{constructor(){super(),this.moveSize=null,this.monsterNodePool=null,this.gameState=0,this.isPause=0,this.isFighting=!1,this.goldInCome=0,this.scoreInAmbush=0,this._enemyList=cc.js.createMap(),this.fightType=1,this._killNum=0,this.stepData=null,this.curStep=0,this.allStep=0,this.curStepMonNum=0,this.curStepRemnantMon=0,this.allEnemy=0,this.curLevel=0,this.addEnemyDelta=0,this.startAddEnemy=!1,this.curSceneId=1,this.curStepInfo=null,this.allCfgLevel=0,this.ambushRoad=[],this.ambushPoolId=0,this.ambushTargetScore=1,this.ambushCfg=null,this.ambushWeight=0,this.ambushMonBronNumList={},this.curAmbushTime=0,this.waitAmbushList={},this.ambushGoldRatio=1,this.ambushFirstBron=!1,this.curAmbushHitTank=0,this.autoMoveSpeed=200,this.cameraOffset=cc.Vec2.ZERO,this.tankAutoMove=!1,this.originPos=cc.Vec2.ZERO,this.moninfolist=[],this.ambushPool=[],this.panelinfolist=[],this.tankinfolist=[],this.searchTime=.1,this.targetId=-1,this.targetArea=0,this.curEnemyNum=0,this.killEnemyNumber=0,this.boomNodePool=null,this.boomEffectNode=null,null==e._instance&&(e._instance=this),this.moveSize=new cc.Rect(-.5*c.Const.designWidth,-.5*c.Const.designHeight,c.Const.designWidth,c.Const.designHeight),this.mainRole=new n.default,this.isFighting=!1,this.isPause=0,this.attackVoList=[],this.enemyPool=new r.ObjectPool(function(){return new a.default});let t=l.Cfg.Barrier.filter({});this.allCfgLevel=t.length,this.shootPos=cc.Vec2.ZERO,this.monPrefabs=[],this.monsterNodePool=[]}reset(){}static get getInstance(){return null==e._instance&&(e._instance=new e),e._instance}set killNum(e){if(0==o.GameVoManager.getInstance.myUserVo.topLevel&&h.Notifier.send(d.ListenID.Guide_NewGuideStepFinish,e),this._killNum!=e&&(this._killNum=e,this.isFighting)){if(this.curStepRemnantMon-=1,this.curStepRemnantMon<=0)if(this.curStep++,this.curStep>this.allStep)1==this.levelCfg.reward[0]?o.GameVoManager.getInstance.setGold(this.levelCfg.reward[1],c.Const.GoldUse.GetPass):2==this.levelCfg.reward[0]?o.GameVoManager.getInstance.setDiamond(this.levelCfg.reward[1],c.Const.GoldUse.GetPass):3==this.levelCfg.reward[0]&&(o.GameVoManager.getInstance.setGold(this.levelCfg.reward[1],c.Const.GoldUse.GetPass),o.GameVoManager.getInstance.setDiamond(this.levelCfg.reward[2],c.Const.DiamondUse.GetPass)),h.Notifier.send(d.ListenID.Fight_EndGame,!0,this.levelCfg.reward);else{let e=this.stepData[this.curStep-1],t=e[e.length-1];h.Notifier.send(d.ListenID.Fight_StartNextStep,{curStep:this.curStep,allStep:this.allStep,partId:t})}h.Notifier.send(d.ListenID.Fight_KillNumChange,this._killNum,this.allEnemy),o.GameVoManager.getInstance.myUserVo.isKillHalf=this._killNum/this.allEnemy>.5}}checkEmptyPos(){for(let e=0;e<this.ambushRoad.length;e++)if(!this.ambushRoad[e]){let t=this.tankinfolist.pop();t||(t=this.popEnemyInAmbush()),this.ambushRoad[e]=t[1];let i=1==t[2]?0:1,s=this.ambushFirstBron?this.curAmbushTime:t[6]/1e3+this.curAmbushTime;this.waitAmbushList[e]={bronTime:s,bronPos:2*e+i,monInfo:t},this.addEnemyDelta=1024}this.ambushFirstBron=!1}getMoveBox(){let e=this.moveSize;return{min:cc.v2(e.xMin,e.yMin),max:cc.v2(e.xMax,e.yMax)}}initLevelCfg(e){let t=l.Cfg.Barrier.get(e);if(t)o.GameVoManager.getInstance.myUserVo.curLevel=t.id,this.curLevel=t.id;else{let i=e%5;i+=this.allCfgLevel-4,t=l.Cfg.Barrier.get(i),o.GameVoManager.getInstance.myUserVo.curLevel=e,this.curLevel=e}this.levelCfg=t,this.stepData=this.levelCfg.bronInfo;let i=0;for(let e=0;e<this.stepData.length;e++){i+=this.stepData[e].length-2}this.allStep=this.levelCfg.bronInfo.length,this.curStep=1,this.curSceneId=t.sceneId,this.allEnemy=i,this._killNum=0,this.killEnemyNumber=0;let s=this.stepData[this.curStep-1],n=s[s.length-2];this.cameraOffset.x=(n-1)*c.Const.designWidth*2,this.originPos.x=this.cameraOffset.x,this.moveSize.x=-.5*c.Const.designWidth+this.cameraOffset.x}initAmbushCfg(e){let t=l.Cfg.AmbushBarrier.get(e);t||(t=l.Cfg.AmbushBarrier.get(o.GameVoManager.getInstance.myUserVo.ambushBarrierLength)),this.curLevel=t.id,this.curSceneId=9,this._killNum=0,this.killEnemyNumber=0,this.allEnemy=999999,this.cameraOffset.x=0,this.curAmbushHitTank=0,this.originPos.x=this.cameraOffset.x,this.moveSize.x=-.5*c.Const.designWidth+this.cameraOffset.x;let i=y[9],s=Math.floor(i.bronPosInfo.length/2);this.ambushRoad=[];for(let e=0;e<s;e++)this.ambushRoad[e]=0;let n=m.Util.random(0,t.poolid.length-1);this.ambushPoolId=t.poolid[n],this.ambushTargetScore=t.integral||1,this.ambushPool=l.Cfg.AmbushEnemyPool.get(this.ambushPoolId).enemyInfo;let a=this.ambushPool.length;this.ambushWeight=0;for(let e=0;e<a;e++)this.ambushWeight+=this.ambushPool[e][0];this.ambushMonBronNumList={},this.ambushCfg=t,this.waitAmbushList={},this.ambushGoldRatio=this.ambushCfg.gold,this.ambushFirstBron=!0}randomLevelInfo(){if(this.tankAutoMove=!1,1==this.fightType){let e=this.stepData[this.curStep-1],t=e[e.length-2];this.cameraOffset.x=(t-1)*c.Const.designWidth*2,this.originPos.x=this.cameraOffset.x,this.moveSize.x=-.5*c.Const.designWidth+this.cameraOffset.x}this.randomMonInfo()}getOriginPosByStep(e){let t=cc.Vec2.ZERO,i=this.stepData[e-1];if(i){let e=i[i.length-2];t.x=(e-1)*c.Const.designWidth*2}return t}randomMonInfo(){if(1==this.fightType){let e=this.stepData[this.curStep-1];this.curStepInfo=e,this.addEnemyDelta=1,this.curEnemyNum=0,this.curStepMonNum=e.length-2,this.curStepRemnantMon=this.curStepMonNum;let t=e[e.length-1],i=l.Cfg.EnemyPool.get(t);if(i)if(this.moninfolist=[],0==o.GameVoManager.getInstance.myUserVo.topLevel)this.moninfolist=c.Const.guideEnemyInfo;else{let t=m.Util.getRandomSDiff(0,i.enemyInfo.length-1,e.length-2,!0);for(let e=0;e<t.length;e++)this.moninfolist[e]=i.enemyInfo[t[e]]}else u.AlertManager.showNormalTipsOnce("\u654c\u65b9\u5bf9\u8c61\u6c60\u4e3a\u7a7a\uff0c\u65e0\u6cd5\u4ea7\u751f\u602a\u7269");this.startAddEnemy=!!i}else if(2==this.fightType){this.tankinfolist=[],this.panelinfolist=[],this.addEnemyDelta=.2;let e=this.ambushRoad.length;for(let t=0;t<e;t++){let e=this.popEnemyInAmbush();-1!=l.Cfg.Enemy.get(e[1]).enemyRes.indexOf("tank")?this.tankinfolist.push(e):this.panelinfolist.push(e)}this.startAddEnemy=!0}}popEnemyInAmbush(){let e=m.Util.random(1,this.ambushWeight+1),t=this.ambushPool.length,i=-1,s=0,n=[];for(let o=0;o<t;o++){let t=this.ambushPool[o];if(this.ambushMonBronNumList[t[1]]||(this.ambushMonBronNumList[t[1]]=0),!(this.ambushMonBronNumList[t[1]]>=t[4]||this.scoreInAmbush/this.ambushTargetScore*100<t[5])){if(e<=t[0]){i=o;break}e-=t[0],n.push({index:o,weight:t[0]}),s+=t[0]}}if(-1==i){e=m.Util.random(1,s+1);for(let t=0;t<n.length;t++){let s=n[t];if(e<=s.weight){i=s.index;break}e-=s.weight}}return-1==i&&(i=0),this.ambushMonBronNumList[this.ambushPool[i][1]]++,this.ambushPool[i]}resetGame(){this.startAddEnemy=!1,this.curEnemyNum=0,this.curStepMonNum=0,this.waitAmbushList={};for(const e in this._enemyList){let t=this._enemyList[e];t.node.destroy(),t.node=null,this.enemyPool.push(t),delete this._enemyList[e]}}setMainRoleInfo(e){e.useTankId=o.GameVoManager.getInstance.myUserVo.useTankId,this.mainRole.init(0,e)}getMainRoleHp(){return[this.mainRole.curHp,this.mainRole.allHp]}getMainRoleCurBullet(){return this.mainRole.bulltNum}getCurNoVisibleEnemyInfo(){let e=[];if(!this.visibleRect){let e=h.Notifier.call(g.CallID.Setting_GetRealDesignSize);this.visibleRect=new cc.Rect(0,0,e.width,e.height)}this.visibleRect.x=this.shootPos.x-.5*this.visibleRect.width,this.visibleRect.y=this.shootPos.y-.5*this.visibleRect.height;for(const t in this._enemyList){let i=this._enemyList[t];!i||i.isDead||this.visibleRect.intersects(i.getBoundingBox())||e.push([i.node.x-this.shootPos.x,i.node.y-this.shootPos.y,i.node.x>this.shootPos.x])}return e}update(e){if(!(this.isPause>0)&&this.isFighting){this.handlerAttack(),this.searchTime-=e,this.searchTime<=0&&(this.findTarget(),this.searchTime=.1),this.mainRole&&this.mainRole.isReady&&this.mainRole.update(e);for(const t in this._enemyList){this._enemyList[t].update(e)}}}addAttackVo(e){this.attackVoList.push(e)}getParentPanelByBronId(e){let t=y[this.curSceneId].bronPosInfo[e];return t?t[2]:1}handlerAttack(){if(this.attackVoList.length>0){let e=this.attackVoList.pop();if(0!=e.defenseId){if(this._enemyList[e.defenseId]){this._enemyList[e.defenseId].beHit(e)}}else this.mainRole.beHit(e)}}getUserTankIconRes(){return"pao_tank"+o.GameVoManager.getInstance.myUserVo.useTankId}getUserTankPaoPosX(){let e=0;return C[o.GameVoManager.getInstance.myUserVo.useTankId-1]&&(e=C[o.GameVoManager.getInstance.myUserVo.useTankId-1].paoposx),e}getUserTankFireEffect(){let e=[0,0,1];return C[o.GameVoManager.getInstance.myUserVo.useTankId-1]&&(e=C[o.GameVoManager.getInstance.myUserVo.useTankId-1].fireEffectInfo),e}calShootPos(e){this.shootPos=e}findTarget(){let e=!1,t=!1,i=y[this.curSceneId].blockInfo;for(let e=0;e<i.length;e++)if(i[e].contains(this.shootPos)){t=!0;break}for(const i in this._enemyList){let s=this._enemyList[i];if(!s.isDead)if(s.hitDoubleBox&&s.hitDoubleBox.contains(this.shootPos)){if(!t||s.isPlane){let t=s.canHeadShoot()?2:1,i=s.getRoleId();t==this.targetArea&&this.targetId==i||(this._enemyList[this.targetId]&&this._enemyList[this.targetId].beSelected(!1),s.beSelected(!0),h.Notifier.send(d.ListenID.Fight_TargetChange,t,i)),this.targetArea=t,this.targetId=i,this.mainRole.setAttackTarget(i,t),e=!0;break}}else if(s.hitNormalBox&&s.hitNormalBox.contains(this.shootPos)&&(!t||s.isPlane)){let t=1,i=s.getRoleId();t==this.targetArea&&this.targetId==i||(this._enemyList[this.targetId]&&this._enemyList[this.targetId].beSelected(!1),s.beSelected(!0),h.Notifier.send(d.ListenID.Fight_TargetChange,t,i)),this.targetArea=t,this.targetId=i,this.mainRole.setAttackTarget(i,t),e=!0;break}}if(!e){let e=0,t=-1;e==this.targetArea&&this.targetId==t||(this._enemyList[this.targetId]&&this._enemyList[this.targetId].beSelected(!1),h.Notifier.send(d.ListenID.Fight_TargetChange,e,t)),this.targetArea=e,this.targetId=t,this.mainRole.setAttackTarget(t,e)}}checkisHit(e){let t=[];for(const i in this._enemyList){let s=this._enemyList[i];if(!s.isDead){if(s.hitDoubleBox&&s.hitDoubleBox.contains(e)){let e=s.canHeadShoot()?2:1,i=s.getRoleId();t[0]=e,t[1]=i;break}if(s.hitNormalBox&&s.hitNormalBox.contains(e)){let e=1,i=s.getRoleId();t[0]=e,t[1]=i;break}}}return t}isLockTarget(){return-1!=this.mainRole.targetId}addMonsterPrefabByType(e,t){this.monPrefabs[e]=cc.instantiate(t)}popEnemyNode(e=1,t){this.monsterNodePool[e]||(this.monsterNodePool[e]=new cc.NodePool);let i=this.monsterNodePool[e].get();if(i)t&&t(i);else if(this.monPrefabs[e])i=cc.instantiate(this.monPrefabs[e]),t&&t(i);else{let i=l.Cfg.Enemy.get(e);if(!i)return null;p.Manager.loader.loadPrefab("enemy/"+i.enemyRes).then(i=>{this.monPrefabs[e]=i,t&&t(cc.instantiate(this.monPrefabs[e]))})}}pushMonsterNode(e,t){this.monsterNodePool[e]||(this.monsterNodePool[e]=new cc.NodePool),this.monsterNodePool[e].put(t)}getMonsterInfo(){let e=this.curStepInfo;if(!e)return null;let t=null,i=null;return this.curEnemyNum<e.length-2?(t=e[this.curEnemyNum],[(i=this.moninfolist[this.curEnemyNum])[0],i[1],i[2],t[0],t[1],t[2]]):null}addEnemy(e=-1,t){if(1==this.fightType){let e=this.getMonsterInfo();if(e){let i=f(),s=this.enemyPool.pop(),n=y[this.curSceneId].bronPosInfo,o=n[e[1]][0],a=n[e[1]][1];this.popEnemyNode(e[0],n=>{let r={roleId:i,roleTypeId:e[0],node:n,bronPos:o,movedir:a,movedis:e[2],bronPosId:e[1],hp:e[4],attackNum:e[5]};s.init(i,r),this._enemyList[i]=s,this.curEnemyNum++,this.curEnemyNum>=this.curStepInfo.length-1?this.startAddEnemy=!1:this.addEnemyDelta=e[3],t(s)})}else this.startAddEnemy=!1,t(null)}else if(2==this.fightType)if(e>=0){let i=this.waitAmbushList[e];if(i||1001!=e||(i={bronTime:0,bronPos:2*this.ambushRoad.length,monInfo:[0,1001,1,720,99,0,0]},console.log("moninfo.bronPos",i.bronPos)),i){let s=f(),n=this.enemyPool.pop(),a=y[this.curSceneId].bronPosInfo,r=a[i.bronPos][0],c=a[i.bronPos][1],h=l.Cfg.AmbushEnemy.get(o.GameVoManager.getInstance.myUserVo.useTankId),d=l.Cfg.Enemy.get(i.monInfo[1]),u=0;2==d.type[0]?u=h.lv1CartLife:5==d.type[0]?u=h.lv2CartLife:3==d.type[0]?u=h.medicalCarLife:4==d.type[0]?u=h.specialCarLife:1==d.type[0]&&(u=h.heavyTankLife),this.popEnemyNode(i.monInfo[1],o=>{let a={roleId:s,roleTypeId:i.monInfo[1],node:o,bronPos:r,movedir:c,movedis:i.monInfo[3],bronPosId:i.bronPos,hp:u,attackNum:0,roadIndex:e};return n.init(s,a),this._enemyList[s]=n,this.curEnemyNum++,t(n),n}),delete this.waitAmbushList[e]}}else console.error("add mon error",e)}removeEnemy(e,t){let i=this._enemyList[e];i?(this.killEnemyNumber++,this.monsterNodePool[t].put(i.node),2==this.fightType?(this.ambushRoad[i.roadIndex]=0,this.checkEmptyPos()):this.killNum=this.killEnemyNumber,i.node=null,this.enemyPool.push(i),delete this._enemyList[e],o.GameVoManager.getInstance.myUserVo.killNum++):console.error("remove fail monsterid",e)}gamePause(e){e?this.isPause++:this.isPause--,this.isPause<0&&(this.isPause=0)}popBoomNode(e,t){this.boomNodePool||(this.boomNodePool=new cc.NodePool);let i=this.boomNodePool.get();i?e(i):this.boomEffectNode?(i=cc.instantiate(this.boomEffectNode),e(i)):p.Manager.loader.loadPrefab("ui/boomEffect").then(t=>{this.boomEffectNode=t,e(cc.instantiate(this.boomEffectNode))})}putBoomEffectNode(e){this.boomNodePool.put(e)}resetMainRole(){this.mainRole.onRelive()}getShootOffsetInfo(){let e=l.Cfg.Tank.get(o.GameVoManager.getInstance.myUserVo.useTankId);return e?e.shootOffset:null}getKickForceInfo(){let e=l.Cfg.Tank.get(o.GameVoManager.getInstance.myUserVo.useTankId);return e?e.kick:null}}return e._instance=null,e})();i.default=_,cc._RF.pop()},{"../../CallID":"CallID","../../ListenID":"ListenID","../../alert/AlertManager":"AlertManager","../../config/Cfg":"Cfg","../../config/Const":"Const","../../frame/MVC":"MVC","../../frame/Notifier":"Notifier","../../frame/collections/ObjectPool":"ObjectPool","../../manager/GameVoManager":"GameVoManager","../../manager/Manager":"Manager","../../utils/Util":"Util","./component/Enemy":"Enemy","./component/MainRole":"MainRole"}],FightUI:[function(e,t,i){"use strict";cc._RF.push(t,"bf796QV4oJKt7hsJ6SNWZXr","FightUI");var s=this&&this.__decorate||function(e,t,i,s){var n,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});const n=e("../../frame/MVC"),o=e("../../manager/GameVoManager"),a=e("../../frame/Notifier"),r=e("../../ListenID"),c=e("./FightModel"),l=e("../../config/Const"),h=e("../../CallID"),d=e("../../manager/Manager"),u=e("../../manager/AudioManager"),m=e("../../utils/Util"),{ccclass:g,property:p}=cc._decorator;let f=(()=>{let e=class extends n.MVC.BaseView{constructor(){super(...arguments),this.progressbar=null,this.hitWarn=null,this.hitBullet=null,this.hitDoubleSign=null,this.missSign=null,this.hitDoubleCar=null,this.tankTips=null,this.warnTips=null,this.scoreNode=null,this.scoreNum=null,this.goldNum=null,this.downTime=null,this.escapeTime=null,this.ambushCurTank=null,this.ambushTargetTank=null,this.targetProgress=null,this.completeSuprass=null,this.stageText=null,this.distanceText=null,this.angleText=null,this.hpText=null,this.bulletText=null,this.loading=null,this.targetNode=null,this.signNode=null,this.hudNode=null,this.tankpaoNode=null,this.loaddesc=null,this.loadtime=null,this.paoNode=null,this.pao=null,this.loadup=null,this.stateGreen=null,this.stateRed=null,this.warnNode=null,this.kuanglist=[],this.warnBg=null,this.hitWarnPool=null,this.hitBulletLightPool=null,this.hpBlood=null,this.bulletProgress=null,this.fireEffect=null,this.next=null,this.guidetips=[],this.ambushTarget=null,this.ambushTargetScore=null,this.ambushTargetComplete=null,this.ambushDiamonSp=null,this.ambushKillOne=null,this.ambushScore=null,this.titlebg=null,this.shootOffsetInfo=null,this.designsize=null,this.ambushTime=l.Const.ambushFightTime,this.isInWarnAction=!1,this.isInWarnActionTwo=!1,this.hitNodeNumber=0,this.myPos=cc.v2(0,-640),this.startShootAction=0,this.startShootPos=cc.Vec2.ZERO,this.targetShootPos=cc.Vec2.ZERO,this.lerpShootPos=cc.Vec2.ZERO,this.ExpanSpeed=cc.Vec2.ZERO,this.curExpanTime=0,this.paox=0,this.loadguntime=0,this.curloadguntime=0,this.isguideaction=!0,this.checkTime=.05,this.startambush=!1,this.ambushUpdateDelta=.1,this.ambushDownTimeDelta=1}changeListener(e){a.Notifier.changeListener(e,r.ListenID.Fight_UpdateBlood,this.updateBlood,this),a.Notifier.changeListener(e,r.ListenID.Fight_BloodWarn,this.updateBloodWarn,this),a.Notifier.changeListener(e,r.ListenID.Fight_GunUpdate,this.updateGun,this),a.Notifier.changeListener(e,r.ListenID.Fight_ReloadGun,this.reloadGun,this),a.Notifier.changeListener(e,r.ListenID.Fight_CameraMove,this.updateTargetInfo,this),a.Notifier.changeListener(e,r.ListenID.Fight_KillNumChange,this.updateNum,this),a.Notifier.changeListener(e,r.ListenID.Fight_TargetChange,this.updateShootSign,this),a.Notifier.changeListener(e,r.ListenID.Fight_onFire,this.onFire,this),a.Notifier.changeCall(e,h.CallID.Fight_GetExpanSize,this.getExpanSize,this),a.Notifier.changeListener(e,r.ListenID.Fight_AutoMoveCall,this.autoMove,this),a.Notifier.changeListener(e,r.ListenID.Fight_HitDouble,this.hitDouble,this),a.Notifier.changeListener(e,r.ListenID.Guide_ActionStart,this.actionstart,this),a.Notifier.changeListener(e,r.ListenID.Guide_ActionFinish,this.actionfinish,this),a.Notifier.changeListener(e,r.ListenID.Fight_UpdateGold,this.updateGold,this),a.Notifier.changeListener(e,r.ListenID.Fight_AddAmbushTime,this.addAmbushTime,this),a.Notifier.changeListener(e,r.ListenID.Fight_HitWarnCar,this.hitCar,this),a.Notifier.changeListener(e,r.ListenID.Fight_StartDiamonMode,this.startDiamonMode,this),a.Notifier.changeListener(e,r.ListenID.Fight_KillExtraRewardInAmbush,this.killExtarReward,this)}onOpen(e){super.onOpen(e),this.initNode(),this.initView(e)}onClose(){super.onClose(),this.hitWarnPool.clear(),this.hitBulletLightPool.clear()}startMissionAction(){a.Notifier.send(r.ListenID.Guide_OpenActionView,n.MVC.eUILayer.Guide,n.MVC.eTransition.Default,{type:0,fightType:c.default.getInstance.fightType})}onPause(){d.Manager.audio.playAudio(104),c.default.getInstance.isFighting&&!this.isguideaction&&0!=o.GameVoManager.getInstance.myUserVo.topLevel&&a.Notifier.send(r.ListenID.Fight_OpenPauseView,n.MVC.eUILayer.Popup,n.MVC.eTransition.EaseScale)}initNode(){this.stageText=this.node.getChildByName("stageText").getComponent(cc.Label),this.titlebg=this.node.getChildByName("titlebg"),this.distanceText=this.node.getChildByName("dis").getComponent(cc.Label),this.angleText=this.node.getChildByName("angle").getComponent(cc.Label),this.hpText=this.node.getChildByName("bloodText").getComponent(cc.Label),this.bulletText=this.node.getChildByName("bulletText").getComponent(cc.Label),this.targetNode=this.node.getChildByName("target"),this.loading=this.targetNode.getChildByName("loading").getComponent(cc.ProgressBar),this.loadup=this.targetNode.getChildByName("loadup"),this.stateGreen=this.targetNode.getChildByName("state1"),this.stateRed=this.targetNode.getChildByName("state2"),this.signNode=this.node.getChildByName("sign"),this.hudNode=this.node.getChildByName("hud"),this.tankpaoNode=this.hudNode.getChildByName("tankpao"),this.loaddesc=this.node.getChildByName("loaddesc").getComponent(cc.Label),this.loadtime=this.node.getChildByName("loadtime").getComponent(cc.Label),this.paoNode=this.node.getChildByName("paoNode"),this.pao=this.paoNode.getChildByName("pao"),this.fireEffect=this.paoNode.getChildByName("fireEffect").getComponent(cc.Animation),this.hpBlood=this.hudNode.getChildByName("blood"),this.bulletProgress=this.hudNode.getChildByName("bulletnum"),this.warnNode=this.node.getChildByName("warn"),this.warnBg=this.node.getChildByName("warnBg"),this.hitWarnPool=new cc.NodePool,this.hitBulletLightPool=new cc.NodePool,this.next=this.node.getChildByName("next"),this.ambushTarget=this.node.getChildByName("ambushTarget");let e=this.ambushTarget.getChildByName("ambushbg");this.ambushTargetScore=e.getChildByName("score").getComponent(cc.Label),this.ambushTargetComplete=e.getChildByName("completesign"),this.ambushDiamonSp=this.node.getChildByName("ambushDiamond"),this.ambushKillOne=this.node.getChildByName("hitboom").getComponent(cc.Animation),this.ambushScore=this.ambushKillOne.node.getChildByName("score").getComponent(cc.Label),this.next.active=!1;for(let e=1;e<=4;e++){let t=this.targetNode.getChildByName("kuang"+e);this.kuanglist.push(t)}}initView(e){this.startambush=!1,1==c.default.getInstance.fightType?(this.stageText.node.active=!0,this.stageText.string=`\u7b2c${o.GameVoManager.getInstance.myUserVo.curLevel}\u5173`,this.progressbar.node.active=!0,this.scoreNode.active=!1,this.ambushTarget.active=!1,this.escapeTime.node.parent.active=!1,this.titlebg.active=!0):2==c.default.getInstance.fightType&&(this.titlebg.active=!1,this.stageText.node.active=!1,this.progressbar.node.active=!1,this.ambushTime=l.Const.ambushFightTime,this.escapeTime.node.parent.active=!0,this.escapeTime.string=`${this.ambushTime.toFixed(2)}`,this.completeSuprass.active=!1,this.scoreNode.active=!0,this.scoreNum.string="0",this.goldNum.string="0",this.ambushTarget.active=!0,this.ambushTargetComplete.active=!1,c.default.getInstance.curAmbushHitTank=0,this.targetProgress.width=0,this.ambushCurTank.string=`${c.default.getInstance.curAmbushHitTank}`,this.ambushTargetScore.string=m.Util.numFormat(c.default.getInstance.ambushTargetScore,2),this.ambushTargetTank.string=`\u5386\u53f2\u6700\u9ad8${o.GameVoManager.getInstance.myUserVo.ambushTopHitTank}\u8f86`,this.checktHitTank()),this.startMissionAction();let t=c.default.getInstance.getMainRoleHp(),i=c.default.getInstance.getMainRoleCurBullet(),s=a.Notifier.call(h.CallID.Setting_GetRealDesignSize);if(this.designsize=s,this.paoNode.y=.5*-s.height,this.myPos.y=.5*-s.height,this.loading.progress=0,this.warnNode.active=!1,this.ambushDiamonSp.active=!1,this.warnBg.opacity=0,this.updateShootSign(),this.updateNum(0,1),this.updateBlood(t[0],t[1]),this.updateGun(i,i,0),this.updateTargetInfo(a.Notifier.call(h.CallID.Fight_CameraPos)),this.reloadGun(0),!this.shootOffsetInfo){let e=c.default.getInstance.getShootOffsetInfo();this.shootOffsetInfo=e?{minSize:new cc.Size(e[0][0],e[0][1]),maxSize:new cc.Size(e[0][2],e[0][3]),time:e[1]}:{minSize:new cc.Size(100,70),maxSize:new cc.Size(150,100),time:1}}this.startShootPos=cc.v2(.5*-this.shootOffsetInfo.minSize.width,.5*this.shootOffsetInfo.minSize.height),this.targetShootPos.x=.5*-this.shootOffsetInfo.maxSize.width,this.targetShootPos.y=.5*this.shootOffsetInfo.maxSize.height,this.updateKuangPos(this.startShootPos),this.updateShowModel()}updateGold(e){2==c.default.getInstance.fightType&&(1==e?(this.goldNum.string=m.Util.goldFormat(c.default.getInstance.goldInCome),this.goldNum.node.getComponent(cc.Animation).play()):2==e&&(this.scoreNum.string=m.Util.numFormat(c.default.getInstance.scoreInAmbush,2),this.targetProgress.width=cc.misc.clampf(c.default.getInstance.scoreInAmbush/c.default.getInstance.ambushTargetScore*376,0,376),this.scoreNum.node.getComponent(cc.Animation).play(),c.default.getInstance.ambushTargetScore<=c.default.getInstance.scoreInAmbush&&!this.ambushTargetComplete.active&&(this.ambushTargetComplete.active=!0,this.ambushTargetComplete.opacity=10,this.ambushTargetComplete.scale=2,cc.tween(this.ambushTargetComplete).then(cc.spawn(cc.fadeIn(.3),cc.scaleTo(.3,1))).start())))}addAmbushTime(e){this.ambushTime+=e}hitCar(){this.warnTips.active||(this.warnTips.active=!0),this.warnTips.getComponent(cc.Animation).play()}startDiamonMode(){this.downTime.node.active=!1,this.ambushDiamonSp.active=!0,this.titlebg.active=!0,this.targetProgress.parent.active=!1,this.escapeTime.node.parent.active=!1}killExtarReward(e){this.ambushScore.string=`+${e}f`,this.ambushKillOne.play(),c.default.getInstance.curAmbushHitTank+=1,this.ambushCurTank.string=`${c.default.getInstance.curAmbushHitTank}`,this.ambushCurTank.node.getComponent(cc.Animation).play(),this.checktHitTank()}checktHitTank(){c.default.getInstance.curAmbushHitTank>o.GameVoManager.getInstance.myUserVo.ambushTopHitTank&&(this.completeSuprass.active||(this.completeSuprass.active=!0,this.completeSuprass.opacity=10,this.completeSuprass.scale=2,cc.tween(this.completeSuprass).then(cc.spawn(cc.fadeIn(.3),cc.scaleTo(.3,1))).start()),o.GameVoManager.getInstance.myUserVo.ambushTopHitTank=c.default.getInstance.curAmbushHitTank,o.GameVoManager.getInstance.saveData())}updateKuangPos(e){this.kuanglist[0].setPosition(e),this.kuanglist[1].y=e.y,this.kuanglist[1].x=-e.x,this.kuanglist[2].x=e.x,this.kuanglist[2].y=-e.y,this.kuanglist[3].x=-e.x,this.kuanglist[3].y=-e.y}updateBlood(e,t){let i=e/t;this.hpText.string=`${m.Util.goldFormat(e)}/${m.Util.goldFormat(t)}`,this.hpBlood.width=126*i,this.hpBlood.color=i>.7?cc.Color.WHITE.fromHEX("#00F369"):i>.3?cc.Color.WHITE.fromHEX("#ffae00"):cc.Color.WHITE.fromHEX("#cd1a12")}updateBloodWarn(e,t,i){this.updateBlood(e,t),this.isInWarnAction||(this.isInWarnAction=!0,this.warnNode.active=!0,cc.tween(this.warnNode).then(cc.sequence(cc.blink(3,3),cc.callFunc(()=>{this.isInWarnAction=!1,this.warnNode.active=!1}))).start()),this.isInWarnActionTwo||(this.isInWarnActionTwo=!0,this.warnBg.opacity=10,cc.tween(this.warnBg).then(cc.sequence(cc.fadeTo(.1,80),cc.fadeOut(1.5),cc.callFunc(()=>{this.isInWarnActionTwo=!1}))).start()),this.updateHitPos(i),this.updateShootLight(i)}updateHitPos(e){if(!e)return;let t=e.sub(c.default.getInstance.shootPos);if(this.hitNodeNumber<5){let e=this.getHitWarnNode();e.active=!0,e.parent=this.node,e.setPosition(cc.Vec2.ZERO),e.angle=-m.Util.getAngle(cc.v2(0,1),t),e.opacity=120,cc.tween(e).then(cc.sequence(cc.fadeIn(.3),cc.fadeTo(1.2,130),cc.callFunc(()=>{this.hitWarnPool.put(e),this.hitNodeNumber--}))).start(),this.hitNodeNumber++}}updateShootLight(e){if(!e)return;let t=e.sub(c.default.getInstance.shootPos).sub(this.myPos),i=this.getHitBulletLightNode();i.active=!0,i.angle=-m.Util.getAngle(cc.v2(0,1),t),i.setPosition(this.myPos.add(t.normalize().mul(300))),i.parent=this.node,cc.tween(i).then(cc.sequence(cc.moveTo(.1,this.myPos),cc.callFunc(()=>{this.hitBulletLightPool.put(i)}))).start()}updateShowModel(){d.Manager.spAtlas.getTankBigPaoIconById(c.default.getInstance.getUserTankIconRes()).then(e=>{this.pao&&(this.pao.getComponent(cc.Sprite).spriteFrame=e),this.paox=c.default.getInstance.getUserTankPaoPosX(),this.pao&&(this.pao.x=this.paox);let t=c.default.getInstance.getUserTankFireEffect();this.fireEffect.node.position=cc.v3(t[0],t[1]),this.fireEffect.node.scale=t[2]})}getHitWarnNode(){let e=this.hitWarnPool.get();return e||(e=cc.instantiate(this.hitWarn)),e}getHitBulletLightNode(){let e=this.hitBulletLightPool.get();return e||(e=cc.instantiate(this.hitBullet)),e}updateShootSign(e=0){this.stateGreen.active=2==e,this.stateRed.active=1==e||0==e}onFire(e){if(!this.shootOffsetInfo){let e=c.default.getInstance.getShootOffsetInfo();this.shootOffsetInfo=e?{minSize:new cc.Size(e[0][0],e[0][1]),maxSize:new cc.Size(e[0][2],e[0][3]),time:e[1]}:{minSize:new cc.Size(100,70),maxSize:new cc.Size(150,100),time:1}}this.startShootAction=1,this.lerpShootPos=cc.v2(this.kuanglist[0].position.x,this.kuanglist[0].position.y),this.ExpanSpeed=this.startShootPos.sub(this.targetShootPos).div(this.shootOffsetInfo.time),this.pao.setPosition(cc.Vec2.ZERO),this.pao.getActionByTag(1)&&this.pao.stopActionByTag(1);let t=cc.sequence(cc.moveTo(.12,this.paox,-e),cc.moveTo(.33,this.paox,0));t.setTag(1),cc.tween(this.pao).then(t).start(),this.fireEffect.play()}updateGun(e,t,i=0){this.bulletText.string=`/${e}`,this.bulletProgress.width=e/t*126}updateNum(e,t){this.progressbar.progress=e/t}reloadGun(e){this.loadguntime=e,this.curloadguntime=0,e<=0?(this.loaddesc.string="\u70ae\u5f39\n\u88c5\u586b\u5b8c\u6bd5",this.loadtime.string="0.00",this.loadup.active=!0):(this.loaddesc.string="\u70ae\u5f39\n\u88c5\u586b\u4e2d......",this.loadtime.string=e.toFixed(2),this.loadup.active=!1)}updateTargetInfo(e){if(!this.next.active){let t=e.x-c.default.getInstance.originPos.x;this.distanceText.string=`${Math.ceil(.5*(e.y+.5*l.Const.designHeight))}m`,e.x>=0?this.angleText.string=`${Math.floor(t/8)}\xb0`:this.angleText.string=`${Math.ceil(t/8+360)}\xb0`,this.signNode.x=.6666*-t,this.tankpaoNode.angle=-t/8}}getExpanSize(){let e=[];return e[0]=this.kuanglist[1].x,e[1]=this.kuanglist[1].y,e}autoMove(e){if(e){this.next.active=e,this.next.opacity=255,this.next.scale=1;let t=this.next.getActionByTag(1);t&&this.next.stopActionByTag(1),(t=cc.blink(10,10)).setTag(1),cc.tween(this.next).then(t).start()}else{let e=this.next.getActionByTag(1);e&&this.next.stopActionByTag(1),this.next.opacity=255,(e=cc.sequence(cc.spawn(cc.fadeOut(.5),cc.scaleTo(.5,2)),cc.callFunc(()=>{this.next.active=!1}))).setTag(1),cc.tween(this.next).then(e).start()}}hitDouble(e){e?(this.missSign.getAnimationState("fightHitDouble").isPlaying&&(this.missSign.stop(),this.missSign.node.opacity=0),2==c.default.getInstance.fightType?this.hitDoubleCar.play():this.hitDoubleSign.play()):(this.hitDoubleSign.getAnimationState("fightHitDouble").isPlaying&&(this.hitDoubleSign.stop(),this.hitDoubleSign.node.opacity=0),this.hitDoubleCar.getAnimationState("fightHitDouble").isPlaying&&(this.hitDoubleCar.stop(),this.hitDoubleCar.node.opacity=0),this.missSign.play())}actionstart(e){0==e.type&&(this.isguideaction=!0)}actionfinish(e){0==e.type&&(this.isguideaction=!1,2==c.default.getInstance.fightType&&(this.ambushTime=l.Const.ambushFightTime,this.ambushUpdateDelta=.1,this.ambushDownTimeDelta=0,this.startambush=!0))}updateEnemyGuideDir(){let e=c.default.getInstance.getCurNoVisibleEnemyInfo(),t=this.guidetips.length;if(t>=e.length)for(let i=0;i<t;i++)e[i]?(this.guidetips[i].active=!0,this.guidetips[i].x=this.designsize.width*(e[i][2]?.5:-.5),this.guidetips[i].y=this.guidetips[i].x*e[i][1]/e[i][0],this.guidetips[i].scale=e[i][2]?1:-1):this.guidetips[i].active=!1;else for(let t=0;t<e.length;t++)this.guidetips[t]||(this.guidetips[t]=cc.instantiate(this.tankTips),this.guidetips[t].active=!0,this.guidetips[t].parent=this.tankTips.parent),this.guidetips[t].active=!0,this.guidetips[t].x=this.designsize.width*(e[t][2]?.5:-.5),this.guidetips[t].y=this.guidetips[t].x*e[t][1]/e[t][0],this.guidetips[t].scale=e[t][2]?1:-1}update(e){if(c.default.getInstance.isFighting&&c.default.getInstance.isPause<=0&&(this.loadguntime>this.curloadguntime&&(this.curloadguntime+=e,this.loadtime.string=(this.loadguntime-this.curloadguntime).toFixed(2),this.loading.progress=this.curloadguntime/this.loadguntime,this.loadguntime<=this.curloadguntime&&(this.loadtime.string="0.00",this.loading.progress=0,this.loaddesc.string="\u70ae\u5f39\n\u88c5\u586b\u5b8c\u6bd5",this.loadup.active=!0)),1==this.startShootAction?(this.lerpShootPos=this.lerpShootPos.lerp(this.targetShootPos,e+.3),this.updateKuangPos(this.lerpShootPos),this.lerpShootPos.sub(this.targetShootPos).mag()<=2&&(this.startShootAction=2,this.curExpanTime=0)):2==this.startShootAction&&(this.curExpanTime+=e,this.lerpShootPos=this.lerpShootPos.add(this.ExpanSpeed.mul(e)),this.curExpanTime>=this.shootOffsetInfo.time&&(this.startShootAction=0,this.lerpShootPos.x=.5*-this.shootOffsetInfo.minSize.width,this.lerpShootPos.y=.5*this.shootOffsetInfo.minSize.height),this.updateKuangPos(this.lerpShootPos)),this.checkTime-=e,this.checkTime<=0&&(this.updateEnemyGuideDir(),this.checkTime=.05),this.startambush&&2==c.default.getInstance.fightType&&c.default.getInstance.isFighting)){if(this.ambushUpdateDelta-=e,this.ambushTime-=e,this.ambushUpdateDelta<=0&&(this.escapeTime.string=`${this.ambushTime.toFixed(2)}`),this.ambushTime<=10){if(this.ambushDownTimeDelta-=e,this.ambushDownTimeDelta<=0){this.downTime.node.active=!0;let e=Math.floor(this.ambushTime);e<0&&(e=0),this.downTime.string=`${e}`,this.downTime.node.getComponent(cc.Animation).play(),e>0?d.Manager.audio.playAudio(319,u.AudioType.Time):d.Manager.audio.playAudio(320,u.AudioType.Time),this.ambushDownTimeDelta=1}}else this.downTime.node.active=!1,this.ambushDownTimeDelta=0;this.ambushTime<=0&&(this.escapeTime.string="0.00",this.startambush=!1,c.default.getInstance.ambushTargetScore<=c.default.getInstance.scoreInAmbush?(a.Notifier.send(r.ListenID.Fight_Pause,!0),c.default.getInstance.curLevel>=o.GameVoManager.getInstance.myUserVo.ambushTopLevel&&(o.GameVoManager.getInstance.myUserVo.ambushTopLevel=c.default.getInstance.curLevel,o.GameVoManager.getInstance.saveData()),a.Notifier.send(r.ListenID.Fight_openDiamonModeView,n.MVC.eUILayer.Popup,n.MVC.eTransition.EaseScale)):a.Notifier.send(r.ListenID.Fight_EndGame,!0,0))}}onOpenAmbushGuide(){a.Notifier.send(r.ListenID.Fight_OpenAmbushGuideView,n.MVC.eUILayer.Popup,n.MVC.eTransition.EaseScale)}};return s([p(cc.ProgressBar)],e.prototype,"progressbar",void 0),s([p(cc.Node)],e.prototype,"hitWarn",void 0),s([p(cc.Node)],e.prototype,"hitBullet",void 0),s([p(cc.Animation)],e.prototype,"hitDoubleSign",void 0),s([p(cc.Animation)],e.prototype,"missSign",void 0),s([p(cc.Animation)],e.prototype,"hitDoubleCar",void 0),s([p(cc.Node)],e.prototype,"tankTips",void 0),s([p(cc.Node)],e.prototype,"warnTips",void 0),s([p(cc.Node)],e.prototype,"scoreNode",void 0),s([p(cc.Label)],e.prototype,"scoreNum",void 0),s([p(cc.Label)],e.prototype,"goldNum",void 0),s([p(cc.Label)],e.prototype,"downTime",void 0),s([p(cc.Label)],e.prototype,"escapeTime",void 0),s([p(cc.Label)],e.prototype,"ambushCurTank",void 0),s([p(cc.Label)],e.prototype,"ambushTargetTank",void 0),s([p(cc.Node)],e.prototype,"targetProgress",void 0),s([p(cc.Node)],e.prototype,"completeSuprass",void 0),e=s([g],e)})();i.default=f,cc._RF.pop()},{"../../CallID":"CallID","../../ListenID":"ListenID","../../config/Const":"Const","../../frame/MVC":"MVC","../../frame/Notifier":"Notifier","../../manager/AudioManager":"AudioManager","../../manager/GameVoManager":"GameVoManager","../../manager/Manager":"Manager","../../utils/Util":"Util","./FightModel":"FightModel"}],FreeUpView:[function(e,t,i){"use strict";cc._RF.push(t,"6717acygvlIcLQXYdjYMVDZ","FreeUpView");var s=this&&this.__decorate||function(e,t,i,s){var n,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});const n=e("../../frame/MVC"),o=e("../../manager/GameVoManager"),a=e("../../manager/Manager"),r=e("../../frame/Notifier"),c=e("../../ListenID"),l=e("./ComposeModel"),{ccclass:h,property:d}=cc._decorator;let u=(()=>{let e=class extends n.MVC.BaseView{constructor(){super(...arguments),this.tank_0=null,this.tank_1=null,this.level_0=null,this.level_1=null,this._args=null}changeListener(e){}onOpen(e){r.Notifier.send(c.ListenID.ShowBanner,0),super.onOpen(e),this._args=e,this.initUI()}onClose(){r.Notifier.send(c.ListenID.HideBanner),a.Manager.audio.playAudio(104),super.onClose(),o.GameVoManager.getInstance.myUserVo.composeTimes=0,o.GameVoManager.getInstance.saveData()}initUI(){let e=l.default.getInstance.getComposeTankInfoById(this._args.id),t=l.default.getInstance.getComposeTankInfoById(this._args.id+1);a.Manager.spAtlas.getTankIconByResPath(e.icon).then(e=>{this.tank_0.spriteFrame=e}),a.Manager.spAtlas.getTankIconByResPath(t.icon).then(e=>{this.tank_1.spriteFrame=e}),this.level_0.string=`${e.level}`,this.level_1.string=`${t.level}`}onVideoReward(){let e=this._args.id+1;o.GameVoManager.getInstance.myUserVo.composeInfo[this._args.targetIndex]+=1,r.Notifier.send(c.ListenID.FreeUpTank,this._args.targetIndex),r.Notifier.send(c.ListenID.Compose_OpenUnLockView,n.MVC.eUILayer.Popup,n.MVC.eTransition.EaseScale,{unLockId:e,type:2}),o.GameVoManager.getInstance.myUserVo.composeTimes=0,o.GameVoManager.getInstance.saveData(),super.onClose(),r.Notifier.send(c.ListenID.HideBanner)}onShareGetTiems(){let e=this._args.id+1;o.GameVoManager.getInstance.myUserVo.composeInfo[this._args.targetIndex]+=1,r.Notifier.send(c.ListenID.FreeUpTank,this._args.targetIndex),r.Notifier.send(c.ListenID.Compose_OpenUnLockView,n.MVC.eUILayer.Popup,n.MVC.eTransition.EaseScale,{unLockId:e,type:2}),o.GameVoManager.getInstance.myUserVo.composeTimes=0,o.GameVoManager.getInstance.saveData(),super.onClose(),r.Notifier.send(c.ListenID.HideBanner)}};return s([d(cc.Sprite)],e.prototype,"tank_0",void 0),s([d(cc.Sprite)],e.prototype,"tank_1",void 0),s([d(cc.Label)],e.prototype,"level_0",void 0),s([d(cc.Label)],e.prototype,"level_1",void 0),e=s([h],e)})();i.default=u,cc._RF.pop()},{"../../ListenID":"ListenID","../../frame/MVC":"MVC","../../frame/Notifier":"Notifier","../../manager/GameVoManager":"GameVoManager","../../manager/Manager":"Manager","./ComposeModel":"ComposeModel"}],GameScene:[function(e,t,i){"use strict";cc._RF.push(t,"a73c2idgGdDYZVUWvTKIG/e","GameScene");var s=this&&this.__decorate||function(e,t,i,s){var n,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});const n=e("../../frame/Notifier"),o=e("../../ListenID"),a=e("../../frame/MVC"),r=e("../../manager/GameVoManager"),c=e("../fight/FightModel"),l=e("../fight/FightDamageDisplay"),h=e("../../frame/Time"),d=e("../../utils/Util"),u=e("../../CallID"),m=e("../../manager/Manager"),g=e("../../manager/AudioManager"),p=e("../../config/Const"),{ccclass:f,property:y}=cc._decorator;let C=(()=>{let e=class extends cc.Component{constructor(){super(...arguments),this.mapParent=null,this.decorateList=[],this.curMapNode=null,this.gameCamera=null,this.gamePanel=null,this.gamePanel2=null,this.gamePanel3=null,this.gamePanel4=null,this.touchCount=0,this.hurtNumPanel=null,this.handShankBg=null,this.handShank=null,this.cloud=null,this.sceneId=p.Const.defaultSceneId,this.refreGuideEnemy=!0,this.step=0,this.openList=[],this.bglist=null,this.catchRocker=!1,this.startPos=cc.Vec2.ZERO,this.shootPos=cc.Vec2.ZERO,this.isMove=!1,this.isPause=0,this._startShake=!1,this.curAddMonsterTime=0,this._offset=cc.v2(0,0),this.dir=0,this.shakeTime=0,this.shakelist=[],this.updatecameratime=.1,this.autoMoveTime=0,this.kickInfo=null,this.startKickAction=0,this.kickXoffset=[],this.upTime=0,this.downTime=0,this.preUpOffset=cc.Vec2.ZERO,this.preDownOffset=cc.Vec2.ZERO,this.preUpTime=0,this.preDownTime=0,this.curTime=0,this.xoffsetIndex=0}changeListener(e){n.Notifier.changeListener(e,o.ListenID.Fight_StartGame,this.onStartGame,this),n.Notifier.changeListener(e,o.ListenID.Guide_ActionFinish,this.actionFinish,this),n.Notifier.changeListener(e,o.ListenID.Fight_Pause,this.gamePause,this),n.Notifier.changeListener(e,o.ListenID.Fight_EndGame,this.onEndGame,this),n.Notifier.changeListener(e,o.ListenID.Fight_ShowHurtNum,this.showHurtNum,this),n.Notifier.changeListener(e,o.ListenID.Fight_CreateKickForce,this.updateKickForce,this),n.Notifier.changeListener(e,o.ListenID.Fight_ShowEffect,this.showEffect,this),n.Notifier.changeListener(e,o.ListenID.Fight_StartNextStep,this.doNextStep,this),n.Notifier.changeListener(e,o.ListenID.Fight_ShowShake,this.startShake,this),n.Notifier.changeListener(e,o.ListenID.Game_OpenUIList,this.openUIList,this),n.Notifier.changeListener(e,o.ListenID.Guide_NewGuideNextStep,this.refreGuideEnemyStatus,this),n.Notifier.changeListener(e,o.ListenID.Fight_StartDiamonMode,this.startDiamonMode,this),n.Notifier.changeListener(e,o.ListenID.Fight_ResetCameraPos,this.initGameCamera,this),n.Notifier.changeCall(e,u.CallID.Fight_CameraPos,this.getCameraPos,this)}refreGuideEnemyStatus(e){this.refreGuideEnemy=!0,this.step=e}startDiamonMode(){c.default.getInstance.resetGame(),this.addMonsterToScene(1001)}start(){this.changeListener(!0),this.initScene(),0==r.GameVoManager.getInstance.myUserVo.topLevel?n.Notifier.send(o.ListenID.Fight_StartGame,1):n.Notifier.send(o.ListenID.Compose_OpenView,a.MVC.eUILayer.Panel)}createMap(e){return new Promise((t,i)=>{let s="scene_"+e,n=this.mapParent.getChildByName(s);n&&cc.isValid(n)?(this.curMapNode=n,this.showSceneByName(s),t(null)):cc.resources.load("ui/map/"+s,(n,o)=>{if(n)return console.error("=====createMap  error===",n,e),void i();let a=cc.instantiate(o);a.parent=this.mapParent,this.curMapNode=a,this.showSceneByName(s),t(null)})})}showSceneByName(e){for(let t=0;t<this.mapParent.childrenCount;t++){let i=this.mapParent.children[t];i.active=i.name==e}}initOpenList(){n.Notifier.call(u.CallID.Compose_OfflineReward)>0&&n.Notifier.call(u.CallID.Guide_isAllComplete)&&this.openList.push(()=>{n.Notifier.send(o.ListenID.Compose_OpenOfflineView,a.MVC.eUILayer.Popup,a.MVC.eTransition.EaseScale)})}openUIList(){let e=this.openList.shift();e&&e()}initScene(){this.initDecorateList(),this.refreshSceneUI(),this.hurtNumPanel=this.node.getChildByName("hurtdisplay"),this.gameCamera=this.node.getChildByName("Main Camera").getComponent(cc.Camera),this.handShankBg=cc.find("control/bg",this.node),this.handShank=this.handShankBg.getChildByName("circle"),this.handShankBg.active=!1,this.handShankBg.parent.active=!0,this.registerTouchOperate(),r.GameVoManager.getInstance.myUserVo.topLevel<=0&&n.Notifier.send(o.ListenID.Fight_UpdateGameScore,0),n.Notifier.send(o.ListenID.Game_OpenCheatView,a.MVC.eUILayer.Loading),this.initOpenList(),this.openUIList()}initDecorateList(){if(1==this.sceneId)for(let e=1;e<=9;e++){let t=this.curMapNode.getChildByName(`d${e}`);t&&this.decorateList.push(t)}else if(2==this.sceneId)for(let e=1;e<=10;e++)if(e<=7){let t=this.curMapNode.getChildByName(`d${e}`);t&&this.decorateList.push(t)}else{let t=this.curMapNode.getChildByName(`yanwu_${8-e}`);t&&this.decorateList.push(t)}else this.decorateList=[]}refreshSceneUI(){let e=this.curMapNode;e&&e.getChildByName("gamePanel")&&(this.gamePanel=e.getChildByName("gamePanel")),e&&e.getChildByName("gamePanel2")&&(this.gamePanel2=e&&e.getChildByName("gamePanel2")),e&&e.getChildByName("gamePanel3")&&(this.gamePanel3=e&&e.getChildByName("gamePanel3")),e&&e.getChildByName("gamePanel4")&&(this.gamePanel4=e&&e.getChildByName("gamePanel4")),this.bglist=e&&e.getChildByName("bglist")}showCloudCg(e,t){n.Notifier.send(o.ListenID.Fight_loadScene,{callBefore:e,callAfter:t})}showCloudCgCallFunc(){m.Manager.audio.playMusic(101,!0),l.FightDamageDisplay.getInstance.resetCount(),h.Time.startGameTimeLog(),1==c.default.getInstance.fightType?(r.GameVoManager.getInstance.myUserVo.curLevel=r.GameVoManager.getInstance.myUserVo.topLevel+1,c.default.getInstance.initLevelCfg(r.GameVoManager.getInstance.myUserVo.curLevel)):(r.GameVoManager.getInstance.myUserVo.curLevel=r.GameVoManager.getInstance.myUserVo.ambushTopLevel+1,c.default.getInstance.initAmbushCfg(r.GameVoManager.getInstance.myUserVo.ambushTopLevel+1)),this.curAddMonsterTime=0,this.initGameCamera(),this.initKickActionInfo(),c.default.getInstance.resetGame(),n.Notifier.send(o.ListenID.Fight_OpenView,a.MVC.eUILayer.Panel),c.default.getInstance.setMainRoleInfo({})}onStartGame(e=p.Const.defaultSceneId,t=!1,i=1){this.sceneId=e,c.default.getInstance.fightType=i,t?this.showCloudCg(()=>{n.Notifier.send(o.ListenID.Compose_CloseView),n.Notifier.send(o.ListenID.Compose_SignCompose,!1),this.createMap(e).then(()=>{this.initDecorateList(),this.refreshSceneUI(),this.registerTouchOperate(),n.Notifier.send(o.ListenID.Fight_loadSceneFinish)})},()=>{console.log("showCloudcd------------"),this.showCloudCgCallFunc()}):(n.Notifier.send(o.ListenID.Compose_CloseView),n.Notifier.send(o.ListenID.Compose_SignCompose,!1),this.showCloudCgCallFunc())}onEndGame(){this.touchCount=0,this.resetTank()}actionFinish(e){0==e.type&&(c.default.getInstance.randomLevelInfo(),c.default.getInstance.curAmbushTime=0)}registerTouchOperate(){this.node.targetOff(this.gamePanel),this.gamePanel.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.gamePanel.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.gamePanel.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.gamePanel.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this)}onTouchStart(e){if(!(1!=c.default.getInstance.gameState||c.default.getInstance.isPause>0)){if(0==this.touchCount){let t=this.handShankBg.parent.convertToNodeSpaceAR(e.getLocation());this.catchRocker=!0,this.startPos=t,this.handShankBg.setPosition(t)}this.touchCount++}}onTouchMove(e){if(1!=c.default.getInstance.gameState||c.default.getInstance.isPause>0)return;let t=e.getDelta();c.default.getInstance.tankAutoMove||this.setCameraPostion(t)}onTouchEnd(e){1!=c.default.getInstance.gameState||c.default.getInstance.isPause>0||(this.touchCount--,0==this.touchCount&&this.resetTank())}gamePause(e){e?this.isPause++:this.isPause--,this.isPause>0?(this.resetTank(),c.default.getInstance.tankAutoMove&&c.default.getInstance.isFighting&&m.Manager.audio.stopAudio(g.AudioType.Move),this.touchCount=0):(c.default.getInstance.tankAutoMove&&c.default.getInstance.isFighting&&m.Manager.audio.playAudio(109,g.AudioType.Move),this.touchCount=0)}onTankMove(){this.setCameraPostion(this.shootPos.mul(5))}setTankFirePos(e){let t=e.sub(this.startPos);this.handShankBg.setPosition(e),this.shootPos=t.normalize();let i=t.mag(),s=cc.Vec2.ZERO.sub(this.shootPos.mul(cc.misc.clampf(t.mag(),0,88)));if(this.handShank.setPosition(s),i>=88){let t=e.sub(this.shootPos.mul(88));this.startPos=t}}resetTank(){this.startPos=cc.Vec2.ZERO,this.shootPos=cc.Vec2.ZERO,this.catchRocker=!1}initGameCamera(){this.gameCamera.node.setPosition(cc.Vec2.ZERO.add(c.default.getInstance.cameraOffset)),c.default.getInstance.calShootPos(cc.v2(this.gameCamera.node.position)),n.Notifier.send(o.ListenID.Fight_CameraMove,this.gameCamera.node.position)}getCameraPos(){return this.gameCamera.node.position}setCameraPostion(e){this.gameCamera.node.position=this.gameCamera.node.position.add(cc.v3(e));let t=c.default.getInstance.getMoveBox();c.default.getInstance.tankAutoMove||(this.gameCamera.node.position=this.gameCamera.node.position.clampf(cc.v3(t.min),cc.v3(t.max))),c.default.getInstance.calShootPos(cc.v2(this.gameCamera.node.position)),n.Notifier.send(o.ListenID.Fight_CameraMove,this.gameCamera.node.position)}update(e){if(c.default.getInstance.isPause<=0&&c.default.getInstance.isFighting){if(c.default.getInstance.startAddEnemy)if(1==c.default.getInstance.fightType)0==r.GameVoManager.getInstance.myUserVo.topLevel?this.refreGuideEnemy&&(this.refreGuideEnemy=!1,this.addMonsterToScene()):(this.curAddMonsterTime+=e,this.curAddMonsterTime>=c.default.getInstance.addEnemyDelta&&(this.addMonsterToScene(),this.curAddMonsterTime=0));else if(2==c.default.getInstance.fightType){this.curAddMonsterTime+=e,c.default.getInstance.curAmbushTime+=e,this.curAddMonsterTime>=c.default.getInstance.addEnemyDelta&&(c.default.getInstance.checkEmptyPos(),this.curAddMonsterTime=0);for(const e in c.default.getInstance.waitAmbushList)c.default.getInstance.waitAmbushList[e]&&c.default.getInstance.waitAmbushList[e].bronTime<=c.default.getInstance.curAmbushTime&&this.addMonsterToScene(e)}1==this.startKickAction?(this.curTime+=e,this.setCameraPostion(this.preUpOffset.mul(e)),this.curTime>=this.preUpTime&&(this.startKickAction=2,this.curTime=0)):2==this.startKickAction&&(this.curTime+=e,this.setCameraPostion(this.preDownOffset.mul(e)),(this.curTime>=this.preDownTime||c.default.getInstance.isLockTarget())&&(this.curTime=0,this.startKickAction=0)),c.default.getInstance.tankAutoMove&&(this.setCameraPostion(this.mvoeDir.mul(e)),this.autoMoveTime-=e,this.autoMoveTime<=0&&(m.Manager.audio.stopAudio(g.AudioType.Move),m.Manager.audio.playAudio(110),c.default.getInstance.tankAutoMove=!1,c.default.getInstance.randomLevelInfo(),n.Notifier.send(o.ListenID.Fight_AutoMoveCall,!1))),this._startShake&&(this.shakeTime-=e,this.shakeTime>=.12?this.shakeByDir(0,e):this.shakeTime>=.09?this.shakeByDir(1,e):this.shakeTime>=.06?this.shakeByDir(2,e):this.shakeTime>=.03?this.shakeByDir(3,e):this.shakeTime>=0?this.shakeByDir(4,e):this._startShake=!1,this.setCameraPostion(this._offset))}}startShake(){this._startShake=!0,this._offset=cc.Vec2.ZERO,this.dir,this.shakeTime=.15;let e=Math.sqrt(5e3);this.shakelist[0]=cc.v2(-1,-1).normalize().mul(e),this.shakelist[1]=cc.v2(0,1).mul(100),this.shakelist[2]=cc.v2(1,-1).normalize().mul(2*e),this.shakelist[3]=cc.v2(0,1).mul(100),this.shakelist[4]=cc.v2(-1,-1).normalize().mul(e)}shakeByDir(e,t){this._offset=this.shakelist[e].mul(t)}lateUpdate(e){e&&(this.updatecameratime-=e,this.updatecameratime<=0&&c.default.getInstance.isPause<=0&&(this.updateCameraCulling(),this.updatecameratime=.1))}addMonsterToScene(e=-1){c.default.getInstance.addEnemy(e,e=>{if(e){let t=c.default.getInstance.getParentPanelByBronId(e.bronPosId);if(1==t?this.gamePanel.addChild(e.node):2==t?this.gamePanel2.addChild(e.node):3==t?this.gamePanel3.addChild(e.node):4==t&&this.gamePanel4.addChild(e.node),e.startAction(),100==e.roleTypeId){let t=cc.find("scaleNode/guideEffect",e.node),i=cc.find("scaleNode/guidePoint",e.node);0==this.step&&0==r.GameVoManager.getInstance.myUserVo.topLevel?(t.active=!0,t.getComponent(cc.Animation).play()):1==this.step&&0==r.GameVoManager.getInstance.myUserVo.topLevel?(t.active=!0,t.scaleX=-.6,t.position=cc.v3(-t.x,t.y),t.getComponent(cc.Animation).play(),i.active=!0):(t.active=!1,i.active=!1)}}})}showHurtNum(e,t,i,s=!1){l.FightDamageDisplay.getInstance.showHurt(e,t,this.hurtNumPanel,i,s)}showEffect(e,t){if(0==e){let e=c.default.getInstance.getParentPanelByBronId(t.bronPosId);c.default.getInstance.popBoomNode(i=>{1==e?this.gamePanel.addChild(i):2==e?this.gamePanel2.addChild(i):3==e?this.gamePanel3.addChild(i):4==e&&this.gamePanel4.addChild(i),i.position=t.position,i.scale=t.scale;let s=i.getComponent(cc.Animation);s.play(),s.on("finished",()=>{c.default.getInstance.putBoomEffectNode(i)},null)},()=>{})}}doNextStep(e){let t=c.default.getInstance.getOriginPosByStep(e.curStep).sub(cc.v2(this.gameCamera.node.position)),i=t.mag();this.autoMoveTime=i/c.default.getInstance.autoMoveSpeed,this.mvoeDir=t.normalize().mul(c.default.getInstance.autoMoveSpeed),c.default.getInstance.tankAutoMove=!0,m.Manager.audio.playAudio(109,g.AudioType.Move),n.Notifier.send(o.ListenID.Fight_AutoMoveCall,!0)}initKickActionInfo(){if(this.kickInfo=null,this.startKickAction=0,this.kickInfo=c.default.getInstance.getKickForceInfo(),this.kickXoffset=[],this.preUpOffset=cc.Vec2.ZERO,this.preDownOffset=cc.Vec2.ZERO,this.preUpTime=0,this.preDownTime=0,this.xoffsetIndex=0,this.kickInfo){let e=this.kickInfo[1];for(let t=0;t<12;t++)this.kickXoffset.push(d.Util.random(e[0],e[1]));let t=this.kickInfo[0];this.preUpTime=t[1]/(0==t[0]?1e4:t[0]),this.preDownTime=t[1]/(0==this.kickInfo[2]?1e4:this.kickInfo[2]),this.preUpOffset=cc.v2(this.kickXoffset[this.xoffsetIndex],t[1]).normalize().mul(t[0]),this.preDownOffset=cc.v2(0,-this.kickInfo[2])}}updateKickForce(){if(this.kickInfo||(this.kickInfo=c.default.getInstance.getKickForceInfo()),this.kickInfo){this.curTime=0,this.startKickAction=1;let e=this.kickInfo[0];this.xoffsetIndex++,this.xoffsetIndex>=this.kickXoffset.length&&(this.xoffsetIndex=0),this.preUpOffset=cc.v2(this.kickXoffset[this.xoffsetIndex],e[1]).normalize().mul(e[0])}}updateCameraCulling(){const e=n.Notifier.call(u.CallID.Setting_GetRealDesignSize),t=e.width,i=e.height,s=cc.rect(this.gameCamera.node.x-.5*t,this.gameCamera.node.y-.5*i,t,i),o=this.bglist.children,a=this.bglist.childrenCount;for(let e=0;e<a;e++){const t=o[e].getBoundingBox(),i=cc.Intersection.rectRect(s,t);o[e].active=i}const r=this.decorateList.length;for(let e=0;e<r;e++){const t=this.decorateList[e].getBoundingBox(),i=cc.Intersection.rectRect(s,t);this.decorateList[e].active=i}}};return s([y(cc.Node)],e.prototype,"mapParent",void 0),s([y([cc.Node])],e.prototype,"decorateList",void 0),s([y(cc.Node)],e.prototype,"curMapNode",void 0),e=s([f],e)})();i.default=C,cc._RF.pop()},{"../../CallID":"CallID","../../ListenID":"ListenID","../../config/Const":"Const","../../frame/MVC":"MVC","../../frame/Notifier":"Notifier","../../frame/Time":"Time","../../manager/AudioManager":"AudioManager","../../manager/GameVoManager":"GameVoManager","../../manager/Manager":"Manager","../../utils/Util":"Util","../fight/FightDamageDisplay":"FightDamageDisplay","../fight/FightModel":"FightModel"}],GameStateMachine:[function(e,t,i){"use strict";cc._RF.push(t,"101b84V039EE5CR+UsgqScn","GameStateMachine"),Object.defineProperty(i,"__esModule",{value:!0}),i.GameStateMachine=void 0;const s=e("./GameState");i.GameStateMachine=class{constructor(){this._state_map={},this.cur_state_id=-1111111,this.previous_state_id=-1}update(e){this._state_map[this.cur_state_id]&&this._state_map[this.cur_state_id].excute(e)}changeState(e,t=!1){let i=this._state_map[e];if(i){if(this.isInState(e))return!!i.isStateReEnter()&&(i.exit(),i.enter(),!0);let t=this._state_map[this.cur_state_id];t&&t.exit(),i.enter(),this.previous_state_id=this.cur_state_id,this.cur_state_id=e}}isInState(e){return this.cur_state_id==e}createState(e,t){let i=new s.GameState;return this._state_map[e]=i,i}revertToPreviousState(){this.changeState(this.previous_state_id)}},cc._RF.pop()},{"./GameState":"GameState"}],GameState:[function(e,t,i){"use strict";cc._RF.push(t,"f2373xerZlG2r/IshK9nQGk","GameState"),Object.defineProperty(i,"__esModule",{value:!0}),i.GameState=void 0;i.GameState=class{constructor(){this._enterFuncId=null,this._excuteFuncId=null,this._exitFuncId=null,this.can_re_enter=!1}enter(){this._enterFuncId&&this._enterFuncId()}excute(e){this._excuteFuncId&&this._excuteFuncId(e)}exit(){this._exitFuncId&&this._exitFuncId()}setCallbackAsMultiFuctions(e,t,i){this._enterFuncId=e,this._excuteFuncId=t,this._exitFuncId=i}isStateReEnter(){return this.can_re_enter}},cc._RF.pop()},{}],GameSwitchVo:[function(e,t,i){"use strict";cc._RF.push(t,"f1769cUJE9A4Y+Wv0VIkNgJ","GameSwitchVo"),Object.defineProperty(i,"__esModule",{value:!0}),i.GameSwitchVo=void 0;i.GameSwitchVo=class{constructor(){this.tankunlock=!1,this.homegold=!0,this.relive=!0,this.result=!1,this.switch=!1,this.checkin=!0,this.turntable=!0,this.accelerate=!1,this.offline=!0,this.unite=!1,this.testplay=!1}updateSwitchVo(e){Object.getOwnPropertyNames(this).forEach(function(t){e.hasOwnProperty(t)&&(this[t]=e[t])}.bind(this))}},cc._RF.pop()},{}],GameVoManager:[function(e,t,i){"use strict";cc._RF.push(t,"893775kopxBA50EZYp5CjTS","GameVoManager"),Object.defineProperty(i,"__esModule",{value:!0}),i.GameVoManager=void 0;const s=e("../shareData/UserVo"),n=e("../shareData/GameSwitchVo"),o=e("../frame/Notifier"),a=e("../ListenID"),r=e("../config/Const"),c=e("./Manager"),l=e("./StorageID");let h=(()=>{class e{constructor(){this.myUserVo=new s.UserVo,this._gameSwitchVo=new n.GameSwitchVo}get gameSwitchVo(){return this._gameSwitchVo}static get getInstance(){return null==e._instance&&(e._instance=new e),e._instance}updateSwitchVo(e){this._gameSwitchVo.updateSwitchVo(e)}updateComposeTankByIndex(e,t){this.myUserVo.composeInfo[e]=t}setGold(e,t=0){this.myUserVo.gold+=e,o.Notifier.send(a.ListenID.Game_UpdateGold,e,t)}setDiamond(e,t=0){this.myUserVo.diamond+=e,o.Notifier.send(a.ListenID.Game_UpdateDiamond,e,t)}setPower(e,t=1){1==t?this.myUserVo.power<r.Const.MaxPower&&(this.myUserVo.power+=e,this.myUserVo.power>=r.Const.MaxPower&&(this.myUserVo.power=r.Const.MaxPower)):2==t?this.myUserVo.power>=e&&(this.myUserVo.power-=e):3==t&&(this.myUserVo.power+=e),o.Notifier.send(a.ListenID.Game_UpdatePower,e,t)}setBoxNum(e,t=0){this.myUserVo.boxNum+=e,1==e&&(this.myUserVo.boxRewardCount>0?(this.myUserVo.boxType=1,this.myUserVo.boxRewardCount--):this.myUserVo.boxType=1),this.myUserVo.boxNum>1&&(this.myUserVo.boxNum=1),this.myUserVo.boxNum<0&&(this.myUserVo.boxNum=0),this.myUserVo.boxCountdown=30,o.Notifier.send(a.ListenID.Game_UpdateBox,e,t)}setBoxCountDown(e){this.myUserVo.boxCountdown-=e,this.myUserVo.boxCountdown=this.myUserVo.boxCountdown<=0?0:this.myUserVo.boxCountdown,o.Notifier.send(a.ListenID.Game_UpdateBoxCountDown)}setSpeedUpTime(t){e.getInstance.myUserVo.speedUpTime+=t,e.getInstance.myUserVo.speedUpTime=cc.misc.clampf(e.getInstance.myUserVo.speedUpTime,0,r.Const.MaxSpeedUpTime),o.Notifier.send(a.ListenID.Compose_UpdateSpeedUpTime,t)}getClickBuyTimesById(e){return this.myUserVo.clickBuyTimes[e]||(this.myUserVo.clickBuyTimes[e]=0),this.myUserVo.clickBuyTimes[e]}addClickBuyTimesById(e){this.myUserVo.clickBuyTimes[e]||(this.myUserVo.clickBuyTimes[e]=0),this.myUserVo.clickBuyTimes[e]=this.myUserVo.clickBuyTimes[e]+1}getShopBuyTimes(e,t=0){let i=0;return 0==t?(this.myUserVo.clickBuyTimes[e]||(this.myUserVo.clickBuyTimes[e]=0),i=this.myUserVo.clickBuyTimes[e]):(this.myUserVo.shopBuyTimesDiamond[e]||(this.myUserVo.shopBuyTimesDiamond[e]=0),i=this.myUserVo.shopBuyTimesDiamond[e]),i}addShopBuyTimes(e,t=0){0==t?(this.myUserVo.clickBuyTimes[e]||(this.myUserVo.clickBuyTimes[e]=0),this.myUserVo.clickBuyTimes[e]=this.myUserVo.clickBuyTimes[e]+1):(this.myUserVo.shopBuyTimesDiamond[e]||(this.myUserVo.shopBuyTimesDiamond[e]=0),this.myUserVo.shopBuyTimesDiamond[e]=this.myUserVo.shopBuyTimesDiamond[e]+1)}saveData(){c.Manager.storage.setString(l.StorageID.Vo_SaveData,e.getInstance.myUserVo.serialize())}loadData(){let t=c.Manager.storage.getString(l.StorageID.Vo_SaveData,"");if(t&&""!=t){let i=JSON.parse(t);e.getInstance.myUserVo.updatetUserVo(i)}}}return e._instance=null,e})();i.GameVoManager=h,cc._RF.pop()},{"../ListenID":"ListenID","../config/Const":"Const","../frame/Notifier":"Notifier","../shareData/GameSwitchVo":"GameSwitchVo","../shareData/UserVo":"UserVo","./Manager":"Manager","./StorageID":"StorageID"}],GetGoldPanel:[function(e,t,i){"use strict";cc._RF.push(t,"18de2OpmTRINqQ4goaPxFi9","GetGoldPanel");var s=this&&this.__decorate||function(e,t,i,s){var n,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});const n=e("../../frame/MVC"),o=e("../../utils/Util"),a=e("../../manager/GameVoManager"),r=e("../../config/Const"),c=e("../../alert/AlertManager"),l=e("../../manager/Manager"),h=e("../../frame/Notifier"),d=e("../../CallID"),{ccclass:u,property:m}=cc._decorator;let g=(()=>{let e=class extends n.MVC.BaseView{constructor(){super(...arguments),this.goldLabel=null,this.icon=null,this.iconSpriteFrams=[],this.type=1,this.goldRewardNum=0}changeListener(e){}onOpen(e){super.onOpen(e),this.initNode(),this.initView(e)}onClose(){l.Manager.audio.playAudio(104),super.onClose()}initNode(){}initView(e){if(e&&e.gold){let t=e.gold+h.Notifier.call(d.CallID.Compose_GetRewardByTime,300);this.goldLabel.string=o.Util.goldFormat(t),this.goldRewardNum=t,a.GameVoManager.getInstance.gameSwitchVo.unite&&(this.icon.spriteFrame=a.GameVoManager.getInstance.myUserVo.commonShareTimes>0?this.iconSpriteFrams[0]:this.iconSpriteFrams[1],a.GameVoManager.getInstance.myUserVo.commonShareTimes>0?this.type=0:this.type=1)}}onShare(){(()=>{a.GameVoManager.getInstance.myUserVo.commonShareTimes--,a.GameVoManager.getInstance.setGold(this.goldRewardNum,r.Const.GoldUse.GetFreeGold),o.Util.showGoldEffect(null,this.goldRewardNum,cc.Vec2.ZERO,cc.v2(-323,550),.1,0,r.Const.CurrencyType.Gold),c.AlertManager.showNormalTips("\u9886\u53d6\u6210\u529f!"),a.GameVoManager.getInstance.saveData(),this.onClose()})()}onVideoReward(){l.Manager.audio.playAudio(104),1==this.type?(a.GameVoManager.getInstance.setGold(this.goldRewardNum,r.Const.GoldUse.GetFreeGold),o.Util.showGoldEffect(null,this.goldRewardNum,cc.Vec2.ZERO,cc.v2(-323,550),.1,0,r.Const.CurrencyType.Gold),c.AlertManager.showNormalTips("\u9886\u53d6\u6210\u529f!"),a.GameVoManager.getInstance.saveData(),this.onClose()):this.onShare()}};return s([m(cc.Label)],e.prototype,"goldLabel",void 0),s([m(cc.Sprite)],e.prototype,"icon",void 0),s([m(cc.SpriteFrame)],e.prototype,"iconSpriteFrams",void 0),e=s([u],e)})();i.default=g,cc._RF.pop()},{"../../CallID":"CallID","../../alert/AlertManager":"AlertManager","../../config/Const":"Const","../../frame/MVC":"MVC","../../frame/Notifier":"Notifier","../../manager/GameVoManager":"GameVoManager","../../manager/Manager":"Manager","../../utils/Util":"Util"}],GetRewardOtherUI:[function(e,t,i){"use strict";cc._RF.push(t,"5d365DuRMFIT7fEYZm899A/","GetRewardOtherUI");var s=this&&this.__decorate||function(e,t,i,s){var n,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});const n=e("../frame/MVC"),o=e("../frame/Notifier"),a=e("../ListenID"),{ccclass:r,property:c}=cc._decorator;let l=(()=>{let e=class extends n.MVC.BaseView{constructor(){super(...arguments),this._args=null,this.callback=null}changeListener(e){}onOpen(e=null){super.onOpen(e),this.setInfo(e)}sucClose(){super.onClose()}onClose(){super.onClose(),-1==this._args.type&&o.Notifier.send(a.ListenID.Resume_CountDown)}setInfo(e){e&&(this._args=e,this.callback=e.callBack)}onShareClick(){this.callback(),super.onClose()}};return e=s([r],e)})();i.default=l,cc._RF.pop()},{"../ListenID":"ListenID","../frame/MVC":"MVC","../frame/Notifier":"Notifier"}],GiftView:[function(e,t,i){"use strict";cc._RF.push(t,"aaa3d2ViPpC6KqgOy/Z2sg8","GiftView");var s=this&&this.__decorate||function(e,t,i,s){var n,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});const n=e("../../frame/MVC"),o=e("../../config/Const"),a=e("../../manager/GameVoManager"),r=e("../../manager/Manager"),c=e("../../alert/AlertManager"),l=e("../../frame/Notifier"),h=e("../../ListenID"),d=e("../../utils/Util"),u=e("../../config/Cfg"),{ccclass:m,property:g}=cc._decorator;let p=(()=>{let e=class extends n.MVC.BaseView{constructor(){super(...arguments),this.rewardNum=100}changeListener(e){}onOpen(e){l.Notifier.send(h.ListenID.ShowBanner,1),super.onOpen(e),this.initUI()}onClose(){l.Notifier.send(h.ListenID.HideBanner),r.Manager.audio.playAudio(104),super.onClose()}initUI(){let e=o.Const.GiftNum-a.GameVoManager.getInstance.myUserVo.giftNum;e=e<=0?0:e,this.node.getChildByName("lbtimes").getComponent(cc.Label).string=`\u4eca\u65e5\u53ef\u9886\u53d6\uff1a${e}\u6b21`,a.GameVoManager.getInstance.myUserVo.topTankId>10&&(this.rewardNum=u.Cfg.Compose.get(a.GameVoManager.getInstance.myUserVo.topTankId).buyDiamond,this.node.getChildByName("lbnum").getComponent(cc.Label).string=`${this.rewardNum}`)}onVideoReward(){r.Manager.audio.playAudio(104),a.GameVoManager.getInstance.myUserVo.giftNum>=o.Const.GiftNum?c.AlertManager.showNormalTipsOnce("\u4eca\u65e5\u6682\u65e0\u53ef\u9886\u53d6\u6b21\u6570!"):(d.Util.showGoldEffect(null,100,cc.Vec2.ZERO,cc.v2(-166,602),.1,0,o.Const.CurrencyType.Diamond),a.GameVoManager.getInstance.myUserVo.giftNum++,a.GameVoManager.getInstance.setDiamond(this.rewardNum),l.Notifier.send(h.ListenID.Activity_RefreshGiftPoint),c.AlertManager.showCurrency(this.rewardNum,o.Const.CurrencyType.Diamond),this.initUI())}onShareGetTiems(){d.Util.showGoldEffect(null,100,cc.Vec2.ZERO,cc.v2(-166,602),.1,0,o.Const.CurrencyType.Diamond),a.GameVoManager.getInstance.myUserVo.giftNum++,a.GameVoManager.getInstance.setDiamond(this.rewardNum),l.Notifier.send(h.ListenID.Activity_RefreshGiftPoint),c.AlertManager.showCurrency(this.rewardNum,o.Const.CurrencyType.Diamond),this.initUI()}};return e=s([m],e)})();i.default=p,cc._RF.pop()},{"../../ListenID":"ListenID","../../alert/AlertManager":"AlertManager","../../config/Cfg":"Cfg","../../config/Const":"Const","../../frame/MVC":"MVC","../../frame/Notifier":"Notifier","../../manager/GameVoManager":"GameVoManager","../../manager/Manager":"Manager","../../utils/Util":"Util"}],Global:[function(e,t,i){"use strict";cc._RF.push(t,"84eacVJqhxMILMorKAP8TWK","Global"),window.toJson=function(e,t,i){var s=[],n=JSON.stringify(e,function(e,i){if(null==t||-1===t.indexOf(e)){if("object"==typeof i&&null!==i){if(-1!==s.indexOf(i))return;s.push(i)}return i}},i);return s=null,n},window.toArray=function(e){var t=[];if(null===e||"object"!=typeof e)return t;for(var i in e){var s=e[i];t.push(s)}return t},window.copy=function(e){if(null===e||"object"!=typeof e)return e;var t=Array.isArray(e)?[]:{};return Object.keys(e).forEach(function(i){t[i]=e[i]}),t},window.deepCopy=function(e,t){if(void 0===t&&(t=[]),null===e||"object"!=typeof e)return e;var i=function(e,t){return e.filter(t)[0]}(t,function(t){return t.original===e});if(i)return i.copy;var s=Array.isArray(e)?[]:{};return t.push({original:e,copy:s}),Object.keys(e).forEach(function(i){s[i]=deepCopy(e[i],t)}),s},window.isNullOrEmpty=function(e){if(null==e)return!0;if(""==e)return!0;var t=typeof e;return"string"!=t&&"number"!=t&&cc.error("isNullOrEmpty error type",e),!1},window.isInteger=function(e){return!isNaN(e)&&e%1==0},window.assign=function(e,t){null!==t&&"object"==typeof t&&null!==e&&"object"==typeof e&&Object.keys(t).forEach(function(i){e[i]=t[i]})},window.costFormat=function(e,t,i){return null==i&&(i="FFFFFF"),e>=t?"<color=#"+i+">"+e+"/"+t+"</c>":"<color=#FF0000>"+e+"</c><color=#"+i+">/"+t+"</c>"},window.shortFormat=function(e){return e<1e4?e.toString():e<1e8?(e/1e4).toFixed(1)+"\u4e07":(e/1e8).toFixed(1)+"\u4ebf"};window.timeoutFormat=function(e){if((e=Math.floor(e))<60)return[e+"\u79d2",1];if(e<3600)return[Math.floor(e/60)+"\u5206"+e%60+"\u79d2",1];if(e<86400){var t=e%3600;return[Math.floor(e/3600)+"\u5c0f\u65f6"+Math.floor(t/60)+"\u5206",t%=60]}var i=e%86400;return[Math.floor(e/86400)+"\u5929"+Math.floor(i/3600)+"\u5c0f\u65f6",i%=3600]},cc._RF.pop()},{}],GoldEffect:[function(e,t,i){"use strict";cc._RF.push(t,"de846sVpGlBo73Ai+McXj0X","GoldEffect");var s=this&&this.__decorate||function(e,t,i,s){var n,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});const n=e("../ListenID"),o=e("../manager/Manager"),a=e("../frame/Notifier"),{ccclass:r,property:c}=cc._decorator;let l=(()=>{let e=class extends cc.Component{constructor(){super(...arguments),this.iconSpriteFrame=[],this._allcoinPos=[],this._coinList=[]}start(){}playEffect(e=10,t,i=0,s=0,r){if(t=cc.v2(t.x-this.node.x,t.y-this.node.y),!this._allcoinPos[0]){let e=0;this.node.children.forEach(t=>{if(t&&"coin"==t.name){t.name=""+e,e++;let i=cc.v2(t.x,t.y);t.opacity=255,t.getComponent(cc.Sprite).spriteFrame=this.iconSpriteFrame[r],this._allcoinPos.push(i),this._coinList.push(t)}})}let c=0,l=this._coinList.length;for(let e=0;e<l;e++){let r=this._coinList[e];if(r&&"goodsNum"!=r.name){let h=Math.floor(300*Math.random()-150),d=Math.floor(300*Math.random()-150),u=Math.abs(Math.random()-.5);u<.2&&(u+=.1),u+=i+s,r.stopAllActions(),r.setScale(.3),r.opacity=18,r.x=0,r.y=0,cc.tween(r).then(cc.sequence(cc.spawn(cc.scaleTo(.2+i/2,.65),cc.fadeTo(.2+i/2,255),cc.moveTo(.2+i,cc.v2(this._allcoinPos[e].x+h,this._allcoinPos[e].y+d))),cc.moveTo(u,t),cc.scaleTo(.2,1.2,1.2),cc.fadeOut(.1),cc.callFunc(()=>{++c>=l&&a.Notifier.send(n.ListenID.Game_GoldEffect_End),1==c&&o.Manager.audio.playAudio(106)}))).start()}}}stopEffect(){this.node.children.forEach(e=>{e&&(e.stopAllActions(),e.opacity=0)}),this._coinList=[]}};return s([c(cc.SpriteFrame)],e.prototype,"iconSpriteFrame",void 0),e=s([r],e)})();i.default=l,cc._RF.pop()},{"../ListenID":"ListenID","../frame/Notifier":"Notifier","../manager/Manager":"Manager"}],GuideController:[function(e,t,i){"use strict";cc._RF.push(t,"48c925ItYJC7b2CO4W7aWCv","GuideController"),Object.defineProperty(i,"__esModule",{value:!0}),i.GuideController=void 0;const s=e("../../ListenID"),n=e("../../frame/MVC"),o=e("../../frame/Notifier"),a=e("./GuideModel"),r=e("../../CallID"),c=e("../../frame/UIManager");i.GuideController=class extends n.MVC.BaseController{constructor(){super("GuideController"),this._model=a.default.getInstance,this.changeListener(!0)}reset(){}changeListener(e){o.Notifier.changeListener(e,s.ListenID.Guide_CloseNewBieView,this.onCloseNewBieView,this),o.Notifier.changeCall(e,r.CallID.Guide_GetCurStep,this.getGuideCurStep,this),o.Notifier.changeCall(e,r.CallID.Guide_isAllComplete,this.isAllComplete,this),o.Notifier.changeListener(e,s.ListenID.Guide_OpenActionView,this.onOpenActionView,this),o.Notifier.changeListener(e,s.ListenID.Guide_ShowGuide,this.showGuide,this),o.Notifier.changeListener(e,s.ListenID.Guide_CloseGuide,this.closeGuide,this),o.Notifier.changeListener(e,s.ListenID.Guide_OpenNewGuideView,this.onOpenNewGuideView,this),o.Notifier.changeListener(e,s.ListenID.Guide_CloseNewGuideView,this.onCloseNewGuideView,this)}onOpenNewBieView(e,t,i){c.UIManager.Open("ui/guide/GuideNewBieView",t,e,i)}onCloseNewBieView(){c.UIManager.Close("ui/guide/GuideNewBieView")}onOpenActionView(e,t,i){c.UIManager.Open("ui/guide/GuideStageView",t,e,i)}onOpenNewGuideView(e,t,i){c.UIManager.Open("ui/guide/NewGuideView",t,e,i)}onCloseNewGuideView(){c.UIManager.Close("ui/guide/NewGuideView")}showGuide(e){let t=999;t=e&&e.step,this._model.getGuideStep()>=t||c.UIManager.Open("ui/guide/GuideView",n.MVC.eTransition.Default,n.MVC.eUILayer.Guide,e)}closeGuide(){c.UIManager.Close("ui/guide/GuideView"),o.Notifier.send(s.ListenID.CloseBoxGuide),o.Notifier.send(s.ListenID.CloseGuideBuy)}getGuideCurStep(){return this._model.getGuideStep()}isAllComplete(){return this._model.isAllGuideComplete()}},cc._RF.pop()},{"../../CallID":"CallID","../../ListenID":"ListenID","../../frame/MVC":"MVC","../../frame/Notifier":"Notifier","../../frame/UIManager":"UIManager","./GuideModel":"GuideModel"}],GuideModel:[function(e,t,i){"use strict";cc._RF.push(t,"8ea47DA+4FGforB979nT2fE","GuideModel"),Object.defineProperty(i,"__esModule",{value:!0});const s=e("../../frame/MVC"),n=e("../../manager/GameVoManager"),o=e("../../frame/Time");let a=[{},{action:1,figure:[0,-194],isforce:!1},{action:1,figure:[0,-194],isforce:!1},{action:2,figure:[-89,-63],isforce:!1},{action:1,figure:[0,-194],isforce:!1},{action:1,figure:[-118,82],isforce:!1}],r=(()=>{class e extends s.MVC.BaseModel{constructor(){super(),null==e._instance&&(e._instance=this)}reset(){}static get getInstance(){return null==e._instance&&(e._instance=new e),e._instance}getGuideStep(){return n.GameVoManager.getInstance.myUserVo.guideStep}setGuideStep(e){n.GameVoManager.getInstance.myUserVo.guideStep<e&&(n.GameVoManager.getInstance.myUserVo.guideStep=e)}isAllGuideComplete(){return n.GameVoManager.getInstance.myUserVo.guideStep>=a.length-1}getGuideInfoByStep(e){if(a[e])return a[e]}needOpenAmbushGuide(){return!n.GameVoManager.getInstance.myUserVo.openAmbushGuideTime||o.Time.serverTimeMs-n.GameVoManager.getInstance.myUserVo.openAmbushGuideTime>=2592e5}setNextOpenAmbushGuideTime(){n.GameVoManager.getInstance.myUserVo.openAmbushGuideTime=o.Time.serverTimeMs,n.GameVoManager.getInstance.saveData()}}return e._instance=null,e})();i.default=r,cc._RF.pop()},{"../../frame/MVC":"MVC","../../frame/Time":"Time","../../manager/GameVoManager":"GameVoManager"}],GuideStageView:[function(e,t,i){"use strict";cc._RF.push(t,"8c4a50VzvRP6bJeNOAdTKd5","GuideStageView");var s=this&&this.__decorate||function(e,t,i,s){var n,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});const n=e("../../frame/MVC"),o=e("../../frame/Notifier"),a=e("../../ListenID"),r=e("../../manager/GameVoManager"),c=e("../../manager/Manager"),l=e("./GuideModel"),{ccclass:h,property:d}=cc._decorator;let u=(()=>{let e=class extends n.MVC.BaseView{constructor(){super(...arguments),this.startAction=null,this.endAction=null,this.ambushTitle=null,this.targetSprite=null,this.guideNode=null}changeListener(e){}onOpen(e){if(super.onOpen(e),this.actionType=e||{},e&&2==e.fightType){l.default.getInstance.needOpenAmbushGuide()?(this.guideNode.active=!0,this.startAction.node.active=!1,this.endAction.node.active=!1,l.default.getInstance.setNextOpenAmbushGuideTime()):(this.guideNode.active=!1,this.callStart())}else this.guideNode.active=!1,this.callStart()}callStart(){if(o.Notifier.send(a.ListenID.Guide_ActionStart,this.actionType),this.actionType&&0!=this.actionType.type){this.endAction.node.active=!0,this.endAction.play();let e=this.endAction.getAnimationState("guideEndAction");this.scheduleOnce(()=>{this.onClose()},e.duration)}else{this.startAction.node.active=!0,2==this.actionType.fightType&&(this.targetSprite.spriteFrame=this.ambushTitle),this.startAction.play();let e=this.startAction.getAnimationState("guideStartAction");this.scheduleOnce(()=>{0==r.GameVoManager.getInstance.myUserVo.topLevel&&this.actionType.fightType&&2!=this.actionType.fightType&&o.Notifier.send(a.ListenID.Guide_OpenNewGuideView,n.MVC.eUILayer.Guide,null,1),this.onClose()},e.duration)}}onClose(){o.Notifier.send(a.ListenID.Guide_ActionFinish,this.actionType),super.onClose()}onCloseGuide(){c.Manager.audio.playAudio(104),this.guideNode.active=!1,this.callStart()}};return s([d(cc.Animation)],e.prototype,"startAction",void 0),s([d(cc.Animation)],e.prototype,"endAction",void 0),s([d(cc.SpriteFrame)],e.prototype,"ambushTitle",void 0),s([d(cc.Sprite)],e.prototype,"targetSprite",void 0),s([d(cc.Node)],e.prototype,"guideNode",void 0),e=s([h],e)})();i.default=u,cc._RF.pop()},{"../../ListenID":"ListenID","../../frame/MVC":"MVC","../../frame/Notifier":"Notifier","../../manager/GameVoManager":"GameVoManager","../../manager/Manager":"Manager","./GuideModel":"GuideModel"}],GuideView:[function(e,t,i){"use strict";cc._RF.push(t,"5cb96YH0bxCsLY6R+qmQn4z","GuideView");var s=this&&this.__decorate||function(e,t,i,s){var n,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});const n=e("../../frame/MVC"),o=e("./GuideModel"),a=e("../../alert/AlertManager"),r=e("../../frame/Notifier"),c=e("../../CallID"),l=e("../../config/Const"),{ccclass:h,property:d}=cc._decorator;let u=(()=>{let e=class extends n.MVC.BaseView{constructor(){super(...arguments),this.figureguide=null}changeListener(e){}onOpen(e){super.onOpen(e),this.setInfo(e)}onClose(){super.onClose()}setInfo(e){let t=e&&e.step;if(o.default.getInstance.getGuideStep()>=t)this.onClose();else{o.default.getInstance.setGuideStep(t);let e=o.default.getInstance.getGuideInfoByStep(t);if(e){let i=1==e.action?"guide":"guid2";this.figureguide.play(i);let s=0;if(2==e.action||5==t){s=.5*(r.Notifier.call(c.CallID.Setting_GetRealDesignSize).height-l.Const.designHeight)}this.figureguide.node.position=cc.v2(e.figure[0],e.figure[1]-s)}else a.AlertManager.showNormalTipsOnce("\u627e\u4e0d\u5230\u5bf9\u5e94\u6307\u5f15",t),this.onClose()}}};return s([d(cc.Animation)],e.prototype,"figureguide",void 0),e=s([h],e)})();i.default=u,cc._RF.pop()},{"../../CallID":"CallID","../../alert/AlertManager":"AlertManager","../../config/Const":"Const","../../frame/MVC":"MVC","../../frame/Notifier":"Notifier","./GuideModel":"GuideModel"}],Gun:[function(e,t,i){"use strict";cc._RF.push(t,"6a73a0U0JpNQL0P3zpcc0yo","Gun"),Object.defineProperty(i,"__esModule",{value:!0});const s=e("../../../config/Const"),n=e("../../../config/Cfg"),o=e("../../../utils/Util"),a=e("../../../frame/Notifier"),r=e("../../../ListenID"),c=e("../FightModel"),l=e("../../../CallID"),h=e("../../../manager/Manager"),d=e("../../../manager/AudioManager");i.default=class{constructor(e,t){this.belongType=s.Const.GunBelong.Player,this.gunReady=!1,this.belongObj=null,this.gunTypeId=0,this.leftBulletNum=0,this.weaponInfo=null,this.attackDelta=0,this.bulletHurtList=[],this.bulletHurtIndex=0,this.chamberTime=0,this.belongType=e,this.belongObj=t}setGunInfo(e){if(this.gunTypeId=e,this.bulletHurtIndex=0,this.bulletHurtList=[],this.belongType==s.Const.GunBelong.Player){if(this.weaponInfo=n.Cfg.Tank.get(e),!this.weaponInfo)return;this.attackDelta=this.weaponInfo.fireDelta;for(let e=0;e<12;e++){let e=o.Util.random(this.weaponInfo.attackNum[0],this.weaponInfo.attackNum[1]+1);this.bulletHurtList.push(e)}this.gunReady=!0,this.leftBulletNum=this.weaponInfo.bulletNum,a.Notifier.send(r.ListenID.Fight_GunUpdate,this.leftBulletNum,this.leftBulletNum,0)}else{if(this.weaponInfo=n.Cfg.Enemy.get(e),!this.weaponInfo)return;this.attackDelta=this.weaponInfo.fireDelta;for(let e=0;e<12;e++){let e=this.belongObj.attackNum;this.bulletHurtList.push(e)}this.gunReady=!0,this.leftBulletNum=this.weaponInfo.bulletNum}}onFire(e,t,i){if(this.weaponInfo&&this.gunReady){if(this.leftBulletNum--,this.weaponInfo.fireAudioId&&h.Manager.audio.playAudio(this.weaponInfo.fireAudioId),this.belongType==s.Const.GunBelong.Player){let s=this.weaponInfo,n=c.default.getInstance.shootPos,u=this.getBulletHurtRandom();if(o.Util.random(0,1e3)<1e3*s.missOffsetRatio){a.Notifier.send(r.ListenID.Fight_HitDouble,!1),h.Manager.audio.playAudio(318,d.AudioType.MyTalk);let s={attackId:i,defenseId:e,attackNum:u=Math.ceil(.5*u),defenseArea:t,hitPos:n};c.default.getInstance.addAttackVo(s)}else{t>=2&&(u*=2,a.Notifier.send(r.ListenID.Fight_HitDouble,!0));let s={attackId:i,defenseId:e,attackNum:u,defenseArea:t,hitPos:n};c.default.getInstance.addAttackVo(s)}a.Notifier.send(r.ListenID.Fight_GunUpdate,this.leftBulletNum,s.bulletNum,1),a.Notifier.send(r.ListenID.Fight_onFire,s.kick[3]),a.Notifier.send(r.ListenID.Fight_CreateKickForce),a.Notifier.call(l.CallID.Setting_IsBlockShake)}else{let s={attackId:i,defenseId:e,attackNum:this.getBulletHurtRandom(),defenseArea:t,attackPos:cc.v2(this.belongObj.node.position)};c.default.getInstance.addAttackVo(s),this.belongObj.firecb()}this.leftBulletNum<=0&&(this.gunReady=!1,this.chamberTime=0,this.belongType==s.Const.GunBelong.Player&&a.Notifier.send(r.ListenID.Fight_ReloadGun,this.weaponInfo.chamber))}}getBulletHurtRandom(){let e=this.bulletHurtList[this.bulletHurtIndex%this.bulletHurtList.length];return this.bulletHurtIndex++,e}update(e){!this.gunReady&&this.weaponInfo&&(this.chamberTime+=e,this.chamberTime>=this.weaponInfo.chamber&&(this.gunReady=!0,this.leftBulletNum=this.weaponInfo.bulletNum,this.belongType==s.Const.GunBelong.Player&&(this.belongObj.isReadyFire=!0,a.Notifier.send(r.ListenID.Fight_GunUpdate,this.leftBulletNum,this.weaponInfo.bulletNum,1))))}},cc._RF.pop()},{"../../../CallID":"CallID","../../../ListenID":"ListenID","../../../config/Cfg":"Cfg","../../../config/Const":"Const","../../../frame/Notifier":"Notifier","../../../manager/AudioManager":"AudioManager","../../../manager/Manager":"Manager","../../../utils/Util":"Util","../FightModel":"FightModel"}],IConfig:[function(e,t,i){"use strict";cc._RF.push(t,"6a7b5DJQcBGWYZnSq/mXcwg","IConfig"),cc._RF.pop()},{}],InviteView:[function(e,t,i){"use strict";cc._RF.push(t,"30f4deZWMxPzpfw2Sgl/aVb","InviteView");var s=this&&this.__decorate||function(e,t,i,s){var n,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});const n=e("../../frame/MVC"),o=e("../../manager/GameVoManager"),a=e("../../manager/Manager"),r=e("../../config/Cfg"),c=e("../compose/ComposeModel"),l=e("../../alert/AlertManager"),h=e("../../frame/Notifier"),d=e("../../ListenID"),{ccclass:u,property:m}=cc._decorator;let g=(()=>{let e=class extends n.MVC.BaseView{constructor(){super(...arguments),this.itemList=[],this._inviteList=[]}changeListener(e){}onOpen(e){h.Notifier.send(d.ListenID.ShowBanner,1),super.onOpen(e),this.initUI(),this.initInviteUI()}onClose(){h.Notifier.send(d.ListenID.HideBanner),a.Manager.audio.playAudio(104),super.onClose()}initUI(){let e=o.GameVoManager.getInstance.myUserVo.topTankId,t=r.Cfg.Compose.get(e);this.node.getChildByName("lbname").getComponent(cc.Label).string=t.name,a.Manager.spAtlas.getTankIconByResPath(t.icon).then(e=>{this.node.getChildByName("icon").getComponent(cc.Sprite).spriteFrame=e});for(let e=0;e<this.itemList.length;e++)a.Manager.spAtlas.getTankIconByResPath(t.icon).then(t=>{this.itemList[e].getChildByName("icon").getComponent(cc.Sprite).spriteFrame=t})}initInviteUI(){}initHeadImg(){let e=this._inviteList.length>5?5:this._inviteList.length,t="";for(let i=0;i<e;i++)for(let e=0;e<5;e++){this._inviteList[e]&&(t=this._inviteList[e].mark);let s=this.itemList[i].getChildByName("head_"+e);if(s){let e=s.getChildByName("img");t&&""!=t?cc.assetManager.loadRemote(t+"?a=a.jpg",(t,i)=>{e.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(i),e.setContentSize(50,50),e.getComponent(cc.Sprite).sizeMode=cc.Sprite.SizeMode.CUSTOM}):(e.active=!1,s.getChildByName("img_default").active=!0,s.getChildByName("label").active=!0)}}}onClickShare(){a.Manager.audio.playAudio(104)}onClickGet(e,t){if(a.Manager.audio.playAudio(104),c.default.getInstance.getEmptyGridNum()<Number(t))l.AlertManager.showNormalTipsOnce("\u6570\u91cf\u5df2\u6ee1\uff0c\u8bf7\u5408\u6210\u6216\u56de\u6536");else{l.AlertManager.showNormalTipsOnce("\u5956\u52b1\u9886\u53d6\u6210\u529f\uff01"),o.GameVoManager.getInstance.myUserVo.inviteRewardList[Number(t)-1]=2;let e=o.GameVoManager.getInstance.myUserVo.topTankId;for(let i=0;i<Number(t);i++){let t=c.default.getInstance.getEmptyGridIndex();h.Notifier.send(d.ListenID.Invite_GetTank,t,e)}h.Notifier.send(d.ListenID.Activity_RefreshInvitePoint),o.GameVoManager.getInstance.saveData(),h.Notifier.send(d.ListenID.HideBanner),super.close()}}refreshUI(){for(let e=0;e<this.itemList.length;e++)this.itemList[e].getChildByName("btnInvite").active=0==o.GameVoManager.getInstance.myUserVo.inviteRewardList[e],this.itemList[e].getChildByName("btnGet").active=1==o.GameVoManager.getInstance.myUserVo.inviteRewardList[e],this.itemList[e].getChildByName("btnGeted").active=2==o.GameVoManager.getInstance.myUserVo.inviteRewardList[e]}};return s([m(cc.Node)],e.prototype,"itemList",void 0),e=s([u],e)})();i.default=g,cc._RF.pop()},{"../../ListenID":"ListenID","../../alert/AlertManager":"AlertManager","../../config/Cfg":"Cfg","../../frame/MVC":"MVC","../../frame/Notifier":"Notifier","../../manager/GameVoManager":"GameVoManager","../../manager/Manager":"Manager","../compose/ComposeModel":"ComposeModel"}],Launcher:[function(e,t,i){"use strict";cc._RF.push(t,"45908vmiKJJpZqdZBYAove8","Launcher");var s=this&&this.__decorate||function(e,t,i,s){var n,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a},n=this&&this.__awaiter||function(e,t,i,s){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function a(e){try{c(s.next(e))}catch(e){o(e)}}function r(e){try{c(s.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):n(e.value).then(a,r)}c((s=s.apply(e,t||[])).next())})};Object.defineProperty(i,"__esModule",{value:!0});const{ccclass:o,property:a}=cc._decorator,r=e("./NetLauncher"),c=e("./ModuleLauncher"),l=e("../config/Cfg"),h=e("../utils/Util"),d=e("../frame/Time"),u=e("./UILauncher"),m=e("./SdkLauncher");let g=(()=>{let e=class extends cc.Component{constructor(){super(...arguments),this.progress=null,this.text=null,this.progressText=null,this.version=null,this.progressNum=0,this.loadTime=0,this.count=0,this.downtime=.5,this.loadState=0,this.stateStr=["\u6b63\u5728  \u9996\u6b21\u5b89\u88c5\u4e0b\u8f7d","\u6b63\u5728  \u521d\u59cb\u5316\u8d44\u6e90","\u6b63\u5728  \u767b\u5f55\u4fe1\u606f","\u6b63\u5728 \u4e0b\u8f7d2D\u8d44\u6e90"],this.onloadTime=3/8,this.sdklauncher=null}onLoad(){cc.game.addPersistRootNode(this.node)}start(){return n(this,void 0,void 0,function*(){let e=cc.director.getScene().children[1].getChildByName("bg");h.Util.resizeNode(e),new u.UILanuncher,this.login(),new r.NetLauncher,yield this.loadConfig()})}login(){}update(e){d.Time.update(e),this.downtime<999999&&(this.downtime-=e,this.downtime<=0&&this.moveon()),this.sdklauncher&&this.sdklauncher.loadFinish||(this.loadTime+=e,this.progressNum=Math.lerp(this.progressNum,100,e*this.onloadTime),this.progressNum>=99&&(this.loadState+=1,this.loadState%=this.stateStr.length,this.progressNum=0,this.moveon()),this.progressText.string=`${this.progressNum.toFixed(0)}%`,this.progress.progress=this.progressNum/100)}loadConfig(){return n(this,void 0,void 0,function*(){this.progress.progress=0,yield Promise.all([l.Cfg.initLocalJson("Compose"),l.Cfg.initLocalJson("Tank"),l.Cfg.initLocalJson("Enemy"),l.Cfg.initLocalJson("Barrier"),l.Cfg.initLocalJson("TurnTable"),l.Cfg.initLocalJson("EnemyPool"),l.Cfg.initLocalJson("AmbushBarrier"),l.Cfg.initLocalJson("AmbushEnemyPool"),l.Cfg.initLocalJson("AmbushEnemy"),l.Cfg.initLocalJson("Sound")]),new c.ModuleLauncher,this.sdklauncher=new m.SdkLauncher})}showDebug(){}moveon(){try{this.text?(this.count%=6,this.text.string=this.getString("\xb7",this.count),++this.count,this.downtime=.5):this.downtime=999999}catch(e){this.downtime=999999}}getString(e,t){let i=this.stateStr[this.loadState],s=e;for(let i=0;i<t;i++)s+=e;return i+=s}};return s([a(cc.ProgressBar)],e.prototype,"progress",void 0),s([a(cc.Label)],e.prototype,"text",void 0),s([a(cc.Label)],e.prototype,"progressText",void 0),s([a(cc.Label)],e.prototype,"version",void 0),e=s([o],e)})();i.default=g,cc._RF.pop()},{"../config/Cfg":"Cfg","../frame/Time":"Time","../utils/Util":"Util","./ModuleLauncher":"ModuleLauncher","./NetLauncher":"NetLauncher","./SdkLauncher":"SdkLauncher","./UILauncher":"UILauncher"}],LessCapacityAlert:[function(e,t,i){"use strict";cc._RF.push(t,"a7dacJ841xDHIFhdpVS3MBn","LessCapacityAlert");var s=this&&this.__decorate||function(e,t,i,s){var n,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});const n=e("../manager/Manager"),o=e("../frame/MVC"),a=e("../config/Cfg"),{ccclass:r,property:c}=cc._decorator;let l=(()=>{let e=class extends o.MVC.BaseView{constructor(){super(...arguments),this.barriername=null,this.ambushSp=null,this.tankIcon=null,this.tankName=null,this.cbConfirm=null,this.cbCompose=null}start(){}changeListener(e){}onOpen(e){if(super.onOpen(e),this.cbConfirm=e&&e.confirmCall,this.cbCompose=e&&e.composeCall,e&&2==e.type&&(this.barriername.spriteFrame=this.ambushSp),e&&e.level){let t=a.Cfg.Compose.get(e.level);n.Manager.spAtlas.getTankIconByResPath(t.icon).then(e=>{this.tankIcon.spriteFrame=e}),this.tankName.string=`Lv.${t.level}\u5766\u514b`}}onClose(){n.Manager.audio.playAudio(104),super.onClose()}startGame(){this.onClose(),this.cbConfirm&&this.cbConfirm()}keepCompose(){this.cbCompose&&this.cbCompose(),this.onClose()}};return s([c(cc.Sprite)],e.prototype,"barriername",void 0),s([c(cc.SpriteFrame)],e.prototype,"ambushSp",void 0),s([c(cc.Sprite)],e.prototype,"tankIcon",void 0),s([c(cc.Label)],e.prototype,"tankName",void 0),e=s([r],e)})();i.default=l,cc._RF.pop()},{"../config/Cfg":"Cfg","../frame/MVC":"MVC","../manager/Manager":"Manager"}],ListenID:[function(e,t,i){"use strict";cc._RF.push(t,"c4701UtlKxGIayebmUItjvF","ListenID"),Object.defineProperty(i,"__esModule",{value:!0}),i.ListenID=void 0,function(e){e[e._Start=999]="_Start",e[e.Game_UpdateGold=1e3]="Game_UpdateGold",e[e.Game_UpdateDiamond=1001]="Game_UpdateDiamond",e[e.Game_UpdatePower=1002]="Game_UpdatePower",e[e.Game_UpdateBox=1003]="Game_UpdateBox",e[e.Game_UpdateBoxCountDown=1004]="Game_UpdateBoxCountDown",e[e.Game_GoldEffect_End=1005]="Game_GoldEffect_End",e[e.Game_RefreshTime=1006]="Game_RefreshTime",e[e.Game_OpenUIList=1007]="Game_OpenUIList",e[e.Game_OpenCheatView=1008]="Game_OpenCheatView",e[e.Game_PauseBoxSchedule=1009]="Game_PauseBoxSchedule",e[e.Game_ResumeBoxSchedule=1010]="Game_ResumeBoxSchedule",e[e.Sdk_UpdateToken=1011]="Sdk_UpdateToken",e[e.Dsp_Get=1012]="Dsp_Get",e[e.Login_Start=1013]="Login_Start",e[e.Login_Finish=1014]="Login_Finish",e[e.Login_User=1015]="Login_User",e[e.Setting_MuteMusic=1016]="Setting_MuteMusic",e[e.Setting_MuteAudio=1017]="Setting_MuteAudio",e[e.Setting_BlockShake=1018]="Setting_BlockShake",e[e.Setting_HurtShow=1019]="Setting_HurtShow",e[e.Setting_Open=1020]="Setting_Open",e[e.ShowBanner=1021]="ShowBanner",e[e.HideBanner=1022]="HideBanner",e[e.HideBanner_2=1023]="HideBanner_2",e[e.ClickBanner=1024]="ClickBanner",e[e.Compose_OpenView=1025]="Compose_OpenView",e[e.Compose_CloseView=1026]="Compose_CloseView",e[e.Compose_TankChange=1027]="Compose_TankChange",e[e.Compose_StartOutPut=1028]="Compose_StartOutPut",e[e.Compose_OutPutGold=1029]="Compose_OutPutGold",e[e.Compose_UpdateModel=1030]="Compose_UpdateModel",e[e.Compose_OpenUnLockView=1031]="Compose_OpenUnLockView",e[e.Compose_CloseUnLockView=1032]="Compose_CloseUnLockView",e[e.Compose_OpenExtraRewardView=1033]="Compose_OpenExtraRewardView",e[e.Compose_CloseExtraRewardView=1034]="Compose_CloseExtraRewardView",e[e.Compose_OpenSelectTankView=1035]="Compose_OpenSelectTankView",e[e.Compose_CloseSelectTankView=1036]="Compose_CloseSelectTankView",e[e.Compose_OpenGetGoldView=1037]="Compose_OpenGetGoldView",e[e.Compose_CloseGetGoldView=1038]="Compose_CloseGetGoldView",e[e.Compose_UpdateSpeedUpTime=1039]="Compose_UpdateSpeedUpTime",e[e.Compose_OpenSpeedUpView=1040]="Compose_OpenSpeedUpView",e[e.Compose_CloseSpeedUpView=1041]="Compose_CloseSpeedUpView",e[e.Compose_OpenOfflineView=1042]="Compose_OpenOfflineView",e[e.Compose_OpenShopView=1043]="Compose_OpenShopView",e[e.Compose_CloseShopView=1044]="Compose_CloseShopView",e[e.Compose_ShopBuy=1045]="Compose_ShopBuy",e[e.Compose_SignCompose=1046]="Compose_SignCompose",e[e.Compose_OpenFreeUpView=1047]="Compose_OpenFreeUpView",e[e.Fight_StartGame=1048]="Fight_StartGame",e[e.Fight_EndGame=1049]="Fight_EndGame",e[e.Fight_OpenView=1050]="Fight_OpenView",e[e.Fight_CloseView=1051]="Fight_CloseView",e[e.Fight_UpdateBlood=1052]="Fight_UpdateBlood",e[e.Fight_GunUpdate=1053]="Fight_GunUpdate",e[e.Fight_ReloadGun=1054]="Fight_ReloadGun",e[e.Fight_CameraMove=1055]="Fight_CameraMove",e[e.Fight_onFire=1056]="Fight_onFire",e[e.Fight_AddEnemyPrefab=1057]="Fight_AddEnemyPrefab",e[e.Fight_Pause=1058]="Fight_Pause",e[e.Fight_KillNumChange=1059]="Fight_KillNumChange",e[e.Fight_TargetChange=1060]="Fight_TargetChange",e[e.Fight_ShowHurtNum=1061]="Fight_ShowHurtNum",e[e.Fight_OpenReliveView=1062]="Fight_OpenReliveView",e[e.Fight_CloseReliveView=1063]="Fight_CloseReliveView",e[e.Fight_OpenPauseView=1064]="Fight_OpenPauseView",e[e.Fight_ClosePauseView=1065]="Fight_ClosePauseView",e[e.Fight_BloodWarn=1066]="Fight_BloodWarn",e[e.Fight_ReliveSuccess=1067]="Fight_ReliveSuccess",e[e.Fight_BackToCompose=1068]="Fight_BackToCompose",e[e.Fight_CreateKickForce=1069]="Fight_CreateKickForce",e[e.Fight_UpdateGameScore=1070]="Fight_UpdateGameScore",e[e.Fight_ShowEffect=1071]="Fight_ShowEffect",e[e.Fight_StartNextStep=1072]="Fight_StartNextStep",e[e.Fight_AutoMoveCall=1073]="Fight_AutoMoveCall",e[e.Fight_ShowShake=1074]="Fight_ShowShake",e[e.Fight_HitDouble=1075]="Fight_HitDouble",e[e.Fight_UpdateGold=1076]="Fight_UpdateGold",e[e.Fight_AmbushUpdateScore=1077]="Fight_AmbushUpdateScore",e[e.Fight_AddAmbushTime=1078]="Fight_AddAmbushTime",e[e.Fight_HitWarnCar=1079]="Fight_HitWarnCar",e[e.Fight_openDiamonModeView=1080]="Fight_openDiamonModeView",e[e.Fight_StartDiamonMode=1081]="Fight_StartDiamonMode",e[e.Fight_UpdateTargetBlood=1082]="Fight_UpdateTargetBlood",e[e.Fight_loadScene=1083]="Fight_loadScene",e[e.Fight_loadSceneFinish=1084]="Fight_loadSceneFinish",e[e.Fight_ResetCameraPos=1085]="Fight_ResetCameraPos",e[e.Fight_OpenAmbushGuideView=1086]="Fight_OpenAmbushGuideView",e[e.Fight_KillExtraRewardInAmbush=1087]="Fight_KillExtraRewardInAmbush",e[e.Power_CloseBuyView=1088]="Power_CloseBuyView",e[e.Power_OpenBuyView=1089]="Power_OpenBuyView",e[e.Activity_RefreshSignPoint=1090]="Activity_RefreshSignPoint",e[e.Activity_RefreshDrawPoint=1091]="Activity_RefreshDrawPoint",e[e.Activity_RefreshGiftPoint=1092]="Activity_RefreshGiftPoint",e[e.Activity_OpenSignView=1093]="Activity_OpenSignView",e[e.Activity_CloseSignView=1094]="Activity_CloseSignView",e[e.Activity_OpenDrawView=1095]="Activity_OpenDrawView",e[e.Activity_CloseDrawView=1096]="Activity_CloseDrawView",e[e.Activity_OpenDrawReward=1097]="Activity_OpenDrawReward",e[e.Activity_UpdateDrawView=1098]="Activity_UpdateDrawView",e[e.Activity_OpenGiftView=1099]="Activity_OpenGiftView",e[e.Activity_OpenInviteView=1100]="Activity_OpenInviteView",e[e.Activity_OpenBoxView=1101]="Activity_OpenBoxView",e[e.Activity_OpenWelfareView=1102]="Activity_OpenWelfareView",e[e.Activity_RefreshInvitePoint=1103]="Activity_RefreshInvitePoint",e[e.Activity_RefreshBoxTankPoint=1104]="Activity_RefreshBoxTankPoint",e[e.Activity_GetBoxTank=1105]="Activity_GetBoxTank",e[e.Activity_SetBoxCountDown=1106]="Activity_SetBoxCountDown",e[e.Invite_GetTank=1107]="Invite_GetTank",e[e.ShowBoxGuide=1108]="ShowBoxGuide",e[e.CloseBoxGuide=1109]="CloseBoxGuide",e[e.CloseGuideBuy=1110]="CloseGuideBuy",e[e.ShowBoxEffect=1111]="ShowBoxEffect",e[e.Rank_OpenView=1112]="Rank_OpenView",e[e.Rank_CloseView=1113]="Rank_CloseView",e[e.Rank_CloseSurpassView=1114]="Rank_CloseSurpassView",e[e.Rank_OpenSurpassView=1115]="Rank_OpenSurpassView",e[e.Rank_PostGameMoney=1116]="Rank_PostGameMoney",e[e.Guide_CloseNewBieView=1117]="Guide_CloseNewBieView",e[e.Guide_OpenNewBieView=1118]="Guide_OpenNewBieView",e[e.Guide_OpenActionView=1119]="Guide_OpenActionView",e[e.Guide_ActionFinish=1120]="Guide_ActionFinish",e[e.Guide_ActionStart=1121]="Guide_ActionStart",e[e.Guide_ShowGuide=1122]="Guide_ShowGuide",e[e.Guide_CloseGuide=1123]="Guide_CloseGuide",e[e.Guide_CheckGuide=1124]="Guide_CheckGuide",e[e.Guide_OpenNewGuideView=1125]="Guide_OpenNewGuideView",e[e.Guide_CloseNewGuideView=1126]="Guide_CloseNewGuideView",e[e.Guide_NewGuideNextStep=1127]="Guide_NewGuideNextStep",e[e.Guide_NewGuideStepFinish=1128]="Guide_NewGuideStepFinish",e[e.DSP_OpenDSPMainView=1129]="DSP_OpenDSPMainView",e[e.DSP_OpenDSPResultView=1130]="DSP_OpenDSPResultView",e[e.DSP_CloseDSPResultView=1131]="DSP_CloseDSPResultView",e[e.DSP_CloseDSPMainView=1132]="DSP_CloseDSPMainView",e[e.DSP_ShowDSPMainView=1133]="DSP_ShowDSPMainView",e[e.Dsp_ShowColorBg=1134]="Dsp_ShowColorBg",e[e.Dsp_CloseColorBg=1135]="Dsp_CloseColorBg",e[e.DSP_OpenTestPlayView=1136]="DSP_OpenTestPlayView",e[e.DSP_RefreshTestPlayPoint=1137]="DSP_RefreshTestPlayPoint",e[e.ZiJie_OpenView=1138]="ZiJie_OpenView",e[e.ZiJie_CloseView=1139]="ZiJie_CloseView",e[e.FreeUpTank=1140]="FreeUpTank",e[e.ShowDspPanel=1141]="ShowDspPanel",e[e.Resume_CountDown=1142]="Resume_CountDown"}(i.ListenID||(i.ListenID={})),cc._RF.pop()},{}],LoaderAdapter:[function(e,t,i){"use strict";cc._RF.push(t,"29aadtFtNRNkKMoN7BFx+KK","LoaderAdapter"),Object.defineProperty(i,"__esModule",{value:!0}),i.LoaderAdapter=void 0;const s=e("./AssetLoader"),n=e("./ResUtil");i.LoaderAdapter=new class{constructor(){this.globalUseId=0}loadRes(){let e=s.default.makeLoadResArgs.apply(this,arguments);s.assetLoader.loadRes(e.url,e.type,e.onProgess,e.onCompleted,e.bundle)}preloadRes(){let e=s.default.makeLoadResArgs.apply(this,arguments);s.assetLoader.preloadRes(e.url,e.type,e.onProgess,e.onCompleted,e.bundle)}releaseAsset(e){s.assetLoader.releaseAsset(e)}loadSpriteAsync(e,t){return new Promise((i,s)=>{this.loadRes(e,cc.SpriteFrame,(e,n)=>{if(e)s(e);else{let e=n;n instanceof cc.Texture2D&&(e=new cc.SpriteFrame(n)),t&&cc.isValid(t)&&this.setAutoRelease(e,t,!0),i(e)}})})}loadSpine(e,t){return new Promise((i,s)=>{this.loadRes(e,sp.SkeletonData,(e,n)=>{if(e)s(e);else{let e=n;t&&cc.isValid(t)&&this.setAutoRelease(e,t,!0),i(e)}})})}loadSpriteAltasAsync(e,t){return new Promise((i,s)=>{this.loadRes(e,cc.SpriteAtlas,(e,n)=>{e?s(e):(t&&cc.isValid(t)&&this.setAutoRelease(n,t),i(n))})})}loadPrefab(e){return new Promise((t,i)=>{this.loadRes(e,cc.Prefab,(e,s)=>{if(e)i(e);else{let e=this.instantiate(s);t(e)}})})}instantiate(e){let t=cc.instantiate(e);return this.setAutoRelease(e,t,!0),t}loadDragonBones(e,t,i){return new Promise((s,n)=>{this.loadRes(e,dragonBones.DragonBonesAsset,(e,o)=>{if(e)n();else{let e=o;i&&cc.isValid(i)&&(this.setAutoRelease(o,i,!0),this.loadRes(t,dragonBones.DragonBonesAtlasAsset,(t,o)=>{t?n():(this.setAutoRelease(o,i,!0),s({asset:e,atlasAsset:o}))}))}})})}loadDragonBonesByPath(e,t,i,n){var o=t.getComponent(dragonBones.ArmatureDisplay);if(!o)return;let a=this;s.assetLoader.loadResDir(e,function(e,s){if(!(e||s.length<=0)){for(var r in o.dragonAsset=null,o.dragonAtlasAsset=null,s)s[r]instanceof dragonBones.DragonBonesAsset&&(o.dragonAsset=s[r],a.setAutoRelease(s[r],t,!0)),s[r]instanceof dragonBones.DragonBonesAtlasAsset&&(o.dragonAtlasAsset=s[r],a.setAutoRelease(s[r],t,!0));o.armatureName="Armature",i&&(o.playAnimation(o.getAnimationNames(o.getArmatureNames()[0])[0],-1),o.timeScale=1),n&&n()}})}setAutoRelease(e,t,i){let s=n.ResUtil.getResKeeper(t,i);return e&&s?(s.autoReleaseRes({asset:e}),e):null}makeUseKey(){return`@useKey_${this.globalUseId++}`}},cc._RF.pop()},{"./AssetLoader":"AssetLoader","./ResUtil":"ResUtil"}],LoginController:[function(e,t,i){"use strict";cc._RF.push(t,"a70e6R87YFPtZDpjXacyZfx","LoginController"),Object.defineProperty(i,"__esModule",{value:!0}),i.LoginController=void 0;const s=e("../../ListenID"),n=e("../../config/Const"),o=e("../../frame/MVC"),a=e("../../frame/Notifier"),r=e("../../manager/GameVoManager");i.LoginController=class extends o.MVC.BaseController{constructor(){super("LoginController"),this.changeListener(!0)}changeListener(e){a.Notifier.changeListener(e,s.ListenID.Login_Start,this.onLoginStart,this),a.Notifier.changeListener(e,s.ListenID.Login_Finish,this.onLoginFinish,this)}onLoginStart(){}onLoginFinish(){a.Notifier.send(s.ListenID.Compose_StartOutPut),this.loadResSuc()}loadResSuc(){r.GameVoManager.getInstance.myUserVo.lastSceneId=n.Const.defaultSceneId,cc.director.loadScene(n.Const.GAME_SCENENAME,()=>{})}},cc._RF.pop()},{"../../ListenID":"ListenID","../../config/Const":"Const","../../frame/MVC":"MVC","../../frame/Notifier":"Notifier","../../manager/GameVoManager":"GameVoManager"}],LoginModel:[function(e,t,i){"use strict";cc._RF.push(t,"e57b1v0x1RBcJg9yusvM6GK","LoginModel"),Object.defineProperty(i,"__esModule",{value:!0}),i.LoginModel=void 0;const s=e("../../frame/MVC");let n=(()=>{class e extends s.MVC.BaseModel{constructor(){super(),null==e._instance&&(e._instance=this)}reset(){}static get getInstance(){return null==e._instance&&(e._instance=new e),e._instance}}return e._instance=null,e})();i.LoginModel=n,cc._RF.pop()},{"../../frame/MVC":"MVC"}],MVC:[function(e,t,i){"use strict";cc._RF.push(t,"9b21bj5uxhCd4IpAuTKyYZ1","MVC"),Object.defineProperty(i,"__esModule",{value:!0}),i.MVC=void 0;const s=e("./Transition/DefaultTransition"),n=e("./Transition/ScaleTransition"),o=e("./Transition/MoveTransition"),a=e("./Transition/EaseScaleTransition"),r=e("./Transition/AnimTransition");(function(e){e.BaseModel=class{};e.BaseController=class{constructor(e){this._name="",this._name=e,d.add(this)}get _classname(){return this._name}reset(){}changeListener(e){}};let t,i,c,l,h,d=(()=>{class e{static add(t){const i=t._classname;null==e.getInstance(i)?e.s_container.push(t):cc.error("LogicContainer.Add repeat:"+i)}static getInstance(t){for(const i of e.s_container)if(i._classname==t)return i;return null}static reset(){for(let t=0;t<e.s_container.length;t++)e.s_container[t].reset()}}return e.s_container=[],e})();e.ControllerContainer=d;class u{static get loadAssetHandler(){return u._loadAssetHandler}static get unloadAssetHandler(){return u._unloadAssetHandler}static initAssetHandler(e,t){u._loadAssetHandler=e,u._unloadAssetHandler=t}static get onOpenEvent(){return u._onOpenEvent}static get onCloseEvent(){return u._onCloseEvent}static initUIEvent(e,t){u._onOpenEvent=e,u._onCloseEvent=t}}e.ViewHandler=u;class m{static get loadAssetHandler(){return m._loadAssetHandler}static get unloadAssetHandler(){return m._unloadAssetHandler}static initAssetHandler(e,t){m._loadAssetHandler=e,m._unloadAssetHandler=t}}e.ComponentHandler=m;e.BaseView=class extends cc.Component{constructor(){super(...arguments),this._isClosed=!1,this._isOpened=!1}init(e=c.Panel,i=t.Default,l,h=!1){switch(this._uiLayer=e,this._assetsPath=l,i){case t.Scale:this._transition=new n.ScaleTransition;break;case t.Move:this._transition=new o.MoveTransition;break;case t.EaseScale:this._transition=new a.EaseScaleTransition;break;case t.Anim:this._transition=new r.AnimTransition;break;case t.Default:default:this._transition=new s.DefaultTransition}this._transition.init(this.node,h),this._isClosed=!1,this._isOpened=!1,this._isclean=h}get uiLayer(){return this._uiLayer}get assetsPath(){return this._assetsPath}get isClosed(){return this._isClosed}get isOpened(){return this._isOpened}open(e=null){this._isOpened?this.setInfo(e):(this.onOpen(e),this._transition.show().then(()=>{this.openCallBack()}),this._isClosed=!1,this._isOpened=!0)}onOpen(e=null){this.changeListener(!0),u.onOpenEvent(this)}onClose(){this._isClosed?cc.warn(`asset ${this._assetsPath} is closing`):(this._isClosed=!0,this._isOpened=!1,this.changeListener(!1),u.onCloseEvent(this,this._assetsPath,this._isclean),this._transition.hide())}close(){this.onClose()}onClickFrame(){}setInfo(e){}openCallBack(){}},function(e){e[e.Default=0]="Default",e[e.Scale=1]="Scale",e[e.Move=2]="Move",e[e.EaseScale=3]="EaseScale",e[e.Anim=4]="Anim"}(t=e.eTransition||(e.eTransition={})),function(e){e[e.Unload=0]="Unload",e[e.Loading=1]="Loading",e[e.Loaded=2]="Loaded"}(i=e.eLoadState||(e.eLoadState={})),function(e){e[e.Scene=0]="Scene",e[e.Main=1]="Main",e[e.Panel=2]="Panel",e[e.Popup=3]="Popup",e[e.Guide=4]="Guide",e[e.Tips=5]="Tips",e[e.Loading=6]="Loading",e[e.Max=7]="Max"}(c=e.eUILayer||(e.eUILayer={})),function(e){e[e.Panel=0]="Panel",e[e.None=1]="None"}(l=e.eUIQueue||(e.eUIQueue={})),function(e){e[e.Timeout=-2]="Timeout",e[e.Refuse=-1]="Refuse",e[e.Cancel=0]="Cancel",e[e.Confirm=1]="Confirm"}(h=e.eReplyOption||(e.eReplyOption={}))})(i.MVC||(i.MVC={})),cc._RF.pop()},{"./Transition/AnimTransition":"AnimTransition","./Transition/DefaultTransition":"DefaultTransition","./Transition/EaseScaleTransition":"EaseScaleTransition","./Transition/MoveTransition":"MoveTransition","./Transition/ScaleTransition":"ScaleTransition"}],MainRole:[function(e,t,i){"use strict";cc._RF.push(t,"844b72vc2FEf78FFyoZ8hiW","MainRole"),Object.defineProperty(i,"__esModule",{value:!0});const s=e("./Role"),n=e("./Gun"),o=e("../../../config/Const"),a=e("../../../frame/Notifier"),r=e("../../../ListenID"),c=e("../FightModel"),l=e("../../../frame/Time"),h=e("../../../frame/MVC"),d=e("../../../config/Cfg"),u=e("../../../manager/GameVoManager"),m=e("../../../manager/Manager"),g=e("../../../utils/Util"),p=e("../../../manager/AudioManager");i.default=class extends s.default{constructor(){super(),this.isReady=!1,this.isCanReliVe=!1,this.hitaudios=[313,314,315,316,317],this.roleId=0,this.changeListener(!0),this.gunObject=new n.default(o.Const.GunBelong.Player,this)}changeListener(e){}init(e,t){this.roleId=e;let i=d.Cfg.Tank.get(u.GameVoManager.getInstance.myUserVo.useTankId);this.initHp(i.hp),this.isDead=!1,this.isReadyFire=!1,this.isReady=!0,this.isCanReliVe=!0,this.gunObject.setGunInfo(t.useTankId),this.attackDelta=this.gunObject.attackDelta}initHp(e){this.curHp=e,this.allHp=e,this.playaudioState=0,a.Notifier.send(r.ListenID.Fight_UpdateBlood,this.curHp,this.allHp)}get bulltNum(){return this.gunObject.leftBulletNum}onRelive(){let e=d.Cfg.Tank.get(u.GameVoManager.getInstance.myUserVo.useTankId);this.initHp(e.hp),this.isReadyFire=!0,this.isDead=!1}update(e){this.attackDelta-=e,this.isReadyFire?this.onAttack():this.attackDelta<=0&&!this.isDead&&(this.attackDelta=this.gunObject.attackDelta,this.isReadyFire=!0),this.gunObject.update(e)}onAttack(){this.targetId>=0&&(this.isReadyFire=!1,this.gunObject.onFire(this.targetId,this.targetArea,this.roleId))}beHit(e){this.curHp-=e.attackNum,this.curHp<0&&(this.curHp=0),a.Notifier.send(r.ListenID.Fight_BloodWarn,this.curHp,this.allHp,e.attackPos),a.Notifier.send(r.ListenID.Fight_ShowShake),this.playHitAudio(this.curHp/this.allHp),this.curHp<=0&&!this.isDead&&c.default.getInstance.isFighting&&(this.isDead=!0,this.isCanReliVe&&u.GameVoManager.getInstance.myUserVo.isKillHalf?(this.isCanReliVe=!1,a.Notifier.send(r.ListenID.Fight_Pause,!0),l.Time.delay(.5,()=>{a.Notifier.send(r.ListenID.Fight_OpenReliveView,h.MVC.eUILayer.Popup)})):a.Notifier.send(r.ListenID.Fight_EndGame,!1))}playHitAudio(e){let t=g.Util.random(0,this.hitaudios.length);this.hitaudios[t]&&m.Manager.audio.playAudio(this.hitaudios[t],p.AudioType.BeHit),this.playaudioState<=0&&e<.7&&e>=.3?(this.playaudioState=1,m.Manager.audio.playAudio(this.getAudioId(this.playaudioState),p.AudioType.MyTalk)):this.playaudioState<=1&&e<.3&&e>0?(this.playaudioState=2,m.Manager.audio.playAudio(this.getAudioId(this.playaudioState),p.AudioType.MyTalk)):this.playaudioState<=2&&e<=0&&(this.playaudioState=3,m.Manager.audio.playAudio(this.getAudioId(this.playaudioState),p.AudioType.MyTalk))}getAudioId(e){let t=g.Util.random(0,999);return 1==e?t>500?305:306:2==e?300+Math.floor(t/335):3==e?t>500?303:304:0}},cc._RF.pop()},{"../../../ListenID":"ListenID","../../../config/Cfg":"Cfg","../../../config/Const":"Const","../../../frame/MVC":"MVC","../../../frame/Notifier":"Notifier","../../../frame/Time":"Time","../../../manager/AudioManager":"AudioManager","../../../manager/GameVoManager":"GameVoManager","../../../manager/Manager":"Manager","../../../utils/Util":"Util","../FightModel":"FightModel","./Gun":"Gun","./Role":"Role"}],Manager:[function(e,t,i){"use strict";cc._RF.push(t,"2975aEoaitM378TVHM5q+uT","Manager"),Object.defineProperty(i,"__esModule",{value:!0}),i.Manager=void 0;const s=e("../loader/LoaderAdapter"),n=e("./AudioManager"),o=e("./StorageManager"),a=e("./AnimateManager"),r=e("./SpriteAtlasManager");i.Manager=new class{get loader(){return s.LoaderAdapter}get audio(){return null==this._audio&&(this._audio=new n.AudioManager),this._audio}get anim(){return null==this._animation&&(this._animation=new a.AnimateManager),this._animation}get storage(){return null==this._storage&&(this._storage=new o.StorageManager),this._storage}get spAtlas(){return null==this._spatlas&&(this._spatlas=new r.SpriteAtlasManager),this._spatlas}},cc._RF.pop()},{"../loader/LoaderAdapter":"LoaderAdapter","./AnimateManager":"AnimateManager","./AudioManager":"AudioManager","./SpriteAtlasManager":"SpriteAtlasManager","./StorageManager":"StorageManager"}],Math:[function(e,t,i){"use strict";cc._RF.push(t,"d6404mbs7RG46Zx07vYwlDo","Math"),Math.intRange=function(e,t){let i=t-e;return Math.round(Math.random()*i)+e},Math.lerp=function(e,t,i){return e+(t-e)*i},cc._RF.pop()},{}],MinHeap:[function(e,t,i){"use strict";cc._RF.push(t,"60da0zi0YRI0aFcd6znd/al","MinHeap"),Object.defineProperty(i,"__esModule",{value:!0}),i.MinHeap=void 0;i.MinHeap=class{constructor(e){this._size=0,this.m_emptyNum=0,this.m_log="",this._compareEv=e,this._element=new Array}clear(e=null,t=null){null!=this._element&&(this._size=0,null!=e&&this._element.forEach(i=>{e.call(t,i)}),this._element.splice(0,this._element.length))}frist(e,t=null){if(null==e)return cc.error("MinHeap Frist predicate null"),null;if(null==this._element)return null;for(let i=0;i<this._element.length;i++){const s=this._element[i];if(e.call(t,s))return s}return null}forEach(e,t){null!=this._element&&this._element.forEach(i=>{e.call(t,i)})}toStringT(e){null!=e?this.m_log+=e.toString()+"\n":++this.m_emptyNum}toString(){return this.m_emptyNum=0,this.m_log="",this.forEach(this.toStringT,this),this.m_emptyNum>0&&(this.m_log+="empty:"+this.m_emptyNum),this.m_log}get size(){return this._size}add(e){let t=this._size++;this.up(t,e)}del(e){let t=this._element.indexOf(e);t<0||(--this._size,this.down(t,this._element[this._size]),this.insert(this._size,null))}peek(){return this._size<=0?null:this._element[0]}pop(){if(this._size<=0)return null;let e=this._element[0],t=--this._size;return this.down(0,this._element[t]),this.insert(t,null),e}change(e,t){let i=this._element.indexOf(e);i<0||(t?this.down(i,e):this.up(i,e))}insert(e,t){this._element.length<=e?this._element.splice(e,0,t):this._element[e]=t}up(e,t){for(;e>0;){let i=(e-1)/2,s=this._element[i];if(this._compareEv(this._element[i],t)<0)break;this.insert(e,s),e=i}this.insert(e,t)}down(e,t){let i=this._size/2;for(;e<i;){let i=2*e+1,s=i+1,n=this._element[i],o=this._element[s];if(s<this._size&&this._compareEv(n,o)>0&&(i=s),this._compareEv(t,this._element[i])<0)break;this.insert(e,this._element[i]),e=i}this.insert(e,t)}},cc._RF.pop()},{}],MinSortList:[function(e,t,i){"use strict";cc._RF.push(t,"bbc34/EB1NHgqKIcM8Oia7M","MinSortList"),Object.defineProperty(i,"__esModule",{value:!0}),i.MinSortList=void 0;i.MinSortList=class{constructor(e){this._count=0,this.m_emptyNum=0,this.m_log="",this._compareEv=e,this._element=new Array}get count(){return this._count}clear(e=null,t=null){this._count=0,null!=e&&this._element.forEach(i=>{e.call(t,i)}),this._element.splice(0,this._element.length)}frist(e,t=null){if(null==e)return cc.error("MinSortList Frist predicate null"),null;if(null==this._element)return null;for(let i=0;i<this._element.length;i++){const s=this._element[i];if(e.call(t,s))return s}return null}forEach(e,t){null!=this._element&&this._element.forEach(i=>{e.call(t,i)})}add(e){this._element.push(e),this.sortDown(this._count,e),++this._count}del(e){let t=this._element.indexOf(e);return!(t<0||(--this._count,this._element.splice(t,1),0))}peek(){return this._count<=0?null:this._element[0]}pop(){return this._count<=0?null:(--this._count,this._element.shift())}sort(e){let t=this._element.indexOf(e);if(!(t<0))if(0==t)this.sortUp(t,e);else if(t==this.count-1)this.sortDown(t,e);else{let i=this._element[t-1];this._compareEv(i,e)>0?this.sortDown(t,e):this.sortUp(t,e)}}sortDown(e,t){let i;for(let s=e-1;s>=0&&(i=this._element[s],!(this._compareEv(i,t)<=0));s--)this._element[s]=t,this._element[s+1]=i}sortUp(e,t){let i;for(let s=e+1;s<this._count&&(i=this._element[s],!(this._compareEv(i,t)>=0));s++)this._element[s-1]=i,this._element[s]=t}toStringT(e){null!=e?this.m_log+=e.toString()+"\n":++this.m_emptyNum}toString(){return this.m_emptyNum=0,this.m_log="",this.forEach(this.toStringT,this),this.m_emptyNum>0&&(this.m_log+="empty:"+this.m_emptyNum),this.m_log}},cc._RF.pop()},{}],ModuleLauncher:[function(e,t,i){"use strict";cc._RF.push(t,"b9d7a881KZGBJG8hZFdt24g","ModuleLauncher"),Object.defineProperty(i,"__esModule",{value:!0}),i.ModuleLauncher=void 0;const s=e("../module/login/LoginController"),n=e("../module/compose/ComposeController"),o=e("../module/fight/FightController"),a=e("../module/setting/SettingController"),r=e("../module/power/PowerController"),c=e("../module/activity/ActivityController"),l=e("../module/rank/RankController"),h=e("../module/guide/GuideController"),d=e("../module/zijie/ZiJieController"),u=e("../common/BannerController");i.ModuleLauncher=class{constructor(){new r.PowerController,new s.LoginController,new n.ComposeController,new o.FightController,new a.SettingController,new c.ActivityController,new l.RankController,new h.GuideController,new u.BannerController,window.tt&&new d.ZiJieController}},cc._RF.pop()},{"../common/BannerController":"BannerController","../module/activity/ActivityController":"ActivityController","../module/compose/ComposeController":"ComposeController","../module/fight/FightController":"FightController","../module/guide/GuideController":"GuideController","../module/login/LoginController":"LoginController","../module/power/PowerController":"PowerController","../module/rank/RankController":"RankController","../module/setting/SettingController":"SettingController","../module/zijie/ZiJieController":"ZiJieController"}],MoveTransition:[function(e,t,i){"use strict";cc._RF.push(t,"0f5a0gw6bJNF6L1Cw1q8JC1","MoveTransition"),Object.defineProperty(i,"__esModule",{value:!0}),i.MoveTransition=void 0;i.MoveTransition=class{constructor(){this._animSpeed=.3,this._moveDist=1e3,this.isClean=!1}init(e,t){this._node=e,this._node.x-=this._moveDist,this.isClean=t;var i=cc.callFunc(this.onMoveOutFinish,this),s=cc.callFunc(this.onMoveInFinish,this);this._moveInAct=cc.sequence(cc.spawn(cc.fadeTo(this._animSpeed,255),cc.moveBy(this._animSpeed,this._moveDist,0)),s),this._moveOutAct=cc.sequence(cc.spawn(cc.fadeTo(this._animSpeed,0),cc.moveBy(this._animSpeed,-this._moveDist,0)),i)}show(){return new Promise(e=>{null!=this._node&&(this._node.active=!0,this._node.opacity=0,cc.tween(this._node).then(cc.sequence(this._moveInAct,cc.callFunc(()=>{e(null)}))).start())})}hide(){null!=this._node&&cc.tween(this._node).then(this._moveOutAct).start()}onMoveInFinish(){}onMoveOutFinish(){this.isClean?this._node.destroy():this._node.active=!1}},cc._RF.pop()},{}],NetErrorAlert:[function(e,t,i){"use strict";cc._RF.push(t,"1d79ePSKnREO4bVQpy3H77b","NetErrorAlert");var s=this&&this.__decorate||function(e,t,i,s){var n,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});const n=e("../frame/MVC"),{ccclass:o,property:a}=cc._decorator;let r=(()=>{let e=class extends n.MVC.BaseView{constructor(){super(...arguments),this.cbConfirm=null}start(){}changeListener(e){}onOpen(e){super.onOpen(e),this.cbConfirm=e&&e.errorcb}onClose(){super.onClose(),this.cbConfirm&&this.cbConfirm()}};return e=s([o],e)})();i.default=r,cc._RF.pop()},{"../frame/MVC":"MVC"}],NetLauncher:[function(e,t,i){"use strict";cc._RF.push(t,"04bd1DomkJFdLviyZ6e4u5f","NetLauncher"),Object.defineProperty(i,"__esModule",{value:!0}),i.NetLauncher=void 0;i.NetLauncher=class{constructor(){}},cc._RF.pop()},{}],NewGuideView:[function(e,t,i){"use strict";cc._RF.push(t,"7e99ajoo5tOVpdBY04D/M7g","NewGuideView");var s=this&&this.__decorate||function(e,t,i,s){var n,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});const n=e("../../frame/MVC"),o=e("../../frame/Notifier"),a=e("../../ListenID"),{ccclass:r,property:c}=cc._decorator;let l=(()=>{let e=class extends n.MVC.BaseView{constructor(){super(...arguments),this.guideEffect=null,this.guideShou=null,this.text_0=null,this.text_1=null,this.text_2=null,this.img_tips=null,this.guideNode=null,this.guideEffectAnima=null,this.guideShouAnima=null,this.imgTipsAnima=null,this.nextStep=1}changeListener(e){o.Notifier.changeListener(e,a.ListenID.Guide_NewGuideStepFinish,this.finishGuideStep,this)}onOpen(e){super.onOpen(e),this.initNode(),this.guideStep(e)}onClose(){super.onClose()}initNode(){this.guideEffectAnima=this.guideEffect.getComponent(cc.Animation),this.guideShouAnima=this.guideShou.getComponent(cc.Animation),this.imgTipsAnima=this.img_tips.getComponent(cc.Animation)}guideStep(e=1){this.text_0.active=1==e,this.text_1.active=2==e,this.text_2.active=3==e,1==e?(this.guideEffectAnima.play("guideEffect"),this.guideShouAnima.play("guideShou_0")):2==e?(this.guideNode.active=!0,this.guideEffect.scaleX=-1,this.guideEffectAnima.play("guideEffect"),this.guideShouAnima.play("guideShou_1")):3==e?(this.guideNode.active=!0,this.guideEffect.active=!1,this.guideShou.active=!1):super.close()}finishGuideStep(e){this.nextStep=e+1,1==e?this.guideShouAnima.stop("guideShou_0"):2==e&&this.guideShouAnima.stop("guideShou_1"),this.guideEffectAnima.stop("guideEffect"),this.guideNode.active=!1,this.img_tips.active=!0,this.imgTipsAnima.play(),this.imgTipsAnima.on("finished",this.animaEnd,this)}animaEnd(){this.imgTipsAnima.off("finished",this.animaEnd,this),this.img_tips.active=!1,this.guideStep(this.nextStep),o.Notifier.send(a.ListenID.Guide_NewGuideNextStep,this.nextStep-1)}};return s([c(cc.Node)],e.prototype,"guideEffect",void 0),s([c(cc.Node)],e.prototype,"guideShou",void 0),s([c(cc.Node)],e.prototype,"text_0",void 0),s([c(cc.Node)],e.prototype,"text_1",void 0),s([c(cc.Node)],e.prototype,"text_2",void 0),s([c(cc.Node)],e.prototype,"img_tips",void 0),s([c(cc.Node)],e.prototype,"guideNode",void 0),e=s([r],e)})();i.default=l,cc._RF.pop()},{"../../ListenID":"ListenID","../../frame/MVC":"MVC","../../frame/Notifier":"Notifier"}],NormalTips:[function(e,t,i){"use strict";cc._RF.push(t,"4b2f589ebBNd5l6X2pme3TJ","NormalTips");var s=this&&this.__decorate||function(e,t,i,s){var n,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});const{ccclass:n,property:o}=cc._decorator;let a=(()=>{let e=class extends cc.Component{constructor(){super(...arguments),this.label=null,this.bg=null}start(){}setText(e){this.label.string=e}unuse(){}reuse(){}};return s([o(cc.Label)],e.prototype,"label",void 0),s([o(cc.Node)],e.prototype,"bg",void 0),e=s([n],e)})();i.default=a,cc._RF.pop()},{}],Notifier:[function(e,t,i){"use strict";cc._RF.push(t,"f1098BuXtdDFpgC8ct6SzsF","Notifier"),Object.defineProperty(i,"__esModule",{value:!0}),i.Notifier=i.PriorHighest=i.PriorHigh=i.PriorMiddle=i.PriorLow=i.PriorLowest=void 0;const s=e("./NotifyListener"),n=e("./NotifyCaller");i.PriorLowest=-200,i.PriorLow=-100,i.PriorMiddle=0,i.PriorHigh=100,i.PriorHighest=200;let o=(()=>{class e{static addListener(e,t,s,n=i.PriorMiddle){this.m_listener.Register(e,t,s,n)}static delListener(e,t,i){this.m_listener.Unregister(e,t,i)}static changeListener(e,t,s,n,o=i.PriorMiddle){e?this.addListener(t,s,n,o):this.delListener(t,s,n)}static send(e,t,i,s,n){this.m_listener.Send(e,t,i,s,n)}static clean(e){this.m_listener.clean(e)}static isExist(e){return this.m_listener.IsExist(e)}static setCall(e,t,i){return this.m_caller.Register(e,t,i)}static delCall(e,t,i){return this.m_caller.Unregister(e,t,i)}static changeCall(e,t,i,s){return e?this.setCall(t,i,s):this.delCall(t,i,s)}static call(e,t,i,s,n){return this.m_caller.Call(e,t,i,s,n)}}return e.m_listener=new s.NotifyListener,e.m_caller=new n.NotifyCaller,e})();i.Notifier=o,cc._RF.pop()},{"./NotifyCaller":"NotifyCaller","./NotifyListener":"NotifyListener"}],NotifyCaller:[function(e,t,i){"use strict";cc._RF.push(t,"c1cd2Xr+YNKS4zAlh4E1Tu6","NotifyCaller"),Object.defineProperty(i,"__esModule",{value:!0}),i.NotifyCaller=void 0;i.NotifyCaller=class{constructor(){this.m_calls={}}Register(e,t,i){return null!=t&&(null==this.m_calls[e]&&(this.m_calls[e]={func:t,context:i},!0))}Unregister(e,t,i){const s=this.m_calls[e];return null!=s&&s.func===t&&s.context==i&&(delete this.m_calls[e],!0)}Call(e,t,i,s,n){const o=this.m_calls[e];if(null!=o)return o.func.call(o.context,t,i,s,n);cc.error("[NotifyCaller].Call can't find:"+e)}},cc._RF.pop()},{}],NotifyID:[function(e,t,i){"use strict";cc._RF.push(t,"e49d567A3BCsofzuqwgqanD","NotifyID"),Object.defineProperty(i,"__esModule",{value:!0}),i.NotifyID=void 0,function(e){e[e.App_Start=1]="App_Start",e[e.App_Pause=2]="App_Pause",e[e.Game_Update=3]="Game_Update",e[e.SDK_Banner_Resize=4]="SDK_Banner_Resize",e[e.Time_Scale=5]="Time_Scale",e[e.Game_OnHide=6]="Game_OnHide",e[e.Game_OnShow=7]="Game_OnShow",e[e.OPEN_PANEL=8]="OPEN_PANEL",e[e.CLOSE_PANEL=9]="CLOSE_PANEL"}(i.NotifyID||(i.NotifyID={})),cc._RF.pop()},{}],NotifyListener_Interl:[function(e,t,i){"use strict";cc._RF.push(t,"1661c0NfpNGo5plMjoyvq/w","NotifyListener_Interl"),Object.defineProperty(i,"__esModule",{value:!0}),i.ListenerManager=i.kWarningStackDepth=i.kMaxStackDepth=void 0,i.kMaxStackDepth=15,i.kWarningStackDepth=10;class s{constructor(e,t,i){this._prior=0,this._sendTimes=0,this._callback=e,this._context=t,this._prior=i}get context(){return this._context}get callback(){return this._callback}get prior(){return this._prior}get sendTimes(){return this._sendTimes}SetSendTimes(e){this._sendTimes=e}}i.ListenerManager=class{constructor(e){this.m_sendTimes=0,this.m_id=0,this.m_id=e,this.m_handlers=new Array}toString(){return"<ListenerManager id:%{m_id}, times:%{m_sendTimes}>"}IsExistHandler(e,t){if(this.m_handlers.length>0)for(let i=this.m_handlers.length-1;i>=0;i--){const s=this.m_handlers[i];if(s.callback===e&&s.context==t)return!0}return!1}AddHandler(e,t,i){let n=new s(e,t,i);if(this.m_handlers.length>0){let e=!1;for(let t=this.m_handlers.length-1;t>=0;t--)if(n.prior>=this.m_handlers[t].prior){this.m_handlers.splice(t+1,0,n),e=!0;break}e||this.m_handlers.unshift(n)}else this.m_handlers.push(n);return!0}RemoveHandler(e,t){let i=-1;if(this.m_handlers.length>0)for(let s=this.m_handlers.length-1;s>=0;s--){const n=this.m_handlers[s];if(n.callback===e&&n.context==t){i=s;break}}return-1!=i&&(this.m_handlers.splice(i,1),!0)}Send(e,t,i,s){++this.m_sendTimes;for(let n=this.m_handlers.length-1;n>=0;n--){const o=this.m_handlers[n];o&&(o.sendTimes>=this.m_sendTimes||(o.SetSendTimes(this.m_sendTimes),o.callback.call(o.context,e,t,i,s)))}}clean(){if(this.m_handlers.length>0)for(let e=this.m_handlers.length-1;e>=0;e--)null==this.m_handlers[e].context&&this.m_handlers.splice(e,1)}},cc._RF.pop()},{}],NotifyListener:[function(e,t,i){"use strict";cc._RF.push(t,"038ad1l7zFP7Kd6LyKoiaV8","NotifyListener"),Object.defineProperty(i,"__esModule",{value:!0}),i.NotifyListener=void 0;const s=e("./NotifyListener_Interl");let n=(()=>{class e{constructor(){this.m_managers={},this.m_callStacks=[]}GetCellStackString(){let e="[";for(const t of this.m_callStacks)e+=t+",";return e+="]"}CheckAndPushCallStack(e){const t=this.m_callStacks.length;return t>=s.kMaxStackDepth?(cc.error("[NotifyListener].Send out call stack:"+this.GetCellStackString()+" msg:"+e),!1):t>=s.kWarningStackDepth?(cc.warn("[NotifyListener].Send warning call stack:"+this.GetCellStackString()+" msg:"+e),!1):(this.m_callStacks.push(e),!0)}PopCallStack(){this.m_callStacks.pop()}Register(e,t,i,n){if(null==t)return void cc.error("[NotifyListener].Register:"+e+" callback null");let o=this.m_managers[e];if(null==o)o=new s.ListenerManager(e),this.m_managers[e]=o;else if(o.IsExistHandler(t,i))return void cc.error("[NotifyListener].Register:"+e+" callback repeat, skip",i);o.AddHandler(t,i,n)}Unregister(t,i,s){let n=this.m_managers[t];null!=n?n.RemoveHandler(i,s)||e.enableLog&&cc.warn("[NotifyListener].Unregister:"+t+" can't find callback:"+i):e.enableLog&&cc.warn("[NotifyListener].Unregister can't find ListenerManager:"+t+" callback:"+i,s)}Send(t,i,s,n,o){let a=this.m_managers[t];null!=a?this.CheckAndPushCallStack(t)&&(a.Send(i,s,n,o),this.PopCallStack()):e.enableLog}IsExist(e){return null!=this.m_managers[e]}clean(e){let t=this.m_managers[e];t&&t.clean()}}return e.enableLog=!1,e})();i.NotifyListener=n,cc._RF.pop()},{"./NotifyListener_Interl":"NotifyListener_Interl"}],ObjectPool:[function(e,t,i){"use strict";cc._RF.push(t,"d1275U49D1L843CNBcbDMPv","ObjectPool"),Object.defineProperty(i,"__esModule",{value:!0}),i.ObjectPool=void 0;i.ObjectPool=class{constructor(e,t=null,i=null){this._ctor=e,this._queue=new Array,this._onPop=t,this._onPush=i}pop(){let e;return e=this._queue.length>0?this._queue.shift():this._ctor(),null!=this._onPop&&this._onPop(e),e}push(e){null!=this._onPush&&this._onPush(e),this._queue.push(e)}clear(){this._queue=[]}},cc._RF.pop()},{}],OfflineView:[function(e,t,i){"use strict";cc._RF.push(t,"c6066UO6U1Iy7Z+5cWkfxMP","OfflineView");var s=this&&this.__decorate||function(e,t,i,s){var n,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});const n=e("../../frame/MVC"),o=e("../../manager/GameVoManager"),a=e("../../config/Const"),r=e("./ComposeModel"),c=e("../../utils/Util"),l=e("../../manager/Manager"),h=e("../../frame/Notifier"),d=e("../../ListenID"),{ccclass:u,property:m}=cc._decorator;let g=(()=>{let e=class extends n.MVC.BaseView{constructor(){super(...arguments),this.icon=null,this.iconSpriteFrams=[],this.type=1,this.goldNumLabel=null,this.btnShare=null,this.goldNum=0}changeListener(e){}onOpen(e){super.onOpen(e),h.Notifier.send(d.ListenID.ShowBanner,1),this.initNode(),this.initView(e)}onClose(){h.Notifier.send(d.ListenID.HideBanner),super.onClose()}initNode(){this.goldNumLabel=this.node.getChildByName("goldNum").getComponent(cc.Label),this.btnShare=this.node.getChildByName("btnShareSpeedUp"),this.goldNum=r.default.getInstance.getOfflineReward()}initView(e){this.btnShare.active=o.GameVoManager.getInstance.gameSwitchVo.offline,this.goldNumLabel.string="+"+c.Util.goldFormat(this.goldNum),o.GameVoManager.getInstance.gameSwitchVo.unite&&(this.icon.spriteFrame=o.GameVoManager.getInstance.myUserVo.commonShareTimes>0?this.iconSpriteFrams[0]:this.iconSpriteFrams[1],o.GameVoManager.getInstance.myUserVo.commonShareTimes>0?this.type=0:this.type=1)}onNormalGet(){l.Manager.audio.playAudio(104),this.onReward(1)}onReward(e){this.goldNum>0&&(o.GameVoManager.getInstance.setGold(this.goldNum*e,a.Const.GoldUse.GetOffline),c.Util.showGoldEffect(null,this.goldNum,cc.Vec2.ZERO,cc.v2(-323,550),.1,0,a.Const.CurrencyType.Gold),this.goldNum=0,r.default.getInstance.setOfflineReward(0),o.GameVoManager.getInstance.saveData()),this.onClose()}onShareGet(){o.GameVoManager.getInstance.myUserVo.commonShareTimes--,this.onReward(2)}onVideoReward(){l.Manager.audio.playAudio(104),1==this.type?this.onReward(2):this.onShareGet()}};return s([m(cc.Sprite)],e.prototype,"icon",void 0),s([m(cc.SpriteFrame)],e.prototype,"iconSpriteFrams",void 0),e=s([u],e)})();i.default=g,cc._RF.pop()},{"../../ListenID":"ListenID","../../config/Const":"Const","../../frame/MVC":"MVC","../../frame/Notifier":"Notifier","../../manager/GameVoManager":"GameVoManager","../../manager/Manager":"Manager","../../utils/Util":"Util","./ComposeModel":"ComposeModel"}],PauseView:[function(e,t,i){"use strict";cc._RF.push(t,"55a7cxdrzNGkYDAjVIdMsrN","PauseView");var s=this&&this.__decorate||function(e,t,i,s){var n,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});const n=e("../../frame/MVC"),o=e("../../frame/Notifier"),a=e("../../CallID"),r=e("../../ListenID"),c=e("../../manager/Manager"),l=e("../../manager/GameVoManager"),{ccclass:h,property:d}=cc._decorator;let u=(()=>{let e=class extends n.MVC.BaseView{constructor(){super(...arguments),this.musicToggle=null,this.audioToggle=null,this.shakeToggle=null,this.lblUserId=null,this._userId=""}changeListener(e){}onOpen(e){super.onOpen(e),o.Notifier.send(r.ListenID.ShowBanner,0);let t=o.Notifier.call(a.CallID.Setting_IsMuteMusic);this.musicToggle.isChecked=t;let i=o.Notifier.call(a.CallID.Setting_IsMuteAudio);this.audioToggle.isChecked=i;let s=o.Notifier.call(a.CallID.Setting_IsBlockShake);this.shakeToggle.isChecked=s,this._updateLblUserId(),o.Notifier.send(r.ListenID.Fight_Pause,!0)}onClose(){this._isClosed||(o.Notifier.send(r.ListenID.HideBanner),c.Manager.audio.playAudio(104),super.onClose(),o.Notifier.send(r.ListenID.Fight_Pause,!1))}onClickMusic(e){c.Manager.audio.playAudio(104),o.Notifier.send(r.ListenID.Setting_MuteMusic,e.isChecked)}onClickAudio(e){c.Manager.audio.playAudio(104),o.Notifier.send(r.ListenID.Setting_MuteAudio,e.isChecked)}onClickShake(e){c.Manager.audio.playAudio(104),o.Notifier.send(r.ListenID.Setting_BlockShake,e.isChecked)}_updateLblUserId(){}uiPasteBoard(e,t){let i="";i=this._userId}onkeepGo(){this.onClose()}onGoHome(){l.GameVoManager.getInstance.myUserVo.gameResult=!1,o.Notifier.send(r.ListenID.Fight_BackToCompose,!0),o.Notifier.send(r.ListenID.Game_ResumeBoxSchedule),this.onClose()}};return s([d(cc.Toggle)],e.prototype,"musicToggle",void 0),s([d(cc.Toggle)],e.prototype,"audioToggle",void 0),s([d(cc.Toggle)],e.prototype,"shakeToggle",void 0),s([d(cc.Label)],e.prototype,"lblUserId",void 0),e=s([h],e)})();i.default=u,cc._RF.pop()},{"../../CallID":"CallID","../../ListenID":"ListenID","../../frame/MVC":"MVC","../../frame/Notifier":"Notifier","../../manager/GameVoManager":"GameVoManager","../../manager/Manager":"Manager"}],Pool:[function(e,t,i){"use strict";cc._RF.push(t,"f0fa0xw2/dOn6uSY6y0mlcL","Pool");var s=this&&this.__decorate||function(e,t,i,s){var n,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a};Object.defineProperty(i,"__esModule",{value:!0}),i.PoolSpawner=i.PoolItem=i.Pool=i.PoolManager=void 0;const n=e("./Time");i.PoolManager=new class{constructor(){this.m_pools={}}isExist(e){return null!=this.m_pools[e]}create(e,t,i=null){try{let s=this.m_pools[e];if(null!=s)return cc.error("Pool has Created:"+e),s;null==t&&cc.error("PoolManager.create target null",e);let n=null;return(n=null==i?new cc.Node(e):i).position=cc.Vec2.ZERO,n.rotation=0,(s=n.addComponent(r)).Type=e,s.Root=n,s.target=t,s.DontDestroyOnLoad(),this.m_pools[e]=s,s}catch(e){cc.error(e)}return null}destory(e){let t=this.m_pools[e];null!=t?(delete this.m_pools[e],t._Destory()):cc.error("Destory Pool no exist:"+e)}clear(e,t){let i=this.m_pools[e];null!=i?i._Clear(t):cc.error("Clear Pool no exist:"+e)}checkUnClear(){for(const e in this.m_pools){const t=this.m_pools[e];null!=t.Root&&0!=t.Root.childrenCount&&(cc.warn("Pool wasn't cleared: "+e),cc.warn("First child:"+t.Root.children[0].name))}}};const{ccclass:o,property:a}=cc._decorator;let r=(()=>{let e=class extends cc.Component{constructor(){super(...arguments),this.MatchScale=!1,this.MatchLayer=!1,this.BackActive=!0,this.ClearAbove=-1,this.ClearMaxPer=5,this.GroupPosition=cc.v2(1e3,1e3),this.m_spawners={}}GetPrefab(e){let t=this.m_spawners[e];return null==t?(cc.error("Pool.getPrefab null",this.Type,e),null):t.Prefab}CheckPrefab(e){return null!=this.m_spawners[e]}GetSpawner(e){let t=this.m_spawners[e];return null==t?(cc.warn("Pool.getSpawner null",this.Type,e),null):t}GetDatas(){let e=[];for(const t in this.m_spawners){const i=this.m_spawners[t];e.push(toArray(i.spawneds))}return e}DontDestroyOnLoad(){cc.game.addPersistRootNode(this.Root)}_DespawnAll(){if(null==this.Root)return void cc.error(this.Type+" is Null:Clear");toArray(this.m_spawners).forEach(e=>{e.DespawnAll()})}_Clear(e){if(null==this.Root)return void cc.error(this.Type+" is Null:Clear");toArray(this.m_spawners).forEach(t=>{e>=t.grade?(delete this.m_spawners[t.Id],t.destory()):--t.grade})}_Destory(){if(null!=this.Root){this.unscheduleAllCallbacks();for(const e in this.m_spawners){this.m_spawners[e].destory()}this.m_spawners=null,null!=this.Root&&(this.Root.destroy(),this.Root=null)}else cc.error(this.Type+" is Null: Destroy")}CreateSpawner(e,t,i=null,s=null,n=1,o=-1,a=0){if(null==this.Root)return cc.error(this.Type+" is Null, CreateSpawner id:"+e),null;this.smoothClear();let r=this.m_spawners[e];return null!=r?(cc.error(this.Type+" CreateSpawner twice id:"+e),r):((r=new d(e,t,this,i,s,n,o)).grade=a,this.m_spawners[r.Id]=r,r.PreloadInstances(),r)}DelSpawner(e){let t=this.m_spawners[e];null!=t?(t.destory(),delete this.m_spawners[e]):cc.error(this.Type+" DelSpawner Null id:"+e)}poolSpawnerComparer(e,t){return e.lastSpawnTime-t.lastSpawnTime}smoothClear(){if(this.ClearAbove<0)return;let e=0,t=[];for(const i in this.m_spawners){const s=this.m_spawners[i];s.clearing||(++e,0==s.grade&&0==s.spawneds.length&&t.push(s))}if(!(e<this.ClearAbove||0==t.length)){e=0,t.sort(this.poolSpawnerComparer);for(let i=0;i<t.length;i++){if(t[i].SmoothClear(),++e>=this.ClearMaxPer)break}}}Spawn(e,t=cc.Vec2.ZERO,i=0,s=null){if(null==this.Root)return cc.error(this.Type+" is Null, Spawn id:"+e),null;let n=this.m_spawners[e];return null==n?(cc.error(this.Type+" Can't Find Spawner id:"+e),null):n.SpawnInstance(t,i,s)}Despawn(e){this.despawn(e,!1)}despawn(e,t){if(null!=e){if(!(e.spawnTimes<=0))if(null!=this.Root)if(e.spawned)try{null!=e.spawner?(e.spawner.DespawnInstance(e,t),0==e.spawner.spawneds.length&&this.smoothClear()):cc.error(this.Type+" spawner is Null!! id:"+e.id+"instanceID:"+e.uuid)}catch(e){cc.error(e)}else cc.warn(this.Type+" despawn mult, id:"+e.id+" inst:"+e.uuid);else cc.error(this.Type+" is Null, despawn id:"+e.id+" inst:"+e.uuid)}else cc.error(this.Type+" data is Null")}DelayDespawn(e,t){if(null==e)return void cc.error(this.Type+" data is Null");if(null==this.Root)return void cc.error(this.Type+" is Null, DelayDespawn id:"+e.id+" inst:"+e.uuid);let i=e.spawnTimes;n.Time.delay(t,this.onDelayDespawn,[e,i],this)}onDelayDespawn([e,t]){e[0].spawnTimes==t&&this.Despawn(e)}};return e=s([o],e)})();i.Pool=r;class c{constructor(e,t,i){this._id=0,this._uuid="",this.m_spawnTimes=0,this.m_spawned=!1,this._id=e,this._uuid=t.uuid,this._node=t,this._name=t.name,this._spawner=i}get id(){return this._id}get uuid(){return this._uuid}get spawnTimes(){return this.m_spawnTimes}Spawn(){this.m_spawned=!0,++this.m_spawnTimes}Despawn(){this.m_spawned=!1}Clear(){this.m_spawnTimes=0}get node(){return this._node}get name(){return this._name}get spawner(){return this._spawner}get spawned(){return this.m_spawned}}i.PoolItem=c;const l=10,h=5;class d{constructor(e,t,i,s,o,a,r){this.m_id=0,this.grade=0,this.cullAbove=-1,this.m_clearing=!1,this.m_preloadCount=1,this.m_preload=!1,this.m_lastSpawnTime=0,this.m_spawneds=[],this.m_despawneds=[],this._cursor=0,this.m_id=e,this.m_prefab=t,this.m_pool=i,this.m_spawnedEvent=s,this.m_despawnedEvent=o,this.m_preloadCount=a,this.cullAbove=r,this.m_lastSpawnTime=n.Time.time}get Id(){return this.m_id}get Prefab(){return this.m_prefab}get clearing(){return this.m_clearing}get lastSpawnTime(){return this.m_lastSpawnTime}get spawneds(){return this.m_spawneds}get despawneds(){return this.m_despawneds}get TotalCount(){let e=0;return e+=this.m_spawneds.length,e+=this.m_despawneds.length}SmoothClear(){this.m_clearing=!0,null==this.m_cullWatcher&&(this.m_cullWatcher=n.Time.delay(l,this.cullDespawned,null,this,-1))}destory(){null!=this.m_pool.onDelSpawner&&this.m_pool.onDelSpawner.call(this.m_pool.target,this.m_id),this.m_id=0,cc.isValid(this.Prefab,!0),this.m_prefab=null,null!=this.m_cullWatcher&&(this.m_cullWatcher.Cancal(),this.m_cullWatcher=null),this.clear()}clear(){this.m_despawneds.forEach(e=>{this._clear(e)}),this.m_despawneds=[],this.m_spawneds.forEach(e=>{this._clear(e)}),this.m_spawneds=[]}_clear(e){e.Clear(),cc.isValid(e.node,!0)&&(e.Despawn(),e.node.parent=null,e.node.destroy())}DespawnAll(){for(let e=0;e<this.m_spawneds.length;e++){const t=this.m_spawneds[e];t.Despawn(),cc.isValid(t.node,!0)&&(this.m_despawneds.push(t),t.node.parent=this.m_pool.Root,t.node.position=this.m_pool.GroupPosition,this.m_pool.BackActive&&(t.node.active=!1),this.despawnEvent(t))}this.m_spawneds=[]}despawnEvent(e){try{return null!=this.m_despawnedEvent&&(this.m_despawnedEvent.call(this.m_pool.target,e),cc.isValid(e.node,!0)||cc.warn(this.m_pool.Type+" despawnEvent Error uuid:"+e.uuid+" Id:"+e.id)),!0}catch(e){cc.error(e)}return!1}DespawnInstance(e,t,i=!0){return null==e?(cc.error("DespawnInstance data null, Pool:"+this.m_pool.Type),!1):(e.Despawn(),i&&!this.m_spawneds.remove(e)?cc.error("spawneds can't find:",e.id,e.uuid,e.name):this.logSpawneds("DespawnInstance",e),cc.isValid(e.node,!0)?t?(e.node.destroy(),e.Clear(),cc.log(this.m_pool.Type,"DespawnInstance destroy",e.id,"uuid:"+e.uuid,e.name)):(this.m_despawneds.push(e),e.node.parent=this.m_pool.Root,e.node.position=this.m_pool.GroupPosition,this.m_pool.BackActive&&(e.node.active=!1)):cc.warn(this.m_pool.Type+" DespawnInstance Error uuid:"+e.uuid+" Id:"+e.id),null==this.m_cullWatcher&&this.cullAbove>=0&&this.m_despawneds.length>this.cullAbove&&(this.m_cullWatcher=n.Time.delay(l,this.cullDespawned,null,this,-1)),!(i&&!this.despawnEvent(e)))}cullDespawned(){let e=this.cullAbove;(this.m_clearing||this.cullAbove<=0)&&(e=0);let t=this.m_despawneds.length;if(t>e){t>h&&(t=h);for(let e=t-1;e>=0;e--){const e=this.m_despawneds.pop();this._clear(e)}}else this.m_cullWatcher.Cancal(),this.m_cullWatcher=null,this.m_clearing&&0!=this.m_id&&this.m_pool.DelSpawner(this.m_id)}fixErrorDestory(){let e=this.m_spawneds.length;for(let t=e-1;t>=0;t--){const e=this.m_spawneds[t];cc.isValid(e.node,!0)||(this._clear(e),this.m_spawneds.removeAt(t))}for(let t=(e=this.m_despawneds.length)-1;t>=0;t--){const e=this.m_despawneds[t];cc.isValid(e.node,!0)||(this._clear(e),this.m_despawneds.removeAt(t))}}SpawnInstance(e,t,i){this.m_clearing=!1,this.m_lastSpawnTime=n.Time.time;let s=null;for(;null==s;){if(this.m_despawneds.length<=0){s=this.spawnNew(e,t,i);break}s=this.m_despawneds.shift(),cc.isValid(s.node,!0)||(cc.error(this.m_pool.Type+" Despawn Error inst:"+s.uuid+" ID:"+s.id+" Name:"+s.name),s=null,this.fixErrorDestory())}return null==s?(cc.error("SpawnInstance null",s.id+" Name:"+s.name),null):(null!=i&&cc.isValid(i,!0)&&(s.node.parent=i,this.m_pool.MatchLayer&&this.SetRecursively(s.node,i.groupIndex)),s.node.position=e,s.node.rotation=t,s.node.active=!0,this.m_spawneds.push(s),this.logSpawneds("SpawnInstance",s),s.Spawn(),s)}spawnNew(e=null,t=0,i=null){if(null==this.m_pool||null==this.m_pool.Root)return cc.warn(this.m_pool,"Pool has destroy!!!, id:",this.m_id),null;if(null==this.m_prefab)return cc.error(this.m_pool,"Pool prefab null!!!, id:",this.m_id),null;null==e&&(e=this.m_pool.GroupPosition),null!=i&&cc.isValid(i,!0)||(i=this.m_pool.Root);let s,n=cc.instantiate(this.m_prefab);return null==n&&cc.error(this.m_pool,"Pool inst null!!!, id:",this.m_id,this.m_prefab),n.name=this.m_prefab.name,this.nameInstance(n),n.parent=i,n.position=e,n.rotation=t,this.m_pool.MatchScale&&(n.scale=1),s=null!=this.m_spawnedEvent?this.m_spawnedEvent.call(this.m_pool.target,this.m_id,n,this):new c(this.m_id,n,this),this.m_pool.MatchLayer&&this.SetRecursively(n,i.groupIndex),s}logSpawneds(e,t){}SetRecursively(e,t){e.groupIndex=t,e.children.forEach(e=>{this.SetRecursively(e,t)})}PreloadInstances(){if(this.m_preload)cc.log(this.m_pool.Type+" Preload twice "+this.m_prefab.name);else for(this.cullAbove>0&&this.m_preloadCount>this.cullAbove&&cc.error(this.m_pool.Type+" PreloadCount > cullAbove ",this.m_prefab.name),this.m_preload=!0;this.TotalCount<this.m_preloadCount;){let e=this.spawnNew();this.DespawnInstance(e,!1,!1)}}nameInstance(e){++this._cursor,e.name+="_"+ ++this._cursor}}i.PoolSpawner=d,cc._RF.pop()},{"./Time":"Time"}],PowerBuyView:[function(e,t,i){"use strict";cc._RF.push(t,"35d2311YFZLu7Pub6OkasZi","PowerBuyView");var s=this&&this.__decorate||function(e,t,i,s){var n,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});const n=e("../../frame/MVC"),o=e("../../ListenID"),a=e("../../frame/Notifier"),r=e("../../config/Const"),c=e("./PowerModel"),l=e("../../manager/GameVoManager"),h=e("../../alert/AlertManager"),d=e("../../manager/Manager"),{ccclass:u,property:m}=cc._decorator;let g=(()=>{let e=class extends n.MVC.BaseView{constructor(){super(...arguments),this.toggle_1=null,this.toggle_2=null,this.buyPowerCost=50,this.powerLabel=null,this.cannoBuyBg=null}changeListener(e){a.Notifier.changeListener(e,o.ListenID.Game_UpdatePower,this.updatePower,this)}onOpen(e){a.Notifier.send(o.ListenID.ShowBanner,0),super.onOpen(e),this.buyPowerCost=5*l.GameVoManager.getInstance.myUserVo.topTankId+50,this.toggle_1.isChecked=1==e,this.toggle_2.isChecked=2==e,this.initNode(),this.initView(e)}onClose(){d.Manager.audio.playAudio(104),a.Notifier.send(o.ListenID.HideBanner),super.onClose()}initNode(){this.powerLabel=this.node.getChildByName("powerLabel").getComponent(cc.Label);let e=this.node.getChildByName("btnGet");this.cannoBuyBg=cc.find("Background/bg2",e),cc.find("Background/diamondNum",e).getComponent(cc.Label).string=this.buyPowerCost+""}initView(e){this.updatePower()}updatePower(){this.powerLabel.string=`${c.default.getInstance.getCurPower()}/${r.Const.MaxPower}`}onVideoClick(){d.Manager.audio.playAudio(104),c.default.getInstance.getCurPower()>=r.Const.MaxPower?h.AlertManager.showNormalTipsOnce("\u4f53\u529b\u5df2\u8fbe\u4e0a\u9650"):(l.GameVoManager.getInstance.setPower(2,3),h.AlertManager.showCurrency(2,r.Const.CurrencyType.Power))}shareReward(){l.GameVoManager.getInstance.setPower(2,3),h.AlertManager.showCurrency(2,r.Const.CurrencyType.Power)}};return s([m(cc.Toggle)],e.prototype,"toggle_1",void 0),s([m(cc.Toggle)],e.prototype,"toggle_2",void 0),e=s([u],e)})();i.default=g,cc._RF.pop()},{"../../ListenID":"ListenID","../../alert/AlertManager":"AlertManager","../../config/Const":"Const","../../frame/MVC":"MVC","../../frame/Notifier":"Notifier","../../manager/GameVoManager":"GameVoManager","../../manager/Manager":"Manager","./PowerModel":"PowerModel"}],PowerController:[function(e,t,i){"use strict";cc._RF.push(t,"24f05DuznxDi5hckD58a93t","PowerController"),Object.defineProperty(i,"__esModule",{value:!0}),i.PowerController=void 0;const s=e("../../ListenID"),n=e("../../frame/MVC"),o=e("../../frame/Notifier"),a=e("./PowerModel"),r=e("../../CallID"),c=e("../../frame/UIManager"),l=e("../../frame/NotifyID"),h=e("../../manager/GameVoManager");i.PowerController=class extends n.MVC.BaseController{constructor(){super("PowerController"),this.isInit=!1,this._model=a.default.getInstance,this.changeListener(!0),this.isInit=!1}reset(){}changeListener(e){o.Notifier.changeListener(e,l.NotifyID.Game_Update,this.updateModel,this),o.Notifier.changeListener(e,s.ListenID.Game_RefreshTime,this.refreshPowerTime,this),o.Notifier.changeCall(e,r.CallID.Power_GetPowerCountTime,this.getPowerCountTime,this),o.Notifier.changeListener(e,s.ListenID.Power_OpenBuyView,this.onOpenBuyView,this),o.Notifier.changeListener(e,s.ListenID.Power_CloseBuyView,this.onCloseBuyView,this),o.Notifier.changeListener(e,s.ListenID.Login_Finish,this.initTime,this)}onOpenBuyView(e,t,i){c.UIManager.Open("ui/power/PowerBuyView",t,e,i)}onCloseBuyView(){c.UIManager.Close("ui/power/PowerBuyView")}initTime(){this.isInit=!0,this.refreshPowerTime()}updateModel(e){h.GameVoManager.getInstance.myUserVo.isGetData&&this.isInit&&this._model.updatePower(e)}refreshPowerTime(){h.GameVoManager.getInstance.myUserVo.isGetData&&this._model.refreshPowerTime()}getPowerCountTime(){return this._model.countTime}},cc._RF.pop()},{"../../CallID":"CallID","../../ListenID":"ListenID","../../frame/MVC":"MVC","../../frame/Notifier":"Notifier","../../frame/NotifyID":"NotifyID","../../frame/UIManager":"UIManager","../../manager/GameVoManager":"GameVoManager","./PowerModel":"PowerModel"}],PowerModel:[function(e,t,i){"use strict";cc._RF.push(t,"8ea7aNVIINNjYNap3e4pO3E","PowerModel"),Object.defineProperty(i,"__esModule",{value:!0});const s=e("../../frame/MVC"),n=e("../../manager/GameVoManager"),o=e("../../config/Const"),a=e("../../frame/Time"),r=e("../../frame/Notifier"),c=e("../../ListenID");let l=(()=>{class e extends s.MVC.BaseModel{constructor(){super(),this.startCountPower=0,this.startCountPower2=0,null==e._instance&&(e._instance=this),this.startCountPower=0,this.startCountPower2=0}reset(){}static get getInstance(){return null==e._instance&&(e._instance=new e),e._instance}updatePower(e){n.GameVoManager.getInstance.myUserVo.power>=o.Const.MaxPower||(this.startCountPower+=e,this.startCountPower2+=e,this.startCountPower>=1&&(n.GameVoManager.getInstance.myUserVo.powerRecoverTime+=1e3,this.startCountPower=0),n.GameVoManager.getInstance.myUserVo.powerRecoverTime>=n.GameVoManager.getInstance.myUserVo.nextPowerTime&&(n.GameVoManager.getInstance.setPower(1,1),n.GameVoManager.getInstance.myUserVo.nextPowerTime=n.GameVoManager.getInstance.myUserVo.powerRecoverTime+1e3*o.Const.PowerRecoverTime,this.startCountPower2=0))}refreshPowerTime(){let e=0;if(n.GameVoManager.getInstance.myUserVo.nextPowerTime<=a.Time.serverTimeMs){let t=(a.Time.serverTimeMs-n.GameVoManager.getInstance.myUserVo.nextPowerTime)/1e3;e=Math.ceil(t/o.Const.PowerRecoverTime),this.startCountPower2=Math.floor(t%o.Const.PowerRecoverTime),n.GameVoManager.getInstance.myUserVo.nextPowerTime=a.Time.serverTimeMs+1e3*(o.Const.PowerRecoverTime-this.startCountPower2)}else{let e=Math.floor((a.Time.serverTimeMs-n.GameVoManager.getInstance.myUserVo.powerRecoverTime)/1e3);this.startCountPower2+=e,r.Notifier.send(c.ListenID.Game_UpdatePower)}n.GameVoManager.getInstance.myUserVo.powerRecoverTime=a.Time.serverTimeMs,e>0&&n.GameVoManager.getInstance.myUserVo.power<o.Const.MaxPower&&n.GameVoManager.getInstance.setPower(e,1)}get countTime(){return o.Const.PowerRecoverTime-this.startCountPower2}getCurPower(){return n.GameVoManager.getInstance.myUserVo.power}}return e._instance=null,e})();i.default=l,cc._RF.pop()},{"../../ListenID":"ListenID","../../config/Const":"Const","../../frame/MVC":"MVC","../../frame/Notifier":"Notifier","../../frame/Time":"Time","../../manager/GameVoManager":"GameVoManager"}],RankController:[function(e,t,i){"use strict";cc._RF.push(t,"0e5305VvY5L8piQUCLhKSDX","RankController"),Object.defineProperty(i,"__esModule",{value:!0}),i.RankController=void 0;const s=e("../../ListenID"),n=e("../../frame/MVC"),o=e("../../frame/Notifier"),a=e("../../frame/UIManager"),r=e("./RankModel"),c=e("../../manager/GameVoManager");i.RankController=class extends n.MVC.BaseController{constructor(){super("RankController"),this._model=r.default.getInstance,this.changeListener(!0)}reset(){}changeListener(e){o.Notifier.changeListener(e,s.ListenID.Rank_OpenView,this.onOpenView,this),o.Notifier.changeListener(e,s.ListenID.Rank_CloseView,this.onCloseView,this),o.Notifier.changeListener(e,s.ListenID.Rank_OpenSurpassView,this.onOpenSurpassView,this),o.Notifier.changeListener(e,s.ListenID.Rank_CloseSurpassView,this.onCloseSurpassView,this),o.Notifier.changeListener(e,s.ListenID.Rank_PostGameMoney,this.postGameMoney,this)}onOpenView(e,t,i){a.UIManager.Open("ui/rank/RankView",t,e,i)}onCloseView(){a.UIManager.Close("ui/rank/RankView")}onOpenSurpassView(e,t,i){a.UIManager.Open("ui/rank/SurpassFriendView",t,e,i)}onCloseSurpassView(){a.UIManager.Close("ui/rank/SurpassFriendView")}getRankData(){}getKillRankData(){}getMoneyRankData(){}postGameMoney(){let e={avatarUrl:c.GameVoManager.getInstance.myUserVo.avatarUrl,nickName:c.GameVoManager.getInstance.myUserVo.nickName};c.GameVoManager.getInstance.myUserVo.gold,JSON.stringify(e)}},cc._RF.pop()},{"../../ListenID":"ListenID","../../frame/MVC":"MVC","../../frame/Notifier":"Notifier","../../frame/UIManager":"UIManager","../../manager/GameVoManager":"GameVoManager","./RankModel":"RankModel"}],RankItem:[function(e,t,i){"use strict";cc._RF.push(t,"db652sUqVBHtJmh2m5KXx1G","RankItem");var s=this&&this.__decorate||function(e,t,i,s){var n,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});const n=e("./RankModel"),o=e("../../utils/Util"),a=e("../../manager/GameVoManager"),{ccclass:r,property:c}=cc._decorator;let l=(()=>{let e=class extends cc.Component{constructor(){super(...arguments),this.rankNum=null,this.rankIconNum=null,this.playName=null,this.playHeadImg=null,this.stageNum=null,this._itemId=0}updateItem(e,t,i){this._itemId=t,this.updateData(t,i)}get itemID(){return this._itemId}updateData(e,t,i=2){e>2?(this.rankNum.string=`${e+1}`,this.rankNum.node.active=!0,this.rankIconNum.node.active=!1):(this.rankIconNum.node.active=!0,this.rankNum.node.active=!1,this.rankIconNum.spriteFrame=t.getSpriteFrame("img_no."+(e+1)));let s=n.default.getInstance.rankList[e];if(3==i?s=n.default.getInstance.killRankList[e]:4==i&&(s=n.default.getInstance.moneyRankList[e]),s){if(s.data){let e=JSON.parse(s.data),t=o.Util.normalName(e.nickName||"");this.playName.string=t,e.avatarUrl&&-1!=e.avatarUrl.indexOf("http")?(this.playHeadImg.node.active=!0,o.Util.setSprite(this.playHeadImg,e.avatarUrl)):this.playHeadImg.node.active=!1}else this.playName.string="\u533f\u540d"+e,this.playHeadImg.node.active=!1;this.setStageInfo(s,t,i)}else this.playName.string="\u865a\u4f4d\u4ee5\u5f85",this.playHeadImg.node.active=!1,this.stageNum.string="0\u5173",3==i?this.stageNum.string="0\u8f86":4==i&&(this.stageNum.string="0\u91d1\u5e01")}updateMyData(e=-1,t,i=2){let s=n.default.getInstance.rankList[e-1];3==i?s=n.default.getInstance.killRankList[e-1]:4==i&&(s=n.default.getInstance.moneyRankList[e-1]),o.Util.setSprite(this.playHeadImg,a.GameVoManager.getInstance.myUserVo.avatarUrl),this.playName.string=o.Util.normalName(a.GameVoManager.getInstance.myUserVo.nickName),this.stageNum.string=`${n.default.getInstance.myScore}\u5173`,3==i?this.stageNum.string=`${n.default.getInstance.myKillScore}\u8f86`:4==i&&(this.stageNum.string=`${o.Util.goldFormat(n.default.getInstance.myMoneyScore)}\u91d1\u5e01`),s?e>2?(this.rankNum.node.active=!0,this.rankIconNum.node.active=!1,this.rankNum.string=`${e}`):(this.rankIconNum.node.active=!0,this.rankNum.node.active=!1,this.rankIconNum.spriteFrame=t.getSpriteFrame("img_no."+e)):(this.rankNum.node.active=!0,this.rankIconNum.node.active=!1,this.rankNum.string=e?e>1e4?"10000+":`${e}`:"--")}setStageInfo(e,t,i=2){let s=e.score;this.stageNum.string=`${s}\u5173`,3==i?this.stageNum.string=`${s}\u8f86`:4==i&&(this.stageNum.string=`${o.Util.goldFormat(s)}\u91d1\u5e01`)}start(){}};return s([c(cc.Label)],e.prototype,"rankNum",void 0),s([c(cc.Sprite)],e.prototype,"rankIconNum",void 0),s([c(cc.Label)],e.prototype,"playName",void 0),s([c(cc.Sprite)],e.prototype,"playHeadImg",void 0),s([c(cc.Label)],e.prototype,"stageNum",void 0),e=s([r],e)})();i.default=l,cc._RF.pop()},{"../../manager/GameVoManager":"GameVoManager","../../utils/Util":"Util","./RankModel":"RankModel"}],RankModel:[function(e,t,i){"use strict";cc._RF.push(t,"73e695wrmxNP6vjzHTxvd7R","RankModel"),Object.defineProperty(i,"__esModule",{value:!0}),i.RankItemVo=void 0;const s=e("../../frame/MVC");i.RankItemVo=class{constructor(){this.score=0,this.data=null,this.open_id=""}};let n=(()=>{class e extends s.MVC.BaseModel{constructor(){super(),this._rankList=[],this._killRankList=[],this._moneyRankList=[],this._myRank=-1,this._myScore=0,this._myKillRank=-1,this._myKillScore=0,this._myMoneyRank=-1,this._myMoneyScore=0,null==e._instance&&(e._instance=this)}reset(){}static get getInstance(){return null==e._instance&&(e._instance=new e),e._instance}setRankList(e,t,i=-1,s=0){if(t&&t.length>=0){let i=t.length;for(let s=0;s<i;s++)this.rankList[s*e]=t[s]}this._myRank=i,this._myScore=s}setKillRankList(e,t,i=-1,s=0){if(t&&t.length>=0){let i=t.length;for(let s=0;s<i;s++)this._killRankList[s*e]=t[s]}this._myKillRank=i,this._myKillScore=s}setMoneyRankList(e,t,i=-1,s=0){if(t&&t.length>=0){let i=t.length;for(let s=0;s<i;s++)this._moneyRankList[s*e]=t[s]}this._myMoneyRank=i,this._myMoneyScore=s}get rankList(){return this._rankList}get killRankList(){return this._killRankList}get moneyRankList(){return this._moneyRankList}get myScore(){return this._myScore}get myRank(){return this._myRank}get myKillScore(){return this._myKillScore}get myKillRank(){return this._myKillRank}get myMoneyScore(){return this._myMoneyScore}get myMoneyRank(){return this._myMoneyRank}}return e._instance=null,e})();i.default=n,cc._RF.pop()},{"../../frame/MVC":"MVC"}],RankView:[function(e,t,i){"use strict";cc._RF.push(t,"a0b10rWIrxEg6FPzVOjkPek","RankView");var s=this&&this.__decorate||function(e,t,i,s){var n,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});const n=e("../../manager/Manager"),o=e("../../frame/MVC"),a=e("../../utils/Util"),r=e("./RankItem"),c=e("./RankModel"),{ccclass:l,property:h}=cc._decorator;let d=(()=>{let e=class extends o.MVC.BaseView{constructor(){super(...arguments),this.bg=null,this.btn_prev=null,this.btn_next=null,this.wx_subview=null,this.worldpanel=null,this.itemRankItem=null,this.myRankItem=null,this.scrollView=null,this.worldkillpanel=null,this.itemKillRankItem=null,this.myKillRankItem=null,this.scrollViewKill=null,this.worldmoneypanel=null,this.itemMoneyRankItem=null,this.myMoneyRankItem=null,this.scrollViewMoney=null,this.ranklist=null,this.checkmask=[],this.normal=[],this.pagenode=null,this.pageinfo=null,this.pageinfokill=null,this.pageinfomoney=null,this._curPage=1,this.kMaxPage=1,this.kMaxPage_1=1,this.kMaxPage_2=1,this.timeoutID=null,this.sharedTexture=null,this.sharedSpriteFrame=null,this.pageItemNum=8,this.items=[],this.itemsKill=[],this.itemsMoney=[],this.isneedRefresh=!0,this.isneedRefresh_1=!0,this.isneedRefresh_2=!0,this.curRankType=1}changeListener(e){}resizeBtnPos(){}onOpen(e){super.onOpen(e),a.Util.resizeNode(this.bg),this.resizeSharedCanvas(this.wx_subview.node.width,this.wx_subview.node.height),this.curRankType=e&&e.rankType?e.rankType:1,this.initRankByType(1),this.initRankByType(2),this.initRankByType(3),this.initRankByType(4),this.updateBtnState(this.curRankType),this.onSelect(null,2)}initRankByType(e){if(1==e);else if(2==e){for(let e=0;e<this.pageItemNum;++e){let e=cc.instantiate(this.itemRankItem);e.active=!0,this.scrollView.addChild(e),this.items.push(e)}this.initMyRank()}else if(3==e){for(let e=0;e<this.pageItemNum;++e){let e=cc.instantiate(this.itemKillRankItem);e.active=!0,this.scrollViewKill.addChild(e),this.itemsKill.push(e)}this.initMyKillRank()}else if(4==e){for(let e=0;e<this.pageItemNum;++e){let e=cc.instantiate(this.itemMoneyRankItem);e.active=!0,this.scrollViewMoney.addChild(e),this.itemsMoney.push(e)}this.initMyMoneyRank()}}initMyRank(){this.myRankItem.getComponent(r.default).updateMyData(c.default.getInstance.myRank,this.ranklist,2)}initMyKillRank(){this.myKillRankItem.getComponent(r.default).updateMyData(c.default.getInstance.myKillRank,this.ranklist,3)}initMyMoneyRank(){this.myMoneyRankItem.getComponent(r.default).updateMyData(c.default.getInstance.myMoneyRank,this.ranklist,4)}updateBtnState(e){this.checkmask[0].active=1==e,this.checkmask[1].active=2==e,this.checkmask[2].active=3==e,this.checkmask[3].active=4==e,this.normal[0].active=1!=e,this.normal[1].active=2!=e,this.normal[2].active=3!=e,this.normal[3].active=4!=e,this.wx_subview.node.active=1==e,this.worldpanel.active=2==e,this.myRankItem.active=2==e,this.worldkillpanel.active=3==e,this.myKillRankItem.active=3==e,this.worldmoneypanel.active=4==e,this.myMoneyRankItem.active=4==e,this.pagenode.position=e>=2?cc.v3(0,-290):cc.v3(0,-310)}updateRankByType(e,t){1==e||(2==e?(this._curPage+=t,this._curPage=Math.floor(cc.misc.clampf(this._curPage,1,this.kMaxPage)),this.updateWorldView()):3==e?(this._curPage+=t,this._curPage=Math.floor(cc.misc.clampf(this._curPage,1,this.kMaxPage)),this.updateWorldKillView()):4==e&&(this._curPage+=t,this._curPage=Math.floor(cc.misc.clampf(this._curPage,1,this.kMaxPage)),this.updateWorldMoneyView()))}onSelect(e,t){2==t?(this.curRankType=2,this.updateBtnState(2),this._curPage=1,this.kMaxPage=Math.ceil(c.default.getInstance.rankList.length/this.pageItemNum),this.kMaxPage<=0&&(this.kMaxPage=1),this.updateWorldView()):3==t?(this.curRankType=3,this._curPage=1,this.updateBtnState(3),this.isneedRefresh_1?(this.isneedRefresh_1=!1,this.kMaxPage=Math.ceil(c.default.getInstance.killRankList.length/this.pageItemNum),this.kMaxPage<=0&&(this.kMaxPage=1),this.updateWorldKillView()):(this.kMaxPage=Math.ceil(c.default.getInstance.killRankList.length/this.pageItemNum),this.kMaxPage<=0&&(this.kMaxPage=1),this.updateWorldKillView())):4==t&&(this.curRankType=4,this._curPage=1,this.updateBtnState(4),this.isneedRefresh_2?(this.isneedRefresh_2=!1,this.kMaxPage=Math.ceil(c.default.getInstance.moneyRankList.length/this.pageItemNum),this.kMaxPage<=0&&(this.kMaxPage=1),this.updateWorldMoneyView()):(this.kMaxPage=Math.ceil(c.default.getInstance.killRankList.length/this.pageItemNum),this.kMaxPage<=0&&(this.kMaxPage=1),this.updateWorldMoneyView()))}updateWorldView(){let e=(this._curPage-1)*this.pageItemNum,t=e+this.pageItemNum;this.pageinfo.string=`${this._curPage}/${this.kMaxPage}`,this.myRankItem.getComponent(r.default).updateMyData(c.default.getInstance.myRank,this.ranklist,this.curRankType);for(let i=e,s=0;i<t;i++,s++)this.items[s].active=i<100,this.items[s].getComponent(r.default).updateData(i,this.ranklist,this.curRankType)}updateWorldKillView(){let e=(this._curPage-1)*this.pageItemNum,t=e+this.pageItemNum;this.pageinfokill.string=`${this._curPage}/${this.kMaxPage}`,this.myKillRankItem.getComponent(r.default).updateMyData(c.default.getInstance.myKillRank,this.ranklist,this.curRankType);for(let i=e,s=0;i<t;i++,s++)this.itemsKill[s].active=i<100,this.itemsKill[s].getComponent(r.default).updateData(i,this.ranklist,this.curRankType)}updateWorldMoneyView(){let e=(this._curPage-1)*this.pageItemNum,t=e+this.pageItemNum;this.pageinfomoney.string=`${this._curPage}/${this.kMaxPage}`,this.myMoneyRankItem.getComponent(r.default).updateMyData(c.default.getInstance.myMoneyRank,this.ranklist,this.curRankType);for(let i=e,s=0;i<t;i++,s++)this.itemsMoney[s].active=i<100,this.itemsMoney[s].getComponent(r.default).updateData(i,this.ranklist,this.curRankType)}onClose(){super.onClose(),n.Manager.audio.playAudio(104)}isWeChat(){return cc.sys.platform==cc.sys.WECHAT_GAME}onShare(){n.Manager.audio.playAudio(104)}getUserInfo(){}OnClickPrev(){this.updateRankByType(this.curRankType,-1)}OnClickNext(){this.updateRankByType(this.curRankType,1)}resizeSharedCanvas(e,t){if(!this.isWeChat())return;if(null==e||null==t)return void console.error("resizeSharedCanvas width/height null",e,t);let i=wx.getOpenDataContext().canvas;i.width=e,i.height=t,this.sharedTexture=new cc.Texture2D,this.sharedSpriteFrame=new cc.SpriteFrame}updateSharedCanvas(e,t=20){if(!this.isWeChat())return;if(null==this.sharedTexture)return;let i=wx.getOpenDataContext().canvas;this.sharedTexture.initWithElement(i),this.sharedTexture.handleLoadedTexture(),this.sharedSpriteFrame.setTexture(this.sharedTexture),e.spriteFrame=this.sharedSpriteFrame,null!=this.timeoutID&&(clearTimeout(this.timeoutID),this.timeoutID=null),t>1&&(this.timeoutID=setTimeout(()=>{this.timeoutID=null,this.updateSharedCanvas(e,t-1)},t*t+200))}};return s([h(cc.Node)],e.prototype,"bg",void 0),s([h(cc.Node)],e.prototype,"btn_prev",void 0),s([h(cc.Node)],e.prototype,"btn_next",void 0),s([h(cc.Sprite)],e.prototype,"wx_subview",void 0),s([h(cc.Node)],e.prototype,"worldpanel",void 0),s([h(cc.Node)],e.prototype,"itemRankItem",void 0),s([h(cc.Node)],e.prototype,"myRankItem",void 0),s([h(cc.Node)],e.prototype,"scrollView",void 0),s([h(cc.Node)],e.prototype,"worldkillpanel",void 0),s([h(cc.Node)],e.prototype,"itemKillRankItem",void 0),s([h(cc.Node)],e.prototype,"myKillRankItem",void 0),s([h(cc.Node)],e.prototype,"scrollViewKill",void 0),s([h(cc.Node)],e.prototype,"worldmoneypanel",void 0),s([h(cc.Node)],e.prototype,"itemMoneyRankItem",void 0),s([h(cc.Node)],e.prototype,"myMoneyRankItem",void 0),s([h(cc.Node)],e.prototype,"scrollViewMoney",void 0),s([h(cc.SpriteAtlas)],e.prototype,"ranklist",void 0),s([h([cc.Node])],e.prototype,"checkmask",void 0),s([h([cc.Node])],e.prototype,"normal",void 0),s([h(cc.Node)],e.prototype,"pagenode",void 0),s([h(cc.Label)],e.prototype,"pageinfo",void 0),s([h(cc.Label)],e.prototype,"pageinfokill",void 0),s([h(cc.Label)],e.prototype,"pageinfomoney",void 0),e=s([l],e)})();i.default=d,cc._RF.pop()},{"../../frame/MVC":"MVC","../../manager/Manager":"Manager","../../utils/Util":"Util","./RankItem":"RankItem","./RankModel":"RankModel"}],ReliveView:[function(e,t,i){"use strict";cc._RF.push(t,"52b2crDIz1L8Ij+YfwfgELh","ReliveView");var s=this&&this.__decorate||function(e,t,i,s){var n,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});const n=e("../../frame/MVC"),o=e("../../frame/Notifier"),a=e("../../ListenID"),r=e("../../config/Const"),c=e("../../alert/AlertManager"),l=e("../../manager/GameVoManager"),h=e("../../manager/Manager"),{ccclass:d,property:u}=cc._decorator;let m=(()=>{let e=class extends n.MVC.BaseView{constructor(){super(...arguments),this.diamond=null,this.isShowVideo=!1,this.reliveTime=4,this.timeLabel=null}changeListener(e){o.Notifier.changeListener(e,a.ListenID.Resume_CountDown,this.resumeCount,this)}stopCount(){this.isShowVideo=!0}resumeCount(){this.isShowVideo=!1}onOpen(e){super.onOpen(e),o.Notifier.send(a.ListenID.ShowBanner,0),this.timeLabel=this.node.getChildByName("time").getComponent(cc.Label);let t=this.node.getChildByName("btnShare"),i=this.node.getChildByName("btnDiamond");t.active=l.GameVoManager.getInstance.gameSwitchVo.relive,i.active=!l.GameVoManager.getInstance.gameSwitchVo.relive}onClose(){o.Notifier.send(a.ListenID.HideBanner),super.onClose()}onSkipRelive(){this.onClose(),o.Notifier.send(a.ListenID.Fight_Pause,!1),o.Notifier.send(a.ListenID.Fight_EndGame,!1)}onDiamondRelive(){h.Manager.audio.playAudio(104),100<=l.GameVoManager.getInstance.myUserVo.diamond?(l.GameVoManager.getInstance.setDiamond(-100,r.Const.DiamondUse.CostRelive),this.onRelive()):c.AlertManager.showNormalTips("\u94bb\u77f3\u4e0d\u8db3")}onRelive(){this.onClose(),o.Notifier.send(a.ListenID.Fight_Pause,!1),o.Notifier.send(a.ListenID.Fight_ReliveSuccess),c.AlertManager.showNormalTips("\u590d\u6d3b\u6210\u529f\uff0c\u7ee7\u7eed\u6218\u6597\u5427\uff01")}onShareRelive(){h.Manager.audio.playAudio(104);this.onRelive()}onVideoRelive(){h.Manager.audio.playAudio(104);this.isShowVideo=!0,this.onRelive()}update(e){this.isShowVideo||(this.reliveTime>0&&(this.reliveTime-=e),this.timeLabel&&(this.timeLabel.string=Math.ceil(this.reliveTime)+""),this.reliveTime<0&&(this.reliveTime=0,this.onSkipRelive()))}};return s([u(cc.Label)],e.prototype,"diamond",void 0),e=s([d],e)})();i.default=m,cc._RF.pop()},{"../../ListenID":"ListenID","../../alert/AlertManager":"AlertManager","../../config/Const":"Const","../../frame/MVC":"MVC","../../frame/Notifier":"Notifier","../../manager/GameVoManager":"GameVoManager","../../manager/Manager":"Manager"}],ResKeeper:[function(e,t,i){"use strict";cc._RF.push(t,"0758fbnEbpGNpAevyxWqHOy","ResKeeper");var s=this&&this.__decorate||function(e,t,i,s){var n,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});const{ccclass:n,property:o}=cc._decorator;let a=(()=>{let e=class extends cc.Component{constructor(){super(...arguments),this.autoRes=[]}onDestroy(){this.releaseAutoRes()}releaseAutoRes(){for(let e=0;e<this.autoRes.length;e++){const t=this.autoRes[e];t.asset&&(t.asset.decRef(),t.asset=null)}this.autoRes=null}autoReleaseRes(e){e.asset.addRef(),this.autoRes.push(e)}};return e=s([n],e)})();i.default=a,cc._RF.pop()},{}],ResUtil:[function(e,t,i){"use strict";cc._RF.push(t,"b9765ldwsdMOqNsVwMFiaqj","ResUtil"),Object.defineProperty(i,"__esModule",{value:!0}),i.ResUtil=void 0;const s=e("./ResKeeper"),n=e("./AssetLoader");class o{static getResKeeper(e,t){if(e){let i=e.getComponent(s.default);return i||(t?e.addComponent(s.default):o.getResKeeper(e.parent,t))}return n.assetLoader.getResKeeper()}}i.ResUtil=o,cc._RF.pop()},{"./AssetLoader":"AssetLoader","./ResKeeper":"ResKeeper"}],ResultView:[function(e,t,i){"use strict";cc._RF.push(t,"00cd8EbF/lKOZCB4usPFq0b","ResultView");var s=this&&this.__decorate||function(e,t,i,s){var n,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});const n=e("../../frame/MVC"),o=e("./FightModel"),a=e("../../utils/Util"),r=e("../../manager/GameVoManager"),c=e("../../frame/Notifier"),l=e("../../ListenID"),h=e("../../config/Const"),d=e("../../manager/Manager"),u=e("../../CallID"),{ccclass:m,property:g}=cc._decorator;let p=(()=>{let e=class extends n.MVC.BaseView{constructor(){super(...arguments),this.winnode=null,this.failnode=null,this.goldNumLabel=null,this.goldNum=0,this.curLevelLabel=null,this.btnnormal=null,this.btnshare=null}changeListener(e){}onOpen(e){super.onOpen(e),c.Notifier.send(l.ListenID.ShowBanner,0),c.Notifier.send(l.ListenID.DSP_OpenDSPResultView,n.MVC.eUILayer.Popup),this.goldNumLabel=this.node.getChildByName("goldnum").getComponent(cc.Label),this.btnnormal=this.node.getChildByName("btnNormal"),this.btnshare=this.node.getChildByName("btnShare"),this.curLevelLabel=this.node.getChildByName("level").getComponent(cc.Label),this.curLevelLabel.string=`\u7b2c${r.GameVoManager.getInstance.myUserVo.curLevel}\u5173`,this.goldNum=o.default.getInstance.goldInCome,e.reward&&(this.goldNum+=c.Notifier.call(u.CallID.Compose_GetRewardByTime,300)),r.GameVoManager.getInstance.myUserVo.gameResult=e.isWin,this.winnode.active=e&&!!e.isWin,this.failnode.active=e&&!e.isWin,this.goldNumLabel.string="+"+a.Util.goldFormat(this.goldNum),this.btnnormal.active=!1,this.btnshare.active=!1,this.scheduleOnce(()=>{this.btnnormal.active=!0,c.Notifier.send(l.ListenID.Guide_ShowGuide,{step:2})},1.2),r.GameVoManager.getInstance.myUserVo.topLevel>=2&&r.GameVoManager.getInstance.gameSwitchVo.result&&this.scheduleOnce(()=>{this.btnshare.active=!0}),this.showSurpassFriendUI()}showSurpassFriendUI(){}onClose(){c.Notifier.send(l.ListenID.Rank_CloseSurpassView),c.Notifier.send(l.ListenID.Guide_CloseGuide),c.Notifier.send(l.ListenID.HideBanner),c.Notifier.send(l.ListenID.DSP_CloseDSPResultView),this.unscheduleAllCallbacks(),super.onClose()}normalReward(){d.Manager.audio.playAudio(104),r.GameVoManager.getInstance.setGold(this.goldNum,h.Const.GoldUse.GetPass),a.Util.showGoldEffect(null,this.goldNum,cc.Vec2.ZERO,cc.v2(-323,550),.1,0,h.Const.CurrencyType.Gold),this.onClose(),c.Notifier.send(l.ListenID.Compose_OpenView,n.MVC.eUILayer.Panel,null,!0),c.Notifier.send(l.ListenID.Fight_CloseView)}shareReward(){d.Manager.audio.playAudio(104);let e=2*this.goldNum;r.GameVoManager.getInstance.setGold(e,h.Const.GoldUse.GetPass),a.Util.showGoldEffect(null,e,cc.Vec2.ZERO,cc.v2(-323,550),.1,0,h.Const.CurrencyType.Gold),this.onClose(),c.Notifier.send(l.ListenID.Compose_OpenView,n.MVC.eUILayer.Panel,null,!0),c.Notifier.send(l.ListenID.Fight_CloseView)}onVideoReward(){d.Manager.audio.playAudio(104);let e=2*this.goldNum;r.GameVoManager.getInstance.setGold(e,h.Const.GoldUse.GetPass),a.Util.showGoldEffect(null,e,cc.Vec2.ZERO,cc.v2(-323,550),.1,0,h.Const.CurrencyType.Gold),this.onClose(),c.Notifier.send(l.ListenID.Compose_OpenView,n.MVC.eUILayer.Panel,null,!0),c.Notifier.send(l.ListenID.Fight_CloseView)}};return s([g(cc.Node)],e.prototype,"winnode",void 0),s([g(cc.Node)],e.prototype,"failnode",void 0),e=s([m],e)})();i.default=p,cc._RF.pop()},{"../../CallID":"CallID","../../ListenID":"ListenID","../../config/Const":"Const","../../frame/MVC":"MVC","../../frame/Notifier":"Notifier","../../manager/GameVoManager":"GameVoManager","../../manager/Manager":"Manager","../../utils/Util":"Util","./FightModel":"FightModel"}],Role:[function(e,t,i){"use strict";cc._RF.push(t,"522fc2QlxdOvYcV7R5rf/bK","Role"),Object.defineProperty(i,"__esModule",{value:!0}),i.RoleState=void 0;const s=e("../../../fsm/GameStateMachine");var n;(function(e){e[e.NONE=0]="NONE",e[e.MOVE=1]="MOVE",e[e.STAND=2]="STAND",e[e.ATTACk=3]="ATTACk",e[e.BEHIT=4]="BEHIT",e[e.DEAD=5]="DEAD"})(n=i.RoleState||(i.RoleState={}));i.default=class{constructor(){this.curHp=0,this.allHp=0,this.roleId=0,this.gunObject=null,this.isDead=!0,this.attackDelta=0,this.attackNum=0,this.targetId=-1,this.targetArea=1,this._node=null,this.playaudioState=0,this.isReadyFire=!1,this.curHp=0,this.allHp=0,this.roleId=0}beHit(e){}firecb(){}setAttackTarget(e,t=1){this.targetId=e,this.targetArea=t}get node(){return this._node}set node(e){this._node=e}registerFSM(){if(!this._gameStateMachine){this._gameStateMachine=new s.GameStateMachine;let e=this._gameStateMachine.createState(n.NONE),t=()=>{this.noneEnterFunc()},i=()=>{this.noneExitFunc()};e.setCallbackAsMultiFuctions(t,null,i),e.can_re_enter=!0;let o=()=>{this.moveEnterFunc()},a=e=>{this.moveUpdateFunc(e)},r=()=>{this.moveExitFunc()};(e=this._gameStateMachine.createState(n.MOVE)).setCallbackAsMultiFuctions(o,a,r),e.can_re_enter=!0;let c=()=>{this.behitEnterFunc()},l=e=>{this.behitUpdateFunc(e)},h=()=>{this.behitExitFunc()};(e=this._gameStateMachine.createState(n.BEHIT)).setCallbackAsMultiFuctions(c,l,h),e.can_re_enter=!0;let d=()=>{this.deadEnterFunc()},u=e=>{this.deadUpdateFunc(e)},m=()=>{this.deadExitFunc()};(e=this._gameStateMachine.createState(n.DEAD)).setCallbackAsMultiFuctions(d,u,m)}}noneEnterFunc(){}noneUpdateFunc(e){}noneExitFunc(){}moveEnterFunc(){}moveUpdateFunc(e){}moveExitFunc(){}behitEnterFunc(){}behitUpdateFunc(e){}behitExitFunc(){}deadEnterFunc(){}deadUpdateFunc(e){}deadExitFunc(){}standEnterFunc(){}standUpdateFunc(e){}standExitFunc(){}},cc._RF.pop()},{"../../../fsm/GameStateMachine":"GameStateMachine"}],ScaleTransition:[function(e,t,i){"use strict";cc._RF.push(t,"5650bEik7RCXbRsqieANW0B","ScaleTransition"),Object.defineProperty(i,"__esModule",{value:!0}),i.ScaleTransition=void 0;i.ScaleTransition=class{constructor(){this._animInSpeed=.2,this._animOutSpeed=.2,this.isClean=!1}init(e,t){this._node=e,this.isClean=t;var i=cc.callFunc(this.onFadeOutFinish,this),s=cc.callFunc(this.onFadeInFinish,this);this._fadeInAct=cc.sequence(cc.spawn(cc.fadeTo(this._animInSpeed,255),cc.scaleTo(this._animInSpeed,1)),s),this._fadeOutAct=cc.sequence(cc.spawn(cc.fadeTo(this._animOutSpeed,0),cc.scaleTo(this._animOutSpeed,2)),i)}show(){return new Promise(e=>{null!=this._node&&(this._node.active=!0,this._node.setScale(2),this._node.opacity=0,cc.tween(this._node).then(cc.sequence(this._fadeInAct,cc.callFunc(()=>{e(null)}))).start())})}hide(){null!=this._node&&cc.tween(this._node).then(this._fadeOutAct).start()}onFadeInFinish(){}onFadeOutFinish(){this.isClean?this._node.destroy():this._node.active=!1}},cc._RF.pop()},{}],SdkLauncher:[function(e,t,i){"use strict";cc._RF.push(t,"15403H+0ItBYI1R4Qg0HwMI","SdkLauncher");var s=this&&this.__awaiter||function(e,t,i,s){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function a(e){try{c(s.next(e))}catch(e){o(e)}}function r(e){try{c(s.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):n(e.value).then(a,r)}c((s=s.apply(e,t||[])).next())})};Object.defineProperty(i,"__esModule",{value:!0}),i.SdkLauncher=void 0;const n=e("../config/Const"),o=e("../manager/GameVoManager"),a=e("../ListenID"),r=e("../frame/Notifier"),c=e("../frame/Time"),l=e("../config/Cfg"),h=e("../manager/Manager"),d=e("../frame/UIManager");i.SdkLauncher=class{constructor(e,t){this.launchDesc=null,this.progress=null,this._progressNum=0,this.loadFinish=!1,this.otherPrefab=1,this.launchDesc=e,this.progress=t,this._progressNum=10,this.loadFinish=!1,this.setSdkInfo(),this.loadShareTemplates(),this.login()}get progressNum(){return this._progressNum>100?100:this._progressNum}setSdkInfo(){r.Notifier.send(a.ListenID.Login_Start)}login(){this.loadOtherPrefab(),this.loadData()}loadData(){return s(this,void 0,void 0,function*(){yield Promise.all([this.loadOther(),this.loadGameSwitchConfig(),,this.loadTime(),this.loadUserData(),this.loadScene(),this.loadMusic()]),this.progress&&(this.progress.progress=1,this.launchDesc.string="100%"),this.checkLogin().then(()=>{this.initData(),this.loadFinish=!0,setTimeout(()=>{r.Notifier.send(a.ListenID.Login_Finish)},100)}).catch(e=>{this.reLogin()})})}loadTime(){return s(this,void 0,void 0,function*(){return new Promise((e,t)=>{let i=Date.now();c.Time.setServerTime(i),e(null)})})}loadShareTemplates(){}loadGameSwitchConfig(){return s(this,void 0,void 0,function*(){return new Promise((e,t)=>{e(null)})})}loadUserData(){return s(this,void 0,void 0,function*(){return new Promise((e,t)=>{o.GameVoManager.getInstance.loadData(),o.GameVoManager.getInstance.myUserVo.isGetData=!0,r.Notifier.send(a.ListenID.Login_User),e(null)})})}loadScene(){return s(this,void 0,void 0,function*(){return new Promise((e,t)=>{cc.director.preloadScene(n.Const.GAME_SCENENAME,(e,t)=>{},()=>{e(null)})})})}loadEnemy(){return s(this,void 0,void 0,function*(){return new Promise((e,t)=>{let i=l.Cfg.Enemy.filter({}),s=i.length,n=0;for(let t=0;t<s;t++){let o=i[t];cc.resources.load("enemy/"+o.enemyRes,cc.Prefab,(t,i)=>{n++,t?cc.error(t):r.Notifier.send(a.ListenID.Fight_AddEnemyPrefab,o.id,i),n>=s&&e(null)})}})})}loadMusic(){return s(this,void 0,void 0,function*(){let e=l.Cfg.Sound.filter({loop:!0}),t=e.length,i=0;return new Promise((s,n)=>{for(let n=0;n<t;n++){let o=e[n];cc.resources.load(o.path,cc.AudioClip,(e,n)=>{i++,e?cc.error(e):h.Manager.audio.setAudioClip(o.id,n),i>=t&&s(null)})}})})}loadOther(){return s(this,void 0,void 0,function*(){return new Promise((e,t)=>{h.Manager.loader.loadPrefab("ui/guide/GuideStageView").then(t=>{d.UIManager.setUINodePrefab("ui/guide/GuideStageView",t),this.otherPrefab--,this.otherPrefab<=0&&e(null)}).catch(()=>{this.otherPrefab--,this.otherPrefab<=0&&e(null)})})})}loadOtherPrefab(){h.Manager.loader.loadPrefab("ui/fight/FightUI").then(e=>{d.UIManager.setUINodePrefab("ui/fight/FightUI",e)}),h.Manager.loader.loadPrefab("ui/compose/ComposeView").then(e=>{d.UIManager.setUINodePrefab("ui/compose/ComposeView",e)})}checkLogin(){return new Promise((e,t)=>{e(null)})}reLogin(){this.checkLogin().then(()=>{this.initData(),this.loadFinish=!0,r.Notifier.send(a.ListenID.Login_Finish)}).catch(e=>{this.reLogin()})}loadTankPaoAndBigIcon(){let e=o.GameVoManager.getInstance.myUserVo.topTankId+1,t=o.GameVoManager.getInstance.myUserVo.useTankId,i=l.Cfg.Tank.get(t),s=l.Cfg.Tank.get(e);s&&(cc.resources.load("icon/"+s.dickRes),cc.resources.load("icon/tank"+e)),i&&(cc.resources.load("icon/tank"+t),cc.resources.load("icon/"+i.dickRes))}initData(){let e=new Date(c.Time.serverTimeMs).getDate(),t=o.GameVoManager.getInstance.myUserVo;e!=t.day&&(t.day=e,t.shareTime=n.Const.DrawShareTimes,t.drawTimes=t.drawTimes<2?n.Const.DrawFreeTimes:t.drawTimes,t.loginDay+=1,t.giftNum=0,t.serviceReward=0,t.fcReward=0,t.scReward=0,t.commonShareTimes=n.Const.CommonShareTimes,t.interstitialTimes=0,t.jumpRewardAppidList=[],t.jumpAppid="",t.jumpTime=0,t.boxFirstShow=!1,t.boxRewardCount=3,t.boxFirstReward=!1,t.inviteRewardList=[0,0,0,0,0],t.ambushTimes=0),o.GameVoManager.getInstance.myUserVo.powerRecoverTime<=0?(o.GameVoManager.getInstance.myUserVo.powerRecoverTime=c.Time.serverTimeMs,o.GameVoManager.getInstance.myUserVo.nextPowerTime=o.GameVoManager.getInstance.myUserVo.powerRecoverTime+1e3*n.Const.PowerRecoverTime):o.GameVoManager.getInstance.myUserVo.nextPowerTime<=0&&(o.GameVoManager.getInstance.myUserVo.nextPowerTime=o.GameVoManager.getInstance.myUserVo.powerRecoverTime+1e3*n.Const.PowerRecoverTime),o.GameVoManager.getInstance.myUserVo.outputRecoverTime<=0?(o.GameVoManager.getInstance.myUserVo.isfristOutPut=!0,o.GameVoManager.getInstance.myUserVo.outputRecoverTime=c.Time.serverTimeMs):o.GameVoManager.getInstance.myUserVo.isfristOutPut=!1;let i=l.Cfg.Compose.filter({});o.GameVoManager.getInstance.myUserVo.tankAllNum=i.length;let s=l.Cfg.AmbushBarrier.filter({});o.GameVoManager.getInstance.myUserVo.ambushBarrierLength=s.length}},cc._RF.pop()},{"../ListenID":"ListenID","../config/Cfg":"Cfg","../config/Const":"Const","../frame/Notifier":"Notifier","../frame/Time":"Time","../frame/UIManager":"UIManager","../manager/GameVoManager":"GameVoManager","../manager/Manager":"Manager"}],SelectTankView:[function(e,t,i){"use strict";cc._RF.push(t,"2b4edVUF9NHr4yEwqXiWN6j","SelectTankView");var s=this&&this.__decorate||function(e,t,i,s){var n,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});const n=e("../../frame/MVC"),o=e("../../manager/Manager"),a=e("../../utils/Util"),r=e("../../manager/GameVoManager"),c=e("../../frame/Notifier"),l=e("../../ListenID"),h=e("./ComposeModel"),{ccclass:d,property:u}=cc._decorator;let m=(()=>{let e=class extends n.MVC.BaseView{constructor(){super(...arguments),this.pageView=null,this.tankItem=null,this.attackNum=null,this.bloodNum=null,this.desc=null,this.lasttankid=0,this.useTankId=0,this.normalIcon=null,this.notselectIcon=null,this.btnSelect=null,this.tankList=[],this.descText=null,this.useIcon=null}changeListener(e){}onOpen(e){super.onOpen(e),this.initNode(),this.initView(e)}onClose(){o.Manager.audio.playAudio(104),super.onClose(),c.Notifier.send(l.ListenID.Compose_OpenView,n.MVC.eUILayer.Panel)}initNode(){this.btnSelect=this.node.getChildByName("btnSelect"),this.descText=this.node.getChildByName("descText").getComponent(cc.Label),this.normalIcon=cc.find("Background/select",this.btnSelect),this.notselectIcon=cc.find("Background/notselect",this.btnSelect),this.useIcon=cc.find("Background/use",this.btnSelect);let e=this.node.getChildByName("bg");a.Util.resizeNode(e),this.pageView.node.on(cc.Node.EventType.TOUCH_MOVE,this.touchMove,this)}initView(e){this.useTankId=e&&e.useTankId||r.GameVoManager.getInstance.myUserVo.useTankId,this.initTankList()}initTankList(){let e=r.GameVoManager.getInstance.myUserVo.tankAllNum;for(let t=0;t<e;t++){let e=h.default.getInstance.getComposeTankInfoById(t+1);if(e)if(0==t){let e=this.pageView.getPages()[0].getChildByName("tankicon").getComponent(cc.Sprite);this.tankList[t]=e.node,e.node.scale=1.5}else{let i=cc.instantiate(this.tankItem);i.active=!0,this.pageView.addPage(i);let s=i.getChildByName("tankicon").getComponent(cc.Sprite);this.tankList[t]=s.node,s.node.scale=1.5,s.node.color=r.GameVoManager.getInstance.myUserVo.topTankId>=t+1?cc.Color.WHITE:cc.Color.BLACK,o.Manager.spAtlas.getTankIconByResPath(e.icon).then(e=>{e&&(s.spriteFrame=e)})}}this.tankList[this.useTankId-1].scale=2,this.pageView.scrollToPage(this.useTankId-1,0),this.lasttankid=-1,this.updateTankInfo()}updateTankInfo(){let e=this.useTankId<=r.GameVoManager.getInstance.myUserVo.topTankId,t=r.GameVoManager.getInstance.myUserVo.useTankId==this.useTankId;this.btnSelect.getComponent(cc.Button).interactable=e,this.normalIcon.active=e&&!t,this.notselectIcon.active=!e,this.useIcon.active=t;let i=h.default.getInstance.getTankInfoById(this.useTankId);this.descText.string=i&&`Lv${i.tankLevel}.${i.name}`,this.attackNum.string=`\u653b\u51fb:${i.attackNum[0]}-${i.attackNum[1]}`,this.bloodNum.string=`\u8840\u91cf:${i.hp}`,this.desc.string=i.describe}touchMove(e){e.getDeltaX()<0?(this.tankList[this.useTankId-1].scale=Math.lerp(this.tankList[this.useTankId-1].scale,1.5,.05),this.tankList[this.useTankId]&&(this.tankList[this.useTankId].scale=Math.lerp(this.tankList[this.useTankId].scale,2,.05))):e.getDeltaX()>0&&(this.tankList[this.useTankId-1].scale=Math.lerp(this.tankList[this.useTankId-1].scale,1.5,.05),this.tankList[this.useTankId-2]&&(this.tankList[this.useTankId-2].scale=Math.lerp(this.tankList[this.useTankId-2].scale,2,.05)))}onPageEvent(e,t){t===cc.PageView.EventType.PAGE_TURNING&&(this.useTankId=e.getCurrentPageIndex()+1,this.tankList[this.useTankId-1]&&(this.tankList[this.useTankId-1].scale=2),this.tankList[this.useTankId]&&(this.tankList[this.useTankId].scale=1.5),this.tankList[this.useTankId-2]&&(this.tankList[this.useTankId-2].scale=1.5),this.updateTankInfo())}onSelect(){r.GameVoManager.getInstance.myUserVo.useTankId=this.useTankId,this.onClose(),c.Notifier.send(l.ListenID.Compose_OpenView)}};return s([u(cc.PageView)],e.prototype,"pageView",void 0),s([u(cc.Node)],e.prototype,"tankItem",void 0),s([u(cc.Label)],e.prototype,"attackNum",void 0),s([u(cc.Label)],e.prototype,"bloodNum",void 0),s([u(cc.RichText)],e.prototype,"desc",void 0),e=s([d],e)})();i.default=m,cc._RF.pop()},{"../../ListenID":"ListenID","../../frame/MVC":"MVC","../../frame/Notifier":"Notifier","../../manager/GameVoManager":"GameVoManager","../../manager/Manager":"Manager","../../utils/Util":"Util","./ComposeModel":"ComposeModel"}],SettingController:[function(e,t,i){"use strict";cc._RF.push(t,"c40baoW4jFKLpQYZ/omFieO","SettingController"),Object.defineProperty(i,"__esModule",{value:!0}),i.SettingController=void 0;const s=e("../../ListenID"),n=e("../../CallID"),o=e("./SettingModel"),a=e("../../manager/Manager"),r=e("../../config/Const"),c=e("../../frame/MVC"),l=e("../../frame/Notifier");i.SettingController=class extends c.MVC.BaseController{constructor(){super("SettingController"),this.changeListener(!0)}reset(){}changeListener(e){l.Notifier.changeCall(e,n.CallID.Setting_IsMuteMusic,this.isMuteMusic,this),l.Notifier.changeCall(e,n.CallID.Setting_IsMuteAudio,this.isMuteAudio,this),l.Notifier.changeCall(e,n.CallID.Setting_IsBlockShake,this.isBlockShake,this),l.Notifier.changeCall(e,n.CallID.Setting_IsHurtShow,this.isHurtShow,this),l.Notifier.changeCall(e,n.CallID.Setting_GetRealDesignSize,this.getRealDesign,this),l.Notifier.changeListener(e,s.ListenID.Login_Start,this.onLoginStart,this),l.Notifier.changeListener(e,s.ListenID.Setting_MuteMusic,this.reqMuteMusic,this),l.Notifier.changeListener(e,s.ListenID.Setting_MuteAudio,this.reqMuteAudio,this),l.Notifier.changeListener(e,s.ListenID.Setting_BlockShake,this.reqBlockShake,this),l.Notifier.changeListener(e,s.ListenID.Setting_HurtShow,this.reqHurShow,this),l.Notifier.changeListener(e,s.ListenID.Setting_Open,this.openSettingView,this)}onLoginStart(){let e=a.Manager.storage.getString(r.Const.STORAGE_SETTING,"");e&&""!=e&&(o.default.getInstance.initSetting(JSON.parse(e)),a.Manager.audio.muteAudio(o.default.getInstance.muteAudio))}isMuteMusic(){return o.default.getInstance.muteMusic}isMuteAudio(){return o.default.getInstance.muteAudio}isBlockShake(){return o.default.getInstance.blockShake}isHurtShow(){return!1}getRealDesign(){return o.default.getInstance.getRealDesignSize()}reqMuteMusic(e){o.default.getInstance.muteMusic=!!e;let t=l.Notifier.call(n.CallID.Compose_isInCompose);a.Manager.audio.muteMusic(!!e,t?100:101),this.reqSave()}reqMuteAudio(e){o.default.getInstance.muteAudio=e,a.Manager.audio.muteAudio(e),this.reqSave()}reqBlockShake(e){o.default.getInstance.blockShake=e,this.reqSave()}reqHurShow(e){this.reqSave()}reqSave(){a.Manager.storage.setString(r.Const.STORAGE_SETTING,o.default.getInstance.serialize())}openSettingView(){}},cc._RF.pop()},{"../../CallID":"CallID","../../ListenID":"ListenID","../../config/Const":"Const","../../frame/MVC":"MVC","../../frame/Notifier":"Notifier","../../manager/Manager":"Manager","./SettingModel":"SettingModel"}],SettingModel:[function(e,t,i){"use strict";cc._RF.push(t,"2de9cVCquZAjpI2nj+DeI+Q","SettingModel"),Object.defineProperty(i,"__esModule",{value:!0});const s=e("../../config/Const"),n=e("../../frame/MVC");let o=(()=>{class e extends n.MVC.BaseModel{constructor(){super(),this.muteMusic=!0,this.muteAudio=!0,this.blockShake=!0,this.designSize=null,null==e._instance&&(e._instance=this)}static get getInstance(){return null==e._instance&&(e._instance=new e),e._instance}serialize(){let e={music:this.muteMusic,audio:this.muteAudio,shake:this.blockShake};return JSON.stringify(e)}reset(){}initSetting(e){null!==e&&(this.muteMusic=e.music,this.muteAudio=e.audio,this.blockShake=e.shake)}getRealDesignSize(){if(!this.designSize){let e=cc.view.getCanvasSize();if(e.height/e.width<=1.5){let t=s.Const.designHeight*e.width/e.height;this.designSize=new cc.Size(t,cc.winSize.height)}else{let t=s.Const.designWidth*e.height/e.width;this.designSize=new cc.Size(cc.winSize.width,t)}}return this.designSize}}return e._instance=null,e})();i.default=o,cc._RF.pop()},{"../../config/Const":"Const","../../frame/MVC":"MVC"}],SettingView:[function(e,t,i){"use strict";cc._RF.push(t,"afb57/1yRhDMJlQDsDfUeQg","SettingView");var s=this&&this.__decorate||function(e,t,i,s){var n,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});const n=e("../../ListenID"),o=e("../../CallID"),a=e("../../manager/Manager"),r=e("../../frame/Notifier"),c=e("../../frame/NotifyID"),l=e("../../frame/MVC"),{ccclass:h,property:d}=cc._decorator;let u=(()=>{let e=class extends l.MVC.BaseView{constructor(){super(...arguments),this.musicToggle=null,this.audioToggle=null,this.shakeToggle=null,this.hurtToggle=null,this.lblCustomServer=null,this.lblUserId=null,this._customServer="",this._userId="",this._pasteBtnId=""}changeListener(e){r.Notifier.changeListener(e,c.NotifyID.SDK_Banner_Resize,this.resizeBtnPos,this)}resizeBtnPos(){cc.find("know",this.node).active=!0}onOpen(e){super.onOpen(e);let t=r.Notifier.call(o.CallID.Setting_IsMuteMusic);this.musicToggle.isChecked=t;let i=r.Notifier.call(o.CallID.Setting_IsMuteAudio);this.audioToggle.isChecked=i;let s=r.Notifier.call(o.CallID.Setting_IsBlockShake);this.shakeToggle.isChecked=s;let a=r.Notifier.call(o.CallID.Setting_IsHurtShow);this.hurtToggle.isChecked=a,this.onFlush(),r.Notifier.send(n.ListenID.ShowBanner,3)}start(){}onClose(){a.Manager.audio.playAudio(501),super.onClose(),r.Notifier.send(n.ListenID.HideBanner)}onClickMusic(e){a.Manager.audio.playAudio(501),r.Notifier.send(n.ListenID.Setting_MuteMusic,e.isChecked)}onClickAudio(e){a.Manager.audio.playAudio(501),r.Notifier.send(n.ListenID.Setting_MuteAudio,e.isChecked)}onClickShake(e){a.Manager.audio.playAudio(501),r.Notifier.send(n.ListenID.Setting_BlockShake,e.isChecked)}onClickHurt(e){a.Manager.audio.playAudio(501),r.Notifier.send(n.ListenID.Setting_HurtShow,e.isChecked)}uiPasteBoard(e,t){let i="";if("1"==t){if(this._pasteBtnId==t)return;i=this._customServer}else{if(this._pasteBtnId==t)return;i=this._userId}this._pasteBtnId}onFlush(e="all"){switch(e){case"all":this._updateLblCustomServer(),this._updateLblUserId()}}_updateLblCustomServer(){if(this.lblCustomServer){let e="heidong20190501";this.lblCustomServer.string=e,this._customServer=e}}_updateLblUserId(){}};return s([d(cc.Toggle)],e.prototype,"musicToggle",void 0),s([d(cc.Toggle)],e.prototype,"audioToggle",void 0),s([d(cc.Toggle)],e.prototype,"shakeToggle",void 0),s([d(cc.Toggle)],e.prototype,"hurtToggle",void 0),s([d(cc.Label)],e.prototype,"lblCustomServer",void 0),s([d(cc.Label)],e.prototype,"lblUserId",void 0),e=s([h],e)})();i.default=u,cc._RF.pop()},{"../../CallID":"CallID","../../ListenID":"ListenID","../../frame/MVC":"MVC","../../frame/Notifier":"Notifier","../../frame/NotifyID":"NotifyID","../../manager/Manager":"Manager"}],SignView:[function(e,t,i){"use strict";cc._RF.push(t,"4fdfdSaUoRG772UDnStdkm3","SignView");var s=this&&this.__decorate||function(e,t,i,s){var n,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});const n=e("../../frame/MVC"),o=e("../../manager/GameVoManager"),a=e("../../alert/AlertManager"),r=e("../../frame/Notifier"),c=e("../../ListenID"),l=e("../../config/Const"),h=e("../../utils/Util"),d=e("../../CallID"),u=e("../../manager/Manager"),{ccclass:m,property:g}=cc._decorator;let p=[{awardCount:200,awardType:1},{awardCount:200,awardType:1},{awardCount:200,awardType:1},{awardCount:200,awardType:1},{awardCount:400,awardType:1},{awardCount:600,awardType:1},{awardCount:800,awardType:1}],f=(()=>{let e=class extends n.MVC.BaseView{constructor(){super(...arguments),this.signItemList=[],this.lbNumList=[],this.isget=null,this.btnSign=null,this.btn_extra=null,this.doubletext=null,this.icon=null,this.iconSpriteFrams=[],this.type=1}changeListener(e){}onOpen(e){r.Notifier.send(c.ListenID.ShowBanner,1),super.onOpen(e),this.updateItemList()}onClose(){r.Notifier.send(c.ListenID.HideBanner),super.onClose(),u.Manager.audio.playAudio(104),setTimeout(()=>{r.Notifier.send(c.ListenID.Game_OpenUIList)},200)}updateItemList(){for(let e=0;e<this.signItemList.length;e++){this.signItemList[e].active=o.GameVoManager.getInstance.myUserVo.signDay%7>e;let t=p[e];this.lbNumList[e].string=t.awardCount*o.GameVoManager.getInstance.myUserVo.topTankId/10+t.awardCount+""}let e=p[o.GameVoManager.getInstance.myUserVo.signDay%7];if(e){let t=e.awardCount*o.GameVoManager.getInstance.myUserVo.topTankId/10+e.awardCount;this.doubletext.string="+"+2*t}else console.error("sign data error day = ",o.GameVoManager.getInstance.myUserVo.signDay),this.doubletext.string="";this.setSignState()}setSignState(){r.Notifier.call(d.CallID.Activity_IsSigned)?(this.isget.active=!0,this.btn_extra.active=!1,this.btnSign.node.active=!1):(this.isget.active=!1,this.btn_extra.active=o.GameVoManager.getInstance.gameSwitchVo.checkin,this.btnSign.node.active=!1),o.GameVoManager.getInstance.gameSwitchVo.unite&&(this.icon.spriteFrame=o.GameVoManager.getInstance.myUserVo.commonShareTimes>0?this.iconSpriteFrams[0]:this.iconSpriteFrams[1],o.GameVoManager.getInstance.myUserVo.commonShareTimes>0?this.type=0:this.type=1)}onSign(e,t=0){let i=p[o.GameVoManager.getInstance.myUserVo.signDay%7];if(!i)return void console.error("sign data error day = ",o.GameVoManager.getInstance.myUserVo.signDay);2!=t&&u.Manager.audio.playAudio(104);let s=i.awardCount*o.GameVoManager.getInstance.myUserVo.topTankId/10+i.awardCount,n=2==t?2*s:s;1==i.awardType&&o.GameVoManager.getInstance.setDiamond(n,l.Const.DiamondUse.GetSign),a.AlertManager.showNormalTips("\u9886\u53d6\u6210\u529f"),o.GameVoManager.getInstance.myUserVo.signDay+=1,o.GameVoManager.getInstance.myUserVo.lastSignDay=o.GameVoManager.getInstance.myUserVo.day,r.Notifier.send(c.ListenID.Activity_RefreshSignPoint),h.Util.showGoldEffect(null,n,cc.Vec2.ZERO,cc.v2(-166,602),.1,0,i.awardType),this.updateItemList(),o.GameVoManager.getInstance.saveData()}onShareReward(){o.GameVoManager.getInstance.myUserVo.commonShareTimes--,this.onSign(null,2)}onVideoReward(){u.Manager.audio.playAudio(104),this.type?this.onSign(null,2):this.onShareReward()}};return s([g([cc.Node])],e.prototype,"signItemList",void 0),s([g([cc.Label])],e.prototype,"lbNumList",void 0),s([g(cc.Node)],e.prototype,"isget",void 0),s([g(cc.Button)],e.prototype,"btnSign",void 0),s([g(cc.Node)],e.prototype,"btn_extra",void 0),s([g(cc.Label)],e.prototype,"doubletext",void 0),s([g(cc.Sprite)],e.prototype,"icon",void 0),s([g(cc.SpriteFrame)],e.prototype,"iconSpriteFrams",void 0),e=s([m],e)})();i.default=f,cc._RF.pop()},{"../../CallID":"CallID","../../ListenID":"ListenID","../../alert/AlertManager":"AlertManager","../../config/Const":"Const","../../frame/MVC":"MVC","../../frame/Notifier":"Notifier","../../manager/GameVoManager":"GameVoManager","../../manager/Manager":"Manager","../../utils/Util":"Util"}],SoundCfg:[function(e,t,i){"use strict";cc._RF.push(t,"f8a13eJGLJB7rwcgPhPzvUo","SoundCfg"),Object.defineProperty(i,"__esModule",{value:!0}),i.SoundCfgReader=void 0;const s=e("./TConfig");i.SoundCfgReader=class extends s.TConfig{constructor(){super(...arguments),this._name="Sound"}},cc._RF.pop()},{"./TConfig":"TConfig"}],SpeedUpView:[function(e,t,i){"use strict";cc._RF.push(t,"ab8c3Ne63pI242g2JXKDmMX","SpeedUpView");var s=this&&this.__decorate||function(e,t,i,s){var n,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});const n=e("../../frame/MVC"),o=e("../../config/Const"),a=e("../../manager/GameVoManager"),r=e("../../alert/AlertManager"),c=e("./ComposeModel"),l=e("../../frame/Notifier"),h=e("../../ListenID"),d=e("../../manager/Manager"),{ccclass:u,property:m}=cc._decorator;let g=(()=>{let e=class extends n.MVC.BaseView{constructor(){super(...arguments),this.btnBg2=null,this.diamondNum=10,this.btnShare=null}changeListener(e){}onOpen(e){super.onOpen(e),l.Notifier.send(h.ListenID.ShowBanner,0),this.diamondNum=3*a.GameVoManager.getInstance.myUserVo.topTankId+30,cc.find("btnSpeedUp/Background/layout/num",this.node).getComponent(cc.Label).string=""+this.diamondNum,this.initNode(),this.initView(e)}onClose(){d.Manager.audio.playAudio(104),l.Notifier.send(h.ListenID.HideBanner),super.onClose()}initNode(){this.btnShare=this.node.getChildByName("btnShareSpeedUp")}initView(e){this.updateShare(),this.updateSpeedUp()}updateShare(){this.btnShare.active=a.GameVoManager.getInstance.myUserVo.shareSpeedUpTimes>0&&a.GameVoManager.getInstance.gameSwitchVo.accelerate}onClickSpeedUp(){d.Manager.audio.playAudio(104),a.GameVoManager.getInstance.myUserVo.diamond<this.diamondNum?r.AlertManager.showNormalTipsOnce("\u94bb\u77f3\u4e0d\u8db3\uff0c\u65e0\u6cd5\u52a0\u901f\u6536\u76ca"):a.GameVoManager.getInstance.myUserVo.speedUpTime>o.Const.MaxSpeedUpTime-59?r.AlertManager.showNormalTipsOnce("\u52a0\u901f\u5df2\u8fbe\u4e0a\u9650"):(a.GameVoManager.getInstance.setDiamond(-this.diamondNum,o.Const.DiamondUse.CostSpeedUp),this.onSpeedUp(0))}updateSpeedUp(){this.btnBg2.active=a.GameVoManager.getInstance.myUserVo.diamond<this.diamondNum||a.GameVoManager.getInstance.myUserVo.speedUpTime>o.Const.MaxSpeedUpTime-59,cc.find("layout/num",this.btnBg2).getComponent(cc.Label).string=""+this.diamondNum}onSpeedUp(e){r.AlertManager.showNormalTipsOnce("\u52a0\u901f\u6210\u529f"),a.GameVoManager.getInstance.myUserVo.speedUpTime<=0&&c.default.getInstance.setSpeedUpRadio(.33),a.GameVoManager.getInstance.setSpeedUpTime(e?200:60),a.GameVoManager.getInstance.saveData(),this.updateSpeedUp()}onShareSpeedUp(){a.GameVoManager.getInstance.myUserVo.speedUpTime>o.Const.MaxSpeedUpTime-59?r.AlertManager.showNormalTipsOnce("\u52a0\u901f\u5df2\u8fbe\u4e0a\u9650"):(a.GameVoManager.getInstance.myUserVo.shareSpeedUpTimes--,this.updateShare(),this.onSpeedUp(1))}onVideoReward(){d.Manager.audio.playAudio(104),a.GameVoManager.getInstance.myUserVo.speedUpTime>o.Const.MaxSpeedUpTime-59?r.AlertManager.showNormalTipsOnce("\u52a0\u901f\u5df2\u8fbe\u4e0a\u9650"):(a.GameVoManager.getInstance.myUserVo.shareSpeedUpTimes--,this.updateShare(),this.onSpeedUp(1))}};return s([m(cc.Node)],e.prototype,"btnBg2",void 0),e=s([u],e)})();i.default=g,cc._RF.pop()},{"../../ListenID":"ListenID","../../alert/AlertManager":"AlertManager","../../config/Const":"Const","../../frame/MVC":"MVC","../../frame/Notifier":"Notifier","../../manager/GameVoManager":"GameVoManager","../../manager/Manager":"Manager","./ComposeModel":"ComposeModel"}],SpriteAtlasManager:[function(e,t,i){"use strict";cc._RF.push(t,"49d3fIzJktDJ6R6zOFQi0yX","SpriteAtlasManager"),Object.defineProperty(i,"__esModule",{value:!0}),i.SpriteAtlasManager=void 0;const s=e("./Manager");i.SpriteAtlasManager=class{constructor(){this._spriteatlas={},this._spriteframes={}}getTankIconByResPath(e){let t=this;return new Promise((i,n)=>{let o=t._spriteatlas.tankIcon;null==o?s.Manager.loader.loadSpriteAltasAsync("icon/tankIcon").then(s=>{t._spriteatlas.tankIcon=s,i(s.getSpriteFrame(e))}):i(o.getSpriteFrame(e))})}getTankBigIconByResPath(e){let t=this;return new Promise((i,n)=>{let o=t._spriteframes[e];null==o?s.Manager.loader.loadSpriteAsync("icon/"+e).then(s=>{t._spriteframes[e]=s,i(s)}):i(o)})}getTankBigPaoIconById(e){let t=this;return new Promise((i,n)=>{let o=t._spriteframes[e];null==o?s.Manager.loader.loadSpriteAsync("icon/"+e).then(s=>{t._spriteframes[e]=s,i(s)}):i(o)})}},cc._RF.pop()},{"./Manager":"Manager"}],StorageID:[function(e,t,i){"use strict";cc._RF.push(t,"c8b81nbiGRCbYRyj+ww26/m","StorageID"),Object.defineProperty(i,"__esModule",{value:!0}),i.StorageID=void 0,function(e){e.Setting_MusicVolume="MusicVolume",e.Setting_AudioVolume="AudioVolume",e.Vo_SaveData="savedata"}(i.StorageID||(i.StorageID={})),cc._RF.pop()},{}],StorageManager:[function(e,t,i){"use strict";cc._RF.push(t,"b8c133/lf5FuKhytsXkzX0A","StorageManager"),Object.defineProperty(i,"__esModule",{value:!0}),i.StorageManager=void 0;i.StorageManager=class{constructor(){}clear(){cc.sys.localStorage.clear()}delete(e){cc.sys.localStorage.removeItem(e)}getBool(e,t=!1){let i=cc.sys.localStorage.getItem(e);return isNullOrEmpty(i)?t:0!=i}setBool(e,t){let i=t?1:0;cc.sys.localStorage.setItem(e,i)}getNumber(e,t=0){let i=cc.sys.localStorage.getItem(e);return isNullOrEmpty(i)?t:i}setNumber(e,t){cc.sys.localStorage.setItem(e,t)}getString(e,t=""){let i=cc.sys.localStorage.getItem(e);return isNullOrEmpty(i)?t:i}setString(e,t){cc.sys.localStorage.setItem(e,t)}getObject(e,t=null){let i=cc.sys.localStorage.getItem(e);if(isNullOrEmpty(i))return t;let s=JSON.parse(i);return null==s&&cc.error("StorageManager.getObject error",e,i),s}setObject(e,t){if(null==t)return void cc.error("StorageManager.setObject null",e);let i=JSON.stringify(t);cc.sys.localStorage.setItem(e,i)}getArray(e,t=null){let i=cc.sys.localStorage.getItem(e);if(isNullOrEmpty(i))return t;let s=JSON.parse(i);return null==s&&cc.error("StorageManager.getArray error",e,i),s}setArray(e,t){if(null==t)return void cc.error("StorageManager.setArray null",e);let i=JSON.stringify(t);cc.sys.localStorage.setItem(e,i)}setPersonKey(e){this._personKey=e}getPrivyBool(e,t=!1){return null==this._personKey?(cc.error("getPrivyBool _personKey null"),t):(e=this._personKey+e,this.getBool(e,t))}setPrivyBool(e,t){null!=this._personKey?(e=this._personKey+e,this.setBool(e,t)):cc.error("setPrivyBool _personKey null")}getPrivyNumber(e,t=0){return null==this._personKey?(cc.error("getPrivyNumber _personKey null"),t):(e=this._personKey+e,this.getNumber(e,t))}setPrivyNumber(e,t){null!=this._personKey?(e=this._personKey+e,this.setNumber(e,t)):cc.error("setPrivyNumber _personKey null")}getPrivyString(e,t=""){return null==this._personKey?(cc.error("getPrivyString _personKey null"),t):(e=this._personKey+e,this.getString(e,t))}setPrivyString(e,t){null!=this._personKey?(e=this._personKey+e,this.setPrivyString(e,t)):cc.error("setPrivyString _personKey null")}getPrivyObject(e,t=null){return null==this._personKey?(cc.error("getPrivyObject _personKey null"),t):(e=this._personKey+e,this.getObject(e,t))}setPrivyObject(e,t){null!=this._personKey?(e=this._personKey+e,this.setObject(e,t)):cc.error("setPrivyObject _personKey null")}getPrivyArray(e,t=null){return null==this._personKey?(cc.error("getPrivyArray _personKey null"),t):(e=this._personKey+e,this.getArray(e,t))}setPrivyArray(e,t){null!=this._personKey?(e=this._personKey+e,this.setArray(e,t)):cc.error("setPrivyArray _personKey null")}},cc._RF.pop()},{}],SurpassFriendView:[function(e,t,i){"use strict";cc._RF.push(t,"e5b97pecZlA2oJ3NihbK9DJ","SurpassFriendView");var s=this&&this.__decorate||function(e,t,i,s){var n,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});const n=e("../../ListenID"),o=e("../../frame/MVC"),a=e("../../frame/Notifier"),{ccclass:r,property:c}=cc._decorator;let l=(()=>{let e=class extends o.MVC.BaseView{constructor(){super(...arguments),this.wx_subview=null,this.timeoutID=null,this.sharedTexture=null,this.sharedSpriteFrame=null}changeListener(e){a.Notifier.changeListener(e,n.ListenID.Rank_CloseSurpassView,this.close,this)}onOpen(e){super.onOpen(e),this.resizeSharedCanvas(this.wx_subview.node.width,this.wx_subview.node.height);console.error("=======\u6ca1\u6709openid========")}onClose(){super.onClose()}isWeChat(){return cc.sys.platform==cc.sys.WECHAT_GAME}resizeSharedCanvas(e,t){if(!this.isWeChat())return;if(null==e||null==t)return void console.error("resizeSharedCanvas width/height null",e,t);let i=wx.getOpenDataContext().canvas;i.width=e,i.height=t,this.sharedTexture=new cc.Texture2D,this.sharedSpriteFrame=new cc.SpriteFrame}updateSharedCanvas(e,t=20){if(!this.isWeChat())return;if(null==this.sharedTexture)return void console.error("updateSharedCanvas sharedTexture null",e);let i=wx.getOpenDataContext().canvas;this.sharedTexture.initWithElement(i),this.sharedTexture.handleLoadedTexture(),this.sharedSpriteFrame.setTexture(this.sharedTexture),e.spriteFrame=this.sharedSpriteFrame,null!=this.timeoutID&&(clearTimeout(this.timeoutID),this.timeoutID=null),t>1&&(this.timeoutID=setTimeout(()=>{this.timeoutID=null,this.updateSharedCanvas(e,t-1)},t*t+200))}};return s([c(cc.Sprite)],e.prototype,"wx_subview",void 0),e=s([r],e)})();i.default=l,cc._RF.pop()},{"../../ListenID":"ListenID","../../frame/MVC":"MVC","../../frame/Notifier":"Notifier"}],TConfig:[function(e,t,i){"use strict";cc._RF.push(t,"1b932CBZANMD5yOlbdTXo4r","TConfig"),Object.defineProperty(i,"__esModule",{value:!0}),i.TConfig=void 0;i.TConfig=class{constructor(){this._name="",this._keyMap=null}initByMap(e){null==this._map?this._map=e:cc.error(this._name+" TConfig.initByMap repetition")}initByArray(e){null==this._map?(this._map={},e.forEach(e=>{this._map[e.id]=e})):cc.error(this._name+" TConfig.initByArray repetition")}tryGet(e){if(null==this._map)return void cc.error(this._name+" TConfig.isExist _map null");const t=this._map[e];return[null!=t,t]}get(e){if(null==this._map)return void cc.error(this._name+" TConfig.get _map null");const t=this._map[e];return null==t&&cc.error(this._name+" TConfig.get fail, id:",e),t}find(e){if(null!=this._map){for(const t in this._map){const i=this._map[t];let s=!0;for(const t in e)if(e[t]!==i[t]){s=!1;break}if(s)return i}return cc.error(this._name+" TConfig.find fail, key:",JSON.stringify(e)),null}cc.error(this._name+" TConfig.find _map null")}filter(e){if(null==this._map)return void cc.error(this._name+" TConfig.filter _map null");let t=[];for(const i in this._map){const s=this._map[i];let n=!0;for(const t in e)if(e[t]!==s[t]){n=!1;break}n&&t.push(s)}return t.length<=0&&cc.error(this._name+" TConfig.filter fail, key:",JSON.stringify(e)),t}sort(e,t){e.sort((e,i)=>{for(const s in t){const n=t[s],o=e[s],a=i[s];if(null!=o&&null!=a)return n*(o-a);cc.warn(this._name+" TConfig.sort property null, key:",s,"id",e.id,i.id)}return 0})}forEach(e,t){if(null!=this._map)for(const i in this._map){const s=this._map[i];e.call(t,s)}else cc.error(this._name+" TConfig.forEach _map null")}keyMap(e,t,i){null==this._keyMap&&(this._keyMap={});let s=this._keyMap[e];null==s&&(s={},this._keyMap[e]=s);let n=s[t];if(null==n){n={},s[t]=n;for(const i in this._map){const s=this._map[i],o=s[e],a=s[t];null!=o&&null!=a&&(n[o]=a)}}return n[i]}getAll(){if(null!=this._map)return this._map;cc.error(this._name+" TConfig.getAll _map null")}},cc._RF.pop()},{}],TankCfg:[function(e,t,i){"use strict";cc._RF.push(t,"bac88O69qxKxr48hc5j0UID","TankCfg"),Object.defineProperty(i,"__esModule",{value:!0}),i.TankCfgReader=void 0;const s=e("./TConfig");i.TankCfgReader=class extends s.TConfig{constructor(){super(...arguments),this._name="Tank"}},cc._RF.pop()},{"./TConfig":"TConfig"}],TankItem:[function(e,t,i){"use strict";cc._RF.push(t,"90336pv7UlPSL1vqlXDPpoU","TankItem");var s=this&&this.__decorate||function(e,t,i,s){var n,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});const n=e("../../../config/Cfg"),o=e("../../../manager/Manager"),{ccclass:a,property:r}=cc._decorator;let c=(()=>{let e=class extends cc.Component{constructor(){super(...arguments),this._tankIcon=null,this._tankid=0,this._tanklevel=0,this._sellGold=0}initTank(e){this._tankIcon||(this._tankIcon=this.node.getChildByName("tankIcon").getComponent(cc.Sprite));let t=n.Cfg.Compose.get(e);t&&(this.node.opacity=255,this._tankid=e,this._tanklevel=t.level,this._sellGold=t.sellGold,o.Manager.spAtlas.getTankIconByResPath(t.icon).then(e=>{this._tankIcon&&(this._tankIcon.spriteFrame=e)}))}updateTank(e){this._tankIcon||(this._tankIcon=this.node.getChildByName("tankIcon").getComponent(cc.Sprite));let t=n.Cfg.Compose.get(e);t&&(this._tankid=e,this._tanklevel=t.level,this._sellGold=t.sellGold,o.Manager.spAtlas.getTankIconByResPath(t.icon).then(e=>{this._tankIcon&&(this._tankIcon.spriteFrame=e)}))}get tankLevel(){return this._tanklevel}get sellGold(){return this._sellGold}get tankId(){return this._tankid}};return e=s([a],e)})();i.default=c,cc._RF.pop()},{"../../../config/Cfg":"Cfg","../../../manager/Manager":"Manager"}],TessController:[function(e,t,i){"use strict";cc._RF.push(t,"15e61jbOmtNu4pKuBSNi6PS","TessController"),Object.defineProperty(i,"__esModule",{value:!0}),i.TessController=void 0;const s=e("../../ListenID"),n=e("../../frame/MVC"),o=e("../../frame/Notifier"),a=e("./TessModel"),r=e("../../frame/UIManager");i.TessController=class extends n.MVC.BaseController{constructor(){super("TessController"),this._model=a.default.getInstance,this.changeListener(!0)}reset(){}changeListener(e){o.Notifier.changeListener(e,s.ListenID.Tess_OpenView,this.onOpenView,this),o.Notifier.changeListener(e,s.ListenID.Tess_CloseView,this.onCloseView,this)}onOpenView(e,t,i){r.UIManager.Open("ui/Tess/TessView",t,e,i)}onCloseView(){r.UIManager.Close("ui/Tess/TessView")}},cc._RF.pop()},{"../../ListenID":"ListenID","../../frame/MVC":"MVC","../../frame/Notifier":"Notifier","../../frame/UIManager":"UIManager","./TessModel":"TessModel"}],TessModel:[function(e,t,i){"use strict";cc._RF.push(t,"64caf30ZIlEsbjacXytmNFX","TessModel"),Object.defineProperty(i,"__esModule",{value:!0});const s=e("../../frame/MVC");let n=(()=>{class e extends s.MVC.BaseModel{constructor(){super(),null==e._instance&&(e._instance=this)}reset(){}static get getInstance(){return null==e._instance&&(e._instance=new e),e._instance}}return e._instance=null,e})();i.default=n,cc._RF.pop()},{"../../frame/MVC":"MVC"}],TessView:[function(e,t,i){"use strict";cc._RF.push(t,"cb976E/1ZZB/p8ifE1c/Mft","TessView");var s=this&&this.__decorate||function(e,t,i,s){var n,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});const n=e("../../frame/MVC"),{ccclass:o,property:a}=cc._decorator;let r=(()=>{let e=class extends n.MVC.BaseView{changeListener(e){}onOpen(e){super.onOpen(e)}onClose(){super.onClose()}};return e=s([o],e)})();i.default=r,cc._RF.pop()},{"../../frame/MVC":"MVC"}],Time:[function(e,t,i){"use strict";cc._RF.push(t,"41d81bkUo1Fm5oOi4lmnMDi","Time"),Object.defineProperty(i,"__esModule",{value:!0}),i.Time=void 0;const s=e("./collections/ObjectPool"),n=e("./collections/MinSortList"),o=e("./Watcher"),a=e("./Notifier"),r=e("./NotifyID"),c=e("../ListenID");i.Time=new class{constructor(){this._time=0,this._deltaTime=0,this._frameCount=0,this._clientTimeMs=0,this._clientDate=new Date,this._serverUpdateMs=0,this._serverInitMs=0,this._serverTimeMs=0,this._gameTime=0,this._isUpdateServerTime=!0,this._isPause=!1,this.postGameGoldTime=0,this._index=0,this._pool=new s.ObjectPool(function(){return new o.Watcher}),this._watchers=new n.MinSortList(this.compareTime),this._scaling=!1,this._scale=1,this._scaleDura=0,this._scaleTimeout=0,this._scaleSmooth=!0,this.tokenExpire=3600,this.isgetToken=!1,this.getTokenState=0,a.Notifier.changeListener(!0,r.NotifyID.Game_OnHide,this.onHideCallBack,this)}get time(){return this._time}get deltaTime(){return this._deltaTime}get frameCount(){return this._frameCount}get clientTimeMs(){return this._clientTimeMs}get clientDate(){return this._clientDate}onHideCallBack(){this._isUpdateServerTime=!1}get serverTimeMs(){return this._serverTimeMs=this._serverInitMs+Date.now()-this._serverUpdateMs,this._serverTimeMs}getServetTime(){return new Promise((e,t)=>{this._isUpdateServerTime?e(this.serverTimeMs):this.updateServerTime().then(e).catch(t)})}getServetTime1(e,t){this._isUpdateServerTime?e(this.serverTimeMs):(this.updateServerTime(),t())}updateServerTime(){return new Promise((e,t)=>{let s=Date.now();i.Time.setServerTime(s),this._isUpdateServerTime=!1,this.tokenExpire-=60,e(null)})}get isPause(){return this._isPause}pause(){this._isPause=!0}resume(){this._isPause=!1}update(e){if(this._frameCount+=1,this.isgetToken&&(this.tokenExpire-=e,this.tokenExpire<300&&1!=this.getTokenState&&(a.Notifier.send(c.ListenID.Sdk_UpdateToken),this.getTokenState=1)),this._scaling&&(e*=this.scale),this._deltaTime=e,this._isPause)return;this._time+=e,this._gameTime+=e;let t=0;for(this.updateScale(e),a.Notifier.isExist(r.NotifyID.Game_Update)&&a.Notifier.send(r.NotifyID.Game_Update,e),a.Notifier.isExist(c.ListenID.Rank_PostGameMoney)&&(this.postGameGoldTime+=e,this.postGameGoldTime>=300&&(this.postGameGoldTime=0,a.Notifier.send(c.ListenID.Rank_PostGameMoney)));;){let e=this._watchers.peek();if(null==e||e.nextTime>this._time)break;if(this._watchers.pop(),e._CallBack(),e.enable&&this._watchers.add(e),++t>5e3){cc.error("watchers too many! frist:"+e.toString());break}}}setServerTime(e){this._serverTimeMs=e,this._serverInitMs=e,this._serverUpdateMs=Date.now()}compareTime(e,t){return e.nextTime<t.nextTime?-1:e.nextTime>t.nextTime?1:0}delay(e,t,i=null,s=null,n=1){if(null==t)return cc.error("Delay ArgCallback null:"+t+" arg:"+i),null;if(null==e||e<0)return cc.error("Timer.Delay delay:"+e),null;let o=this._pool.pop();return o._SetIndex(++this._index),o._SetCallback(this._time+e,e,t,i,s,n),this._watchers.add(o),o}doCancal(e){null!=e&&(e.Cancal(),this._pool.push(e))}reset(){this._index=0,this._watchers.clear(this.doCancal,this),cc.warn("Time.reset")}setScale(e,t,i=!0){this._scaling=!0,this._scale=e,this._scaleDura=t,this._scaleTimeout=this._time+t,this._scaleSmooth=i,cc.director.getScheduler().setTimeScale(e),a.Notifier.send(r.NotifyID.Time_Scale,e)}updateScale(e){if(this._scaling){if(this._time>this._scaleTimeout)return this._scaling=!1,cc.director.getScheduler().setTimeScale(1),void a.Notifier.send(r.NotifyID.Time_Scale,1);if(this._scaleSmooth){let e=Math.lerp(this._scale,1,1-(this._scaleTimeout-this._time)/this._scaleDura);cc.director.getScheduler().setTimeScale(e),a.Notifier.send(r.NotifyID.Time_Scale,e)}}}get scale(){return cc.director.getScheduler().getTimeScale()}get isScaling(){return this._scaling}startGameTimeLog(){this._gameTime=0}get gameTime(){return this._gameTime}initTokenTime(){this.getTokenState=2,this.tokenExpire=3600,this.isgetToken=!0}},cc._RF.pop()},{"../ListenID":"ListenID","./Notifier":"Notifier","./NotifyID":"NotifyID","./Watcher":"Watcher","./collections/MinSortList":"MinSortList","./collections/ObjectPool":"ObjectPool"}],TurnTableCfg:[function(e,t,i){"use strict";cc._RF.push(t,"2a724dlR8VHcrAolZhbuYuC","TurnTableCfg"),Object.defineProperty(i,"__esModule",{value:!0}),i.TurnTableCfgReader=void 0;const s=e("./TConfig");i.TurnTableCfgReader=class extends s.TConfig{constructor(){super(...arguments),this._name="TurnTable"}},cc._RF.pop()},{"./TConfig":"TConfig"}],UILauncher:[function(e,t,i){"use strict";cc._RF.push(t,"7b8302YgmxDyr7czDTcjN+o","UILauncher"),Object.defineProperty(i,"__esModule",{value:!0}),i.UILanuncher=void 0;const s=e("../manager/Manager"),n=e("../frame/UIManager"),o=e("../frame/MVC");i.UILanuncher=class{constructor(){n.UIManager.Init(),o.MVC.ViewHandler.initAssetHandler(s.Manager.loader.loadRes.bind(s.Manager.loader),s.Manager.loader.releaseAsset.bind(s.Manager.loader)),o.MVC.ComponentHandler.initAssetHandler(s.Manager.loader.loadRes.bind(s.Manager.loader),s.Manager.loader.releaseAsset.bind(s.Manager.loader))}},cc._RF.pop()},{"../frame/MVC":"MVC","../frame/UIManager":"UIManager","../manager/Manager":"Manager"}],UIManager:[function(e,t,i){"use strict";cc._RF.push(t,"fe668X5K0RETYPDQglel1lR","UIManager"),Object.defineProperty(i,"__esModule",{value:!0}),i.UIManager=void 0;const s=e("./MVC"),n=e("../config/Const"),o=e("../alert/AlertManager"),a=720,r=1280;let c;class l{constructor(){this._viewNode=cc.js.createMap(),this._assets="",this._counter=0,this._countcall=0,this._views={},s.MVC.ViewHandler.initUIEvent(this.onOpen.bind(this),this.onClose.bind(this))}static Init(){(c=new l).initRoot()}static get canvas(){return c._canvas}static RegisterViewType(e,t){}static Open(e,t=s.MVC.eTransition.Default,i=s.MVC.eUILayer.Panel,n=null,o=!0){c.open(e,t,i,n,o)}static Close(e){c.close(e)}static CloseQueues(){c.closeQueues()}static layerRoots(e=s.MVC.eUILayer.Panel){return c.getLayerRoots(e)}static getNodeByName(e){return c.getNodeByName(e)}static setUINodePrefab(e,t){c._viewNode[e]=t}initRoot(){this._root=new cc.Node("_UIRoot"),this._root.parent=cc.director.getScene(),this._root.width=a,this._root.height=r,this._root.position=cc.v3(a/2,r/2),cc.game.addPersistRootNode(this._root),this._layerRoots=new Array;for(let e=s.MVC.eUILayer.Scene;e<s.MVC.eUILayer.Max;e++)this._layerRoots[e]=this.addSubCanvas(s.MVC.eUILayer[e])}addSubCanvas(e){let t=new cc.Node(e+"_Root");return t.group="UI",t.parent=this._root,t.width=a,t.height=r,t.position=cc.Vec3.ZERO,t.angle=0,t}open(e,t=s.MVC.eTransition.Default,i=s.MVC.eUILayer.Panel,a=null,r=!0){let c=e.split("/");if(null==this._views[e]){this._views[e]={asset:e,args:a,uiLayer:i,transition:t,cleanView:r};let l=c[c.length-1];if(this._viewNode[e]&&cc.isValid(this._viewNode[e])){try{let s=this._viewNode[e];s.getComponent(l).init(i,t,e,r),s.setParent(this._layerRoots[i]),s.group=n.Const.GroupUI,this._views[e].node=s,s.getComponent(l).open(this._views[e].args)}catch(e){console.log(e),o.AlertManager.showAlert(o.AlertType.COMMON,{desc:`\u6253\u5f00UI ${l}\u9519\u8bef`+e,errorcb:a&&a.errorcb})}return}this._assets=e,this._uiLayer=i,this._transition=t,s.MVC.ViewHandler.loadAssetHandler(e,cc.Prefab,(t,i)=>{t?this._views[e]=null:this.onLoadCallback(i,e)})}else this._views[e].node&&this._views[e].node.getComponent(c[c.length-1]).open(a)}getLayerRoots(e){return this._layerRoots[e]}onLoadCallback(e,t){let i=e,s=t.split("/"),a=this._views[t],r=cc.instantiate(i);try{r.getComponent(s[s.length-1]).init(a.uiLayer,a.transition,t,a.cleanView),r.setParent(this._layerRoots[a.uiLayer]),r.group=n.Const.GroupUI,this._views[t].node=r,r.getComponent(s[s.length-1]).open(this._views[t].args)}catch(e){o.AlertManager.showAlert(o.AlertType.COMMON,{desc:`\u6253\u5f00UI ${s[s.length-1]}\u9519\u8bef`+e}),console.log(e)}this._countcall=1}onOpen(e){}close(e){let t=this._views[e];null!=t&&t.node&&cc.isValid(t.node)&&t.node.getComponent(t.node.name).close()}onClose(e,t,i){i&&(this._views[t]=null)}closeQueues(){}getNodeByName(e){if(this._views[e]&&this._views[e].node)return this._views[e].node}}i.UIManager=l,cc._RF.pop()},{"../alert/AlertManager":"AlertManager","../config/Const":"Const","./MVC":"MVC"}],UnLockView:[function(e,t,i){"use strict";cc._RF.push(t,"61316Y4Kz1NGZO0oLYYHOuw","UnLockView");var s=this&&this.__decorate||function(e,t,i,s){var n,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});const n=e("../../frame/MVC"),o=e("../../config/Cfg"),a=e("../../manager/Manager"),r=e("../../config/Const"),c=e("../../frame/Notifier"),l=e("../../ListenID"),{ccclass:h,property:d}=cc._decorator;let u=(()=>{let e=class extends n.MVC.BaseView{constructor(){super(...arguments),this.icon=null,this.iconSpriteFrams=[],this._args=null,this.tankIcon=null,this.tankName=null,this.tankId=0,this.unLockReward=0,this.unLockRewardType=0,this.rewardType=0,this.ischeck=!1}changeListener(e){}onOpen(e){super.onOpen(e),this._args=e,c.Notifier.send(l.ListenID.ShowBanner,0),this.initNode(),this.initTitleIcon(),this.initView(e)}onClose(){super.onClose(),c.Notifier.send(l.ListenID.HideBanner),this._args.type||this.checkoutReward()}initTitleIcon(){1==this._args.type?this.icon.spriteFrame=this.iconSpriteFrams[1]:2==this._args.type?this.icon.spriteFrame=this.iconSpriteFrams[2]:this.icon.spriteFrame=this.iconSpriteFrams[0]}initNode(){this.tankIcon=this.node.getChildByName("tankIcon").getComponent(cc.Sprite),this.tankName=this.node.getChildByName("tankName").getComponent(cc.Label),this.desc=this.node.getChildByName("desc").getComponent(cc.RichText)}initView(e){if(a.Manager.audio.playAudio(103),this.ischeck=!1,e&&e.unLockId){this.tankId=e.unLockId;let t=o.Cfg.Compose.get(e.unLockId);t&&(this.unLockReward=t.diamond?t.diamond:t.shareGiamond,this.unLockRewardType=t.diamond?r.Const.GetRewardType.Free:r.Const.GetRewardType.Video,this.rewardType=r.Const.CurrencyType.Diamond,a.Manager.spAtlas.getTankBigIconByResPath(t.icon).then(e=>{this.tankIcon&&(this.tankIcon.spriteFrame=e)}),this.tankName.string=`Lv${t.level}.${t.name}`);let i=o.Cfg.Tank.get(this.tankId);i&&(this.desc.string=i.simpleDesc||"\u975e\u5e38\u5389\u5bb3\u7684\u5766\u514b");let s=o.Cfg.Tank.get(this.tankId+1);s&&(cc.resources.load("icon/"+s.dickRes),cc.resources.load("icon/tank"+(this.tankId+1)))}}checkoutReward(){this.ischeck||(this.ischeck=!0,this.unLockReward&&c.Notifier.send(l.ListenID.Compose_OpenExtraRewardView,n.MVC.eUILayer.Popup,n.MVC.eTransition.EaseScale,{rewardNum:this.unLockReward,GetRewardType:this.unLockRewardType,rewardType:this.rewardType}))}};return s([d(cc.Sprite)],e.prototype,"icon",void 0),s([d(cc.SpriteFrame)],e.prototype,"iconSpriteFrams",void 0),e=s([h],e)})();i.default=u,cc._RF.pop()},{"../../ListenID":"ListenID","../../config/Cfg":"Cfg","../../config/Const":"Const","../../frame/MVC":"MVC","../../frame/Notifier":"Notifier","../../manager/Manager":"Manager"}],UserVo:[function(e,t,i){"use strict";cc._RF.push(t,"5d1063vRvxCQ6HlGrCNrbGO","UserVo"),Object.defineProperty(i,"__esModule",{value:!0}),i.UserVo=void 0;const s=e("../alert/AlertManager");i.UserVo=class{constructor(){this.isAuthorize=0,this.nickName="\u533f\u540d",this.avatarUrl="",this.day=0,this.useTankId=1,this.topTankId=1,this.topLevel=0,this.gold=0,this.diamond=0,this.power=10,this.powerRecoverTime=0,this.composeInfo=[1,1,0,0,0,0,0,0,0,0,0,0],this.shopBuyTimesDiamond={},this.clickBuyTimes={},this.lastSignDay=0,this.signDay=0,this.drawTimes=2,this.shareTime=5,this.getDrawTimes=1,this.isDrawDouble=0,this.outputRecoverTime=0,this.speedUpTime=0,this.loginDay=0,this.guideStep=0,this.nextPowerTime=0,this.giftNum=0,this.inviteReward=0,this.inviteRewardList=[0,0,0,0,0],this.boxNum=0,this.boxType=0,this.boxCountdown=30,this.boxShowTips=!1,this.boxFirstShow=!1,this.boxFirstReward=!1,this.boxRewardCount=3,this.boxTankNum=0,this.serviceReward=0,this.fcReward=0,this.scReward=0,this.commonShareTimes=3,this.composeTimes=0,this.killNum=0,this.interstitialTimes=0,this.jumpRewardAppidList=[],this.jumpAppid="",this.jumpTime=0,this.ambushTopLevel=0,this.guideAmbushTime=0,this.openAmbushGuideTime=0,this.ambushTopHitTank=0,this.ambushTimes=0,this.isGetData=!1,this.tankAllNum=50,this.curLevel=0,this.shareSpeedUpTimes=3,this.isfristOutPut=!1,this.channel_code="",this.DSPData=null,this.DSPPanelPoint=!0,this.inviteRedPoint=!0,this.openShopTimes=0,this.videoItemId=0,this.showSign=!1,this.showDraw=!1,this.curSceneId=1,this.lastSceneId=1,this.lastShowInterstitialTime=0,this.isShowDspPanel=!1,this.isKillHalf=!1,this.ambushBarrierLength=0,this.gameResult=!0}updatetUserVo(e){Object.getOwnPropertyNames(this).forEach(function(t){if(e.hasOwnProperty(t)&&"version"!=t)if("member"!=t)this[t]=e[t];else for(let i in e[t])this[t][i]=e[t][i]}.bind(this))}serialize(){let e={day:this.day,nickName:this.nickName,avatarUrl:this.avatarUrl,isAuthorize:this.isAuthorize,useTankId:this.useTankId,topTankId:this.topTankId,gold:this.gold,diamond:this.diamond,power:this.power,powerRecoverTime:this.powerRecoverTime,composeInfo:this.composeInfo,clickBuyTimes:this.clickBuyTimes,shopBuyTimesDiamond:this.shopBuyTimesDiamond,topLevel:this.topLevel,signDay:this.signDay,lastSignDay:this.lastSignDay,drawTimes:this.drawTimes,shareTime:this.shareTime,getDrawTimes:this.getDrawTimes,isDrawDouble:this.isDrawDouble,outputRecoverTime:this.outputRecoverTime,speedUpTime:this.speedUpTime,loginDay:this.loginDay,guideStep:this.guideStep,nextPowerTime:this.nextPowerTime,giftNum:this.giftNum,inviteReward:this.inviteReward,boxNum:this.boxNum,boxType:this.boxType,boxCountdown:this.boxCountdown,serviceReward:this.serviceReward,fcReward:this.fcReward,scReward:this.scReward,commonShareTimes:this.commonShareTimes,composeTimes:this.composeTimes,killNum:this.killNum,interstitialTimes:this.interstitialTimes,jumpRewardAppidList:this.jumpRewardAppidList,jumpAppid:this.jumpAppid,jumpTime:this.jumpTime,boxFirstShow:this.boxFirstShow,boxRewardCount:this.boxRewardCount,boxFirstReward:this.boxFirstReward,boxTankNum:this.boxTankNum,inviteRewardList:this.inviteRewardList,ambushTopLevel:this.ambushTopLevel,guideAmbushTime:this.guideAmbushTime,openAmbushGuideTime:this.openAmbushGuideTime,ambushTopHitTank:this.ambushTopHitTank,ambushTimes:this.ambushTimes},t="";try{"{}"!=(t=JSON.stringify(e))&&null!=t&&""!=t||s.AlertManager.showAlert(s.AlertType.COMMON,{desc:"\u6570\u636e\u5e8f\u5217\u5316\u51fa\u9519"+t+",\u8bf7\u622a\u56fe\u53cd\u9988\u7ed9\u5ba2\u670d"})}catch(e){s.AlertManager.showAlert(s.AlertType.COMMON,{desc:"\u6570\u636e\u5e8f\u5217\u5316\u51fa\u9519"+e+",\u8bf7\u622a\u56fe\u53cd\u9988\u7ed9\u5ba2\u670d"})}return t}},cc._RF.pop()},{"../alert/AlertManager":"AlertManager"}],Util:[function(e,t,i){"use strict";cc._RF.push(t,"99dcfZt4ddAR5sPFnes7dU9","Util");var s=this&&this.__awaiter||function(e,t,i,s){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function a(e){try{c(s.next(e))}catch(e){o(e)}}function r(e){try{c(s.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):n(e.value).then(a,r)}c((s=s.apply(e,t||[])).next())})};Object.defineProperty(i,"__esModule",{value:!0}),i.Util=void 0;const n=e("../config/Const"),o=e("../manager/Manager"),a=e("../frame/MVC"),r=e("../frame/UIManager"),c=e("../config/Cfg"),l=e("../module/fight/FightModel");let h=(()=>{class e{static isWeChat(){return cc.sys.platform==cc.sys.WECHAT_GAME}static getAngle(e,t){if(0==t.x&&0==t.y)return 0;let i=cc.v2(t).signAngle(e);return 180/(Math.PI/i)}static AngleToRadinas(e){return e*(Math.PI/180)}static RadinasToAngle(e){return 180*e/Math.PI}static pDistance(e,t){let i=t.x-e.x,s=t.y-e.y;return Math.sqrt(i*i+s*s)}static getAngleByVec2(e){let t=0<e.x?1:-1,i=e.mag();if(0==i)return 0;let s=e.y/i,n=Math.acos(s);return 180/(Math.PI/n)*t}static setSprite2(e,t,i=null){if(!e)return void cc.error("\u8bf7\u4f20\u5165\u6b63\u786e\u7684\u8282\u70b9\u540d\u79f0");if(!t)return void cc.error("\u8bf7\u4f20\u5165\u6b63\u786e\u7684\u8d44\u6e90\u8def\u5f84");var s;if(e instanceof cc.Sprite)s=e;else if(e instanceof cc.Node)s=e.getComponent(cc.Sprite);else{if("[object String]"!==Object.prototype.toString.call(e))return void cc.error("\u4f20\u5165\u8282\u70b9\u8d44\u6e90\u7c7b\u578b\u4e0d\u6b63\u786e");s=cc.find(e).getComponent(cc.Sprite)}if(!s)return void cc.error("\u672a\u627e\u5230\u6b63\u786e\u7684Sprite");if(!s||!s.spriteFrame)return;var n=s.node.opacity;s.node.opacity=0;let o="load";0!=t.indexOf("http")&&(o+="Res"),cc.loader[o]({url:t,type:"jpg"},function(e,t){e?cc.error(e.message||e):(s.spriteFrame=new cc.SpriteFrame(t),s.node.opacity=n,i&&i())})}static setSprite(t,i,s=null){if(!e.isWeChat())return void this.setSprite2(t,i,s);if(!i)return;let n=null;if(t instanceof cc.Sprite?n=t:t instanceof cc.Node&&(n=t.getComponent(cc.Sprite)),!n)throw new Error("CommonUtil.setSprite:  \u65e0\u6cd5\u627e\u5230\u6b63\u786e\u7684Sprite");let o=wx.createImage();o.onload=function(){let e=new cc.Texture2D;e.initWithElement(o),e.handleLoadedTexture(),n.spriteFrame=new cc.SpriteFrame(e),s&&s()},o.src=i}static setNodePic(e,t){cc.resources.load(t,cc.SpriteFrame,function(t,i){t?cc.error(t.message||t):e.getComponent(cc.Sprite).spriteFrame=i})}static random(e,t){return e+Math.floor(Math.random()*(t-e))}static timeFormat(e,t=1){if(e<0)return"";let i="";if(1==t){i=`${Math.floor(e/60)}\u5206${e%60}\u79d2`}else if(2==t){let t=e/60>>0;i+=(t<10?"0":"")+t+":";let s=Math.ceil(e%60);i+=(s<10?"0":"")+s}return i}static normalName(e,t=5){let i=e;return e.length>t&&(i=e.substr(0,t)+"..."),i}static getRandomSDiff(e,t,i,s=!1){if(t-e+1<i&&!s)return[0];let n=new Array,o=t-e+1;for(let t=0;t<o;t++)n[t]=e+t;let a=new Array;for(let e=0;e<i;e++){let t=o-1-e;t<=0&&(t=o-1);let i=this.random(0,t);a[e]=n[i];var r=n[t];n[t]=n[i],n[i]=r}return a}static randomArray(e){let t=new Array,i=e,s=e.length;for(let e=0;e<s;e++){let o=this.random(0,s-1-e);t[e]=i[o];var n=i[s-1-e];i[s-1-e]=i[o],i[o]=n}return t}static goldFormat(e,t=1){let i="",s="";if(e<=0)return"0";if(e<1e3)return String(Math.floor(e));if(e>=1e3&&e<1e6?(i=(e/1e3).toFixed(t),s="k"):e>=1e6&&e<1e9?(i=(e/1e6).toFixed(t),s="m"):e>=1e9&&e<1e12?(i=(e/1e9).toFixed(t),s="b"):e>=1e12&&e<1e15?(i=(e/1e12).toFixed(t),s="t"):e>=1e15&&e<1e18?(i=(e/1e15).toFixed(t),s="A"):e>=1e18&&e<1e21?(i=(e/1e18).toFixed(t),s="B"):e>=1e21&&e<1e24?(i=(e/1e21).toFixed(t),s="C"):e>=1e24&&e<1e27?(i=(e/1e24).toFixed(t),s="D"):e>=1e27&&e<1e30?(i=(e/1e27).toFixed(t),s="E"):e>=1e30&&e<1e33?(i=(e/1e30).toFixed(t),s="F"):e>=1e33&&e<1e36?(i=(e/1e33).toFixed(t),s="G"):(i=(e/1e36).toFixed(t),s="H"),i.length>4){let e=i.indexOf(".");-1!=e&&(i=i.substr(0,e))}return i+s}static numFormat(e,t=1){let i="",s="";return e<=0?"0":e<1e3?String(Math.floor(e)):(e>=1e3&&e<1e6?(i=(e/1e3).toFixed(t),s="k"):e>=1e6&&e<1e9?(i=(e/1e6).toFixed(t),s="m"):e>=1e9&&e<1e12?(i=(e/1e9).toFixed(t),s="b"):e>=1e12&&e<1e15?(i=(e/1e12).toFixed(t),s="t"):e>=1e15&&e<1e18?(i=(e/1e15).toFixed(t),s="A"):e>=1e18&&e<1e21?(i=(e/1e18).toFixed(t),s="B"):e>=1e21&&e<1e24?(i=(e/1e21).toFixed(t),s="C"):e>=1e24&&e<1e27?(i=(e/1e24).toFixed(t),s="D"):e>=1e27&&e<1e30?(i=(e/1e27).toFixed(t),s="E"):e>=1e30&&e<1e33?(i=(e/1e30).toFixed(t),s="F"):e>=1e33&&e<1e36?(i=(e/1e33).toFixed(t),s="G"):(i=(e/1e36).toFixed(t),s="H"),i+s)}static showGoldEffect(t,i,c,l,h=0,d=100,u=n.Const.CurrencyType.Gold){if(e._goldN){let s=cc.instantiate(e._goldN);s.parent=t||r.UIManager.layerRoots(a.MVC.eUILayer.Tips),s.setPosition(c),s.getComponent("GoldEffect").stopEffect(),s.getComponent("GoldEffect").playEffect(i,l,h,0,u)}else setTimeout(function(){return s(this,void 0,void 0,function*(){o.Manager.loader.loadPrefab("tool/goldeffect").then(s=>{e._goldN=cc.instantiate(s),s.parent=t||r.UIManager.layerRoots(a.MVC.eUILayer.Tips),s.setPosition(c),s.getComponent("GoldEffect").playEffect(i,l,h,0,u)})})},d)}static S4(){return(65536*(1+Math.random())|0).toString(16).substring(1)}static guid(){return e.S4()+e.S4()+"-"+e.S4()+"-"+e.S4()+"-"+e.S4()+"-"+e.S4()+e.S4()+e.S4()}static resizeNode(e){if(e&&cc.isValid(e)){let t=cc.view.getCanvasSize();t.height/t.width<=1.5&&(e.scale=t.height/t.width)}}static setAvatarSprite(t,i,s=null){e.setSprite(t,i,s)}static getRealLevel(e){if(c.Cfg.Barrier.get(e))return e;{let t=e%5;return t+=l.default.getInstance.allCfgLevel-4}}}return e._goldN=null,e})();i.Util=h,cc._RF.pop()},{"../config/Cfg":"Cfg","../config/Const":"Const","../frame/MVC":"MVC","../frame/UIManager":"UIManager","../manager/Manager":"Manager","../module/fight/FightModel":"FightModel"}],Watcher:[function(e,t,i){"use strict";cc._RF.push(t,"a91bbeXOJhCI5u8YLBb1N8e","Watcher"),Object.defineProperty(i,"__esModule",{value:!0}),i.Watcher=void 0;i.Watcher=class{constructor(){}get index(){return this._index}get nextTime(){return this._nextTime}get delay(){return this._delay}set delay(e){this._delay=e}get times(){return this._times}get enable(){return this._times>0||-1==this.times}_SetIndex(e){this._index=e}_SetCallback(e,t,i,s=null,n=null,o=1){o<0&&(o=-1),this._nextTime=e,this._delay=t,this._times=o,this._func=i,this._args=s,this._target=n}Cancal(e=!1){e&&this._CallBack(),this._times=0}_CallBack(){this.enable&&(this.times>0?(this._times=this._times-1,this._nextTime=this.nextTime+this.delay):-1==this.times?this._nextTime=this.nextTime+this.delay:cc.error("Watcher._CallBack times error:",this.times),null!=this._func&&this._func.call(this._target,this._args))}toString(){let e="[Watcher] index:"+this.index+" time:"+this.nextTime+" times:"+this.times;return null==this._args?e+=" func:"+this._func:e+=" argfunc:"+this._func+" "+this._args,e}},cc._RF.pop()},{}],WelfareView:[function(e,t,i){"use strict";cc._RF.push(t,"c5b3ebsoG9J0q/ee1p68IsK","WelfareView");var s=this&&this.__decorate||function(e,t,i,s){var n,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});const n=e("../../frame/MVC"),o=e("../../manager/Manager"),a=e("../../frame/Notifier"),r=e("../../ListenID"),{ccclass:c,property:l}=cc._decorator;let h=(()=>{let e=class extends n.MVC.BaseView{constructor(){super(...arguments),this.servicePanel=null,this.img_fc=null,this.img_sc=null}changeListener(e){}onOpen(e){a.Notifier.send(r.ListenID.ShowBanner,0),super.onOpen(e)}onClose(){a.Notifier.send(r.ListenID.HideBanner),o.Manager.audio.playAudio(104),super.onClose()}onClickService(){}callFunc(){}onToggleClick(e,t){this.servicePanel.active="1"==t,this.img_fc.active="2"==t,this.img_sc.active="3"==t}};return s([l(cc.Node)],e.prototype,"servicePanel",void 0),s([l(cc.Node)],e.prototype,"img_fc",void 0),s([l(cc.Node)],e.prototype,"img_sc",void 0),e=s([c],e)})();i.default=h,cc._RF.pop()},{"../../ListenID":"ListenID","../../frame/MVC":"MVC","../../frame/Notifier":"Notifier","../../manager/Manager":"Manager"}],ZiJieController:[function(e,t,i){"use strict";cc._RF.push(t,"8a728TbYe5PAYUQ2v9zLhxn","ZiJieController"),Object.defineProperty(i,"__esModule",{value:!0}),i.ZiJieController=void 0;const s=e("../../ListenID"),n=e("../../frame/MVC"),o=e("../../frame/Notifier"),a=e("../../frame/UIManager");i.ZiJieController=class extends n.MVC.BaseController{constructor(){super("TessController"),this.changeListener(!0)}reset(){}changeListener(e){o.Notifier.changeListener(e,s.ListenID.ZiJie_OpenView,this.onOpenView,this),o.Notifier.changeListener(e,s.ListenID.ZiJie_CloseView,this.onCloseView,this)}onOpenView(e,t,i){a.UIManager.Open("ui/zijie/ZiJieRecord",t,e,i)}onCloseView(){a.UIManager.Close("ui/zijie/ZiJieRecord")}},cc._RF.pop()},{"../../ListenID":"ListenID","../../frame/MVC":"MVC","../../frame/Notifier":"Notifier","../../frame/UIManager":"UIManager"}],ZiJieRecord:[function(e,t,i){"use strict";cc._RF.push(t,"6d0a719WN5I65oF575f9WF4","ZiJieRecord");var s=this&&this.__decorate||function(e,t,i,s){var n,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});const n=e("../../frame/MVC"),o=e("../../alert/AlertManager"),{ccclass:a,property:r}=cc._decorator;let c=(()=>{let e=class extends n.MVC.BaseView{constructor(){super(...arguments),this.btnZiJieRecord=null,this.recorTime=0,this.startRecord=!1}changeListener(e){}onOpen(e){super.onOpen(e),this.recorTime=0}onClose(){super.onClose()}onClickRecord(){this.startRecord&&this.recorTime<5&&o.AlertManager.showNormalTipsOnce("\u65f6\u95f4\u8fc7\u77ed\u8bf7\u7a0d\u540e")}update(e){}};return s([r(cc.Node)],e.prototype,"btnZiJieRecord",void 0),e=s([a],e)})();i.default=c,cc._RF.pop()},{"../../alert/AlertManager":"AlertManager","../../frame/MVC":"MVC"}],loadSceneCloud:[function(e,t,i){"use strict";cc._RF.push(t,"a6c7fUaFVFPBKZCo9AYLdC8","loadSceneCloud");var s=this&&this.__decorate||function(e,t,i,s){var n,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});const n=e("../../frame/MVC"),{ccclass:o,property:a}=cc._decorator;let r=(()=>{let e=class extends n.MVC.BaseView{constructor(){super(...arguments),this.callArgs=null}changeListener(e){}onOpen(e){super.onOpen(e),this.callArgs=e}onClose(){this._isClosed||(super.onClose(),this.callArgs&&this.callArgs.callAfter&&this.callArgs.callAfter())}onActionInFinish(){this.callArgs&&this.callArgs.callAfter&&this.callArgs.callBefore()}onActionReady(){this.node.active=!1}};return e=s([o],e)})();i.default=r,cc._RF.pop()},{"../../frame/MVC":"MVC"}],"use_v2.1-2.2.1_cc.Toggle_event":[function(e,t,i){"use strict";cc._RF.push(t,"6b6ffzSpnZKkreJppCsM7xI","use_v2.1-2.2.1_cc.Toggle_event"),cc.Toggle&&(cc.Toggle._triggerEventInScript_isChecked=!0),cc._RF.pop()},{}]},{},["use_v2.1-2.2.1_cc.Toggle_event","AppLife","CallID","ListenID","AlertManager","CommonAlert","CurrencyTips","LessCapacityAlert","NetErrorAlert","NormalTips","BannerController","Common_Define","GetRewardOtherUI","GoldEffect","AmbushBarrierCfg","AmbushEnemyCfg","AmbushEnemyPoolCfg","BarrierCfg","Cfg","ComposeCfg","Const","EnemyCfg","EnemyPoolCfg","IConfig","SoundCfg","TConfig","TankCfg","TurnTableCfg","BaseNet","MVC","Notifier","NotifyCaller","NotifyID","NotifyListener","NotifyListener_Interl","Pool","Time","AnimTransition","DefaultTransition","EaseScaleTransition","MoveTransition","ScaleTransition","UIManager","Watcher","MinHeap","MinSortList","ObjectPool","Global","Math","GameState","GameStateMachine","Launcher","ModuleLauncher","NetLauncher","SdkLauncher","UILauncher","AssetLoader","LoaderAdapter","ResKeeper","ResUtil","AnimateManager","AudioManager","CameraManager","GameVoManager","Manager","SpriteAtlasManager","StorageID","StorageManager","ActivityController","ActivityModel","BoxView","DrawReward","DrawView","GiftView","InviteView","SignView","WelfareView","CheatView","ComposeController","ComposeModel","ComposeShopView","ComposeView","ExtraRewardView","FreeUpView","GetGoldPanel","OfflineView","SelectTankView","SpeedUpView","UnLockView","ComposeShopItem","TankItem","AmbushDiamonModeView","AmbushGuideView","DiamonModeFailView","DiamonModeSuccessView","FightController","FightDamageDisplay","FightModel","FightUI","PauseView","ReliveView","ResultView","Enemy","Gun","MainRole","Role","loadSceneCloud","AttackVo","GuideController","GuideModel","GuideStageView","GuideView","NewGuideView","LoginController","LoginModel","PowerBuyView","PowerController","PowerModel","RankController","RankItem","RankModel","RankView","SurpassFriendView","GameScene","SettingController","SettingModel","SettingView","TessController","TessModel","TessView","ZiJieController","ZiJieRecord","GameSwitchVo","UserVo","Util"]);