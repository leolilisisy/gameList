window.__require=function e(t,o,n){function a(r,s){if(!o[r]){if(!t[r]){var c=r.split("/");if(c=c[c.length-1],!t[c]){var l="function"==typeof __require&&__require;if(!s&&l)return l(c,!0);if(i)return i(c,!0);throw new Error("Cannot find module '"+r+"'")}r=c}var p=o[r]={exports:{}};t[r][0].call(p.exports,function(e){return a(t[r][1][e]||e)},p,p.exports,e,t,o,n)}return o[r].exports}for(var i="function"==typeof __require&&__require,r=0;r<n.length;r++)a(n[r]);return a}({AddBubble:[function(e,t,o){"use strict";cc._RF.push(t,"d201aaIcGBDXLGxQpQ6gRkk","AddBubble");var n,a=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var a,i=arguments.length,r=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(i<3?a(r):i>3?a(t,o,r):a(t,o))||r);return i>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,s=r.ccclass,c=r.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.numLabel=null,t.anim=null,t}return a(t,e),t.prototype.show=function(e){this.numLabel.string=""+e,this.anim.on("finished",this.onFinished,this),this.anim.play()},t.prototype.start=function(){},t.prototype.onFinished=function(){this.remove()},t.prototype.remove=function(){var e=this;this.node.removeFromParent(),this.scheduleOnce(function(){e.node.destroy()},1)},i([c(cc.Label)],t.prototype,"numLabel",void 0),i([c(cc.Animation)],t.prototype,"anim",void 0),i([s],t)}(cc.Component);o.default=l,cc._RF.pop()},{}],AimDot:[function(e,t,o){"use strict";cc._RF.push(t,"7461aC49XhJrrhLpw8TEvR4","AimDot");var n,a=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var a,i=arguments.length,r=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(i<3?a(r):i>3?a(t,o,r):a(t,o))||r);return i>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../GameConst"),s=cc._decorator,c=s.ccclass,l=s.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.dotSpriteFrame=[],t}return a(t,e),t.prototype.onLoad=function(){},t.prototype.setType=function(e){this.type=e;var t=-1;switch(e){case r.GameConst.BUBBLE_TYPE.PINK:t=0;break;case r.GameConst.BUBBLE_TYPE.CYAN:t=1;break;case r.GameConst.BUBBLE_TYPE.YELLOW:t=2;break;case r.GameConst.BUBBLE_TYPE.BLUE:t=3;break;case r.GameConst.BUBBLE_TYPE.GREEN:t=4;break;case r.GameConst.BUBBLE_TYPE.RED:t=5;break;case r.GameConst.PROP_BUBBLE_TYPE.LASER:t=6;break;case r.GameConst.PROP_BUBBLE_TYPE.LIGHTNING:t=7;break;case r.GameConst.PROP_BUBBLE_TYPE.BOMB:t=8;break;case r.GameConst.PROP_BUBBLE_TYPE.RAINBOW:t=9}t>=0&&(this.node.getComponent(cc.Sprite).spriteFrame=this.dotSpriteFrame[t])},t.prototype.start=function(){},t.prototype.playAnimation=function(e){this.node&&(this.node.stopAllActions(),e?cc.tween(this.node).to(.6,{scale:1}).to(.6,{scale:1.6}).union().repeatForever().start():cc.tween(this.node).to(.6,{scale:1.6}).to(.6,{scale:1}).union().repeatForever().start())},i([l([cc.SpriteFrame])],t.prototype,"dotSpriteFrame",void 0),i([c],t)}(cc.Component);o.default=p,cc._RF.pop()},{"../GameConst":"GameConst"}],AimLine:[function(e,t,o){"use strict";cc._RF.push(t,"cb9cb8if3JEP6YmMYNZJDvJ","AimLine");var n,a=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var a,i=arguments.length,r=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(i<3?a(r):i>3?a(t,o,r):a(t,o))||r);return i>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../common/PoolManager"),s=e("../GameConst"),c=e("./AimDot"),l=cc._decorator,p=l.ccclass,u=l.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.shooter=null,t.type=-1,t.aimDotArray=[],t.rotation=0,t.DOT_SPACE=60,t.dir=1,t}return a(t,e),t.prototype.onLoad=function(){console.log("[Dot]","onLoad"),r.default.Preload(s.GameConst.PREFAB_NAME.AIM_DOT,s.GameConst.AIM_DOT_MAX_COUNT);for(var e=s.GameConst.AIM_DOT_MAX_COUNT,t=0;t<e;t++){var o=this.spawnDot();this.aimDotArray.push(o);var n=o.getComponent(c.default);n.setType(this.type),t%2==0?n.playAnimation(!0):n.playAnimation(!1)}},t.prototype.init=function(e){console.log("[Dot]","init"),this.bubbleManager=e,this.minPosX=-cc.visibleRect.width/2+s.GameConst.BUBBLE_R,this.maxPosX=cc.visibleRect.width/2-s.GameConst.BUBBLE_R},t.prototype.spawnDot=function(){var e=r.default.Spawn(s.GameConst.PREFAB_NAME.AIM_DOT,this.node);return e.scale=1,e},t.prototype.setRotation=function(e,t){this.rotation=e,this.endPos=t,this.updateRoutine()},t.prototype.setEndPos=function(e){this.endPos=e},t.prototype.setType=function(e){for(var t=0;t<s.GameConst.AIM_DOT_MAX_COUNT;t++){var o=this.aimDotArray[t];o&&(o.getComponent(c.default).setType(e),this.type!=e&&(this.type=e))}},t.prototype.changeXDir=function(){this.vel&&(this.vel.x=-this.vel.x)},t.prototype.updateAimDotPos=function(){for(var e=cc.v2(0,0),t=!1,o=0;o<s.GameConst.AIM_DOT_MAX_COUNT;o++)if(t)(r=this.aimDotArray[o])&&(r.active=!1);else{var n=e.x+this.vel.x,a=e.y+this.vel.y;if(this.type!=s.GameConst.PROP_BUBBLE_TYPE.LASER){if(n<this.minPosX){var i=Math.abs(this.minPosX-e.x);a=Math.abs(i/this.vel.x*this.vel.y)+e.y,n=this.minPosX,this.changeXDir()}else n>this.maxPosX&&(i=Math.abs(e.x-this.maxPosX),a=Math.abs(i/this.vel.x*this.vel.y)+e.y,n=this.maxPosX,this.changeXDir());e=c=cc.v2(n,a),(r=this.aimDotArray[o])&&(this.endPos?c.y>this.endPos.y-s.GameConst.BUBBLE_R?Math.abs(c.y-this.endPos.y)<s.GameConst.BUBBLE_R?this.vel.x/Math.abs(this.vel.x)>0?c.x<=this.endPos.x?(r.active=!0,r.setPosition(c)):(r.active=!1,r.setPosition(c),t=!0):c.x>=this.endPos.x?(r.active=!0,r.setPosition(c)):(r.active=!1,r.setPosition(c),t=!0):(r.active=!1,r.setPosition(c),t=!0):(r.active=!0,r.setPosition(c)):(r.active=!1,r.setPosition(c),t=!0))}else{var r,c;(r=this.aimDotArray[o])&&(n<this.minPosX-s.GameConst.BUBBLE_R||n>this.maxPosX+s.GameConst.BUBBLE_R||a>cc.winSize.height-s.GameConst.BOTTOM_H?r.active=!1:(e=c=cc.v2(n,a),r.active=!0,r.setPosition(c)))}}},t.prototype.updateRoutine=function(){if(this.node.active&&this.bubbleManager){var e=this.bubbleManager.getAimType();this.type!=e&&this.setType(e);var t=cc.misc.degreesToRadians(this.rotation),o=cc.v2(Math.cos(t),Math.sin(t));this.vel=o.mul(this.DOT_SPACE),this.bubbleManager.updateAimColliedBubbleData(null),this.updateAimDotPos()}},t.prototype.start=function(){},i([u(cc.Node)],t.prototype,"shooter",void 0),i([p],t)}(cc.Component);o.default=h,cc._RF.pop()},{"../../common/PoolManager":"PoolManager","../GameConst":"GameConst","./AimDot":"AimDot"}],BaseBubble:[function(e,t,o){"use strict";cc._RF.push(t,"667ceth0R5OIKR8O6B5h8Nl","BaseBubble");var n,a=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var a,i=arguments.length,r=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(i<3?a(r):i>3?a(t,o,r):a(t,o))||r);return i>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../common/EventManager"),s=e("../GameConst"),c=e("../Global"),l=e("../Sound"),p=e("./BubbleUtil"),u=cc._decorator,h=u.ccclass,b=(u.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.onLoad=function(){},t.prototype.start=function(){},t.prototype.getWorldPos=function(){return this.bubbleManager.node.convertToWorldSpaceAR(this.node.getPosition())},t.prototype.init=function(e,t,o){switch(void 0===t&&(t=-1),this.type=e,this.state=s.GameConst.PROP_BUBBLE_STATE.IDLE,this.node.scale=1,this.node.active=!0,this.node.opacity=255,this.innerType=t,this.bubbleManager=o,this.node.stopAllActions(),e){case s.GameConst.BUBBLE_TYPE.BLACK_HOLE:this.startAutoRotation();break;case s.GameConst.BUBBLE_TYPE.RANDOM:this.changeInnerType()}},t.prototype.changeInnerType=function(){var e=p.default.randNum(s.GameConst.BUBBLE_TYPE.PINK,s.GameConst.BUBBLE_TYPE.RED);this.innerType=e},t.prototype.updateInnerType=function(){},t.prototype.isReadBubble=function(){return this.type==s.GameConst.BUBBLE_TYPE.RED||this.type==s.GameConst.BUBBLE_TYPE.RANDOM&&this.innerType==s.GameConst.BUBBLE_TYPE.RED},t.prototype.showGift=function(e){this.node&&(this.node.getChildByName("gift").active=e)},t.prototype.showRing=function(e){this.node.getChildByName("ring").active=e},t.prototype.setInnerType=function(e){this.innerType=e},t.prototype.getInnerType=function(){return this.innerType},t.prototype.getType=function(){return this.type},t.prototype.startAutoRotation=function(){this.node&&(this.node.stopAllActions(),cc.tween(this.node).by(1.2,{angle:360}).repeatForever().start())},t.prototype.moveToBlackHole=function(e,t){var o=this;this.node&&(this.node.stopAllActions(),console.log("[Hole]","\u8fdb\u5165\u9ed1\u6d1e index="+e.x+","+e.y+",pos="+t.x+","+t.y),cc.tween(this.node).to(.4,{position:cc.v3(t.x,t.y,0)}).call(function(){o.bubbleManager.removeBubble(e,o.node)}).start())},t.prototype.iceBreaking=function(e,t){console.log("[ice]","\u7834\u51b0 index=["+e.x+","+e.y+"],nextType="+t),this.bubbleManager.removeBubble(e,this.node),this.bubbleManager.insertBubble(e.x,e.y,t,null,!1),l.default.Ice()},t.prototype.playEffectWithScore=function(e,t,o){void 0===o&&(o=!1);var n=e.getType(),a=e.getInnerType(),i=e.node.getPosition(),r=-1,l=-1;switch(n){case s.GameConst.BUBBLE_TYPE.PINK:case s.GameConst.BUBBLE_TYPE.CYAN:case s.GameConst.BUBBLE_TYPE.YELLOW:case s.GameConst.BUBBLE_TYPE.BLUE:case s.GameConst.BUBBLE_TYPE.GREEN:case s.GameConst.BUBBLE_TYPE.RED:l=n,r=s.GameConst.EFFECT_TYPE.BUBBLE_DIE;break;case s.GameConst.BUBBLE_TYPE.RANDOM:l=a,r=s.GameConst.EFFECT_TYPE.BUBBLE_DIE;break;case s.GameConst.BUBBLE_TYPE.ICE:r=s.GameConst.EFFECT_TYPE.BUBBLE_DIE,o?this.bubbleManager.playEffect(s.GameConst.EFFECT_TYPE.ICE_IDLE,i,-1,-1):this.bubbleManager.playEffect(s.GameConst.EFFECT_TYPE.ICE_BOOM,i,-1,-1);break;case s.GameConst.BUBBLE_TYPE.CLOUD:r=s.GameConst.EFFECT_TYPE.BUBBLE_DIE,this.bubbleManager.playEffect(s.GameConst.EFFECT_TYPE.CLOUD_BOOM,i,-1,-1);break;case s.GameConst.BUBBLE_TYPE.IRON:case s.GameConst.BUBBLE_TYPE.BLACK_HOLE:r=s.GameConst.EFFECT_TYPE.BUBBLE_DIE;break;case s.GameConst.BUBBLE_TYPE.BOOM:case s.GameConst.BUBBLE_TYPE.RAINBOW:case s.GameConst.BUBBLE_TYPE.LASER:case s.GameConst.BUBBLE_TYPE.LIGHTNING:}o&&(console.log("[END][Score]","Down Global.comboScore ="+c.Global.comboScore),t*=2),r>=0&&this.bubbleManager.playEffect(r,i,l,t)},t.prototype.playDeathAnimation=function(e,t,o){var n=this;void 0===t&&(t=0),void 0===o&&(o=0),this.node&&(this.isReadBubble()&&r.EventManager.getInstance().sendEvent(s.GameConst.EVENT.ADD_TO_CHEST),this.node.stopAllActions(),l.default.Remove(),cc.tween(this.node).delay(t).to(.1,{scale:1.2}).to(.1,{scale:1}).call(function(){o>0?n.playEffectWithScore(n,o):n.playEffectWithScore(n,c.Global.comboScore),n.bubbleManager.removeBubble(e,n.node)}).start())},t.prototype.playDownAnimation=function(e,t){var o=this;if(this.node){this.isReadBubble()&&r.EventManager.getInstance().sendEvent(s.GameConst.EVENT.ADD_TO_CHEST),this.node.stopAllActions();var n=this.bubbleManager.getMidLineBubbleLayerPos(),a=p.default.randNum(-50,50),i=cc.jumpBy(.3,cc.v2(a,50),50,1),u=n.y-this.node.y-c.Global.midSpace+80,h=Math.abs(u)/3e3;return cc.tween(this.node).delay(.1).then(i).by(h,{position:cc.v3(0,u,0)}).to(.1,{opacity:0}).call(function(){l.default.Fall(),o.bubbleManager.checkGift(e),o.playEffectWithScore(o,t,!0),o.bubbleManager.removeBubble(e,o.node)}).start(),h+1}return.4},i([h],t)}(cc.Component));o.default=b,cc._RF.pop()},{"../../common/EventManager":"EventManager","../GameConst":"GameConst","../Global":"Global","../Sound":"Sound","./BubbleUtil":"BubbleUtil"}],BasePropBubble:[function(e,t,o){"use strict";cc._RF.push(t,"6ef55dWv8BKKK6PAIRAGGvN","BasePropBubble");var n,a=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var a,i=arguments.length,r=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(i<3?a(r):i>3?a(t,o,r):a(t,o))||r);return i>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../GameConst"),s=e("../BubbleUtil"),c=cc._decorator,l=c.ccclass,p=(c.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.speed=r.GameConst.BUBBLE_MOVE_SPEED,t.path=[],t.dur=[],t.dis=[],t.ace=1,t}return a(t,e),t.prototype.onLoad=function(){this.minPosX=-cc.visibleRect.width/2+r.GameConst.BUBBLE_R,this.maxPosX=cc.visibleRect.width/2-r.GameConst.BUBBLE_R},t.prototype.start=function(){},t.prototype.setStreakTexture=function(e){this.node.getChildByName("streak").getComponent(cc.MotionStreak).texture=e},t.prototype.init=function(e,t,o,n){void 0===t&&(t=-1),this.type=e,this.normalSubType=t,this.state=r.GameConst.PROP_BUBBLE_STATE.IDLE,this.vel=null,this.shootPos=o,this.node.scale=1,this.bubbleManager=n},t.prototype.updateSpriteFrame=function(e){var t=this.node.getChildByName("base"),o=this.bubbleManager.getPropBubbleSpriteFrameByType(this.type,e);o>=0&&(this.type==r.GameConst.PROP_BUBBLE_TYPE.NORMAL?t.getComponent(cc.Sprite).spriteFrame=this.bubbleManager.bubbleSpriteFrame[o]:t.getComponent(cc.Sprite).spriteFrame=this.bubbleManager.propBubbleSpriteFrame[o])},t.prototype.setNormalSubType=function(e){this.normalSubType=e,this.updateSpriteFrame(e)},t.prototype.setPos=function(e){this.node.setPosition(e)},t.prototype.getNormalSubType=function(){return this.normalSubType},t.prototype.getAimType=function(){return this.type==r.GameConst.PROP_BUBBLE_TYPE.NORMAL?this.normalSubType:this.type},t.prototype.setType=function(e){this.type=e},t.prototype.getType=function(){return this.type},t.prototype.launch=function(e,t){this.moveEndPos=t;var o=cc.misc.degreesToRadians(e),n=cc.v2(Math.cos(o),Math.sin(o));this.vel=n.mul(this.speed),this.velPer=cc.v2(this.vel.x/r.GameConst.VEL_PER,this.vel.y/r.GameConst.VEL_PER),this.ace=1,this.startMove()},t.prototype.changeXDir=function(){this.vel&&(this.vel.x=-this.vel.x,this.velPer=cc.v2(this.vel.x/r.GameConst.VEL_PER,this.vel.y/r.GameConst.VEL_PER))},t.prototype.changeYDir=function(){this.vel&&(this.vel.y=-this.vel.y,this.velPer=cc.v2(this.vel.x/r.GameConst.VEL_PER,this.vel.y/r.GameConst.VEL_PER))},t.prototype.getWorldPos=function(){return this.bubbleManager.node.convertToWorldSpaceAR(this.node.getPosition())},t.prototype.getBubbleLayerPos=function(){var e=this.node.getBoundingBoxToWorld();return this.bubbleManager.node.convertToNodeSpaceAR(e.center)},t.prototype.getBubbleLayerPosByPos=function(){var e=this.node.getBoundingBoxToWorld();return this.bubbleManager.node.convertToNodeSpaceAR(e.center)},t.prototype.getBubbleLayerPosX=function(){return this.getBubbleLayerPos().x},t.prototype.getBubbleLayerPosY=function(){return this.getBubbleLayerPos().y},t.prototype.update=function(){},t.prototype.reset=function(){this.node.active=!1,this.node.setPosition(this.shootPos)},t.prototype.handleCollided=function(e,t,o,n){void 0===o&&(o=null),void 0===n&&(n=null),this.scheduleOnce(this.bubbleManager.sendShootEndEvent,.5)},t.prototype.move=function(){if(this.isMoving()&&this.vel)for(var e=0;e<r.GameConst.VEL_PER;e++){var t=this.node.x+this.velPer.x,o=this.node.y+this.velPer.y;if(t<this.minPosX){var n=Math.abs(this.node.x-this.minPosX);o=Math.abs(n/this.velPer.x*this.velPer.y)+this.node.y,this.node.x=this.minPosX,this.changeXDir()}else t>this.maxPosX?(n=Math.abs(this.node.x-this.maxPosX),o=Math.abs(n/this.velPer.x*this.velPer.y)+this.node.y,this.node.x=this.maxPosX,this.changeXDir()):this.node.x=t;if(this.node.y=o,console.log("[MMM]","y="+this.getBubbleLayerPos().y),s.default.checkCollided(this.node.x,this.node.y,this.moveEndPos.x,this.moveEndPos.y)){this.node.setPosition(this.moveEndPos),this.bubbleManager.checkCollided();break}if(this.getBubbleLayerPos().y>0){var a=this.getBubbleLayerPos().y-2*r.GameConst.BUBBLE_R;this.node.setPosition(cc.v2(this.node.x,this.node.y-a)),this.bubbleManager.checkCollided();break}}},t.prototype.startMove=function(){this.state=r.GameConst.PROP_BUBBLE_STATE.MOVING},t.prototype.stopMoving=function(){this.state=r.GameConst.PROP_BUBBLE_STATE.IDLE},t.prototype.isMoving=function(){return this.state==r.GameConst.PROP_BUBBLE_STATE.MOVING},t.prototype.release=function(){this.node.destroy()},t.prototype.removeSelf=function(){this.node.removeFromParent(),this.scheduleOnce(this.release,.1)},t.prototype.playMoveAnimation=function(e,t,o){void 0===t&&(t=1),cc.tween(this.node).to(.2,{scale:t,position:cc.v3(e.x,e.y,0)}).call(function(){o()}).start()},t.prototype.plaShowAnimation=function(e){cc.tween(this.node).to(.2,{scale:.7}).call(function(){e()}).start()},i([l],t)}(cc.Component));o.default=p,cc._RF.pop()},{"../../GameConst":"GameConst","../BubbleUtil":"BubbleUtil"}],BubbleData:[function(e,t,o){"use strict";cc._RF.push(t,"99a23O7A29PprpLTCInsisQ","BubbleData"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],BubbleManager:[function(e,t,o){"use strict";cc._RF.push(t,"e970fHQyUBDJ4Boi4q++Ia3","BubbleManager");var n,a=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var a,i=arguments.length,r=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(i<3?a(r):i>3?a(t,o,r):a(t,o))||r);return i>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../common/EventManager"),s=e("../../common/PoolManager"),c=e("../Effect"),l=e("../EffectBigScore"),p=e("../EffectCombo"),u=e("../GameConst"),h=e("../Global"),b=e("../Sound"),d=e("./BaseBubble"),m=e("./BubbleUtil"),f=e("./prop/PropBubbleBoom"),B=e("./prop/PropBubbleLaser"),v=e("./prop/PropBubbleLightning"),E=e("./prop/PropBubbleNormal"),y=e("./prop/PropBubbleRainbow"),_=cc._decorator,g=_.ccclass,C=_.property,P=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bubbleSpriteFrame=[],t.propBubbleSpriteFrame=[],t.propBubblePerfab=null,t.laserPerfab=null,t.lightningPerfab=null,t.propBubbleBombPerfab=null,t.propBubbleLaserPerfab=null,t.propBubbleRainbowPerfab=null,t.propBubbleLightningPerfab=null,t.streakTexture2D=null,t.streakTexture2DTrans=null,t.shooter=null,t.shooterNext=null,t.shooterLayer=null,t.midLine=null,t.opLayer=null,t.opPropLayer=null,t.opCancelNode=null,t.effectLayer=null,t.bubbleTip=null,t.dot1=null,t.dot2=null,t.bubbleLayerMoveFinish=!0,t.bubbleDataArray=[],t.runPathArray=[],t.targetPosPathArray=[],t.totalLineCoilledIndexs=[],t.useSpecialPropBubble=!1,t.choosableBubbleType=[],t.randomBubbleIndex=[],t.cloudBubbleIndex=[],t.startbubble=[],t.ready=!0,t.switchStep=[],t.curPlayDownAnimDelay=0,t}return a(t,e),t.prototype.onLoad=function(){s.default.Preload(u.GameConst.PREFAB_NAME.BUBBLE,50),s.default.Preload(u.GameConst.PREFAB_NAME.EFFECT_ICE_BOOM,5),s.default.Preload(u.GameConst.PREFAB_NAME.EFFECT_BUBBLE_BOMB,10),s.default.Preload(u.GameConst.PREFAB_NAME.EFFECT_RAINBOW_BOOM,10),s.default.Preload(u.GameConst.PREFAB_NAME.EFFECT_CLOUD_BOOM,5),s.default.Preload(u.GameConst.PREFAB_NAME.EFFECT_ICE_IDLE,5),s.default.Preload(u.GameConst.PREFAB_NAME.EFFECT_BUBBLE_DIE,20),s.default.Preload(u.GameConst.PREFAB_NAME.EFFECT_BIG_SCORE,1),s.default.Preload(u.GameConst.PREFAB_NAME.EFFECT_COMBO,1);var e=u.GameConst.MID_SPACE_RATE*cc.visibleRect.height,t=-cc.visibleRect.height/2+(u.GameConst.BOTTOM_H+e);this.midLine.setPosition(cc.v2(0,t)),this.shooterLayer.getChildByName("SwitchBtn").zIndex=1e3,this.initPropBubble()},t.prototype.getNextStartBubble=function(){if(this.startbubble&&this.startbubble.length>0){for(var e=-1,t=0;t<this.startbubble.length;t++)if(this.startbubble[t]){e=this.startbubble[t],this.startbubble[t]=void 0;break}if(e>=0)return e;this.startbubble=void 0}return-1},t.prototype.initPropBubble=function(){this.choosableBubbleType=[],this.choosableBubbleType.push(u.GameConst.BUBBLE_TYPE.CYAN),this.choosableBubbleType.push(u.GameConst.BUBBLE_TYPE.PINK),this.choosableBubbleType.push(u.GameConst.BUBBLE_TYPE.YELLOW),this.choosableBubbleType.push(u.GameConst.BUBBLE_TYPE.BLUE),this.choosableBubbleType.push(u.GameConst.BUBBLE_TYPE.GREEN),this.choosableBubbleType.push(u.GameConst.BUBBLE_TYPE.RED);var e=this.getNextPropBubbleType(),t=this.getNextPropBubbleType();this.startbubble&&this.startbubble.length>0&&(e=this.startbubble[0],this.startbubble[0]=void 0,this.startbubble.length>1&&(t=this.startbubble[1],this.startbubble[1]=void 0)),this.propBubbleNormal1=this.createPropBubbleComponent(u.GameConst.PROP_BUBBLE_TYPE.NORMAL,this.shooterLayer,e),this.propBubbleNormal2=this.createPropBubbleComponent(u.GameConst.PROP_BUBBLE_TYPE.NORMAL,this.shooterLayer,t),this.propBubbleBoom=this.createPropBubbleComponent(u.GameConst.PROP_BUBBLE_TYPE.BOMB,this.shooterLayer),this.propBubbleLaser=this.createPropBubbleComponent(u.GameConst.PROP_BUBBLE_TYPE.LASER,this.shooterLayer),this.propBubbleRainbow=this.createPropBubbleComponent(u.GameConst.PROP_BUBBLE_TYPE.RAINBOW,this.shooterLayer),this.propBubbleLightning=this.createPropBubbleComponent(u.GameConst.PROP_BUBBLE_TYPE.LIGHTNING,this.shooterLayer),this.curPropBubble=this.createPropBubbleComponent(u.GameConst.PROP_BUBBLE_TYPE.NORMAL,this.shooterLayer,e),this.curPropBubble.node.active=!0,this.curPropBubble.node.scale=1,this.curPropBubble.setStreakTexture(this.streakTexture2DTrans),this.propBubbleNormal1.node.active=!1,this.propBubbleNormal1.node.scale=1,this.propBubbleNormal1.setStreakTexture(this.streakTexture2DTrans),this.propBubbleNormal2.node.active=!0,this.propBubbleNormal2.node.scale=.7;var o=this.shooterNext.getPosition();this.propBubbleNormal2.node.setPosition(o),this.propBubbleNormal2.setStreakTexture(this.streakTexture2DTrans),this.propBubbleBoom.setStreakTexture(this.streakTexture2DTrans),this.propBubbleLaser.setStreakTexture(this.streakTexture2DTrans),this.propBubbleRainbow.setStreakTexture(this.streakTexture2DTrans),this.propBubbleLightning.setStreakTexture(this.streakTexture2DTrans)},t.prototype.setStartbubble=function(e){this.startbubble=e,console.log("this.startbubble=",this.startbubble)},t.prototype.getMidLineBubbleLayerPos=function(){var e=this.midLine.getBoundingBoxToWorld();this.midLineBubbleLayerPos=this.node.convertToNodeSpaceAR(e.center);var t=this.node.parent.getPosition().y;return console.log("bubbleLayerHeight getMidLineBubbleLayerPos moveOffsetY:"+t),this.midLineBubbleLayerPos},t.prototype.checkWin=function(){if(!this.waitShoot||!this.bubbleLayerMoveFinish)return console.log("checkWin\u672a\u51c6\u5907\u597d\uff01"),!1;var e=!0;if(this.bubbleDataArray)for(var t=0;t<this.bubbleDataArray.length&&e;t++)if(this.bubbleDataArray[t])for(var o=0;o<this.bubbleDataArray[t].length;o++){var n=this.bubbleDataArray[t][o];if(n&&this.isCanRemoveTypeBubble(n.type)){e=!1;break}}return e?(console.log("[Check]checkWin=\u83b7\u80dc!!"),r.EventManager.getInstance().sendEvent(u.GameConst.EVENT.GAME_WIN)):h.Global.curLevelShootBubbleCount<=0&&(console.log("[Check]checkWin=Lose!!"),r.EventManager.getInstance().sendEvent(u.GameConst.EVENT.GAME_OVER_CHECK)),e},t.prototype.switchPropBubble=function(){var e=this;this.waitShoot&&this.ready?(b.default.SwitchBubble(),this.switchStep[0]=!1,this.switchStep[1]=!1,this.ready=!1,this.curPropBubble.node.active=!1,this.propBubbleNormal1.node.active=!0,this.propBubbleNormal2.node.active=!0,this.propBubbleNormal2.playMoveAnimation(this.shooter.getPosition(),1,function(){e.switchStep[1]=!0,e.switchFinish()}),this.propBubbleNormal1.playMoveAnimation(this.shooterNext.getPosition(),.7,function(){e.switchStep[0]=!0,e.switchFinish()})):console.log("switchPropBubble\u672a\u51c6\u5907\u597d\uff01")},t.prototype.switchFinish=function(){if(this.switchStep[0]&&this.switchStep[1]){var e=this.propBubbleNormal1;this.propBubbleNormal1=this.propBubbleNormal2,this.propBubbleNormal2=e,this.propBubbleNormal1.node.scale=1,this.propBubbleNormal2.node.scale=.7;var t=this.propBubbleNormal1.getNormalSubType();this.curPropBubble.setNormalSubType(t),this.curPropBubble.node.active=!0,this.propBubbleNormal1.node.active=!1,r.EventManager.getInstance().sendEvent(u.GameConst.EVENT.UPDATE_AIM_TYPE,this.curPropBubble.getAimType()),this.ready=!0,this.switchStep[0]=!1,this.switchStep[1]=!1}},t.prototype.switchSpecialPropBubble=function(e){if(this.waitShoot&&this.bubbleLayerMoveFinish&&this.ready){switch(this.curPropBubble.node.active=!1,this.propBubbleNormal1.node.active=!1,this.propBubbleNormal2.node.active=!1,this.curSpecialPropBubble&&this.curSpecialPropBubble.node&&(this.curSpecialPropBubble.node.active=!1),e){case u.GameConst.PROP_BUBBLE_TYPE.BOMB:this.curSpecialPropBubble=this.propBubbleBoom;break;case u.GameConst.PROP_BUBBLE_TYPE.LASER:this.curSpecialPropBubble=this.propBubbleLaser;break;case u.GameConst.PROP_BUBBLE_TYPE.RAINBOW:this.curSpecialPropBubble=this.propBubbleRainbow;var t=h.Global.getGuideData(u.GameConst.GUIDE_TYPE.PROP_RAINBOW);t!=u.GameConst.YES&&r.EventManager.getInstance().sendEvent(u.GameConst.EVENT.SHOW_GUIDE,u.GameConst.GUIDE_TYPE.PROP_RAINBOW);break;case u.GameConst.PROP_BUBBLE_TYPE.LIGHTNING:this.curSpecialPropBubble=this.propBubbleLightning,(t=h.Global.getGuideData(u.GameConst.GUIDE_TYPE.PROP_LIGHTNING))!=u.GameConst.YES&&r.EventManager.getInstance().sendEvent(u.GameConst.EVENT.SHOW_GUIDE,u.GameConst.GUIDE_TYPE.PROP_LIGHTNING)}this.useSpecialPropBubble=!0,this.curSpecialPropBubble.node.active=!0,this.curSpecialPropBubble.setStreakTexture(this.streakTexture2DTrans),this.showSpecialPropBubbleBgEffect(),r.EventManager.getInstance().sendEvent(u.GameConst.EVENT.UPDATE_AIM_TYPE,this.curSpecialPropBubble.getAimType())}else console.log("\u672a\u51c6\u5907\u597d\uff01")},t.prototype.cancelUseSpecialPropBubble=function(e,t){void 0===e&&(e=null),void 0===t&&(t=null),this.useSpecialPropBubble=!1,this.curSpecialPropBubble&&this.curSpecialPropBubble.node&&(this.curSpecialPropBubble.node.active=!1),this.shooter.removeAllChildren(),this.showOpPropLayer(!0),t&&1==Number.parseInt(t)&&this.showNextPropBubble()},t.prototype.showOpPropLayer=function(e){var t=this;e?(this.opCancelNode.active=!1,cc.tween(this.opPropLayer).by(.2,{opacity:255,position:cc.v3(0,200,0)}).call(function(){}).start()):cc.tween(this.opPropLayer).by(.2,{opacity:-255,position:cc.v3(0,-200,0)}).call(function(){t.opCancelNode.active=!0}).start()},t.prototype.showNextPropBubble=function(){var e=this;if(this.ready){this.ready=!1,console.log("[END]","showNextPropBubble"),u.GameConst.PROP_BUBBLE_TYPE.NORMAL;var t,o=this.getNextStartBubble();t=o<0?this.getNextPropBubbleType():o,this.curPropBubble.node.active=!1,this.switchStep[0]=!1,this.switchStep[1]=!1,this.propBubbleNormal2.node.active=!0,this.propBubbleNormal2.setStreakTexture(this.streakTexture2DTrans),this.propBubbleNormal2.playMoveAnimation(this.shooter.getPosition(),1,function(){e.switchStep[1]=!0,e.showNextFinish()}),this.propBubbleNormal1.setNormalSubType(t),this.propBubbleNormal1.setPos(this.shooterNext.getPosition()),this.propBubbleNormal1.node.scale=.1,this.propBubbleNormal1.node.active=!0,this.propBubbleNormal1.setStreakTexture(this.streakTexture2DTrans),this.propBubbleNormal1.plaShowAnimation(function(){e.switchStep[0]=!0,e.showNextFinish()})}else console.log("showNextPropBubble\u672a\u51c6\u5907\u597d\uff01")},t.prototype.showNextFinish=function(){var e=this;if(this.switchStep[0]&&this.switchStep[1]){var t=this.propBubbleNormal1;this.propBubbleNormal1=this.propBubbleNormal2,this.propBubbleNormal2=t,this.propBubbleNormal1.node.scale=1,this.propBubbleNormal2.node.scale=.7;var o=this.propBubbleNormal1.getNormalSubType();this.curPropBubble.setNormalSubType(o),this.curPropBubble.node.active=!0,this.propBubbleNormal1.node.active=!1,this.scheduleOnce(function(){e.ready=!0,e.switchStep[0]=!1,e.switchStep[1]=!1,r.EventManager.getInstance().sendEvent(u.GameConst.EVENT.BUBBLE_SHOOT_END),r.EventManager.getInstance().sendEvent(u.GameConst.EVENT.UPDATE_UI,u.GameConst.UI_TYPE.SEORE)},.5)}},t.prototype.updateRandomBubble=function(){if(console.log("[END]","\u5237\u65b0\u968f\u673a\u6ce1\u6ce1"),this.randomBubbleIndex)for(var e=this.randomBubbleIndex.length,t=0;t<e;t++){var o=this.randomBubbleIndex[t],n=this.bubbleDataArray[o.x][o.y];if(n){var a=n.node.getComponent(d.default);if(a){a.changeInnerType();var i=a.getInnerType();if(i>=0){var r=n.node.getChildByName("inner"),s=this.getBubbleSpriteFrameByType(i);s>=0&&(r.getComponent(cc.Sprite).spriteFrame=this.bubbleSpriteFrame[s])}}}}},t.prototype.isNormalTypeBubble=function(e){var t=!1;switch(e){case u.GameConst.BUBBLE_TYPE.PINK:case u.GameConst.BUBBLE_TYPE.CYAN:case u.GameConst.BUBBLE_TYPE.YELLOW:case u.GameConst.BUBBLE_TYPE.BLUE:case u.GameConst.BUBBLE_TYPE.GREEN:case u.GameConst.BUBBLE_TYPE.RED:t=!0}return t},t.prototype.isCanRemoveTypeBubble=function(e){var t=!1;switch(e){case u.GameConst.BUBBLE_TYPE.PINK:case u.GameConst.BUBBLE_TYPE.CYAN:case u.GameConst.BUBBLE_TYPE.YELLOW:case u.GameConst.BUBBLE_TYPE.BLUE:case u.GameConst.BUBBLE_TYPE.GREEN:case u.GameConst.BUBBLE_TYPE.RED:case u.GameConst.BUBBLE_TYPE.ICE:case u.GameConst.BUBBLE_TYPE.RANDOM:t=!0}return t},t.prototype.setWaitShoot=function(){var e=this;console.log("[lau]","setWaitShoot=true"),this.waitShoot=!0;for(var t=new Map,o=this.bubbleDataArray.length-1;o>=0;o--)if(this.bubbleDataArray[o])for(var n=0;n<this.bubbleDataArray[o].length;n++){var a=this.bubbleDataArray[o][n];if(a){var i=a.type;this.isNormalTypeBubble(i)&&t.set(""+i,i)}}this.choosableBubbleType=[],t.forEach(function(t){var o=t;e.choosableBubbleType.push(o)});var s=this.propBubbleNormal1.getNormalSubType(),c=this.propBubbleNormal2.getNormalSubType();if(!t.has(s+"")){var l=this.choosableBubbleType.length,p=u.GameConst.BUBBLE_TYPE.PINK;p=l>0?this.choosableBubbleType[m.default.randNum(0,l-1)]:m.default.randNum(u.GameConst.BUBBLE_TYPE.PINK,u.GameConst.BUBBLE_TYPE.RED),this.propBubbleNormal1.setNormalSubType(p),this.curPropBubble.setNormalSubType(this.propBubbleNormal1.getNormalSubType())}t.has(c+"")||(l=this.choosableBubbleType.length,p=u.GameConst.BUBBLE_TYPE.PINK,p=l>0?this.choosableBubbleType[m.default.randNum(0,l-1)]:m.default.randNum(u.GameConst.BUBBLE_TYPE.PINK,u.GameConst.BUBBLE_TYPE.RED),this.propBubbleNormal2.setNormalSubType(p)),this.shooterLayer.active=!0,this.opLayer.active=!0,this.checkWin(),r.EventManager.getInstance().sendEvent(u.GameConst.EVENT.UPDATE_AIM_TYPE,this.curPropBubble.getAimType())},t.prototype.setSpecialPropBubble=function(e,t){if(this.waitShoot&&this.bubbleLayerMoveFinish&&this.ready){var o=Number.parseInt(t),n=!1,a=0;switch(o){case u.GameConst.PROP_BUBBLE_TYPE.BOMB:a=h.Global.getPropData(u.GameConst.PROP_BUBBLE_TYPE.BOMB);break;case u.GameConst.PROP_BUBBLE_TYPE.LASER:a=h.Global.getPropData(u.GameConst.PROP_BUBBLE_TYPE.LASER);break;case u.GameConst.PROP_BUBBLE_TYPE.RAINBOW:a=h.Global.getPropData(u.GameConst.PROP_BUBBLE_TYPE.RAINBOW);break;case u.GameConst.PROP_BUBBLE_TYPE.LIGHTNING:a=h.Global.getPropData(u.GameConst.PROP_BUBBLE_TYPE.LIGHTNING)}a>0?n=!0:h.Global.getCoin()>=u.GameConst.PROP_PRICE?n=!0:(console.log("[AD]","\u770b\u5e7f\u544a\u83b7\u53d6\u9053\u5177~~~~~~~~~~~~~"),h.Global.addPropData(o,1)),n&&(this.showOpPropLayer(!1),this.switchSpecialPropBubble(o))}else console.log("\u672a\u51c6\u5907\u597d\uff01")},t.prototype.isLaserBubble=function(){return!(!this.useSpecialPropBubble||!this.curSpecialPropBubble||this.curSpecialPropBubble.getType()!=u.GameConst.PROP_BUBBLE_TYPE.LASER)},t.prototype.updateTargetRing=function(e,t,o){void 0===t&&(t=null),void 0===o&&(o=null);var n=[];switch(this.curSpecialPropBubble.getType()){case u.GameConst.PROP_BUBBLE_TYPE.BOMB:n=this.queryAround2NonEmptyBubbles(e),this.setShowRingBubble(n);break;case u.GameConst.PROP_BUBBLE_TYPE.LASER:o&&this.setShowRingBubble(o);break;case u.GameConst.PROP_BUBBLE_TYPE.RAINBOW:var a=this.queryAround1NonEmptyBubbles(e);if(a){var i=a.length;if(i>0)for(var r=0;r<i;r++){var s=a[r],c=this.getBubbleDataByIndex(s.x,s.y);if(c){var l=this.queryLinkedSameBubbles(c);if(l)for(var p=l.length,h=0;h<p;h++){var b=l[h];if(b)for(var d=b.length,m=0;m<d;m++){var f=b[m];this.bubbleDataArray[f.x][f.y].isVisited=!1,n.push(f)}}}}}this.setShowRingBubble(n);break;case u.GameConst.PROP_BUBBLE_TYPE.LIGHTNING:t&&(n=this.queryRowNonEmptyBubbles(t.x),this.setShowRingBubble(n))}},t.prototype.updateSpecialPropBubbleUI=function(){switch(this.curSpecialPropBubble.getType()){case u.GameConst.PROP_BUBBLE_TYPE.BOMB:case u.GameConst.PROP_BUBBLE_TYPE.LASER:case u.GameConst.PROP_BUBBLE_TYPE.RAINBOW:case u.GameConst.PROP_BUBBLE_TYPE.LIGHTNING:}},t.prototype.updateAimColliedBubbleData=function(e){if(e)switch(this.curSpecialPropBubble.getType()){case u.GameConst.PROP_BUBBLE_TYPE.BOMB:case u.GameConst.PROP_BUBBLE_TYPE.LASER:case u.GameConst.PROP_BUBBLE_TYPE.RAINBOW:case u.GameConst.PROP_BUBBLE_TYPE.LIGHTNING:}},t.prototype.setShowRingBubble=function(e){for(var t=this.bubbleDataArray.length-1;t>=0;t--)if(this.bubbleDataArray[t])for(var o=0;o<this.bubbleDataArray[t].length;o++)(a=this.bubbleDataArray[t][o])&&a.node&&a.node.getComponent(d.default).showRing(!1);if(e)for(var n=0;n<e.length;n++){var a,i=e[n];i&&(a=this.getBubbleDataByIndex(i.x,i.y))&&a.node&&a.node.getComponent(d.default).showRing(!0)}},t.prototype.getAimType=function(){return this.useSpecialPropBubble&&this.curSpecialPropBubble?this.curSpecialPropBubble.getAimType():this.curPropBubble?this.curPropBubble.getAimType():-1},t.prototype.getNextPropBubbleType=function(){u.GameConst.PROP_BUBBLE_TYPE.NORMAL,u.GameConst.BUBBLE_TYPE.YELLOW;var e=this.choosableBubbleType.length;return u.GameConst.BUBBLE_TYPE.PINK,e>0?this.choosableBubbleType[m.default.randNum(0,e-1)]:m.default.randNum(u.GameConst.BUBBLE_TYPE.PINK,u.GameConst.BUBBLE_TYPE.RED)},t.prototype.start=function(){},t.prototype.createBubbleData=function(e,t,o,n,a,i,r){return void 0===e&&(e=null),void 0===t&&(t=-1),void 0===a&&(a=!1),void 0===i&&(i=!1),void 0===r&&(r=0),{node:e,type:t,row:o,col:n,gift:r,isVisited:a,isLinked:i}},t.prototype.propBubbleMoving=function(e){this.useSpecialPropBubble?this.curSpecialPropBubble&&this.curSpecialPropBubble.isMoving()&&this.curSpecialPropBubble.move(e):this.curPropBubble&&this.curPropBubble.isMoving()&&this.curPropBubble.move(e)},t.prototype.checkCollided=function(){if(this.useSpecialPropBubble){var e=this.curSpecialPropBubble.getBubbleLayerPos(),t=m.default.convertPosToRowCol(e.x,e.y);this.handleCollided(t),this.cancelUseSpecialPropBubble()}else e=this.curPropBubble.getBubbleLayerPos(),t=m.default.convertPosToRowCol(e.x,e.y),this.handleCollided(t)},t.prototype.sendShootEndEvent=function(){console.log("[END]","sendShootEndEvent"),this.showNextPropBubble(),this.updateRandomBubble()},t.prototype.handleColliedFinish=function(e,t,o){var n=this;void 0===o&&(o=!1),console.log("[END]","handleColliedFinish sendShootEndEvent"),e<0&&(e=0),t<0&&(t=0),e<this.curPlayDownAnimDelay&&(e=this.curPlayDownAnimDelay),console.log("[END]","this.curPlayDownAnimDelay ="+this.curPlayDownAnimDelay+",updateDelay="+e),this.updateBubbleLayerPosDelay(e),this.scheduleOnce(function(){n.sendShootEndEvent(),o?h.Global.comboScore+=u.GameConst.COMBO_SCORE_STEP:h.Global.comboScore=u.GameConst.COMBO_SCORE_DEF,console.log("[END][Score]","Global.comboScore ="+h.Global.comboScore)},t)},t.prototype.updateBubbleLayerPosDelay=function(e){e>0?this.scheduleOnce(this.updateBubbleLayerPos,e):this.updateBubbleLayerPos()},t.prototype.updateBubbleLayerPos=function(){var e=this.getBubbleLayerHeight();r.EventManager.getInstance().sendEvent(u.GameConst.EVENT.UPDATE_BUBBLE_LAYER_POS,e)},t.prototype.getBubbleLayerHeight=function(){for(var e=0,t=this.bubbleDataArray.length-1;t>=0;t--)if(this.bubbleDataArray[t])for(var o=this.bubbleDataArray[t].length;o>=0;o--)if(this.bubbleDataArray[t][o])return e=t,m.default.getBubbleLayerHeight(e+1);return 0},t.prototype.handleCollided=function(e){var t;if(this.useSpecialPropBubble){if(e){var o=e.x,n=e.y,a=this.curSpecialPropBubble.getNormalSubType();t=this.createBubbleData(null,a,o,n)}else{var i=this.curSpecialPropBubble.getBubbleLayerPos();e=m.default.convertPosToRowCol(i.x,i.y)}this.curSpecialPropBubble.handleCollided(t,e,this.collidedTargetIndex)}else e?(o=e.x,n=e.y,a=this.curPropBubble.getNormalSubType(),t=this.createBubbleData(null,a,o,n)):(i=this.curPropBubble.getBubbleLayerPos(),e=m.default.convertPosToRowCol(i.x,i.y)),this.curPropBubble.setStreakTexture(this.streakTexture2DTrans),this.curPropBubble.handleCollided(t,e)},t.prototype.bubbleMoveFinish=function(){},t.prototype.insertBubble=function(e,t,o,n,a){void 0===n&&(n=null),void 0===a&&(a=!0);var i=this.createBubbleComponent(o,this.node),r=m.default.convertRowColToPos(e,t);return console.log("[insertBubble]","type="+o+",row="+e+",col="+t+",pos=["+r.x+","+r.y+"]"),i.node.setPosition(r),n||(n=this.createBubbleData(i.node,o,e,t)),n.node=i.node,n.type=o,i.showRing(!1),this.bubbleDataArray[e]||(this.bubbleDataArray[e]=[]),this.bubbleDataArray[e][t]=n,a&&this.bubbleCollidedAnimation(n),b.default.BallImpact(),n},t.prototype.getCurPropBubble=function(){return this.curPropBubble},t.prototype.getBubbleDataByIndex=function(e,t){return this.isValidIndex(e,t)&&this.bubbleDataArray[e]?this.bubbleDataArray[e][t]:null},t.prototype.getOrCreateBubbleDataByIndex=function(e,t){return this.isValidIndex(e,t)?this.bubbleDataArray[e]&&this.bubbleDataArray[e][t]?this.bubbleDataArray[e][t]:(this.bubbleDataArray[e]||(this.bubbleDataArray[e]=[]),this.bubbleDataArray[e][t]||(this.bubbleDataArray[e][t]=this.createBubbleData(null,0,e,t)),this.bubbleDataArray[e][t]):null},t.prototype.isValidIndex=function(e,t){if(e<0)return!1;if(e%2==0){if(t<0||t>=u.GameConst.COL_ODD)return!1}else if(t<0||t>=u.GameConst.COL_EVEN)return!1;return!0},t.prototype.bubbleCollidedAnimation=function(e){for(var t=this.getAroundByFilter(e,this.filterNonEmptyBubble),o=0;o<t.length;o++){var n=t[o],a=this.getBubbleDataByIndex(n.x,n.y);if(0==a.node.getNumberOfRunningActions()){var i=a.node.getPosition(),r=cc.v2(e.node.position),s=i.sub(r).normalize().mul(2/(o+1)*6),c=i.add(s),l=cc.moveTo(.15,c),p=cc.moveTo(.2,i).easing(cc.easeSineInOut());a.node.runAction(cc.sequence(l,p))}}},t.prototype.queryAroundIceBubbles=function(e){return this.getAroundByFilterForType(e,u.GameConst.BUBBLE_TYPE.ICE,this.filterBubbleByType)},t.prototype.queryAroundOneBlackHoleBubbles=function(e){var t=this.getAroundByFilterForType(e,u.GameConst.BUBBLE_TYPE.BLACK_HOLE,this.filterBubbleByType);if(t&&t.length>0){for(var o=0;o<t.length;o++){var n=t[o];n&&(this.bubbleDataArray[n.x][n.y].isVisited=!1)}return t[0]}return null},t.prototype.resetTagBubbleDataArray=function(){if(this.bubbleDataArray)for(var e=0;e<this.bubbleDataArray.length;e++)if(this.bubbleDataArray[e])for(var t=0;t<this.bubbleDataArray[e].length;t++)this.bubbleDataArray[e][t]&&(this.bubbleDataArray[e][t].isVisited=!1,this.bubbleDataArray[e][t].isLinked=!1)},t.prototype.queryNonLinkedBubbles=function(){var e=!0;console.log("[queryNonLinkedBubbles]","======queryNonLinkedBubbles==========");for(var t=0;t<this.bubbleDataArray[0].length;t++)if(c=this.bubbleDataArray[0][t]){c.isLinked=!0,c.isVisited=!0;var o=[];this.recursionQueryLinkedBubbles(c,o)}for(var n=[],a=0;a<this.bubbleDataArray.length;a++)if(this.bubbleDataArray[a])for(var i=0;i<this.bubbleDataArray[a].length;i++)if(this.bubbleDataArray[a][i]&&!this.bubbleDataArray[a][i].isLinked){var r=this.bubbleDataArray[a][i].type;this.bubbleDataArray[a][i].isVisited=!1,r==u.GameConst.BUBBLE_TYPE.CLOUD&&n.push(cc.v2(a,i))}var s=n.length;if(s>0)for(t=0;t<s;t++){var c,l=n[t];l&&(c=this.bubbleDataArray[l.x][l.y])&&(c.isLinked=!0,c.isVisited=!0,o=[],console.log("[queryNonLinkedBubbles]\u4e91","cloud bubbleData:"+c.row+","+c.col),this.recursionQueryLinkedBubbles(c,o),o.length<=0&&(c.isLinked=!1,c.isVisited=!0))}for(this.curPlayDownAnimDelay=0,a=0;a<this.bubbleDataArray.length;a++)if(this.bubbleDataArray[a])for(i=0;i<this.bubbleDataArray[a].length;i++)if(this.bubbleDataArray[a][i])if(this.bubbleDataArray[a][i].isLinked)this.bubbleDataArray[a][i].isVisited=!1,this.bubbleDataArray[a][i].isLinked=!1;else{console.log("[queryNonLinkedBubbles]","\u672a\u94fe\u63a5\uff1a"+a+","+i),e=!1;var p=this.bubbleDataArray[a][i].node,b=h.Global.comboScore;if(this.checkGift(cc.v2(a,i)),this.bubbleDataArray[a][i].type==u.GameConst.BUBBLE_TYPE.CLOUD)p.getComponent(d.default).playDeathAnimation(cc.v2(a,i),0,b);else{var m=p.getComponent(d.default).playDownAnimation(cc.v2(a,i),b);this.curPlayDownAnimDelay<m&&(this.curPlayDownAnimDelay=m)}this.bubbleDataArray[a][i]=void 0}return console.log("======queryNonLinkedBubbles=========="),e},t.prototype.queryLinkedSameBubbles=function(e){if(e){var t=[];return t[0]=[],t[0][0]=cc.v2(e.row,e.col),this.recursionQueryAroundSameBubbles(t,0,e),t}return null},t.prototype.recursionQueryLinkedBubbles=function(e,t){if(e){var o=this.getAroundByFilter(e,this.filterLinkedBubble);if(o)for(var n=o.length,a=0;a<n;a++){var i=o[a];t.push(i);var r=this.bubbleDataArray[i.x][i.y];this.recursionQueryLinkedBubbles(r,t)}}},t.prototype.queryAround1NonEmptyBubbles=function(e){return e?this.getAroundByFilterByIndex2(e,this.filterNonEmptyBubble):null},t.prototype.queryRowNonEmptyBubbles=function(e){if(e>=0){var t=[];if(this.bubbleDataArray[e])for(var o=this.bubbleDataArray[e].length,n=0;n<o;n++){var a=this.bubbleDataArray[e][n];a&&t.push(cc.v2(a.row,a.col))}return t}return null},t.prototype.queryAround2NonEmptyBubbles=function(e){return e?this.getAroundByFilterByIndex(e,this.filterNonEmptyBubble):null},t.prototype.recursionQueryAroundNonEmptyBubbles=function(e,t,o){if(!(t<=0)&&o){var n=this.getAroundByFilterByIndex(o,this.filterNonEmptyBubble);if(n)for(var a=n.length,i=0;i<a;i++){var r=n[i];e.push(r),this.recursionQueryAroundNonEmptyBubbles(e,t-1,r)}}},t.prototype.recursionQueryAroundSameBubbles=function(e,t,o){if(o){e[t]||(e[t]=[]);var n=this.getAroundByFilter(o,this.filterSameBubble);if(n)for(var a=n.length,i=0;i<a;i++){var r=n[i];e[t].push(r);var s=this.bubbleDataArray[r.x][r.y];this.recursionQueryAroundSameBubbles(e,t+1,s)}}},t.prototype.filterLinkedBubble=function(e,t,o,n){if(!e.isValidIndex(o,n))return null;if(!e.bubbleDataArray[o]||!e.bubbleDataArray[o][n])return null;var a=e.bubbleDataArray[o][n];return a.isVisited?null:(a.isVisited=!0,a.isLinked=!0,cc.v2(o,n))},t.prototype.filterBubbleByType=function(e,t,o,n){if(!e.isValidIndex(o,n))return null;if(!e.bubbleDataArray[o]||!e.bubbleDataArray[o][n])return null;var a=e.bubbleDataArray[o][n];return a.isVisited?null:a.type!==t?null:(a.isVisited=!0,cc.v2(o,n))},t.prototype.filterSameBubble=function(e,t,o,n){if(!e.isValidIndex(o,n))return null;if(!e.bubbleDataArray[o]||!e.bubbleDataArray[o][n])return null;var a=e.bubbleDataArray[o][n];if(a.isVisited)return null;if(a.type==u.GameConst.BUBBLE_TYPE.RANDOM){var i=a.node.getComponent(d.default);if(i)if(console.log("[Random]","\u968f\u673a\u6ce1\u6ce1\u68c0\u6d4bfilterSameBubble~~~"),t.type!=u.GameConst.BUBBLE_TYPE.RANDOM){if(i.getInnerType()!==t.type)return null}else{var r=t.node.getComponent(d.default);if(i.getInnerType()!==r.getInnerType())return null}}else if(t.type==u.GameConst.BUBBLE_TYPE.RANDOM){if((r=t.node.getComponent(d.default)).getInnerType()!==a.type)return null}else if(a.type!==t.type)return null;return a.isVisited=!0,cc.v2(o,n)},t.prototype.filterEmptyBubble=function(e,t,o,n){return!e.isValidIndex(o,n)||o<t.row?null:e.getBubbleDataByIndex(o,n)?null:cc.v2(o,n)},t.prototype.filterNonEmptyBubble=function(e,t,o,n){return e.isValidIndex(o,n)&&e.getBubbleDataByIndex(o,n)?cc.v2(o,n):null},t.prototype.getAroundByFilterByIndex=function(e,t){if(!e)return null;var o=[],n=e.x,a=e.y,i=a;n%2==0&&(i=a-1);var r=n-1,s=i+1,c=n,l=a-1,p=n,u=a+1,h=n+1,b=i,d=n+1,m=i+1,f=n-2,B=a-1,v=n-2,E=a,y=n-2,_=a+1,g=n-1,C=i-1,P=n-1,T=i+2,G=n,S=a-2,L=n,O=a+2,N=n+1,A=i-1,R=n+1,I=i+2,M=n+2,D=a-1,F=n+2,w=a,U=n+2,x=a+1,k=t(this,null,n-1,i),Y=t(this,null,r,s),j=t(this,null,c,l),V=t(this,null,p,u),H=t(this,null,h,b),W=t(this,null,d,m),K=t(this,null,f,B),q=t(this,null,v,E),X=t(this,null,y,_),J=t(this,null,g,C),z=t(this,null,P,T),Q=t(this,null,G,S),Z=t(this,null,L,O),$=t(this,null,N,A),ee=t(this,null,R,I),te=t(this,null,M,D),oe=t(this,null,F,w),ne=t(this,null,U,x);return W&&o.push(W),H&&o.push(H),V&&o.push(V),j&&o.push(j),Y&&o.push(Y),k&&o.push(k),K&&o.push(K),q&&o.push(q),X&&o.push(X),J&&o.push(J),z&&o.push(z),Q&&o.push(Q),Z&&o.push(Z),$&&o.push($),ee&&o.push(ee),te&&o.push(te),oe&&o.push(oe),ne&&o.push(ne),o},t.prototype.getAroundByFilterByIndex2=function(e,t){if(!e)return null;var o=[],n=e.x,a=e.y,i=a;n%2==0&&(i=a-1);var r=n-1,s=i+1,c=n,l=a-1,p=n,u=a+1,h=n+1,b=i,d=n+1,m=i+1,f=t(this,null,n-1,i),B=t(this,null,r,s),v=t(this,null,c,l),E=t(this,null,p,u),y=t(this,null,h,b),_=t(this,null,d,m);return _&&o.push(_),y&&o.push(y),E&&o.push(E),v&&o.push(v),B&&o.push(B),f&&o.push(f),o},t.prototype.getAroundByFilterForType=function(e,t,o){if(!e)return null;var n=[],a=e.row,i=e.col,r=i;a%2==0&&(r=i-1);var s=a-1,c=r+1,l=a,p=i-1,u=a,h=i+1,b=a+1,d=r,m=a+1,f=r+1,B=o(this,t,a-1,r),v=o(this,t,s,c),E=o(this,t,l,p),y=o(this,t,u,h),_=o(this,t,b,d),g=o(this,t,m,f);return g&&n.push(g),_&&n.push(_),y&&n.push(y),E&&n.push(E),v&&n.push(v),B&&n.push(B),n},t.prototype.getAroundByFilter=function(e,t){if(!e)return null;var o=[],n=e.row,a=e.col,i=a;n%2==0&&(i=a-1);var r=n-1,s=i+1,c=n,l=a-1,p=n,u=a+1,h=n+1,b=i,d=n+1,m=i+1,f=t(this,e,n-1,i),B=t(this,e,r,s),v=t(this,e,c,l),E=t(this,e,p,u),y=t(this,e,h,b),_=t(this,e,d,m);return _&&o.push(_),y&&o.push(y),E&&o.push(E),v&&o.push(v),B&&o.push(B),f&&o.push(f),o},t.prototype.getFitPosition=function(e,t){for(var o=999999,n=this.getAroundByFilter(e,this.filterEmptyBubble),a=n[0],i=0;i<n.length;i++){var r=n[i];if(r){var s=m.default.convertRowColToPos(r.x,r.y),c=m.default.getPosDistSq(s.x,s.y,t.x,t.y);c<o&&(a=r,o=c)}}return a},t.prototype.getFitPosition3=function(e,t){for(var o=9999999,n=this.getAroundByFilter(e,this.filterEmptyBubble),a=n[0],i=0;i<n.length;i++){var r=n[i];if(r){var s=m.default.convertRowColToPos(r.x,r.y),c=m.default.getPosDistSq(s.x,s.y,t.x,t.y);c<o&&(a=r,o=c)}}return a},t.prototype.getFitPosition2=function(e,t,o){for(var n=999999,a=this.getAroundByFilter(e,this.filterEmptyBubble),i=a[0],r=0;r<a.length;r++){var s=a[r];if(s){var c=m.default.convertRowColToPos(s.x,s.y),l=this.getPointLineDistance(c,t,o);l<n&&(i=s,n=l)}}return i},t.prototype.updateBubbleTipPos=function(e){if(this.bubbleTip)if(e){var t=this.node.convertToWorldSpaceAR(e),o=this.shooterLayer.convertToNodeSpaceAR(t);this.bubbleTip.active=!0,this.bubbleTip.setPosition(o)}else this.bubbleTip.active=!1},t.prototype.updateDot=function(e){if(h.Global.debug)if(e){var t=this.node.convertToWorldSpaceAR(e[0]),o=this.shooterLayer.convertToNodeSpaceAR(t);this.dot1.active=!0,this.dot1.setPosition(o);var n=this.node.convertToWorldSpaceAR(e[1]),a=this.shooterLayer.convertToNodeSpaceAR(n);this.dot2.active=!0,this.dot2.setPosition(a)}else this.dot1.active=!1,this.dot2.active=!1},t.prototype.addToPath=function(e,t){void 0===t&&(t=!1);var o,n=this.node.convertToWorldSpaceAR(e),a=this.shooterLayer.convertToNodeSpaceAR(n);this.runPathArray||(this.runPathArray=[]);var i=this.targetPosPathArray.length;if(i>0)o=this.targetPosPathArray[i-1];else{var r=this.shooterLayer.convertToWorldSpaceAR(this.shooter.getPosition());o=this.node.convertToNodeSpaceAR(r)}this.targetPosPathArray.push(e);for(var s=[],c=[],l=[],p=this.bubbleDataArray.length-1;p>=0;p--)if(this.bubbleDataArray[p])for(var h=0;h<this.bubbleDataArray[p].length;h++)if(A=this.bubbleDataArray[p][h]){var b=A.node;if(b){var d=b.getPosition();this.node.convertToWorldSpaceAR(d).y<cc.winSize.height+2*u.GameConst.BUBBLE_R&&(C=this.getPointLineDistance(d,o,e))<2*u.GameConst.BUBBLE_R*u.GameConst.COLLIDED_RATE&&(l.push(cc.v2(p,h)),s.push(d),c.push(C))}}var f,B,v=l.length,E=v>0||t,y=null,_=999999;if(v>0)for(var g=0;g<v;g++){var C,P=l[g],T=s[g],G=(C=c[g])+m.default.getPosDistByPos(o,T);G<_&&(_=G,y=P)}else B=m.default.convertPosToRowCol(e.x,e.y),f=m.default.convertRowColToPos(B.x,B.y);if(y){this.collidedTargetIndex=y;var S,L,O=m.default.convertRowColToPos(y.x,y.y),N=m.default.getCrossPoints(o,e,O,2*u.GameConst.BUBBLE_R);S=N[0].y>N[1].y?N[1]:N[0],L=o.x>e.x?1:-1,[].push(y);var A=this.getBubbleDataByIndex(y.x,y.y),R=this.getFitPosition3(A,S,L);f=m.default.convertRowColToPos(R.x,R.y),this.useSpecialPropBubble&&this.updateTargetRing(R,y,l)}else this.useSpecialPropBubble&&(this.collidedTargetIndex=B,this.updateTargetRing(B,B,l));if(this.isLaserBubble()&&(this.totalLineCoilledIndexs=l),E){var I=this.node.convertToWorldSpaceAR(f),M=this.shooterLayer.convertToNodeSpaceAR(I);this.runPathArray.push(M)}else this.runPathArray.push(a);return E},t.prototype.getPointLineDistance=function(e,t,o){return cc.Intersection.pointLineDistance(e,t,o,!0)},t.prototype.getMoveEndPos=function(){var e;return this.runPathArray&&this.runPathArray.length>0&&(e=this.runPathArray[this.runPathArray.length-1]),e},t.prototype.calAllTouchPos=function(e){this.runPathArray=[],this.targetPosPathArray=[],this.collidedTargetIndex=null,this.totalLineCoilledIndexs=null,this.updateBubbleTipPos(null);var t,o,n=cc.misc.degreesToRadians(e),a=cc.misc.degreesToRadians(180-e),i=this.shooterLayer.convertToWorldSpaceAR(this.shooter.getPosition()),r=this.node.convertToNodeSpaceAR(i),s=cc.winSize.width/2-u.GameConst.BUBBLE_R,c=Math.abs(r.y+u.GameConst.BUBBLE_R),l=!1;e<90?(o=s,t=Math.tan(n)*s,r.y+t>-u.GameConst.BUBBLE_R&&(t=Math.abs(r.y)-u.GameConst.BUBBLE_R,o=c/Math.tan(n))):e>90?(o=-s,t=Math.tan(a)*s,r.y+t>-u.GameConst.BUBBLE_R&&(t=Math.abs(r.y)-u.GameConst.BUBBLE_R,o=-c/Math.tan(a))):(o=0,t=Math.abs(r.y)-u.GameConst.BUBBLE_R);var p=o+r.x,h=t+r.y,b=Math.abs(t),d=h>=-u.GameConst.BUBBLE_R;if(!(l=this.addToPath(cc.v2(p,h),d))&&!this.isLaserBubble()){var m=h;if(m<-u.GameConst.BUBBLE_R)for(var f=1;m<-u.GameConst.BUBBLE_R&&!l;)if(f*=-1,m+2*b<-u.GameConst.BUBBLE_R){var B=(o*=-1)+r.x;m+=2*b,l=this.addToPath(cc.v2(B,m))}else{var v=Math.abs(u.GameConst.BUBBLE_R+m);B=0,B=f<0?e<90?cc.winSize.width-v/Math.tan(n):v/Math.tan(a):e>90?cc.winSize.width-v/Math.tan(a):v/Math.tan(n),m=-u.GameConst.BUBBLE_R,l=this.addToPath(cc.v2(B,m),!0)}}},t.prototype.launch=function(e){var t=this;if(this.curPropBubble&&this.waitShoot&&this.ready&&this.bubbleLayerMoveFinish){console.log("[lau]","\u53d1\u5c04=!!!!"),this.bubbleLayerMoveFinish=!1,this.waitShoot=!1,this.calAllTouchPos(e);var o=this.getMoveEndPos();if(this.useSpecialPropBubble){var n=0;switch(this.curSpecialPropBubble.getType()){case u.GameConst.PROP_BUBBLE_TYPE.BOMB:(n=h.Global.getPropData(u.GameConst.PROP_BUBBLE_TYPE.BOMB))>0?(n--,h.Global.savePropData(u.GameConst.PROP_BUBBLE_TYPE.BOMB,n)):(a=h.Global.getCoin())>=u.GameConst.PROP_PRICE&&(a-=u.GameConst.PROP_PRICE,h.Global.saveCoin(a));break;case u.GameConst.PROP_BUBBLE_TYPE.LASER:(n=h.Global.getPropData(u.GameConst.PROP_BUBBLE_TYPE.LASER))>0?(n--,h.Global.savePropData(u.GameConst.PROP_BUBBLE_TYPE.LASER,n)):(a=h.Global.getCoin())>=u.GameConst.PROP_PRICE&&(a-=u.GameConst.PROP_PRICE,h.Global.saveCoin(a));break;case u.GameConst.PROP_BUBBLE_TYPE.RAINBOW:(n=h.Global.getPropData(u.GameConst.PROP_BUBBLE_TYPE.RAINBOW))>0?(n--,h.Global.savePropData(u.GameConst.PROP_BUBBLE_TYPE.RAINBOW,n)):(a=h.Global.getCoin())>=u.GameConst.PROP_PRICE&&(a-=u.GameConst.PROP_PRICE,h.Global.saveCoin(a));break;case u.GameConst.PROP_BUBBLE_TYPE.LIGHTNING:var a;(n=h.Global.getPropData(u.GameConst.PROP_BUBBLE_TYPE.LIGHTNING))>0?(n--,h.Global.savePropData(u.GameConst.PROP_BUBBLE_TYPE.LIGHTNING,n)):(a=h.Global.getCoin())>=u.GameConst.PROP_PRICE&&(a-=u.GameConst.PROP_PRICE,h.Global.saveCoin(a))}r.EventManager.getInstance().sendEvent(u.GameConst.EVENT.UPDATE_UI,u.GameConst.UI_TYPE.PROP),r.EventManager.getInstance().sendEvent(u.GameConst.EVENT.UPDATE_UI,u.GameConst.UI_TYPE.COIN),this.isLaserBubble()?(b.default.ShootLaser(),this.curSpecialPropBubble.handleCollided(null,null,null,this.totalLineCoilledIndexs),this.curSpecialPropBubble.node.active=!0,this.curPropBubble.node.active=!1,this.showLaser(e),this.scheduleOnce(function(){t.cancelUseSpecialPropBubble()},.5)):(this.curSpecialPropBubble.launch(e,o),this.curSpecialPropBubble.setStreakTexture(this.streakTexture2D),this.curSpecialPropBubble.node.active=!0,this.curPropBubble.node.active=!1)}else b.default.Shoot(),this.curPropBubble.launch(e,o),this.curPropBubble.setStreakTexture(this.streakTexture2D),this.curPropBubble.node.active=!0,this.curSpecialPropBubble&&(this.curSpecialPropBubble.node.active=!1)}},t.prototype.getBubbleSpriteFrameByType=function(e){var t=12;switch(e){case u.GameConst.BUBBLE_TYPE.PINK:t=0;break;case u.GameConst.BUBBLE_TYPE.CYAN:t=1;break;case u.GameConst.BUBBLE_TYPE.YELLOW:t=2;break;case u.GameConst.BUBBLE_TYPE.BLUE:t=3;break;case u.GameConst.BUBBLE_TYPE.GREEN:t=4;break;case u.GameConst.BUBBLE_TYPE.RED:t=5;break;case u.GameConst.BUBBLE_TYPE.IRON:t=6;break;case u.GameConst.BUBBLE_TYPE.BLACK_HOLE:t=7;break;case u.GameConst.BUBBLE_TYPE.ICE:t=8;break;case u.GameConst.BUBBLE_TYPE.CLOUD:t=9;break;case u.GameConst.BUBBLE_TYPE.LOCK:t=10;break;case u.GameConst.BUBBLE_TYPE.RANDOM:t=11}return t},t.prototype.getPropBubbleSpriteFrameByType=function(e,t){var o=-1;switch(e){case u.GameConst.PROP_BUBBLE_TYPE.NORMAL:switch(t){case u.GameConst.BUBBLE_TYPE.PINK:o=0;break;case u.GameConst.BUBBLE_TYPE.CYAN:o=1;break;case u.GameConst.BUBBLE_TYPE.YELLOW:o=2;break;case u.GameConst.BUBBLE_TYPE.BLUE:o=3;break;case u.GameConst.BUBBLE_TYPE.GREEN:o=4;break;case u.GameConst.BUBBLE_TYPE.RED:o=5}break;case u.GameConst.PROP_BUBBLE_TYPE.BOMB:o=0;break;case u.GameConst.PROP_BUBBLE_TYPE.LASER:o=3;break;case u.GameConst.PROP_BUBBLE_TYPE.RAINBOW:o=1;break;case u.GameConst.PROP_BUBBLE_TYPE.LIGHTNING:o=2}return o},t.prototype.createBubbleComponent=function(e,t){var o=s.default.Spawn(u.GameConst.PREFAB_NAME.BUBBLE,t);o.addComponent(d.default);var n=o.getComponent(d.default);n.init(e,-1,this);var a=o.getChildByName("base"),i=this.getBubbleSpriteFrameByType(e);i>=0&&(a.getComponent(cc.Sprite).spriteFrame=this.bubbleSpriteFrame[i]);var r=n.getInnerType();if(r>=0){var c=o.getChildByName("inner"),l=this.getBubbleSpriteFrameByType(r);l>=0&&(c.getComponent(cc.Sprite).spriteFrame=this.bubbleSpriteFrame[l])}return n},t.prototype.createBubbleComponentWithRowCol=function(e,t,o,n){var a=this.createBubbleComponent(e,t),i=a.node;if(i){var r=m.default.convertRowColToPos(o,n);i.setPosition(r),a.showRing(!1),a.showGift(!1)}this.bubbleDataArray[o]||(this.bubbleDataArray[o]=[]);var s=0;switch(m.default.randNum(1,100)<=1&&(s=1,a.showGift(!0)),this.bubbleDataArray[o][n]=this.createBubbleData(i,e,o,n,!1,!1,s),e){case u.GameConst.BUBBLE_TYPE.RANDOM:this.randomBubbleIndex||(this.randomBubbleIndex=[]),this.randomBubbleIndex.push(cc.v2(o,n));break;case u.GameConst.BUBBLE_TYPE.CLOUD:this.cloudBubbleIndex||(this.cloudBubbleIndex=[]),this.cloudBubbleIndex.push(cc.v2(o,n))}return a},t.prototype.resetData=function(){this.randomBubbleIndex=[],this.cloudBubbleIndex=[],this.runPathArray=[],this.targetPosPathArray=[],this.collidedTargetIndex=null,this.totalLineCoilledIndexs=[],this.curSpecialPropBubble=null,this.useSpecialPropBubble=!1,this.choosableBubbleType=[],this.randomBubbleIndex=[],this.cloudBubbleIndex=[],this.bubbleLayerMoveFinish=!1,h.Global.comboScore=u.GameConst.COMBO_SCORE_DEF,this.waitShoot=!1,this.bubbleDataArray=[],this.node.removeAllChildren(),this.shooterLayer.active=!1,this.opLayer.active=!1,this.choosableBubbleType=[],this.choosableBubbleType.push(u.GameConst.BUBBLE_TYPE.CYAN),this.choosableBubbleType.push(u.GameConst.BUBBLE_TYPE.PINK),this.choosableBubbleType.push(u.GameConst.BUBBLE_TYPE.YELLOW),this.choosableBubbleType.push(u.GameConst.BUBBLE_TYPE.BLUE),this.choosableBubbleType.push(u.GameConst.BUBBLE_TYPE.GREEN),this.choosableBubbleType.push(u.GameConst.BUBBLE_TYPE.RED);var e=this.getNextPropBubbleType(),t=this.getNextPropBubbleType();this.startbubble&&this.startbubble.length>0&&(e=this.startbubble[0],this.startbubble[0]=void 0,this.startbubble.length>1&&(t=this.startbubble[1],this.startbubble[1]=void 0)),this.propBubbleNormal1.setNormalSubType(e),this.propBubbleNormal2.setNormalSubType(t),this.curPropBubble.setNormalSubType(e),this.propBubbleNormal1.node.active=!1,this.propBubbleNormal2.node.active=!0,this.curPropBubble.node.active=!0},t.prototype.createPropBubbleComponent=function(e,t,o){void 0===o&&(o=-1);var n=cc.instantiate(this.propBubblePerfab),a=null,i=this.shooter.getPosition();switch(e){case u.GameConst.PROP_BUBBLE_TYPE.NORMAL:n.addComponent(E.default),(a=n.getComponent(E.default)).init(e,o,i,this),n.scale=1;break;case u.GameConst.PROP_BUBBLE_TYPE.BOMB:n.addComponent(f.default),(a=n.getComponent(f.default)).init(e,o,i,this),n.scale=1.1;break;case u.GameConst.PROP_BUBBLE_TYPE.LASER:n.addComponent(B.default),(a=n.getComponent(B.default)).init(e,o,i,this),n.scale=1.1;break;case u.GameConst.PROP_BUBBLE_TYPE.RAINBOW:n.addComponent(y.default),(a=n.getComponent(y.default)).init(e,o,i,this),n.scale=1.1;break;case u.GameConst.PROP_BUBBLE_TYPE.LIGHTNING:n.addComponent(v.default),(a=n.getComponent(v.default)).init(e,o,i,this),n.scale=1.1}n.parent=t,n.setPosition(i),n.active=!1,a.setStreakTexture(this.streakTexture2DTrans);var r=n.getChildByName("base"),s=this.getPropBubbleSpriteFrameByType(e,o);return s>=0&&(e==u.GameConst.PROP_BUBBLE_TYPE.NORMAL?r.getComponent(cc.Sprite).spriteFrame=this.bubbleSpriteFrame[s]:r.getComponent(cc.Sprite).spriteFrame=this.propBubbleSpriteFrame[s]),a},t.prototype.removeBubble=function(e,t){this.bubbleDataArray[e.x][e.y]&&(this.bubbleDataArray[e.x][e.y]=void 0),s.default.Despawn(u.GameConst.PREFAB_NAME.BUBBLE,t)},t.prototype.checkGift=function(e){this.bubbleDataArray[e.x][e.y]&&this.bubbleDataArray[e.x][e.y].gift>0&&r.EventManager.getInstance().sendEvent(u.GameConst.EVENT.SHOW_GIFT)},t.prototype.showLaser=function(e){var t=cc.instantiate(this.laserPerfab),o=this.shooter.convertToWorldSpaceAR(this.shooter.getPosition()),n=this.effectLayer.convertToNodeSpaceAR(o);t.parent=this.effectLayer,t.setPosition(n),t.zIndex=10,t.angle=e-90},t.prototype.showLightning=function(e){var t=m.default.convertRowColToPos(e.x,e.y),o=cc.instantiate(this.lightningPerfab),n=this.node.convertToWorldSpaceAR(t),a=this.effectLayer.convertToNodeSpaceAR(n),i=cc.v2(0,a.y),r=cc.v2(a.x,0);o.parent=this.effectLayer,o.setPosition(i),o.zIndex=10,o.getChildByName("light").setPosition(r)},t.prototype.showSpecialPropBubbleBgEffect=function(){if(this.useSpecialPropBubble&&this.curSpecialPropBubble){this.shooter.removeAllChildren();var e=null;switch(this.curSpecialPropBubble.getType()){case u.GameConst.PROP_BUBBLE_TYPE.BOMB:e=cc.instantiate(this.propBubbleBombPerfab);break;case u.GameConst.PROP_BUBBLE_TYPE.LASER:e=cc.instantiate(this.propBubbleLaserPerfab);break;case u.GameConst.PROP_BUBBLE_TYPE.RAINBOW:e=cc.instantiate(this.propBubbleRainbowPerfab);break;case u.GameConst.PROP_BUBBLE_TYPE.LIGHTNING:e=cc.instantiate(this.propBubbleLightningPerfab)}e&&(e.parent=this.shooter)}},t.prototype.playEffectWithScore=function(e,t){t.getType(),t.getInnerType();var o,n=t.node.getPosition();o=h.Global.comboScore,e>=0&&this.playEffect(e,n,-1,o)},t.prototype.showCombo=function(){var e=h.Global.comboScore/u.GameConst.COMBO_SCORE_DEF;if(console.log("[Combo]","combo="+e),3==e||6==e||9==e||12==e||15==e){var t=cc.v2(0,100),o=s.default.Spawn(u.GameConst.PREFAB_NAME.EFFECT_COMBO,this.effectLayer);o.setPosition(t),o.getComponent(p.default).play(e)}},t.prototype.showBigScore=function(e,t){if(console.log("[Effect][BigScore]","showBigScore score="+t+",pos="+e.x+","+e.y),!(t<30)){var o=this.node.convertToWorldSpaceAR(e),n=this.effectLayer.convertToNodeSpaceAR(o),a=s.default.Spawn(u.GameConst.PREFAB_NAME.EFFECT_BIG_SCORE,this.effectLayer);a.setPosition(n),a.getComponent(l.default).play(t)}},t.prototype.playEffect=function(e,t,o,n){void 0===n&&(n=-1),console.log("[Effect]","playEffect type="+e+",pos="+t.x+","+t.y+",bubbleType="+o);var a=this.node.convertToWorldSpaceAR(t),i=this.effectLayer.convertToNodeSpaceAR(a),r=this.createEffect(e);r.setPosition(i),r.getComponent(c.default).play(o,n)},t.prototype.createEffect=function(e){var t=null;switch(e){case u.GameConst.EFFECT_TYPE.ICE_BOOM:t=s.default.Spawn(u.GameConst.PREFAB_NAME.EFFECT_ICE_BOOM,this.effectLayer);break;case u.GameConst.EFFECT_TYPE.ICE_IDLE:t=s.default.Spawn(u.GameConst.PREFAB_NAME.EFFECT_ICE_IDLE,this.effectLayer);break;case u.GameConst.EFFECT_TYPE.RAINBOW_BOOM:t=s.default.Spawn(u.GameConst.PREFAB_NAME.EFFECT_RAINBOW_BOOM,this.effectLayer);break;case u.GameConst.EFFECT_TYPE.BUBBLE_BOMB:t=s.default.Spawn(u.GameConst.PREFAB_NAME.EFFECT_BUBBLE_BOMB,this.effectLayer);break;case u.GameConst.EFFECT_TYPE.CLOUD_BOOM:t=s.default.Spawn(u.GameConst.PREFAB_NAME.EFFECT_CLOUD_BOOM,this.effectLayer);break;case u.GameConst.EFFECT_TYPE.BUBBLE_DIE:t=s.default.Spawn(u.GameConst.PREFAB_NAME.EFFECT_BUBBLE_DIE,this.effectLayer)}return t},i([C([cc.SpriteFrame])],t.prototype,"bubbleSpriteFrame",void 0),i([C([cc.SpriteFrame])],t.prototype,"propBubbleSpriteFrame",void 0),i([C(cc.Prefab)],t.prototype,"propBubblePerfab",void 0),i([C(cc.Prefab)],t.prototype,"laserPerfab",void 0),i([C(cc.Prefab)],t.prototype,"lightningPerfab",void 0),i([C(cc.Prefab)],t.prototype,"propBubbleBombPerfab",void 0),i([C(cc.Prefab)],t.prototype,"propBubbleLaserPerfab",void 0),i([C(cc.Prefab)],t.prototype,"propBubbleRainbowPerfab",void 0),i([C(cc.Prefab)],t.prototype,"propBubbleLightningPerfab",void 0),i([C(cc.Texture2D)],t.prototype,"streakTexture2D",void 0),i([C(cc.Texture2D)],t.prototype,"streakTexture2DTrans",void 0),i([C(cc.Node)],t.prototype,"shooter",void 0),i([C(cc.Node)],t.prototype,"shooterNext",void 0),i([C(cc.Node)],t.prototype,"shooterLayer",void 0),i([C(cc.Node)],t.prototype,"midLine",void 0),i([C(cc.Node)],t.prototype,"opLayer",void 0),i([C(cc.Node)],t.prototype,"opPropLayer",void 0),i([C(cc.Node)],t.prototype,"opCancelNode",void 0),i([C(cc.Node)],t.prototype,"effectLayer",void 0),i([C(cc.Node)],t.prototype,"bubbleTip",void 0),i([C(cc.Node)],t.prototype,"dot1",void 0),i([C(cc.Node)],t.prototype,"dot2",void 0),i([g],t)}(cc.Component);o.default=P,cc._RF.pop()},{"../../common/EventManager":"EventManager","../../common/PoolManager":"PoolManager","../Effect":"Effect","../EffectBigScore":"EffectBigScore","../EffectCombo":"EffectCombo","../GameConst":"GameConst","../Global":"Global","../Sound":"Sound","./BaseBubble":"BaseBubble","./BubbleUtil":"BubbleUtil","./prop/PropBubbleBoom":"PropBubbleBoom","./prop/PropBubbleLaser":"PropBubbleLaser","./prop/PropBubbleLightning":"PropBubbleLightning","./prop/PropBubbleNormal":"PropBubbleNormal","./prop/PropBubbleRainbow":"PropBubbleRainbow"}],BubbleUtil:[function(e,t,o){"use strict";cc._RF.push(t,"100caeCGyxKOYJZnkXgA1Kv","BubbleUtil"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../GameConst"),a=function(){function e(){}return e.randNum=function(e,t){return e+Math.floor((t-e+1)*Math.random())},e.convertRowColToPos=function(e,t){var o,a=2*n.GameConst.BUBBLE_R;o=e%2==0?n.GameConst.BUBBLE_R+t*a:a+t*a;var i=-(n.GameConst.BUBBLE_R+e*n.GameConst.BUBBLE_V_SPACE);return cc.v2(o,i)},e.convertPosToRowCol=function(e,t){var o=Math.round((Math.abs(t)-n.GameConst.BUBBLE_R)/n.GameConst.BUBBLE_V_SPACE),a=Math.round((e-n.GameConst.BUBBLE_R*(o%2+1))/(2*n.GameConst.BUBBLE_R));return cc.v2(o,a)},e.checkCollided=function(e,t,o,a){var i=2*n.GameConst.BUBBLE_R,r=Math.abs(t-a);if(r>i)return!1;var s=Math.abs(e-o);return!(s>i||s*s+r*r>=i*i*n.GameConst.COLLIDED_RATE)},e.checkCollidedWithAimDot=function(t,o,n,a){return e.checkCollided(t,o,n,a)},e.getPosDistSq=function(e,t,o,n){var a=t-n,i=e-o;return i*i+a*a},e.getPosDist=function(e,t,o,n){var a=t-n,i=e-o;return Math.sqrt(i*i+a*a)},e.getPosDistByPos=function(e,t){var o=e.y-t.y,n=e.x-t.x;return Math.sqrt(n*n+o*o)},e.getBubbleLayerHeight=function(e){return e<=0?0:2*n.GameConst.BUBBLE_R+(e-1)*n.GameConst.BUBBLE_V_SPACE},e.dot=function(e,t){return e.x*t.x+e.y*t.y},e.norm=function(e){return e.x*e.x+e.y*e.y},e.getVel=function(e,t){return cc.v2(t.x-e.x,t.y-e.y)},e.project=function(t,o,n){var a=o.sub(t);a=e.getVel(t,o);var i=n.sub(t);i=e.getVel(t,n);var r=e.dot(i,a)/e.norm(a),s=a.mul(r),c=t.x+s.x,l=t.y+s.y;return cc.v2(c,l)},e.getCrossPoints=function(t,o,n,a){var i=e.project(t,o,n),r=o.sub(t),s=Math.sqrt(e.norm(r)),c=r.div(s),l=n.sub(i),p=a*a-e.norm(l),u=Math.sqrt(Math.abs(p)),h=c.mul(u),b=cc.v2(i.x+h.x,i.y+h.y),d=cc.v2(i.x-h.x,i.y-h.y),m=[];return m.push(b),m.push(d),m},e}();o.default=a,cc._RF.pop()},{"../GameConst":"GameConst"}],EffectBigScore:[function(e,t,o){"use strict";cc._RF.push(t,"17ba4PUophFNZfK/rhF+E+u","EffectBigScore");var n,a=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var a,i=arguments.length,r=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(i<3?a(r):i>3?a(t,o,r):a(t,o))||r);return i>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../common/PoolManager"),s=e("./bubble/BubbleUtil"),c=e("./GameConst"),l=cc._decorator,p=l.ccclass,u=l.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.numLabel=null,t}return a(t,e),t.prototype.onLoad=function(){this.animation=this.node.getComponent(cc.Animation)},t.prototype.onEnable=function(){this.animation&&this.animation.on("finished",this.onFinished,this)},t.prototype.onDisable=function(){this.animation&&this.animation.off("finished",this.onFinished,this)},t.prototype.play=function(e){var t="anim_bigscore01";if(this.numLabel.string=""+e,e>=30&&e<=60)t="anim_bigscore0"+(o=s.default.randNum(1,2));else if(e>60&&e<=120)3==(o=s.default.randNum(1,4))&&(o=1),t="anim_bigscore0"+o;else if(e>120){var o;t="anim_bigscore0"+(o=s.default.randNum(3,4))}else e>300&&(t="anim_bigscore03");this.animation&&this.animation.play(t)},t.prototype.onFinished=function(){this.remove()},t.prototype.remove=function(){r.default.Despawn(c.GameConst.PREFAB_NAME.EFFECT_BIG_SCORE,this.node)},i([u(cc.Label)],t.prototype,"numLabel",void 0),i([p],t)}(cc.Component);o.default=h,cc._RF.pop()},{"../common/PoolManager":"PoolManager","./GameConst":"GameConst","./bubble/BubbleUtil":"BubbleUtil"}],EffectCombo:[function(e,t,o){"use strict";cc._RF.push(t,"07e4b4U1XhFiIFDi+kl/N2J","EffectCombo");var n,a=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var a,i=arguments.length,r=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(i<3?a(r):i>3?a(t,o,r):a(t,o))||r);return i>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../common/PoolManager"),s=e("./GameConst"),c=e("./Sound"),l=cc._decorator,p=l.ccclass,u=l.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.comboNode=null,t}return a(t,e),t.prototype.onLoad=function(){this.animation=this.comboNode.getComponent(cc.Animation)},t.prototype.onEnable=function(){this.animation&&this.animation.on("finished",this.onFinished,this)},t.prototype.onDisable=function(){this.animation&&this.animation.off("finished",this.onFinished,this)},t.prototype.play=function(e){if(!(e<3)){var t=null;3==e?(t="anim_combo_01",c.default.Combo(3)):6==e?(t="anim_combo_02",c.default.Combo(6)):e>=9&&(t="anim_combo_03",c.default.Combo(9)),t&&this.animation&&this.animation.play(t)}},t.prototype.onFinished=function(){this.remove()},t.prototype.remove=function(){r.default.Despawn(s.GameConst.PREFAB_NAME.EFFECT_COMBO,this.node)},i([u(cc.Node)],t.prototype,"comboNode",void 0),i([p],t)}(cc.Component);o.default=h,cc._RF.pop()},{"../common/PoolManager":"PoolManager","./GameConst":"GameConst","./Sound":"Sound"}],EffectGameStartTip:[function(e,t,o){"use strict";cc._RF.push(t,"67577zMiaVMrLjFBISl0iMI","EffectGameStartTip");var n,a=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var a,i=arguments.length,r=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(i<3?a(r):i>3?a(t,o,r):a(t,o))||r);return i>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,s=r.ccclass,c=(r.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.onLoad=function(){this.animation=this.node.getComponent(cc.Animation)},t.prototype.onEnable=function(){this.animation&&this.animation.on("finished",this.onFinished,this)},t.prototype.onDisable=function(){this.animation&&this.animation.off("finished",this.onFinished,this)},t.prototype.play=function(){this.animation&&this.animation.play()},t.prototype.onFinished=function(){this.remove()},t.prototype.remove=function(){var e=this;this.node.removeFromParent(),this.scheduleOnce(function(){e.node.destroy()},1)},i([s],t)}(cc.Component));o.default=c,cc._RF.pop()},{}],Effect:[function(e,t,o){"use strict";cc._RF.push(t,"ebc46iWTlhEa5c3/2KXvimr","Effect");var n,a=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var a,i=arguments.length,r=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(i<3?a(r):i>3?a(t,o,r):a(t,o))||r);return i>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../common/PoolManager"),s=e("./GameConst"),c=e("./Global"),l=cc._decorator,p=l.ccclass,u=l.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=0,t.numLabel=null,t.bubbleType=-1,t}return a(t,e),t.prototype.onLoad=function(){this.animation=this.node.getComponent(cc.Animation)},t.prototype.onEnable=function(){this.animation&&this.animation.on("finished",this.onFinished,this)},t.prototype.onDisable=function(){this.animation&&this.animation.off("finished",this.onFinished,this)},t.prototype.play=function(e,t){if(void 0===t&&(t=-1),this.bubbleType=e,this.type==s.GameConst.EFFECT_TYPE.BUBBLE_DIE){var o="anim_bubble_block7";switch(this.bubbleType){case s.GameConst.BUBBLE_TYPE.PINK:o="anim_bubble_block1";break;case s.GameConst.BUBBLE_TYPE.CYAN:o="anim_bubble_block2";break;case s.GameConst.BUBBLE_TYPE.YELLOW:o="anim_bubble_block3";break;case s.GameConst.BUBBLE_TYPE.BLUE:o="anim_bubble_block4";break;case s.GameConst.BUBBLE_TYPE.GREEN:o="anim_bubble_block5";break;case s.GameConst.BUBBLE_TYPE.RED:o="anim_bubble_block6"}t>0?(this.numLabel&&(this.numLabel.string=t+""),c.Global.curGameScore+=t,console.log("[Score][Game] \u603b\u5206="+c.Global.curGameScore)):this.numLabel&&(this.numLabel.string=""),this.animation&&this.animation.play(o)}else this.animation&&this.animation.play()},t.prototype.onPlay=function(){},t.prototype.onPause=function(){},t.prototype.onResume=function(){},t.prototype.onStop=function(){},t.prototype.onFinished=function(){this.remove()},t.prototype.remove=function(){switch(this.type){case s.GameConst.EFFECT_TYPE.ICE_BOOM:r.default.Despawn(s.GameConst.PREFAB_NAME.EFFECT_ICE_BOOM,this.node);break;case s.GameConst.EFFECT_TYPE.ICE_IDLE:r.default.Despawn(s.GameConst.PREFAB_NAME.EFFECT_ICE_IDLE,this.node);break;case s.GameConst.EFFECT_TYPE.BUBBLE_BOMB:r.default.Despawn(s.GameConst.PREFAB_NAME.EFFECT_BUBBLE_BOMB,this.node);break;case s.GameConst.EFFECT_TYPE.RAINBOW_BOOM:r.default.Despawn(s.GameConst.PREFAB_NAME.EFFECT_RAINBOW_BOOM,this.node);break;case s.GameConst.EFFECT_TYPE.CLOUD_BOOM:r.default.Despawn(s.GameConst.PREFAB_NAME.EFFECT_CLOUD_BOOM,this.node);break;case s.GameConst.EFFECT_TYPE.BUBBLE_DIE:r.default.Despawn(s.GameConst.PREFAB_NAME.EFFECT_BUBBLE_DIE,this.node);break;default:this.node.destroy()}},i([u(cc.Integer)],t.prototype,"type",void 0),i([u(cc.Label)],t.prototype,"numLabel",void 0),i([p],t)}(cc.Component);o.default=h,cc._RF.pop()},{"../common/PoolManager":"PoolManager","./GameConst":"GameConst","./Global":"Global"}],EventManager:[function(e,t,o){"use strict";cc._RF.push(t,"e9d571lFKxNMqUu/8NFxqNA","EventManager"),Object.defineProperty(o,"__esModule",{value:!0}),o.EventManager=void 0;var n=function(){function e(){this.eventList={}}return e.getInstance=function(){return this.instance||(this.instance=new e),this.instance},e.prototype.sendEvent=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];var n=this.eventList[e];if(null!=n)for(var a=n.length,i=void 0,r=void 0,s=a-1;s>=0;s--){var c=n[s];c?(i=c[0],r=c[1],i.apply(r,t)):console.log("msg null i="+s+",args="+t)}},e.prototype.addEvent=function(e,t,o){var n=this.eventList[e];if(null==n)n=[],this.eventList[e]=n;else for(var a=n.length,i=0;i<a;i++)if(n[i][0]==t&&n[i][1]==o)return;n.push([t,o])},e.prototype.removeEvent=function(e,t,o){var n=this.eventList[e];if(null!=n)for(var a=n.length-1;a>=0;a--)n[a][0]==t&&n[a][1]==o&&n.splice(a,1);n&&0==n.length&&(this.eventList[e]=null,delete this.eventList[e])},e}();o.EventManager=n,cc._RF.pop()},{}],GameConst:[function(e,t,o){"use strict";cc._RF.push(t,"ef99fBHLmRPFoaWQK6HjPY5","GameConst"),Object.defineProperty(o,"__esModule",{value:!0}),o.GameConst=void 0;var n=function(){function e(){}return e.BUBBLE_MOVE_SPEED=50,e.BUBBLE_R=34,e.BUBBLE_V_SPACE=e.BUBBLE_R*Math.sqrt(3),e.COLLIDED_RATE=.7,e.VEL_PER=5,e.COL_ODD=11,e.COL_EVEN=10,e.TOP_H=290,e.BOTTOM_H=300,e.MID_SPACE_RATE=.32,e.AIM_DOT_MAX_COUNT=50,e.PER=2,e.YES=1,e.NO=0,e.CRYPT_KEY="12345678",e.GAME_VERSION="v1.0.0",e.GAME_VERSION_NUMBER=1,e.COMBO_SCORE_DEF=10,e.COMBO_SCORE_STEP=10,e.PROP_PRICE=100,e.TOTAL_LEVE=287,e.BUBBLE_TYPE={PINK:1,CYAN:2,YELLOW:3,BLUE:4,GREEN:5,RED:6,BOOM:11,LASER:12,RAINBOW:13,LIGHTNING:14,IRON:1001,BLACK_HOLE:1002,ICE:1003,CLOUD:1004,LOCK:1e4,RANDOM:1e5},e.PROP_BUBBLE_TYPE={NORMAL:0,BOMB:11,LASER:12,RAINBOW:13,LIGHTNING:14},e.BUBBLE_STATE={IDLE:0,MOVING:1},e.PROP_BUBBLE_STATE={IDLE:0,MOVING:1},e.DATA_KEY={UUID:"key_uuid",CUR_LEVEL:"key_cur_level",LEVEL_STAR:"key_level_star",FIRST_SIGN_TIMESTAMP:"key_f_s_ts",LAST_SIGN_TIMESTAMP:"key_l_s_ts",SIGNED_TIME:"key_s_t",COIN:"key_coin",GET_FREE_COIN_TIME:"key_g_f_c_t",GET_FREE_COIN_TIMESTAMP:"key_g_f_c_ts",ONLINE_TIMESTAMP:"key_ol_ts",CHEST_START_TIMESTAMP:"key_cs_ts",PROP_BOMB:"key_prop_bomb",PROP_LASER:"key_prop_laser",PROP_RAINBOW:"key_prop_rainbow",PROP_LIGHTNING:"key_prop_lightning",SOUND_MUSIC:"key_sound_music",SOUND_FX:"key_sound_fx",SHAKE:"key_shake",CHEST_LEVEL:"key_chest_level",CHEST_COUNT:"key_chest_count",GUIDE_IRON:"key_guide_iron",GUIDE_PROP_RAINBOW:"key_guide_prop_rainbow",GUIDE_PROP_LIGHTNING:"key_guide_lightning",GUIDE_ICE:"key_guide_ice",GUIDE_BLACK_HOLE:"key_guide_bh",GUIDE_CLOUD:"key_guide_cloud"},e.GAME_STATE={REPRARE:0,WAIT_SHOOT:1,SHOOTING:2,PAUSE:3,GAME_OVER:4,GAME_WIN:5},e.EVENT={GAME_START:"game_start",GAME_RESTART:"game_restart",GAME_PAUSE:"game_pause",GAME_RESUME:"game_resume",GAME_OVER:"game_over",GAME_WIN:"game_win",GAME_OVER_CHECK:"game_over_check",REVIVE:"revive",EXIT:"exit",SHOW_GUIDE:"show_guide",HIDE_ADD_BUBBLE:"hide_add_bubble",ADD_TO_CHEST:"add_to_chest",SHOW_CHEST_OVER:"show_chest_over",SHOW_CHEST_OPEN:"show_chest_open",SHOW_CHEST_LIST:"show_chest_list",SHOW_CHEST_REWARD:"show_chest_reward",SHOW_DAILY:"show_daily",UPDATE_BUBBLE_LAYER_POS:"update_bubble_layer_pos",UPDATE_AIM_TYPE:"update_aim_type",UPDATE_UI:"update_ui",SHOW_GIFT:"show_gift",BUBBLE_SHOOT:"bubble_shoot",BUBBLE_SHOOT_MOVE:"bubble_shoot_move",BUBBLE_SHOOT_END:"bubble_shoot_end",LEVEL_SELECT:"level_select",START_NEW_LEVEL:"start_new_level",LIST_SCROLL:"list_scroll",LIST_SCROLL_END:"list_scroll_end"},e.PATH={LEVEL:"ppl/data/level/",AUDIO:"ppl/audio/",PREFAB:"ppl/prefab/"},e.PREFAB_NAME={BUBBLE:"bubble",PROP_BUBBLE:"prop_bubble",AIM_DOT:"aim_dot",EFFECT_ICE_BOOM:"ice_boom",EFFECT_ICE_IDLE:"bubble_iceidle",EFFECT_BUBBLE_BOMB:"bubble_bomb",EFFECT_RAINBOW_BOOM:"bubble_color_bomb",EFFECT_CLOUD_BOOM:"cloud_boom",EFFECT_BUBBLE_DIE:"bubble_die",EFFECT_BIG_SCORE:"big_score",EFFECT_COMBO:"combo"},e.EFFECT_TYPE={ICE_BOOM:0,ICE_IDLE:1,BUBBLE_BOMB:2,RAINBOW_BOOM:3,CLOUD_BOOM:4,BUBBLE_DIE:5},e.UI_TYPE={COIN:0,STAR_PROGRESS:1,SEORE:2,LEVEL:3,PROP:4,COUNT:5},e.GUIDE_TYPE={BUBBLE_IRON:0,PROP_RAINBOW:1,PROP_LIGHTNING:2,BUBBLE_ICE:3,BUBBLE_BLACK_HOLE:4,BUBBLE_CLOUD:5},e.SIGN_CONFIG=[{COIN:0,PROP_BOMB:1,PROP_LASER:0,PROP_RAINBOW:0,PROP_LIGHTNING:0},{COIN:150,PROP_BOMB:0,PROP_LASER:0,PROP_RAINBOW:0,PROP_LIGHTNING:0},{COIN:0,PROP_BOMB:0,PROP_LASER:0,PROP_RAINBOW:0,PROP_LIGHTNING:1},{COIN:0,PROP_BOMB:0,PROP_LASER:0,PROP_RAINBOW:1,PROP_LIGHTNING:0},{COIN:300,PROP_BOMB:1,PROP_LASER:0,PROP_RAINBOW:0,PROP_LIGHTNING:0},{COIN:0,PROP_BOMB:1,PROP_LASER:1,PROP_RAINBOW:0,PROP_LIGHTNING:0},{COIN:0,PROP_BOMB:2,PROP_LASER:2,PROP_RAINBOW:2,PROP_LIGHTNING:2}],e.CHEST_COUNT_CONFIG=[80,240,360],e}();o.GameConst=n,cc._RF.pop()},{}],Game:[function(e,t,o){"use strict";cc._RF.push(t,"354356z9YJL0J93osG6jf/4","Game");var n,a=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var a,i=arguments.length,r=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(i<3?a(r):i>3?a(t,o,r):a(t,o))||r);return i>3&&r&&Object.defineProperty(t,o,r),r},r=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))(function(a,i){function r(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(r,s)}c((n=n.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){var o,n,a,i,r={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(e){return function(t){return c([e,t])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;r;)try{if(o=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return r.label++,{value:i[1],done:!1};case 5:r.label++,n=i[1],i=[0];continue;case 7:i=r.ops.pop(),r.trys.pop();continue;default:if(!(a=(a=r.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){r=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){r.label=i[1];break}if(6===i[0]&&r.label<a[1]){r.label=a[1],a=i;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(i);break}a[2]&&r.ops.pop(),r.trys.pop();continue}i=t.call(e,r)}catch(s){i=[6,s],n=0}finally{o=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=e("../common/Utils"),l=e("./GameConst"),p=e("../common/EventManager"),u=e("./bubble/BubbleManager"),h=e("./bubble/BubbleUtil"),b=e("./bubble/AimLine"),d=e("./Global"),m=e("../common/PopupManager"),f=e("./pop/PopPause"),B=e("./EffectGameStartTip"),v=e("./Sound"),E=e("./pop/PopFail"),y=e("./pop/PopDaily"),_=e("./pop/PopGuide"),g=e("./AddBubble"),C=e("./pop/PopAddBubble"),P=e("./pop/PopShop"),T=e("./pop/PopOnlineGift"),G=e("./pop/PopRandomGift"),S=e("./pop/PopCoinGift"),L=e("./pop/PopChestOver"),O=e("./pop/PopChestOpen"),N=e("./pop/PopChestList"),A=e("./pop/PopChestReward"),R=cc._decorator,I=R.ccclass,M=R.property,D=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.levelLayer=null,t.bubbleLayer=null,t.opLayer=null,t.topLayer=null,t.effectlLayer=null,t.levelSelectLayer=null,t.bubbleManager=null,t.countLabel=null,t.aimLine=null,t.coinLabel=null,t.scoreLabel=null,t.levelLabel=null,t.coinFly=null,t.add10Bubble=null,t.starSpriteFrame=[],t.star1=null,t.star2=null,t.star3=null,t.progressBar=null,t.propBombCoin=null,t.propBombCoinLabel=null,t.propBombCount=null,t.propBombCountLabel=null,t.propLaserCoin=null,t.propLaserCoinLabel=null,t.propLaserCount=null,t.propLaserCountLabel=null,t.propRainbowCoin=null,t.propRainbowLabel=null,t.propRainbowCount=null,t.propRainbowCountLabel=null,t.propLightningCoin=null,t.propLightningLabel=null,t.propLightningCount=null,t.propLightningCountLabel=null,t.gameStartTipPerfab=null,t.addBubblePerfab=null,t.curLevel=1,t.moveOffsetY=0,t.curStar=0,t.waitTime=0,t.showOnecAddBubblePop=!1,t}return a(t,e),t.prototype.onEnable=function(){p.EventManager.getInstance().addEvent(l.GameConst.EVENT.BUBBLE_SHOOT,this.shoot,this),p.EventManager.getInstance().addEvent(l.GameConst.EVENT.BUBBLE_SHOOT_MOVE,this.shootMove,this),p.EventManager.getInstance().addEvent(l.GameConst.EVENT.BUBBLE_SHOOT_END,this.shootEnd,this),p.EventManager.getInstance().addEvent(l.GameConst.EVENT.UPDATE_BUBBLE_LAYER_POS,this.updateBubbleLayerPos,this),p.EventManager.getInstance().addEvent(l.GameConst.EVENT.UPDATE_AIM_TYPE,this.updateAimLineType,this),p.EventManager.getInstance().addEvent(l.GameConst.EVENT.UPDATE_UI,this.updateUI,this),p.EventManager.getInstance().addEvent(l.GameConst.EVENT.GAME_WIN,this.gameWin,this),p.EventManager.getInstance().addEvent(l.GameConst.EVENT.GAME_OVER,this.gameOver,this),p.EventManager.getInstance().addEvent(l.GameConst.EVENT.GAME_OVER_CHECK,this.gameOverCheck,this),p.EventManager.getInstance().addEvent(l.GameConst.EVENT.GAME_RESTART,this.gameRestart,this),p.EventManager.getInstance().addEvent(l.GameConst.EVENT.EXIT,this.gameExit,this),p.EventManager.getInstance().addEvent(l.GameConst.EVENT.GAME_RESUME,this.gameResume,this),p.EventManager.getInstance().addEvent(l.GameConst.EVENT.SHOW_GUIDE,this.showGuide,this),p.EventManager.getInstance().addEvent(l.GameConst.EVENT.HIDE_ADD_BUBBLE,this.hideAddBubble,this),p.EventManager.getInstance().addEvent(l.GameConst.EVENT.SHOW_GIFT,this.showGift,this),p.EventManager.getInstance().addEvent(l.GameConst.EVENT.SHOW_CHEST_OVER,this.showChestOver,this),p.EventManager.getInstance().addEvent(l.GameConst.EVENT.SHOW_CHEST_OPEN,this.showChestOpen,this),p.EventManager.getInstance().addEvent(l.GameConst.EVENT.SHOW_CHEST_LIST,this.showChestList,this),p.EventManager.getInstance().addEvent(l.GameConst.EVENT.SHOW_CHEST_REWARD,this.showChestReward,this),p.EventManager.getInstance().addEvent(l.GameConst.EVENT.ADD_TO_CHEST,this.addToChest,this),p.EventManager.getInstance().addEvent(l.GameConst.EVENT.SHOW_DAILY,this.showDaily,this)},t.prototype.onDisable=function(){p.EventManager.getInstance().removeEvent(l.GameConst.EVENT.BUBBLE_SHOOT,this.shoot,this),p.EventManager.getInstance().removeEvent(l.GameConst.EVENT.BUBBLE_SHOOT_MOVE,this.shootMove,this),p.EventManager.getInstance().removeEvent(l.GameConst.EVENT.BUBBLE_SHOOT_END,this.shootEnd,this),p.EventManager.getInstance().removeEvent(l.GameConst.EVENT.UPDATE_BUBBLE_LAYER_POS,this.updateBubbleLayerPos,this),p.EventManager.getInstance().removeEvent(l.GameConst.EVENT.UPDATE_AIM_TYPE,this.updateAimLineType,this),p.EventManager.getInstance().removeEvent(l.GameConst.EVENT.UPDATE_UI,this.updateUI,this),p.EventManager.getInstance().removeEvent(l.GameConst.EVENT.GAME_WIN,this.gameWin,this),p.EventManager.getInstance().removeEvent(l.GameConst.EVENT.GAME_OVER,this.gameOver,this),p.EventManager.getInstance().removeEvent(l.GameConst.EVENT.GAME_OVER_CHECK,this.gameOverCheck,this),p.EventManager.getInstance().removeEvent(l.GameConst.EVENT.GAME_RESTART,this.gameRestart,this),p.EventManager.getInstance().removeEvent(l.GameConst.EVENT.EXIT,this.gameExit,this),p.EventManager.getInstance().removeEvent(l.GameConst.EVENT.GAME_RESUME,this.gameResume,this),p.EventManager.getInstance().removeEvent(l.GameConst.EVENT.SHOW_GUIDE,this.showGuide,this),p.EventManager.getInstance().removeEvent(l.GameConst.EVENT.HIDE_ADD_BUBBLE,this.hideAddBubble,this),p.EventManager.getInstance().removeEvent(l.GameConst.EVENT.SHOW_GIFT,this.showGift,this),p.EventManager.getInstance().removeEvent(l.GameConst.EVENT.SHOW_CHEST_OVER,this.showChestOver,this),p.EventManager.getInstance().removeEvent(l.GameConst.EVENT.SHOW_CHEST_OPEN,this.showChestOpen,this),p.EventManager.getInstance().removeEvent(l.GameConst.EVENT.SHOW_CHEST_LIST,this.showChestList,this),p.EventManager.getInstance().removeEvent(l.GameConst.EVENT.SHOW_CHEST_REWARD,this.showChestReward,this),p.EventManager.getInstance().removeEvent(l.GameConst.EVENT.ADD_TO_CHEST,this.addToChest,this),p.EventManager.getInstance().removeEvent(l.GameConst.EVENT.SHOW_DAILY,this.showDaily,this)},t.prototype.showGameStartTip=function(){var e=this;this.scheduleOnce(function(){var t=cc.instantiate(e.gameStartTipPerfab);t.parent=e.effectlLayer,t.setPosition(cc.v2(0,0)),t.getComponent(B.default).play()},2)},t.prototype.shootMove=function(e){if(console.log("this.state="+this.state),this.isWaitShootState())if(e>0){this.bubbleManager.calAllTouchPos(e);var t=this.bubbleManager.getMoveEndPos();this.aimLine.node.active=!0,this.aimLine.setRotation(e,t),this.changeTopLayerOpt(100)}else this.aimLine.node.active=!1,this.aimLine.setEndPos(null),this.bubbleManager.setShowRingBubble(null),this.changeTopLayerOpt(255);else this.aimLine.node.active=!1,this.changeTopLayerOpt(255)},t.prototype.shoot=function(e){this.isWaitShootState()&&e>0&&(d.Global.curLevelShootBubbleCount>0&&(this.bubbleManager.launch(e),d.Global.curLevelShootBubbleCount--,this.updateCountUI(),this.setGameState(l.GameConst.GAME_STATE.SHOOTING),10!=d.Global.curLevelShootBubbleCount||this.showOnecAddBubblePop||(this.add10Bubble.active=!0,this.showOnecAddBubblePop=!0)),this.changeTopLayerOpt(255)),this.aimLine.node.active=!1},t.prototype.changeTopLayerOpt=function(e){this.topLayer&&(this.topLayer.opacity=e)},t.prototype.shootEnd=function(){var e=this.bubbleManager.getAimType();this.updateAimLineType(e),this.isShootingState()?(console.log("[END]","Game shootEnd"),this.setGameState(l.GameConst.GAME_STATE.WAIT_SHOOT)):console.log("[END]","Game shootEnd not shooting state")},t.prototype.gameWin=function(){var e=this;this.setGameState(l.GameConst.GAME_STATE.GAME_WIN),v.default.Win(),this.updateCoin(),this.getCoin(20),this.remainBubble=d.Global.curLevelShootBubbleCount,d.Global.curGameScore+=300*this.remainBubble,this.updateScore();var t=d.Global.getChestLevel();if(t<=3){var o=d.Global.curChestCount+d.Global.getChestCount(),n=t-1,a=l.GameConst.CHEST_COUNT_CONFIG[n];o>a&&(o=a),d.Global.saveChestCount(o)}this.scheduleOnce(function(){e.toNextLevel(),e.moveBubbleLayer(1,1.5)},1)},t.prototype.gameOver=function(){v.default.Fail(),this.setGameState(l.GameConst.GAME_STATE.GAME_OVER),m.default.show(E.default.path,null)},t.prototype.gameOverCheck=function(){this.showAddBubblePop(null,0)},t.prototype.gameRestart=function(e){var t=this;console.log("[POP]startNewLevel="+e),this.curLevel=e,this.bubbleLayer.removeAllChildren(),this.scheduleOnce(function(){t.restartLevel(),t.moveBubbleLayer(-1,1.5)},.5)},t.prototype.gameResume=function(){this.setGameState(l.GameConst.GAME_STATE.WAIT_SHOOT)},t.prototype.gameExit=function(){this.showLevelSelect()},t.prototype.updateCountUI=function(){var e=d.Global.curLevelShootBubbleCount;this.countLabel.string=""+e},t.prototype.updateUI=function(e){switch(void 0===e&&(e=-1),e){case l.GameConst.UI_TYPE.COIN:this.updateCoin();break;case l.GameConst.UI_TYPE.STAR_PROGRESS:this.updateProgressBar();break;case l.GameConst.UI_TYPE.SEORE:this.updateScore();break;case l.GameConst.UI_TYPE.LEVEL:this.updateLevel();break;case l.GameConst.UI_TYPE.PROP:this.updateOpLayerUI();break;case l.GameConst.UI_TYPE.COUNT:this.updateCountUI();break;default:this.updateTopUI(),this.updateOpLayerUI()}},t.prototype.updateTopUI=function(){this.updateCoin(),this.updateLevel(),this.updateScore()},t.prototype.updateLevel=function(){this.levelLabel.string="\u7b2c"+this.curLevel+"\u5173"},t.prototype.updateCoin=function(){var e=d.Global.getCoin();this.coinLabel.string=e+""},t.prototype.updateScore=function(){this.scoreLabel.string="\u5f97\u5206:"+d.Global.curGameScore,this.updateProgressBar()},t.prototype.updateProgressBar=function(){if(this.curLevelData){var e=this.curLevelData.score1,t=this.curLevelData.score2,o=this.curLevelData.score3;if(o>0){var n=d.Global.curGameScore,a=n/o;console.log("[Data]","progress="+a),a>1&&(a=1);var i=0;this.progressBar.progress=a,n>=e?(this.star1.getComponent(cc.Sprite).spriteFrame=this.starSpriteFrame[0],i=1):this.star1.getComponent(cc.Sprite).spriteFrame=this.starSpriteFrame[1],n>=t?(this.star2.getComponent(cc.Sprite).spriteFrame=this.starSpriteFrame[0],i=2):this.star2.getComponent(cc.Sprite).spriteFrame=this.starSpriteFrame[1],n>=o?(this.star3.getComponent(cc.Sprite).spriteFrame=this.starSpriteFrame[0],i=3):this.star3.getComponent(cc.Sprite).spriteFrame=this.starSpriteFrame[1],i>this.curStar&&(this.curStar=i,d.Global.saveLevelStar(this.curLevel,i))}}},t.prototype.updateOpLayerUI=function(){var e=d.Global.getCoin(),t=d.Global.getPropData(l.GameConst.PROP_BUBBLE_TYPE.BOMB),o=d.Global.getPropData(l.GameConst.PROP_BUBBLE_TYPE.LASER),n=d.Global.getPropData(l.GameConst.PROP_BUBBLE_TYPE.RAINBOW),a=d.Global.getPropData(l.GameConst.PROP_BUBBLE_TYPE.LIGHTNING),i=e>=100;if(t>0)this.propBombCoin.active=!1,this.propBombCountLabel.string=t+"";else{this.propBombCoin.active=!0,this.propBombCountLabel.string="0";var r=this.propBombCoin.getChildByName("Coin"),s=this.propBombCoin.getChildByName("CoinLabel").getComponent(cc.Label),c=this.propBombCoin.getChildByName("Video");i?(r.active=!0,c.active=!1,s.string="100"):(r.active=!1,c.active=!0,s.string="\u7b2c1")}o>0?(this.propLaserCoin.active=!1,this.propLaserCountLabel.string=o+""):(this.propLaserCoin.active=!0,this.propLaserCountLabel.string="0",r=this.propLaserCoin.getChildByName("Coin"),s=this.propLaserCoin.getChildByName("CoinLabel").getComponent(cc.Label),c=this.propLaserCoin.getChildByName("Video"),i?(r.active=!0,c.active=!1,s.string="100"):(r.active=!1,c.active=!0,s.string="\u7b2c1")),n>0?(this.propRainbowCoin.active=!1,this.propRainbowCountLabel.string=n+""):(this.propRainbowCoin.active=!0,this.propRainbowCountLabel.string="0",r=this.propRainbowCoin.getChildByName("Coin"),s=this.propRainbowCoin.getChildByName("CoinLabel").getComponent(cc.Label),c=this.propRainbowCoin.getChildByName("Video"),i?(r.active=!0,c.active=!1,s.string="100"):(r.active=!1,c.active=!0,s.string="\u7b2c1")),a>0?(this.propLightningCoin.active=!1,this.propLightningCountLabel.string=t+""):(this.propLightningCoin.active=!0,this.propLightningCountLabel.string="0",r=this.propLightningCoin.getChildByName("Coin"),s=this.propLightningCoin.getChildByName("CoinLabel").getComponent(cc.Label),c=this.propLightningCoin.getChildByName("Video"),i?(r.active=!0,c.active=!1,s.string="100"):(r.active=!1,c.active=!0,s.string="\u7b2c1"))},t.prototype.getCoin=function(e){var t=this;this.coinFly.active=!0,this.coinFly.scale=.1;var o=cc.v3(120-cc.winSize.width/2,cc.winSize.height/2-75,0);cc.tween(this.coinFly).to(.3,{scale:1.2}).to(.1,{scale:1}).to(.5,{position:o}).call(function(){t.coinFly.active=!1,t.coinFly.scale=.1,t.coinFly.setPosition(cc.v2(0,0));var o=d.Global.getCoin();o+=e,d.Global.saveCoin(o),t.updateCoin()}).start()},t.prototype.restartLevel=function(){this.setGameState(l.GameConst.GAME_STATE.REPRARE),d.Global.curGameScore=0,this.setLevelData(this.curLevel)},t.prototype.toNextLevel=function(){var e=this;this.setGameState(l.GameConst.GAME_STATE.REPRARE),this.curLevel++,this.curLevel>l.GameConst.TOTAL_LEVE&&(this.curLevel=1),d.Global.curGameScore=0,this.setLevelData(this.curLevel),d.Global.saveLevel(this.curLevel),this.scheduleOnce(function(){var t=d.Global.curLevelShootBubbleCount-e.remainBubble;t>0&&e.showAddBubble(t),e.remainBubble=0},2);var t=d.Global.getChestLevel();if(t<=3){var o=t-1;d.Global.getChestCount()>=l.GameConst.CHEST_COUNT_CONFIG[o]&&this.scheduleOnce(function(){e.showChestOpen()},3)}},t.prototype.updateAimLineType=function(e){this.aimLine.setType(e)},t.prototype.updateBubbleLayerPos=function(e){var t=this,o=l.GameConst.MID_SPACE_RATE*cc.visibleRect.height,n=cc.visibleRect.height-(l.GameConst.BOTTOM_H+o),a=l.GameConst.TOP_H+e-n;a<0&&(a=0),console.log("bubbleLayerHeight moveOffsetY:"+a),console.log("bubbleLayerHeight this.moveOffsetY:"+this.moveOffsetY),this.moveOffsetY!=a?(this.moveOffsetY=a,cc.tween(this.levelLayer).to(.5,{position:cc.v3(0,this.moveOffsetY,0)},cc.easeSineOut()).call(function(){console.log("[lau]","updateBubbleLayerPos:"),t.bubbleManager.bubbleLayerMoveFinish=!0,t.setGameState(l.GameConst.GAME_STATE.WAIT_SHOOT)}).start()):(this.bubbleManager.bubbleLayerMoveFinish=!0,this.setGameState(l.GameConst.GAME_STATE.WAIT_SHOOT))},t.prototype.hideOpLayer=function(){this.opLayer},t.prototype.onLoad=function(){d.Global.gameInit(),this.init()},t.prototype.init=function(){this.setGameState(l.GameConst.GAME_STATE.REPRARE),d.Global.curGameScore=0,this.curLevel=d.Global.getLevel(),d.Global.debug,d.Global.currentLevel=this.curLevel,this.initLevel(this.curLevel),this.aimLine.init(this.bubbleManager),this.aimLine.node.active=!1,this.updateUI(),v.default.init(function(){v.default.GameBGM()})},t.prototype.start=function(){cc.game.setFrameRate(81)},t.prototype.gamePause=function(){console.log("[lau]","gamePause"),m.default.CacheMode.Once,m.default.show(f.default.path,null)},t.prototype.setGameState=function(e){switch(console.log("[lau]","GameState Set="+e),this.state=e,e){case l.GameConst.GAME_STATE.WAIT_SHOOT:this.bubbleManager.setWaitShoot();break;case l.GameConst.GAME_STATE.PAUSE:}},t.prototype.isWaitShootState=function(){return this.state==l.GameConst.GAME_STATE.WAIT_SHOOT},t.prototype.isShootingState=function(){return this.state==l.GameConst.GAME_STATE.SHOOTING},t.prototype.checkOnlineTime=function(){var e=d.Global.getOnlineTimestamp(),t=(new Date).getTime(),o=t-e;console.log("[WaitTime]","checkOnlineTime~ diff="+o),o>9e5&&(e=t,d.Global.saveOnlineTimestamp(e),this.showOnlienGift())},t.prototype.update=function(e){switch(this.state){case l.GameConst.GAME_STATE.REPRARE:break;case l.GameConst.GAME_STATE.WAIT_SHOOT:this.waitTime+=e,this.waitTime>60&&(this.waitTime=0,this.checkOnlineTime());break;case l.GameConst.GAME_STATE.SHOOTING:this.bubbleManager.propBubbleMoving(e);break;case l.GameConst.GAME_STATE.PAUSE:case l.GameConst.GAME_STATE.GAME_WIN:case l.GameConst.GAME_STATE.GAME_OVER:}},t.prototype.initLevel=function(e){var t=this;console.log("////////////////////////////////////-"),console.log("\u52a0\u8f7d\u5173\u5361\u6570\u636e-"),this.loadLevel(e).then(function(){console.log("\u5b8c\u6210\u52a0\u8f7d\u5173\u5361\u6570\u636e\uff01\uff01\uff01"),t.moveBubbleLayer(-1,1.5,!0),t.showGameStartTip(),c.Utils.isNextDay(d.Global.getLastSignTimestamp())&&t.showDaily()})},t.prototype.moveBubbleLayer=function(e,t,o){var n=this;void 0===o&&(o=!1);var a=this.levelData.bubble_list.length,i=h.default.getBubbleLayerHeight(a),r=l.GameConst.MID_SPACE_RATE*cc.visibleRect.height;d.Global.midSpace=r;var s=cc.visibleRect.height-(l.GameConst.BOTTOM_H+r),c=l.GameConst.TOP_H+i;this.moveOffsetY=c-s,this.moveOffsetY<0&&(this.moveOffsetY=0),1==e?this.levelLayer.setPosition(cc.v2(0,cc.visibleRect.height/2+c)):this.levelLayer.setPosition(cc.v2(0,-cc.visibleRect.height/2)),cc.tween(this.levelLayer).to(t,{position:cc.v3(0,this.moveOffsetY,0)},cc.easeSineOut()).call(function(){console.log("[lau]","moveBubbleLayer:"),n.bubbleManager.bubbleLayerMoveFinish=!0,o?n.ready():n.setGameState(l.GameConst.GAME_STATE.WAIT_SHOOT)}).start()},t.prototype.ready=function(){var e=this;this.scheduleOnce(function(){e.setGameState(l.GameConst.GAME_STATE.WAIT_SHOOT)},.5)},t.prototype.showDaily=function(){var e={mode:m.default.CacheMode.Once};m.default.show(y.default.path,null,e)},t.prototype.showGuide=function(e){var t={mode:m.default.CacheMode.Once},o={type:e};m.default.show(_.default.path,o,t)},t.prototype.showChestOver=function(){var e={mode:m.default.CacheMode.Once};m.default.show(L.default.path,null,e)},t.prototype.showChestList=function(){var e={mode:m.default.CacheMode.Once};m.default.show(N.default.path,null,e)},t.prototype.showChestOpen=function(){var e={mode:m.default.CacheMode.Once};m.default.show(O.default.path,null,e)},t.prototype.showChestReward=function(){var e={mode:m.default.CacheMode.Once};m.default.show(A.default.path,null,e)},t.prototype.addToChest=function(){var e=d.Global.getChestLevel();if(e<=3){var t=e-1;l.GameConst.CHEST_COUNT_CONFIG[t]<d.Global.curChestCount+1?console.log("[Chest]","chest count\u5df2\u7ecf\u6ee1~~="+d.Global.curChestCount):(d.Global.curChestCount++,console.log("[Chest]","add chest count="+d.Global.curChestCount))}},t.prototype.showGift=function(){var e={mode:m.default.CacheMode.Once};h.default.randNum(1,10)>2?m.default.show(G.default.path,null,e):m.default.show(S.default.path,null,e)},t.prototype.hideAddBubble=function(){this.add10Bubble.active=!1},t.prototype.showAddBubblePop=function(e,t){var o=Number(t),n={mode:m.default.CacheMode.Once},a={type:o};1==o&&(this.showOnecAddBubblePop=!0),m.default.show(C.default.path,a,n)},t.prototype.showAddBubble=function(e){var t=cc.instantiate(this.addBubblePerfab);this.node.addChild(t),t.getComponent(g.default).show(e)},t.prototype.showShop=function(){var e={mode:m.default.CacheMode.Once};m.default.show(P.default.path,null,e)},t.prototype.showOnlienGift=function(){var e={mode:m.default.CacheMode.Once};m.default.show(T.default.path,null,e)},t.prototype.loadLevel=function(e){return r(this,void 0,void 0,function(){var t;return s(this,function(o){switch(o.label){case 0:return[4,this.parseLevelInfo(e)];case 1:return t=o.sent(),console.log(t),this.levelListData=t.levellist,d.Global.levelListData=this.levelListData,this.setLevelData(e),[2]}})})},t.prototype.showLevelSelect=function(){var e=this;this.loadLevelSelectPrefab().then(function(t){var o=cc.instantiate(t);e.levelSelectLayer.addChild(o)})},t.prototype.loadLevelSelectPrefab=function(){return r(this,void 0,void 0,function(){var e;return s(this,function(t){switch(t.label){case 0:return e=l.GameConst.PATH.PREFAB+"LevelLayer",[4,this.load(e)];case 1:return[2,t.sent()]}})})},t.prototype.load=function(e){return new Promise(function(t){cc.resources.load(e,function(e,o){t(e?null:o)})})},t.prototype.createCurLevelData=function(e,t,o,n,a){return void 0===e&&(e=0),{bubble:e,score1:t,score2:o,score3:n,startbubble:a}},t.prototype.setLevelData=function(e){var t=this;if(this.levelListData){var o=this.levelListData.length;if(console.log("[Level]\u8bbe\u7f6e\u5173\u5361\u6570\u636e\uff1alevel="+e+"/"+o),e<1||e>o-1)return;d.Global.curChestCount=0,this.add10Bubble.active=!1,this.showOnecAddBubblePop=!1,this.updateLevel(),this.curStar=0,this.levelData=this.levelListData[e-1];var n=this.levelData.bubble_list,a=this.levelData.bubble,i=this.levelData.score1,r=this.levelData.score2,s=this.levelData.score3,c=250*i/s,p=250*r/s;this.star1.x=c-20,this.star2.x=p-20;var u=this.levelData.startbubble;this.curLevelData=this.createCurLevelData(a,i,r,s,u),d.Global.curLevelShootBubbleCount=a,this.updateCountUI(),this.updateScore(),this.updateProgressBar(),this.updateOpLayerUI();var b=n.length;this.bubbleManager.setStartbubble(this.curLevelData.startbubble),this.bubbleManager.resetData();for(var m=0;m<b;m++)for(var f=n[m].length,B=0;B<f;B++){var v=n[m][B];0!=v&&(100==v&&(v=h.default.randNum(l.GameConst.BUBBLE_TYPE.PINK,l.GameConst.BUBBLE_TYPE.RED)),v>=l.GameConst.BUBBLE_TYPE.PINK&&v<=l.GameConst.BUBBLE_TYPE.RED||v>=l.GameConst.BUBBLE_TYPE.IRON&&v<=l.GameConst.BUBBLE_TYPE.CLOUD||v==l.GameConst.BUBBLE_TYPE.RANDOM?this.bubbleManager.createBubbleComponentWithRowCol(v,this.bubbleLayer,m,B):(v=h.default.randNum(l.GameConst.BUBBLE_TYPE.PINK,l.GameConst.BUBBLE_TYPE.RED),this.bubbleManager.createBubbleComponentWithRowCol(v,this.bubbleLayer,m,B)))}11==e?d.Global.getGuideData(l.GameConst.GUIDE_TYPE.BUBBLE_IRON)!=l.GameConst.YES&&this.scheduleOnce(function(){t.showGuide(l.GameConst.GUIDE_TYPE.BUBBLE_IRON)},2):31==e?d.Global.getGuideData(l.GameConst.GUIDE_TYPE.BUBBLE_ICE)!=l.GameConst.YES&&this.scheduleOnce(function(){t.showGuide(l.GameConst.GUIDE_TYPE.BUBBLE_ICE)},2):71==e?d.Global.getGuideData(l.GameConst.GUIDE_TYPE.BUBBLE_BLACK_HOLE)!=l.GameConst.YES&&this.scheduleOnce(function(){t.showGuide(l.GameConst.GUIDE_TYPE.BUBBLE_BLACK_HOLE)},2):281==e&&d.Global.getGuideData(l.GameConst.GUIDE_TYPE.BUBBLE_CLOUD)!=l.GameConst.YES&&this.scheduleOnce(function(){t.showGuide(l.GameConst.GUIDE_TYPE.BUBBLE_CLOUD)},2)}},t.prototype.getIndex=function(){},t.prototype.parseLevelInfo=function(){return r(this,void 0,void 0,function(){var e;return s(this,function(t){switch(t.label){case 0:return e=l.GameConst.PATH.LEVEL+"level_data.json",console.log("////////////////////////////////////-"),console.log("\u89e3\u6790\u5173\u5361\u6570\u636e path= ",e),console.log("////////////////////////////////////-"),[4,c.Utils.loadJson(e)];case 1:return[2,t.sent()]}})})},i([M(cc.Node)],t.prototype,"levelLayer",void 0),i([M(cc.Node)],t.prototype,"bubbleLayer",void 0),i([M(cc.Node)],t.prototype,"opLayer",void 0),i([M(cc.Node)],t.prototype,"topLayer",void 0),i([M(cc.Node)],t.prototype,"effectlLayer",void 0),i([M(cc.Node)],t.prototype,"levelSelectLayer",void 0),i([M(u.default)],t.prototype,"bubbleManager",void 0),i([M(cc.Label)],t.prototype,"countLabel",void 0),i([M(b.default)],t.prototype,"aimLine",void 0),i([M(cc.Label)],t.prototype,"coinLabel",void 0),i([M(cc.Label)],t.prototype,"scoreLabel",void 0),i([M(cc.Label)],t.prototype,"levelLabel",void 0),i([M(cc.Node)],t.prototype,"coinFly",void 0),i([M(cc.Node)],t.prototype,"add10Bubble",void 0),i([M([cc.SpriteFrame])],t.prototype,"starSpriteFrame",void 0),i([M(cc.Node)],t.prototype,"star1",void 0),i([M(cc.Node)],t.prototype,"star2",void 0),i([M(cc.Node)],t.prototype,"star3",void 0),i([M(cc.ProgressBar)],t.prototype,"progressBar",void 0),i([M(cc.Node)],t.prototype,"propBombCoin",void 0),i([M(cc.Label)],t.prototype,"propBombCoinLabel",void 0),i([M(cc.Node)],t.prototype,"propBombCount",void 0),i([M(cc.Label)],t.prototype,"propBombCountLabel",void 0),i([M(cc.Node)],t.prototype,"propLaserCoin",void 0),i([M(cc.Label)],t.prototype,"propLaserCoinLabel",void 0),i([M(cc.Node)],t.prototype,"propLaserCount",void 0),i([M(cc.Label)],t.prototype,"propLaserCountLabel",void 0),i([M(cc.Node)],t.prototype,"propRainbowCoin",void 0),i([M(cc.Label)],t.prototype,"propRainbowLabel",void 0),i([M(cc.Node)],t.prototype,"propRainbowCount",void 0),i([M(cc.Label)],t.prototype,"propRainbowCountLabel",void 0),i([M(cc.Node)],t.prototype,"propLightningCoin",void 0),i([M(cc.Label)],t.prototype,"propLightningLabel",void 0),i([M(cc.Node)],t.prototype,"propLightningCount",void 0),i([M(cc.Label)],t.prototype,"propLightningCountLabel",void 0),i([M(cc.Prefab)],t.prototype,"gameStartTipPerfab",void 0),i([M(cc.Prefab)],t.prototype,"addBubblePerfab",void 0),i([I],t)}(cc.Component);o.default=D,cc._RF.pop()},{"../common/EventManager":"EventManager","../common/PopupManager":"PopupManager","../common/Utils":"Utils","./AddBubble":"AddBubble","./EffectGameStartTip":"EffectGameStartTip","./GameConst":"GameConst","./Global":"Global","./Sound":"Sound","./bubble/AimLine":"AimLine","./bubble/BubbleManager":"BubbleManager","./bubble/BubbleUtil":"BubbleUtil","./pop/PopAddBubble":"PopAddBubble","./pop/PopChestList":"PopChestList","./pop/PopChestOpen":"PopChestOpen","./pop/PopChestOver":"PopChestOver","./pop/PopChestReward":"PopChestReward","./pop/PopCoinGift":"PopCoinGift","./pop/PopDaily":"PopDaily","./pop/PopFail":"PopFail","./pop/PopGuide":"PopGuide","./pop/PopOnlineGift":"PopOnlineGift","./pop/PopPause":"PopPause","./pop/PopRandomGift":"PopRandomGift","./pop/PopShop":"PopShop"}],Global:[function(e,t,o){"use strict";cc._RF.push(t,"d4b22ACghlIybEHvmQPssx6","Global"),Object.defineProperty(o,"__esModule",{value:!0}),o.Global=void 0;var n=e("../common/Utils"),a=e("./GameConst"),i=function(){function e(){}return e.saveData=function(e,t){cc.sys.localStorage.setItem(e,Number(t))},e.getData=function(e){return cc.sys.localStorage.getItem(e)?Number(cc.sys.localStorage.getItem(e)):0},e.saveStringData=function(e,t){cc.sys.localStorage.setItem(e,t)},e.getStringData=function(e){return cc.sys.localStorage.getItem(e)?cc.sys.localStorage.getItem(e):""},e.gameInit=function(){console.log("[Data]","===================="),console.log("[gameInit]init!!");var t=e.getStringData(a.GameConst.DATA_KEY.UUID);console.log("[Data]","uuid:"+t),t||(t=n.Utils.uuid(),e.saveStringData(a.GameConst.DATA_KEY.UUID,t),console.log("[Data]","save uuid:"+t),e.saveCoin(0),e.saveLevel(1),e.savePropData(a.GameConst.PROP_BUBBLE_TYPE.BOMB,1),e.savePropData(a.GameConst.PROP_BUBBLE_TYPE.LASER,1),e.savePropData(a.GameConst.PROP_BUBBLE_TYPE.RAINBOW,1),e.savePropData(a.GameConst.PROP_BUBBLE_TYPE.LIGHTNING,1),e.debug&&e.saveCoin(100));var o=e.getSignTime(),i=e.getFirstSignTimestamp();i<=0?(i=(new Date).getTime(),o=0,e.saveSignTime(o),e.saveFirstSignTimestamp(i)):n.Utils.isGreaterDays(i,7)&&(i=(new Date).getTime(),o=0,e.saveSignTime(o),e.saveFirstSignTimestamp(i));var r=e.getGetFreeCoinTimestamp();n.Utils.isNextDay(r)&&(e.saveGetFreeCoinTime(0),r=(new Date).getTime(),e.saveGetFreeCoinTimestamp(r),e.saveChestLevel(1),e.saveChestCount(0));var s=e.getOnlineTimestamp(),c=(new Date).getTime();c-s>9e5&&(s=c,e.saveOnlineTimestamp(s)),console.log("[Data]","====================");var l=null;if(cc.sys.localStorage.getItem(a.GameConst.DATA_KEY.LEVEL_STAR)&&(l=String(cc.sys.localStorage.getItem(a.GameConst.DATA_KEY.LEVEL_STAR)),console.log("levelStar:"),console.log(l),null!=l&&null!=l&&""!=l)){var p=JSON.parse(l||"[]");null==p.length&&(l=null),console.log(" levelStar saveLevelStarArray="+p)}if(null==l||null==l||""==l){var u=JSON.stringify([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);console.log("[gameInit]init  saveLevelStarStr="+u),cc.sys.localStorage.setItem(a.GameConst.DATA_KEY.LEVEL_STAR,u)}console.log("[Data]","====================")},e.getLevelStar=function(){var e=JSON.parse(cc.sys.localStorage.getItem(a.GameConst.DATA_KEY.LEVEL_STAR));return console.log("[LevelStar]getLevelStarArray="),console.log(e),e},e.saveLevelStar=function(e,t){var o=e-1,n=null,i=cc.sys.localStorage.getItem(a.GameConst.DATA_KEY.LEVEL_STAR);if(i){var r=JSON.parse(i);null==r.length&&(i=null),null!=i&&null!=i&&(n=r)}if(n||(n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),!(o<0||o>=n.length)){n[o]<t&&(n[o]=t);var s=JSON.stringify(n);console.log("[LevelStar]saveLevelStarStr="+s),cc.sys.localStorage.setItem(a.GameConst.DATA_KEY.LEVEL_STAR,s)}},e.saveLevel=function(t){cc.sys.localStorage.setItem(a.GameConst.DATA_KEY.CUR_LEVEL,Number(t)),console.log("[Data]","save level:"+t),t>e.currentLevel&&(e.currentLevel=t)},e.getLevel=function(){var e=1;return cc.sys.localStorage.getItem(a.GameConst.DATA_KEY.CUR_LEVEL)&&(e=Number(cc.sys.localStorage.getItem(a.GameConst.DATA_KEY.CUR_LEVEL))),console.log("[Data]","get level:"+e),e},e.addCoin=function(e){var t=0;cc.sys.localStorage.getItem(a.GameConst.DATA_KEY.COIN)&&(t=Number(cc.sys.localStorage.getItem(a.GameConst.DATA_KEY.COIN))),t+=e,cc.sys.localStorage.setItem(a.GameConst.DATA_KEY.COIN,Number(t)),console.log("[Data]","add coin:"+e)},e.saveCoin=function(e){cc.sys.localStorage.setItem(a.GameConst.DATA_KEY.COIN,Number(e)),console.log("[Data]","save coin:"+e)},e.getCoin=function(){var e=0;return cc.sys.localStorage.getItem(a.GameConst.DATA_KEY.COIN)&&(e=Number(cc.sys.localStorage.getItem(a.GameConst.DATA_KEY.COIN))),console.log("[Data]","get coin:"+e),e},e.addPropData=function(e,t){var o="",n=0;switch(e){case a.GameConst.PROP_BUBBLE_TYPE.BOMB:o=a.GameConst.DATA_KEY.PROP_BOMB;break;case a.GameConst.PROP_BUBBLE_TYPE.LASER:o=a.GameConst.DATA_KEY.PROP_LASER;break;case a.GameConst.PROP_BUBBLE_TYPE.RAINBOW:o=a.GameConst.DATA_KEY.PROP_RAINBOW;break;case a.GameConst.PROP_BUBBLE_TYPE.LIGHTNING:o=a.GameConst.DATA_KEY.PROP_LIGHTNING}o&&(cc.sys.localStorage.getItem(o)&&(n=Number(cc.sys.localStorage.getItem(o)),console.log("[Data]","get prop:"+o+",count:"+n)),n+=t,console.log("[Data]","add prop:"+o+",value:"+t),cc.sys.localStorage.setItem(o,Number(n)))},e.savePropData=function(e,t){var o="";switch(e){case a.GameConst.PROP_BUBBLE_TYPE.BOMB:o=a.GameConst.DATA_KEY.PROP_BOMB;break;case a.GameConst.PROP_BUBBLE_TYPE.LASER:o=a.GameConst.DATA_KEY.PROP_LASER;break;case a.GameConst.PROP_BUBBLE_TYPE.RAINBOW:o=a.GameConst.DATA_KEY.PROP_RAINBOW;break;case a.GameConst.PROP_BUBBLE_TYPE.LIGHTNING:o=a.GameConst.DATA_KEY.PROP_LIGHTNING}o&&(console.log("[Data]","save prop:"+o+",value:"+t),cc.sys.localStorage.setItem(o,Number(t)))},e.getPropData=function(e){var t="",o=0;switch(e){case a.GameConst.PROP_BUBBLE_TYPE.BOMB:t=a.GameConst.DATA_KEY.PROP_BOMB;break;case a.GameConst.PROP_BUBBLE_TYPE.LASER:t=a.GameConst.DATA_KEY.PROP_LASER;break;case a.GameConst.PROP_BUBBLE_TYPE.RAINBOW:t=a.GameConst.DATA_KEY.PROP_RAINBOW;break;case a.GameConst.PROP_BUBBLE_TYPE.LIGHTNING:t=a.GameConst.DATA_KEY.PROP_LIGHTNING}return t&&cc.sys.localStorage.getItem(t)&&(o=Number(cc.sys.localStorage.getItem(t)),console.log("[Data]","get prop:"+t+",count:"+o)),o},e.saveGuideData=function(e,t){var o="";switch(e){case a.GameConst.GUIDE_TYPE.BUBBLE_IRON:o=a.GameConst.DATA_KEY.GUIDE_IRON;break;case a.GameConst.GUIDE_TYPE.PROP_RAINBOW:o=a.GameConst.DATA_KEY.GUIDE_PROP_RAINBOW;break;case a.GameConst.GUIDE_TYPE.PROP_LIGHTNING:o=a.GameConst.DATA_KEY.GUIDE_PROP_LIGHTNING;break;case a.GameConst.GUIDE_TYPE.BUBBLE_ICE:o=a.GameConst.DATA_KEY.GUIDE_ICE;break;case a.GameConst.GUIDE_TYPE.BUBBLE_BLACK_HOLE:o=a.GameConst.DATA_KEY.GUIDE_BLACK_HOLE;break;case a.GameConst.GUIDE_TYPE.BUBBLE_CLOUD:o=a.GameConst.DATA_KEY.GUIDE_CLOUD}o&&(console.log("[Data]","save guide:"+o+",value:"+t),cc.sys.localStorage.setItem(o,Number(t)))},e.getGuideData=function(e){var t="",o=0;switch(e){case a.GameConst.GUIDE_TYPE.BUBBLE_IRON:t=a.GameConst.DATA_KEY.GUIDE_IRON;break;case a.GameConst.GUIDE_TYPE.PROP_RAINBOW:t=a.GameConst.DATA_KEY.GUIDE_PROP_RAINBOW;break;case a.GameConst.GUIDE_TYPE.PROP_LIGHTNING:t=a.GameConst.DATA_KEY.GUIDE_PROP_LIGHTNING;break;case a.GameConst.GUIDE_TYPE.BUBBLE_ICE:t=a.GameConst.DATA_KEY.GUIDE_ICE;break;case a.GameConst.GUIDE_TYPE.BUBBLE_BLACK_HOLE:t=a.GameConst.DATA_KEY.GUIDE_BLACK_HOLE;break;case a.GameConst.GUIDE_TYPE.BUBBLE_CLOUD:t=a.GameConst.DATA_KEY.GUIDE_CLOUD}return t&&cc.sys.localStorage.getItem(t)&&(o=Number(cc.sys.localStorage.getItem(t)),console.log("[Data]","get prop:"+t+",show:"+o)),o},e.getSoundMusic=function(){var e=a.GameConst.YES;return cc.sys.localStorage.getItem(a.GameConst.DATA_KEY.SOUND_MUSIC)&&(e=Number(cc.sys.localStorage.getItem(a.GameConst.DATA_KEY.SOUND_MUSIC))),console.log("[Data]","getSoundMusic:"+e),e},e.getShake=function(){var e=a.GameConst.YES;return cc.sys.localStorage.getItem(a.GameConst.DATA_KEY.SHAKE)&&(e=Number(cc.sys.localStorage.getItem(a.GameConst.DATA_KEY.SHAKE))),console.log("[Data]","getShake:"+e),e},e.switchSoundMusic=function(){var e=a.GameConst.YES;return cc.sys.localStorage.getItem(a.GameConst.DATA_KEY.SOUND_MUSIC)&&(e=Number(cc.sys.localStorage.getItem(a.GameConst.DATA_KEY.SOUND_MUSIC))),e=e==a.GameConst.YES?a.GameConst.NO:a.GameConst.YES,cc.sys.localStorage.setItem(a.GameConst.DATA_KEY.SOUND_MUSIC,Number(e)),console.log("[Data]","switchSoundMusic:"+e),e},e.switchShake=function(){var e=a.GameConst.YES;return cc.sys.localStorage.getItem(a.GameConst.DATA_KEY.SHAKE)&&(e=Number(cc.sys.localStorage.getItem(a.GameConst.DATA_KEY.SHAKE))),e=e==a.GameConst.YES?a.GameConst.NO:a.GameConst.YES,cc.sys.localStorage.setItem(a.GameConst.DATA_KEY.SHAKE,Number(e)),console.log("[Data]","switchShake:"+e),e},e.saveFirstSignTimestamp=function(e){cc.sys.localStorage.setItem(a.GameConst.DATA_KEY.FIRST_SIGN_TIMESTAMP,Number(e)),console.log("[Data]","save FirstSignTimestamp:"+e)},e.getFirstSignTimestamp=function(){var e=0;return cc.sys.localStorage.getItem(a.GameConst.DATA_KEY.FIRST_SIGN_TIMESTAMP)&&(e=Number(cc.sys.localStorage.getItem(a.GameConst.DATA_KEY.FIRST_SIGN_TIMESTAMP))),console.log("[Data]","get FirstSignTimestamp:"+e),e},e.saveLastSignTimestamp=function(e){cc.sys.localStorage.setItem(a.GameConst.DATA_KEY.LAST_SIGN_TIMESTAMP,Number(e)),console.log("[Data]","save LastSignTimestamp:"+e)},e.getLastSignTimestamp=function(){var e=0;return cc.sys.localStorage.getItem(a.GameConst.DATA_KEY.LAST_SIGN_TIMESTAMP)&&(e=Number(cc.sys.localStorage.getItem(a.GameConst.DATA_KEY.LAST_SIGN_TIMESTAMP))),console.log("[Data]","get LastSignTimestamp:"+e),e},e.saveSignTime=function(e){cc.sys.localStorage.setItem(a.GameConst.DATA_KEY.SIGNED_TIME,Number(e)),console.log("[Data]","save SignTime:"+e)},e.getSignTime=function(){var e=0;return cc.sys.localStorage.getItem(a.GameConst.DATA_KEY.SIGNED_TIME)&&(e=Number(cc.sys.localStorage.getItem(a.GameConst.DATA_KEY.SIGNED_TIME))),console.log("[Data]","get SignTime:"+e),e},e.saveGetFreeCoinTime=function(e){cc.sys.localStorage.setItem(a.GameConst.DATA_KEY.GET_FREE_COIN_TIME,Number(e)),console.log("[Data]","save GetFreeCoinTime:"+e)},e.getGetFreeCoinTime=function(){var e=0;return cc.sys.localStorage.getItem(a.GameConst.DATA_KEY.GET_FREE_COIN_TIME)&&(e=Number(cc.sys.localStorage.getItem(a.GameConst.DATA_KEY.GET_FREE_COIN_TIME))),console.log("[Data]","get GetFreeCoinTime:"+e),e},e.saveGetFreeCoinTimestamp=function(e){cc.sys.localStorage.setItem(a.GameConst.DATA_KEY.GET_FREE_COIN_TIMESTAMP,Number(e)),console.log("[Data]","save GetFreeCoinTimestamp:"+e)},e.getGetFreeCoinTimestamp=function(){var e=0;return cc.sys.localStorage.getItem(a.GameConst.DATA_KEY.GET_FREE_COIN_TIMESTAMP)&&(e=Number(cc.sys.localStorage.getItem(a.GameConst.DATA_KEY.GET_FREE_COIN_TIMESTAMP))),console.log("[Data]","get GetFreeCoinTimestamp:"+e),e},e.saveOnlineTimestamp=function(e){cc.sys.localStorage.setItem(a.GameConst.DATA_KEY.ONLINE_TIMESTAMP,Number(e)),console.log("[Data]","save OnlineTimestamp:"+e)},e.getOnlineTimestamp=function(){var e=0;return cc.sys.localStorage.getItem(a.GameConst.DATA_KEY.ONLINE_TIMESTAMP)&&(e=Number(cc.sys.localStorage.getItem(a.GameConst.DATA_KEY.ONLINE_TIMESTAMP))),console.log("[Data]","get OnlineTimestamp:"+e),e},e.saveChestStartTimestamp=function(e){cc.sys.localStorage.setItem(a.GameConst.DATA_KEY.CHEST_START_TIMESTAMP,Number(e)),console.log("[Data]","save ChestStartTimestamp:"+e)},e.getChestStartTimestamp=function(){var e=0;return cc.sys.localStorage.getItem(a.GameConst.DATA_KEY.CHEST_START_TIMESTAMP)&&(e=Number(cc.sys.localStorage.getItem(a.GameConst.DATA_KEY.CHEST_START_TIMESTAMP))),console.log("[Data]","get ChestStartTimestamp:"+e),e},e.saveChestLevel=function(e){cc.sys.localStorage.setItem(a.GameConst.DATA_KEY.CHEST_LEVEL,Number(e)),console.log("[Data]","save ChestLevel:"+e)},e.getChestLevel=function(){var e=1;return cc.sys.localStorage.getItem(a.GameConst.DATA_KEY.CHEST_LEVEL)&&(e=Number(cc.sys.localStorage.getItem(a.GameConst.DATA_KEY.CHEST_LEVEL))),console.log("[Data]","get ChestLevel:"+e),e},e.saveChestCount=function(e){cc.sys.localStorage.setItem(a.GameConst.DATA_KEY.CHEST_COUNT,Number(e)),console.log("[Data]","save ChestCount:"+e)},e.getChestCount=function(){var e=0;return cc.sys.localStorage.getItem(a.GameConst.DATA_KEY.CHEST_COUNT)&&(e=Number(cc.sys.localStorage.getItem(a.GameConst.DATA_KEY.CHEST_COUNT))),console.log("[Data]","get ChestCount:"+e),e},e.currentLevel=1,e.testCount=0,e.gameState=-1,e.invertControls=1,e.debug=!0,e.midSpace=0,e.comboScore=10,e.curGameScore=0,e.curLevelShootBubbleCount=10,e.curChestCount=0,e}();o.Global=i,cc._RF.pop()},{"../common/Utils":"Utils","./GameConst":"GameConst"}],LevelData:[function(e,t,o){"use strict";cc._RF.push(t,"c407akSl5VCdandT6ce9hkE","LevelData"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],Level:[function(e,t,o){"use strict";cc._RF.push(t,"eb543MrOQNINZ1EEjMnbLW2","Level");var n,a=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var a,i=arguments.length,r=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(i<3?a(r):i>3?a(t,o,r):a(t,o))||r);return i>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../common/EventManager"),s=e("../common/PopupManager"),c=e("./GameConst"),l=e("./Global"),p=e("./pop/PopLevelSelect"),u=cc._decorator,h=u.ccclass,b=u.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.chestNode=null,t.signNode=null,t.coinNode=null,t.levelLabel=null,t.coinLabel=null,t.hide=!1,t}return a(t,e),t.prototype.onEnable=function(){r.EventManager.getInstance().addEvent(c.GameConst.EVENT.LEVEL_SELECT,this.toLevel,this),r.EventManager.getInstance().addEvent(c.GameConst.EVENT.START_NEW_LEVEL,this.startNewLevel,this),r.EventManager.getInstance().addEvent(c.GameConst.EVENT.LIST_SCROLL,this.listScroll,this),r.EventManager.getInstance().addEvent(c.GameConst.EVENT.LIST_SCROLL_END,this.listScrollEnd,this)},t.prototype.onDisable=function(){r.EventManager.getInstance().removeEvent(c.GameConst.EVENT.LEVEL_SELECT,this.toLevel,this),r.EventManager.getInstance().removeEvent(c.GameConst.EVENT.START_NEW_LEVEL,this.startNewLevel,this),r.EventManager.getInstance().removeEvent(c.GameConst.EVENT.LIST_SCROLL,this.listScroll,this),r.EventManager.getInstance().removeEvent(c.GameConst.EVENT.LIST_SCROLL_END,this.listScrollEnd,this)},t.prototype.startNewLevel=function(e,t){var o=this;void 0===t&&(t=0),e>0&&(t>0?this.scheduleOnce(function(){r.EventManager.getInstance().sendEvent(c.GameConst.EVENT.GAME_RESTART,e),o.node.removeFromParent(),o.scheduleOnce(function(){o.node.destroy()},1)},t):(r.EventManager.getInstance().sendEvent(c.GameConst.EVENT.GAME_RESTART,e),this.node.removeFromParent(),this.scheduleOnce(function(){o.node.destroy()},1)))},t.prototype.toLevel=function(e,t,o){var n={mode:s.default.CacheMode.Once},a={level:e,star:t,num:o};s.default.show(p.default.path,a,n)},t.prototype.toCurLevel=function(){this.startNewLevel(l.Global.currentLevel)},t.prototype.onLoad=function(){this.levelLabel.string=l.Global.currentLevel+"";var e=l.Global.getCoin();this.coinLabel.string=e+"",this.chestNodePosOrg=this.chestNode.getPosition(),this.signNodePosOrg=this.signNode.getPosition(),this.coinNodePosOrg=this.coinNode.getPosition()},t.prototype.listScroll=function(){console.log("[Level]","listScroll~~~~~"),this.hide||(this.hide=!0,this.chestNode.stopAllActions(),cc.tween(this.chestNode).to(.3,{position:cc.v3(this.chestNodePosOrg.x+200,this.chestNodePosOrg.y,0)}).start(),this.signNode.stopAllActions(),cc.tween(this.signNode).to(.3,{position:cc.v3(this.signNodePosOrg.x+200,this.signNodePosOrg.y,0)}).start(),this.coinNode.stopAllActions(),cc.tween(this.coinNode).to(.3,{position:cc.v3(this.coinNodePosOrg.x-200,this.coinNodePosOrg.y,0)}).start())},t.prototype.listScrollEnd=function(){this.hide&&(this.hide=!1,console.log("[Level]","listScrollEnd~~~~~"),this.chestNode.stopAllActions(),cc.tween(this.chestNode).to(.3,{position:cc.v3(this.chestNodePosOrg.x,this.chestNodePosOrg.y,0)}).start(),this.signNode.stopAllActions(),cc.tween(this.signNode).to(.3,{position:cc.v3(this.signNodePosOrg.x,this.signNodePosOrg.y,0)}).start(),this.coinNode.stopAllActions(),cc.tween(this.coinNode).to(.3,{position:cc.v3(this.coinNodePosOrg.x,this.coinNodePosOrg.y,0)}).start())},t.prototype.showChest=function(){r.EventManager.getInstance().sendEvent(c.GameConst.EVENT.SHOW_CHEST_LIST)},t.prototype.showSign=function(){r.EventManager.getInstance().sendEvent(c.GameConst.EVENT.SHOW_DAILY)},t.prototype.watchVideo=function(){console.log("[AD]","\u770b\u5b8c\u89c6\u9891\u83b7\u53d6\u5956\u52b1~~~~~")},t.prototype.start=function(){},i([b(cc.Node)],t.prototype,"chestNode",void 0),i([b(cc.Node)],t.prototype,"signNode",void 0),i([b(cc.Node)],t.prototype,"coinNode",void 0),i([b(cc.Label)],t.prototype,"levelLabel",void 0),i([b(cc.Label)],t.prototype,"coinLabel",void 0),i([h],t)}(cc.Component);o.default=d,cc._RF.pop()},{"../common/EventManager":"EventManager","../common/PopupManager":"PopupManager","./GameConst":"GameConst","./Global":"Global","./pop/PopLevelSelect":"PopLevelSelect"}],ListViewItem:[function(e,t,o){"use strict";cc._RF.push(t,"c761a2z/+5PSrrgH0NnolcH","ListViewItem");var n,a=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var a,i=arguments.length,r=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(i<3?a(r):i>3?a(t,o,r):a(t,o))||r);return i>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../common/EventManager"),s=e("./GameConst"),c=e("./Global"),l=cc._decorator,p=l.ccclass,u=l.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bubbleSpriteFrame=[],t.startSpriteFrame=[],t.route0=null,t.roundNow1=null,t.lamp1=null,t.starCount1=null,t.start1=null,t.roundNow2=null,t.lamp2=null,t.starCount2=null,t.start2=null,t.roundNow3=null,t.lamp3=null,t.starCount3=null,t.start3=null,t.roundNow4=null,t.lamp4=null,t.starCount4=null,t.start4=null,t.roundNow5=null,t.lamp5=null,t.starCount5=null,t.start5=null,t.roundNow6=null,t.lamp6=null,t.starCount6=null,t.start6=null,t.itemID=0,t.itemId=0,t}return a(t,e),t.prototype.updateItem=function(e,t){this.itemID=e,this.data=t,this.dataChanged()},t.prototype.dataChanged=function(){this.itemID>0?this.route0.active=!0:this.route0.active=!1,this.node.zIndex=1e3-this.itemID;var e=this.data[5],t=this.data[4],o=this.data[3],n=this.data[2],a=this.data[1],i=this.data[0];if(e){var r=e.level,s=e.star;if(this.starCount1.string=r+"",this.start1.spriteFrame=this.startSpriteFrame[s],c.Global.currentLevel==r)this.roundNow1.active=!0,this.anim1.resume();else{if(this.roundNow1.active=!1,c.Global.currentLevel<r)this.lamp1.spriteFrame=this.bubbleSpriteFrame[0];else{var l=Math.floor(r/21)%6+1;this.lamp1.spriteFrame=this.bubbleSpriteFrame[l]}this.anim1.pause()}}if(t){var p=t.level,u=t.star;this.starCount2.string=p+"",this.start2.spriteFrame=this.startSpriteFrame[u],c.Global.currentLevel==p?(this.roundNow2.active=!0,this.anim2.resume()):(this.roundNow2.active=!1,c.Global.currentLevel<p?this.lamp2.spriteFrame=this.bubbleSpriteFrame[0]:(l=Math.floor(p/21)%6+1,this.lamp2.spriteFrame=this.bubbleSpriteFrame[l]),this.anim2.pause())}if(o){var h=o.level,b=o.star;this.starCount3.string=h+"",this.start3.spriteFrame=this.startSpriteFrame[b],c.Global.currentLevel==h?(this.roundNow3.active=!0,this.anim3.resume()):(this.roundNow3.active=!1,c.Global.currentLevel<h?this.lamp3.spriteFrame=this.bubbleSpriteFrame[0]:(l=Math.floor(h/21)%6+1,this.lamp3.spriteFrame=this.bubbleSpriteFrame[l]),this.anim3.pause())}if(n){var d=n.level,m=n.star;this.starCount4.string=d+"",this.start4.spriteFrame=this.startSpriteFrame[m],c.Global.currentLevel==d?(this.roundNow4.active=!0,this.anim4.resume()):(this.roundNow4.active=!1,c.Global.currentLevel<d?this.lamp4.spriteFrame=this.bubbleSpriteFrame[0]:(l=Math.floor(d/21)%6+1,this.lamp4.spriteFrame=this.bubbleSpriteFrame[l]),this.anim4.pause())}if(a){var f=a.level,B=a.star;this.starCount5.string=f+"",this.start5.spriteFrame=this.startSpriteFrame[B],c.Global.currentLevel==f?(this.roundNow5.active=!0,this.anim5.resume()):(this.roundNow5.active=!1,c.Global.currentLevel<f?this.lamp5.spriteFrame=this.bubbleSpriteFrame[0]:(l=Math.floor(f/21)%6+1,this.lamp5.spriteFrame=this.bubbleSpriteFrame[l]),this.anim5.pause())}if(i){var v=i.level,E=i.star;this.starCount6.string=v+"",this.start6.spriteFrame=this.startSpriteFrame[E],c.Global.currentLevel==v?(this.roundNow6.active=!0,this.anim6.resume()):(this.roundNow6.active=!1,c.Global.currentLevel<v?this.lamp6.spriteFrame=this.bubbleSpriteFrame[0]:(l=Math.floor(v/21)%6+1,this.lamp6.spriteFrame=this.bubbleSpriteFrame[l]),this.anim6.pause())}},t.prototype.onLoad=function(){this.anim1=this.roundNow1.getComponent(cc.Animation),this.anim2=this.roundNow2.getComponent(cc.Animation),this.anim3=this.roundNow3.getComponent(cc.Animation),this.anim4=this.roundNow4.getComponent(cc.Animation),this.anim5=this.roundNow5.getComponent(cc.Animation),this.anim6=this.roundNow6.getComponent(cc.Animation)},t.prototype.select=function(e,t){var o=Number(t),n=this.data[o];if(n){var a=n.level,i=n.star,l=n.num;console.log("[List]","index="+o+",level="+a+",num="+l),a<c.Global.currentLevel&&r.EventManager.getInstance().sendEvent(s.GameConst.EVENT.LEVEL_SELECT,a,i,l)}},t.prototype.initData=function(e,t){this.itemId=e,this.init(e,t)},t.prototype.init=function(){},i([u([cc.SpriteFrame])],t.prototype,"bubbleSpriteFrame",void 0),i([u([cc.SpriteFrame])],t.prototype,"startSpriteFrame",void 0),i([u(cc.Node)],t.prototype,"route0",void 0),i([u(cc.Node)],t.prototype,"roundNow1",void 0),i([u(cc.Sprite)],t.prototype,"lamp1",void 0),i([u(cc.Label)],t.prototype,"starCount1",void 0),i([u(cc.Sprite)],t.prototype,"start1",void 0),i([u(cc.Node)],t.prototype,"roundNow2",void 0),i([u(cc.Sprite)],t.prototype,"lamp2",void 0),i([u(cc.Label)],t.prototype,"starCount2",void 0),i([u(cc.Sprite)],t.prototype,"start2",void 0),i([u(cc.Node)],t.prototype,"roundNow3",void 0),i([u(cc.Sprite)],t.prototype,"lamp3",void 0),i([u(cc.Label)],t.prototype,"starCount3",void 0),i([u(cc.Sprite)],t.prototype,"start3",void 0),i([u(cc.Node)],t.prototype,"roundNow4",void 0),i([u(cc.Sprite)],t.prototype,"lamp4",void 0),i([u(cc.Label)],t.prototype,"starCount4",void 0),i([u(cc.Sprite)],t.prototype,"start4",void 0),i([u(cc.Node)],t.prototype,"roundNow5",void 0),i([u(cc.Sprite)],t.prototype,"lamp5",void 0),i([u(cc.Label)],t.prototype,"starCount5",void 0),i([u(cc.Sprite)],t.prototype,"start5",void 0),i([u(cc.Node)],t.prototype,"roundNow6",void 0),i([u(cc.Sprite)],t.prototype,"lamp6",void 0),i([u(cc.Label)],t.prototype,"starCount6",void 0),i([u(cc.Sprite)],t.prototype,"start6",void 0),i([p],t)}(cc.Component);o.default=h,cc._RF.pop()},{"../common/EventManager":"EventManager","./GameConst":"GameConst","./Global":"Global"}],ListView:[function(e,t,o){"use strict";cc._RF.push(t,"69f8eOMFclEJrtqMT8Mrg+A","ListView");var n,a=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var a,i=arguments.length,r=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(i<3?a(r):i>3?a(t,o,r):a(t,o))||r);return i>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../common/EventManager"),s=e("./GameConst"),c=e("./Global"),l=e("./ListViewItem"),p=cc._decorator,u=p.ccclass,h=p.property,b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.item=null,t.scrollView=null,t.spacing=0,t.spawnCount=0,t.bufferZone=0,t.totalCount=0,t.content=null,t.items=[],t.updateTimer=0,t.updateInterval=0,t.lastContentPosY=0,t.itemDataList=[],t.itemHeight=0,t}return a(t,e),t.prototype.onLoad=function(){this.content=this.scrollView.content,this.items=[],this.updateTimer=0,this.updateInterval=.1,this.lastContentPosY=0,this.itemHeight=400,this.content.removeAllChildren(),this.spawnCount=Math.round(this.scrollView.node.height/(this.itemHeight+this.spacing))+2,this.bufferZone=this.scrollView.node.height/2+this.itemHeight/2+this.spacing,this.enabled=!1,this.scrollView.enabled=!1;for(var e=[],t=[],o=c.Global.getLevelStar(),n=(c.Global.levelListData.length,6*Math.ceil(s.GameConst.TOTAL_LEVE/6)-1);n>=0;n--){var a=30,i=c.Global.levelListData[n];i&&(a=i.bubble);var r={level:n+1,star:o[n],num:a};t.push(r),n%6==0&&(e.push(t),t=[])}this.setData(e),this.scrollView.node.on("scroll-began",this.scroll,this),this.scrollView.node.on("scroll-ended",this.scrollEnd,this)},t.prototype.scroll=function(){r.EventManager.getInstance().sendEvent(s.GameConst.EVENT.LIST_SCROLL)},t.prototype.scrollEnd=function(){r.EventManager.getInstance().sendEvent(s.GameConst.EVENT.LIST_SCROLL_END)},t.prototype.setData=function(e){this.itemDataList=e.slice(),this.totalCount=this.itemDataList.length,this.createItem(),this.enabled=!0,this.scrollView.enabled=!0;var t=Math.floor((s.GameConst.TOTAL_LEVE-c.Global.currentLevel)/6)*this.itemHeight-this.itemHeight;console.log("[Level][OF]","offsetY1="+t),t<0&&(t=0);var o=cc.v2(0,t);console.log("[Level][OF]","offsetY2="+t),this.scrollToFixedPosition(o)},t.prototype.createItem=function(){this.content.height=this.totalCount*(this.itemHeight+this.spacing)+this.spacing,this.clearAllItem();for(var e=this.totalCount<this.spawnCount?this.totalCount:this.spawnCount,t=0;t<e;t++){var o=cc.instantiate(this.item);this.content.addChild(o),o.setPosition(0,-o.height*(.5+t)-this.spacing*(t+1)),o.getComponent(l.default).updateItem(t,this.itemDataList[t]),this.items.push(o)}},t.prototype.clearAllItem=function(){for(var e=0,t=this.items.length;e<t;e++)this.items[e].destroy();this.items.length=0},t.prototype.getPositionInView=function(e){var t=e.parent.convertToWorldSpaceAR(e.position);return this.scrollView.node.convertToNodeSpaceAR(t)},t.prototype.update=function(e){if(this.updateTimer+=e,!(this.updateTimer<this.updateInterval)){this.updateTimer=0;for(var t=this.items,o=this.bufferZone,n=this.scrollView.content.y<this.lastContentPosY,a=(this.itemHeight+this.spacing)*t.length,i=0;i<t.length;++i){var r=this.getPositionInView(t[i]);if(n){if(r.y<-o&&t[i].y+a<0){console.log("[List]","isDown"),t[i].y=t[i].y+a;var s=(c=t[i].getComponent(l.default)).itemID-t.length;c.updateItem(s,this.itemDataList[s])}}else if(r.y>o&&t[i].y-a>-this.content.height){var c;console.log("[List]","isUp"),t[i].y=t[i].y-a,s=(c=t[i].getComponent(l.default)).itemID+t.length,c.updateItem(s,this.itemDataList[s])}}this.lastContentPosY=this.scrollView.content.y}},t.prototype.scrollToFixedPosition=function(e){this.scrollView.scrollToOffset(e,1)},t.prototype.onDestroy=function(){},i([h(cc.Prefab)],t.prototype,"item",void 0),i([h(cc.ScrollView)],t.prototype,"scrollView",void 0),i([h(cc.Integer)],t.prototype,"spacing",void 0),i([u],t)}(cc.Component);o.default=b,cc._RF.pop()},{"../common/EventManager":"EventManager","./GameConst":"GameConst","./Global":"Global","./ListViewItem":"ListViewItem"}],NodeAction:[function(e,t,o){"use strict";cc._RF.push(t,"ab451Pt5/xIy5bRIdSw+E68","NodeAction");var n,a=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var a,i=arguments.length,r=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(i<3?a(r):i>3?a(t,o,r):a(t,o))||r);return i>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,s=r.ccclass,c=r.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=0,t.delay=0,t}return a(t,e),t.prototype.start=function(){switch(this.type){case 0:this.doBlink();break;case 1:this.doShake();break;case 2:this.doRateAndFade();break;case 3:this.doRate();break;case 4:this.doFlex()}},t.prototype.doFlex=function(){this.node&&(this.node.stopAllActions(),cc.tween(this.node).repeatForever(cc.tween(this.node).delay(1.5).to(.3,{scaleY:.6,scaleX:1.1,position:cc.v3(0,-16,0)}).to(.2,{scaleY:1.1,scaleX:.9,position:cc.v3(0,-21,0)}).to(.1,{scaleY:.9,scaleX:1.05,position:cc.v3(0,-16,0)}).to(.1,{scaleY:1,scaleX:.9,position:cc.v3(0,-21,0)}).to(.1,{scaleY:.9,scaleX:1.05,position:cc.v3(0,-16,0)}).to(.1,{scaleY:1,scaleX:.9,position:cc.v3(0,-21,0)}).to(.1,{scaleY:.9,scaleX:1.05,position:cc.v3(0,-16,0)}).to(.1,{scaleY:1,scaleX:1,position:cc.v3(0,-21,0)})).start())},t.prototype.doShake=function(){this.node&&(this.node.stopAllActions(),cc.tween(this.node).repeatForever(cc.tween(this.node).to(.4,{scale:1.1,angle:5}).to(.4,{scale:1,angle:0}).to(.4,{scale:1.1,angle:-5}).to(.4,{scale:1,angle:0})).start())},t.prototype.doBlink=function(){this.node&&(this.node.stopAllActions(),cc.tween(this.node).repeatForever(cc.tween(this.node).to(1,{scale:1.05}).to(1,{scale:1})).start())},t.prototype.doFade=function(){var e=this;this.node&&(this.node.stopAllActions(),this.node.opacity=0,cc.tween(this.node).repeatForever(cc.tween(this.node).to(.5,{scale:.8,opacity:255}).delay(.5).to(.5,{scale:.7}).delay(.5).to(.5,{opacity:0}).delay(.5).call(function(){e.node.scale=.8})).start())},t.prototype.doRateAndFade=function(){var e=this;this.node&&(this.node.stopAllActions(),cc.tween(this.node).to(3,{angle:360,opacity:0}).call(function(){e.node.angle=0}).to(3,{angle:360,opacity:255}).call(function(){e.node.angle=0}).union().repeatForever().start())},t.prototype.doRate=function(){var e=this;this.node&&(this.node.stopAllActions(),cc.tween(this.node).to(2,{angle:360}).call(function(){e.node.angle=0}).to(2,{angle:360}).call(function(){e.node.angle=0}).union().repeatForever().start())},t.prototype.resetNode=function(){this.node&&(this.node.setScale(1),this.node.stopAllActions(),this.node.opacity=255,this.node.active=!1)},t.prototype.stopAllActions=function(){this.node&&this.node.stopAllActions()},i([c],t.prototype,"type",void 0),i([c],t.prototype,"delay",void 0),i([s],t)}(cc.Component);o.default=l,cc._RF.pop()},{}],PoolManager:[function(e,t,o){"use strict";cc._RF.push(t,"e19d2qq4e1EOrcASorbXsNv","PoolManager");var n,a=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var a,i=arguments.length,r=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(i<3?a(r):i>3?a(t,o,r):a(t,o))||r);return i>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,s=r.ccclass,c=r.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.allPrefab=[],t.allPrefabMap=null,t.poolMap=null,t}var o;return a(t,e),o=t,t.prototype.onLoad=function(){null!=o.Instance&&o.Instance.destroy(),o.Instance=this,this.allPrefabMap=new Map,this.poolMap=new Map;for(var e=0;e<this.allPrefab.length;e++){this.allPrefabMap.set(this.allPrefab[e].name,this.allPrefab[e]),cc.log(this.allPrefab[e].name);var t=new cc.NodePool;this.poolMap.set(this.allPrefab[e].name,t)}},t.Spawn=function(e,t){if(void 0===t&&(t=null),!o.Instance.poolMap.has(e))return cc.warn("no prefab named "+e),null;var n=o.Instance.poolMap.get(e);if(n.size()>0){var a=n.get();return null!=t&&(a.parent=t),a}var i=cc.instantiate(o.Instance.allPrefabMap.get(e));return null!=t&&(i.parent=t),i},t.Despawn=function(e,t){if(!o.Instance.poolMap.has(e))return cc.log("\u56de\u6536\u5931\u8d25,\u8282\u70b9\u540d : "+e),null;o.Instance.poolMap.get(e).put(t)},t.GetPrefab=function(e){return o.Instance.allPrefabMap.has(e)?o.Instance.allPrefabMap.get(e):null},t.Preload=function(e,t){if(!o.Instance.poolMap.has(e))return null;for(var n=o.Instance.poolMap.get(e),a=0;a<t;a++){var i=cc.instantiate(o.Instance.allPrefabMap.get(e));n.put(i)}},t.Clear=function(e){if(!o.Instance.poolMap.has(e))return null;var t=o.Instance.poolMap.get(e);t&&t.clear()},t.Instance=null,i([c([cc.Prefab])],t.prototype,"allPrefab",void 0),o=i([s],t)}(cc.Component);o.default=l,cc._RF.pop()},{}],PopAddBubble:[function(e,t,o){"use strict";cc._RF.push(t,"6c5b88iLYVIxYt3Nf3X/MC1","PopAddBubble");var n,a=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var a,i=arguments.length,r=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(i<3?a(r):i>3?a(t,o,r):a(t,o))||r);return i>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../common/EventManager"),s=e("../../common/PopupBase"),c=e("../GameConst"),l=e("../Global"),p=cc._decorator,u=p.ccclass,h=p.property,b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.add10Node=null,t.failNode=null,t}return a(t,e),Object.defineProperty(t,"path",{get:function(){return"ppl/prefab/pop/pop_add_bubble"},enumerable:!1,configurable:!0}),t.prototype.start=function(){},t.prototype.init=function(e){this.type=e.type,1==this.type?(this.add10Node.active=!0,this.failNode.active=!1):(this.add10Node.active=!1,this.failNode.active=!0)},t.prototype.watchVideo=function(){console.log("[AD]","\u770b\u5b8c\u89c6\u9891\u6dfb\u52a0\u5bf9\u5e94\u7684\u9053\u5177~~~~~"),1==this.type?(l.Global.curLevelShootBubbleCount+=10,r.EventManager.getInstance().sendEvent(c.GameConst.EVENT.UPDATE_UI,c.GameConst.UI_TYPE.COUNT)):(l.Global.curLevelShootBubbleCount+=5,l.Global.addPropData(c.GameConst.PROP_BUBBLE_TYPE.LASER,1),r.EventManager.getInstance().sendEvent(c.GameConst.EVENT.UPDATE_UI,c.GameConst.UI_TYPE.PROP),r.EventManager.getInstance().sendEvent(c.GameConst.EVENT.UPDATE_UI,c.GameConst.UI_TYPE.COUNT)),r.EventManager.getInstance().sendEvent(c.GameConst.EVENT.HIDE_ADD_BUBBLE),this.hide()},t.prototype.onLoad=function(){},t.prototype.onDestroy=function(){},t.prototype.closePop=function(){console.log("[Add]","\u5173\u95ed~"),1!=this.type&&r.EventManager.getInstance().sendEvent(c.GameConst.EVENT.SHOW_CHEST_OVER),this.hide()},i([h(cc.Node)],t.prototype,"add10Node",void 0),i([h(cc.Node)],t.prototype,"failNode",void 0),i([u],t)}(s.default);o.default=b,cc._RF.pop()},{"../../common/EventManager":"EventManager","../../common/PopupBase":"PopupBase","../GameConst":"GameConst","../Global":"Global"}],PopChestList:[function(e,t,o){"use strict";cc._RF.push(t,"6fdaftuiQFIkJGilFJnWRkj","PopChestList");var n,a=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var a,i=arguments.length,r=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(i<3?a(r):i>3?a(t,o,r):a(t,o))||r);return i>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../common/EventManager"),s=e("../../common/PopupBase"),c=e("../GameConst"),l=e("../Global"),p=cc._decorator,u=p.ccclass,h=p.property,b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.chest1=null,t.chest2=null,t.chest3=null,t.chest1PrBg=null,t.chest1Pr=null,t.chest2Pr=null,t.chest3Pr=null,t.chestLabel1=null,t.chestLabel2=null,t.chestLabel3=null,t.btnTow=null,t.btnStart=null,t}return a(t,e),Object.defineProperty(t,"path",{get:function(){return"ppl/prefab/pop/pop_chest_list"},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){var e=l.Global.getChestLevel(),t=e-1,o=l.Global.getChestCount(),n=c.GameConst.CHEST_COUNT_CONFIG[t];o>n&&(o=n);var a=o+"/"+n,i=this.chest1PrBg.width*(o/n);switch(e){case 1:this.chest1.getChildByName("state_not").active=!1,this.chest1.getChildByName("state_on").active=!0,this.chest1.getChildByName("state_open").active=!1,this.chest2.getChildByName("state_not").active=!0,this.chest2.getChildByName("state_on").active=!1,this.chest2.getChildByName("state_open").active=!1,this.chest3.getChildByName("state_not").active=!0,this.chest3.getChildByName("state_on").active=!1,this.chest3.getChildByName("state_open").active=!1,this.chestLabel1.string=a,this.chest1Pr.width=i;break;case 2:this.chest1.getChildByName("state_not").active=!1,this.chest1.getChildByName("state_on").active=!1,this.chest1.getChildByName("state_open").active=!0,this.chest2.getChildByName("state_not").active=!1,this.chest2.getChildByName("state_on").active=!0,this.chest2.getChildByName("state_open").active=!1,this.chest3.getChildByName("state_not").active=!0,this.chest3.getChildByName("state_on").active=!1,this.chest3.getChildByName("state_open").active=!1,this.chestLabel2.string=a,this.chest2Pr.width=i;break;case 3:this.chest1.getChildByName("state_not").active=!1,this.chest1.getChildByName("state_on").active=!1,this.chest1.getChildByName("state_open").active=!0,this.chest2.getChildByName("state_not").active=!1,this.chest2.getChildByName("state_on").active=!1,this.chest2.getChildByName("state_open").active=!0,this.chest3.getChildByName("state_not").active=!1,this.chest3.getChildByName("state_on").active=!0,this.chest3.getChildByName("state_open").active=!1,this.btnTow.active=!1,this.btnStart.active=!0,this.chestLabel3.string=a,this.chest3Pr.width=i;break;default:this.chest1.getChildByName("state_not").active=!1,this.chest1.getChildByName("state_on").active=!1,this.chest1.getChildByName("state_open").active=!0,this.chest2.getChildByName("state_not").active=!1,this.chest2.getChildByName("state_on").active=!1,this.chest2.getChildByName("state_open").active=!0,this.chest3.getChildByName("state_not").active=!1,this.chest3.getChildByName("state_on").active=!1,this.chest3.getChildByName("state_open").active=!0,this.btnTow.active=!0,this.btnStart.active=!1}},t.prototype.onDestroy=function(){},t.prototype.startCollect=function(){r.EventManager.getInstance().sendEvent(c.GameConst.EVENT.START_NEW_LEVEL,l.Global.currentLevel,.5),this.hide()},t.prototype.closePop=function(){this.hide()},i([h(cc.Node)],t.prototype,"chest1",void 0),i([h(cc.Node)],t.prototype,"chest2",void 0),i([h(cc.Node)],t.prototype,"chest3",void 0),i([h(cc.Node)],t.prototype,"chest1PrBg",void 0),i([h(cc.Node)],t.prototype,"chest1Pr",void 0),i([h(cc.Node)],t.prototype,"chest2Pr",void 0),i([h(cc.Node)],t.prototype,"chest3Pr",void 0),i([h(cc.Label)],t.prototype,"chestLabel1",void 0),i([h(cc.Label)],t.prototype,"chestLabel2",void 0),i([h(cc.Label)],t.prototype,"chestLabel3",void 0),i([h(cc.Node)],t.prototype,"btnTow",void 0),i([h(cc.Node)],t.prototype,"btnStart",void 0),i([u],t)}(s.default);o.default=b,cc._RF.pop()},{"../../common/EventManager":"EventManager","../../common/PopupBase":"PopupBase","../GameConst":"GameConst","../Global":"Global"}],PopChestOpen:[function(e,t,o){"use strict";cc._RF.push(t,"27b85tgumhDf6iasm2BGxIR","PopChestOpen");var n,a=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var a,i=arguments.length,r=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(i<3?a(r):i>3?a(t,o,r):a(t,o))||r);return i>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../common/EventManager"),s=e("../../common/PopupBase"),c=e("../GameConst"),l=e("../Global"),p=cc._decorator,u=p.ccclass,h=p.property,b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.animation=null,t.desLabel=null,t}return a(t,e),Object.defineProperty(t,"path",{get:function(){return"ppl/prefab/pop/pop_chest_open"},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){var e=l.Global.getChestLevel()-1,t=c.GameConst.CHEST_COUNT_CONFIG[e];this.desLabel.string=t+"/"+t;var o="anim_chest_open_01";switch(e){case 0:o="anim_chest_open_01";break;case 1:o="anim_chest_open_02";break;case 2:o="anim_chest_open_03"}this.animation.play(o)},t.prototype.onDestroy=function(){},t.prototype.onEnable=function(){this.animation&&this.animation.on("finished",this.onFinished,this)},t.prototype.onDisable=function(){this.animation&&this.animation.off("finished",this.onFinished,this)},t.prototype.onFinished=function(){var e=l.Global.getChestLevel();l.Global.saveChestLevel(e+1),l.Global.saveChestCount(0),r.EventManager.getInstance().sendEvent(c.GameConst.EVENT.SHOW_CHEST_REWARD),this.hide()},t.prototype.closePop=function(){this.hide()},i([h(cc.Animation)],t.prototype,"animation",void 0),i([h(cc.Label)],t.prototype,"desLabel",void 0),i([u],t)}(s.default);o.default=b,cc._RF.pop()},{"../../common/EventManager":"EventManager","../../common/PopupBase":"PopupBase","../GameConst":"GameConst","../Global":"Global"}],PopChestOver:[function(e,t,o){"use strict";cc._RF.push(t,"7d775X1NtlDpLDitu9AQid+","PopChestOver");var n,a=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var a,i=arguments.length,r=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(i<3?a(r):i>3?a(t,o,r):a(t,o))||r);return i>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../common/EventManager"),s=e("../../common/PopupBase"),c=e("../GameConst"),l=e("../Global"),p=cc._decorator,u=p.ccclass,h=p.property,b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.chestSpriteFrame=[],t.chestSprite=null,t.countLabel=null,t.proLabel=null,t.proBg=null,t.pro=null,t}return a(t,e),Object.defineProperty(t,"path",{get:function(){return"ppl/prefab/pop/pop_chest_over"},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){var e=l.Global.getChestLevel()-1;this.chestSprite.spriteFrame=this.chestSpriteFrame[e];var t=l.Global.getChestCount();this.totalChestCount=t+l.Global.curChestCount,this.totalChestCount>c.GameConst.CHEST_COUNT_CONFIG[e]&&(this.totalChestCount=c.GameConst.CHEST_COUNT_CONFIG[e]),this.countLabel.string="x"+l.Global.curChestCount,this.proLabel.string="+"+this.totalChestCount+"/"+c.GameConst.CHEST_COUNT_CONFIG[e];var o=this.proBg.width;this.pro.width=o*(this.totalChestCount/c.GameConst.CHEST_COUNT_CONFIG[e])},t.prototype.onDestroy=function(){},t.prototype.watchVideo=function(){console.log("[AD]","\u770b\u5b8c\u89c6\u9891\u83b7\u53d6\u5956\u52b1~~~~~"),l.Global.saveChestCount(this.totalChestCount),r.EventManager.getInstance().sendEvent(c.GameConst.EVENT.GAME_OVER),this.hide()},t.prototype.closePop=function(){this.hide(),r.EventManager.getInstance().sendEvent(c.GameConst.EVENT.GAME_OVER)},i([h([cc.SpriteFrame])],t.prototype,"chestSpriteFrame",void 0),i([h(cc.Sprite)],t.prototype,"chestSprite",void 0),i([h(cc.Label)],t.prototype,"countLabel",void 0),i([h(cc.Label)],t.prototype,"proLabel",void 0),i([h(cc.Node)],t.prototype,"proBg",void 0),i([h(cc.Node)],t.prototype,"pro",void 0),i([u],t)}(s.default);o.default=b,cc._RF.pop()},{"../../common/EventManager":"EventManager","../../common/PopupBase":"PopupBase","../GameConst":"GameConst","../Global":"Global"}],PopChestReward:[function(e,t,o){"use strict";cc._RF.push(t,"82f3dpc0FBJhovTozDUVm5A","PopChestReward");var n,a=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var a,i=arguments.length,r=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(i<3?a(r):i>3?a(t,o,r):a(t,o))||r);return i>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../common/EventManager"),s=e("../../common/PopupBase"),c=e("../bubble/BubbleUtil"),l=e("../GameConst"),p=e("../Global"),u=cc._decorator,h=u.ccclass,b=u.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.coinNode=null,t.bombNode=null,t.laserNode=null,t.rainrowNode=null,t.lightningNode=null,t}return a(t,e),Object.defineProperty(t,"path",{get:function(){return"ppl/prefab/pop/pop_chest_reward"},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){switch(c.default.randNum(1,4)){case 1:this.propType=l.GameConst.PROP_BUBBLE_TYPE.BOMB,this.bombNode.active=!0;break;case 2:this.propType=l.GameConst.PROP_BUBBLE_TYPE.LASER,this.laserNode.active=!0;break;case 3:this.propType=l.GameConst.PROP_BUBBLE_TYPE.RAINBOW,this.rainrowNode.active=!0;break;case 4:this.propType=l.GameConst.PROP_BUBBLE_TYPE.LIGHTNING,this.lightningNode.active=!0}},t.prototype.onDestroy=function(){},t.prototype.watchVideo=function(){console.log("[AD]","\u770b\u5b8c\u89c6\u9891\u83b7\u53d6\u5956\u52b1x2~~~~~"),p.Global.addPropData(this.propType,2),p.Global.addCoin(200),r.EventManager.getInstance().sendEvent(l.GameConst.EVENT.UPDATE_UI,l.GameConst.UI_TYPE.COIN),r.EventManager.getInstance().sendEvent(l.GameConst.EVENT.UPDATE_UI,l.GameConst.UI_TYPE.PROP),this.hide()},t.prototype.gotIt=function(){p.Global.addPropData(this.propType,1),p.Global.addCoin(100),r.EventManager.getInstance().sendEvent(l.GameConst.EVENT.UPDATE_UI,l.GameConst.UI_TYPE.COIN),r.EventManager.getInstance().sendEvent(l.GameConst.EVENT.UPDATE_UI,l.GameConst.UI_TYPE.PROP),this.hide()},t.prototype.closePop=function(){this.hide()},i([b(cc.Node)],t.prototype,"coinNode",void 0),i([b(cc.Node)],t.prototype,"bombNode",void 0),i([b(cc.Node)],t.prototype,"laserNode",void 0),i([b(cc.Node)],t.prototype,"rainrowNode",void 0),i([b(cc.Node)],t.prototype,"lightningNode",void 0),i([h],t)}(s.default);o.default=d,cc._RF.pop()},{"../../common/EventManager":"EventManager","../../common/PopupBase":"PopupBase","../GameConst":"GameConst","../Global":"Global","../bubble/BubbleUtil":"BubbleUtil"}],PopCoinGift:[function(e,t,o){"use strict";cc._RF.push(t,"cb20d2D+rdAfYVIYc2gxd4R","PopCoinGift");var n,a=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var a,i=arguments.length,r=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(i<3?a(r):i>3?a(t,o,r):a(t,o))||r);return i>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../common/EventManager"),s=e("../../common/PopupBase"),c=e("../GameConst"),l=e("../Global"),p=cc._decorator,u=p.ccclass,h=(p.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),Object.defineProperty(t,"path",{get:function(){return"ppl/prefab/pop/pop_coingift"},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){},t.prototype.onDestroy=function(){},t.prototype.watchVideo=function(){console.log("[AD]","\u770b\u5b8c\u89c6\u9891\u83b7\u53d6\u5956\u52b1~~~~~"),l.Global.addCoin(250),r.EventManager.getInstance().sendEvent(c.GameConst.EVENT.UPDATE_UI,c.GameConst.UI_TYPE.COIN),this.hide()},t.prototype.add5=function(){l.Global.addCoin(5),r.EventManager.getInstance().sendEvent(c.GameConst.EVENT.UPDATE_UI,c.GameConst.UI_TYPE.COIN),this.hide()},t.prototype.closePop=function(){this.hide()},i([u],t)}(s.default));o.default=h,cc._RF.pop()},{"../../common/EventManager":"EventManager","../../common/PopupBase":"PopupBase","../GameConst":"GameConst","../Global":"Global"}],PopDaily:[function(e,t,o){"use strict";cc._RF.push(t,"b3460jyOfVPQZrFBooQlA0j","PopDaily");var n,a=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var a,i=arguments.length,r=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(i<3?a(r):i>3?a(t,o,r):a(t,o))||r);return i>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../common/EventManager"),s=e("../../common/PopupBase"),c=e("../../common/Utils"),l=e("../GameConst"),p=e("../Global"),u=cc._decorator,h=u.ccclass,b=u.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.itemBgSpritFrame=[],t.d1BgNode=null,t.d2BgNode=null,t.d3BgNode=null,t.d4BgNode=null,t.d5BgNode=null,t.d6BgNode=null,t.d7BgNode=null,t.d1Check=null,t.d2Check=null,t.d3Check=null,t.d4Check=null,t.d5Check=null,t.d6Check=null,t.d7Check=null,t.d1CheckTxt=null,t.d2CheckTxt=null,t.d3CheckTxt=null,t.d4CheckTxt=null,t.d5CheckTxt=null,t.d6CheckTxt=null,t.d7CheckTxt=null,t.d1Txt=null,t.d2Txt=null,t.d3Txt=null,t.d4Txt=null,t.d5Txt=null,t.d6Txt=null,t.d7Txt=null,t.d1num=null,t.d2num=null,t.d3num=null,t.d4num=null,t.d5num=null,t.d6num=null,t.signBtn=null,t.tmBtn=null,t}return a(t,e),Object.defineProperty(t,"path",{get:function(){return"ppl/prefab/pop/pop_daily"},enumerable:!1,configurable:!0}),t.prototype.start=function(){},t.prototype.onLoad=function(){this.updateUI()},t.prototype.onDestroy=function(){},t.prototype.updateUI=function(){var e=p.Global.getLastSignTimestamp(),t=p.Global.getSignTime();if(c.Utils.isNextDay(e)&&t<7)switch(this.signBtn.active=!0,this.tmBtn.active=!1,t){case 0:this.d1num.active=!0,this.d1Txt.active=!0,this.d1Check.active=!1,this.d1CheckTxt.active=!1,this.d1BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[2],this.d2BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[0],this.d3BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[0],this.d4BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[0],this.d5BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[0],this.d6BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[0],this.d7BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[0];break;case 1:this.d1BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[1],this.d1num.active=!1,this.d1Txt.active=!1,this.d1Check.active=!0,this.d1CheckTxt.active=!0,this.d2BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[2],this.d3BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[0],this.d4BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[0],this.d5BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[0],this.d6BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[0],this.d7BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[0];break;case 2:this.d1BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[1],this.d1num.active=!1,this.d1Txt.active=!1,this.d1Check.active=!0,this.d1CheckTxt.active=!0,this.d2BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[1],this.d2num.active=!1,this.d2Txt.active=!1,this.d2Check.active=!0,this.d2CheckTxt.active=!0,this.d3BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[2],this.d4BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[0],this.d5BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[0],this.d6BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[0],this.d7BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[0];break;case 3:this.d1BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[1],this.d1num.active=!1,this.d1Txt.active=!1,this.d1Check.active=!0,this.d1CheckTxt.active=!0,this.d2BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[1],this.d2num.active=!1,this.d2Txt.active=!1,this.d2Check.active=!0,this.d2CheckTxt.active=!0,this.d3BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[1],this.d3num.active=!1,this.d3Txt.active=!1,this.d3Check.active=!0,this.d3CheckTxt.active=!0,this.d4BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[2],this.d5BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[0],this.d6BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[0],this.d7BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[0];break;case 4:this.d1BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[1],this.d1num.active=!1,this.d1Txt.active=!1,this.d1Check.active=!0,this.d1CheckTxt.active=!0,this.d2BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[1],this.d2num.active=!1,this.d2Txt.active=!1,this.d2Check.active=!0,this.d2CheckTxt.active=!0,this.d3BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[1],this.d3num.active=!1,this.d3Txt.active=!1,this.d3Check.active=!0,this.d3CheckTxt.active=!0,this.d4BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[1],this.d4num.active=!1,this.d4Txt.active=!1,this.d4Check.active=!0,this.d4CheckTxt.active=!0,this.d5BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[2],this.d6BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[0],this.d7BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[0];break;case 5:this.d1BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[1],this.d1num.active=!1,this.d1Txt.active=!1,this.d1Check.active=!0,this.d1CheckTxt.active=!0,this.d2BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[1],this.d2num.active=!1,this.d2Txt.active=!1,this.d2Check.active=!0,this.d2CheckTxt.active=!0,this.d3BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[1],this.d3num.active=!1,this.d3Txt.active=!1,this.d3Check.active=!0,this.d3CheckTxt.active=!0,this.d4BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[1],this.d4num.active=!1,this.d4Txt.active=!1,this.d4Check.active=!0,this.d4CheckTxt.active=!0,this.d5BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[1],this.d5num.active=!1,this.d5Txt.active=!1,this.d5Check.active=!0,this.d5CheckTxt.active=!0,this.d6BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[2],this.d7BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[0];break;case 6:this.d1BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[1],this.d1num.active=!1,this.d1Txt.active=!1,this.d1Check.active=!0,this.d1CheckTxt.active=!0,this.d2BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[1],this.d2num.active=!1,this.d2Txt.active=!1,this.d2Check.active=!0,this.d2CheckTxt.active=!0,this.d3BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[1],this.d3num.active=!1,this.d3Txt.active=!1,this.d3Check.active=!0,this.d3CheckTxt.active=!0,this.d4BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[1],this.d4num.active=!1,this.d4Txt.active=!1,this.d4Check.active=!0,this.d4CheckTxt.active=!0,this.d5BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[1],this.d5num.active=!1,this.d5Txt.active=!1,this.d5Check.active=!0,this.d5CheckTxt.active=!0,this.d6BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[1],this.d6num.active=!1,this.d6Txt.active=!1,this.d6Check.active=!0,this.d6CheckTxt.active=!0,this.d7BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[2]}else switch(this.signBtn.active=!1,this.tmBtn.active=!0,t){case 1:this.d1BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[1],this.d1num.active=!1,this.d1Txt.active=!1,this.d1Check.active=!0,this.d1CheckTxt.active=!0,this.d2BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[0],this.d3BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[0],this.d4BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[0],this.d5BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[0],this.d6BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[0],this.d7BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[0];break;case 2:this.d1BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[1],this.d1num.active=!1,this.d1Txt.active=!1,this.d1Check.active=!0,this.d1CheckTxt.active=!0,this.d2BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[1],this.d2num.active=!1,this.d2Txt.active=!1,this.d2Check.active=!0,this.d2CheckTxt.active=!0,this.d3BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[0],this.d4BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[0],this.d5BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[0],this.d6BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[0],this.d7BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[0];break;case 3:this.d1BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[1],this.d1num.active=!1,this.d1Txt.active=!1,this.d1Check.active=!0,this.d1CheckTxt.active=!0,this.d2BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[1],this.d2num.active=!1,this.d2Txt.active=!1,this.d2Check.active=!0,this.d2CheckTxt.active=!0,this.d3BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[1],this.d3num.active=!1,this.d3Txt.active=!1,this.d3Check.active=!0,this.d3CheckTxt.active=!0,this.d4BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[0],this.d5BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[0],this.d6BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[0],this.d7BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[0];break;case 4:this.d1BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[1],this.d1num.active=!1,this.d1Txt.active=!1,this.d1Check.active=!0,this.d1CheckTxt.active=!0,this.d2BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[1],this.d2num.active=!1,this.d2Txt.active=!1,this.d2Check.active=!0,this.d2CheckTxt.active=!0,this.d3BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[1],this.d3num.active=!1,this.d3Txt.active=!1,this.d3Check.active=!0,this.d3CheckTxt.active=!0,this.d4BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[1],this.d4num.active=!1,this.d4Txt.active=!1,this.d4Check.active=!0,this.d4CheckTxt.active=!0,this.d5BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[0],this.d6BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[0],this.d7BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[0];break;case 5:this.d1BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[1],this.d1num.active=!1,this.d1Txt.active=!1,this.d1Check.active=!0,this.d1CheckTxt.active=!0,this.d2BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[1],this.d2num.active=!1,this.d2Txt.active=!1,this.d2Check.active=!0,this.d2CheckTxt.active=!0,this.d3BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[1],this.d3num.active=!1,this.d3Txt.active=!1,this.d3Check.active=!0,this.d3CheckTxt.active=!0,this.d4BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[1],this.d4num.active=!1,this.d4Txt.active=!1,this.d4Check.active=!0,this.d4CheckTxt.active=!0,this.d5BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[1],this.d5num.active=!1,this.d5Txt.active=!1,this.d5Check.active=!0,this.d5CheckTxt.active=!0,this.d6BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[0],this.d7BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[0];break;case 6:this.d1BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[1],this.d1num.active=!1,this.d1Txt.active=!1,this.d1Check.active=!0,this.d1CheckTxt.active=!0,this.d2BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[1],this.d2num.active=!1,this.d2Txt.active=!1,this.d2Check.active=!0,this.d2CheckTxt.active=!0,this.d3BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[1],this.d3num.active=!1,this.d3Txt.active=!1,this.d3Check.active=!0,this.d3CheckTxt.active=!0,this.d4BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[1],this.d4num.active=!1,this.d4Txt.active=!1,this.d4Check.active=!0,this.d4CheckTxt.active=!0,this.d5BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[1],this.d5num.active=!1,this.d5Txt.active=!1,this.d5Check.active=!0,this.d5CheckTxt.active=!0,this.d6BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[1],this.d6num.active=!1,this.d6Txt.active=!1,this.d6Check.active=!0,this.d6CheckTxt.active=!0,this.d7BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[0];break;case 7:this.d1BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[1],this.d1num.active=!1,this.d1Txt.active=!1,this.d1Check.active=!0,this.d1CheckTxt.active=!0,this.d2BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[1],this.d2num.active=!1,this.d2Txt.active=!1,this.d2Check.active=!0,this.d2CheckTxt.active=!0,this.d3BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[1],this.d3num.active=!1,this.d3Txt.active=!1,this.d3Check.active=!0,this.d3CheckTxt.active=!0,this.d4BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[1],this.d4num.active=!1,this.d4Txt.active=!1,this.d4Check.active=!0,this.d4CheckTxt.active=!0,this.d5BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[1],this.d5num.active=!1,this.d5Txt.active=!1,this.d5Check.active=!0,this.d5CheckTxt.active=!0,this.d6BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[1],this.d6num.active=!1,this.d6Txt.active=!1,this.d6Check.active=!0,this.d6CheckTxt.active=!0,this.d7BgNode.getComponent(cc.Sprite).spriteFrame=this.itemBgSpritFrame[1],this.d7Txt.active=!1,this.d7Check.active=!0,this.d7CheckTxt.active=!0}},t.prototype.sign=function(){console.log("[POP]","\u7b7e\u5230\u6210\u529f\uff01~");var e=p.Global.getSignTime(),t=++e-1,o=l.GameConst.SIGN_CONFIG[t],n=o.COIN,a=o.PROP_BOMB,i=o.PROP_LASER,s=o.PROP_RAINBOW,c=o.PROP_LIGHTNING,u=(new Date).getTime();p.Global.saveLastSignTimestamp(u),p.Global.saveSignTime(e),n>0&&p.Global.addCoin(n),a>0&&p.Global.addPropData(l.GameConst.PROP_BUBBLE_TYPE.BOMB,a),i>0&&p.Global.addPropData(l.GameConst.PROP_BUBBLE_TYPE.LASER,i),s>0&&p.Global.addPropData(l.GameConst.PROP_BUBBLE_TYPE.RAINBOW,s),c>0&&p.Global.addPropData(l.GameConst.PROP_BUBBLE_TYPE.LIGHTNING,c),this.updateUI(),r.EventManager.getInstance().sendEvent(l.GameConst.EVENT.UPDATE_UI,-1)},t.prototype.closePop=function(){console.log("[POP]","\u5173\u95ed~"),this.hide()},i([b([cc.SpriteFrame])],t.prototype,"itemBgSpritFrame",void 0),i([b(cc.Node)],t.prototype,"d1BgNode",void 0),i([b(cc.Node)],t.prototype,"d2BgNode",void 0),i([b(cc.Node)],t.prototype,"d3BgNode",void 0),i([b(cc.Node)],t.prototype,"d4BgNode",void 0),i([b(cc.Node)],t.prototype,"d5BgNode",void 0),i([b(cc.Node)],t.prototype,"d6BgNode",void 0),i([b(cc.Node)],t.prototype,"d7BgNode",void 0),i([b(cc.Node)],t.prototype,"d1Check",void 0),i([b(cc.Node)],t.prototype,"d2Check",void 0),i([b(cc.Node)],t.prototype,"d3Check",void 0),i([b(cc.Node)],t.prototype,"d4Check",void 0),i([b(cc.Node)],t.prototype,"d5Check",void 0),i([b(cc.Node)],t.prototype,"d6Check",void 0),i([b(cc.Node)],t.prototype,"d7Check",void 0),i([b(cc.Node)],t.prototype,"d1CheckTxt",void 0),i([b(cc.Node)],t.prototype,"d2CheckTxt",void 0),i([b(cc.Node)],t.prototype,"d3CheckTxt",void 0),i([b(cc.Node)],t.prototype,"d4CheckTxt",void 0),i([b(cc.Node)],t.prototype,"d5CheckTxt",void 0),i([b(cc.Node)],t.prototype,"d6CheckTxt",void 0),i([b(cc.Node)],t.prototype,"d7CheckTxt",void 0),i([b(cc.Node)],t.prototype,"d1Txt",void 0),i([b(cc.Node)],t.prototype,"d2Txt",void 0),i([b(cc.Node)],t.prototype,"d3Txt",void 0),i([b(cc.Node)],t.prototype,"d4Txt",void 0),i([b(cc.Node)],t.prototype,"d5Txt",void 0),i([b(cc.Node)],t.prototype,"d6Txt",void 0),i([b(cc.Node)],t.prototype,"d7Txt",void 0),i([b(cc.Node)],t.prototype,"d1num",void 0),i([b(cc.Node)],t.prototype,"d2num",void 0),i([b(cc.Node)],t.prototype,"d3num",void 0),i([b(cc.Node)],t.prototype,"d4num",void 0),i([b(cc.Node)],t.prototype,"d5num",void 0),i([b(cc.Node)],t.prototype,"d6num",void 0),i([b(cc.Node)],t.prototype,"signBtn",void 0),i([b(cc.Node)],t.prototype,"tmBtn",void 0),i([h],t)}(s.default);o.default=d,cc._RF.pop()},{"../../common/EventManager":"EventManager","../../common/PopupBase":"PopupBase","../../common/Utils":"Utils","../GameConst":"GameConst","../Global":"Global"}],PopFail:[function(e,t,o){"use strict";cc._RF.push(t,"8ff5eFah59CR5FGhJHc7MA0","PopFail");var n,a=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var a,i=arguments.length,r=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(i<3?a(r):i>3?a(t,o,r):a(t,o))||r);return i>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../common/EventManager"),s=e("../../common/PopupBase"),c=e("../GameConst"),l=e("../Global"),p=cc._decorator,u=p.ccclass,h=p.property,b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.heartNode=null,t}return a(t,e),Object.defineProperty(t,"path",{get:function(){return"ppl/prefab/pop/pop_fail"},enumerable:!1,configurable:!0}),t.prototype.start=function(){},t.prototype.onLoad=function(){var e=this.heartNode.getComponent(cc.Animation);this.scheduleOnce(function(){e.play()},1)},t.prototype.onDestroy=function(){},t.prototype.restart=function(){r.EventManager.getInstance().sendEvent(c.GameConst.EVENT.GAME_RESTART,l.Global.currentLevel),this.hide()},t.prototype.revive=function(){console.log("[AD]","\u770b\u5e7f\u544a\u590d\u6d3b~~~~~"),r.EventManager.getInstance().sendEvent(c.GameConst.EVENT.REVIVE,l.Global.currentLevel),this.hide()},i([h(cc.Node)],t.prototype,"heartNode",void 0),i([u],t)}(s.default);o.default=b,cc._RF.pop()},{"../../common/EventManager":"EventManager","../../common/PopupBase":"PopupBase","../GameConst":"GameConst","../Global":"Global"}],PopGuide:[function(e,t,o){"use strict";cc._RF.push(t,"12310UCNnhKGIqMAG4HGZda","PopGuide");var n,a=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var a,i=arguments.length,r=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(i<3?a(r):i>3?a(t,o,r):a(t,o))||r);return i>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../common/PopupBase"),s=e("../GameConst"),c=e("../Global"),l=cc._decorator,p=l.ccclass,u=l.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.contenNode=null,t}return a(t,e),Object.defineProperty(t,"path",{get:function(){return"ppl/prefab/pop/pop_guide"},enumerable:!1,configurable:!0}),t.prototype.start=function(){},t.prototype.onLoad=function(){},t.prototype.init=function(e){this.type=e.type,console.log("[POP]guide type:",this.type);var t=this.contenNode.getComponent(cc.Animation),o=null;switch(this.type){case s.GameConst.GUIDE_TYPE.BUBBLE_IRON:o="anim_popup_guide01";break;case s.GameConst.GUIDE_TYPE.PROP_RAINBOW:o="anim_popup_guide02";break;case s.GameConst.GUIDE_TYPE.PROP_LIGHTNING:o="anim_popup_guide03";break;case s.GameConst.GUIDE_TYPE.BUBBLE_ICE:o="anim_popup_guide04";break;case s.GameConst.GUIDE_TYPE.BUBBLE_BLACK_HOLE:o="anim_popup_guide05";break;case s.GameConst.GUIDE_TYPE.BUBBLE_CLOUD:o="anim_popup_guide06"}o&&t.play(o),c.Global.saveGuideData(this.type,s.GameConst.YES)},t.prototype.onDestroy=function(){},t.prototype.yes=function(){this.hide()},t.prototype.closePop=function(){this.hide()},i([u(cc.Node)],t.prototype,"contenNode",void 0),i([p],t)}(r.default);o.default=h,cc._RF.pop()},{"../../common/PopupBase":"PopupBase","../GameConst":"GameConst","../Global":"Global"}],PopLevelSelect:[function(e,t,o){"use strict";cc._RF.push(t,"9d87exB3ZxKT5fknnfKA2M+","PopLevelSelect");var n,a=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var a,i=arguments.length,r=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(i<3?a(r):i>3?a(t,o,r):a(t,o))||r);return i>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../common/EventManager"),s=e("../../common/PopupBase"),c=e("../GameConst"),l=cc._decorator,p=l.ccclass,u=l.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.starSpritFrame=[],t.star1Node=null,t.star2Node=null,t.star3Node=null,t.levelLabel=null,t.numLabel=null,t}return a(t,e),Object.defineProperty(t,"path",{get:function(){return"ppl/prefab/pop/pop_level_select"},enumerable:!1,configurable:!0}),t.prototype.start=function(){},t.prototype.init=function(e){this.level=e.level;var t=e.star;this.num=e.num,console.log("[POP]init:",e),1==t?(this.star1Node.getComponent(cc.Sprite).spriteFrame=this.starSpritFrame[1],this.star2Node.getComponent(cc.Sprite).spriteFrame=this.starSpritFrame[0],this.star3Node.getComponent(cc.Sprite).spriteFrame=this.starSpritFrame[0]):2==t?(this.star1Node.getComponent(cc.Sprite).spriteFrame=this.starSpritFrame[1],this.star2Node.getComponent(cc.Sprite).spriteFrame=this.starSpritFrame[1],this.star3Node.getComponent(cc.Sprite).spriteFrame=this.starSpritFrame[0]):3==t?(this.star1Node.getComponent(cc.Sprite).spriteFrame=this.starSpritFrame[1],this.star2Node.getComponent(cc.Sprite).spriteFrame=this.starSpritFrame[1],this.star3Node.getComponent(cc.Sprite).spriteFrame=this.starSpritFrame[1]):(this.star1Node.getComponent(cc.Sprite).spriteFrame=this.starSpritFrame[0],this.star2Node.getComponent(cc.Sprite).spriteFrame=this.starSpritFrame[0],this.star3Node.getComponent(cc.Sprite).spriteFrame=this.starSpritFrame[0]),this.levelLabel.string=""+this.level,this.numLabel.string=""+this.num},t.prototype.onLoad=function(){},t.prototype.onDestroy=function(){},t.prototype.startLevel=function(){r.EventManager.getInstance().sendEvent(c.GameConst.EVENT.START_NEW_LEVEL,this.level),this.hide()},t.prototype.closePop=function(){console.log("[POP]","\u5173\u95ed~"),cc.director.isPaused()&&cc.director.resume(),this.hide()},i([u([cc.SpriteFrame])],t.prototype,"starSpritFrame",void 0),i([u(cc.Node)],t.prototype,"star1Node",void 0),i([u(cc.Node)],t.prototype,"star2Node",void 0),i([u(cc.Node)],t.prototype,"star3Node",void 0),i([u(cc.Label)],t.prototype,"levelLabel",void 0),i([u(cc.Label)],t.prototype,"numLabel",void 0),i([p],t)}(s.default);o.default=h,cc._RF.pop()},{"../../common/EventManager":"EventManager","../../common/PopupBase":"PopupBase","../GameConst":"GameConst"}],PopOnlineGift:[function(e,t,o){"use strict";cc._RF.push(t,"d038dntUBBIv5omdy6S/ger","PopOnlineGift");var n,a=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var a,i=arguments.length,r=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(i<3?a(r):i>3?a(t,o,r):a(t,o))||r);return i>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../common/PopupBase"),s=cc._decorator,c=s.ccclass,l=(s.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),Object.defineProperty(t,"path",{get:function(){return"ppl/prefab/pop/pop_onlinegift"},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){},t.prototype.onDestroy=function(){},t.prototype.watchVideo=function(){console.log("[AD]","\u770b\u5b8c\u89c6\u9891\u83b7\u53d6\u5956\u52b1~~~~~"),this.hide()},t.prototype.closePop=function(){this.hide()},i([c],t)}(r.default));o.default=l,cc._RF.pop()},{"../../common/PopupBase":"PopupBase"}],PopPause:[function(e,t,o){"use strict";cc._RF.push(t,"9d2cdQ3AmJJOpHZHWxaCJfj","PopPause");var n,a=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var a,i=arguments.length,r=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(i<3?a(r):i>3?a(t,o,r):a(t,o))||r);return i>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../common/EventManager"),s=e("../../common/PopupBase"),c=e("../../common/SoundManager"),l=e("../GameConst"),p=e("../Global"),u=cc._decorator,h=u.ccclass,b=u.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.musicSpritFrame=[],t.shakeSpritFrame=[],t.musicSprit=null,t.shakeSprit=null,t}return a(t,e),Object.defineProperty(t,"path",{get:function(){return"ppl/prefab/pop/pop_pause"},enumerable:!1,configurable:!0}),t.prototype.start=function(){cc.director.isPaused()||(cc.director.pause(),cc.director.resume())},t.prototype.onLoad=function(){var e=p.Global.getSoundMusic();this.updateMusicUI(e),e=p.Global.getShake(),this.updateShakeUI(e)},t.prototype.onDestroy=function(){},t.prototype.replay=function(){cc.director.isPaused()&&cc.director.resume(),r.EventManager.getInstance().sendEvent(l.GameConst.EVENT.GAME_RESTART,p.Global.currentLevel),this.hide()},t.prototype.exit=function(){cc.director.isPaused()&&cc.director.resume(),r.EventManager.getInstance().sendEvent(l.GameConst.EVENT.EXIT),this.hide()},t.prototype.updateMusicUI=function(e){e==l.GameConst.YES?(console.log("[Setting]","\u5f00\u542f\u58f0\u97f3\uff01"),this.musicSprit.spriteFrame=this.musicSpritFrame[0]):(console.log("[Setting]","\u5173\u95ed\u58f0\u97f3\uff01"),this.musicSprit.spriteFrame=this.musicSpritFrame[1])},t.prototype.updateShakeUI=function(e){e==l.GameConst.YES?(console.log("[Setting]","\u5f00\u542f\u9707\u52a8\uff01"),this.shakeSprit.spriteFrame=this.shakeSpritFrame[0]):(console.log("[Setting]","\u5173\u95ed\u9707\u52a8\uff01"),this.shakeSprit.spriteFrame=this.shakeSpritFrame[1])},t.prototype.switchShake=function(){var e=p.Global.switchShake();this.updateShakeUI(e),e==l.GameConst.YES&&c.default.vibrate()},t.prototype.switchMusic=function(){var e=p.Global.switchSoundMusic();this.updateMusicUI(e),c.default.setSoundsEnable(e==l.GameConst.YES)},t.prototype.closePop=function(){console.log("[Setting]","\u5173\u95ed~"),cc.director.isPaused()&&cc.director.resume(),r.EventManager.getInstance().sendEvent(l.GameConst.EVENT.GAME_RESUME),this.hide()},i([b([cc.SpriteFrame])],t.prototype,"musicSpritFrame",void 0),i([b([cc.SpriteFrame])],t.prototype,"shakeSpritFrame",void 0),i([b(cc.Sprite)],t.prototype,"musicSprit",void 0),i([b(cc.Sprite)],t.prototype,"shakeSprit",void 0),i([h],t)}(s.default);o.default=d,cc._RF.pop()},{"../../common/EventManager":"EventManager","../../common/PopupBase":"PopupBase","../../common/SoundManager":"SoundManager","../GameConst":"GameConst","../Global":"Global"}],PopRandomGift:[function(e,t,o){"use strict";cc._RF.push(t,"bbf53sujtdJ84PeLQGIE+W7","PopRandomGift");var n,a=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var a,i=arguments.length,r=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(i<3?a(r):i>3?a(t,o,r):a(t,o))||r);return i>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../common/EventManager"),s=e("../../common/PopupBase"),c=e("../bubble/BubbleUtil"),l=e("../GameConst"),p=e("../Global"),u=cc._decorator,h=u.ccclass,b=u.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.propBubbleSpriteFrame=[],t.propBubbleNameSpriteFrame=[],t.propBubbleSprite=null,t.propBubbleNameSprite=null,t.desLabel=null,t}return a(t,e),Object.defineProperty(t,"path",{get:function(){return"ppl/prefab/pop/pop_randomgift"},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){var e=c.default.randNum(0,3),t="";switch(e){case 0:this.propType=l.GameConst.PROP_BUBBLE_TYPE.BOMB,t="\u4e00\u6b21\u6d88\u9664\u7206\u70b8\u5468\u56f4\u7684\u6ce1\u6ce1";break;case 1:this.propType=l.GameConst.PROP_BUBBLE_TYPE.RAINBOW,t="\u6d88\u9664\u4eba\u5458\u989c\u8272\u7684\u6ce1\u6ce1";break;case 2:this.propType=l.GameConst.PROP_BUBBLE_TYPE.LIGHTNING,t="\u6d88\u9664\u4e00\u6574\u6392\u7684\u6ce1\u6ce1";break;case 3:this.propType=l.GameConst.PROP_BUBBLE_TYPE.LASER,t="\u6d88\u9664\u4e00\u76f4\u7ebf\u4e0a\u6240\u6709\u7684\u6ce1\u6ce1"}this.propBubbleSprite.spriteFrame=this.propBubbleSpriteFrame[e],this.propBubbleNameSprite.spriteFrame=this.propBubbleNameSpriteFrame[e],this.desLabel.string=t+""},t.prototype.onDestroy=function(){},t.prototype.watchVideo=function(){console.log("[AD]","\u770b\u5b8c\u89c6\u9891\u83b7\u53d6\u5956\u52b1~~~~~"),p.Global.addPropData(this.propType,1),r.EventManager.getInstance().sendEvent(l.GameConst.EVENT.UPDATE_UI,l.GameConst.UI_TYPE.PROP),this.hide()},t.prototype.closePop=function(){this.hide()},i([b([cc.SpriteFrame])],t.prototype,"propBubbleSpriteFrame",void 0),i([b([cc.SpriteFrame])],t.prototype,"propBubbleNameSpriteFrame",void 0),i([b(cc.Sprite)],t.prototype,"propBubbleSprite",void 0),i([b(cc.Sprite)],t.prototype,"propBubbleNameSprite",void 0),i([b(cc.Label)],t.prototype,"desLabel",void 0),i([h],t)}(s.default);o.default=d,cc._RF.pop()},{"../../common/EventManager":"EventManager","../../common/PopupBase":"PopupBase","../GameConst":"GameConst","../Global":"Global","../bubble/BubbleUtil":"BubbleUtil"}],PopShop:[function(e,t,o){"use strict";cc._RF.push(t,"e9e02Kcn9hBxb/fTJCVXDmx","PopShop");var n,a=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var a,i=arguments.length,r=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(i<3?a(r):i>3?a(t,o,r):a(t,o))||r);return i>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../common/EventManager"),s=e("../../common/PopupBase"),c=e("../GameConst"),l=e("../Global"),p=cc._decorator,u=p.ccclass,h=p.property,b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.timeLabel=null,t.getFreeCoinTime=0,t}return a(t,e),Object.defineProperty(t,"path",{get:function(){return"ppl/prefab/pop/pop_shop"},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){this.getFreeCoinTime=l.Global.getGetFreeCoinTime();var e="\u514d\u8d39\u9886\u53d6\u6b21\u6570\uff08"+(2-this.getFreeCoinTime)+"/2\uff09";this.timeLabel.string=e},t.prototype.onDestroy=function(){},t.prototype.watchVideo=function(){this.getFreeCoinTime>=2?console.log("[AD]","\u514d\u8d39\u6b21\u6570\u7528\u5b8c\uff0c\u770b\u5b8c\u89c6\u9891\u83b7\u53d6\u91d1\u5e01~~~~~"):(this.getFreeCoinTime++,l.Global.saveGetFreeCoinTime(this.getFreeCoinTime),l.Global.addCoin(50),r.EventManager.getInstance().sendEvent(c.GameConst.EVENT.UPDATE_UI,c.GameConst.UI_TYPE.COIN),this.hide())},t.prototype.closePop=function(){this.hide()},i([h(cc.Label)],t.prototype,"timeLabel",void 0),i([u],t)}(s.default);o.default=b,cc._RF.pop()},{"../../common/EventManager":"EventManager","../../common/PopupBase":"PopupBase","../GameConst":"GameConst","../Global":"Global"}],PopupBase:[function(e,t,o){"use strict";cc._RF.push(t,"66397WAfJJM3qyR2JIQfKiY","PopupBase");var n,a=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var a,i=arguments.length,r=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(i<3?a(r):i>3?a(t,o,r):a(t,o))||r);return i>3&&r&&Object.defineProperty(t,o,r),r},r=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))(function(a,i){function r(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(r,s)}c((n=n.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){var o,n,a,i,r={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(e){return function(t){return c([e,t])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;r;)try{if(o=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return r.label++,{value:i[1],done:!1};case 5:r.label++,n=i[1],i=[0];continue;case 7:i=r.ops.pop(),r.trys.pop();continue;default:if(!(a=(a=r.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){r=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){r.label=i[1];break}if(6===i[0]&&r.label<a[1]){r.label=a[1],a=i;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(i);break}a[2]&&r.ops.pop(),r.trys.pop();continue}i=t.call(e,r)}catch(s){i=[6,s],n=0}finally{o=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,l=c.ccclass,p=c.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.background=null,t.main=null,t.animationDuration=.3,t.blocker=null,t.options=null,t.finishCallback=null,t}return a(t,e),t.prototype.show=function(e,t){return r(this,void 0,void 0,function(){return s(this,function(o){switch(o.label){case 0:return this.options=e,this.init(e),this.updateDisplay(e),this.onBeforeShow?[4,this.onBeforeShow()]:[3,2];case 1:o.sent(),o.label=2;case 2:return null==t&&(t=t<0?0:this.animationDuration),[4,this.playShowAnimation(t)];case 3:return o.sent(),this.onAfterShow&&this.onAfterShow(),[2]}})})},t.prototype.hide=function(e,t){return void 0===e&&(e=!1),r(this,void 0,void 0,function(){var o,n;return s(this,function(a){switch(a.label){case 0:return o=this.node,0!==t&&((n=this.blocker)||((n=this.blocker=new cc.Node("blocker")).addComponent(cc.BlockInputEvents),n.setParent(o),n.setContentSize(o.getContentSize())),n.active=!0),this.onBeforeHide?[4,this.onBeforeHide(e)]:[3,2];case 1:a.sent(),a.label=2;case 2:return null==t&&(t=t<0?0:this.animationDuration),[4,this.playHideAnimation(t)];case 3:return a.sent(),this.blocker&&(this.blocker.active=!1),o.active=!1,this.onAfterHide&&this.onAfterHide(e),this.finishCallback&&this.finishCallback(e),[2]}})})},t.prototype.playShowAnimation=function(e){var t=this;return new Promise(function(o){var n=t.background,a=t.main;t.node.active=!0,n.active=!0,n.opacity=0,a.active=!0,a.scale=.5,a.opacity=0,cc.tween(n).to(.5*e,{opacity:150}).start(),cc.tween(a).to(e,{scale:1,opacity:255},{easing:"backOut"}).call(o).start()})},t.prototype.playHideAnimation=function(e){var t=this;return new Promise(function(o){cc.tween(t.background).delay(.5*e).to(.5*e,{opacity:0}).start(),cc.tween(t.main).to(e,{scale:.5,opacity:0},{easing:"backIn"}).call(o).start()})},t.prototype.init=function(){},t.prototype.updateDisplay=function(){},t.prototype.onBeforeShow=function(){return new Promise(function(e){return e()})},t.prototype.onAfterShow=function(){},t.prototype.onBeforeHide=function(){return new Promise(function(e){return e()})},t.prototype.onAfterHide=function(){},t.prototype.onSuspended=function(){return new Promise(function(e){return e()})},i([p({type:cc.Node,tooltip:!1})],t.prototype,"background",void 0),i([p({type:cc.Node,tooltip:!1})],t.prototype,"main",void 0),i([l],t)}(cc.Component);o.default=u,cc._RF.pop()},{}],PopupManager:[function(e,t,o){"use strict";cc._RF.push(t,"db199abt41ElIYEZ4AXRlbF","PopupManager");var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))(function(a,i){function r(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(r,s)}c((n=n.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var o,n,a,i,r={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(e){return function(t){return c([e,t])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;r;)try{if(o=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return r.label++,{value:i[1],done:!1};case 5:r.label++,n=i[1],i=[0];continue;case 7:i=r.ops.pop(),r.trys.pop();continue;default:if(!(a=(a=r.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){r=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){r.label=i[1];break}if(6===i[0]&&r.label<a[1]){r.label=a[1],a=i;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(i);break}a[2]&&r.ops.pop(),r.trys.pop();continue}i=t.call(e,r)}catch(s){i=[6,s],n=0}finally{o=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var i,r,s=e("./PopupBase");(function(e){e[e.Once=1]="Once",e[e.Normal=2]="Normal",e[e.Frequent=3]="Frequent"})(i||(i={})),function(e){e[e.Done=1]="Done",e[e.Failed=2]="Failed",e[e.Waiting=3]="Waiting"}(r||(r={}));var c=function(){function e(){}return Object.defineProperty(e,"prefabCache",{get:function(){return this._prefabCache},enumerable:!1,configurable:!0}),Object.defineProperty(e,"nodeCache",{get:function(){return this._nodeCache},enumerable:!1,configurable:!0}),Object.defineProperty(e,"current",{get:function(){return this._current},enumerable:!1,configurable:!0}),Object.defineProperty(e,"queue",{get:function(){return this._queue},enumerable:!1,configurable:!0}),Object.defineProperty(e,"suspended",{get:function(){return this._suspended},enumerable:!1,configurable:!0}),Object.defineProperty(e,"container",{get:function(){return this._container||cc.Canvas.instance.node},set:function(e){this._container=e},enumerable:!1,configurable:!0}),Object.defineProperty(e,"CacheMode",{get:function(){return i},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ShowResultType",{get:function(){return r},enumerable:!1,configurable:!0}),e.show=function(e,t,o){var i=this;return new Promise(function(c){return n(i,void 0,void 0,function(){var i,l,p,u=this;return a(this,function(h){switch(h.label){case 0:return o=this.parseParams(o),this._current||this.locked?o&&o.immediately?(this.locked=!1,[4,this.suspend()]):[3,2]:[3,3];case 1:return h.sent(),[3,3];case 2:return this.push(e,t,o),c(r.Waiting),[2];case 3:return this._current={path:e,options:t,params:o},i=this.getNodeFromCache(e),cc.isValid(i)?[3,5]:(this.loadStartCallback&&this.loadStartCallback(),[4,this.load(e)]);case 4:if(l=h.sent(),this.loadFinishCallback&&this.loadFinishCallback(),!cc.isValid(l))return cc.warn("[PopupManager]","\u5f39\u7a97\u52a0\u8f7d\u5931\u8d25",e),this._current=null,c(r.Failed),[2];i=cc.instantiate(l),h.label=5;case 5:return(p=i.getComponent(s.default))?(this._current.popup=p,this._current.node=i,i.setParent(this.container),i.setSiblingIndex(cc.macro.MAX_ZINDEX),p.finishCallback=function(t){return n(u,void 0,void 0,function(){var n=this;return a(this,function(a){switch(a.label){case 0:return t?[2]:(this.locked=this._suspended.length>0||this._queue.length>0,this.recycle(e,i,o.mode),this._current=null,c(r.Done),[4,new Promise(function(e){cc.Canvas.instance.scheduleOnce(e,n.interval)})]);case 1:return a.sent(),this.next(),[2]}})})},p.show(t),[2]):(cc.warn("[PopupManager]","\u672a\u627e\u5230\u5f39\u7a97\u7ec4\u4ef6",e),this._current=null,c(r.Failed),[2])}})})})},e.hide=function(){cc.isValid(this._current.popup)&&this._current.popup.hide()},e.getNodeFromCache=function(e){var t=this._nodeCache;if(t.has(e)){var o=t.get(e);if(cc.isValid(o))return o;t.delete(e)}var n=this._prefabCache;if(n.has(e)){var a=n.get(e);if(cc.isValid(a))return a.addRef(),cc.instantiate(a);n.delete(e)}return null},e.next=function(){if(!(this._current||0===this._suspended.length&&0===this._queue.length)){var e=null;if(e=this._suspended.length>0?this._suspended.shift():this._queue.shift(),this.locked=!1,cc.isValid(e.popup))return this._current=e,e.node.setParent(this.container),void e.popup.show(e.options);this.show(e.path,e.options,e.params)}},e.push=function(e,t,o){this._current||this.locked?(this._queue.push({path:e,options:t,params:o}),this._queue.sort(function(e,t){return e.params.priority-t.params.priority})):this.show(e,t,o)},e.suspend=function(){return n(this,void 0,void 0,function(){var e;return a(this,function(t){switch(t.label){case 0:return this._current?(e=this._current,this._suspended.push(e),[4,e.popup.onSuspended()]):[2];case 1:return t.sent(),[4,e.popup.hide(!0)];case 2:return t.sent(),this._current=null,[2]}})})},e.recycle=function(e,t,o){switch(o){case i.Once:this._nodeCache.delete(e),t.destroy(),this.release(e);break;case i.Normal:this._nodeCache.delete(e),t.destroy();break;case i.Frequent:t.removeFromParent(!1),this._nodeCache.set(e,t)}},e.load=function(e){var t=this;return new Promise(function(o){var n=t._prefabCache;if(n.has(e)){var a=n.get(e);if(cc.isValid(a))return void o(a);n.delete(e)}cc.resources.load(e,function(t,a){t?o(null):(n.set(e,a),o(a))})})},e.release=function(e){var t=this._nodeCache,o=t.get(e);o&&(t.delete(e),cc.isValid(o)&&o.destroy(),o=null);var n=this._prefabCache,a=n.get(e);a&&(a.refCount<=1&&n.delete(e),a.decRef(),a=null)},e.parseParams=function(e){return null==e?new l:"[object Object]"!==Object.prototype.toString.call(e)?(cc.warn("[PopupManager]","\u5f39\u7a97\u53c2\u6570\u65e0\u6548\uff0c\u4f7f\u7528\u9ed8\u8ba4\u53c2\u6570"),new l):(null==e.mode&&(e.mode=i.Normal),null==e.priority&&(e.priority=0),null==e.immediately&&(e.immediately=!1),e)},e._prefabCache=new Map,e._nodeCache=new Map,e._current=null,e._queue=[],e._suspended=[],e.locked=!1,e._container=null,e.interval=.05,e.loadStartCallback=null,e.loadFinishCallback=null,e}();o.default=c;var l=function(){this.mode=i.Normal,this.priority=0,this.immediately=!1};cc._RF.pop()},{"./PopupBase":"PopupBase"}],PropBubbleBoom:[function(e,t,o){"use strict";cc._RF.push(t,"f4f7a6KrkJH4Jdxfr4FVUG/","PropBubbleBoom");var n,a=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var a,i=arguments.length,r=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(i<3?a(r):i>3?a(t,o,r):a(t,o))||r);return i>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../GameConst"),s=e("../../Global"),c=e("../../Sound"),l=e("./BasePropBubble"),p=cc._decorator,u=p.ccclass,h=(p.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.handleCollided=function(e,t,o){void 0===o&&(o=null),this.stopMoving(),this.bubbleManager.insertBubble(t.x,t.y,this.getType(),e),this.reset();var n=this.bubbleManager.queryAround2NonEmptyBubbles(t);if(n||(n=[]),n.push(t),n){var a=n.length;if(a>0){c.default.BombImpact();for(var i=0;i<a;i++){var l=n[i],p=this.bubbleManager.bubbleDataArray[l.x][l.y];p&&p.node&&(this.bubbleManager.checkGift(l),this.bubbleManager.playEffect(r.GameConst.EFFECT_TYPE.BUBBLE_BOMB,p.node.getPosition(),-1),this.bubbleManager.playEffect(r.GameConst.EFFECT_TYPE.BUBBLE_DIE,p.node.getPosition(),-1,s.Global.comboScore),this.bubbleManager.removeBubble(l,p.node),this.bubbleManager.bubbleDataArray[l.x][l.y]=void 0)}var u=!1;a>1&&(u=!0,this.bubbleManager.showCombo());var h=this.bubbleManager.queryNonLinkedBubbles();u||(u=h),this.bubbleManager.handleColliedFinish(h?.2:0,.3,u)}else this.bubbleManager.handleColliedFinish(0,.3)}else console.log("\u653e\u7a7a\u70ae!!!"),this.bubbleManager.handleColliedFinish(0,.3)},i([u],t)}(l.default));o.default=h,cc._RF.pop()},{"../../GameConst":"GameConst","../../Global":"Global","../../Sound":"Sound","./BasePropBubble":"BasePropBubble"}],PropBubbleLaser:[function(e,t,o){"use strict";cc._RF.push(t,"9fda87uQ4lEzbj/f6S7LbAG","PropBubbleLaser");var n,a=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var a,i=arguments.length,r=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(i<3?a(r):i>3?a(t,o,r):a(t,o))||r);return i>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../BaseBubble"),s=e("./BasePropBubble"),c=cc._decorator,l=c.ccclass,p=(c.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.handleCollided=function(e,t,o,n){void 0===o&&(o=null),this.stopMoving(),this.reset(),n||(n=[]);var a=n.length;if(a>0){for(var i=0;i<a;i++){var s=n[i],c=this.bubbleManager.bubbleDataArray[s.x][s.y];c&&c.node&&(this.bubbleManager.checkGift(s),c.node.getComponent(r.default).playDeathAnimation(s),this.bubbleManager.bubbleDataArray[s.x][s.y]=void 0)}var l=!1;a>0&&(l=!0,this.bubbleManager.showCombo());var p=this.bubbleManager.queryNonLinkedBubbles();this.bubbleManager.handleColliedFinish(p?.2:0,.3,l)}else console.log("\u4e0d\u53d8!!!000"),this.bubbleManager.handleColliedFinish(0,.3)},t.prototype.move=function(){},i([l],t)}(s.default));o.default=p,cc._RF.pop()},{"../BaseBubble":"BaseBubble","./BasePropBubble":"BasePropBubble"}],PropBubbleLightning:[function(e,t,o){"use strict";cc._RF.push(t,"1bab5WirCFEvbt4NjcNfi1J","PropBubbleLightning");var n,a=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var a,i=arguments.length,r=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(i<3?a(r):i>3?a(t,o,r):a(t,o))||r);return i>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../Sound"),s=e("../BaseBubble"),c=e("./BasePropBubble"),l=cc._decorator,p=l.ccclass,u=(l.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.handleCollided=function(e,t,o){this.stopMoving(),this.bubbleManager.insertBubble(t.x,t.y,-1,e),this.reset();var n=this.bubbleManager.queryRowNonEmptyBubbles(o.x);if(n||(n=[]),n.push(t),n){var a=n.length;if(a>0){r.default.Lightning(),this.bubbleManager.showLightning(o);for(var i=0;i<a;i++){var c=n[i],l=this.bubbleManager.bubbleDataArray[c.x][c.y];l&&l.node&&(this.bubbleManager.checkGift(c),l.node.getComponent(s.default).playDeathAnimation(c),this.bubbleManager.bubbleDataArray[c.x][c.y]=void 0)}var p=!1;a>1&&(p=!0,this.bubbleManager.showCombo());var u=this.bubbleManager.queryNonLinkedBubbles();p||(p=u),this.bubbleManager.handleColliedFinish(u?.2:0,.3,p)}else console.log("\u4e0d\u53d8!!!000"),this.bubbleManager.handleColliedFinish(0,.3)}else console.log("\u4e0d\u53d8!!!000"),this.bubbleManager.handleColliedFinish(0,.3)},i([p],t)}(c.default));o.default=u,cc._RF.pop()},{"../../Sound":"Sound","../BaseBubble":"BaseBubble","./BasePropBubble":"BasePropBubble"}],PropBubbleNormal:[function(e,t,o){"use strict";cc._RF.push(t,"93367385JlPi5eSFvtEXcfX","PropBubbleNormal");var n,a=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var a,i=arguments.length,r=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(i<3?a(r):i>3?a(t,o,r):a(t,o))||r);return i>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../GameConst"),s=e("../../Global"),c=e("../BaseBubble"),l=e("../BubbleUtil"),p=e("./BasePropBubble"),u=cc._decorator,h=u.ccclass,b=(u.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.handleCollided=function(e,t,o){void 0===o&&(o=null),this.stopMoving();var n=this.bubbleManager.insertBubble(t.x,t.y,this.getNormalSubType(),e);this.reset();var a=this.bubbleManager.queryLinkedSameBubbles(n);if(a){for(var i=0,p=a.length,u=0;u<p;u++)(P=a[u])&&(i+=m=P.length);if(i>3){var h=0,b=0;for(u=0;u<p;u++){var d=0;if(P=a[u])for(var m=P.length,f=0;f<m;f++){var B=P[f];if((T=this.bubbleManager.bubbleDataArray[B.x][B.y])&&T.node){var v=this.bubbleManager.queryAroundIceBubbles(T);if(v&&v.length>0)for(var E=0;E<v.length;E++){var y=v[E];if(y){var _=this.bubbleManager.bubbleDataArray[y.x][y.y];_&&_.node&&(_.node.getComponent(c.default).iceBreaking(y,T.type),this.bubbleManager.playEffect(r.GameConst.EFFECT_TYPE.ICE_BOOM,_.node.getPosition(),-1))}}this.bubbleManager.checkGift(B),T.node.getComponent(c.default).playDeathAnimation(B,h+d),b=h+d,this.bubbleManager.bubbleDataArray[B.x][B.y]=void 0,d+=.02}}h+=.02}if(n&&n.node){(L=n.node.getPosition()).x<8*r.GameConst.BUBBLE_R?L.x=8*r.GameConst.BUBBLE_R:L.x>cc.winSize.width-8*r.GameConst.BUBBLE_R&&(L.x=cc.winSize.width-8*r.GameConst.BUBBLE_R);var g=s.Global.comboScore*(i-1);this.bubbleManager.showBigScore(L,g)}this.bubbleManager.showCombo(),this.bubbleManager.resetTagBubbleDataArray();var C=this.bubbleManager.queryNonLinkedBubbles();this.bubbleManager.handleColliedFinish(C?b+.4:b+.1,.3,!0)}else{for(u=0;u<p;u++){var P;if(P=a[u])for(m=P.length,f=0;f<m;f++){var T,G=P[f];(T=this.bubbleManager.bubbleDataArray[G.x][G.y]).isVisited=!1}}if(console.log("\u4e0d\u53d8!!! count="+i),n&&n.node&&(O=this.bubbleManager.queryAroundOneBlackHoleBubbles(n))){console.log("[Hole]","\u53d1\u73b0\u9ed1\u6d1e index="+O.x+","+O.y);var S=cc.v2(n.row,n.col),L=l.default.convertRowColToPos(O.x,O.y);n.node.getComponent(c.default).moveToBlackHole(S,L)}this.bubbleManager.handleColliedFinish(0,.3)}}else{var O;if(C=!1,n&&n.node&&(O=this.bubbleManager.queryAroundOneBlackHoleBubbles(n))){C=!0,console.log("[Hole]","\u53d1\u73b0\u9ed1\u6d1e index="+O.x+","+O.y);var N=cc.v2(n.row,n.col);L=l.default.convertRowColToPos(O.x,O.y),n.node.getComponent(c.default).moveToBlackHole(N,L)}this.bubbleManager.handleColliedFinish(0,.3)}},i([h],t)}(p.default));o.default=b,cc._RF.pop()},{"../../GameConst":"GameConst","../../Global":"Global","../BaseBubble":"BaseBubble","../BubbleUtil":"BubbleUtil","./BasePropBubble":"BasePropBubble"}],PropBubbleRainbow:[function(e,t,o){"use strict";cc._RF.push(t,"8e701Jm13dIdInk02omLRMo","PropBubbleRainbow");var n,a=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var a,i=arguments.length,r=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(i<3?a(r):i>3?a(t,o,r):a(t,o))||r);return i>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../GameConst"),s=e("../../Global"),c=e("../../Sound"),l=e("./BasePropBubble"),p=cc._decorator,u=p.ccclass,h=(p.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.handleCollided=function(e,t,o){void 0===o&&(o=null),this.stopMoving();var n=this.bubbleManager.insertBubble(t.x,t.y,this.getType(),e);this.reset();var a=this.bubbleManager.queryAround1NonEmptyBubbles(t);if(n&&n.node&&(this.bubbleManager.playEffect(r.GameConst.EFFECT_TYPE.RAINBOW_BOOM,n.node.getPosition(),-1),this.bubbleManager.playEffect(r.GameConst.EFFECT_TYPE.BUBBLE_DIE,n.node.getPosition(),-1,s.Global.comboScore),this.bubbleManager.removeBubble(t,n.node),this.bubbleManager.bubbleDataArray[t.x][t.y]=void 0),a){var i=a.length;if(i>0){for(var l=0;l<i;l++){var p=a[l],u=this.bubbleManager.getBubbleDataByIndex(p.x,p.y);if(u){var h=this.bubbleManager.queryLinkedSameBubbles(u);if(h){for(var b=0,d=h.length,m=0;m<d;m++)(y=h[m])&&(b+=f=y.length);if(b>0){for(m=0;m<d;m++)if(y=h[m])for(var f=y.length,B=0;B<f;B++){var v=y[B],E=this.bubbleManager.bubbleDataArray[v.x][v.y];E&&E.node&&(this.bubbleManager.checkGift(v),this.bubbleManager.playEffect(r.GameConst.EFFECT_TYPE.RAINBOW_BOOM,E.node.getPosition(),-1),this.bubbleManager.playEffect(r.GameConst.EFFECT_TYPE.BUBBLE_DIE,E.node.getPosition(),-1,s.Global.comboScore),c.default.RainbowImpact(),this.bubbleManager.removeBubble(v,E.node),this.bubbleManager.bubbleDataArray[v.x][v.y]=void 0)}}else{for(m=0;m<d;m++){var y;if(y=h[m])for(f=y.length,B=0;B<f;B++){var _=y[B];this.bubbleManager.bubbleDataArray[_.x][_.y].isVisited=!1}}console.log("\u4e0d\u53d8!!! count="+b),this.bubbleManager.handleColliedFinish(0,.3)}}}}var g=!1;i>0&&(g=!0,this.bubbleManager.showCombo());var C=this.bubbleManager.queryNonLinkedBubbles();this.bubbleManager.handleColliedFinish(C?.2:0,.3,g)}else console.log("\u4e0d\u53d8!!!000"),this.bubbleManager.handleColliedFinish(0,.3)}else console.log("\u4e0d\u53d8!!!000"),this.bubbleManager.handleColliedFinish(0,.3)},i([u],t)}(l.default));o.default=h,cc._RF.pop()},{"../../GameConst":"GameConst","../../Global":"Global","../../Sound":"Sound","./BasePropBubble":"BasePropBubble"}],SoundManager:[function(e,t,o){"use strict";cc._RF.push(t,"f740a+++tlCh6E/7PSfKXkP","SoundManager"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../ppl/GameConst"),a=e("../ppl/Global"),i=function(){function e(){}return e.setSoundsEnable=function(t){e.setSFXEnable(t),e.setBGMEnable(t)},e.setSFXEnable=function(t){cc.audioEngine.setEffectsVolume(1==t?1:0),e.isSfxEnabled=t,t?cc.audioEngine.resumeAllEffects():cc.audioEngine.pauseAllEffects()},e.useCCAudioEngine=function(){this._useCCAudioEngine=!0},e.useDefaultAudioEngine=function(){this._useCCAudioEngine=!1},e.setBGMEnable=function(t){cc.audioEngine.setMusicVolume(1==t?.5:0),e.isBgmEnabled=t,t?cc.audioEngine.resumeMusic():cc.audioEngine.pauseMusic()},e.playEffect=function(t,o){if(void 0===o&&(o=!1),t)return e.isSfxEnabled?cc.audioEngine.playEffect(t,o):void 0},e.stopMusic=function(){cc.audioEngine.stopMusic()},e.playMusic=function(t,o){if(void 0===o&&(o=!0),e.isBgmEnabled)return cc.audioEngine.playMusic(t,o)},e.vibrate=function(){a.Global.getShake()==n.GameConst.YES?cc.sys.WECHAT_GAME==cc.sys.platform||(cc.sys.os===cc.sys.OS_ANDROID&&jsb.reflection.callStaticMethod("org/cocos2dx/javascript/AppActivity","vibrate","()V"),console.log("not support vibrate on except-wx platfrom ")):console.log("\u9707\u52a8\u5df2\u5173\u95ed\uff01 ")},e.isSfxEnabled=!0,e.isBgmEnabled=!0,e._useCCAudioEngine=!1,e}();o.default=i,cc._RF.pop()},{"../ppl/GameConst":"GameConst","../ppl/Global":"Global"}],Sound:[function(e,t,o){"use strict";cc._RF.push(t,"c21f26OWW1LmrFB4Ujke7Bo","Sound"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../common/SoundManager"),a=e("./GameConst"),i=e("./Global"),r=function(){function e(){}return e.GameBGM=function(){n.default.stopMusic(),this.playMusic(a.GameConst.PATH.AUDIO+"bubble_bgm1",!0)},e.LevelBGM=function(){n.default.stopMusic(),this.playMusic(a.GameConst.PATH.AUDIO+"bubble_bgm1",!0)},e.init=function(e){var t=this,o=i.Global.getSoundMusic();n.default.setSoundsEnable(o==a.GameConst.YES),cc.loader.loadResDir("ppl/audio",cc.AudioClip,function(o,n,a){for(var i=0;i<n.length;i++)t.clips[a[i]]=n[i],console.log("[Sound]","load:clip="+n[i]);e()})},e.playMusic=function(t,o){console.log("[Sound]","play music path="+t),n.default.playEffect(e.clips[t],o)},e.playSfx=function(t,o){console.log("[Sound]","play:path="+t),n.default.playEffect(e.clips[t],o)},e.Win=function(){this.playSfx(a.GameConst.PATH.AUDIO+"target_done",!1)},e.Fail=function(){this.playSfx(a.GameConst.PATH.AUDIO+"play_fail",!1)},e.Shoot=function(){this.playSfx(a.GameConst.PATH.AUDIO+"bubble_shoot",!1)},e.ShootLaser=function(){this.playSfx(a.GameConst.PATH.AUDIO+"pp_laser",!1)},e.BallImpact=function(){this.playSfx(a.GameConst.PATH.AUDIO+"bubble_pop1",!1)},e.RainbowImpact=function(){this.playSfx(a.GameConst.PATH.AUDIO+"pp_rainbow",!1)},e.Ice=function(){this.playSfx(a.GameConst.PATH.AUDIO+"bubble_ice",!1)},e.BombImpact=function(){this.playSfx(a.GameConst.PATH.AUDIO+"explosion",!1)},e.Lightning=function(){this.playSfx(a.GameConst.PATH.AUDIO+"bubble_lightning",!1)},e.Fall=function(){this.playSfx(a.GameConst.PATH.AUDIO+"bubble_fall",!1)},e.Combo=function(e){switch(e){case 3:this.playSfx(a.GameConst.PATH.AUDIO+"cool",!1);break;case 6:this.playSfx(a.GameConst.PATH.AUDIO+"good",!1);break;case 9:this.playSfx(a.GameConst.PATH.AUDIO+"excellent",!1)}},e.Remove=function(){this.playSfx(a.GameConst.PATH.AUDIO+"xiaochu",!1),n.default.vibrate()},e.SwitchBubble=function(){this.playSfx(a.GameConst.PATH.AUDIO+"bubble_switch",!1)},e.clips={},e}();o.default=r,cc._RF.pop()},{"../common/SoundManager":"SoundManager","./GameConst":"GameConst","./Global":"Global"}],Splash:[function(e,t,o){"use strict";cc._RF.push(t,"20cb1Z0Cz5F84X2i5mrzjPW","Splash");var n,a=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var a,i=arguments.length,r=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(i<3?a(r):i>3?a(t,o,r):a(t,o))||r);return i>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,s=r.ccclass,c=r.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.loadingLabel=null,t.loadingProgressBar=null,t}return a(t,e),t.prototype.onLoad=function(){},t.prototype.onProgress=function(e,t){console.log("\u8fdb\u5ea6\uff1a"+e+"/"+t);var o=e/t;o>this.progress&&(this.progress=o),this.loadingProgressBar.progress=this.progress,this.loadingLabel.string=Math.floor(100*this.progress)+"%"},t.prototype.start=function(){this.progress=0,cc.director.preloadScene("game",this.onProgress.bind(this),function(){cc.director.loadScene("game")})},i([c(cc.Label)],t.prototype,"loadingLabel",void 0),i([c(cc.ProgressBar)],t.prototype,"loadingProgressBar",void 0),i([s],t)}(cc.Component);o.default=l,cc._RF.pop()},{}],TouchMgr:[function(e,t,o){"use strict";cc._RF.push(t,"1e3d0DIcCpI8J3NETfV3+Yu","TouchMgr");var n,a=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var a,i=arguments.length,r=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(i<3?a(r):i>3?a(t,o,r):a(t,o))||r);return i>3&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../common/EventManager"),s=e("./GameConst"),c=cc._decorator,l=c.ccclass,p=c.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.shooter=null,t.shooterLayer=null,t}return a(t,e),t.prototype.onLoad=function(){this.openTouch()},t.prototype.openTouch=function(){this.node.on(cc.Node.EventType.TOUCH_START,this._touchStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this._touchsMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this._touchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this._touchCancel,this)},t.prototype.closeTouch=function(){this.node.off(cc.Node.EventType.TOUCH_START,this._touchStart,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this._touchsMove,this),this.node.off(cc.Node.EventType.TOUCH_END,this._touchEnd,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this._touchCancel,this)},t.prototype._touchStart=function(e){var t=this.convertToDegree(e);r.EventManager.getInstance().sendEvent(s.GameConst.EVENT.BUBBLE_SHOOT_MOVE,t)},t.prototype._touchsMove=function(e){var t=this.convertToDegree(e);r.EventManager.getInstance().sendEvent(s.GameConst.EVENT.BUBBLE_SHOOT_MOVE,t)},t.prototype._touchEnd=function(e){var t=this.convertToDegree(e);r.EventManager.getInstance().sendEvent(s.GameConst.EVENT.BUBBLE_SHOOT,t)},t.prototype._touchCancel=function(){r.EventManager.getInstance().sendEvent(s.GameConst.EVENT.BUBBLE_SHOOT,0)},t.prototype.convertToDegree=function(e){var t=e.getLocation(),o=this.shooterLayer.convertToWorldSpaceAR(this.shooter.getPosition()),n=t.x-o.x,a=t.y-o.y,i=Math.atan2(a,n),r=cc.misc.radiansToDegrees(i);return(r>165||r<15)&&(r=0),r},i([p(cc.Node)],t.prototype,"shooter",void 0),i([p(cc.Node)],t.prototype,"shooterLayer",void 0),i([l],t)}(cc.Component);o.default=u,cc._RF.pop()},{"../common/EventManager":"EventManager","./GameConst":"GameConst"}],Utils:[function(e,t,o){"use strict";cc._RF.push(t,"ffd2aOz89RM7oJDA4SvuCVW","Utils"),Object.defineProperty(o,"__esModule",{value:!0}),o.Utils=void 0;var n=function(){function e(){}return e.loadPicture=function(t,o){return new Promise(function(n,a){var i=function(e,o){e?(console.error(e),a()):(o instanceof cc.Texture2D&&(o=new cc.SpriteFrame(o)),t.spriteFrame=o,n())};o.startsWith("http")?cc.sys.isNative?e.download(o).then(function(e){cc.assetManager.loadRemote(e,i)}).catch(function(){a()}):cc.assetManager.loadRemote(o,i):cc.resources.load(o,cc.SpriteFrame,i)})},e.getComponentInChildren=function(e,t){for(var o=0;o<e.childrenCount;o++){var n=e.children[o].getComponent(t);if(n)return n}return null},e.bindButtonEvent=function(e,t,o,n,a){var i=e.clickEvents.find(function(e){return e.target==t&&e.component==o&&e.handler==e.handler&&e.customEventData==a});i||((i=new cc.Component.EventHandler).target=t,i.component=o,i.handler=n,i.customEventData=a,e.clickEvents.push(i))},e.getToday=function(){var e=function(e){return e<10?"0"+e:""+e},t=new Date,o=t.getFullYear()+e(t.getMonth()+1)+e(t.getDate());return parseInt(o)},e.formatTimeMS=function(e,t,o){var n;void 0===o&&(o=":");var a=function(e){return e<10?"0"+e:e},i=new Date,r=i.getTimezoneOffset();i.setTime(e+6e4*r);var s=i.getDate()-1,c=i.getHours()+24*s,l=i.getMinutes(),p=i.getSeconds();return 1==t?n=""+a(c)+o+a(l)+o+a(p):2==t?n=a(c)+"\u65f6"+a(l)+"\u5206"+a(p)+"\u79d2":3==t?(n=c>0?""+a(c)+o:"",n+=""+a(l)+o+a(p)):4==t&&(n=c>0?a(c)+"\u65f6":"",n+=a(l)+"\u5206"+a(p)+"\u79d2"),n},e.randomNum=function(e,t,o){void 0===o&&(o=!0);var n=t-e,a=Math.random()*n+e;return o&&(a=Math.round(a)),a},e.formatString=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];return t.forEach(function(t,o){e=e.replace("{"+o+"}",t)}),e},e.load=function(e,t,o){return new Promise(function(n,a){cc.resources.load(e,t,o,function(e,t){e?a(e):n(t)})})},e.loadRemote=function(e){return new Promise(function(t,o){cc.assetManager.loadRemote(e,function(e,n){e?o(e):t(n)})})},e.loadJson=function(e){return new Promise(function(t){cc.loader.loadRes(e,cc.JsonAsset,function(e,o){t(o.json)})})},e.sleep=function(e){return new Promise(function(t){setTimeout(function(){t()},1e3*e)})},e.loadArray=function(e,t){var o=[],n=[],a=[];return new Promise(function(i,r){e.forEach(function(s,c){cc.resources.load(s,function(a,i){if(o[c]=a||0,n[c]=i||0,t){for(var r=0,s=0,l=0;l<e.length;l++)r+=o[l]||0,s+=n[l]||0;t(r,s)}},function(t,o){t?r(t):(a.push(o),a.length==e.length&&i(a))})})})},e.loadDir=function(e,t){return new Promise(function(o,n){cc.resources.loadDir(e,t,function(e,t){e?n(e):o(t)})})},e.download=function(e,t){var o=this;if(!cc.sys.isNative)return new Promise(function(e){e()});var n=e.substr(e.lastIndexOf("."));return this.downloadProgress.get(e)||this.downloadProgress.set(e,[]),t&&this.downloadProgress.get(e).push(t),new Promise(function(t,a){cc.assetManager.downloader.download(e,e,n,{onFileProgress:function(t,n){o.downloadProgress.get(e).forEach(function(e){return e(t,n)})}},function(n,i){o.downloadProgress.delete(e),n?a(n):t(i)})})},e.uuid=function(){for(var e=[],t=0;t<36;t++)e[t]="0123456789abcdef".substr(Math.floor(16*Math.random()),1);return e[14]="4",e[19]="0123456789abcdef".substr(3&e[19]|8,1),e[8]=e[13]=e[18]=e[23]="-",e.join("")},e.getRandom=function(e,t){var o=t-e+1;return e+Math.floor(Math.random()*o)},e.shuffle=function(e){var t,o=0,n=0;for(o=e.length-1;o>0;o--)n=Math.floor(Math.random()*(o+1)),t=e[o],e[o]=e[n],e[n]=t;return e},e.isNextDay=function(t){return e.isGreaterDate(new Date,new Date(t))},e.isGreaterDate=function(t,o){var n=t.getTime()-o.getTime();return n>e.ONE_DAY_TIMESTAMP||n>0&&t.getDate()!=o.getDate()},e.isGreaterDays=function(t,o){return void 0===t&&(t=0),void 0===o&&(o=7),(new Date).getTime()-t>e.ONE_DAY_TIMESTAMP*o},e.log=function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];e.DEBUG_LOG&&console.log(t)},e.downloadProgress=new Map,e.ONE_DAY_TIMESTAMP=864e5,e}();o.Utils=n,cc._RF.pop()},{}]},{},["EventManager","NodeAction","PoolManager","PopupBase","PopupManager","SoundManager","Utils","AddBubble","Effect","EffectBigScore","EffectCombo","EffectGameStartTip","Game","GameConst","Global","Level","LevelData","ListView","ListViewItem","Sound","Splash","TouchMgr","AimDot","AimLine","BaseBubble","BubbleData","BubbleManager","BubbleUtil","BasePropBubble","PropBubbleBoom","PropBubbleLaser","PropBubbleLightning","PropBubbleNormal","PropBubbleRainbow","PopAddBubble","PopChestList","PopChestOpen","PopChestOver","PopChestReward","PopCoinGift","PopDaily","PopFail","PopGuide","PopLevelSelect","PopOnlineGift","PopPause","PopRandomGift","PopShop"]);