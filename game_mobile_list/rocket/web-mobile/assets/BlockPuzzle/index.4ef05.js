window.__require=function t(e,o,i){function n(a,s){if(!o[a]){if(!e[a]){var c=a.split("/");if(c=c[c.length-1],!e[c]){var l="function"==typeof __require&&__require;if(!s&&l)return l(c,!0);if(r)return r(c,!0);throw new Error("Cannot find module '"+a+"'")}a=c}var p=o[a]={exports:{}};e[a][0].call(p.exports,function(t){return n(e[a][1][t]||t)},p,p.exports,t,e,o,i)}return o[a].exports}for(var r="function"==typeof __require&&__require,a=0;a<i.length;a++)n(i[a]);return n}({BPActionUIPanel:[function(t,e,o){"use strict";cc._RF.push(e,"a1cc15Jd1pI6bPt+viyPrwm","BPActionUIPanel");var i,n,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,o,a):n(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.UIActionType=void 0,function(t){t[t.POSITION=0]="POSITION",t[t.SCALE_OUT=1]="SCALE_OUT"}(n=o.UIActionType||(o.UIActionType={}));var s=cc._decorator,c=s.ccclass,l=s.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_Background=null,e.m_ActionNode=null,e.m_OriginActionNodePosition=null,e.m_OriginActionNodeOpacity=0,e.m_OriginActionNodeScale=1,e.m_OriginBackgroundOpacity=null,e}return r(e,t),e.prototype.GetBackground=function(){return this.m_Background},e.prototype.GetActionNode=function(){return this.m_ActionNode},e.prototype.EnterActionType=function(){return n.POSITION},e.prototype.EnterActionEasingType=function(){return cc.easing.backOut},e.prototype.EnterSpeedFactor=function(){return 1},e.prototype.EnterBackgroundSeconds=function(){return.6*this.EnterSpeedFactor()},e.prototype.EnterSeconds=function(){return.4*this.EnterSpeedFactor()},e.prototype.EnterDelaySeconds=function(){return.3*this.EnterSpeedFactor()},Object.defineProperty(e.prototype,"EnterActionSeconds",{get:function(){return this.EnterSeconds()+this.EnterDelaySeconds()},enumerable:!1,configurable:!0}),e.prototype.OnCreate=function(){switch(this.EnterActionType()){case n.SCALE_OUT:this.m_OriginActionNodeScale=this.GetActionNode().scale,this.m_OriginActionNodeOpacity=this.GetActionNode().opacity;break;default:this.m_OriginActionNodePosition=this.GetActionNode().position}this.m_OriginBackgroundOpacity=this.GetBackground().opacity,this.GetBackground().opacity=0},e.prototype.OnOpen=function(){var t=this;switch(ii.UIUtil.showAction(this.GetBackground(),this.EnterBackgroundSeconds(),{opacity:this.m_OriginBackgroundOpacity}),this.EnterActionType()){case n.SCALE_OUT:this.GetActionNode().active=!0,this.GetActionNode().scale=1,this.GetActionNode().opacity=0,cc.tween(this.GetActionNode()).delay(this.EnterDelaySeconds()).set({opacity:this.m_OriginActionNodeOpacity}).to(this.EnterSeconds(),{opacity:255}).start();break;default:this.GetActionNode().position=this.m_OriginActionNodePosition,ii.UIUtil.moveAction(this.GetActionNode(),!0,this.m_OriginActionNodePosition,this.EnterSeconds(),function(){return t.OnEnter()},this.EnterDelaySeconds(),this.EnterActionEasingType())}},e.prototype.OnRelease=function(){},e.prototype.ExitWithAction=function(t,e){var o=this;switch(void 0===e&&(e=!1),this.EnterActionType()){case n.SCALE_OUT:cc.tween(this.GetActionNode()).to(.3,{scale:this.m_OriginActionNodeScale,opacity:this.m_OriginActionNodeOpacity},{easing:cc.easing.backIn}).set({active:!1}).start();break;default:var i=e?cc.v3(-this.m_OriginActionNodePosition.x,-this.m_OriginActionNodePosition.y,0):this.m_OriginActionNodePosition;ii.UIUtil.moveAction(this.GetActionNode(),!1,i,.3)}ii.UIUtil.hideAction(this.GetBackground(),.3,{opacity:0},function(){o.Close(),t&&t()},.4)},e.prototype.OnEnter=function(){},a([l(cc.Node)],e.prototype,"m_Background",void 0),a([l(cc.Node)],e.prototype,"m_ActionNode",void 0),a([c],e)}(ii.UIPanel);o.default=p,cc._RF.pop()},{}],BPAudioCfg:[function(t,e,o){"use strict";cc._RF.push(e,"1b8e1eGeZFO07zli2n74aT0","BPAudioCfg"),Object.defineProperty(o,"__esModule",{value:!0});var i=function(){function t(){}return t.GetGLC=function(t){return t<this.m_GLCs.length?this.m_GLCs[t]:this.m_GLCs[this.m_GLCs.length-1]},t.Register=function(t){console.info("BPAudioCfg::Register("+t+") >> \u6ce8\u518c Audio \u8d44\u6e90"),ii.registerResDict(this.audio,t,ii.EResType.Audio)},t.audio={default_effect:"audio.default_effect",bomb:"audio.bomb",cd:"audio.cd",clear:"audio.clear",lose:"audio.lose",lihua:"audio.lihua",pass_best_score:"audio.pass_best_score",pick_up:"audio.pick_up",put_down:"audio.put_down",rocket_start:"audio.rocket_start",rocket_hit:"audio.rocket_hit",star_reach:"audio.star_reach",star_pop:"audio.star_pop",tip_exit:"audio.tip_exit",tile_clear:"audio.tile_clear",win:"audio.win",win_new_record:"audio.win_new_record",glc_0_cool:"audio.glc_0_cool",glc_1_great:"audio.glc_1_great",glc_2_awesome:"audio.glc_2_awesome",glc_3_perfect:"audio.glc_3_perfect",glc_4_amazing:"audio.glc_4_amazing"},t.m_GLCs=[t.audio.glc_0_cool,t.audio.glc_1_great,t.audio.glc_2_awesome,t.audio.glc_3_perfect,t.audio.glc_4_amazing],t}();o.default=i,cc._RF.pop()},{}],BPBlockLocationType:[function(t,e,o){"use strict";var i;cc._RF.push(e,"458a9UH6vhHDoZZ2qeD8wyL","BPBlockLocationType"),Object.defineProperty(o,"__esModule",{value:!0}),function(t){t[t.NORMAL=0]="NORMAL",t[t.STAGE=1]="STAGE"}(i||(i={})),o.default=i,cc._RF.pop()},{}],BPClearInfo:[function(t,e,o){"use strict";cc._RF.push(e,"369fbJnJ9pFn5Vw+GUy44Md","BPClearInfo"),Object.defineProperty(o,"__esModule",{value:!0}),o.BPClearInfo=void 0;var i=function(){function t(){this.clearTiles=null,this.reduceTiles=null,this.score=0,this.combo=0,this.clearRocketCnt=0,this.clearBombCnt=0,this.m_IsUsing=!1}return t.prototype.BeginUse=function(){console.assert(!1===this.m_IsUsing),this.m_IsUsing=!0,this.clearTiles=ii.AnyQueue.Borrow(),this.reduceTiles=ii.AnyQueue.Borrow()},t.prototype.EndUse=function(){console.assert(!0===this.m_IsUsing),this.m_IsUsing=!1,this.clearTiles.Return(),this.reduceTiles.Return(),this.score=0,this.clearRocketCnt=0,this.clearBombCnt=0},t}();o.BPClearInfo=i,cc._RF.pop()},{}],BPContinueUIPanel:[function(t,e,o){"use strict";cc._RF.push(e,"3e7fbz6hXBItqN0GS0ohIU+","BPContinueUIPanel");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,o,a):n(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../../../StartScene/Script/GameApp"),s=t("../../../../../StartScene/Script/HttpMgr"),c=t("../../BPAudioCfg"),l=t("../../_Public/UIPanel/BPActionUIPanel"),p=cc._decorator,u=p.ccclass,h=p.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_StarLabel=null,e.gameoverTitleNode=null,e.continueNode=null,e.nothanksNode=null,e.newgameNode=null,e.retryNode=null,e.adSpriteNode=null,e.tipsLbl=null,e._userData=null,e._boardParent=null,e}return n(e,t),e.prototype.OnOpen=function(e){var o=this;t.prototype.OnOpen.call(this,null),this._userData=e,ii.AudioMgr.ins.PlayEffect(c.default.audio.lose),this.m_StarLabel.string=e.Star+"/"+e.TargetStar,this.Display(!1),this._boardParent=this._userData.Board.parent,this.scheduleOnce(function(){return ii.UIUtil.transferTo(o._userData.Board,o.node,!1)},0),this.SetIIClickHandler("OnContinue",function(){return o.Continue()}),this.SetIIClickHandler("OnNoThanks",function(){return o.GameOver()}),this.SetIIClickHandler("OnNewGame",function(){return o.ExitWithAction(e.OnNewGame,!1)}),this.SetIIClickHandler("OnRetry",function(){return o.ExitWithAction(e.OnRetry,!1)}),this.tipsLbl.node.active=!1,ii.App.ins.p.ad.ShowBanner(!0)},e.prototype.OnRelease=function(){t.prototype.OnRelease.call(this),ii.UIUtil.transferTo(this._userData.Board,this._boardParent,!1),this._boardParent=null,ii.App.ins.p.ad.ShowBanner(!1)},e.prototype.Continue=function(){if(a.default.Release){var t="/api/smallGameCast",e=localStorage.getItem("userToken");console.log("\u8bf7\u6c42url122="+t);var o=new FormData;o.append("token",e),o.append("game_id","6");var i=this;s.httpPost(t,function(t,e){0===Number(t)&&(1===Number(e.code)?(console.log("\u4fc4\u7f57\u65af\u6d88\u9664\u7ee7\u7eed="+e.message),i.ExitWithAction(i._userData.OnContinue,!1)):i.ShowTips(e.message))},o)}else this.ExitWithAction(this._userData.OnContinue,!1)},e.prototype.GameOver=function(){this.Display(!0)},e.prototype.Display=function(t){this.gameoverTitleNode.active=t,this.continueNode.active=!t,this.nothanksNode.active=!t,this.newgameNode.active=t,this.retryNode.active=t},e.prototype.ShowTips=function(t){var e=this;this.tipsLbl.node.active=!0,this.tipsLbl.string=t,setTimeout(function(){e.tipsLbl.node.active=!1},3e3)},r([h({type:cc.Label,tooltip:"\u5b8c\u6210\u5ea6"})],e.prototype,"m_StarLabel",void 0),r([h({type:cc.Node})],e.prototype,"gameoverTitleNode",void 0),r([h({type:cc.Node})],e.prototype,"continueNode",void 0),r([h({type:cc.Node})],e.prototype,"nothanksNode",void 0),r([h({type:cc.Node})],e.prototype,"newgameNode",void 0),r([h({type:cc.Node})],e.prototype,"retryNode",void 0),r([h({type:cc.Node})],e.prototype,"adSpriteNode",void 0),r([h({type:cc.Label,tooltip:"tips"})],e.prototype,"tipsLbl",void 0),r([u],e)}(l.default);o.default=f,cc._RF.pop()},{"../../../../../StartScene/Script/GameApp":void 0,"../../../../../StartScene/Script/HttpMgr":void 0,"../../BPAudioCfg":"BPAudioCfg","../../_Public/UIPanel/BPActionUIPanel":"BPActionUIPanel"}],BPDataBlock:[function(t,e,o){"use strict";cc._RF.push(e,"3b60dRjpr5DrK/raP5rSpC9","BPDataBlock"),Object.defineProperty(o,"__esModule",{value:!0}),o.BPBlockSnapData=void 0;var i=t("./BPDataTile"),n=t("../Type/BPBlockLocationType"),r=function(){function t(){this.ui=null,this.location=n.default.NORMAL,this.index=-1,this.color=0,this.width=0,this.height=0,this.tiles=null,this.tileSize=0,this.isCanputDown=!1}return t.Borrow=function(){var e=ii.ReferencePool.Borrow(t);return e.tiles=ii.AnyQueue.Borrow(),e},t.prototype.Reset=function(){this.ui=null},t.prototype.Return=function(){this.tiles.Return(),this.tiles=null,ii.ReferencePool.Return(t,this)},t.prototype.InitWithConfigData=function(t,e,o,n,r,a,s){var c=this;return this.location=t,this.index=e,this.color=o,this.width=n.width,this.height=n.height,this.tileSize=r,n.tiles.forEach(function(t){return c.tiles.Enqueue(i.default.Borrow().Init(t.col,t.row,c.color,a,s,1,1))}),this},t.prototype.InitWithSnap=function(t){var e=this;return this.location=t.location,this.index=t.index,this.color=t.color,this.width=t.width,this.height=t.height,this.tileSize=t.tileSize,t.tiles.forEach(function(t){return e.tiles.Enqueue(i.default.Borrow().InitWithSnap(t))}),this},t.prototype.Snap=function(){var t=new a;return t.location=this.location,t.index=this.index,t.color=this.color,t.width=this.width,t.height=this.height,t.tileSize=this.tileSize,this.tiles.ForEach(function(e){return t.tiles.push(e.Snap())}),t},t.prototype.Rotate=function(){var t;t=[this.height,this.width],this.width=t[0],this.height=t[1];var e=5,o=5;this.tiles.ForEach(function(t){t.Rotate(),t.col<e&&(e=t.col),t.row<o&&(o=t.row)}),this.tiles.ForEach(function(t){t.col-=e,t.row-=o})},t.prototype.ChangeAnyTileTo=function(t){var e=ii.rand.IntBetween(0,this.tiles.Count),o=this.tiles.FetchByIndex(e);o.typ=t,o.toolDir=ii.rand.IntBetween(0,4)},t}();o.default=r;var a=function(){this.location=n.default.NORMAL,this.index=-1,this.color=0,this.width=0,this.height=0,this.tileSize=0,this.isCanputDown=!1,this.tiles=[]};o.BPBlockSnapData=a,cc._RF.pop()},{"../Type/BPBlockLocationType":"BPBlockLocationType","./BPDataTile":"BPDataTile"}],BPDataBomb:[function(t,e,o){"use strict";cc._RF.push(e,"a2be0zIx3lH7I/flSbcMWH4","BPDataBomb"),Object.defineProperty(o,"__esModule",{value:!0});var i=t("./BPDataExplosion"),n=t("../Type/BPExplosionType"),r=function(){function t(){this.col=0,this.row=0,this.toolDir=ii.Dir.Right,this.explosions=null,this.Order=-1}return t.Borrow=function(){var e=ii.ReferencePool.Borrow(t);return e.explosions=ii.AnyQueue.Borrow(),e},t.prototype.Return=function(){this.explosions.Return(),ii.ReferencePool.Return(t,this)},t.prototype.Reset=function(){},t.prototype.Init=function(t){return this.col=t.col,this.row=t.row,this.toolDir=t.toolDir,this.Order=t.dismissInfo.Order,console.assert(0==this.explosions.Count),this.__CheckToAddExplosion(this.col-1,this.row-1),this.__CheckToAddExplosion(this.col,this.row-1),this.__CheckToAddExplosion(this.col+1,this.row-1),this.__CheckToAddExplosion(this.col-1,this.row),this.__CheckToAddExplosion(this.col+1,this.row),this.__CheckToAddExplosion(this.col-1,this.row+1),this.__CheckToAddExplosion(this.col,this.row+1),this.__CheckToAddExplosion(this.col+1,this.row+1),this},t.prototype.__CheckToAddExplosion=function(t,e){this.explosions.Enqueue(i.default.Borrow().Init(n.BPExplosionType.Bomb,t,e,this.col,this.row))},t}();o.default=r,cc._RF.pop()},{"../Type/BPExplosionType":"BPExplosionType","./BPDataExplosion":"BPDataExplosion"}],BPDataDragger:[function(t,e,o){"use strict";cc._RF.push(e,"fc34ayKNQ5GI6OqUB/478/D","BPDataDragger"),Object.defineProperty(o,"__esModule",{value:!0});var i=t("../Type/BPBlockLocationType"),n=function(){function t(t,e){this.ui=null,this.block=null,this.location=i.default.NORMAL,this.location=t,this.index=e}return t.prototype.IsLocationNormal=function(){return this.location==i.default.NORMAL},t.prototype.IsLocationStage=function(){return this.location==i.default.STAGE},t.prototype.RemoveBlock=function(){var t=this.block;return this.block=null,t},t}();o.default=n,cc._RF.pop()},{"../Type/BPBlockLocationType":"BPBlockLocationType"}],BPDataExplosion:[function(t,e,o){"use strict";cc._RF.push(e,"81b41kPYcNPsJBcKb/v74Cx","BPDataExplosion"),Object.defineProperty(o,"__esModule",{value:!0});var i=t("../Type/BPExplosionType"),n=function(){function t(){this.col=0,this.row=0,this.typ=i.BPExplosionType.Bomb,this.origin=null}return t.Borrow=function(){var e=ii.ReferencePool.Borrow(t);return e.origin=ii.Tile.Borrow(),e},t.prototype.Return=function(){this.origin.Return(),ii.ReferencePool.Return(t,this)},t.prototype.Reset=function(){},t.prototype.Init=function(t,e,o,i,n){return this.col=e,this.row=o,this.typ=t,this.origin.col=i,this.origin.row=n,this},t}();o.default=n,cc._RF.pop()},{"../Type/BPExplosionType":"BPExplosionType"}],BPDataRocketHalf:[function(t,e,o){"use strict";cc._RF.push(e,"b5c12PkKahOHptv0QzUGp47","BPDataRocketHalf"),Object.defineProperty(o,"__esModule",{value:!0});var i=t("./BPDataExplosion"),n=t("../Type/BPExplosionType"),r=function(){function t(){this.col=0,this.row=0,this.toolDir=ii.Dir.Right,this.ds=0,this.total_ds=0,this.explosions=null}return t.Borrow=function(){var e=ii.ReferencePool.Borrow(t);return e.explosions=ii.AnyQueue.Borrow(),e},t.prototype.Return=function(){this.explosions.Return(),ii.ReferencePool.Return(t,this)},t.prototype.Reset=function(){this.ds=0,this.total_ds=0,this.explosions.RemoveAll()},t.prototype.Init=function(t,e,o,r,a){switch(this.col=t,this.row=e,this.toolDir=o,this.toolDir){case ii.Dir.Right:for(var s=t+1;s<r;++s)this.explosions.Enqueue(i.default.Borrow().Init(n.BPExplosionType.Rocket,s,this.row,t,e));break;case ii.Dir.Left:for(s=t-1;s>=0;--s)this.explosions.Enqueue(i.default.Borrow().Init(n.BPExplosionType.Rocket,s,this.row,t,e));break;case ii.Dir.Bottom:for(var c=e-1;c>=0;--c)this.explosions.Enqueue(i.default.Borrow().Init(n.BPExplosionType.Rocket,this.col,c,t,e));break;case ii.Dir.Top:for(c=e+1;c<a;++c)this.explosions.Enqueue(i.default.Borrow().Init(n.BPExplosionType.Rocket,this.col,c,t,e))}return this},t}();o.default=r,cc._RF.pop()},{"../Type/BPExplosionType":"BPExplosionType","./BPDataExplosion":"BPDataExplosion"}],BPDataRocket:[function(t,e,o){"use strict";cc._RF.push(e,"f2e36Dpi45MUZ9lhe+X2UnT","BPDataRocket"),Object.defineProperty(o,"__esModule",{value:!0});var i=function(){function t(){this.col=0,this.row=0,this.toolDir=ii.Dir.Right,this.explosions=null,this.Order=-1}return t.Borrow=function(){var e=ii.ReferencePool.Borrow(t);return e.explosions=ii.AnyQueue.Borrow(),e},t.prototype.Return=function(){this.explosions.Return(),ii.ReferencePool.Return(t,this)},t.prototype.Reset=function(){},t.prototype.Init=function(t){return this.col=t.col,this.row=t.row,this.toolDir=t.toolDir,this.Order=t.dismissInfo.Order,this},t}();o.default=i,cc._RF.pop()},{}],BPDataTile:[function(t,e,o){"use strict";cc._RF.push(e,"b7e4f00V6FDPbzHVv6rb3Rl","BPDataTile"),Object.defineProperty(o,"__esModule",{value:!0}),o.BPTileSnapData=void 0;var i=t("../Info/BPDismissInfo"),n=t("../Type/BPTileType"),r=function(){function t(){this.ui=null,this.col=0,this.row=0,this.color=0,this.typ=n.BPTileType.Default,this.toolDir=ii.Dir.Right,this.remainCount=0,this.targetClearCount=0,this.dismissInfo=null}return t.Borrow=function(){var e=ii.ReferencePool.Borrow(t);return e.dismissInfo=i.BPDismissInfo.Borrow(),e},t.prototype.Return=function(){this.dismissInfo.Return(),ii.ReferencePool.Return(t,this)},t.prototype.Reset=function(){var t;this.col=0,this.row=0,this.color=0,this.typ=n.BPTileType.Default,this.remainCount=0,null===(t=this.dismissInfo)||void 0===t||t.Reset()},t.prototype.Init=function(t,e,o,i,n,r,a){return this.col=t,this.row=e,this.color=o,this.typ=i,this.toolDir=n,this.remainCount=r,this.targetClearCount=a,this},t.prototype.InitWithSnap=function(t){return this.col=t.col,this.row=t.row,this.color=t.color,this.typ=t.typ,this.toolDir=t.toolDir,this.remainCount=t.remainCount,this.targetClearCount=t.targetClearCount,this},t.prototype.Clone=function(){var e=t.Borrow();return e.col=this.col,e.row=this.row,e.color=this.color,e.typ=this.typ,e.toolDir=this.toolDir,e.remainCount=this.remainCount,e.targetClearCount=this.targetClearCount,e},t.prototype.Snap=function(){var t=new a;return t.col=this.col,t.row=this.row,t.color=this.color,t.typ=this.typ,t.toolDir=this.toolDir,t.remainCount=this.remainCount,t.targetClearCount=this.targetClearCount,t},t.prototype.Rotate=function(){var t;t=[this.row,4-this.col],this.col=t[0],this.row=t[1],this.toolDir=(this.toolDir+3)%4},t}();o.default=r;var a=function(){this.col=0,this.row=0,this.color=0,this.typ=n.BPTileType.Default,this.toolDir=ii.Dir.Right,this.remainCount=0,this.targetClearCount=0};o.BPTileSnapData=a,cc._RF.pop()},{"../Info/BPDismissInfo":"BPDismissInfo","../Type/BPTileType":"BPTileType"}],BPDismissInfo:[function(t,e,o){"use strict";cc._RF.push(e,"29a3dGLfppJmoyzmrjSaIXE","BPDismissInfo"),Object.defineProperty(o,"__esModule",{value:!0}),o.BPDismissInfo=void 0;var i=t("../Type/BPDismissType"),n=function(){function t(){this.Face=ii.Dir.Right,this.Order=-1,this.Typ=i.BPDismissType.Default}return t.Borrow=function(){return ii.ReferencePool.Borrow(t)},t.prototype.Return=function(){ii.ReferencePool.Return(t,this)},t.prototype.Reset=function(){this.Order=-1,this.Typ=i.BPDismissType.Default},t}();o.BPDismissInfo=n,cc._RF.pop()},{"../Type/BPDismissType":"BPDismissType"}],BPDismissType:[function(t,e,o){"use strict";cc._RF.push(e,"77a7b6KC/VEPKC3SzMkXYTS","BPDismissType"),Object.defineProperty(o,"__esModule",{value:!0}),o.BPDismissType=void 0,function(t){t[t.Default=0]="Default"}(o.BPDismissType||(o.BPDismissType={})),cc._RF.pop()},{}],BPExplosionInfo:[function(t,e,o){"use strict";cc._RF.push(e,"69699uqRz1GtbKxGDenXQv+","BPExplosionInfo"),Object.defineProperty(o,"__esModule",{value:!0}),o.BPExplosionInfo=void 0;var i=function(){function t(){this.clearTiles=null,this.reduceTiles=null,this.score=0}return t.Borrow=function(){var e=ii.ReferencePool.Borrow(t);return e.clearTiles=ii.AnyQueue.Borrow(),e.reduceTiles=ii.AnyQueue.Borrow(),e.pos=ii.Tile.Borrow(),e},t.prototype.Reset=function(){this.clearTiles.RemoveAll(),this.reduceTiles.RemoveAll(),this.score=0},t.prototype.Return=function(){this.clearTiles.Return(),this.reduceTiles.Return(),this.pos.Return(),ii.ReferencePool.Return(t,this)},t}();o.BPExplosionInfo=i,cc._RF.pop()},{}],BPExplosionType:[function(t,e,o){"use strict";cc._RF.push(e,"85000qGXH1Ceotm8EaPsSFF","BPExplosionType"),Object.defineProperty(o,"__esModule",{value:!0}),o.BPExplosionType=void 0,function(t){t[t.Bomb=0]="Bomb",t[t.Rocket=1]="Rocket"}(o.BPExplosionType||(o.BPExplosionType={})),cc._RF.pop()},{}],BPFiveStarUIPanel:[function(t,e,o){"use strict";cc._RF.push(e,"3be8frOE9VCLLM7HIxMhvgJ","BPFiveStarUIPanel");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,o,a):n(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../BPLS"),s=t("../../_Public/UIPanel/BPActionUIPanel"),c=cc._decorator,l=c.ccclass,p=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.starNodes=[],e.m_StarIndex=-1,e}return n(e,t),e.prototype.OnOpen=function(){var e=this;t.prototype.OnOpen.call(this,null),this.SetIIClickHandler("OnClose",function(){e.ExitWithAction(null,!1)}),this.SetIIClickHandler("OnStar0",this.OnStar.bind(this,0)),this.SetIIClickHandler("OnStar1",this.OnStar.bind(this,1)),this.SetIIClickHandler("OnStar2",this.OnStar.bind(this,2)),this.SetIIClickHandler("OnStar3",this.OnStar.bind(this,3)),this.SetIIClickHandler("OnStar4",this.OnStar.bind(this,4)),this.SetStar(-1)},e.prototype.OnRelease=function(){t.prototype.OnRelease.call(this),this.m_StarIndex>=4&&(ii.UIMgr.ins.blockSeconds(1,null),a.BPLS.ins.RecordFiveStar(),ii.App.ins.p.user.FiveStar())},e.prototype.OnStar=function(t){this.SetStar(t)},e.prototype.SetStar=function(t){this.m_StarIndex=t;for(var e=0;e<this.starNodes.length;++e)this.starNodes[e].active=e<=t},e.IsFiveStarRecorded=function(){return a.BPLS.ins.IsFiveStarRecorded()},r([p({type:[cc.Node],tooltip:"\u661f\u661f\u6570\u7ec4"})],e.prototype,"starNodes",void 0),r([l],e)}(s.default);o.default=u,cc._RF.pop()},{"../../_Public/UIPanel/BPActionUIPanel":"BPActionUIPanel","../BPLS":"BPLS"}],BPGameLayout:[function(t,e,o){"use strict";cc._RF.push(e,"b66f86pjVBLTKOdCVRhFlYs","BPGameLayout"),Object.defineProperty(o,"__esModule",{value:!0});var i=function(){function t(t,e,o){this.m_TileSize=0,this.m_Row=0,this.m_Col=0,this.m_TileSize=t,this.m_Row=o,this.m_Col=e}return Object.defineProperty(t.prototype,"TileSize",{get:function(){return this.m_TileSize},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ROW",{get:function(){return this.m_Row},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"COL",{get:function(){return this.m_Col},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"COLOR_LENGTH",{get:function(){return 6},enumerable:!1,configurable:!0}),t.prototype.GetPosition=function(t,e,o){o.x=(t+.5)*this.m_TileSize,o.y=(e+.5)*this.m_TileSize},t.prototype.GetCol=function(t){return Math.floor(t/this.m_TileSize)},t.prototype.GetRow=function(t){return Math.floor(t/this.m_TileSize)},t.prototype.ColRow2Index=function(t,e){return t+e*this.m_Col},t.prototype.Index2Col=function(t){return t%this.m_Col},t.prototype.Index2Row=function(t){return Math.floor(t/this.m_Col)},t}();o.default=i,cc._RF.pop()},{}],BPGameUIPanel:[function(t,e,o){"use strict";cc._RF.push(e,"f8c06Q6JSNFE5lldfji9nJT","BPGameUIPanel");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,o,a):n(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../BlockPuzzleCfg"),s=t("../../BPAudioCfg"),c=t("../../BPJsonCfg"),l=t("../../BPPrefabCfg"),p=t("../BPGameLayout"),u=t("../BPGoalGame"),h=t("../BPLS"),f=t("../BPUtil"),_=t("../Info/BPClearInfo"),d=t("../Info/BPTipInfo"),y=t("../Type/BPBlockLocationType"),m=t("../Type/BPTileType"),S=t("../Type/BPToolType"),g=cc._decorator,P=g.ccclass,v=g.property,T=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.normalDraggerAnchor=null,e.stageDraggerAnchor=null,e.draggerContainer=null,e._uiBoardParent=null,e.effectRoot=null,e.scoreLabel=null,e.remainStarLabel=null,e.goalStarSpriteNode=null,e.goalLayout=null,e.rightLayout=null,e.rocketToolRoot=null,e.bombToolRoot=null,e.rotateButton=null,e.m_RocketSpriteFrame=null,e.m_RocketPieceSpriteFrame=null,e.m_BombSpriteFrame=null,e.m_BombPieceSpriteFrame=null,e.highlightStarSpriteFrame=null,e.starSpriteFrame=null,e.m_Sprites=[],e.m_HighlightSprites=[],e.disableSprites=[],e.glcSprites=[],e.spToolRocketNormal=null,e.spToolRocketPiece=null,e.spToolBombNormal=null,e.spToolBombPiece=null,e.reachCircleParticles=[],e.reachStarParticles=[],e.goalRootForHowToPlay=null,e.m_NormalUIDraggers=[],e.m_StageUIDragger=null,e.game=null,e.m_TmpClearInfo=null,e.m_TmpTipInfo=null,e.m_RemainStar=0,e.m_Rotating=!1,e._uiBoard=null,e.m_DelayEvent=null,e.m_GuideCtrl=null,e.m_RocketToolItem=null,e.m_BombToolItem=null,e.m_CheckStatusScheduler=null,e.m_isTouchStart=!1,e.m_DragItem=null,e.m_TmpTile=null,e.m_PreCol=null,e.m_PreRow=null,e.m_MoveCount=0,e.m_IsItemDragStart=!1,e.m_DraggerAfterSecondScheduler=null,e.m_LastEventForTouchStart=null,e.m_Index=0,e.m_SummaryScore=0,e.m_LastPlayScore=0,e.m_LastGLCIndex=0,e}return n(e,t),e.prototype.OnCreate=function(){},e.prototype.OnRelease=function(){this.game.Exit(),cc.game.targetOff(this),this.CloseToolItemModule(),this.m_TmpTile.Return(),this.m_TmpTipInfo=null,this.m_TmpClearInfo=null,this.m_GuideCtrl.Release()},e.prototype.OnOpen=function(){var t=this,e=new p.default(62,10,10);this.m_Layout=e,f.default.layout=e,this.m_GuideCtrl=ii.guide.GuideCtrl.Create("ls_howtoplay_is_played",this),this.SetIIClickHandler("OnSetting",this.OnClickSetting.bind(this)),this.SetIIClickHandler("OnRotate",this.OnClickRotate.bind(this)),this.SetIIClickHandler("OnHome",this.OnHome.bind(this)),f.default.SetSpriteFrames(this.m_Sprites),f.default.SetHighlightSpriteFrames(this.m_HighlightSprites),f.default.SetRocketSpriteFrame(this.m_RocketSpriteFrame),f.default.SetBombSpriteFrame(this.m_BombSpriteFrame),f.default.SetDisableSpriteFrames(this.disableSprites),f.default.SetStarSpriteFrame(this.starSpriteFrame,this.highlightStarSpriteFrame),f.default.SetGLCSpriteFrames(this.glcSprites),f.default.SetRocketPieceSpriteFrame(this.m_RocketPieceSpriteFrame),f.default.SetBombPieceSpriteFrame(this.m_BombPieceSpriteFrame),f.default.spToolRocketNormal=this.spToolRocketNormal,f.default.spToolRocketPiece=this.spToolRocketPiece,f.default.spToolBombNormal=this.spToolBombNormal,f.default.spToolBombPiece=this.spToolBombPiece,this._uiBoard=ii.UIMgr.ins.Create(l.default.pub.comp._UIBoard.key,{tileSize:this.m_Layout.TileSize,col:this.m_Layout.COL,row:this.m_Layout.ROW},this._uiBoardParent).CloseBy(this),this.m_DelayEvent=this.addComponent(ii.DelayEventComponent),this.m_TmpClearInfo=new _.BPClearInfo,this.m_TmpTipInfo=new d.BPTipInfo,this.m_TmpTile=ii.Tile.Borrow(),this.OpenToolItemModule(),this.effectRoot.zIndex=2,console.assert(0==this.m_NormalUIDraggers.length);for(var o=(this.normalDraggerAnchor.width-20)*this.normalDraggerAnchor.scale/3,i=0;i<3;++i){var n=new cc.Node;this.draggerContainer.addChild(n),n.position=new cc.Vec3(this.normalDraggerAnchor.x+(i-1)*o,0,0);var r=ii.UIMgr.ins.Create(l.default.bp.comp.BPUIDragger.key,i).CloseBy(this);r.node.width=o,r.node.height=o,r.node.active=!1,n.addChild(r.node),r.SetTouchDelegate(this),this.m_NormalUIDraggers.push(r)}console.assert(null==this.m_StageUIDragger);var a=new cc.Node;this.draggerContainer.addChild(a),a.position=new cc.Vec3(this.stageDraggerAnchor.x,0,0);var s=ii.UIMgr.ins.Create(l.default.bp.comp.BPUIDragger.key).CloseBy(this);s.node.active=!1,a.addChild(s.node),s.SetTouchDelegate(this),this.m_StageUIDragger=s,this.game=new u.default(this.m_Layout),this.game.on(u.default.EV_BUILD_DRAGGER,this.ON_EV_BUILD_DRAGGER,this),this.game.on(u.default.EV_SPAWN_BLOCK,this.m_DelayEvent.WrapEventHandler(this.ON_EV_SPAWN_BLOCK,this),this),this.game.on(u.default.EV_SCORE_CHANGED,this.ON_EV_SCORE_CHANGED,this),this.game.on(u.default.EV_BLOCK_PUTDOWN_STATUS_CHANGED,this.ON_EV_BLOCK_PUTDOWN_STATUS_CHANGED,this),this.game.on(u.default.EV_INIT_REMAIN_STAR,this.ON_EV_INIT_REMAIN_STAR,this),this.game.on(u.default.EV_ADD_BOARD_TILE,this.m_DelayEvent.WrapEventHandler(this.ON_EV_ADD_BOARD_TILE,this),this),this.game.on(u.default.EV_CLEAR_TILES,this.ON_EV_CLEAR_TILES,this),this.game.on(u.default.EV_CLEAR_TILES_NOW,this.ON_EV_CLEAR_TILES_NOW,this),this.game.on(u.default.EV_CLEAR_BLOCK,this.ON_EV_CLEAR_BLOCK,this),this.game.on(u.default.EV_SPAWN_ROCKETS,this.ON_EV_SPAWN_ROCKETS,this),this.game.on(u.default.EV_SPAWN_BOMBS,this.ON_EV_SPAWN_BOMBS,this),this.game.on(u.default.EV_EXPLOSION_TILES,this.ON_EV_EXPLOSION_TILES,this),this.game.on(u.default.EV_SHOW_EMPTY_TILES,this.m_DelayEvent.WrapEventHandler(this.ON_EV_SHOW_EMPTY_TILES,this),this),this.game.on(u.default.EV_NEW_GAME_FINISH,this.m_DelayEvent.WrapEventHandler(this.ON_EV_NEW_GAME_FINISH,this),this),this.game.Init(),this.m_GuideCtrl.IsGuided()?this.game.Run():this.RunHowToPlay(),cc.game.on(cc.game.EVENT_HIDE,function(){t.m_GuideCtrl.IsGuiding||t.game.TrySaveToLSOnGameHide()},this)},e.prototype.OnHome=function(){ii.UIMgr.ins.LoadBundleStage(a.BlockPuzzleCfg.BundleName,null,this.Close.bind(this))},e.prototype.NewGame=function(t){this.m_DelayEvent.BlockEvents(),this.game.NewGame(t)},e.prototype.Retry=function(t){this.m_DelayEvent.BlockEvents(),this.game.Retry(t)},e.prototype.Continue=function(){this.game.Continue()},e.prototype.ShowWinUIPanel=function(){var t=this;ii.UIMgr.ins.Exist(l.default.bp.panel.BPWinUIPanel.key)||ii.UIMgr.ins.Open(l.default.bp.panel.BPWinUIPanel.key,{Star:h.BPLS.ins.SummaryStar,Score:this.game.scoreBV.v,OnNewGame:function(){return t.NewGame(!0)},OnRetry:function(){return t.Retry(!0)}})},e.prototype.CheckStateStep=function(){var t=this;if(!this.m_GuideCtrl.IsGuiding){if(this.game.UpdateDraggerCanPutdownStatus(),this.game.SpawnNormalBlocksIfAllDraggerEmpty(),this.TryToShowTipTile(),ii.UIMgr.ins.Exist(l.default.bp.panel.BPWinUIPanel.key))return;if(ii.UIMgr.ins.Exist(l.default.bp.panel.BPContinueUIPanel.key))return;if(this.game.IsWin)return this.__RotateStop(),void ii.UIMgr.ins.blockSeconds(.5,function(){t.ShowWinUIPanel()});this.game.IsAnyBlockCanPutdown()||(this.__RotateStop(),ii.UIMgr.ins.Open(l.default.bp.panel.BPContinueUIPanel.key,{Board:this._uiBoard.TransferRoot,Star:this.game.TargetStar-this.game.RemainStar,TargetStar:this.game.TargetStar,OnContinue:function(){return t.Continue()},OnNewGame:function(){return t.NewGame(!1)},OnRetry:function(){return t.Retry(!1)}}))}},e.prototype.RunHowToPlay=function(){var t=ii.ResMgr.ins.GetRes(c.default.BPHowToPlayConfig).json.howtoplay;this.m_GuideCtrl.StartGuide(l.default.pub.panel.BPHowToPlayUIPanel.key,t)},e.prototype.OnClickSetting=function(){ii.UIMgr.ins.Open(l.default.pub.panel.BPSettingUIPanel.key,{OnHome:this.OnHome.bind(this),OnHowToPlay:this.RunHowToPlay.bind(this),OnReplay:this.Retry.bind(this,!1)})},e.prototype.OnClickRotate=function(){this.__RotateStart()},e.prototype.ON_EV_BUILD_DRAGGER=function(t){switch(t.location){case y.default.NORMAL:this.m_NormalUIDraggers[t.index].BindMode(t);break;case y.default.STAGE:this.m_StageUIDragger.BindMode(t);break;default:console.error("\u672a\u5904\u7406\u7684\u62d6\u62fd\u7c7b\u578b: "+t.location)}},e.prototype.ON_EV_SPAWN_BLOCK=function(t){switch(t.location){case y.default.NORMAL:this.m_NormalUIDraggers[t.index].SpawnBlock(t);break;case y.default.STAGE:this.m_StageUIDragger.SpawnBlock(t);break;default:console.error("\u672a\u5904\u7406\u7684\u5757\u4f4d\u7f6e\u7c7b\u578b block.location: "+t.location)}},e.prototype.ON_EV_SCORE_CHANGED=function(t){this.scoreLabel.string=""+t},e.prototype.ON_EV_BLOCK_PUTDOWN_STATUS_CHANGED=function(t){t.ui.UpdateIsCanPutdownStatus()},e.prototype.ON_EV_INIT_REMAIN_STAR=function(){var t=this;this.SetRemainStar(0,!1),ii.App.ins.delayCall(.3,function(){t.SetRemainStar(t.game.RemainStar,!1),t.m_DelayEvent.HandleEvents()})},e.prototype.ON_EV_ADD_BOARD_TILE=function(t){var e=ii.UIMgr.ins.Create(l.default.bp.comp.BPUITile.key,t);this._uiBoard.AddTileChild(e.node,e.vm)},e.prototype.ON_EV_CLEAR_TILES=function(t){var e=this;t.Count>0&&ii.AudioMgr.ins.PlayEffect(s.default.audio.clear),t.RemoveAll(function(t){ii.UIUtil.transferTo(t.ui.node,e.effectRoot),t.ui.RunClearAction()}),t.Return()},e.prototype.ON_EV_CLEAR_TILES_NOW=function(t){var e=this;t.RemoveAll(function(t){ii.UIUtil.transferTo(t.ui.node,e.effectRoot),t.ui.Close()}),t.Return()},e.prototype.ON_EV_CLEAR_BLOCK=function(t){t.ui.uiDragger.ClearBlockDirectly()},e.prototype.ON_EV_SPAWN_ROCKETS=function(t){var e=this;t.RemoveAll(function(t){e.scheduleOnce(function(){var o=ii.UIMgr.ins.Create(l.default.bp.comp.BPUIRocket.key,t);e._uiBoard.AddTileChild(o.node,o.vm),o.RunEffect(e.effectRoot,e.game),e.StartCheckStatusScheduler()},t.Order*f.default.TILE_INTERVAL)}),t.Return(),this.StartCheckStatusScheduler()},e.prototype.ON_EV_SPAWN_BOMBS=function(t){var e=this;t.RemoveAll(function(t){e.scheduleOnce(function(){var o=ii.UIMgr.ins.Create(l.default.bp.comp.BPUIBomb.key,t);e._uiBoard.AddTileChild(o.node,o.vm),o.RunEffect(e._uiBoard.TileRoot,e.effectRoot,e.game),e.StartCheckStatusScheduler()},t.Order*f.default.TILE_INTERVAL)}),t.Return(),this.StartCheckStatusScheduler()},e.prototype.ON_EV_EXPLOSION_TILES=function(t){t.clearTiles.Count>0&&ii.AudioMgr.ins.PlayEffect(s.default.audio.rocket_hit),this.PlayReduceTilesEffect(t.reduceTiles,!1),this.PlayClearTilesEffect(t.clearTiles,!1),this.AddSummaryScore(t.score,t.pos.col,t.pos.row),t.Return()},e.prototype.ON_EV_SHOW_EMPTY_TILES=function(t){this._uiBoard.ShowTargetTipTiles(t.tiles),ii.Util.safeCall(t.cb)},e.prototype.ON_EV_NEW_GAME_FINISH=function(){this.CheckStateStep()},e.prototype.SetRemainStar=function(t,e){t<0&&(t=0),this.m_RemainStar=t,this.remainStarLabel.string=""+this.m_RemainStar,e&&cc.tween(this.remainStarLabel.node).to(.15,{scale:1.2}).to(.1,{scale:1}).start()},e.prototype.OpenToolItemModule=function(){var t=this,e={typ:S.BPToolType.Rocket,click:function(e,o){return t.OnClickTool(e,o)},srcPieceBV:h.BPLS.ins.RocketPieceCntBV,srcBV:h.BPLS.ins.RocketCntBV};this.m_RocketToolItem=ii.UIMgr.ins.Create(l.default.bp.comp.BPUEToolItem.key,e),this.rocketToolRoot.addChild(this.m_RocketToolItem.node);var o={typ:S.BPToolType.Bomb,click:function(e,o){return t.OnClickTool(e,o)},srcPieceBV:h.BPLS.ins.BombPieceCntBV,srcBV:h.BPLS.ins.BombCntBV};this.m_BombToolItem=ii.UIMgr.ins.Create(l.default.bp.comp.BPUEToolItem.key,o),this.bombToolRoot.addChild(this.m_BombToolItem.node)},e.prototype.CloseToolItemModule=function(){this.m_RocketToolItem.Close(),this.m_BombToolItem.Close()},e.prototype.OnClickTool=function(t,e){var o=this;if(!this.m_StageUIDragger.HasBlock())switch(t){case S.BPToolType.Rocket:this.m_GuideCtrl.IsGuiding?this.__Guide_OnClickProp(t):0==h.BPLS.ins.RocketCntBV.v?ii.App.ins.p.ad.ShowRewardedVideo(function(){o.game.SpawnRocketBlockToStageDragger()}):(h.BPLS.ins.RocketCntBV.v-=1,e(),this.game.SpawnRocketBlockToStageDragger());break;case S.BPToolType.Bomb:this.m_GuideCtrl.IsGuiding?this.__Guide_OnClickProp(t):0==h.BPLS.ins.BombCntBV.v?ii.App.ins.p.ad.ShowRewardedVideo(function(){o.game.SpawnBombBlockToStageDragger()}):(h.BPLS.ins.BombCntBV.v-=1,e(),this.game.SpawnBombBlockToStageDragger())}},e.prototype.StartCheckStatusScheduler=function(){var t=this;this.StopCheckStatusScheduler(),this.m_CheckStatusScheduler=function(){t.StopCheckStatusScheduler(),t.CheckStateStep()},this.schedule(this.m_CheckStatusScheduler,2)},e.prototype.StopCheckStatusScheduler=function(){null!=this.m_CheckStatusScheduler&&(this.unschedule(this.m_CheckStatusScheduler),this.m_CheckStatusScheduler=null)},e.prototype.__RotateStart=function(){var t=this;this.m_Rotating||(this.m_Rotating=!0,this.rotateButton.interactable=!1,this.m_NormalUIDraggers.forEach(function(e){e.SetRotating(t.m_Rotating)}),this.m_StageUIDragger.SetRotating(this.m_Rotating))},e.prototype.__RotateStop=function(){var t=this;this.m_Rotating&&(this.m_Rotating=!1,this.rotateButton.interactable=!0,this.m_NormalUIDraggers.forEach(function(e){e.SetRotating(t.m_Rotating)}),this.m_StageUIDragger.SetRotating(this.m_Rotating))},e.prototype.__RotatePause=function(){this.m_Rotating&&(this.m_NormalUIDraggers.forEach(function(t){t.SetRotating(!1)}),this.m_StageUIDragger.SetRotating(!1))},e.prototype.__RotateResume=function(){var t=this;this.m_Rotating&&(this.m_NormalUIDraggers.forEach(function(e){e.SetRotating(t.m_Rotating)}),this.m_StageUIDragger.SetRotating(this.m_Rotating))},e.prototype.RotateBlock=function(t){t.RotateTiles(),this.game.UpdateDraggerCanPutdownStatus()},e.prototype.__StopDragAfterSecondScheduler=function(){null!=this.m_DraggerAfterSecondScheduler&&(this.unschedule(this.m_DraggerAfterSecondScheduler),this.m_DraggerAfterSecondScheduler=null)},e.prototype.OnDragTouchStart=function(t,e){var o=this;return!this.m_isTouchStart&&(t.vm.block.isCanputDown?(this.m_isTouchStart=!0,this.m_MoveCount=0,this.m_DragItem=t,this.TopZOrder(t),this._uiBoard.HideTipOnDragStart(),this.m_IsItemDragStart=!1,this.m_Rotating?(this.m_LastEventForTouchStart=e,this.m_DraggerAfterSecondScheduler=function(){o.m_isTouchStart&&!o.m_IsItemDragStart&&(o.m_IsItemDragStart=!0,t.OnDragStart(o.m_LastEventForTouchStart,o),o.__RotatePause())},this.scheduleOnce(this.m_DraggerAfterSecondScheduler,.3)):(this.m_IsItemDragStart=!0,t.OnDragStart(e,this)),!0):(this.m_Rotating&&this.RotateBlock(t.DragTarget()),!1))},e.prototype.OnDragTouchMove=function(t,e){if(this.m_isTouchStart&&t==this.m_DragItem&&(++this.m_MoveCount,!this.m_Rotating||this.m_MoveCount>10||this.m_IsItemDragStart)){if(!this.m_IsItemDragStart)return this.m_IsItemDragStart=!0,this.__StopDragAfterSecondScheduler(),this.m_LastEventForTouchStart=null,t.OnDragStart(e,this),void this.__RotatePause();t.OnDragMove(e,this);var o=this.m_DragItem.DragTarget(),i=this.m_TmpTile;if(f.default.GetOriginColAndRow(o,this._uiBoard.TileOriginRoot,i),this.m_PreCol!==i.col||this.m_PreRow!==i.row){this.m_PreCol=i.col,this.m_PreRow=i.row;var n=o.vm.tiles,r=this.game.IsCanPutdown(n,this.m_PreCol,this.m_PreRow);this._uiBoard.HideShadowTiles(),r&&this._uiBoard.ShowShadowTiles(n,function(t){return f.default.GetSpriteFrame(t.color,!1)},this.m_PreCol,this.m_PreRow),this.UpdateHighlightOnDrag(r,o,n)}}},e.prototype.OnDragTouchEnd=function(t){if(this.m_isTouchStart&&t==this.m_DragItem)if(this.m_DragItem=null,this.m_isTouchStart=!1,this.m_PreCol=null,this.m_PreRow=null,this.__StopDragAfterSecondScheduler(),!this.m_Rotating||this.m_IsItemDragStart){this._uiBoard.HideShadowTiles();var e=t.DragTarget(),o=this.m_TmpTile;f.default.GetOriginColAndRow(e,this._uiBoard.TileOriginRoot,o),this.m_GuideCtrl.IsGuiding?this.m_GuideCtrl.Step.CheckColRow(o)?this.TryPutdown(t,o):this.ReturnBlockBack(t):this.TryPutdown(t,o)}else this.RotateBlock(t.DragTarget())},e.prototype.TryPutdown=function(t,e){var o=this,i=t.DragTarget(),n=i.node.convertToWorldSpaceAR(cc.Vec3.ZERO);this.game.IsCanPutdown(i.vm.tiles,e.col,e.row)?(this.__RotateStop(),ii.AudioMgr.ins.PlayEffect(s.default.audio.put_down),t.PutdownBlock(this._uiBoard.TileRoot,this.game,e.col,e.row,function(t){o.m_TmpClearInfo.BeginUse(),o.ClearStep(t,o.m_TmpClearInfo,n),o.m_TmpClearInfo.EndUse()})):this.ReturnBlockBack(t)},e.prototype.ReturnBlockBack=function(t){this._uiBoard.TryToResumeTipOnBack(),t.OnDragEnd(null,this),this.__RotateResume()},e.prototype.TopZOrder=function(t){this.m_NormalUIDraggers.forEach(function(t){return t.SetZIndex(0)}),this.m_StageUIDragger.SetZIndex(0),t.SetZIndex(1)},e.prototype.ClearStep=function(t,e,o){var i=this;this.game.ClearWithCollection(t,e),e.clearTiles.Count>0?(this.SetSummaryScore(e.score,o),this.PlayReduceTilesEffect(e.reduceTiles,!0),this.PlayClearTilesEffect(e.clearTiles,!0),0==e.clearRocketCnt&&0==e.clearBombCnt&&(ii.AudioMgr.ins.PlayEffect(s.default.audio.clear),ii.UIMgr.ins.blockSeconds(1.5,function(){return i.CheckStateStep()}))):(console.assert(0==e.reduceTiles.Count),this.CheckStateStep())},e.prototype.PlayReduceTilesEffect=function(t,e){var o=this,i=0;t.RemoveAll(function(t){return o.PlayReduceStarNumberEffect(t,e,i++)})},e.prototype.PlayClearTilesEffect=function(t,e){var o=this,i=0;t.RemoveAll(function(t){var n=t.ui;ii.UIUtil.transferTo(n.node,o.effectRoot),n.ResetDisplayColorAndHighlight();var r=i;e?o.scheduleOnce(function(){return o.__PlayClearTileAction(n,r)},n.vm.dismissInfo.Order*f.default.TILE_INTERVAL):o.__PlayClearTileAction(n,r),n.vm.typ===m.BPTileType.Star&&++i})},e.prototype.__PlayClearTileAction=function(t,e){switch(ii.AudioMgr.ins.PlayEffect(s.default.audio.tile_clear),t.vm.typ){case m.BPTileType.Star:var o=t.GetStarSprite().node.convertToWorldSpaceAR(cc.Vec3.ZERO);this.PlayCollectStarEffect(o,e),t.UpdateStarVisiable()}t.RunClearAction()},e.prototype.PlayReduceStarNumberEffect=function(t,e,o){var i=this;e?this.scheduleOnce(function(){return i.__PlayReduceStarNumberEffect(t,o)},t.dismissInfo.Order*f.default.TILE_INTERVAL):this.__PlayReduceStarNumberEffect(t,o)},e.prototype.__PlayReduceStarNumberEffect=function(t,e){var o=t.ui,i=o.GetStarSprite().node.convertToWorldSpaceAR(cc.Vec3.ZERO);o.UpdateStarLabel(!0),o.ResetDisplayColorAndHighlight(),this.PlayCollectStarEffect(i,e)},e.prototype.PlayCollectStarEffect=function(t,e){var o=this,i=ii.UIMgr.ins.Create(l.default.pub.comp.BPUIActionStar.key);this.effectRoot.addChild(i.node,8),i.node.position=this.effectRoot.convertToNodeSpaceAR(t);var n=this.goalStarSpriteNode.convertToWorldSpaceAR(cc.Vec2.ZERO),r=this.effectRoot.convertToNodeSpaceAR(n),a=30+20*Math.random(),s=.4+.1*e+.1*Math.random(),c=cc.v2(r.x,i.node.y+(r.y-i.node.y)/3),p=cc.v2(r.x+(r.x>i.node.x?100:-100),i.node.y+2*(r.y-i.node.y)/3);cc.tween(i.node).by(s,{scale:1.1,y:-a},{easing:cc.easing.elasticOut}).bezierTo(.5,c,p,r).call(function(){o.__RunStarArrivedEffect(),i.Close()}).start()},e.prototype.__RunStarArrivedEffect=function(){ii.AudioMgr.ins.PlayEffect(s.default.audio.star_reach),this.SetRemainStar(this.m_RemainStar-1,!0),cc.tween(this.goalStarSpriteNode).to(.1,{scale:1.3},{easing:cc.easing.backIn}).to(.1,{scale:1},{easing:cc.easing.backOut}).start(),this.m_Index=++this.m_Index%this.reachCircleParticles.length,ii.Util.playParticleSystem(this.reachCircleParticles[this.m_Index]),ii.Util.playParticleSystem(this.reachStarParticles[this.m_Index])},e.prototype.SetSummaryScore=function(t,e){this.m_SummaryScore=t,this.m_LastPlayScore=t;var o=Math.round(t/10-2);this.__ShowGLC(o,t,e)},e.prototype.AddSummaryScore=function(t,e,o){if(this.m_SummaryScore+=t,this.m_SummaryScore>1.2*this.m_LastPlayScore){var i=this._uiBoard.TileRoot.convertToWorldSpaceAR(f.default.GetColRowPosition(e,o));this.__ShowGLC(this.m_LastGLCIndex+1,this.m_SummaryScore,i)}},e.prototype.__ShowGLC=function(t,e,o){if(t>=0){this.m_LastGLCIndex=t,this.m_LastPlayScore=e,this.scheduleOnce(function(){ii.AudioMgr.ins.PlayEffect(s.default.GetGLC(t))},.5);var i=ii.UIMgr.ins.Create(l.default.bp.comp.BPUIScoreWordEffect.key);this.effectRoot.addChild(i.node,6),i.node.position=this.effectRoot.convertToNodeSpaceAR(o),i.RunGLCEffect(t,e)}},e.prototype.UpdateHighlightOnDrag=function(t,e,o){if(this.game.tiles.ForEach(function(t){return t.ui.ResetDisplayColorAndHighlight()}),o.ForEach(function(t){return t.ui.SetHighlight(!1)}),t){var i=ii.AnyQueue.Borrow(),n=ii.AnyQueue.Borrow();if(this.game.IsClearable(o,this.m_PreCol,this.m_PreRow,i,n)){var r=e.vm.color;i.ForEach(function(t){return t.ui.SetDisplayColorWithHighlight(r)}),n.ForEach(function(t){return t.ui.SetHighlight(!0)})}n.Return(),i.Return()}},e.prototype.TryToShowTipTile=function(){var t=this.m_TmpTipInfo,e=this.game.IsAnyActiveBlockOnlyOnePosition(t);e?this._uiBoard.ShowTipTiles(t.block.tiles,function(){return f.default.GetSpriteFrame(t.block.color,!1)},t.col,t.row):this._uiBoard.HideTipTiles(e)},e.prototype.OnGuideGetNode=function(t){switch(t){case"goal":return this.goalRootForHowToPlay;case"tiles":return this._uiBoard.TileOriginRoot;case"dragger_2":return this.m_NormalUIDraggers[2].node.parent;case"dragger_3":return this.m_StageUIDragger.node.parent;case"tool_rocket":return this.m_RocketToolItem.node;case"tool_bomb":return this.m_BombToolItem.node;default:console.error("\u5173\u952e\u5b57 "+t+" \u6ca1\u6709\u5bf9\u5e94\u7684 UI \u8282\u70b9")}},e.prototype.OnGuideFinished=function(){this.Retry(!0)},e.prototype.OnGuideStep=function(t){switch(t.typ){case"load_level":this.__OnGuideStep_LoadLevel(t.GetV("level"),t.NextStep);break;case"show_empty_tiles":this.game.ShowEmptyTiles(t.tiles,t.NextStep);break;case"hide_empty_tiles":this._uiBoard.HideTargetTipTiles(),t.NextStep();break;case"check_col_row":case"check_use_prop":break;default:console.warn("HowToPlay >> \u672a\u5904\u7406\u7684\u6b65\u9aa4 type = "+t.typ),console.table(t.kv)}},e.prototype.__OnGuideStep_LoadLevel=function(t,e){this.m_DelayEvent.BlockEvents(),this.game.LoadLevel(t,!0,e)},e.prototype.__Guide_OnClickProp=function(t){switch(this.m_GuideCtrl.Step.typ){case"check_use_prop":if(this.m_GuideCtrl.Step.GetV("tool_type")==t){switch(t){case S.BPToolType.Rocket:this.game.SpawnRocketBlockToStageDraggerWithDir(this.m_GuideCtrl.Step.dir,this.m_GuideCtrl.Step.color);break;case S.BPToolType.Bomb:this.game.SpawnBombBlockToStageDragger()}this.m_GuideCtrl.Step.NextStep()}return!1;default:return!1}},r([v({type:cc.Node,tooltip:"\u53ef\u62d6\u62fd\u666e\u901a\u65b9\u5757\u4f4d\u7f6e\u951a\u70b9"})],e.prototype,"normalDraggerAnchor",void 0),r([v({type:cc.Node,tooltip:"\u53ef\u62d6\u62fd\u9053\u5177\u65b9\u5757\u4f4d\u7f6e\u951a\u70b9"})],e.prototype,"stageDraggerAnchor",void 0),r([v({type:cc.Node,tooltip:"\u53ef\u62d6\u62fd\u65b9\u5757\u6216\u9053\u5177\u7684\u5bb9\u5668"})],e.prototype,"draggerContainer",void 0),r([v({type:cc.Node,visible:!0,tooltip:"\u68cb\u76d8\u5bb9\u5668\u8282\u70b9"})],e.prototype,"_uiBoardParent",void 0),r([v({type:cc.Node,tooltip:"\u8868\u73b0\u5c42"})],e.prototype,"effectRoot",void 0),r([v({type:cc.Label,tooltip:"\u5206\u6570"})],e.prototype,"scoreLabel",void 0),r([v({type:cc.Label,tooltip:"\u5269\u4f59\u661f\u661f\u6570"})],e.prototype,"remainStarLabel",void 0),r([v({type:cc.Node,tooltip:"\u661f\u661f\u7cbe\u7075"})],e.prototype,"goalStarSpriteNode",void 0),r([v({type:cc.Layout,tooltip:"\u76ee\u6807\u5e03\u5c40\u5bb9\u5668"})],e.prototype,"goalLayout",void 0),r([v({type:cc.Layout,tooltip:"\u53f3\u4fa7\u9053\u5177\u5e03\u5c40\u5bb9\u5668"})],e.prototype,"rightLayout",void 0),r([v({type:cc.Node,tooltip:"\u706b\u7bad\u9053\u5177\u6839\u8282\u70b9"})],e.prototype,"rocketToolRoot",void 0),r([v({type:cc.Node,tooltip:"\u706b\u7bad\u9053\u5177\u6839\u8282\u70b9"})],e.prototype,"bombToolRoot",void 0),r([v({type:cc.Button,tooltip:"\u65cb\u8f6c\u6309\u94ae"})],e.prototype,"rotateButton",void 0),r([v({type:cc.SpriteFrame,tooltip:"\u706b\u7bad\u7cbe\u7075"})],e.prototype,"m_RocketSpriteFrame",void 0),r([v({type:cc.SpriteFrame,tooltip:"\u706b\u7bad\u788e\u7247\u7cbe\u7075"})],e.prototype,"m_RocketPieceSpriteFrame",void 0),r([v({type:cc.SpriteFrame,tooltip:"\u70b8\u5f39\u7cbe\u7075"})],e.prototype,"m_BombSpriteFrame",void 0),r([v({type:cc.SpriteFrame,tooltip:"\u70b8\u5f39\u788e\u7247\u7cbe\u7075"})],e.prototype,"m_BombPieceSpriteFrame",void 0),r([v({type:cc.SpriteFrame,tooltip:"\u9ad8\u4eae\u661f\u661f\u7eb9\u7406"})],e.prototype,"highlightStarSpriteFrame",void 0),r([v({type:cc.SpriteFrame,tooltip:"\u666e\u901a\u661f\u661f\u7eb9\u7406"})],e.prototype,"starSpriteFrame",void 0),r([v({type:[cc.SpriteFrame],tooltip:"\u65b9\u5757\u7cbe\u7075\u76ae\u80a4"})],e.prototype,"m_Sprites",void 0),r([v({type:[cc.SpriteFrame],tooltip:"\u65b9\u5757\u9ad8\u4eae\u7cbe\u7075\u76ae\u80a4"})],e.prototype,"m_HighlightSprites",void 0),r([v({type:[cc.SpriteFrame],tooltip:"\u7f6e\u7070\u7cbe\u7075"})],e.prototype,"disableSprites",void 0),r([v({type:[cc.SpriteFrame],tooltip:"\u9f13\u52b1\u8bcd\u7cbe\u7075"})],e.prototype,"glcSprites",void 0),r([v({type:cc.SpriteFrame,tooltip:"\u706b\u7bad\u9053\u5177\u7eb9\u7406"})],e.prototype,"spToolRocketNormal",void 0),r([v({type:cc.SpriteFrame,tooltip:"\u706b\u7bad\u788e\u7247\u9053\u5177\u7eb9\u7406"})],e.prototype,"spToolRocketPiece",void 0),r([v({type:cc.SpriteFrame,tooltip:"\u70b8\u5f39\u9053\u5177\u7eb9\u7406"})],e.prototype,"spToolBombNormal",void 0),r([v({type:cc.SpriteFrame,tooltip:"\u70b8\u5f39\u788e\u7247\u9053\u5177\u7eb9\u7406"})],e.prototype,"spToolBombPiece",void 0),r([v({type:cc.ParticleSystem,tooltip:"\u661f\u661f\u5230\u8fbe Circle \u7c92\u5b50"})],e.prototype,"reachCircleParticles",void 0),r([v({type:cc.ParticleSystem,tooltip:"\u661f\u661f\u5230\u8fbe Star \u7c92\u5b50"})],e.prototype,"reachStarParticles",void 0),r([v({type:cc.Node,tooltip:"\u76ee\u6807\u6839\u8282\u70b9"})],e.prototype,"goalRootForHowToPlay",void 0),r([P],e)}(ii.UIPanel);o.default=T,cc._RF.pop()},{"../../BPAudioCfg":"BPAudioCfg","../../BPJsonCfg":"BPJsonCfg","../../BPPrefabCfg":"BPPrefabCfg","../../BlockPuzzleCfg":"BlockPuzzleCfg","../BPGameLayout":"BPGameLayout","../BPGoalGame":"BPGoalGame","../BPLS":"BPLS","../BPUtil":"BPUtil","../Info/BPClearInfo":"BPClearInfo","../Info/BPTipInfo":"BPTipInfo","../Type/BPBlockLocationType":"BPBlockLocationType","../Type/BPTileType":"BPTileType","../Type/BPToolType":"BPToolType"}],BPGoalGame:[function(t,e,o){"use strict";cc._RF.push(e,"fb23dtxWzRDG7x5L0thrvk2","BPGoalGame");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var r=t("../_Public/Cfg/_BlockConfig"),a=t("./BPLS"),s=t("./Data/BPDataBlock"),c=t("./Data/BPDataBomb"),l=t("./Data/BPDataDragger"),p=t("./Data/BPDataRocket"),u=t("./Data/BPDataTile"),h=t("./Info/BPExplosionInfo"),f=t("./Type/BPBlockLocationType"),_=t("./Type/BPTileType"),d=function(){function t(){this.stars=null}return t.Borrow=function(){var e=ii.ReferencePool.Borrow(t);return e.stars=ii.AnyQueue.Borrow(),e},t.prototype.Reset=function(){},t.prototype.Return=function(){this.stars.RemoveAll(function(t){return t.Return()}),this.stars.Return(),ii.ReferencePool.Return(t,this)},t.prototype.GetOriginStarCount=function(){var t=0;return this.stars.ForEach(function(e){return t+=e.remainCount}),t},t.prototype.IsExist=function(t,e){return this.stars.Contains(function(o){return o.col==t&&o.row==e})},t.prototype.IncreaseStarNumber=function(t,e){var o=this.stars.Fetch(function(o){return o.col==t&&o.row==e});++o.remainCount,o.targetClearCount=o.remainCount},t.prototype.IncreaseStarNumberByRandom=function(){var t=ii.rand.IntBetween(0,this.stars.Count),e=this.stars.FetchByIndex(t);++e.remainCount,e.targetClearCount=e.remainCount},t}(),y=function(t){function e(e){var o=t.call(this)||this;return o.comboBV=null,o.scoreBV=null,o.m_NormalDraggers=[],o.m_StageDragger=null,o.tiles=null,o._col_links=[],o._row_links=[],o.m_bInit=!1,o.m_RemainStarCount=0,o.m_TargetStarCount=0,o.m_IsWin=!1,o.m_EditorMode=!1,o.m_Layout=e,o}return n(e,t),e.prototype.newBoardTile=function(t){this.__addBoardTile(t),this.emit(e.EV_ADD_BOARD_TILE,t)},e.prototype.addBoardTileByTransfer=function(t){this.__addBoardTile(t)},e.prototype.__addBoardTile=function(t){this.tiles.Enqueue(t),this._col_links[t.col].Enqueue(t),this._row_links[t.row].Enqueue(t)},e.prototype.__removeBoardTile=function(t){this.tiles.Remove(function(e){return e==t}),this._col_links[t.col].Remove(function(e){return e==t}),this._row_links[t.row].Remove(function(e){return e==t})},e.prototype.IsAllNormalDraggersEmpty=function(){for(var t=this.m_NormalDraggers.length-1;t>=0;--t)if(null!=this.m_NormalDraggers[t].block)return!1;return!0},e.prototype.IsAnyBlockCanPutdown=function(){for(var t=this.m_NormalDraggers.length-1;t>=0;--t){var e=this.m_NormalDraggers[t].block;if(null!=e&&e.isCanputDown)return!0}return!(!this.m_StageDragger.block||!this.m_StageDragger.block.isCanputDown)},e.prototype.__BuildNormalDraggers=function(){console.assert(0==this.m_NormalDraggers.length);for(var t=0;t<3;++t){var o=new l.default(f.default.NORMAL,t);this.m_NormalDraggers.push(o),this.emit(e.EV_BUILD_DRAGGER,o)}},e.prototype.__BuildStageDragger=function(){console.assert(null==this.m_StageDragger);var t=new l.default(f.default.STAGE,0);this.m_StageDragger=t,this.emit(e.EV_BUILD_DRAGGER,t)},e.prototype.Init=function(){var t=this;if(!this.m_bInit){this.m_bInit=!0,this.tiles=ii.AnyQueue.Borrow(),this.comboBV=ii.NumberBV.Borrow(-1),this.scoreBV=ii.NumberBV.Borrow(0),this.scoreBV.Bind(function(o,i){return t.emit(e.EV_SCORE_CHANGED,o,i)},!0,this);for(var o=this.m_Layout.COL-1;o>=0;--o)this._col_links.push(ii.AnyQueue.Borrow());for(var i=this.m_Layout.ROW-1;i>=0;--i)this._row_links.push(ii.AnyQueue.Borrow());this.__BuildNormalDraggers(),this.__BuildStageDragger()}},e.prototype.Run=function(){if(this.Init(),a.BPLS.ins.HasSnapData(a.BPLS.KEY_QUIT_SNAP_DATA)){var t=a.BPLS.ins.ReadSnapData(a.BPLS.KEY_QUIT_SNAP_DATA);a.BPLS.ins.RemoveSnapData(a.BPLS.KEY_QUIT_SNAP_DATA),this.__NewFromSnapData(t,!0)}else this.Retry(!0);this.emit(e.EV_NEW_GAME_FINISH)},e.prototype.NewGame=function(t){this.Clear(!1),this.__NewFromRandom(t)},e.prototype.Retry=function(t){if(this.Clear(!1),a.BPLS.ins.HasSnapData(a.BPLS.KEY_INIT_SNAP_DATA)){var e=a.BPLS.ins.ReadSnapData(a.BPLS.KEY_INIT_SNAP_DATA);this.__NewFromSnapData(e,t)}else this.__NewFromRandom(t)},e.prototype.Continue=function(){var t=this;this.m_IsWin=!1;var o=ii.AnyQueue.Borrow();this.tiles.Remove(function(t){return t.typ==_.BPTileType.Default},function(e){t._col_links[e.col].Remove(function(t){return t==e}),t._row_links[e.row].Remove(function(t){return t==e}),o.Enqueue(e)}),this.emit(e.EV_CLEAR_TILES,o),this.UpdateDraggerCanPutdownStatus()},e.prototype.Exit=function(){if(this.tiles.Count>0){for(var t=this.m_Layout.COL-1;t>=0;--t)this._col_links[t].RemoveAll();for(var o=this.m_Layout.ROW-1;o>=0;--o)this._row_links[o].RemoveAll();var i=this.tiles;this.tiles=ii.AnyQueue.Borrow(),this.emit(e.EV_CLEAR_TILES_NOW,i)}for(var n=this.m_NormalDraggers.length-1;n>=0;--n){var r=this.m_NormalDraggers[n];null!=r.block&&this.emit(e.EV_CLEAR_BLOCK,r.block)}var a=this.m_StageDragger;null!=a.block&&this.emit(e.EV_CLEAR_BLOCK,a.block)},e.prototype.Clear=function(t){if(this.tiles.Count>0){for(var o=this.m_Layout.COL-1;o>=0;--o)this._col_links[o].RemoveAll();for(var i=this.m_Layout.ROW-1;i>=0;--i)this._row_links[i].RemoveAll();var n=this.tiles;this.tiles=ii.AnyQueue.Borrow(),this.emit(e.EV_CLEAR_TILES,n)}for(var r=this.m_NormalDraggers.length-1;r>=0;--r)null!=(a=this.m_NormalDraggers[r]).block&&this.emit(e.EV_CLEAR_BLOCK,a.block);var a;t&&null!=(a=this.m_StageDragger).block&&this.emit(e.EV_CLEAR_BLOCK,a.block)},Object.defineProperty(e.prototype,"IsWin",{get:function(){return this.m_IsWin},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"TargetStar",{get:function(){return this.m_TargetStarCount},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"RemainStar",{get:function(){return this.m_RemainStarCount},enumerable:!1,configurable:!0}),e.prototype.IsWinCondition=function(){return 0==this.m_RemainStarCount},e.prototype.UpdateWinStatus=function(){this.IsWinCondition()&&(this.m_IsWin||(this.m_IsWin=!0,a.BPLS.ins.SummaryStar+=this.m_TargetStarCount,a.BPLS.ins.BestScore=this.scoreBV.v,a.BPLS.ins.RemoveSnapData(a.BPLS.KEY_QUIT_SNAP_DATA)))},e.prototype.__NewFromRandom=function(t){var o=this;this.m_IsWin=!1;var i=20,n=6,r=ii.rand.IntBetween(0,100);r<40?(i=7,n=4):r<70&&(i=12,n=5);var s=ii.rand.IntBetween(2,i+1);this.m_TargetStarCount=s;for(var c=d.Borrow();s>0;){if(c.stars.Count<n){var l=ii.rand.IntBetween(0,this.m_Layout.COL),p=ii.rand.IntBetween(0,this.m_Layout.ROW);if(c.IsExist(l,p))c.IncreaseStarNumber(l,p);else{var h=u.default.Borrow();h.Init(l,p,ii.rand.IntBetween(0,this.m_Layout.COLOR_LENGTH),_.BPTileType.Star,ii.Dir.Right,1,1),c.stars.Enqueue(h)}}else c.IncreaseStarNumberByRandom();--s}c.stars.RemoveAll(function(t){return o.newBoardTile(t)}),c.Return(),this.m_RemainStarCount=this.m_TargetStarCount,this.emit(e.EV_INIT_REMAIN_STAR,this.m_RemainStarCount),this.SpawnNormalBlocksIfAllDraggerEmpty(),t||(this.scoreBV.v=0),this.comboBV.v=-1,this.SaveToLS(a.BPLS.KEY_INIT_SNAP_DATA)},e.prototype.__NewFromSnapData=function(t,o){var i=this;this.m_IsWin=!1,this.scoreBV.v=o?Math.max(this.scoreBV.v,t.score):t.score,this.comboBV.v=t.combo;var n=0,r=0;t.tiles.forEach(function(t){var e=u.default.Borrow().InitWithSnap(t);i.newBoardTile(e),e.typ==_.BPTileType.Star&&(n+=t.targetClearCount,r+=t.remainCount)}),this.m_TargetStarCount=n,this.m_RemainStarCount=r,this.emit(e.EV_INIT_REMAIN_STAR,this.m_RemainStarCount),t.blocks.forEach(function(t){var o=s.default.Borrow().InitWithSnap(t);o.isCanputDown=i.IsBlockCanPutdownToAny(o),i.m_NormalDraggers[o.index].block=o,i.emit(e.EV_SPAWN_BLOCK,o)}),this.SpawnNormalBlocksIfAllDraggerEmpty()},e.prototype.SaveToLS=function(t){console.debug("\u4fdd\u5b58\u6570\u636e");var e=a.BPSnapData.Create();e.score=this.scoreBV.v,e.combo=this.comboBV.v,this.tiles.ForEach(function(t){return e.tiles.push(t.Snap())}),this.m_NormalDraggers.forEach(function(t){null!=t.block&&e.blocks.push(t.block.Snap())}),a.BPLS.ins.SaveSnapData(t,e)},e.prototype.__NewFromConfig=function(t,o){var i=this;this.m_IsWin=!1;var n=0,r=0;t.tiles.forEach(function(t){var e=u.default.Borrow().InitWithSnap(t);i.newBoardTile(e),e.typ==_.BPTileType.Star&&(n+=t.targetClearCount,r+=t.remainCount)}),this.m_TargetStarCount=n,this.m_RemainStarCount=r,this.emit(e.EV_INIT_REMAIN_STAR,this.m_RemainStarCount),t.blocks.forEach(function(t){var o=s.default.Borrow().InitWithConfigData(f.default.NORMAL,t.id,t.color,t.block,i.m_Layout.TileSize,_.BPTileType.Default,ii.Dir.Right);o.isCanputDown=i.IsBlockCanPutdownToAny(o),i.m_NormalDraggers[o.index].block=o,i.emit(e.EV_SPAWN_BLOCK,o)}),o()},e.prototype.TrySaveToLSOnGameHide=function(){this.IsWin||this.IsAnyBlockCanPutdown()&&this.SaveToLS(a.BPLS.KEY_QUIT_SNAP_DATA)},e.prototype.SpawnNormalBlocksIfAllDraggerEmpty=function(){this.IsAllNormalDraggersEmpty()&&this.SpawnNormalBlocks()},e.prototype.SpawnNormalBlocks=function(){for(var t=0;t<this.m_NormalDraggers.length;++t){var o=this.m_NormalDraggers[t];console.assert(null==o.block);var i=ii.rand.IntBetween(1,r._BlockConfig.length);this.m_EditorMode&&(i=0);var n=r._BlockConfig[i],a=Math.floor(Math.random()*n.kinds.length);this.m_EditorMode&&(a=0);var c=n.kinds[a];c||console.error("_BlockConfig.length: "+r._BlockConfig.length+" blockType: "+i+" blockTypeConfig.kinds.length:"+n.kinds.length+" blockKind: "+a);var l=s.default.Borrow(),p=ii.rand.IntBetween(0,this.m_Layout.COLOR_LENGTH);l.InitWithConfigData(o.location,t,p,c,this.m_Layout.TileSize,_.BPTileType.Default,ii.Dir.Right),l.isCanputDown=this.IsBlockCanPutdownToAny(l);var u=ii.rand.IntBetween(0,1e4);u<500?l.ChangeAnyTileTo(_.BPTileType.RocketPiece):u<1e3&&l.ChangeAnyTileTo(_.BPTileType.BombPiece),o.block=l,this.emit(e.EV_SPAWN_BLOCK,l)}},e.prototype.SpawnRocketBlockToStageDragger=function(){this.__SpawnToolBlockToStageDragger(_.BPTileType.Rocket,!1,ii.Dir.Right,0)},e.prototype.SpawnRocketBlockToStageDraggerWithDir=function(t,e){this.__SpawnToolBlockToStageDragger(_.BPTileType.Rocket,!0,t,e)},e.prototype.SpawnBombBlockToStageDragger=function(){this.__SpawnToolBlockToStageDragger(_.BPTileType.Bomb,!1,ii.Dir.Right,0)},e.prototype.__SpawnToolBlockToStageDragger=function(t,o,i,n){var a=this.m_StageDragger;console.assert(null==a.block);var c=r._BlockConfig[0],l=c.kinds[0];l||console.error("_BlockConfig.length: "+r._BlockConfig.length+" blockType: 0 blockTypeConfig.kinds.length:"+c.kinds.length+" blockKind: 0");var p=s.default.Borrow(),u=o?n:ii.rand.IntBetween(0,this.m_Layout.COLOR_LENGTH),h=o?i:ii.rand.IntBetween(0,4);p.InitWithConfigData(a.location,0,u,l,this.m_Layout.TileSize,t,h),p.isCanputDown=this.IsBlockCanPutdownToAny(p),a.block=p,this.emit(e.EV_SPAWN_BLOCK,p)},e.prototype.UpdateDraggerCanPutdownStatus=function(){for(var t=0;t<this.m_NormalDraggers.length;++t){var o=this.m_NormalDraggers[t].block;if(null!=o){var i=o.isCanputDown;o.isCanputDown=this.IsBlockCanPutdownToAny(o),i!=o.isCanputDown&&this.emit(e.EV_BLOCK_PUTDOWN_STATUS_CHANGED,o)}}},e.prototype.IsAnyActiveBlockOnlyOnePosition=function(t){for(var e=0;e<this.m_NormalDraggers.length;++e){var o=this.m_NormalDraggers[e];if(o.block&&o.block.isCanputDown&&this.IsBlockOnlyOnePositionEmbeddedable(o.block,t))return!0}return!1},e.prototype.IsBlockOnlyOnePositionEmbeddedable=function(t,e){for(var o=0,i=0,n=0,r=this.m_Layout.ROW-(t.height-1)-1;r>=0;--r)for(var a=this.m_Layout.COL-(t.width-1)-1;a>=0;--a)if(this.IsCanPutdown(t.tiles,a,r)){if(++o>1)return!1;i=a,n=r}return 1==o&&(e.block=t,e.col=i,e.row=n,!0)},e.prototype.IsBlockCanPutdownToAny=function(t){for(var e=this.m_Layout.ROW-(t.height-1)-1;e>=0;--e)for(var o=this.m_Layout.COL-(t.width-1)-1;o>=0;--o)if(this.IsCanPutdown(t.tiles,o,e))return!0;return!1},e.prototype.CalculateVerticalDismissInfo=function(t,e,o){var i=t.row>e.row;t.dismissInfo.Face=i?ii.Dir.Top:ii.Dir.Bottom;var n=t.row,r=null;do{n=i?n-1:n+1}while(!o.Contains(function(e){return r=e,e.col==t.col&&e.row==n}));t.dismissInfo.Order=r.dismissInfo.Order+Math.abs(t.row-n)},e.prototype.CalculateHorizontalDismissInfo=function(t,e,o){var i=t.col>e.col;t.dismissInfo.Face=i?ii.Dir.Right:ii.Dir.Left;var n=t.col,r=null;do{n=i?n-1:n+1}while(!o.Contains(function(e){return r=e,e.row==t.row&&e.col==n}));t.dismissInfo.Order=r.dismissInfo.Order+Math.abs(t.col-n)},e.prototype.ClearWithCollection=function(t,e){var o=this;this.tiles.ForEach(function(t){t.dismissInfo.Reset()});var i=this.m_Layout.COL,n=this.m_Layout.ROW,r=0,a=0,s=ii.AnyQueue.Borrow();t.ForEach(function(t){return t.dismissInfo.Order=0}),t.ForEach(function(c){var l=c.color,p=o._col_links[c.col];p.Count>0&&p.Count==n-r&&(++a,p.RemoveAll(function(i){-1==i.dismissInfo.Order&&o.CalculateVerticalDismissInfo(i,c,t),o._row_links[i.row].Remove(function(t){return t==i}),o.tiles.Remove(function(t){return t==i}),--i.remainCount,i.remainCount>0?(s.Enqueue(i),e.reduceTiles.Enqueue(i)):(i.color=l,e.clearTiles.Enqueue(i))}));var u=o._row_links[c.row];u.Count>0&&u.Count==i-a&&(++r,u.RemoveAll(function(i){-1==i.dismissInfo.Order&&o.CalculateHorizontalDismissInfo(i,c,t),o._col_links[i.col].Remove(function(t){return t==i}),o.tiles.Remove(function(t){return t==i}),--i.remainCount,i.remainCount>0?(s.Enqueue(i),e.reduceTiles.Enqueue(i)):(i.color=l,e.clearTiles.Enqueue(i))}))}),s.RemoveAll(function(t){return o.__addBoardTile(t)}),s.Return(),0==e.clearTiles.Count?this.comboBV.v=-1:this.comboBV.v+=1,e.combo=this.comboBV.v;var c=this.comboBV.v,l=0;l+=1*t.Count,r+a>0&&(l+=10*(r+a)),c>0&&(l+=10*c),e.clearRocketCnt=e.clearTiles.CountIf(function(t){return t.typ==_.BPTileType.Rocket}),e.clearBombCnt=e.clearTiles.CountIf(function(t){return t.typ==_.BPTileType.Bomb}),l+=5*(e.clearRocketCnt+e.clearBombCnt),l+=10*(e.clearTiles.CountIf(function(t){return t.typ==_.BPTileType.Star})+e.reduceTiles.CountIf(function(t){return t.typ==_.BPTileType.Star})),this.scoreBV.v+=l,e.score=l,this.UpdateRemainStarCountAndPieces(e),this.TryTriggerTools(e.clearTiles),this.UpdateWinStatus()},e.prototype.UpdateRemainStarCountAndPieces=function(t){var e=t.clearTiles.CountIf(function(t){return t.typ===_.BPTileType.Star}),o=t.reduceTiles.CountIf(function(t){return t.typ===_.BPTileType.Star});this.m_RemainStarCount-=e+o;var i=t.clearTiles.CountIf(function(t){return t.typ===_.BPTileType.RocketPiece});if(i>0){var n=a.BPLS.ins.RocketPieceCntBV.v,r=a.BPLS.ins.RocketPieceCntBV.v+i;a.BPLS.ins.RocketPieceCntBV.v=r,a.BPLS.ins.RocketCntBV.v+=Math.floor(r/a.BPLS.PIECE_TO_TOOL)-Math.floor(n/a.BPLS.PIECE_TO_TOOL)}var s=t.clearTiles.CountIf(function(t){return t.typ===_.BPTileType.BombPiece});s>0&&(n=a.BPLS.ins.BombPieceCntBV.v,r=a.BPLS.ins.BombPieceCntBV.v+s,a.BPLS.ins.BombPieceCntBV.v=r,a.BPLS.ins.BombCntBV.v+=Math.floor(r/a.BPLS.PIECE_TO_TOOL)-Math.floor(n/a.BPLS.PIECE_TO_TOOL))},e.prototype.TryTriggerTools=function(t){if(0!=t.Count){var o=ii.AnyQueue.Borrow(),i=ii.AnyQueue.Borrow();t.ForEach(function(t){switch(t.typ){case _.BPTileType.Rocket:var e=p.default.Borrow();e.Init(t),o.Enqueue(e);break;case _.BPTileType.Bomb:var n=c.default.Borrow();n.Init(t),i.Enqueue(n)}}),o.Count>0?this.emit(e.EV_SPAWN_ROCKETS,o):o.Return(),i.Count>0?this.emit(e.EV_SPAWN_BOMBS,i):i.Return()}},e.prototype.getColCount=function(t,e){return t.CountIf(function(t){return t.col==e})},e.prototype.getRowCount=function(t,e){return t.CountIf(function(t){return t.row==e})},e.prototype.IsClearable=function(t,e,o,i,n){var r=this,a=!1;return t.ForEach(function(s){var c=e+s.col,l=o+s.row,p=r._col_links[c];p.Count+r.getColCount(t,s.col)==r.m_Layout.ROW&&(a=!0,p.ForEach(function(t){return i.Enqueue(t)}),t.ForEach(function(t){t.col==s.col&&n.Enqueue(t)}));var u=r._row_links[l];u.Count+r.getRowCount(t,s.row)==r.m_Layout.COL&&(a=!0,u.ForEach(function(t){return i.Enqueue(t)}),t.ForEach(function(t){t.row==s.row&&n.Enqueue(t)}))}),a},e.prototype.TryExplosion=function(t){var o=this,i=h.BPExplosionInfo.Borrow();i.pos.col=t.col,i.pos.row=t.row;var n=0;this.tiles.Contains(function(e){return e.col==t.col&&e.row==t.row},function(t){--t.remainCount,t.typ==_.BPTileType.Rocket||t.typ==_.BPTileType.Bomb?n+=10:++n,t.remainCount>0?i.reduceTiles.Enqueue(t):(i.clearTiles.Enqueue(t),o.__removeBoardTile(t))}),i.score=n,this.scoreBV.v+=n,this.UpdateRemainStarCountAndPieces(i),this.TryTriggerTools(i.clearTiles),this.UpdateWinStatus(),this.emit(e.EV_EXPLOSION_TILES,i),t.Return()},e.prototype.IsCanPutdown=function(t,e,o){var i=this,n=!0;return t.For(function(t){var r=!i.IsInBoardRect(e+t.col,o+t.row)||i.hasTile(e+t.col,o+t.row);return r&&(n=!1),r}),n},e.prototype.IsInBoardRect=function(t,e){return t>=0&&t<this.m_Layout.COL&&e>=0&&e<this.m_Layout.ROW},e.prototype.hasTile=function(t,e){return this.tiles.Contains(function(o){return o.col==t&&o.row==e})},e.prototype.LoadLevel=function(t,e,o){this.Clear(e),this.__NewFromConfig(t,o)},e.prototype.ShowEmptyTiles=function(t,o){this.emit(e.EV_SHOW_EMPTY_TILES,{tiles:t,cb:o})},e.EV_BUILD_DRAGGER="EV_BUILD_DRAGGER",e.EV_SPAWN_BLOCK="EV_SPAWN_BLOCK",e.EV_SCORE_CHANGED="EV_SCORE_CHANGED",e.EV_BLOCK_PUTDOWN_STATUS_CHANGED="EV_BLOCK_PUTDOWN_STATUS_CHANGED",e.EV_INIT_REMAIN_STAR="EV_INIT_REMAIN_STAR",e.EV_ADD_BOARD_TILE="EV_ADD_BOARD_TILE",e.EV_CLEAR_TILES_NOW="EV_CLEAR_TILES_NOW",e.EV_CLEAR_TILES="EV_CLEAR_TILES",e.EV_CLEAR_BLOCK="EV_CLEAR_BLOCK",e.EV_SPAWN_ROCKETS="EV_SPAWN_ROCKETS",e.EV_SPAWN_BOMBS="EV_SPAWN_BOMBS",e.EV_EXPLOSION_TILES="EV_EXPLOSION_TILES",e.EV_SHOW_EMPTY_TILES="EV_SHOW_EMPTY_TILES",e.EV_NEW_GAME_FINISH="EV_NEW_GAME_FINISH",e}(cc.EventTarget);o.default=y,cc._RF.pop()},{"../_Public/Cfg/_BlockConfig":"_BlockConfig","./BPLS":"BPLS","./Data/BPDataBlock":"BPDataBlock","./Data/BPDataBomb":"BPDataBomb","./Data/BPDataDragger":"BPDataDragger","./Data/BPDataRocket":"BPDataRocket","./Data/BPDataTile":"BPDataTile","./Info/BPExplosionInfo":"BPExplosionInfo","./Type/BPBlockLocationType":"BPBlockLocationType","./Type/BPTileType":"BPTileType"}],BPGoalUIPanel:[function(t,e,o){"use strict";cc._RF.push(e,"2b2a3hR0eJC06I0oKbRTnJU","BPGoalUIPanel");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,o,a):n(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../BPAudioCfg"),s=t("../../_Public/UIPanel/BPActionUIPanel"),c=cc._decorator,l=c.ccclass,p=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_GoalLabel=null,e}return n(e,t),e.prototype.OnOpen=function(e){var o=this;t.prototype.OnOpen.call(this,e),this.m_GoalLabel.string=""+e.remainStars,this.scheduleOnce(function(){ii.AudioMgr.ins.PlayEffect(a.default.audio.tip_exit),o.ExitWithAction(e.OnClose,!0)},2)},r([p({type:cc.Label,tooltip:"\u76ee\u6807\u661f\u661f\u6570"})],e.prototype,"m_GoalLabel",void 0),r([l],e)}(s.default);o.default=u,cc._RF.pop()},{"../../BPAudioCfg":"BPAudioCfg","../../_Public/UIPanel/BPActionUIPanel":"BPActionUIPanel"}],BPGuideModel:[function(t,e,o){"use strict";cc._RF.push(e,"8f969aoATRO26vYTOfxWcbS","BPGuideModel"),Object.defineProperty(o,"__esModule",{value:!0}),o.BPGuideLevelData=void 0;o.BPGuideLevelData=function(){},cc._RF.pop()},{}],BPHowToPlayFinishedUIPanel:[function(t,e,o){"use strict";cc._RF.push(e,"95c91Uxc+5HX506IcuiuG7Y","BPHowToPlayFinishedUIPanel");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,o,a):n(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../BPAudioCfg"),s=t("../../_Public/UIPanel/BPActionUIPanel"),c=cc._decorator,l=c.ccclass,p=(c.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.OnOpen=function(e){var o=this;t.prototype.OnOpen.call(this,e),this.SetGuideNotificationActive(!0),this.scheduleOnce(function(){o.ExitWithAction(null,!0)},2),this.scheduleOnce(function(){ii.AudioMgr.ins.PlayEffect(a.default.audio.tip_exit)},2.5)},r([l],e)}(s.default));o.default=p,cc._RF.pop()},{"../../BPAudioCfg":"BPAudioCfg","../../_Public/UIPanel/BPActionUIPanel":"BPActionUIPanel"}],BPHowToPlayUIPanel:[function(t,e,o){"use strict";cc._RF.push(e,"2239fRGrC9MWbnl00m32tyA","BPHowToPlayUIPanel");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,o,a):n(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../BPPrefabCfg"),s=cc._decorator,c=s.ccclass,l=s.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bg=null,e.transferRoot=null,e.containerRoot=null,e.m_Dialog=null,e.m_Finger=null,e}return n(e,t),Object.defineProperty(e.prototype,"TransferRoot",{get:function(){return this.transferRoot},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Background",{get:function(){return this.bg},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Dialog",{get:function(){return this.m_Dialog},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Finger",{get:function(){return this.m_Finger},enumerable:!1,configurable:!0}),e.prototype.SetBackgroundClickHandler=function(t){this.SetIIClickHandler("OnBG",t,!0)},e.prototype.OnCreateSelf=function(){this.m_Dialog=ii.UIMgr.ins.Create(a.default.pub.comp.BPUIHowToPlayDialog.key).CloseBy(this),this.containerRoot.addChild(this.m_Dialog.node),this.m_Dialog.node.active=!1,this.m_Finger=ii.UIMgr.ins.Create(a.default.pub.comp.BPUIHowToPlayFinger.key).CloseBy(this),this.containerRoot.addChild(this.m_Finger.node),this.m_Finger.node.active=!1},e.prototype.OnOpenSelf=function(){},e.prototype.OnReleaseSelf=function(){},r([l({type:cc.Node,tooltip:"\u80cc\u666f\u906e\u7f69"})],e.prototype,"bg",void 0),r([l({type:cc.Node,tooltip:"\u4e0a\u79fb\u7684\u8282\u70b9\u5bb9\u5668"})],e.prototype,"transferRoot",void 0),r([l({type:cc.Node,tooltip:"\u81ea\u8eab\u5bb9\u5668\u8282\u70b9"})],e.prototype,"containerRoot",void 0),r([c],e)}(ii.guide.GuidePlayerUIPanel);o.default=p,cc._RF.pop()},{"../../BPPrefabCfg":"BPPrefabCfg"}],BPJsonCfg:[function(t,e,o){"use strict";cc._RF.push(e,"1716dgepQBNf7F+KCl9KyzH","BPJsonCfg"),Object.defineProperty(o,"__esModule",{value:!0});var i=function(){function t(){}return t.Register=function(t){console.info("BPJsonCfg::Register("+t+") >> \u6ce8\u518c Json \u8d44\u6e90"),ii.registerRes(this.BPHowToPlayConfig,t,ii.EResType.Json),ii.registerRes(this.GSLevelData,t,ii.EResType.Json)},t.BPHowToPlayConfig="json.BPHowToPlayConfig",t.GSLevelData="json.GSLevelData",t}();o.default=i,cc._RF.pop()},{}],BPLS:[function(t,e,o){"use strict";cc._RF.push(e,"70b80qQpppC7400SFtM/zTu","BPLS"),Object.defineProperty(o,"__esModule",{value:!0}),o.BPSnapData=o.BPLS=void 0;var i=t("../../../../StartScene/Script/GameApp"),n=t("../../../../StartScene/Script/HttpMgr"),r=function(){function t(){this.RocketCntBV=null,this.BombCntBV=null,this.RocketPieceCntBV=null,this.BombPieceCntBV=null,this.RocketPieceCntBV=ii.NumberBV.BorrowAsUserLS("ls_rocket_piece_cnt",0,!0),this.BombPieceCntBV=ii.NumberBV.BorrowAsUserLS("ls_bomb_piece_cnt",0,!0),this.RocketCntBV=ii.NumberBV.BorrowAsUserLS("ls_rocket_cnt",9,!0),this.BombCntBV=ii.NumberBV.BorrowAsUserLS("ls_bomb_cnt",9,!0)}return Object.defineProperty(t,"ins",{get:function(){return this._ins||(this._ins=new t),this._ins},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"SummaryStar",{get:function(){return ii.App.ins.p.user.GetGameCenterVal("GameStar")},set:function(t){if(ii.App.ins.p.user.SetGameCenterVal("GameStar",t),i.default.Release){var e=localStorage.getItem("userToken"),o=new FormData;o.append("token",e),o.append("gameStar",t+""),n.httpPost("/api/updateInfoRocketThreeMatch",function(t,e){0===Number(t)&&1===Number(e.code)&&console.log("\u66f4\u65b0\u4fc4\u7f57\u65af\u6d88\u9664\u661f\u661f="+e.message)},o)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"BestScore",{get:function(){return ii.App.ins.p.user.GetGameCenterVal("GameScore")},set:function(t){if(ii.App.ins.p.user.SetGameCenterVal("GameScore",t),i.default.Release){var e=localStorage.getItem("userToken"),o=new FormData;o.append("token",e),o.append("gameScore",t+""),n.httpPost("/api/updateInfoRocketThreeMatch",function(t,e){0===Number(t)&&1===Number(e.code)&&console.log("\u66f4\u65b0\u4fc4\u7f57\u65af\u6d88\u9664\u5206\u6570="+e.message)},o)}},enumerable:!1,configurable:!0}),t.prototype.RemoveSnapData=function(t){ii.UserLSMgr.ins.deleteKey(t)},t.prototype.SaveSnapData=function(t,e){ii.UserLSMgr.ins.setObject(t,e,!1)},t.prototype.HasSnapData=function(t){return ii.UserLSMgr.ins.hasKey(t)},t.prototype.ReadSnapData=function(t){return ii.UserLSMgr.ins.getObject(t)},t.prototype.IsFiveStarRecorded=function(){return ii.UserLSMgr.ins.getBoolWithDefault("ls_five_star",!1)},t.prototype.RecordFiveStar=function(){ii.UserLSMgr.ins.setBool("ls_five_star",!0,!1)},t.prototype.GetFiveStarWinCount=function(){return ii.UserLSMgr.ins.getIntWithDefault("ls_five_star_win_count",0)},t.prototype.AddFiveStarWinCount=function(){if(ii.UserLSMgr.ins.setInt("ls_five_star_win_count",this.GetFiveStarWinCount()+1,!1),i.default.Release){var t=localStorage.getItem("userToken"),e=new FormData;e.append("token",t),e.append("fiveStar_count",this.GetFiveStarWinCount()+1+""),n.httpPost("/api/updateInfoRocketThreeMatch",function(t,e){0===Number(t)&&1===Number(e.code)&&console.log("\u66f4\u65b0\u4fc4\u7f57\u65af\u6d88\u9664\u4e94\u661f\u597d\u8bc4="+e.message)},e)}},t.prototype.SetFiveStarWinCount=function(t){ii.UserLSMgr.ins.setInt("ls_five_star_win_count",t,!1)},t.event={ROCKET_REWARDED:"ROCKET_REWARDED",BOMB_REWARDED:"BOMB_REWARDED"},t._ins=null,t.PIECE_TO_TOOL=5,t.KEY_QUIT_SNAP_DATA="ll_ls_quit_snap_data",t.KEY_INIT_SNAP_DATA="ll_ls_init_snap_data",t}();o.BPLS=r;var a=function(){function t(){this.score=0,this.combo=-1,this.tiles=[],this.blocks=[]}return t.Create=function(){return new t},t}();o.BPSnapData=a,cc._RF.pop()},{"../../../../StartScene/Script/GameApp":void 0,"../../../../StartScene/Script/HttpMgr":void 0}],BPLoadingADUIPanel:[function(t,e,o){"use strict";cc._RF.push(e,"18e11w+2BFI97I3drBivIvn","BPLoadingADUIPanel");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,o,a):n(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_LogoSprite=null,e.m_LoadingProgressCircleSprite=null,e.m_LoadingADLabel=null,e}return n(e,t),e.prototype.OnCreate=function(){},e.prototype.OnRelease=function(){cc.Tween.stopAllByTarget(this.m_LogoSprite.node),cc.Tween.stopAllByTarget(this.m_LoadingProgressCircleSprite.node),cc.Tween.stopAllByTarget(this.m_LoadingADLabel.node)},e.prototype.OnOpen=function(t){var e=this;this.m_LogoSprite.node.opacity=0,this.m_LoadingProgressCircleSprite.node.opacity=0,this.m_LoadingProgressCircleSprite.fillRange=0,this.m_LoadingADLabel.node.opacity=0,ii.UIUtil.showAction(this.m_LogoSprite.node,.2,{opacity:255}),ii.UIUtil.showAction(this.m_LoadingProgressCircleSprite.node,.2,{opacity:255}),ii.UIUtil.showAction(this.m_LoadingADLabel.node,.2,{opacity:255}),this.m_LoadingProgressCircleSprite.fillRange=.001,cc.tween(this.m_LoadingProgressCircleSprite).to(t.duration,{fillRange:1}).call(function(){cc.Tween.stopAllByTarget(e.m_LoadingProgressCircleSprite),ii.Util.safeCall(t.cb),e.Close()}).start()},r([c({type:cc.Sprite,tooltip:"\u56fe\u6807"})],e.prototype,"m_LogoSprite",void 0),r([c({type:cc.Sprite,tooltip:"\u8fdb\u5ea6\u5706\u5708"})],e.prototype,"m_LoadingProgressCircleSprite",void 0),r([c({type:cc.Label,tooltip:"\u5e7f\u544a\u6807\u5fd7"})],e.prototype,"m_LoadingADLabel",void 0),r([s],e)}(ii.UIPanel);o.default=l,cc._RF.pop()},{}],BPPrefabCfg:[function(t,e,o){"use strict";cc._RF.push(e,"e5ae7E4zWdJe69iEf9NE4wj","BPPrefabCfg"),Object.defineProperty(o,"__esModule",{value:!0});var i=function(){function t(){}return t.Register=function(t){console.info("BPPrefabCfg::Register("+t+") >> \u6ce8\u518c Prefab \u8d44\u6e90"),ii.registerPrefabCfg(this.pub,t),ii.registerPrefabCfg(this.bp,t),ii.registerPrefabCfg(this.gs,t)},t.pub={panel:{_BPGameListUIPanel:{key:"_p/_BPGameListUIPanel",z:ii.UIZIndex.Stage},BPLoadingADUIPanel:{key:"_p/BPLoadingADUIPanel",z:ii.UIZIndex.TopMsg},BPHowToPlayUIPanel:{key:"_p/guide/BPHowToPlayUIPanel",z:ii.UIZIndex.TopModule},BPSettingUIPanel:{key:"_p/BPSettingUIPanel",z:ii.UIZIndex.PopUp}},comp:{_UIBoard:{key:"_p/_UIBoard"},_UITargetStar:{key:"_p/_UITargetStar"},_UIStarDashboard:{key:"_p/_UIStarDashboard"},_UIJudgeDashboard:{key:"_p/_UIJudgeDashboard"},BPUIShadowTile:{key:"_p/BPUIShadowTile"},BPUITipTile:{key:"_p/BPUITipTile"},BPUITargetTipTile:{key:"_p/BPUITargetTipTile"},BPUIActionStar:{key:"_p/BPUIActionStar"},BPUIHowToPlayFinger:{key:"_p/guide/BPUIHowToPlayFinger"},BPUIHowToPlayDialog:{key:"_p/guide/BPUIHowToPlayDialog"}}},t.bp={panel:{BPGameUIPanel:{key:"bp/BPGameUIPanel",z:ii.UIZIndex.Stage},BPContinueUIPanel:{key:"bp/BPContinueUIPanel",z:ii.UIZIndex.PopUp},BPFiveStarUIPanel:{key:"bp/BPFiveStarUIPanel",z:ii.UIZIndex.PopUp},BPGoalUIPanel:{key:"bp/BPGoalUIPanel",z:ii.UIZIndex.PopUp},BPHowToPlayFinishedUIPanel:{key:"bp/BPHowToPlayFinishedUIPanel",z:ii.UIZIndex.PopUp},BPWinUIPanel:{key:"bp/BPWinUIPanel",z:ii.UIZIndex.PopUp}},comp:{BPUITile:{key:"bp/BPUITile"},BPUIBlock:{key:"bp/BPUIBlock"},BPUIDragger:{key:"bp/BPUIDragger"},BPUIRocket:{key:"bp/BPUIRocket"},BPUIRocketHalf:{key:"bp/BPUIRocketHalf"},BPUIParticleRocketTail:{key:"bp/BPUIParticleRocketTail"},BPUIParticleRocketTail_1:{key:"bp/BPUIParticleRocketTail_1"},BPUIBomb:{key:"bp/BPUIBomb"},BPUIParticleRocketBoomCircle:{key:"bp/BPUIParticleRocketBoomCircle"},BPUIParticleBoomSmoke:{key:"bp/BPUIParticleBoomSmoke"},BPUIScoreWordEffect:{key:"bp/BPUIScoreWordEffect"},BPUEToolItem:{key:"bp/BPUEToolItem"}}},t.gs={panel:{GSLevelUIPanel:{key:"gs/GSLevelUIPanel",z:ii.UIZIndex.Stage},GSGameUIPanel:{key:"gs/GSGameUIPanel",z:ii.UIZIndex.Stage},GSWinUIPanel:{key:"gs/GSWinUIPanel",z:ii.UIZIndex.PopUp},GSLoseUIPanel:{key:"gs/GSLoseUIPanel",z:ii.UIZIndex.PopUp}},comp:{GSLevelUIPanelPage:{key:"gs/GSLevelUIPanelPage"},GSLevelUIPanelItem:{key:"gs/GSLevelUIPanelItem"},GSUITile:{key:"gs/GSUITile"},GSUIBlock:{key:"gs/GSUIBlock"},GSUIDragger:{key:"gs/GSUIDragger"}}},t}();o.default=i,cc._RF.pop()},{}],BPSettingUIPanel:[function(t,e,o){"use strict";cc._RF.push(e,"5879bg/6wFP+qoWjkmud8kf","BPSettingUIPanel");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,o,a):n(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../../../StartScene/Script/GameApp"),s=t("../../../../../StartScene/Script/HttpMgr"),c=t("./BPActionUIPanel"),l=cc._decorator,p=l.ccclass,u=l.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.vibrateOffState=null,e.vibrateOnState=null,e.soundOffState=null,e.soundOnState=null,e.rankRoot=null,e.rateRoot=null,e.contactUsRoot=null,e.backButtonRoot=null,e.layoutRoot=null,e.howToPlayADIconNode=null,e.guideButtonRoot=null,e.replayButtonRoot=null,e.replayADIconNode=null,e.tipsLbl=null,e}return n(e,t),e.prototype.OnOpen=function(){var e=this;t.prototype.OnOpen.call(this,null),this.SetIIClickHandler("OnClose",function(){e.ExitWithAction(null,!1)}),this.SetIIClickHandler("OnHome",this.OnHome.bind(this)),this.SetIIClickHandler("OnVibrate",this.OnVibrate.bind(this)),this.SetIIClickHandler("OnSound",this.OnSound.bind(this)),this.SetIIClickHandler("OnRank",this.OnRank.bind(this)),this.SetIIClickHandler("OnRate",this.OnRate.bind(this)),this.SetIIClickHandler("OnContactUs",this.OnContactUs.bind(this)),this.SetIIClickHandler("OnHowToPlay",this.OnHowToPlay.bind(this)),this.SetIIClickHandler("OnReplay",this.OnReplay.bind(this)),this.BindBV(ii.AudioMgr.ins.effectOffBV,function(t){e.soundOnState.active=!t,e.soundOffState.active=t},!0),this.BindBV(ii.App.ins.p.vibrate.off,function(t){e.vibrateOnState.active=!t,e.vibrateOffState.active=t},!0),this.rateRoot.active=ii.App.ins.p.user.IsSupportRateUsByOpenUrl(),this.contactUsRoot.active=ii.App.ins.p.user.IsSupportContactUs(),this.guideButtonRoot.active=null!==this.args.OnHowToPlay,this.replayButtonRoot.active=null!==this.args.OnReplay,this.scheduleOnce(function(){e.backButtonRoot.position=cc.v3(e.backButtonRoot.x,.5*e.layoutRoot.height-85,0)},.05),this.rankRoot.active=ii.App.ins.p.user.IsSupportLeaderboard(),this.tipsLbl.node.active=!1,ii.App.ins.p.ad.ShowBanner(!0)},e.prototype.OnRelease=function(){ii.App.ins.p.ad.ShowBanner(!1),t.prototype.OnRelease.call(this)},e.prototype.OnHome=function(){this.ExitWithAction(this.args.OnHome,!1)},e.prototype.OnVibrate=function(){ii.App.ins.p.vibrate.Toggle()},e.prototype.OnSound=function(){ii.AudioMgr.ins.effectOffBV.v=!ii.AudioMgr.ins.effectOffBV.v},e.prototype.OnRank=function(){ii.App.ins.p.user.ShowDefaultLeaderboard()},e.prototype.OnRate=function(){ii.App.ins.p.user.RateUsByOpenUrl()},e.prototype.OnContactUs=function(){ii.App.ins.p.user.ContactUs()},e.prototype.OnHowToPlay=function(){if(a.default.Release){var t="/api/smallGameCast",e=localStorage.getItem("userToken");console.log("\u8bf7\u6c42url122="+t);var o=new FormData;o.append("token",e),o.append("game_id","6");var i=this;s.httpPost(t,function(t,e){0===Number(t)&&(1===Number(e.code)?(console.log("\u4fc4\u7f57\u65af\u6d88\u9664\u65b0\u624b\u5f15\u5bfc\u91cd\u590d="+e.message),i.ExitWithAction(i.args.OnHowToPlay,!1)):i.ShowTips(e.message))},o)}else this.ExitWithAction(this.args.OnHowToPlay,!1)},e.prototype.OnReplay=function(){if(a.default.Release){var t="/api/smallGameCast",e=localStorage.getItem("userToken");console.log("\u8bf7\u6c42url122="+t);var o=new FormData;o.append("token",e),o.append("game_id","6");var i=this;s.httpPost(t,function(t,e){0===Number(t)&&(1===Number(e.code)?(console.log("\u4fc4\u7f57\u65af\u6d88\u9664\u91cd\u7f6e="+e.message),i.ExitWithAction(i.args.OnReplay,!1)):i.ShowTips(e.message))},o)}else this.ExitWithAction(this.args.OnReplay,!1)},e.prototype.ShowTips=function(t){var e=this;this.tipsLbl.node.active=!0,this.tipsLbl.string=t,setTimeout(function(){e.tipsLbl.node.active=!1},3e3)},r([u({type:cc.Node,tooltip:"\u632f\u52a8Off"})],e.prototype,"vibrateOffState",void 0),r([u({type:cc.Node,tooltip:"\u632f\u52a8On"})],e.prototype,"vibrateOnState",void 0),r([u({type:cc.Node,tooltip:"\u58f0\u97f3Off"})],e.prototype,"soundOffState",void 0),r([u({type:cc.Node,tooltip:"\u58f0\u97f3On"})],e.prototype,"soundOnState",void 0),r([u({type:cc.Node,tooltip:"\u6392\u884c\u699c\u6839\u8282\u70b9"})],e.prototype,"rankRoot",void 0),r([u({type:cc.Node,tooltip:"\u8bc4\u5206\u8282\u70b9"})],e.prototype,"rateRoot",void 0),r([u({type:cc.Node,tooltip:"\u8054\u7cfb\u6211\u4eec\u8282\u70b9"})],e.prototype,"contactUsRoot",void 0),r([u({type:cc.Node,tooltip:"\u5173\u95ed\u8282\u70b9"})],e.prototype,"backButtonRoot",void 0),r([u({type:cc.Node,tooltip:"\u5e03\u5c40\u8282\u70b9"})],e.prototype,"layoutRoot",void 0),r([u({type:cc.Node,tooltip:"\u5e7f\u544a\u56fe\u6807\uff08\u652f\u6301\u5e7f\u544a\u65f6\u624d\u663e\u793a\uff09"})],e.prototype,"howToPlayADIconNode",void 0),r([u({type:cc.Node,tooltip:"\u5f15\u5bfc\u6309\u94ae"})],e.prototype,"guideButtonRoot",void 0),r([u({type:cc.Node,tooltip:"\u91cd\u73a9\u6309\u94ae"})],e.prototype,"replayButtonRoot",void 0),r([u({type:cc.Node,tooltip:"\u5e7f\u544a\u56fe\u6807\uff08\u652f\u6301\u5e7f\u544a\u65f6\u624d\u663e\u793a\uff09"})],e.prototype,"replayADIconNode",void 0),r([u({type:cc.Label,tooltip:"tips"})],e.prototype,"tipsLbl",void 0),r([p],e)}(c.default);o.default=h,cc._RF.pop()},{"../../../../../StartScene/Script/GameApp":void 0,"../../../../../StartScene/Script/HttpMgr":void 0,"./BPActionUIPanel":"BPActionUIPanel"}],BPTileType:[function(t,e,o){"use strict";cc._RF.push(e,"e42aejRNB5GsblWOo+/DKA9","BPTileType"),Object.defineProperty(o,"__esModule",{value:!0}),o.BPTileType=void 0,function(t){t[t.Default=0]="Default",t[t.Star=1]="Star",t[t.Rocket=2]="Rocket",t[t.Bomb=3]="Bomb",t[t.RocketPiece=4]="RocketPiece",t[t.BombPiece=5]="BombPiece"}(o.BPTileType||(o.BPTileType={})),cc._RF.pop()},{}],BPTipInfo:[function(t,e,o){"use strict";cc._RF.push(e,"4872au5+I5L6Y60Xq7KoPG6","BPTipInfo"),Object.defineProperty(o,"__esModule",{value:!0}),o.BPTipInfo=void 0;o.BPTipInfo=function(){this.block=null,this.col=0,this.row=0},cc._RF.pop()},{}],BPToolType:[function(t,e,o){"use strict";cc._RF.push(e,"35ee1EdPSlBn60BsAWz1PJ1","BPToolType"),Object.defineProperty(o,"__esModule",{value:!0}),o.BPToolType=void 0,function(t){t[t.Rocket=0]="Rocket",t[t.Bomb=1]="Bomb"}(o.BPToolType||(o.BPToolType={})),cc._RF.pop()},{}],BPUEToolItem:[function(t,e,o){"use strict";cc._RF.push(e,"b0faahzE8hFWZEsS82ZkQEE","BPUEToolItem");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,o,a):n(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../BPUtil"),s=t("../BPLS"),c=t("../Type/BPToolType"),l=t("../../../../../StartScene/Script/HttpMgr"),p=t("../../../../../StartScene/Script/GameApp"),u=cc._decorator,h=u.ccclass,f=u.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_PieceProgressSprite=null,e.m_DisableSprite=null,e.m_NormalSprite=null,e.m_CntLabel=null,e.m_AdNode=null,e.m_AdRootNode=null,e.vm=null,e.m_PieceUIBV=null,e.m_ToolUIBV=null,e.m_ProgressScheduler=null,e.m_ProgressSpeed=8,e.t_url="/api/getInfoRocketThreeMatch",e.token=localStorage.getItem("userToken"),e}return n(e,t),e.prototype.OnCreate=function(){},e.prototype.OnRelease=function(){},e.prototype.OnOpen=function(t){var e=this;switch(this.vm=t,this.SetIIClickHandler("OnClickTool",this.OnClickTool.bind(this)),this.vm.typ){case c.BPToolType.Rocket:this.m_DisableSprite.spriteFrame=a.default.spToolRocketPiece,this.m_NormalSprite.spriteFrame=a.default.spToolRocketNormal;break;case c.BPToolType.Bomb:this.m_DisableSprite.spriteFrame=a.default.spToolBombPiece,this.m_NormalSprite.spriteFrame=a.default.spToolBombNormal}this.m_PieceUIBV=ii.NumberBV.Borrow(this.vm.srcPieceBV.v),this.m_ToolUIBV=ii.NumberBV.Borrow(this.vm.srcBV.v),this.m_PieceUIBV.Bind(function(t){var o=(t-Math.floor(t/s.BPLS.PIECE_TO_TOOL)*s.BPLS.PIECE_TO_TOOL)/s.BPLS.PIECE_TO_TOOL;e.m_PieceProgressSprite.fillRange=o},!0,this),this.BindBV(this.vm.srcPieceBV,function(){return e.RunProgressToAction()},!0),this.m_ToolUIBV.Bind(function(t){e.m_CntLabel.string=""+t,e.m_CntLabel.node.active=t>0,e.m_AdRootNode.active=t>0||0==t&&ii.App.ins.p.ad.IsSupport(),e.m_AdNode.active=0==t&&ii.App.ins.p.ad.IsSupport(),e.m_DisableSprite.node.active=0==t,e.m_NormalSprite.node.active=t>0,t>0&&(ii.UIUtil.scaleAction(e.m_NormalSprite.node,1.2),ii.UIUtil.scaleAction(e.m_CntLabel.node,1.2))},!0,this),ii.EventCenter.ins.on(s.BPLS.event.BOMB_REWARDED,this.SyncUI.bind(this),this),ii.EventCenter.ins.on(s.BPLS.event.ROCKET_REWARDED,this.SyncUI.bind(this),this)},e.prototype.OnClose=function(){ii.EventCenter.ins.targetOff(this),this.m_PieceUIBV.Return()},e.prototype.OnDestroy=function(){},e.prototype.OnClickTool=function(){this.vm.click(this.vm.typ,this.SyncUI.bind(this))},e.prototype.RunProgressToAction=function(){null==this.m_ProgressScheduler&&(this.m_ProgressScheduler=this.TickRocketProgress.bind(this),this.schedule(this.m_ProgressScheduler))},e.prototype.TickRocketProgress=function(t){if(this.m_PieceUIBV.v<this.vm.srcPieceBV.v){var e=this.m_PieceUIBV.v,o=this.m_PieceUIBV.v+t*this.m_ProgressSpeed;o>=this.vm.srcPieceBV.v&&(o=this.vm.srcPieceBV.v,this.unschedule(this.m_ProgressScheduler),this.m_ProgressScheduler=null),this.m_PieceUIBV.v=o,this.m_ToolUIBV.v+=Math.floor(o/s.BPLS.PIECE_TO_TOOL)-Math.floor(e/s.BPLS.PIECE_TO_TOOL)}},e.prototype.SyncUI=function(){if(this.m_ToolUIBV.v=this.vm.srcBV.v,p.default.Release){var t=localStorage.getItem("userToken"),e=new FormData;e.append("token",t),e.append("rocket_cnt",s.BPLS.ins.RocketCntBV.v+""),e.append("bomb_cnt",s.BPLS.ins.BombCntBV.v+""),e.append("rocket_piece_cnt",s.BPLS.ins.RocketPieceCntBV.v+""),e.append("bomb_piece_cnt",s.BPLS.ins.BombPieceCntBV.v+""),l.httpPost("/api/updateInfoRocketThreeMatch",function(t,e){0===Number(t)&&1===Number(e.code)&&console.log("\u66f4\u65b0\u4fc4\u7f57\u65af\u6d88\u9664\u706b\u7bad\u5f39\u70b8\u5f39="+e.message)},e)}},r([f({type:cc.Sprite,tooltip:"\u8fdb\u5ea6\u6761"})],e.prototype,"m_PieceProgressSprite",void 0),r([f({type:cc.Sprite,tooltip:"\u6309\u94ae-\u788e\u7247\u56fe\u6807"})],e.prototype,"m_DisableSprite",void 0),r([f({type:cc.Sprite,tooltip:"\u6309\u94ae-\u706b\u7bad\u56fe\u6807"})],e.prototype,"m_NormalSprite",void 0),r([f({type:cc.Label,tooltip:"\u6309\u94ae-\u6570\u5b57"})],e.prototype,"m_CntLabel",void 0),r([f({type:cc.Node,tooltip:"\u6309\u94ae-\u5e7f\u544a\u56fe\u6807"})],e.prototype,"m_AdNode",void 0),r([f({type:cc.Node,tooltip:"\u6309\u94ae-\u5e7f\u544a\u56fe\u6807\u80cc\u666f"})],e.prototype,"m_AdRootNode",void 0),r([h],e)}(ii.UIComp);o.default=_,cc._RF.pop()},{"../../../../../StartScene/Script/GameApp":void 0,"../../../../../StartScene/Script/HttpMgr":void 0,"../BPLS":"BPLS","../BPUtil":"BPUtil","../Type/BPToolType":"BPToolType"}],BPUIActionStar:[function(t,e,o){"use strict";cc._RF.push(e,"3413eM6hcFFz70meTLmSSPN","BPUIActionStar");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,o,a):n(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_Sprite=null,e}return n(e,t),e.prototype.OnCreate=function(){},e.prototype.OnRelease=function(){},e.prototype.OnOpen=function(){},r([c(cc.Sprite)],e.prototype,"m_Sprite",void 0),r([s],e)}(ii.UIComp);o.default=l,cc._RF.pop()},{}],BPUIBlock:[function(t,e,o){"use strict";cc._RF.push(e,"6ddcfENSptJuLZDiih8jDS1","BPUIBlock");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,o,a):n(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../BPUtil"),s=t("../../BPPrefabCfg"),c=t("../Type/BPBlockLocationType"),l=cc._decorator,p=l.ccclass,u=l.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.container=null,e.rotateNode=null,e.vm=null,e.uiDragger=null,e.m_OffsetCol=null,e.m_OffsetRow=null,e.m_UITileQueue=null,e.m_StartTween=null,e}return n(e,t),Object.defineProperty(e.prototype,"m_DockScale",{get:function(){return this.vm.location==c.default.NORMAL?.45:1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"m_InitScale",{get:function(){return this.vm.location==c.default.NORMAL?.2:.4},enumerable:!1,configurable:!0}),e.prototype.OnCreate=function(){},e.prototype.OnRelease=function(){console.assert(0==this.m_UITileQueue.Count,"\u672a\u5904\u7406\u56de\u6536\u903b\u8f91"),this.ClearDirectly(),this.m_UITileQueue.Return()},e.prototype.OnOpen=function(t){this.m_UITileQueue=ii.AnyQueue.Borrow(),this.node.position=cc.Vec3.ZERO,this.BindModel(t)},e.prototype.PreCalculate=function(){this.m_OffsetCol=.5*-(this.vm.width-1),this.m_OffsetRow=.5*-(this.vm.height-1)},e.prototype.BindModel=function(t){var e=this;this.vm=t,t.ui=this,this.container.scale=this.m_InitScale,this.PreCalculate(),this.vm.tiles.ForEach(function(t){return e.CreateUITile(t)}),cc.tween(this.container).to(.12,{scale:this.m_DockScale}).start(),this.UpdateIsCanPutdownStatus()},e.prototype.CreateUITile=function(t){var e=ii.UIMgr.ins.Create(s.default.bp.comp.BPUITile.key,t);this.container.addChild(e.node),e.node.x=this.GetColRowDragPosX(t.col,0),e.node.y=this.GetColRowDragPosY(t.row,0),this.m_UITileQueue.Enqueue(e)},e.prototype.UpdateIsCanPutdownStatus=function(){var t=this;this.m_UITileQueue.ForEach(function(e){return e.UpdateIsCanPutdownStatus(t.vm.isCanputDown)})},e.prototype.PutdownBlock=function(t,e,o,i,n){var r=this.vm,s=ii.AnyQueue.Borrow(),c=ii.Util.onceCall(function(){n(s),s.Return()},r.tiles.Count);r.tiles.RemoveAll(function(t){t.col+=o,t.row+=i,e.addBoardTileByTransfer(t),s.Enqueue(t)}),this.m_UITileQueue.RemoveAll(function(e){return ii.UIUtil.transferTo(e.node,t)}),s.ForEach(function(t){var e=a.default.GetColRowPosition(t.col,t.row);cc.tween(t.ui.node).to(.1,{position:e,scale:1}).call(c).start()})},e.prototype.ClearDirectly=function(){this.vm&&this.vm.tiles.RemoveAll(),this.m_UITileQueue.RemoveAll(function(t){return t.Close()})},e.prototype.SetRotating=function(t){this.rotateNode.active=t,t&&(cc.Tween.stopAllByTarget(this.rotateNode),cc.tween(this.rotateNode).by(2,{angle:-360}).repeatForever().start())},e.prototype.RotateTiles=function(){var t=this;this.vm.Rotate(),this.PreCalculate(),cc.tween(this.container).to(.15,{angle:-90}).call(function(){t.container.angle=0,t.vm.tiles.ForEach(function(e){e.ui.node.x=t.GetColRowDragPosX(e.col,0),e.ui.node.y=t.GetColRowDragPosY(e.row,0),e.ui.UpdateUIAfterRotate()})}).start()},e.prototype.GetColRowDragPosX=function(t,e){return(this.m_OffsetCol+t)*(this.vm.tileSize+e)},e.prototype.GetColRowDragPosY=function(t,e){return(this.m_OffsetRow+t)*(this.vm.tileSize+e)},e.prototype.GetOriginWorldPosition=function(){var t=cc.v2(this.GetColRowDragPosX(0,0),this.GetColRowDragPosY(0,0));return this.node.convertToWorldSpaceAR(t)},e.prototype.OnDragStart=function(){this.m_StartTween=cc.tween(this.container).to(.4,{scale:1},{easing:cc.easing.elasticOut}).start()},e.prototype.OnDragEnd=function(){this.m_StartTween.stop(),cc.tween(this.container).to(.15,{scale:this.m_DockScale}).start()},r([u(cc.Node)],e.prototype,"container",void 0),r([u(cc.Node)],e.prototype,"rotateNode",void 0),r([p],e)}(ii.UIComp);o.default=h,cc._RF.pop()},{"../../BPPrefabCfg":"BPPrefabCfg","../BPUtil":"BPUtil","../Type/BPBlockLocationType":"BPBlockLocationType"}],BPUIBomb:[function(t,e,o){"use strict";cc._RF.push(e,"467a7uoGlZOQodPFS1WXpQc","BPUIBomb");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,o,a):n(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../BPAudioCfg"),s=t("../BPUtil"),c=t("../../BPPrefabCfg"),l=cc._decorator,p=l.ccclass,u=l.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_BombRoot=null,e.m_BombSprite=null,e.vm=null,e}return n(e,t),e.prototype.OnCreate=function(){},e.prototype.OnRelease=function(){this.vm.Return()},e.prototype.OnOpen=function(t){this.vm=t},e.prototype.RunEffect=function(t,e,o){var i=this;ii.UIUtil.transferTo(this.node,e,!1),this.m_BombSprite.node.active=!1,this.scheduleOnce(function(){ii.AudioMgr.ins.PlayEffect(a.default.audio.bomb),i.vm.explosions.ForEach(function(i){if(o.IsInBoardRect(i.col,i.row)){var n=ii.UIMgr.ins.Create(c.default.bp.comp.BPUIParticleRocketBoomCircle.key);t.addChild(n.node),n.node.position=s.default.GetColRowPosition(i.col,i.row),n.RunEffect(e,-2);var r=ii.UIMgr.ins.Create(c.default.bp.comp.BPUIParticleBoomSmoke.key);t.addChild(r.node),r.node.position=s.default.GetColRowPosition(i.col,i.row),r.RunEffect(e,-1)}})},.1),this.scheduleOnce(function(){for(;i.vm.explosions.Count>0;)o.TryExplosion(i.vm.explosions.Dequeue());i.Close()},.1)},r([u(cc.Node)],e.prototype,"m_BombRoot",void 0),r([u(cc.Sprite)],e.prototype,"m_BombSprite",void 0),r([p],e)}(ii.UIComp);o.default=h,cc._RF.pop()},{"../../BPAudioCfg":"BPAudioCfg","../../BPPrefabCfg":"BPPrefabCfg","../BPUtil":"BPUtil"}],BPUIDragger:[function(t,e,o){"use strict";cc._RF.push(e,"0c917PcDDdFmqIgvtYQMMpK","BPUIDragger");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,o,a):n(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../BPAudioCfg"),s=t("../../BPPrefabCfg"),c=cc._decorator,l=c.ccclass,p=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.vm=null,e.m_Rotating=!1,e._touchDelegate=null,e.C_DRAG_TO_Y=180,e.C_DRAG_END_ACTION_TIME=.2,e}return n(e,t),e.prototype.HasBlock=function(){return null!=this.vm.block},e.prototype.DragTarget=function(){return this.vm.block.ui},e.prototype.OnCreate=function(){},e.prototype.OnRelease=function(){this.vm&&(null!=this.vm.block&&this.ClearBlockDirectly(),this.vm=null),this.UnbindTouch()},e.prototype.OnOpen=function(){this.BindTouch()},e.prototype.ResetPosition=function(){this.node.position=cc.Vec3.ZERO},e.prototype.BindMode=function(t){this.vm=t,t.ui=this,null!=this.vm.block&&console.error("\u672a\u5904\u7406\u521b\u5efa Block \u7684\u903b\u8f91")},e.prototype.SpawnBlock=function(t){console.assert(t==this.vm.block);var e=ii.UIMgr.ins.Create(s.default.bp.comp.BPUIBlock.key,this.vm.block);this.node.addChild(e.node),this.node.active=!0,e.uiDragger=this,this.m_Rotating&&this.SetRotating(this.m_Rotating)},e.prototype.PutdownBlock=function(t,e,o,i,n){var r=this.vm.block.ui;r.PutdownBlock(t,e,o,i,n),r.Close(),this.ResetPosition(),this.node.active=!1,null!=this.vm&&this.vm.RemoveBlock().Return()},e.prototype.ClearBlockDirectly=function(){var t=this.vm.block.ui;t.ClearDirectly(),t.Close(),this.ResetPosition(),this.node.active=!1,null!=this.vm&&this.vm.RemoveBlock().Return()},e.prototype.SetRotating=function(t){this.m_Rotating=t,null!=this.vm.block&&this.vm.block.ui.SetRotating(t)},e.prototype.SetTouchDelegate=function(t){this._touchDelegate=t},e.prototype.BindTouch=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},e.prototype.UnbindTouch=function(){this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.off(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},e.prototype.onTouchStart=function(t){return this._touchDelegate.OnDragTouchStart(this,t)},e.prototype.onTouchMove=function(t){this._touchDelegate.OnDragTouchMove(this,t)},e.prototype.onTouchEnd=function(t){this._touchDelegate.OnDragTouchEnd(this,t)},e.prototype.SetZIndex=function(t){this.node.zIndex=t},e.prototype.OnDragStart=function(t){ii.AudioMgr.ins.PlayEffect(a.default.audio.pick_up);var e=this.node.parent.convertToNodeSpaceAR(t.getLocation());this.node.x=e.x,this.node.y=e.y+this.C_DRAG_TO_Y,this.vm.block.ui.OnDragStart(),ii.EventCenter.ins.emit(ii.guide.Event.DRAG_START)},e.prototype.OnDragMove=function(t){this.node.x+=t.getDelta().x,this.node.y+=t.getDelta().y},e.prototype.OnDragEnd=function(){this.vm.block.ui.OnDragEnd(),cc.tween(this.node).to(this.C_DRAG_END_ACTION_TIME,{position:cc.Vec3.ZERO}).start(),ii.EventCenter.ins.emit(ii.guide.Event.DRAG_END)},r([l],e)}(ii.UIComp));o.default=p,cc._RF.pop()},{"../../BPAudioCfg":"BPAudioCfg","../../BPPrefabCfg":"BPPrefabCfg"}],BPUIHowToPlayDialog:[function(t,e,o){"use strict";cc._RF.push(e,"7f2f5icMz1FS6hGYbt9ma32","BPUIHowToPlayDialog");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,o,a):n(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_CornerNode=null,e.m_CornerSprite=null,e.m_Layout=null,e.m_ExchangeBackground=null,e.m_BoxSprite=null,e.m_RichText=null,e.m_Next=null,e.m_PieceSprite=null,e.m_PropSprite=null,e.m_PieceSpriteFrames=[],e.m_PropSpriteFrames=[],e.m_CallbackQueue=null,e.m_IsCallingQueue=!1,e}return n(e,t),e.prototype.doCallbackQueue=function(){for(this.m_IsCallingQueue=!0;this.m_CallbackQueue.Count>0;)this.m_CallbackQueue.Dequeue()();this.m_IsCallingQueue=!1},e.prototype.OnCreate=function(){ii.guide.ActionUtil.Run(this.m_Next,{typ:"up_down",delay:1,duration:2,from:0,to:5},null)},e.prototype.OnRelease=function(){this.doCallbackQueue(),this.m_CallbackQueue.Return(),this.m_CallbackQueue=null},e.prototype.OnOpen=function(){this.m_CallbackQueue=ii.AnyQueue.Borrow(),this.SetIIClickHandler("OnNext",this.OnNext.bind(this))},e.prototype.Show=function(t,e){if(this.m_IsCallingQueue)return console.error("\u6b63\u5728\u6267\u884c\u4e0a\u4e00\u4e2a\u5bf9\u8bdd\u6846\uff0c\u4e0d\u80fd\u5728\u6b64\u65f6\u663e\u793a\u65b0\u7684\u5bf9\u8bdd"),void e();var o=ii.Util.onceCall(e,1);this.m_CallbackQueue.Enqueue(o),this.scheduleOnce(o,t.time),this.m_RichText.string=t.text,this.m_Layout.width=Math.max(this.m_RichText.node.width+64,this.m_ExchangeBackground.width),this.m_BoxSprite.node.width=this.m_Layout.width,this.m_ExchangeBackground.active=!1,this.m_BoxSprite.node.height=this.m_RichText.node.height+12+30;var i=this.m_CornerSprite.node.height;switch(t.dir){case ii.Dir.Right:this.m_CornerNode.scaleX=1,this.m_CornerNode.scaleY=1,this.m_BoxSprite.node.position=new cc.Vec3(t.dx,i+.5*this.m_BoxSprite.node.height,0);break;case ii.Dir.Top:this.m_CornerNode.scaleX=-1,this.m_CornerNode.scaleY=1,this.m_BoxSprite.node.position=new cc.Vec3(t.dx,i+.5*this.m_BoxSprite.node.height,0);break;case ii.Dir.Left:this.m_CornerNode.scaleX=-1,this.m_CornerNode.scaleY=-1,this.m_BoxSprite.node.position=new cc.Vec3(t.dx,-i-.5*this.m_BoxSprite.node.height,0);break;case ii.Dir.Bottom:this.m_CornerNode.scaleX=1,this.m_CornerNode.scaleY=-1,this.m_BoxSprite.node.position=new cc.Vec3(t.dx,-i-.5*this.m_BoxSprite.node.height,0)}},e.prototype.OnNext=function(){this.doCallbackQueue()},r([c({type:cc.Node,tooltip:"\u89d2\u7cbe\u7075\u6839\u8282\u70b9"})],e.prototype,"m_CornerNode",void 0),r([c({type:cc.Sprite,tooltip:"\u89d2\u7cbe\u7075"})],e.prototype,"m_CornerSprite",void 0),r([c({type:cc.Node,tooltip:"\u9053\u5177\u548c\u6587\u672c\u7ad6\u76f4\u65b9\u5411\u5bb9\u5668"})],e.prototype,"m_Layout",void 0),r([c({type:cc.Node,tooltip:"\u7c89\u8272\u9053\u5177\u80cc\u666f"})],e.prototype,"m_ExchangeBackground",void 0),r([c({type:cc.Sprite,tooltip:"\u6846\u7cbe\u7075"})],e.prototype,"m_BoxSprite",void 0),r([c({type:cc.RichText,tooltip:"\u5bcc\u6587\u672c"})],e.prototype,"m_RichText",void 0),r([c({type:cc.Node,tooltip:"Next"})],e.prototype,"m_Next",void 0),r([c({type:cc.Sprite,tooltip:"\u788e\u7247\u7cbe\u7075"})],e.prototype,"m_PieceSprite",void 0),r([c({type:cc.Sprite,tooltip:"\u9053\u5177\u7cbe\u7075"})],e.prototype,"m_PropSprite",void 0),r([c({type:[cc.SpriteFrame],tooltip:"\u788e\u7247\u7eb9\u7406"})],e.prototype,"m_PieceSpriteFrames",void 0),r([c({type:[cc.SpriteFrame],tooltip:"\u9053\u5177\u7eb9\u7406"})],e.prototype,"m_PropSpriteFrames",void 0),r([s],e)}(ii.UIComp);o.default=l,cc._RF.pop()},{}],BPUIHowToPlayFinger:[function(t,e,o){"use strict";cc._RF.push(e,"60c2bB7YKtIDJ6aG19LDvEu","BPUIHowToPlayFinger");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,o,a):n(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_PointSprite=null,e.m_FingerSprite=null,e.m_PointAction=null,e.m_FingerAction=null,e.m_Step=null,e.m_Showing=!1,e}return n(e,t),e.prototype.OnCreate=function(){},e.prototype.OnRelease=function(){},e.prototype.OnOpen=function(){},e.prototype.Show=function(t){this.m_Step=t,this.node.active=!0,this.m_Showing=!0,this.node.opacity=255,this.__Show(!0)},e.prototype.Hide=function(){this.node.active=!1,this.m_Showing=!1,this.__Hide()},e.prototype.OnDragStart=function(){this.node.opacity=0},e.prototype.OnDragEnd=function(){this.node.opacity=255,this.__Show(!0)},e.prototype.__Show=function(t){if(this.m_Showing&&t){this.__Hide();var e=this.m_Step.GetNodePosition(this.node,this.m_Step.path_action.from);this.node.position=e;var o=this.m_Step.enter_action,i=o.delay+o.duration;ii.guide.ActionUtil.Run(this.m_PointSprite.node,o,null),ii.guide.ActionUtil.Run(this.m_FingerSprite.node,o,null);var n=this.m_Step.path_action.duration,r=this.m_Step.path_action.interval,a=this.m_Step.GetNodePosition(this.m_FingerAction,this.m_Step.path_action.to),s=cc.tween().set({position:cc.Vec3.ZERO,opacity:255}).to(n,{position:a}).delay(i).set({opacity:0}).delay(r);cc.tween(this.m_FingerAction).repeatForever(s).start();var c=cc.tween().set({opacity:255}).delay(n).delay(i).set({opacity:0}).delay(r);cc.tween(this.m_PointAction).repeatForever(c).start()}},e.prototype.__Hide=function(){cc.Tween.stopAllByTarget(this.m_PointSprite.node),cc.Tween.stopAllByTarget(this.m_FingerSprite.node),cc.Tween.stopAllByTarget(this.m_FingerAction),cc.Tween.stopAllByTarget(this.m_PointAction)},r([c({type:cc.Sprite,tooltip:"\u7cbe\u7075"})],e.prototype,"m_PointSprite",void 0),r([c({type:cc.Sprite,tooltip:"\u7cbe\u7075"})],e.prototype,"m_FingerSprite",void 0),r([c({type:cc.Node,tooltip:"\u52a8\u4f5c\u8282\u70b9"})],e.prototype,"m_PointAction",void 0),r([c({type:cc.Node,tooltip:"\u52a8\u4f5c\u8282\u70b9"})],e.prototype,"m_FingerAction",void 0),r([s],e)}(ii.UIComp);o.default=l,cc._RF.pop()},{}],BPUIParticleBoomSmoke:[function(t,e,o){"use strict";cc._RF.push(e,"494e7cAwxlLzoVUba9gLu4q","BPUIParticleBoomSmoke");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,o,a):n(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=(a.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._ps=null,e}return n(e,t),e.prototype.OnCreate=function(){this._ps=this.getComponent(cc.ParticleSystem)},e.prototype.OnRelease=function(){},e.prototype.OnOpen=function(){},e.prototype.RunEffect=function(t,e){var o=this;ii.UIUtil.transferTo(this.node,t,!1),this.node.zIndex=e,ii.Util.playParticleSystem(this._ps,0),this.scheduleOnce(function(){return o.Close()},.8)},r([s],e)}(ii.UIComp));o.default=c,cc._RF.pop()},{}],BPUIParticleRocketBoomCircle:[function(t,e,o){"use strict";cc._RF.push(e,"be8e4wVmERA6KE5R7qmcF6t","BPUIParticleRocketBoomCircle");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,o,a):n(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=(a.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._ps=null,e}return n(e,t),e.prototype.OnCreate=function(){this._ps=this.getComponent(cc.ParticleSystem)},e.prototype.OnRelease=function(){},e.prototype.OnOpen=function(){},e.prototype.RunEffect=function(t,e){var o=this;ii.UIUtil.transferTo(this.node,t,!1),this.node.zIndex=e,ii.Util.playParticleSystem(this._ps,0),this.scheduleOnce(function(){return o.Close()},.8)},r([s],e)}(ii.UIComp));o.default=c,cc._RF.pop()},{}],BPUIParticleRocketTail_1:[function(t,e,o){"use strict";cc._RF.push(e,"2163fd46K5G4K27r7f7X0zd","BPUIParticleRocketTail_1");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,o,a):n(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=(a.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._ps=null,e}return n(e,t),e.prototype.OnCreate=function(){this._ps=this.getComponent(cc.ParticleSystem)},e.prototype.OnRelease=function(){},e.prototype.OnOpen=function(){this.node.position=cc.Vec3.ZERO},e.prototype.RunEffect=function(){ii.Util.playParticleSystem(this._ps,0)},r([s],e)}(ii.UIComp));o.default=c,cc._RF.pop()},{}],BPUIParticleRocketTail:[function(t,e,o){"use strict";cc._RF.push(e,"05afbLVjWpL4INC8351fv0d","BPUIParticleRocketTail");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,o,a):n(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=(a.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._ps=null,e}return n(e,t),e.prototype.OnCreate=function(){this._ps=this.getComponent(cc.ParticleSystem)},e.prototype.OnRelease=function(){},e.prototype.OnOpen=function(){this.node.position=cc.Vec3.ZERO},e.prototype.RunEffect=function(){ii.Util.playParticleSystem(this._ps,0)},r([s],e)}(ii.UIComp));o.default=c,cc._RF.pop()},{}],BPUIRocketHalf:[function(t,e,o){"use strict";cc._RF.push(e,"a99afjaV75C5Yfqq2pQ9buQ","BPUIRocketHalf");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,o,a):n(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../BPUtil"),s=t("../../BPPrefabCfg"),c=t("./BPUIParticleRocketTail_1"),l=cc._decorator,p=l.ccclass,u=l.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_Rocket=null,e.m_TailContainer=null,e.vm=null,e.fsm=null,e.SM_STATUS={none:"none",flying:"flying",done:"done"},e.SM_EVENT={Fly:"Fly",Finish:"Finish",Reset:"Reset"},e.m_ActionCallback=null,e.m_Game=null,e.m_FlyingScheduler=null,e.m_Speed=0,e}return n(e,t),e.prototype.OnCreate=function(){this.fsm=ii.StateMachine.create({final:this.SM_STATUS.done,events:[{name:this.SM_EVENT.Fly,from:this.SM_STATUS.none,to:this.SM_STATUS.flying},{name:this.SM_EVENT.Finish,from:this.SM_STATUS.flying,to:this.SM_STATUS.done},{name:this.SM_EVENT.Reset,from:ii.StateMachine.WILDCARD,to:this.SM_STATUS.none}],callbacks:{onenterstate:this.onEnterState.bind(this)}})},e.prototype.OnOpen=function(t){this.vm=t,this.m_Rocket.angle=90*this.vm.toolDir;var e=ii.UIMgr.ins.Create(s.default.bp.comp.BPUIParticleRocketTail_1.key,t);this.m_TailContainer.addChild(e.node),e.RunEffect()},e.prototype.OnRelease=function(){this.fsm.Reset(),this.m_TailContainer.getComponentInChildren(c.default).Close(),this.vm.Return(),this.m_Game=null},e.prototype.RunEffect=function(t,e,o){this.node.position=cc.Vec3.ZERO,ii.UIUtil.transferTo(this.node,t,!1),this.node.zIndex=e,this.m_Game=o,this.fsm.Fly()},e.prototype.onEnterState=function(t,e,o){switch(o){case this.SM_STATUS.none:break;case this.SM_STATUS.flying:this.m_FlyingScheduler=this.CreateFlyingScheduler(),this.schedule(this.m_FlyingScheduler,0,cc.macro.REPEAT_FOREVER);break;case this.SM_STATUS.done:this.m_ActionCallback&&this.m_ActionCallback(),this.Close();break;default:console.error("state: "+o+" no handled")}},e.prototype.CreateFlyingScheduler=function(){var t=this;switch(this.m_Speed=.05/a.default.TILE_INTERVAL*600,this.vm.toolDir){case ii.Dir.Right:return function(e){return t.__updatePerFrameForFlyingToRight(e)};case ii.Dir.Left:return function(e){return t.__updatePerFrameForFlyingToLeft(e)};case ii.Dir.Bottom:return function(e){return t.__updatePerFrameForFlyingToBottom(e)};case ii.Dir.Top:default:return function(e){return t.__updatePerFrameForFlyingToTop(e)}}},e.prototype.__flyingCheckFinish=function(){return this.vm.total_ds>20*a.default.layout.TileSize&&(this.unschedule(this.m_FlyingScheduler),this.m_FlyingScheduler=null,this.fsm.Finish(),!0)},e.prototype.__TryExplosion=function(t){if(this.vm.ds+=t,this.vm.total_ds+=t,this.vm.ds>a.default.layout.TileSize&&(this.vm.ds-=a.default.layout.TileSize,this.vm.explosions.Count>0)){var e=this.vm.explosions.Dequeue();this.m_Game.TryExplosion(e)}},e.prototype.__updatePerFrameForFlyingToRight=function(t){if(!this.__flyingCheckFinish()){var e=this.m_Speed*t;this.node.x+=e,this.__TryExplosion(e)}},e.prototype.__updatePerFrameForFlyingToLeft=function(t){if(!this.__flyingCheckFinish()){var e=this.m_Speed*t;this.node.x+=-e,this.__TryExplosion(e)}},e.prototype.__updatePerFrameForFlyingToBottom=function(t){if(!this.__flyingCheckFinish()){var e=this.m_Speed*t;this.node.y+=-e,this.__TryExplosion(e)}},e.prototype.__updatePerFrameForFlyingToTop=function(t){if(!this.__flyingCheckFinish()){var e=this.m_Speed*t;this.node.y+=e,this.__TryExplosion(e)}},r([u(cc.Node)],e.prototype,"m_Rocket",void 0),r([u(cc.Node)],e.prototype,"m_TailContainer",void 0),r([p],e)}(ii.UIComp);o.default=h,cc._RF.pop()},{"../../BPPrefabCfg":"BPPrefabCfg","../BPUtil":"BPUtil","./BPUIParticleRocketTail_1":"BPUIParticleRocketTail_1"}],BPUIRocket:[function(t,e,o){"use strict";cc._RF.push(e,"89fdfSTqERM+plnHRYtjndR","BPUIRocket");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,o,a):n(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../BPAudioCfg"),s=t("../BPUtil"),c=t("../../BPPrefabCfg"),l=t("../Data/BPDataRocketHalf"),p=cc._decorator,u=p.ccclass,h=(p.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.vm=null,e}return n(e,t),e.prototype.OnCreate=function(){},e.prototype.OnRelease=function(){this.vm.Return()},e.prototype.OnOpen=function(t){this.vm=t},e.prototype.RunEffect=function(t,e){var o=this;ii.UIUtil.transferTo(this.node,t,!1);var i=ii.UIMgr.ins.Create(c.default.bp.comp.BPUIParticleRocketBoomCircle.key);this.node.addChild(i.node),i.node.position=cc.Vec3.ZERO,i.RunEffect(t,1),ii.AudioMgr.ins.PlayEffect(a.default.audio.rocket_start);for(var n=0;n<2;++n){var r=(0==n?this.vm.toolDir:this.vm.toolDir+2)%4,p=l.default.Borrow().Init(this.vm.col,this.vm.row,r,s.default.layout.COL,s.default.layout.ROW),u=ii.UIMgr.ins.Create(c.default.bp.comp.BPUIRocketHalf.key,p);this.node.addChild(u.node),u.RunEffect(t,2,e)}var h=ii.UIMgr.ins.Create(c.default.bp.comp.BPUIParticleBoomSmoke.key);this.node.addChild(h.node),h.node.position=cc.Vec3.ZERO,h.RunEffect(t,3),this.scheduleOnce(function(){o.Close()},.1)},r([u],e)}(ii.UIComp));o.default=h,cc._RF.pop()},{"../../BPAudioCfg":"BPAudioCfg","../../BPPrefabCfg":"BPPrefabCfg","../BPUtil":"BPUtil","../Data/BPDataRocketHalf":"BPDataRocketHalf"}],BPUIScoreWordEffect:[function(t,e,o){"use strict";cc._RF.push(e,"ed643JLzYdHbZuZGG7dMS0R","BPUIScoreWordEffect");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,o,a):n(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../BPUtil"),s=cc._decorator,c=s.ccclass,l=s.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_LevelSprite=null,e.m_ScoreLabel=null,e.fsm=null,e.SM_STATUS={none:"none",scaling:"scaling",flying:"flying",done:"done"},e.SM_EVENT={Scale:"Scale",Fly:"Fly",Finish:"Finish",Reset:"Reset"},e.m_Radian=0,e.m_Power=0,e.m_ActionCallback=null,e.m_Velocity=null,e.m_RotationSpeed=0,e.m_Gravity=0,e.m_FlyingScheduler=null,e}return n(e,t),e.prototype.OnCreate=function(){this.fsm=ii.StateMachine.create({final:this.SM_STATUS.done,events:[{name:this.SM_EVENT.Scale,from:this.SM_STATUS.none,to:this.SM_STATUS.scaling},{name:this.SM_EVENT.Fly,from:this.SM_STATUS.scaling,to:this.SM_STATUS.flying},{name:this.SM_EVENT.Finish,from:this.SM_STATUS.flying,to:this.SM_STATUS.done},{name:this.SM_EVENT.Reset,from:ii.StateMachine.WILDCARD,to:this.SM_STATUS.none}],callbacks:{onenterstate:this.onEnterState.bind(this)}})},e.prototype.OnOpen=function(){},e.prototype.OnRelease=function(){this.fsm.Reset(),this.fsm=null},e.prototype.RunGLCEffect=function(t,e){this.node.scale=.1,this.m_ScoreLabel.string="+"+e,this.m_LevelSprite.node.active=!0,this.m_LevelSprite.spriteFrame=a.default.GetGLCSpriteFrame(t),this.m_Gravity=-2600,this.RunRemoveFromBoardAction(Math.PI*(.5+.2*(.5-Math.random())),1400,null),ii.App.ins.p.vibrate.Default()},e.prototype.RunRemoveFromBoardAction=function(t,e,o){this.m_Radian=t,this.m_Power=e,this.m_ActionCallback=o,this.fsm.Scale()},e.prototype.onEnterState=function(t,e,o){var i=this;switch(o){case this.SM_STATUS.none:this.node.angle=0;break;case this.SM_STATUS.scaling:this.node.angle=0,cc.tween(this.node).to(.6,{scale:1},{easing:cc.easing.elasticOut}).delay(1).call(function(){return i.fsm.Fly()}).start();break;case this.SM_STATUS.flying:this.m_Velocity=cc.v2(0,0),this.m_RotationSpeed=40*(Math.random()-.5),this.m_FlyingScheduler=function(t){return i.__updatePerFrameForFlying(t)},this.schedule(this.m_FlyingScheduler,0,cc.macro.REPEAT_FOREVER);break;case this.SM_STATUS.done:this.m_ActionCallback&&this.m_ActionCallback(),this.Close();break;default:console.error("state: "+o+" no handled")}},e.prototype.__updatePerFrameForFlying=function(t){this.node.angle+=this.m_RotationSpeed*t,this.m_Velocity.y+=this.m_Gravity*t,this.node.x+=this.m_Velocity.x*t,this.node.y+=this.m_Velocity.y*t,this.node.convertToWorldSpaceAR(cc.Vec2.ZERO).y<-cc.winSize.height/3&&(this.unschedule(this.m_FlyingScheduler),this.m_FlyingScheduler=null,this.fsm.Finish())},r([l(cc.Sprite)],e.prototype,"m_LevelSprite",void 0),r([l(cc.Label)],e.prototype,"m_ScoreLabel",void 0),r([c],e)}(ii.UIComp);o.default=p,cc._RF.pop()},{"../BPUtil":"BPUtil"}],BPUIShadowTile:[function(t,e,o){"use strict";cc._RF.push(e,"92ca1+9V1ZM2IK7lb6TRuYg","BPUIShadowTile");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,o,a):n(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_Sprite=null,e}return n(e,t),e.prototype.OnCreate=function(){},e.prototype.OnRelease=function(){},e.prototype.OnOpen=function(){},e.prototype.ShowShadow=function(t){this.m_Sprite.spriteFrame=t},r([c(cc.Sprite)],e.prototype,"m_Sprite",void 0),r([s],e)}(ii.UIComp);o.default=l,cc._RF.pop()},{}],BPUITargetTipTile:[function(t,e,o){"use strict";cc._RF.push(e,"6433cqT70pHhI8i9CAkQQsr","BPUITargetTipTile");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,o,a):n(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_Sprite=null,e}return n(e,t),e.prototype.OnCreate=function(){},e.prototype.OnOpen=function(){},e.prototype.OnRelease=function(){},r([c(cc.Sprite)],e.prototype,"m_Sprite",void 0),r([s],e)}(ii.UIComp);o.default=l,cc._RF.pop()},{}],BPUITile:[function(t,e,o){"use strict";cc._RF.push(e,"f5c0eQ2Lf1DG7nO7zNF4n7L","BPUITile");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,o,a):n(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../BPUtil"),s=t("../Type/BPTileType"),c=cc._decorator,l=c.ccclass,p=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_ColorSprite=null,e.m_AvatarSpriteRoot=null,e.m_AvatarSprite=null,e.m_StarLabel=null,e.fsm=null,e.SM_STATUS={none:"none",flying:"flying",done:"done"},e.SM_EVENT={Fly:"Fly",Finish:"Finish",Reset:"Reset"},e.vm=null,e.m_DisplayColor=0,e.m_Highlight=!1,e.m_Radian=0,e.m_Power=0,e.m_ActionCallback=null,e.m_Velocity=null,e.m_RotationSpeed=0,e.m_Gravity=0,e.m_FlyingScheduler=null,e}return n(e,t),e.prototype.GetStarSprite=function(){return this.m_AvatarSprite},e.prototype.OnCreate=function(){console.assert(null==this.fsm),this.fsm=ii.StateMachine.create({final:this.SM_STATUS.done,events:[{name:this.SM_EVENT.Fly,from:this.SM_STATUS.none,to:this.SM_STATUS.flying},{name:this.SM_EVENT.Finish,from:this.SM_STATUS.flying,to:this.SM_STATUS.done},{name:this.SM_EVENT.Reset,from:ii.StateMachine.WILDCARD,to:this.SM_STATUS.none}],callbacks:{onenterstate:this.onEnterState.bind(this)}})},e.prototype.OnRelease=function(){this.fsm.Reset(),this.vm.Return(),this.fsm=null},e.prototype.OnOpen=function(t){switch(this.vm=t,t.ui=this,this.m_DisplayColor=this.vm.color,this.m_Highlight=!1,this.__updateColorSpriteFrame(),this.__updateAvatarVisiableAndRotation(),this.vm.typ){case s.BPTileType.Default:break;case s.BPTileType.Star:this.m_AvatarSprite.spriteFrame=a.default.GetStarSpriteFrame(this.m_Highlight);break;case s.BPTileType.Rocket:this.m_AvatarSprite.spriteFrame=a.default.GetRocketSpriteFrame();break;case s.BPTileType.Bomb:this.m_AvatarSprite.spriteFrame=a.default.GetBombSpriteFrame();break;case s.BPTileType.RocketPiece:this.m_AvatarSprite.spriteFrame=a.default.GetRocketPieceSpriteFrame();break;case s.BPTileType.BombPiece:this.m_AvatarSprite.spriteFrame=a.default.GetBombPieceSpriteFrame();break;default:console.error("Type of "+this.vm.typ+" not handled!")}this.__UpdateStarLabel()},e.prototype.__updateColorSpriteFrame=function(){this.m_ColorSprite.spriteFrame=a.default.GetSpriteFrame(this.m_DisplayColor,this.m_Highlight)},e.prototype.__updateStarSpriteFrame=function(){this.vm.typ==s.BPTileType.Star&&(this.m_AvatarSprite.spriteFrame=a.default.GetStarSpriteFrame(this.m_Highlight))},e.prototype.UpdateStarVisiable=function(){this.__updateAvatarVisiableAndRotation()},e.prototype.__updateAvatarVisiableAndRotation=function(){switch(this.vm.typ){case s.BPTileType.Default:this.m_AvatarSpriteRoot.angle=0,this.m_AvatarSpriteRoot.active=!1;break;case s.BPTileType.Star:this.m_AvatarSpriteRoot.angle=0,this.m_AvatarSpriteRoot.active=this.vm.remainCount>0;break;case s.BPTileType.Rocket:this.m_AvatarSpriteRoot.active=!0,this.m_AvatarSpriteRoot.angle=90*this.vm.toolDir;break;case s.BPTileType.Bomb:case s.BPTileType.RocketPiece:case s.BPTileType.BombPiece:this.m_AvatarSpriteRoot.angle=0,this.m_AvatarSpriteRoot.active=!0;break;default:console.error("Type of "+this.vm.typ+" not handled!")}},e.prototype.UpdateStarLabel=function(t){var e=this;t?cc.tween(this.node).to(.15,{scale:1.2}).to(.2,{scale:1}).call(function(){return e.__UpdateStarLabel()}).start():this.__UpdateStarLabel()},e.prototype.__UpdateStarLabel=function(){this.m_StarLabel.string=""+this.vm.remainCount,this.m_StarLabel.node.active=this.vm.remainCount>1},e.prototype.UpdateIsCanPutdownStatus=function(t){t?this.ResetDisplayColorAndHighlight():this.m_ColorSprite.spriteFrame=a.default.GetDisableSpriteFrame()},e.prototype.SetHighlight=function(t){this.m_Highlight=t,this.__updateColorSpriteFrame(),this.__updateStarSpriteFrame()},e.prototype.SetDisplayColorWithHighlight=function(t){this.m_Highlight=!0,this.m_DisplayColor=t,this.__updateColorSpriteFrame(),this.__updateStarSpriteFrame()},e.prototype.ResetDisplayColorAndHighlight=function(){this.m_Highlight=!1,this.m_DisplayColor=this.vm.color,this.__updateColorSpriteFrame(),this.__updateStarSpriteFrame()},e.prototype.UpdateUIAfterRotate=function(){this.vm.typ==s.BPTileType.Rocket&&(this.m_AvatarSpriteRoot.angle=90*this.vm.toolDir)},e.prototype.RunClearAction=function(){var t=this;this.m_AvatarSpriteRoot.active=!1;var e=function(){return t.Close()},o=this.vm.dismissInfo,i=o.Order;switch(o.Face){case ii.Dir.Left:case ii.Dir.Right:var n=i*(o.Face==ii.Dir.Left?-1:1),r=.5*Math.PI+Math.PI/3*(n/(a.default.layout.COL-1))+10*Math.random(),s=0;s=0==i?3e3*(1-.1*Math.abs(n)):this.vm.col===a.default.layout.COL-1||0===this.vm.col?3e3:3e3*(.4+.1*Math.random()),this.RunRemoveFromBoardAction(r,s,e);break;case ii.Dir.Top:case ii.Dir.Bottom:var c=i*(o.Face==ii.Dir.Bottom?-1:1);r=.5*Math.PI+(Math.random()-.5)*Math.PI/3,s=0,s=0==i?3e3*(1-.1*Math.abs(c)):3e3*(.4+.1*Math.random()),this.RunRemoveFromBoardAction(r,s,e)}},e.prototype.RunRemoveFromBoardAction=function(t,e,o){this.m_Radian=t,this.m_Power=e,this.m_ActionCallback=o,this.fsm.Fly()},e.prototype.onEnterState=function(t,e,o){var i=this;switch(o){case this.SM_STATUS.none:this.node.angle=0;break;case this.SM_STATUS.flying:this.m_Velocity=cc.v2(0,0),this.m_Velocity.x=30*Math.sin(this.m_Radian),this.m_Velocity.y=this.m_Power*(.8+.2*Math.cos(this.m_Radian)),this.m_RotationSpeed=600*(.3+.7*Math.random()),this.m_Gravity=-5e3,this.m_FlyingScheduler=function(t){return i.__updatePerFrameForFlying(t)},this.schedule(this.m_FlyingScheduler,0,cc.macro.REPEAT_FOREVER);break;case this.SM_STATUS.done:this.m_ActionCallback&&this.m_ActionCallback();break;default:console.error("state: "+o+" no handled")}},e.prototype.__updatePerFrameForFlying=function(t){this.node.angle+=this.m_RotationSpeed*t,this.m_Velocity.y+=this.m_Gravity*t,this.node.x+=this.m_Velocity.x*t,this.node.y+=this.m_Velocity.y*t,this.node.convertToWorldSpaceAR(cc.Vec2.ZERO).y<-cc.winSize.height/3&&(this.unschedule(this.m_FlyingScheduler),this.m_FlyingScheduler=null,this.fsm.Finish())},r([p(cc.Sprite)],e.prototype,"m_ColorSprite",void 0),r([p({type:cc.Node,tooltip:"\u5c55\u793a\u7cbe\u7075\u7684\u7236\u8282\u70b9"})],e.prototype,"m_AvatarSpriteRoot",void 0),r([p({type:cc.Sprite,tooltip:"\u5c55\u793a\u7684\u7cbe\u7075"})],e.prototype,"m_AvatarSprite",void 0),r([p(cc.Label)],e.prototype,"m_StarLabel",void 0),r([l],e)}(ii.UIComp);o.default=u,cc._RF.pop()},{"../BPUtil":"BPUtil","../Type/BPTileType":"BPTileType"}],BPUITipTile:[function(t,e,o){"use strict";cc._RF.push(e,"c2fe6g7SeFC1LMHp/xP+54c","BPUITipTile");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,o,a):n(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._scaleNode=null,e.m_Sprite=null,e}return n(e,t),e.prototype.OnCreate=function(){},e.prototype.OnRelease=function(){},e.prototype.OnOpen=function(){},e.prototype.RunTipAction=function(t){this.m_Sprite.spriteFrame=t,this.m_Sprite.node.opacity=0;var e=cc.tween(this.m_Sprite.node).to(1,{opacity:255}).to(1,{opacity:0});cc.tween(this.m_Sprite.node).repeatForever(e).start()},e.prototype.StopTipAction=function(){cc.Tween.stopAllByTarget(this.m_Sprite.node)},r([c({type:cc.Node,visible:!0,tooltip:"\u7f29\u653e\u8282\u70b9"})],e.prototype,"_scaleNode",void 0),r([c(cc.Sprite)],e.prototype,"m_Sprite",void 0),r([s],e)}(ii.UIComp);o.default=l,cc._RF.pop()},{}],BPUtil:[function(t,e,o){"use strict";cc._RF.push(e,"15d8bcv31hIJLEexiM//VsV","BPUtil"),Object.defineProperty(o,"__esModule",{value:!0});var i=function(){function t(){}return t.SetSkin=function(t){this.m_Skin=t},t.SetSpriteFrames=function(t){this.m_Sprites=t},t.SetHighlightSpriteFrames=function(t){this.m_HighlightSprites=t},t.__GetSpriteFrame=function(t){return this.m_Sprites[t+this.m_Skin*this.layout.COLOR_LENGTH]},t.__GetHighlightSpriteFrame=function(t){return this.m_HighlightSprites[t+this.m_Skin*this.layout.COLOR_LENGTH]},t.GetSpriteFrame=function(t,e){return e?this.__GetHighlightSpriteFrame(t):this.__GetSpriteFrame(t)},t.SetDisableSpriteFrames=function(t){this.m_DisableSprites=t},t.GetDisableSpriteFrame=function(){return this.m_DisableSprites[this.m_Skin]},t.SetStarSpriteFrame=function(t,e){this.m_StarSpriteFrame=t,this.m_HighlightStarSpriteFrame=e},t.GetStarSpriteFrame=function(t){return t?this.m_HighlightStarSpriteFrame:this.m_StarSpriteFrame},t.SetGLCSpriteFrames=function(t){this.m_GLCSpriteFrames=t},t.GetGLCSpriteFrame=function(t){return t<this.m_GLCSpriteFrames.length?this.m_GLCSpriteFrames[t]:this.m_GLCSpriteFrames[this.m_GLCSpriteFrames.length-1]},t.SetRocketSpriteFrame=function(t){this.m_RocketSpriteFrame=t},t.GetRocketSpriteFrame=function(){return this.m_RocketSpriteFrame},t.SetRocketPieceSpriteFrame=function(t){this.m_RocketPieceSpriteFrame=t},t.GetRocketPieceSpriteFrame=function(){return this.m_RocketPieceSpriteFrame},t.SetBombSpriteFrame=function(t){this.m_BombSpriteFrame=t},t.GetBombSpriteFrame=function(){return this.m_BombSpriteFrame},t.SetBombPieceSpriteFrame=function(t){this.m_BombPieceSpriteFrame=t},t.GetBombPieceSpriteFrame=function(){return this.m_BombPieceSpriteFrame},t.GetOriginColAndRow=function(t,e,o){var i=t.GetOriginWorldPosition(),n=e.convertToNodeSpaceAR(i),r=Math.floor(n.x/this.layout.TileSize),a=Math.floor(n.y/this.layout.TileSize);o.col=r,o.row=a},t.GetColRowPosition=function(t,e){return new cc.Vec3((.5+t)*this.layout.TileSize,(.5+e)*this.layout.TileSize,0)},t.SetColRowPosition=function(t,e,o){t.x=(.5+e)*this.layout.TileSize,t.y=(.5+o)*this.layout.TileSize},t.TILE_INTERVAL=.04,t.m_Skin=0,t.m_Sprites=[],t.m_HighlightSprites=[],t.m_DisableSprites=null,t.m_StarSpriteFrame=null,t.m_HighlightStarSpriteFrame=null,t.m_GLCSpriteFrames=null,t.m_RocketSpriteFrame=null,t.m_RocketPieceSpriteFrame=null,t.m_BombSpriteFrame=null,t.m_BombPieceSpriteFrame=null,t.spToolRocketNormal=null,t.spToolRocketPiece=null,t.spToolBombNormal=null,t.spToolBombPiece=null,t.layout=null,t}();o.default=i,cc._RF.pop()},{}],BPWinUIPanel:[function(t,e,o){"use strict";cc._RF.push(e,"14a2cmOEctHRpPgUZjGQlxe","BPWinUIPanel");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,o,a):n(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../BPAudioCfg"),s=t("../../BPPrefabCfg"),c=t("../BPLS"),l=t("../../_Public/UIPanel/BPActionUIPanel"),p=t("../../../../../StartScene/Script/HttpMgr"),u=t("../../../../../StartScene/Script/GameApp"),h=cc._decorator,f=h.ccclass,_=h.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_StarLabel=null,e.m_ScoreLabel=null,e.welldoneNode=null,e.lightBG=null,e.lihuaPS=null,e.lihuaParticles=[],e.buttonList=[],e._adBtnRoot=null,e._rewardSprite=null,e._watchADSprite=null,e._costlbl=null,e.tipsLbl=null,e.m_RepeatTween=null,e.m_Reward=!1,e}return n(e,t),e.prototype.SetRewarded=function(t){this.m_Reward=t,this._rewardSprite.node.active=this.m_Reward,this._costlbl.node.active=!this.m_Reward},e.prototype.OnOpen=function(e){var o=this;t.prototype.OnOpen.call(this,null),ii.AudioMgr.ins.PlayEffect(a.default.audio.win),this.m_StarLabel.string=""+e.Star,this.m_ScoreLabel.string=""+e.Score,this.SetIIClickHandler("OnAD",function(){return o.OnAD()}),this.SetIIClickHandler("OnNewGame",function(){return o.ExitWithAction(e.OnNewGame,!1)}),this.SetIIClickHandler("OnRetry",function(){return o.ExitWithAction(e.OnRetry,!1)}),this.welldoneNode.scale=0,this.welldoneNode.position=cc.Vec3.ZERO,this.buttonList.forEach(function(t){return t.active=!1}),this.m_RepeatTween=cc.tween(this.lightBG).repeatForever(cc.tween(this.lightBG).to(8,{angle:360})).start(),ii.App.ins.p.ad.ShowBanner(!0),this.SetRewarded(!1),this.SetADButtonActive(ii.App.ins.p.ad.IsSupport()&&ii.App.ins.p.ad.IsRewardedVideoAvailable()),this.tipsLbl.node.active=!1},e.prototype.OnRelease=function(){this.m_RepeatTween.stop(),ii.App.ins.p.ad.ShowBanner(!1),t.prototype.OnRelease.call(this)},e.prototype.OnEnter=function(){var e=this;t.prototype.OnEnter.call(this),cc.tween(this.welldoneNode).to(.4,{scale:1,position:cc.v3(0,40,0)},{easing:cc.easing.elasticOut}).call(function(){return e.PlayPSEffect()}).start(),this.tipsLbl.node.active=!1},e.prototype.PlayPSEffect=function(){var t=this;ii.AudioMgr.ins.PlayEffect(a.default.audio.lihua);for(var e=0;e<this.lihuaParticles.length;++e)ii.Util.playParticleSystem(this.lihuaParticles[e],.2*e);ii.Util.playParticleSystem(this.lihuaPS,1),this.buttonList.forEach(function(t){return t.active=!0}),this.scheduleOnce(function(){t.TryToShowFiveStar()},1.2)},e.prototype.TryToShowFiveStar=function(){c.BPLS.ins.IsFiveStarRecorded()||(c.BPLS.ins.GetFiveStarWinCount()>20&&ii.UIMgr.ins.Open(s.default.bp.panel.BPFiveStarUIPanel.key),c.BPLS.ins.AddFiveStarWinCount())},e.prototype.SetADButtonActive=function(){},e.prototype.OnAD=function(){if(!this.m_Reward)if(u.default.Release){var t="/api/smallGameCast",e=localStorage.getItem("userToken");console.log("\u8bf7\u6c42url122="+t);var o=new FormData;o.append("token",e),o.append("game_id","6");var i=this;p.httpPost(t,function(t,e){0===Number(t)&&(1===Number(e.code)?(console.log("\u4fc4\u7f57\u65af\u6d88\u9664\u706b\u7bad\u70b8\u5f395="+e.message),c.BPLS.ins.RocketCntBV.v+=5,c.BPLS.ins.BombCntBV.v+=5,ii.EventCenter.ins.emit(c.BPLS.event.ROCKET_REWARDED,c.BPLS.ins.RocketCntBV.v),ii.EventCenter.ins.emit(c.BPLS.event.BOMB_REWARDED,c.BPLS.ins.BombCntBV.v),i.SetRewarded(!0)):i.ShowTips(e.message))},o)}else c.BPLS.ins.RocketCntBV.v+=5,c.BPLS.ins.BombCntBV.v+=5,ii.EventCenter.ins.emit(c.BPLS.event.ROCKET_REWARDED,c.BPLS.ins.RocketCntBV.v),ii.EventCenter.ins.emit(c.BPLS.event.BOMB_REWARDED,c.BPLS.ins.BombCntBV.v),this.SetRewarded(!0)},e.prototype.ShowTips=function(t){var e=this;this.tipsLbl.node.active=!0,this.tipsLbl.string=t,setTimeout(function(){e.tipsLbl.node.active=!1},3e3)},r([_({type:cc.Label,tooltip:"\u661f\u661f\u6570"})],e.prototype,"m_StarLabel",void 0),r([_({type:cc.Label,tooltip:"\u5206\u6570"})],e.prototype,"m_ScoreLabel",void 0),r([_({type:cc.Node,tooltip:"welldone"})],e.prototype,"welldoneNode",void 0),r([_({type:cc.Node,tooltip:"\u5149\u80cc\u666f"})],e.prototype,"lightBG",void 0),r([_({type:cc.ParticleSystem,tooltip:"\u64ad\u653e\u4e00\u6b21\u7684\u793c\u82b1"})],e.prototype,"lihuaPS",void 0),r([_({type:[cc.ParticleSystem],tooltip:"\u4e09\u4e2a\u7c92\u5b50\u8f6e\u6d41\u64ad\u653e\u4e00\u6b21"})],e.prototype,"lihuaParticles",void 0),r([_({type:[cc.Node],tooltip:"\u6309\u94ae\u5217\u8868"})],e.prototype,"buttonList",void 0),r([_({type:cc.Node,visible:!0,tooltip:"\u770b\u5e7f\u544a\u83b7\u5f97\u706b\u7bad\u548c\u70b8\u5f39\u5bb9\u5668\u8282\u70b9"})],e.prototype,"_adBtnRoot",void 0),r([_({type:cc.Sprite,visible:!0,tooltip:"\u5df2\u770b\u5e7f\u544a\u56fe\u7247"})],e.prototype,"_rewardSprite",void 0),r([_({type:cc.Sprite,visible:!0,tooltip:"\u770b\u5e7f\u544a\u56fe\u7247"})],e.prototype,"_watchADSprite",void 0),r([_({type:cc.Label,visible:!0,tooltip:"\u82b1\u8d39\u94bb\u77f3\u6587\u672c\u63d0\u793a"})],e.prototype,"_costlbl",void 0),r([_({type:cc.Label,tooltip:"tips"})],e.prototype,"tipsLbl",void 0),r([f],e)}(l.default);o.default=d,cc._RF.pop()},{"../../../../../StartScene/Script/GameApp":void 0,"../../../../../StartScene/Script/HttpMgr":void 0,"../../BPAudioCfg":"BPAudioCfg","../../BPPrefabCfg":"BPPrefabCfg","../../_Public/UIPanel/BPActionUIPanel":"BPActionUIPanel","../BPLS":"BPLS"}],BlockPuzzleCfg:[function(t,e,o){"use strict";cc._RF.push(e,"c64c0eb6lZNKYEz/HRCnH5o","BlockPuzzleCfg"),Object.defineProperty(o,"__esModule",{value:!0}),o.BlockPuzzleCfg=void 0;var i=t("./BPAudioCfg"),n=t("./BPJsonCfg"),r=t("./BPPrefabCfg"),a=function(){function t(){}return t.Register=function(){i.default.Register(this.BundleName),n.default.Register(this.BundleName),r.default.Register(this.BundleName)},t.BundleName="BlockPuzzle",t}();o.BlockPuzzleCfg=a,cc._RF.pop()},{"./BPAudioCfg":"BPAudioCfg","./BPJsonCfg":"BPJsonCfg","./BPPrefabCfg":"BPPrefabCfg"}],BlockPuzzleGameScene:[function(t,e,o){"use strict";cc._RF.push(e,"36396CsadVKX6gPMTkUaQcH","BlockPuzzleGameScene");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,o,a):n(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__spreadArrays||function(){for(var t=0,e=0,o=arguments.length;e<o;e++)t+=arguments[e].length;var i=Array(t),n=0;for(e=0;e<o;e++)for(var r=arguments[e],a=0,s=r.length;a<s;a++,n++)i[n]=r[a];return i};Object.defineProperty(o,"__esModule",{value:!0});var s=t("../BlockPuzzleCfg"),c=t("../BPAudioCfg"),l=t("../BPJsonCfg"),p=t("../BPPrefabCfg"),u=cc._decorator,h=u.ccclass,f=(u.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.KEEP_RES_LIST=[p.default.pub.panel.BPSettingUIPanel.key,p.default.bp.panel.BPWinUIPanel.key,p.default.bp.panel.BPGoalUIPanel.key,c.default.audio.default_effect,c.default.audio.tip_exit,c.default.audio.pick_up,c.default.audio.put_down,c.default.audio.clear,c.default.audio.tile_clear,c.default.audio.star_reach,c.default.audio.glc_0_cool,c.default.audio.glc_1_great,c.default.audio.glc_2_awesome,c.default.audio.glc_3_perfect,c.default.audio.glc_4_amazing,c.default.audio.rocket_start,c.default.audio.rocket_hit,c.default.audio.bomb],e}return n(e,t),e.prototype.GetDefaultEffectAudioKey=function(){return c.default.audio.default_effect},Object.defineProperty(e.prototype,"PRELOAD_RES_LIST",{get:function(){return a([l.default.BPHowToPlayConfig,p.default.bp.panel.BPGoalUIPanel.key],ii.prefabCfg2ResKeyList(p.default.pub.comp),ii.prefabCfg2ResKeyList(p.default.bp.comp))},enumerable:!1,configurable:!0}),e.prototype.OnInit=function(t){console.info("BlockPuzzle::OnInit"),s.BlockPuzzleCfg.Register(),this.AutoReleaseRes(this.KEEP_RES_LIST),this.LoadResList(this.PRELOAD_RES_LIST,function(){ii.UIMgr.ins.Open(p.default.bp.panel.BPGameUIPanel.key,null,t)})},r([h],e)}(ii.UIStage));o.default=f,cc._RF.pop()},{"../BPAudioCfg":"BPAudioCfg","../BPJsonCfg":"BPJsonCfg","../BPPrefabCfg":"BPPrefabCfg","../BlockPuzzleCfg":"BlockPuzzleCfg"}],BlockPuzzle:[function(t,e,o){"use strict";cc._RF.push(e,"24b98fPhMtHtaROeiaaRxkM","BlockPuzzle");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,o,a):n(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__spreadArrays||function(){for(var t=0,e=0,o=arguments.length;e<o;e++)t+=arguments[e].length;var i=Array(t),n=0;for(e=0;e<o;e++)for(var r=arguments[e],a=0,s=r.length;a<s;a++,n++)i[n]=r[a];return i};Object.defineProperty(o,"__esModule",{value:!0});var s=t("./BlockPuzzleCfg"),c=t("./BPAudioCfg"),l=t("./BPJsonCfg"),p=t("./BPPrefabCfg"),u=t("./GetStarsGame/Cfg/JsonData/GSJsonLevelsData"),h=t("./GetStarsGame/GSDataCache"),f=cc._decorator,_=f.ccclass,d=(f.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.KEEP_RES_LIST=[c.default.audio.default_effect],e.PRELOAD_RES_LIST=a([l.default.GSLevelData],ii.prefabCfg2ResKeyList(p.default.pub.comp)),e}return n(e,t),e.prototype.GetDefaultEffectAudioKey=function(){return c.default.audio.default_effect},e.prototype.OnInit=function(t){console.info("BlockPuzzle::OnInit"),s.BlockPuzzleCfg.Register(),this.AutoReleaseRes(this.KEEP_RES_LIST),this.LoadResList(this.PRELOAD_RES_LIST,function(){u.GSJsonLevelsData.Cache(l.default.GSLevelData),ii.UIMgr.ins.Open(p.default.pub.panel._BPGameListUIPanel.key,null,t)})},e.prototype.onDestroy=function(){t.prototype.onDestroy.call(this),h.GSDataCache.DestroyInstance()},r([_],e)}(ii.UIStage));o.default=d,cc._RF.pop()},{"./BPAudioCfg":"BPAudioCfg","./BPJsonCfg":"BPJsonCfg","./BPPrefabCfg":"BPPrefabCfg","./BlockPuzzleCfg":"BlockPuzzleCfg","./GetStarsGame/Cfg/JsonData/GSJsonLevelsData":"GSJsonLevelsData","./GetStarsGame/GSDataCache":"GSDataCache"}],GSBlock:[function(t,e,o){"use strict";cc._RF.push(e,"4dfa3PGydROTYTBDduAH/7i","GSBlock"),Object.defineProperty(o,"__esModule",{value:!0});var i=t("./GSTile"),n=function(){function t(){this.ui=null,this.index=-1,this.width=0,this.height=0,this.tiles=null,this.isCanputDown=!1}return t.Borrow=function(){var e=ii.ReferencePool.Borrow(t);return e.tiles=ii.AnyQueue.Borrow(),e},t.prototype.Reset=function(){this.ui=null},t.prototype.Return=function(){this.tiles.Return(),this.tiles=null,ii.ReferencePool.Return(t,this)},t.prototype.InitWithLevelBlockCfg=function(t){var e=this;return this.index=t.id,this.width=t.block.width,this.height=t.block.height,t.block.tiles.forEach(function(t){e.tiles.Enqueue(i.default.Borrow().Init(t.col,t.row,t.color,t.typ))}),this},t}();o.default=n,cc._RF.pop()},{"./GSTile":"GSTile"}],GSDataCache:[function(t,e,o){"use strict";cc._RF.push(e,"9c474D8IL5OIITeWi2dzGps","GSDataCache");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0}),o.GSDataCache=void 0;var r=t("../../../../StartScene/Script/GameApp"),a=t("../../../../StartScene/Script/HttpMgr"),s=function(){function t(){}return t.LevelsData="gs_LevelsData",t}(),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._levelsData=null,e.m_StarBV=null,e}return n(e,t),Object.defineProperty(e,"ins",{get:function(){return null===this._ins&&(this._ins=new e,this._ins.Init()),this._ins},enumerable:!1,configurable:!0}),e.DestroyInstance=function(){null!==this._ins&&(this._ins.Release(),this._ins=null)},Object.defineProperty(e.prototype,"StarCnt",{get:function(){return this.m_StarBV.v},set:function(t){if(this.m_StarBV.v=t,r.default.Release){var e=localStorage.getItem("userToken"),o=new FormData;o.append("token",e),o.append("LvStar_cnt",t+""),a.httpPost("/api/updateInfoRocketThreeMatch",function(t,e){0===Number(t)&&1===Number(e.code)&&console.log("\u66f4\u65b0\u4fc4\u7f57\u65af\u6d88\u9664\u5173\u5361\u661f\u661f="+e.message)},o)}},enumerable:!1,configurable:!0}),e.prototype.Init=function(){ii.UserLSMgr.ins.hasKey(s.LevelsData)?this._levelsData=ii.UserLSMgr.ins.getObject(s.LevelsData):this._levelsData={judge:{},passLevel:-1},this.m_StarBV=ii.NumberBV.BorrowAsUserLS("gs_star_cnt",0,!0)},e.prototype.Release=function(){this._levelsData=null,this.m_StarBV=null},e.prototype.SaveLevelsData=function(){if(ii.UserLSMgr.ins.setObject(s.LevelsData,this._levelsData,!0),r.default.Release){var t=localStorage.getItem("userToken"),e=new FormData;e.append("token",t),e.append("content",JSON.stringify(this._levelsData)),a.httpPost("/api/updateInfoRocketThreeMatch",function(t,e){0===Number(t)&&1===Number(e.code)&&console.log("\u66f4\u65b0\u4fc4\u7f57\u65af\u6d88\u9664\u5173\u5361\u6570\u636e="+e.message)},e)}},Object.defineProperty(e.prototype,"PassLevel",{get:function(){return this._levelsData.passLevel},enumerable:!1,configurable:!0}),e.prototype.GetJudge=function(t){var e=this._levelsData.judge[t];return e?e.judge:0},e.prototype.SetWin=function(t,e,o){var i=!1;t>this.PassLevel&&(this._levelsData.passLevel=t,i=!0);var n=this._levelsData.judge[e];n?n.judge<o&&(n.judge=o,i=!0):this._levelsData.judge[e]={judge:o},i&&this.SaveLevelsData()},e._ins=null,e}(cc.EventTarget);o.GSDataCache=c,cc._RF.pop()},{"../../../../StartScene/Script/GameApp":void 0,"../../../../StartScene/Script/HttpMgr":void 0}],GSDragger:[function(t,e,o){"use strict";cc._RF.push(e,"80d42v4F7NCwpN6c2imgWSw","GSDragger"),Object.defineProperty(o,"__esModule",{value:!0});var i=function(){function t(t){this.ui=null,this.block=null,this.index=t}return t.prototype.RemoveBlock=function(){var t=this.block;return this.block=null,t},t}();o.default=i,cc._RF.pop()},{}],GSGameLogic:[function(t,e,o){"use strict";cc._RF.push(e,"4a6fex2P91NebhMJcg5JOnA","GSGameLogic");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0}),o.GSGameLogic=void 0;var r=t("../Cfg/JsonData/GSJsonLevelsData"),a=t("../GSDataCache"),s=t("./Define/GSTileType"),c=t("./Model/GSBlock"),l=t("./Model/GSDragger"),p=t("./Model/GSTile"),u=function(t){function e(e,o,i){var n=t.call(this)||this;return n.m_TileSize=0,n.m_Row=0,n.m_Col=0,n.m_Draggers=[],n.tiles=null,n._col_links=[],n._row_links=[],n._stepCnt=0,n._toSpawnBlockIndex=0,n._level=-1,n._levelData=null,n._putDownDraggerIndex=-1,n.m_TileSize=e,n.m_Row=i,n.m_Col=o,n}return n(e,t),Object.defineProperty(e.prototype,"TileSize",{get:function(){return this.m_TileSize},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ROW",{get:function(){return this.m_Row},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"COL",{get:function(){return this.m_Col},enumerable:!1,configurable:!0}),e.prototype.GetColRowPosition=function(t,e){return new cc.Vec3((.5+t)*this.m_TileSize,(.5+e)*this.m_TileSize,0)},e.prototype.SetColRowPosition=function(t,e,o){t.x=(.5+e)*this.m_TileSize,t.y=(.5+o)*this.m_TileSize},e.prototype.InitWithLevel=function(t,o){this.tiles=ii.AnyQueue.Borrow();for(var i=this.m_Col-1;i>=0;--i)this._col_links.push(ii.AnyQueue.Borrow());for(var n=this.m_Row-1;n>=0;--n)this._row_links.push(ii.AnyQueue.Borrow());for(var r=0;r<3;++r){var a=new l.default(r);this.m_Draggers.push(a),this.emit(e.event.EV_BUILD_DRAGGER,a)}this.LoadLevel(t,o)},e.prototype.PlayWithLevel=function(t,e){this.LoadLevel(t,e)},Object.defineProperty(e.prototype,"Level",{get:function(){return this._level},enumerable:!1,configurable:!0}),e.prototype.LoadLevel=function(t,o){var i=this;this.__Clear(),this._stepCnt=0,this._toSpawnBlockIndex=0,this._level=t,this._levelData=o,this._levelData.star_tiles.forEach(function(t){var e=p.default.Borrow().Init(t.col,t.row,0,s.GSTileType.Star);i.addBoardTile(e,!0)}),this._levelData.tiles.forEach(function(t){var e=p.default.Borrow().Init(t.col,t.row,t.color,s.GSTileType.Default);i.addBoardTile(e,!0)}),this._levelData.blocks.forEach(function(t){return i.addBlock(t)});for(var n=0;n<this.m_Draggers.length;++n)null==this.m_Draggers[n].block&&this.HasNextBlock()&&this.SpawnNextBlock(n);this.emit(e.event.EV_INIT_LEVEL_DATA,this._level,this._levelData),this._levelData.guide&&this.emit(e.event.EV_HOW_TOP_PLAY,this._levelData.guide_data)},e.prototype.Exit=function(){this.__Clear()},e.prototype.__Clear=function(){var t=this,o=ii.AnyQueue.Borrow();this.tiles.RemoveAll(function(e){t._col_links[e.col].Remove(function(t){return t==e}),t._row_links[e.row].Remove(function(t){return t==e}),o.Enqueue(e)}),this.emit(e.event.EV_CLEAR_TILES,o);for(var i=this.m_Draggers.length-1;i>=0;--i){var n=this.m_Draggers[i];null!=n.block&&this.emit(e.event.EV_CLEAR_BLOCK,n.block)}},e.prototype.IsBlockCanPutdownToAny=function(t){for(var e=this.m_Row-(t.height-1)-1;e>=0;--e)for(var o=this.m_Col-(t.width-1)-1;o>=0;--o)if(this.IsCanPutdown(t.tiles,o,e))return!0;return!1},e.prototype.IsAnyBlockCanPutdown=function(){for(var t=this.m_Draggers.length-1;t>=0;--t){var e=this.m_Draggers[t];if(null!=e.block&&this.IsBlockCanPutdownToAny(e.block))return!0}return!1},e.prototype.IsAllDraggerEmpty=function(){for(var t=this.m_Draggers.length-1;t>=0;--t)if(null!=this.m_Draggers[t].block)return!1;return!0},e.prototype.addBoardTile=function(t,o){this.tiles.Enqueue(t),this._col_links[t.col].Enqueue(t),this._row_links[t.row].Enqueue(t),o&&this.emit(e.event.EV_ADD_BOARD_TILE,t)},e.prototype.removeBoardTile=function(t){this.tiles.Remove(function(e){return e===t}),this._col_links[t.col].Remove(function(e){return e===t}),this._row_links[t.row].Remove(function(e){return e===t})},e.prototype.addBlock=function(t){var o=c.default.Borrow().InitWithLevelBlockCfg(t);o.isCanputDown=this.IsBlockCanPutdownToAny(o),this.m_Draggers[o.index].block=o,this.emit(e.event.EV_SPAWN_BLOCK,o)},e.prototype.IsCanPutdown=function(t,e,o){var i=this,n=!0;return t.For(function(t){var r=!i.IsInBoardRect(e+t.col,o+t.row)||i.hasTile(e+t.col,o+t.row);return r&&(n=!1),r}),n},e.prototype.UpdateDraggerCanPutdownStatus=function(){for(var t=0;t<this.m_Draggers.length;++t){var o=this.m_Draggers[t].block;if(null!=o){var i=o.isCanputDown;o.isCanputDown=this.IsBlockCanPutdownToAny(o),i!=o.isCanputDown&&this.emit(e.event.EV_BLOCK_PUTDOWN_STATUS_CHANGED,o)}}},e.prototype.IsInBoardRect=function(t,e){return t>=0&&t<this.m_Col&&e>=0&&e<this.m_Row},e.prototype.hasTile=function(t,e){return this.tiles.Contains(function(o){return o.col==t&&o.row==e})},e.prototype.IsClearable=function(t,e,o){var i=this;return!this.tiles.For(function(n){if(n.typ==s.GSTileType.Star){if(i.__IsColRowEmptyAndNotFilledByDragTiles(n.col,n.row+1,t,e,o))return!0;if(i.__IsColRowEmptyAndNotFilledByDragTiles(n.col,n.row-1,t,e,o))return!0;if(i.__IsColRowEmptyAndNotFilledByDragTiles(n.col-1,n.row,t,e,o))return!0;if(i.__IsColRowEmptyAndNotFilledByDragTiles(n.col+1,n.row,t,e,o))return!0}return!1})},e.prototype.__IsColRowEmptyAndNotFilledByDragTiles=function(t,e,o,i,n){return!(!this.IsInBoardRect(t,e)||this.hasTile(t,e)||o.Contains(function(o){return o.col+i==t&&o.row+n==e}))},e.prototype.__IsColRowEmpty=function(t,e){return this.IsInBoardRect(t,e)&&!this.hasTile(t,e)},e.prototype.PutdownBlock=function(t,o,i,n){var r=this;this._putDownDraggerIndex=t.index,t.tiles.RemoveAll(function(t){t.col+=o,t.row+=i,r.addBoardTile(t,!1),n.Enqueue(t)}),++this._stepCnt,this.emit(e.event.EV_STEP_CHANGED,this._stepCnt)},e.prototype.ClearWithCollectionAfterPutdown=function(t,e){var o=this,i=ii.AnyQueue.Borrow();t.ForEach(function(t){return i.Enqueue(t)});for(var n=function(){var t=i.Dequeue();t.typ==s.GSTileType.Default&&c._col_links[t.col].Contains(function(e){return e.col==t.col&&e.row==t.row})&&c.__CollectClearableTiles(t,e)},c=this;i.Count>0;)n();if(i.Return(),!this.tiles.For(function(t){if(t.typ==s.GSTileType.Star){if(o.__IsColRowEmpty(t.col,t.row+1))return!0;if(o.__IsColRowEmpty(t.col,t.row-1))return!0;if(o.__IsColRowEmpty(t.col-1,t.row))return!0;if(o.__IsColRowEmpty(t.col+1,t.row))return!0}return!1})){var l=0;this.tiles.Remove(function(t){return t.typ==s.GSTileType.Star},function(t){o._col_links[t.col].Remove(function(e){return e===t}),o._row_links[t.row].Remove(function(e){return e===t}),e.Enqueue(t),++l});var p=r.GSJsonLevelsData.CalculateJudge(this._stepCnt,this._levelData);a.GSDataCache.ins.SetWin(this._level,this._levelData.id,p);var u=a.GSDataCache.ins.StarCnt,h=u+l;return a.GSDataCache.ins.StarCnt=h,{win:!0,winInfo:{judge:p,preStarCnt:u,curStarCnt:h,useSteps:this._stepCnt,totalSteps:this._levelData.three_star[3]}}}return{win:!1}},e.prototype.__CollectClearableTiles=function(t,e){var o=this,i=0,n=t.color,r=ii.AnyQueue.Borrow(),a=ii.AnyQueue.Borrow();for(this.removeBoardTile(t),r.Enqueue(t),a.Enqueue(t),++i;a.Count>0;){var s=a.Dequeue();this.__CollectClearableTiles_CheckColRow(n,s.col+1,s.row,r,a)&&++i,this.__CollectClearableTiles_CheckColRow(n,s.col,s.row+1,r,a)&&++i,this.__CollectClearableTiles_CheckColRow(n,s.col-1,s.row,r,a)&&++i,this.__CollectClearableTiles_CheckColRow(n,s.col,s.row-1,r,a)&&++i}a.Return(),i>=3?r.RemoveAll(function(t){return e.Enqueue(t)}):r.RemoveAll(function(t){return o.addBoardTile(t,!1)}),r.Return()},e.prototype.__CollectClearableTiles_CheckColRow=function(t,e,o,i,n){var r=this;return!!this.IsInBoardRect(e,o)&&this._col_links[e].Contains(function(e){return e.typ==s.GSTileType.Default&&e.row===o&&e.color===t},function(t){r.removeBoardTile(t),i.Enqueue(t),n.Enqueue(t)})},e.prototype.CheckStep=function(){this.UpdateDraggerCanPutdownStatus(),this.HasNextBlock()?(this.SpawnNextBlock(this._putDownDraggerIndex),this.CheckLose()):this.CheckLose()},e.prototype.HasNextBlock=function(){return r.GSJsonLevelsData.HasBlock(this._levelData,this._toSpawnBlockIndex)},e.prototype.SpawnNextBlock=function(t){console.assert(null==this.m_Draggers[t].block);var e=r.GSJsonLevelsData.GetBlock(this._levelData,this._toSpawnBlockIndex++,t);this.addBlock(e)},e.prototype.CheckLose=function(){this._stepCnt!==this._levelData.three_star[3]&&!this.IsAllDraggerEmpty()&&this.IsAnyBlockCanPutdown()||this.emit(e.event.EV_LOSE,{useSteps:this._stepCnt,totalSteps:this._levelData.three_star[3]})},e.prototype.ShowEmptyTiles=function(t,o){this.emit(e.event.EV_SHOW_EMPTY_TILES,{tiles:t,cb:o})},e.event={EV_BUILD_DRAGGER:"EV_BUILD_DRAGGER",EV_SPAWN_BLOCK:"EV_SPAWN_BLOCK",EV_ADD_BOARD_TILE:"EV_ADD_BOARD_TILE",EV_BLOCK_PUTDOWN_STATUS_CHANGED:"EV_BLOCK_PUTDOWN_STATUS_CHANGED",EV_CLEAR_TILES:"EV_CLEAR_TILES",EV_CLEAR_BLOCK:"EV_CLEAR_BLOCK",EV_STEP_CHANGED:"EV_STEP_CHANGED",EV_SHOW_EMPTY_TILES:"EV_SHOW_EMPTY_TILES",EV_HOW_TOP_PLAY:"EV_HOW_TOP_PLAY",EV_LOSE:"EV_LOSE",EV_INIT_LEVEL_DATA:"EV_INIT_LEVEL_DATA"},e}(cc.EventTarget);o.GSGameLogic=u,cc._RF.pop()},{"../Cfg/JsonData/GSJsonLevelsData":"GSJsonLevelsData","../GSDataCache":"GSDataCache","./Define/GSTileType":"GSTileType","./Model/GSBlock":"GSBlock","./Model/GSDragger":"GSDragger","./Model/GSTile":"GSTile"}],GSGameUIPanelStepComponent:[function(t,e,o){"use strict";cc._RF.push(e,"07127EK5rVB3I+hdbrBrBb4","GSGameUIPanelStepComponent");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,o,a):n(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Cfg/JsonData/GSJsonLevelsData"),s=cc._decorator,c=s.ccclass,l=s.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._stepCntLabel=null,e._circleSprite=null,e.m_LevelCfg=null,e.m_StepCnt=0,e.m_MaxStepCnt=0,e}return n(e,t),Object.defineProperty(e.prototype,"Judge",{get:function(){return a.GSJsonLevelsData.CalculateJudge(this.m_StepCnt,this.m_LevelCfg)},enumerable:!1,configurable:!0}),e.prototype.RecordStepCnt=function(t){return this.m_LevelCfg=t,this.m_MaxStepCnt=this.m_LevelCfg.three_star[3],this.m_StepCnt=0,this.SyncUI(!1),this},e.prototype.SetStep=function(t){this.m_StepCnt=t,this.SyncUI(!0)},e.prototype.SyncUI=function(t){this._stepCntLabel.string=""+(this.m_MaxStepCnt-this.m_StepCnt);var e=this.m_StepCnt>this.m_MaxStepCnt?0:(this.m_MaxStepCnt-this.m_StepCnt)/this.m_MaxStepCnt;t?cc.tween(this._circleSprite).to(.2,{fillRange:e},ii.TweenUtil.LinearProgress).start():this._circleSprite.fillRange=e},r([l({type:cc.Label,visible:!0,tooltip:"\u64cd\u4f5c\u6b65\u6570"})],e.prototype,"_stepCntLabel",void 0),r([l({type:cc.Sprite,visible:!0,tooltip:"\u8fdb\u5ea6\u5708"})],e.prototype,"_circleSprite",void 0),r([c],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../../Cfg/JsonData/GSJsonLevelsData":"GSJsonLevelsData"}],GSGameUIPanel:[function(t,e,o){"use strict";cc._RF.push(e,"49c8aYwWXJM65MFWt4UMQ2d","GSGameUIPanel");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,o,a):n(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../BlockPuzzleCfg"),s=t("../../../BPAudioCfg"),c=t("../../../BPPrefabCfg"),l=t("../../Cfg/JsonData/GSJsonLevelsData"),p=t("../../GameLogic/Define/GSTileType"),u=t("../../GameLogic/GSGameLogic"),h=t("../../GSDataCache"),f=t("./GSGameUIPanelStepComponent"),_=cc._decorator,d=_.ccclass,y=_.property,m=_.requireComponent,S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._levelLabel=null,e._effectRoot=null,e._starDashboardContainer=null,e._uiStarDashboard=null,e.TileSize=77.5,e.UI_SCALE=1.25,e.COL=8,e.ROW=8,e.vm={game:null,layout:null},e.m_StepComponent=null,e.m_GuideCtrl=null,e.highlightStarSpriteFrame=null,e.starSpriteFrame=null,e.m_Sprites=[],e.m_HighlightSprites=[],e.disableSprites=[],e.m_Skin=0,e._uiBoardParent=null,e._uiBoard=null,e._draggerAnchor=null,e._draggerContainer=null,e.m_UIDraggers=[],e.m_isTouchStart=!1,e.m_DragItem=null,e.m_TmpTile=null,e.m_PreCol=null,e.m_PreRow=null,e}return n(e,t),Object.defineProperty(e.prototype,"game",{get:function(){return this.vm.game},enumerable:!1,configurable:!0}),e.prototype.OnCreate=function(){this._uiStarDashboard=ii.UIMgr.ins.Create(c.default.pub.comp._UIStarDashboard.key,null,this._starDashboardContainer).CloseBy(this),this.m_StepComponent=this.getComponent(f.default)},e.prototype.OnRelease=function(){this.game.Exit(),this.m_GuideCtrl.Release()},e.prototype.OnOpen=function(t){this.SetIIClickHandler("OnBack",this.OnBack.bind(this)),this.SetIIClickHandler("OnSetting",this.OnSetting.bind(this)),this.m_TmpTile=ii.Tile.Borrow(),this.vm.game=new u.GSGameLogic(this.TileSize,this.COL,this.ROW),this._uiBoard=ii.UIMgr.ins.Create(c.default.pub.comp._UIBoard.key,{tileSize:this.game.TileSize,col:this.game.COL,row:this.game.ROW},this._uiBoardParent).CloseBy(this),console.assert(0==this.m_UIDraggers.length);for(var e=(this._draggerAnchor.width-20)*this._draggerAnchor.scale/3,o=0;o<3;++o){var i=new cc.Node;this._draggerContainer.addChild(i),i.position=new cc.Vec3(this._draggerAnchor.x+(o-1)*e,0,0);var n=ii.UIMgr.ins.Create(c.default.gs.comp.GSUIDragger.key,{index:o,util:this}).CloseBy(this);n.node.width=e,n.node.height=e,n.node.active=!1,i.addChild(n.node),n.SetTouchDelegate(this),this.m_UIDraggers.push(n)}this.game.on(u.GSGameLogic.event.EV_BUILD_DRAGGER,this.ON_EV_BUILD_DRAGGER,this),this.game.on(u.GSGameLogic.event.EV_ADD_BOARD_TILE,this.ON_EV_ADD_BOARD_TILE,this),this.game.on(u.GSGameLogic.event.EV_SPAWN_BLOCK,this.ON_EV_SPAWN_BLOCK,this),this.game.on(u.GSGameLogic.event.EV_BLOCK_PUTDOWN_STATUS_CHANGED,this.ON_EV_BLOCK_PUTDOWN_STATUS_CHANGED,this),this.game.on(u.GSGameLogic.event.EV_CLEAR_TILES,this.ON_EV_CLEAR_TILES,this),this.game.on(u.GSGameLogic.event.EV_CLEAR_BLOCK,this.ON_EV_CLEAR_BLOCK,this),this.game.on(u.GSGameLogic.event.EV_STEP_CHANGED,this.ON_EV_STEP_CHANGED,this),this.game.on(u.GSGameLogic.event.EV_HOW_TOP_PLAY,this.ON_EV_HOW_TOP_PLAY,this),this.game.on(u.GSGameLogic.event.EV_SHOW_EMPTY_TILES,this.ON_EV_SHOW_EMPTY_TILES,this),this.game.on(u.GSGameLogic.event.EV_LOSE,this.ON_EV_LOSE,this),this.game.on(u.GSGameLogic.event.EV_INIT_LEVEL_DATA,this.ON_EV_INIT_LEVEL_DATA,this),this.m_GuideCtrl=this.CreateGuideCtrl(t.level);var r=l.GSJsonLevelsData.GetLevelCfg(t.level);this._uiStarDashboard.StarCnt=h.GSDataCache.ins.StarCnt,this.m_StepComponent.RecordStepCnt(r),this.vm.game.InitWithLevel(t.level,r)},e.prototype.PlayNextLevel=function(){var t=this.vm.game.Level+1,e=l.GSJsonLevelsData.GetLevelCfg(t);this.m_GuideCtrl=this.CreateGuideCtrl(t),this._uiStarDashboard.StarCnt=h.GSDataCache.ins.StarCnt,this.m_StepComponent.RecordStepCnt(e),this.vm.game.PlayWithLevel(t,e)},e.prototype.Replay=function(){var t=this.vm.game.Level,e=l.GSJsonLevelsData.GetLevelCfg(t);this.m_GuideCtrl=this.CreateGuideCtrl(t),this._uiStarDashboard.StarCnt=h.GSDataCache.ins.StarCnt,this.m_StepComponent.RecordStepCnt(e),this.vm.game.PlayWithLevel(t,e)},e.prototype.OnHome=function(){ii.UIMgr.ins.LoadBundleStage(a.BlockPuzzleCfg.BundleName,null,this.Close.bind(this))},e.prototype.OnBack=function(){var t=this;ii.UIMgr.ins.Open(c.default.gs.panel.GSLevelUIPanel.key,null,function(){return t.Close()})},e.prototype.OnSetting=function(){ii.UIMgr.ins.Open(c.default.pub.panel.BPSettingUIPanel.key,{OnHome:this.OnHome.bind(this),OnHowToPlay:null,OnReplay:this.Replay.bind(this)})},e.prototype.OnWin=function(t){ii.UIMgr.ins.Open(c.default.gs.panel.GSWinUIPanel.key,{MaxLevel:l.GSJsonLevelsData.MaxLevel===this.vm.game.Level,Judge:t.judge,PreStar:t.preStarCnt,CurStar:t.curStarCnt,UseStep:t.useSteps,TotalStep:t.totalSteps,OnHome:this.OnHome.bind(this),OnReplay:this.Replay.bind(this),OnNext:this.PlayNextLevel.bind(this)})},e.prototype.CreateGuideCtrl=function(t){return ii.guide.GuideCtrl.Create("ls_guide_isguided_getstar_"+t,this)},e.prototype.OnGuideFinished=function(){},e.prototype.OnGuideGetNode=function(t){switch(t){case"tiles":return this._uiBoard.TileOriginRoot;case"dragger_0":return this.m_UIDraggers[0].node.parent;case"dragger_1":return this.m_UIDraggers[1].node.parent;case"dragger_2":return this.m_UIDraggers[2].node.parent;default:console.error("\u5173\u952e\u5b57 "+t+" \u6ca1\u6709\u5bf9\u5e94\u7684 UI \u8282\u70b9")}},e.prototype.OnGuideStep=function(t){switch(t.typ){case"new_block":this.game.addBlock(t.GetV("block")),t.NextStep();break;case"show_empty_tiles":this.game.ShowEmptyTiles(t.tiles,t.NextStep);break;case"hide_empty_tiles":this._uiBoard.HideTargetTipTiles(),t.NextStep();break;case"check_col_row":break;default:console.error(t)}},e.prototype.GetStarSpriteFrame=function(t){return t?this.highlightStarSpriteFrame:this.starSpriteFrame},e.prototype.GetSpriteFrame=function(t,e){return e?this.m_HighlightSprites[t+6*this.m_Skin]:this.m_Sprites[t+6*this.m_Skin]},e.prototype.GetDisableSpriteFrame=function(){return this.disableSprites[this.m_Skin]},e.prototype.ON_EV_BUILD_DRAGGER=function(t){this.m_UIDraggers[t.index].BindMode(t)},e.prototype.ON_EV_ADD_BOARD_TILE=function(t){var e=ii.UIMgr.ins.Create(c.default.gs.comp.GSUITile.key,{tile:t,util:this});this._uiBoard.AddTileChild(e.node,e.vm)},e.prototype.ON_EV_SPAWN_BLOCK=function(t){this.m_UIDraggers[t.index].SpawnBlock(t)},e.prototype.ON_EV_BLOCK_PUTDOWN_STATUS_CHANGED=function(t){t.ui.UpdateIsCanPutdownStatus()},e.prototype.ON_EV_CLEAR_TILES=function(t){t.RemoveAll(function(t){t.ui.Close()}),t.Return()},e.prototype.ON_EV_CLEAR_BLOCK=function(t){t.ui.uiDragger.ClearBlockDirectly()},e.prototype.ON_EV_STEP_CHANGED=function(t){this.m_StepComponent.SetStep(t)},e.prototype.ON_EV_HOW_TOP_PLAY=function(t){this.m_GuideCtrl.StartGuide(c.default.pub.panel.BPHowToPlayUIPanel.key,t)},e.prototype.ON_EV_SHOW_EMPTY_TILES=function(t){this._uiBoard.ShowTargetTipTiles(t.tiles),ii.Util.safeCall(t.cb)},e.prototype.ON_EV_LOSE=function(t){ii.UIMgr.ins.Open(c.default.gs.panel.GSLoseUIPanel.key,{UseStep:t.useSteps,TotalStep:t.totalSteps,OnHome:this.OnHome.bind(this),OnReplay:this.Replay.bind(this)})},e.prototype.ON_EV_INIT_LEVEL_DATA=function(t){this._levelLabel.string="Level "+(t+1)},e.prototype.OnDragTouchStart=function(t,e){return!this.m_isTouchStart&&!!t.vm.block.isCanputDown&&(this.m_isTouchStart=!0,this.m_DragItem=t,this.TopZOrder(t),this._uiBoard.HideTipOnDragStart(),t.OnDragStart(e,this),!0)},e.prototype.OnDragTouchMove=function(t,e){var o=this;if(this.m_isTouchStart&&t==this.m_DragItem){t.OnDragMove(e,this);var i=this.m_DragItem.DragTarget(),n=this.m_TmpTile;if(this.GetOriginColAndRow(i,this._uiBoard.TileOriginRoot,n),this.m_PreCol!==n.col||this.m_PreRow!==n.row){this.m_PreCol=n.col,this.m_PreRow=n.row;var r=i.vm.tiles,a=this.game.IsCanPutdown(r,this.m_PreCol,this.m_PreRow);this._uiBoard.HideShadowTiles(),a&&this._uiBoard.ShowShadowTiles(r,function(t){return o.GetSpriteFrame(t.color,!1)},this.m_PreCol,this.m_PreRow),this.UpdateHighlightOnDrag(a,i,r)}}},e.prototype.OnDragTouchEnd=function(t){if(this.m_isTouchStart&&t==this.m_DragItem){this.m_DragItem=null,this.m_isTouchStart=!1,this.m_PreCol=null,this.m_PreRow=null,this._uiBoard.HideShadowTiles();var e=t.DragTarget(),o=this.m_TmpTile;this.GetOriginColAndRow(e,this._uiBoard.TileOriginRoot,o),this.m_GuideCtrl.IsGuiding?this.m_GuideCtrl.Step.CheckColRow(o)?this.TryPutdown(t,o):this.ReturnBlockBack(t):this.TryPutdown(t,o)}},e.prototype.TopZOrder=function(t){this.m_UIDraggers.forEach(function(e){e.SetZIndex(e===t?1:0)})},e.prototype.TryPutdown=function(t,e){var o=this,i=t.DragTarget();this.game.IsCanPutdown(i.vm.tiles,e.col,e.row)?(ii.AudioMgr.ins.PlayEffect(s.default.audio.put_down),t.PutdownBlock(this._uiBoard.TileRoot,this.game,e.col,e.row,function(t){var e=ii.AnyQueue.Borrow(),i=o.game.ClearWithCollectionAfterPutdown(t,e);i.win?(console.assert(e.Count>0),o.PlayClearTilesEffect(e,function(){return o.OnWin(i.winInfo)})):e.Count>0?o.PlayClearTilesEffect(e,o.CheckStep.bind(o)):o.CheckStep(),e.Return()})):this.ReturnBlockBack(t)},e.prototype.ReturnBlockBack=function(t){this._uiBoard.TryToResumeTipOnBack(),t.OnDragEnd(null,this)},e.prototype.UpdateHighlightOnDrag=function(t,e,o){this.game.tiles.ForEach(function(t){return t.ui.ResetDisplayColorAndHighlight()}),o.ForEach(function(t){return t.ui.SetHighlight(!1)}),t&&this.game.IsClearable(o,this.m_PreCol,this.m_PreRow)&&this.game.tiles.ForEach(function(t){return t.typ==p.GSTileType.Star&&t.ui.SetHighlight(!0)})},e.prototype.PlayClearTilesEffect=function(t,e){var o=this,i=ii.Util.onceCall(function(){return ii.AudioMgr.ins.PlayEffect(s.default.audio.clear)},1),n=ii.Util.onceCall(e,t.Count),r=0;t.RemoveAll(function(t){var e=t.ui;if(ii.UIUtil.transferTo(e.node,o._effectRoot),e.ResetDisplayColorAndHighlight(),e.vm.typ===p.GSTileType.Star){var a=e.GetStarSprite().node.convertToWorldSpaceAR(cc.Vec3.ZERO);o._uiStarDashboard.PlayCollectStarEffect(o._effectRoot,a,function(){n()},r++),e.Close()}else i(),e.RunClearAction(o.game.COL,n)})},e.prototype.CheckStep=function(){this.game.CheckStep()},e.prototype.GetOriginColAndRow=function(t,e,o){var i=t.GetOriginWorldPosition(),n=e.convertToNodeSpaceAR(i),r=Math.floor(n.x/this.TileSize),a=Math.floor(n.y/this.TileSize);o.col=r,o.row=a},r([y({type:cc.Label,visible:!0,tooltip:"\u5173\u5361ID"})],e.prototype,"_levelLabel",void 0),r([y({type:cc.Node,visible:!0,tooltip:"\u8868\u73b0\u5c42"})],e.prototype,"_effectRoot",void 0),r([y({type:cc.Node,visible:!0,tooltip:"\u661f\u661f\u9762\u677f\u5bb9\u5668\u8282\u70b9"})],e.prototype,"_starDashboardContainer",void 0),r([y({type:cc.SpriteFrame,tooltip:"\u9ad8\u4eae\u661f\u661f\u7eb9\u7406"})],e.prototype,"highlightStarSpriteFrame",void 0),r([y({type:cc.SpriteFrame,tooltip:"\u666e\u901a\u661f\u661f\u7eb9\u7406"})],e.prototype,"starSpriteFrame",void 0),r([y({type:[cc.SpriteFrame],tooltip:"\u65b9\u5757\u7cbe\u7075\u76ae\u80a4"})],e.prototype,"m_Sprites",void 0),r([y({type:[cc.SpriteFrame],tooltip:"\u65b9\u5757\u9ad8\u4eae\u7cbe\u7075\u76ae\u80a4"})],e.prototype,"m_HighlightSprites",void 0),r([y({type:[cc.SpriteFrame],tooltip:"\u7f6e\u7070\u7cbe\u7075"})],e.prototype,"disableSprites",void 0),r([y({type:cc.Node,visible:!0,tooltip:"\u68cb\u76d8\u5bb9\u5668\u8282\u70b9"})],e.prototype,"_uiBoardParent",void 0),r([y({type:cc.Node,visible:!0,tooltip:"\u53ef\u62d6\u62fd\u666e\u901a\u65b9\u5757\u4f4d\u7f6e\u951a\u70b9"})],e.prototype,"_draggerAnchor",void 0),r([y({type:cc.Node,visible:!0,tooltip:"\u53ef\u62d6\u62fd\u65b9\u5757\u6216\u9053\u5177\u7684\u5bb9\u5668"})],e.prototype,"_draggerContainer",void 0),r([d,m(f.default)],e)}(ii.UIPanel);o.default=S,cc._RF.pop()},{"../../../BPAudioCfg":"BPAudioCfg","../../../BPPrefabCfg":"BPPrefabCfg","../../../BlockPuzzleCfg":"BlockPuzzleCfg","../../Cfg/JsonData/GSJsonLevelsData":"GSJsonLevelsData","../../GSDataCache":"GSDataCache","../../GameLogic/Define/GSTileType":"GSTileType","../../GameLogic/GSGameLogic":"GSGameLogic","./GSGameUIPanelStepComponent":"GSGameUIPanelStepComponent"}],GSJsonLevelsData:[function(t,e,o){"use strict";cc._RF.push(e,"0337bIRW2VDOZhD5znTtNmT","GSJsonLevelsData"),Object.defineProperty(o,"__esModule",{value:!0}),o.GSJsonLevelsData=void 0;var i=function(){function t(){}return Object.defineProperty(t,"_levels",{get:function(){return this._json.levels},enumerable:!1,configurable:!0}),t.Cache=function(t){this._json=ii.ResMgr.ins.GetRes(t).json},Object.defineProperty(t,"MaxLevel",{get:function(){return this._levels.length-1},enumerable:!1,configurable:!0}),t.GetLevelCfg=function(t){return this._levels[t]},t.HasBlock=function(t,e){return e<t.blocks_list.length},t.GetBlock=function(t,e,o){var i=t.blocks_list[e],n=this._json.blocks[i],r=[];return n.tiles.forEach(function(e,o){r.push({col:e.col,row:e.row,color:t.blocks_color_list[o%t.blocks_color_list.length],typ:0})}),{id:o,block:{width:n.width,height:n.height,tiles:r}}},t.CalculateJudge=function(t,e){for(var o=0;o<e.three_star.length;++o)if(t<=e.three_star[o])return 3-o;return 0},t._json=null,t}();o.GSJsonLevelsData=i,cc._RF.pop()},{}],GSLevelUIPanelItem:[function(t,e,o){"use strict";cc._RF.push(e,"80c10GoKNRGrqLojVjbWBMl","GSLevelUIPanelItem");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,o,a):n(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Cfg/JsonData/GSJsonLevelsData"),s=t("../../GSDataCache"),c=cc._decorator,l=c.ccclass,p=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._label=null,e._button=null,e._starSprites=[],e.vm={unlock:!1,stars:0,level:0},e}return n(e,t),e.prototype.OnCreate=function(){},e.prototype.OnRelease=function(){},e.prototype.OnOpen=function(){this.SetIIClickHandler("OnLevel",this.OnLevel.bind(this)),this.vm.level=this.args.level,this._label.string=""+(this.vm.level+1),this.SetUnlock(!1),this.SetJudge(0)},e.prototype.OnLevel=function(){this.vm.unlock&&this.args.click(this.vm.level)},e.prototype.SetUnlock=function(t){this.vm.unlock=t,this.node.opacity=this.vm.unlock?255:80,this._button.interactable=this.vm.unlock},e.prototype.SetJudge=function(t){this.vm.stars=t;for(var e=0;e<3;++e)this._starSprites[e].node.active=e+1<=this.vm.stars},e.prototype.RefreshUI=function(t,e){if(this.node.active=this.vm.level<=e,this.SetUnlock(this.vm.level<=t+1&&this.vm.level<=e),this.vm.level<=t&&this.vm.level<=e){var o=a.GSJsonLevelsData.GetLevelCfg(this.vm.level);this.SetJudge(s.GSDataCache.ins.GetJudge(o.id))}},r([p({type:cc.Label,visible:!0})],e.prototype,"_label",void 0),r([p({type:cc.Button,visible:!0})],e.prototype,"_button",void 0),r([p({type:[cc.Sprite],visible:!0})],e.prototype,"_starSprites",void 0),r([l],e)}(ii.UIComp);o.default=u,cc._RF.pop()},{"../../Cfg/JsonData/GSJsonLevelsData":"GSJsonLevelsData","../../GSDataCache":"GSDataCache"}],GSLevelUIPanelPage:[function(t,e,o){"use strict";cc._RF.push(e,"d3046r3EsJD2aRxnqnUZq0R","GSLevelUIPanelPage");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,o,a):n(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../BPPrefabCfg"),s=t("../../GetStarsGameCfg"),c=cc._decorator,l=c.ccclass,p=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._layout=null,e.m_items=[],e.m_PageLevelCnt=0,e.m_ItemLoadingStatus=ii.task.ETaskStatus.NONE,e.m_PassLevel=0,e.m_MaxLevel=0,e.m_TargetPageIndex=0,e}return n(e,t),e.prototype.OnCreate=function(){},e.prototype.OnRelease=function(){},e.prototype.OnOpen=function(){this.m_PageLevelCnt=this.args.pageIndex*s.GetStarsGameCfg.LEVEL_LIST_COL*s.GetStarsGameCfg.LEVEL_LIST_ROW},e.prototype.LoadItem=function(t,e){var o=ii.UIMgr.ins.Create(a.default.gs.comp.GSLevelUIPanelItem.key,{level:this.m_PageLevelCnt+s.GetStarsGameCfg.GetIndex(t,e),click:this.OnItemClick.bind(this)},this._layout.node).CloseBy(this);this.m_items.push(o)},e.prototype.LoadItemAsync=function(t,e,o){var i=this;t.AddFunc(function(t){i.LoadItem(e,o),t()})},e.prototype.OnItemClick=function(t){this.args.click(t)},e.prototype.GetPageIndex=function(){return this.args.pageIndex},e.prototype.RefreshUI=function(t,e,o){this.m_PassLevel=t,this.m_MaxLevel=e,this.m_TargetPageIndex=o,this.__FilterWithChecking()},e.prototype.__FilterWithChecking=function(){var t=this;switch(this.m_ItemLoadingStatus){case ii.task.ETaskStatus.DONE:this.__RefreshUI();break;case ii.task.ETaskStatus.NONE:if(this.m_TargetPageIndex===this.args.pageIndex){for(var e=0;e<s.GetStarsGameCfg.LEVEL_LIST_ROW;++e)for(var o=0;o<s.GetStarsGameCfg.LEVEL_LIST_COL;++o)this.LoadItem(o,e);this.m_ItemLoadingStatus=ii.task.ETaskStatus.DONE,this.__RefreshUI()}else{var i=this.Task;for(e=0;e<s.GetStarsGameCfg.LEVEL_LIST_ROW;++e)for(o=0;o<s.GetStarsGameCfg.LEVEL_LIST_COL;++o)this.LoadItemAsync(i,o,e);i.Run(1,function(){t.m_ItemLoadingStatus=ii.task.ETaskStatus.DONE,t.__RefreshUI()})}}},e.prototype.__RefreshUI=function(){var t=this;this.m_items.forEach(function(e){e.RefreshUI(t.m_PassLevel,t.m_MaxLevel)})},r([p({type:cc.Layout,visible:!0})],e.prototype,"_layout",void 0),r([l],e)}(ii.UIComp);o.default=u,cc._RF.pop()},{"../../../BPPrefabCfg":"BPPrefabCfg","../../GetStarsGameCfg":"GetStarsGameCfg"}],GSLevelUIPanel:[function(t,e,o){"use strict";cc._RF.push(e,"ae3c7yVdF9FMIaC6FgKIb1d","GSLevelUIPanel");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,o,a):n(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../BlockPuzzleCfg"),s=t("../../../BPPrefabCfg"),c=t("../../Cfg/JsonData/GSJsonLevelsData"),l=t("../../GetStarsGameCfg"),p=t("../../GSDataCache"),u=cc._decorator,h=u.ccclass,f=u.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._UIJudgeDashboardContainer=null,e._pageView=null,e._uiJudgeDashboard=null,e.m_Pages=[],e._m_CurrentPageIndex=-1,e.vm={passLevel:-1,maxLevel:0},e}return n(e,t),Object.defineProperty(e.prototype,"m_CurrentPageIndex",{get:function(){return this._m_CurrentPageIndex},set:function(t){this.m_CurrentPageIndex!=t&&(this._m_CurrentPageIndex=t,this.RefreshUI_PageIndex(t))},enumerable:!1,configurable:!0}),e.prototype.OnCreate=function(){this._uiJudgeDashboard=ii.UIMgr.ins.Create(s.default.pub.comp._UIJudgeDashboard.key,{labelAlign:cc.Label.HorizontalAlign.RIGHT},this._UIJudgeDashboardContainer).CloseBy(this)},e.prototype.OnRelease=function(){},e.prototype.OnOpen=function(){this.SetIIClickHandler("OnHome",this.OnHome.bind(this));for(var t=Math.floor(c.GSJsonLevelsData.MaxLevel/(l.GetStarsGameCfg.LEVEL_LIST_COL*l.GetStarsGameCfg.LEVEL_LIST_ROW))+1,e=0;e<t;++e){var o=ii.UIMgr.ins.Create(s.default.gs.comp.GSLevelUIPanelPage.key,{pageIndex:e,click:this.OnLevelClick.bind(this)}).CloseBy(this);this._pageView.addPage(o.node),this.m_Pages.push(o)}this.SetToTargetPage(),this.RefreshUI(this.m_CurrentPageIndex)},e.prototype.RefreshUI=function(t){var e=this;this.vm.passLevel=p.GSDataCache.ins.PassLevel,this.vm.maxLevel=c.GSJsonLevelsData.MaxLevel,this.m_Pages.forEach(function(o){o.RefreshUI(e.vm.passLevel,e.vm.maxLevel,t)})},e.prototype.SetToTargetPage=function(){var t=this.vm.passLevel,e=t+1;e>c.GSJsonLevelsData.MaxLevel?this.SetToPage(t):this.SetToPage(e)},e.prototype.SetToPage=function(t){this.m_CurrentPageIndex=Math.floor(t/(l.GetStarsGameCfg.LEVEL_LIST_COL*l.GetStarsGameCfg.LEVEL_LIST_ROW)),this._pageView.setCurrentPageIndex(this.m_CurrentPageIndex)},e.prototype.OnHome=function(){ii.UIMgr.ins.LoadBundleStage(a.BlockPuzzleCfg.BundleName,null,this.Close.bind(this))},e.prototype.OnLevelClick=function(t){var e=this;ii.UIMgr.ins.Open(s.default.gs.panel.GSGameUIPanel.key,{level:t},function(){return e.Close()})},e.prototype.OnPageViewEvent=function(t){this.m_CurrentPageIndex=t.getCurrentPageIndex()},e.prototype.GetJudges=function(t){for(var e=0,o=c.GSJsonLevelsData.MaxLevel,i=l.GetStarsGameCfg.LEVEL_LIST_COL*l.GetStarsGameCfg.LEVEL_LIST_ROW,n=t*i+i,r=t*i;r<=o&&r<n;++r){var a=c.GSJsonLevelsData.GetLevelCfg(r);e+=p.GSDataCache.ins.GetJudge(a.id)}return e},e.prototype.RefreshUI_PageIndex=function(t){var e=this.GetJudges(t),o=c.GSJsonLevelsData.MaxLevel,i=l.GetStarsGameCfg.LEVEL_LIST_COL*l.GetStarsGameCfg.LEVEL_LIST_ROW,n=(t+1)*i<=o?3*i:3*(o+1-t*i);this._uiJudgeDashboard.SetJudgeInfo(e,n,!0)},r([f({type:cc.Node,visible:!0})],e.prototype,"_UIJudgeDashboardContainer",void 0),r([f({type:cc.PageView,visible:!0})],e.prototype,"_pageView",void 0),r([h],e)}(ii.UIPanel);o.default=_,cc._RF.pop()},{"../../../BPPrefabCfg":"BPPrefabCfg","../../../BlockPuzzleCfg":"BlockPuzzleCfg","../../Cfg/JsonData/GSJsonLevelsData":"GSJsonLevelsData","../../GSDataCache":"GSDataCache","../../GetStarsGameCfg":"GetStarsGameCfg"}],GSLoseUIPanel:[function(t,e,o){"use strict";cc._RF.push(e,"99805x2A6VAnaJ3M4Y+sxBa","GSLoseUIPanel");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,o,a):n(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../BPAudioCfg"),s=t("../../../_Public/UIPanel/BPActionUIPanel"),c=cc._decorator,l=c.ccclass,p=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._stepCntLabel=null,e._circleSprite=null,e}return n(e,t),e.prototype.OnOpen=function(e){t.prototype.OnOpen.call(this,e),ii.App.ins.p.ad.ShowBanner(!0),this.SetIIClickHandler("OnHome",this.OnHome.bind(this)),this.SetIIClickHandler("OnReplay",this.OnReplay.bind(this)),this._stepCntLabel.string=""+this.args.TotalStep},e.prototype.OnEnter=function(){var t=this;ii.AudioMgr.ins.PlayEffect(a.default.audio.lose);var e=.5+.05*this.args.UseStep;this._circleSprite.fillRange=1;var o=this.args.UseStep>this.args.TotalStep?0:(this.args.TotalStep-this.args.UseStep)/this.args.TotalStep;cc.tween(this._circleSprite).to(e,{fillRange:o},ii.TweenUtil.LinearProgress).start(),ii.TweenUtil.CeilIntegerTo(e,this.args.TotalStep,this.args.UseStep>this.args.TotalStep?0:this.args.TotalStep-this.args.UseStep,function(e){t._stepCntLabel.string=""+e},!1)},e.prototype.OnRelease=function(){ii.App.ins.p.ad.ShowBanner(!1),t.prototype.OnRelease.call(this)},e.prototype.OnHome=function(){this.ExitWithAction(this.args.OnHome)},e.prototype.OnReplay=function(){this.ExitWithAction(this.args.OnReplay)},r([p({type:cc.Label,visible:!0,tooltip:"\u64cd\u4f5c\u6b65\u6570"})],e.prototype,"_stepCntLabel",void 0),r([p({type:cc.Sprite,visible:!0,tooltip:"\u8fdb\u5ea6\u5708"})],e.prototype,"_circleSprite",void 0),r([l],e)}(s.default);o.default=u,cc._RF.pop()},{"../../../BPAudioCfg":"BPAudioCfg","../../../_Public/UIPanel/BPActionUIPanel":"BPActionUIPanel"}],GSTileType:[function(t,e,o){"use strict";cc._RF.push(e,"815c5+w1ZVJxrFH30IA2SCu","GSTileType"),Object.defineProperty(o,"__esModule",{value:!0}),o.GSTileType=void 0,function(t){t[t.Default=0]="Default",t[t.Star=1]="Star"}(o.GSTileType||(o.GSTileType={})),cc._RF.pop()},{}],GSTile:[function(t,e,o){"use strict";cc._RF.push(e,"6cdb0DGNrVIWZ5WHv8mKkTG","GSTile"),Object.defineProperty(o,"__esModule",{value:!0});var i=t("../Define/GSTileType"),n=function(){function t(){this.col=0,this.row=0,this.color=0,this.typ=i.GSTileType.Default,this.ui=null}return t.Borrow=function(){return ii.ReferencePool.Borrow(t)},t.prototype.Return=function(){ii.ReferencePool.Return(t,this)},t.prototype.Reset=function(){this.col=0,this.row=0,this.color=0,this.typ=i.GSTileType.Default},t.prototype.Init=function(t,e,o,i){return this.col=t,this.row=e,this.color=o,this.typ=i,this},t.prototype.Clone=function(){var e=t.Borrow();return e.col=this.col,e.row=this.row,e.color=this.color,e.typ=this.typ,e},t}();o.default=n,cc._RF.pop()},{"../Define/GSTileType":"GSTileType"}],GSUIBlock:[function(t,e,o){"use strict";cc._RF.push(e,"9ed1eJaWwlImr1WwEFXCs7A","GSUIBlock");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,o,a):n(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../BPPrefabCfg"),s=cc._decorator,c=s.ccclass,l=s.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.container=null,e.vm=null,e.uiDragger=null,e.m_OffsetCol=null,e.m_OffsetRow=null,e.m_UITileQueue=null,e.m_TileSize=0,e.m_StartTween=null,e}return n(e,t),Object.defineProperty(e.prototype,"m_DockScale",{get:function(){return.7},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"m_InitScale",{get:function(){return.2},enumerable:!1,configurable:!0}),e.prototype.OnCreate=function(){},e.prototype.OnRelease=function(){console.assert(0==this.m_UITileQueue.Count,"\u672a\u5904\u7406\u56de\u6536\u903b\u8f91"),this.ClearDirectly(),this.m_UITileQueue.Return()},e.prototype.OnOpen=function(t){this.m_TileSize=t.util.TileSize,this.m_UITileQueue=ii.AnyQueue.Borrow(),this.node.position=cc.Vec3.ZERO,this.BindModel(t.block)},e.prototype.PreCalculate=function(){this.m_OffsetCol=.5*-(this.vm.width-1),this.m_OffsetRow=.5*-(this.vm.height-1)},e.prototype.BindModel=function(t){var e=this;this.vm=t,t.ui=this,this.container.scale=this.m_InitScale,this.PreCalculate(),this.vm.tiles.ForEach(function(t){return e.CreateUITile(t)}),cc.tween(this.container).to(.12,{scale:this.m_DockScale}).start(),this.UpdateIsCanPutdownStatus()},e.prototype.CreateUITile=function(t){var e=ii.UIMgr.ins.Create(a.default.gs.comp.GSUITile.key,{tile:t,util:this.args.util});this.container.addChild(e.node),e.node.x=this.GetColRowDragPosX(t.col,0),e.node.y=this.GetColRowDragPosY(t.row,0),this.m_UITileQueue.Enqueue(e)},e.prototype.UpdateIsCanPutdownStatus=function(){var t=this;this.m_UITileQueue.ForEach(function(e){return e.UpdateIsCanPutdownStatus(t.vm.isCanputDown)})},e.prototype.PutdownBlock=function(t,e,o,i,n){var r=this.vm,a=ii.AnyQueue.Borrow(),s=ii.Util.onceCall(function(){n(a),a.Return()},r.tiles.Count);e.PutdownBlock(r,o,i,a),this.m_UITileQueue.RemoveAll(function(e){return ii.UIUtil.transferTo(e.node,t)}),a.ForEach(function(t){var o=e.GetColRowPosition(t.col,t.row);cc.tween(t.ui.node).to(.1,{position:o,scale:1}).call(s).start()})},e.prototype.ClearDirectly=function(){this.vm&&this.vm.tiles.RemoveAll(),this.m_UITileQueue.RemoveAll(function(t){return t.Close()})},e.prototype.GetColRowDragPosX=function(t,e){return(this.m_OffsetCol+t)*(this.m_TileSize+e)},e.prototype.GetColRowDragPosY=function(t,e){return(this.m_OffsetRow+t)*(this.m_TileSize+e)},e.prototype.GetOriginWorldPosition=function(){var t=cc.v2(this.GetColRowDragPosX(0,0),this.GetColRowDragPosY(0,0));return this.node.convertToWorldSpaceAR(t)},e.prototype.OnDragStart=function(){this.m_StartTween=cc.tween(this.container).to(.4,{scale:1},{easing:cc.easing.elasticOut}).start()},e.prototype.OnDragEnd=function(){this.m_StartTween.stop(),cc.tween(this.container).to(.15,{scale:this.m_DockScale}).start()},r([l(cc.Node)],e.prototype,"container",void 0),r([c],e)}(ii.UIComp);o.default=p,cc._RF.pop()},{"../../../BPPrefabCfg":"BPPrefabCfg"}],GSUIDragger:[function(t,e,o){"use strict";cc._RF.push(e,"839c6/C0LlLEaLQYO+22XmA","GSUIDragger");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,o,a):n(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../BPAudioCfg"),s=t("../../../BPPrefabCfg"),c=cc._decorator,l=c.ccclass,p=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.vm=null,e._touchDelegate=null,e.C_DRAG_TO_Y=180,e.C_DRAG_END_ACTION_TIME=.2,e}return n(e,t),e.prototype.HasBlock=function(){return null!=this.vm.block},e.prototype.DragTarget=function(){return this.vm.block.ui},e.prototype.OnCreate=function(){},e.prototype.OnRelease=function(){this.vm&&(null!=this.vm.block&&this.ClearBlockDirectly(),this.vm=null),this.UnbindTouch()},e.prototype.OnOpen=function(){this.BindTouch()},e.prototype.ResetPosition=function(){this.node.position=cc.Vec3.ZERO},e.prototype.BindMode=function(t){this.vm=t,t.ui=this,null!=this.vm.block&&console.error("\u672a\u5904\u7406\u521b\u5efa Block \u7684\u903b\u8f91")},e.prototype.SpawnBlock=function(t){console.assert(t==this.vm.block);var e=ii.UIMgr.ins.Create(s.default.gs.comp.GSUIBlock.key,{block:this.vm.block,util:this.args.util});this.node.addChild(e.node),this.node.active=!0,e.uiDragger=this},e.prototype.PutdownBlock=function(t,e,o,i,n){var r=this.vm.block.ui;r.PutdownBlock(t,e,o,i,n),r.Close(),this.ResetPosition(),this.node.active=!1,null!=this.vm&&this.vm.RemoveBlock().Return()},e.prototype.ClearBlockDirectly=function(){var t=this.vm.block.ui;t.ClearDirectly(),t.Close(),this.ResetPosition(),this.node.active=!1,null!=this.vm&&this.vm.RemoveBlock().Return()},e.prototype.SetTouchDelegate=function(t){this._touchDelegate=t},e.prototype.BindTouch=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},e.prototype.UnbindTouch=function(){this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.off(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},e.prototype.onTouchStart=function(t){return this._touchDelegate.OnDragTouchStart(this,t)},e.prototype.onTouchMove=function(t){this._touchDelegate.OnDragTouchMove(this,t)},e.prototype.onTouchEnd=function(t){this._touchDelegate.OnDragTouchEnd(this,t)},e.prototype.SetZIndex=function(t){this.node.zIndex=t},e.prototype.OnDragStart=function(t){ii.AudioMgr.ins.PlayEffect(a.default.audio.pick_up);var e=this.node.parent.convertToNodeSpaceAR(t.getLocation());this.node.x=e.x,this.node.y=e.y+this.C_DRAG_TO_Y,this.vm.block.ui.OnDragStart(),ii.EventCenter.ins.emit(ii.guide.Event.DRAG_START)},e.prototype.OnDragMove=function(t){this.node.x+=t.getDelta().x,this.node.y+=t.getDelta().y},e.prototype.OnDragEnd=function(){this.vm.block.ui.OnDragEnd(),cc.tween(this.node).to(this.C_DRAG_END_ACTION_TIME,{position:cc.Vec3.ZERO}).start(),ii.EventCenter.ins.emit(ii.guide.Event.DRAG_END)},r([l],e)}(ii.UIComp));o.default=p,cc._RF.pop()},{"../../../BPAudioCfg":"BPAudioCfg","../../../BPPrefabCfg":"BPPrefabCfg"}],GSUITile:[function(t,e,o){"use strict";cc._RF.push(e,"0aaf1daQq9DPKDS7ynLvtWc","GSUITile");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,o,a):n(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../GameLogic/Define/GSTileType"),s=cc._decorator,c=s.ccclass,l=s.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._scaleNode=null,e.m_ColorSprite=null,e.m_AvatarSpriteRoot=null,e.m_AvatarSprite=null,e.fsm=null,e.SM_STATUS={none:"none",flying:"flying",done:"done"},e.SM_EVENT={Fly:"Fly",Finish:"Finish",Reset:"Reset"},e.vm=null,e.m_DisplayColor=0,e.m_Highlight=!1,e.m_Radian=0,e.m_Power=0,e.m_ActionCallback=null,e.m_Velocity=null,e.m_RotationSpeed=0,e.m_Gravity=0,e.m_FlyingScheduler=null,e}return n(e,t),e.prototype.GetStarSprite=function(){return this.m_AvatarSprite},e.prototype.OnCreate=function(){console.assert(null==this.fsm),this.fsm=ii.StateMachine.create({final:this.SM_STATUS.done,events:[{name:this.SM_EVENT.Fly,from:this.SM_STATUS.none,to:this.SM_STATUS.flying},{name:this.SM_EVENT.Finish,from:this.SM_STATUS.flying,to:this.SM_STATUS.done},{name:this.SM_EVENT.Reset,from:ii.StateMachine.WILDCARD,to:this.SM_STATUS.none}],callbacks:{onenterstate:this.onEnterState.bind(this)}})},e.prototype.OnRelease=function(){this.fsm.Reset(),this.vm.Return(),this.fsm=null},e.prototype.OnOpen=function(t){switch(this.vm=this.args.tile,this.vm.ui=this,this.m_DisplayColor=this.vm.color,this.m_Highlight=!1,this._scaleNode.scale=t.util.UI_SCALE,this.__updateColorSpriteFrame(),this.__updateAvatarVisiableAndRotation(),this.vm.typ){case a.GSTileType.Default:this.m_ColorSprite.node.active=!0;break;case a.GSTileType.Star:this.m_ColorSprite.node.active=!1,this.m_AvatarSprite.spriteFrame=this.args.util.GetStarSpriteFrame(this.m_Highlight);break;default:console.error("Type of "+this.vm.typ+" not handled!")}},e.prototype.__updateColorSpriteFrame=function(){this.m_ColorSprite.spriteFrame=this.args.util.GetSpriteFrame(this.m_DisplayColor,this.m_Highlight)},e.prototype.__updateStarSpriteFrame=function(){this.vm.typ==a.GSTileType.Star&&(this.m_AvatarSprite.spriteFrame=this.args.util.GetStarSpriteFrame(this.m_Highlight))},e.prototype.UpdateStarVisiable=function(){this.__updateAvatarVisiableAndRotation()},e.prototype.__updateAvatarVisiableAndRotation=function(){switch(this.vm.typ){case a.GSTileType.Default:this.m_AvatarSpriteRoot.active=!1;break;case a.GSTileType.Star:this.m_AvatarSpriteRoot.active=!0;break;default:console.error("Type of "+this.vm.typ+" not handled!")}},e.prototype.UpdateIsCanPutdownStatus=function(t){t?this.ResetDisplayColorAndHighlight():this.m_ColorSprite.spriteFrame=this.args.util.GetDisableSpriteFrame()},e.prototype.SetHighlight=function(t){this.m_Highlight=t,this.__updateColorSpriteFrame(),this.__updateStarSpriteFrame()},e.prototype.SetDisplayColorWithHighlight=function(t){this.m_Highlight=!0,this.m_DisplayColor=t,this.__updateColorSpriteFrame(),this.__updateStarSpriteFrame()},e.prototype.ResetDisplayColorAndHighlight=function(){this.m_Highlight=!1,this.m_DisplayColor=this.vm.color,this.__updateColorSpriteFrame(),this.__updateStarSpriteFrame()},e.prototype.RunClearAction=function(t,e){var o=this;this.m_AvatarSpriteRoot.active=!1;var i=function(){e&&e(),o.Close()};switch(1){case ii.Dir.Left:case ii.Dir.Right:var n=0*(1==ii.Dir.Left?-1:1),r=.5*Math.PI+Math.PI/3*(n/(t-1))+10*Math.random(),a=0;a=3e3*(1-.1*Math.abs(n)),this.RunRemoveFromBoardAction(r,a,i);break;case ii.Dir.Top:case ii.Dir.Bottom:var s=0*(1==ii.Dir.Bottom?-1:1);r=.5*Math.PI+(Math.random()-.5)*Math.PI/3,a=0,a=3e3*(1-.1*Math.abs(s)),this.RunRemoveFromBoardAction(r,a,i)}},e.prototype.RunRemoveFromBoardAction=function(t,e,o){this.m_Radian=t,this.m_Power=e,this.m_ActionCallback=o,this.fsm.Fly()},e.prototype.onEnterState=function(t,e,o){var i=this;switch(o){case this.SM_STATUS.none:this.node.angle=0;break;case this.SM_STATUS.flying:this.m_Velocity=cc.v2(0,0),this.m_Velocity.x=30*Math.sin(this.m_Radian),this.m_Velocity.y=this.m_Power*(.8+.2*Math.cos(this.m_Radian)),this.m_RotationSpeed=600*(.3+.7*Math.random()),this.m_Gravity=-5e3,this.m_FlyingScheduler=function(t){return i.__updatePerFrameForFlying(t)},this.schedule(this.m_FlyingScheduler,0,cc.macro.REPEAT_FOREVER);break;case this.SM_STATUS.done:this.m_ActionCallback&&this.m_ActionCallback();break;default:console.error("state: "+o+" no handled")}},e.prototype.__updatePerFrameForFlying=function(t){this.node.angle+=this.m_RotationSpeed*t,this.m_Velocity.y+=this.m_Gravity*t,this.node.x+=this.m_Velocity.x*t,this.node.y+=this.m_Velocity.y*t,this.node.convertToWorldSpaceAR(cc.Vec2.ZERO).y<-cc.winSize.height/3&&(this.unschedule(this.m_FlyingScheduler),this.m_FlyingScheduler=null,this.fsm.Finish())},r([l({type:cc.Node,visible:!0,tooltip:"\u7f29\u653e\u8282\u70b9"})],e.prototype,"_scaleNode",void 0),r([l(cc.Sprite)],e.prototype,"m_ColorSprite",void 0),r([l({type:cc.Node,tooltip:"\u5c55\u793a\u7cbe\u7075\u7684\u7236\u8282\u70b9"})],e.prototype,"m_AvatarSpriteRoot",void 0),r([l({type:cc.Sprite,tooltip:"\u5c55\u793a\u7684\u7cbe\u7075"})],e.prototype,"m_AvatarSprite",void 0),r([c],e)}(ii.UIComp);o.default=p,cc._RF.pop()},{"../../GameLogic/Define/GSTileType":"GSTileType"}],GSWinUIPanel:[function(t,e,o){"use strict";cc._RF.push(e,"d5a1fkA1tpMM4oCZZDXN1Ic","GSWinUIPanel");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,o,a):n(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../../../../StartScene/Script/GameApp"),s=t("../../../../../../StartScene/Script/HttpMgr"),c=t("../../../BPAudioCfg"),l=t("../../../BPPrefabCfg"),p=t("../../../_Public/UIPanel/BPActionUIPanel"),u=t("../../GSDataCache"),h=cc._decorator,f=h.ccclass,_=h.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._judgeStars=[],e._stepCntLabel=null,e._circleSprite=null,e._nextLevelNode=null,e._starDashboardContainer=null,e._adBtnRoot=null,e._ctn_StarContainer=null,e._moreStarLabel=null,e.tipsLbl=null,e._uiStarDashboard=null,e._x3MoreStars=null,e}return n(e,t),e.prototype.OnCreate=function(){t.prototype.OnCreate.call(this),this._uiStarDashboard=ii.UIMgr.ins.Create(l.default.pub.comp._UIStarDashboard.key,null,this._starDashboardContainer).CloseBy(this),this._x3MoreStars=ii.UIMgr.ins.Create(l.default.pub.comp._UITargetStar.key,null,this._ctn_StarContainer).CloseBy(this)},e.prototype.OnOpen=function(e){t.prototype.OnOpen.call(this,e),ii.App.ins.p.ad.ShowBanner(!0),this.SetIIClickHandler("OnHome",this.OnHome.bind(this)),this.SetIIClickHandler("OnReplay",this.OnReplay.bind(this)),this.SetIIClickHandler("OnNext",this.OnNext.bind(this)),this.SetIIClickHandler("OnAD",this.OnAD.bind(this)),this._uiStarDashboard.StarCnt=0,this._stepCntLabel.string=""+this.args.TotalStep,this._nextLevelNode.active=!this.args.MaxLevel,this._moreStarLabel.string=""+3*(this.args.CurStar-this.args.PreStar),this.SetADButtonActive(ii.App.ins.p.ad.IsRewardedVideoAvailable()),this.tipsLbl.node.active=!1,ii.AudioMgr.ins.PlayEffect(c.default.audio.win)},e.prototype.OnEnter=function(){var t=this,e=this.args.CurStar-this.args.PreStar,o=.05*e;this._uiStarDashboard.TweenStarCnt(o,e),this._circleSprite.fillRange=1;var i=this.args.UseStep>this.args.TotalStep?0:(this.args.TotalStep-this.args.UseStep)/this.args.TotalStep;cc.tween(this._circleSprite).to(o,{fillRange:i},ii.TweenUtil.LinearProgress).start(),ii.TweenUtil.CeilIntegerTo(o,this.args.TotalStep,this.args.UseStep>this.args.TotalStep?0:this.args.TotalStep-this.args.UseStep,function(e){t._stepCntLabel.string=""+e},!1),ii.UIMgr.ins.blockSeconds(o,null);for(var n=ii.Util.onceCall(function(){return ii.AudioMgr.ins.PlayEffect(c.default.audio.pass_best_score)},3),r=function(e){var i=e;a.scheduleOnce(function(){n(),t._judgeStars[i].active=!0,t._judgeStars[i].scale=2,cc.tween(t._judgeStars[i]).to(.1,{scale:1}).call(function(){ii.AudioMgr.ins.PlayEffect(c.default.audio.star_pop)}).start()},.5+o+.15*e)},a=this,s=0;s<this.args.Judge;++s)r(s)},e.prototype.OnRelease=function(){ii.App.ins.p.ad.ShowBanner(!1),t.prototype.OnRelease.call(this)},e.prototype.SetADButtonActive=function(t){var e=this;this._adBtnRoot.active=t,this.schedule(function(){e._x3MoreStars.RunStarEffect()},3,cc.macro.REPEAT_FOREVER,1)},e.prototype.OnHome=function(){this.ExitWithAction(this.args.OnHome)},e.prototype.OnReplay=function(){this.ExitWithAction(this.args.OnReplay)},e.prototype.OnNext=function(){this.ExitWithAction(this.args.OnNext)},e.prototype.OnAD=function(){if(a.default.Release){var t="/api/smallGameCast",e=localStorage.getItem("userToken");console.log("\u8bf7\u6c42url122="+t);var o=new FormData;o.append("token",e),o.append("game_id","6");var i=this;s.httpPost(t,function(t,e){if(0===Number(t))if(1===Number(e.code)){console.log("\u4fc4\u7f57\u65af\u6d88\u9664\u5173\u5361\u661f\u6570\u7ffb\u500d="+e.message);var o=3*(i.args.CurStar-i.args.PreStar);u.GSDataCache.ins.StarCnt+=o;var n=.05*o;i._uiStarDashboard.TweenStarCnt(n,i._uiStarDashboard.StarCnt+o),i.SetADButtonActive(!1)}else i.ShowTips(e.message)},o)}else{var n=3*(this.args.CurStar-this.args.PreStar);u.GSDataCache.ins.StarCnt+=n;var r=.05*n;this._uiStarDashboard.TweenStarCnt(r,this._uiStarDashboard.StarCnt+n),this.SetADButtonActive(!1)}},e.prototype.ShowTips=function(t){var e=this;this.tipsLbl.node.active=!0,this.tipsLbl.string=t,setTimeout(function(){e.tipsLbl.node.active=!1},3e3)},r([_({type:[cc.Node],visible:!0,tooltip:"\u8bc4\u4ef7\u661f\u661f\u5217\u8868"})],e.prototype,"_judgeStars",void 0),r([_({type:cc.Label,visible:!0,tooltip:"\u64cd\u4f5c\u6b65\u6570"})],e.prototype,"_stepCntLabel",void 0),r([_({type:cc.Sprite,visible:!0,tooltip:"\u8fdb\u5ea6\u5708"})],e.prototype,"_circleSprite",void 0),r([_({type:cc.Node,visible:!0,tooltip:"\u4e0b\u4e00\u5173"})],e.prototype,"_nextLevelNode",void 0),r([_({type:cc.Node,visible:!0,tooltip:"\u661f\u661f\u9762\u677f\u5bb9\u5668\u8282\u70b9"})],e.prototype,"_starDashboardContainer",void 0),r([_({type:cc.Node,visible:!0,tooltip:"\u770b\u5e7f\u544a\u6309\u94ae\u6839\u8282\u70b9"})],e.prototype,"_adBtnRoot",void 0),r([_({type:cc.Node,visible:!0,tooltip:"\u989d\u59163\u500d\u661f\u661f\u5bb9\u5668\u8282\u70b9"})],e.prototype,"_ctn_StarContainer",void 0),r([_({type:cc.Label,visible:!0,tooltip:"\u989d\u59163\u500d\u661f\u661f\u6570\u5b57\u663e\u793a\u533a\u57df"})],e.prototype,"_moreStarLabel",void 0),r([_({type:cc.Label,visible:!0,tooltip:"tips"})],e.prototype,"tipsLbl",void 0),r([f],e)}(p.default);o.default=d,cc._RF.pop()},{"../../../../../../StartScene/Script/GameApp":void 0,"../../../../../../StartScene/Script/HttpMgr":void 0,"../../../BPAudioCfg":"BPAudioCfg","../../../BPPrefabCfg":"BPPrefabCfg","../../../_Public/UIPanel/BPActionUIPanel":"BPActionUIPanel","../../GSDataCache":"GSDataCache"}],GetStarsGameCfg:[function(t,e,o){"use strict";cc._RF.push(e,"de2aaLBITRGLLjWnPqyCb9j","GetStarsGameCfg"),Object.defineProperty(o,"__esModule",{value:!0}),o.GetStarsGameCfg=void 0;var i=function(){function t(){}return t.GetIndex=function(t,e){return t+this.LEVEL_LIST_COL*e},t.LEVEL_LIST_COL=4,t.LEVEL_LIST_ROW=5,t}();o.GetStarsGameCfg=i,cc._RF.pop()},{}],GetStarsGameScene:[function(t,e,o){"use strict";cc._RF.push(e,"56e36GLy3xJYIjL/rzAgdd7","GetStarsGameScene");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,o,a):n(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__spreadArrays||function(){for(var t=0,e=0,o=arguments.length;e<o;e++)t+=arguments[e].length;var i=Array(t),n=0;for(e=0;e<o;e++)for(var r=arguments[e],a=0,s=r.length;a<s;a++,n++)i[n]=r[a];return i};Object.defineProperty(o,"__esModule",{value:!0});var s=t("../BlockPuzzleCfg"),c=t("../BPAudioCfg"),l=t("../BPJsonCfg"),p=t("../BPPrefabCfg"),u=t("./Cfg/JsonData/GSJsonLevelsData"),h=cc._decorator,f=h.ccclass,_=(h.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.GetDefaultEffectAudioKey=function(){return c.default.audio.default_effect},e.prototype.OnInit=function(t){console.info("GetStars::OnInit"),s.BlockPuzzleCfg.Register(),this.AutoReleaseRes(a(ii.prefabCfg2ResKeyList(p.default.gs.panel))),this.LoadResList(a([l.default.GSLevelData,c.default.audio.star_pop],ii.prefabCfg2ResKeyList(p.default.pub.comp),ii.prefabCfg2ResKeyList(p.default.gs.comp)),function(){u.GSJsonLevelsData.Cache(l.default.GSLevelData),ii.UIMgr.ins.Open(p.default.gs.panel.GSLevelUIPanel.key,null,t)})},r([f],e)}(ii.UIStage));o.default=_,cc._RF.pop()},{"../BPAudioCfg":"BPAudioCfg","../BPJsonCfg":"BPJsonCfg","../BPPrefabCfg":"BPPrefabCfg","../BlockPuzzleCfg":"BlockPuzzleCfg","./Cfg/JsonData/GSJsonLevelsData":"GSJsonLevelsData"}],_BPGameListUIPanel:[function(t,e,o){"use strict";cc._RF.push(e,"5cb54wjq3lIxpebRo5QTHQT","_BPGameListUIPanel");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,o,a):n(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../../../StartScene/Script/GameApp"),s=t("../../../../../StartScene/Script/HttpMgr"),c=t("../../BlockPuzzleCfg"),l=t("../../BlockPuzzleGame/BPLS"),p=t("../../BPPrefabCfg"),u=t("../../GetStarsGame/Cfg/JsonData/GSJsonLevelsData"),h=t("../../GetStarsGame/GSDataCache"),f=cc._decorator,_=f.ccclass,d=f.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._versionLabel=null,e._bp_StarDashboardContainer=null,e._bp_BestScoreLabel=null,e._gs_UIJudgeDashboardContainer=null,e._gs_StarDashboardContainer=null,e._moreGameRoot=null,e._bp_uiStarDashboard=null,e._gs_uiJudgeDashboard=null,e._gs_uiStarDashboard=null,e}return n(e,t),e.prototype.OnCreate=function(){this._bp_uiStarDashboard=ii.UIMgr.ins.Create(p.default.pub.comp._UIStarDashboard.key,null,this._bp_StarDashboardContainer).CloseBy(this),this._gs_uiJudgeDashboard=ii.UIMgr.ins.Create(p.default.pub.comp._UIJudgeDashboard.key,{labelAlign:cc.Label.HorizontalAlign.LEFT},this._gs_UIJudgeDashboardContainer).CloseBy(this),this._gs_uiStarDashboard=ii.UIMgr.ins.Create(p.default.pub.comp._UIStarDashboard.key,null,this._gs_StarDashboardContainer).CloseBy(this)},e.prototype.OnRelease=function(){},e.prototype.OnOpen=function(){if(ii.App.ins.p.ad.ShowBanner(!0),this.SetIIClickHandler("OnEnterBP",this.OnEnterBP.bind(this)),this.SetIIClickHandler("OnEnterGS",this.OnEnterGS.bind(this)),this.SetIIClickHandler("OnMoreGame_Solitaire",this.OnMoreGame_Solitaire.bind(this)),this._versionLabel.string=""+ii.App.ins.Version,a.default.Release){var t="/api/getInfoRocketThreeMatch",e=localStorage.getItem("userToken");console.log("\u8bf7\u6c42url221="+t);var o=new FormData;o.append("token",e);var i=this;s.httpPost(t,function(t,e){0===Number(t)&&1===Number(e.code)&&(console.log("\u83b7\u53d6\u4fc4\u7f57\u65af\u6d88\u9664\u4fe1\u606f2="+e.message),l.BPLS.ins.SummaryStar=e.data.gameStar,l.BPLS.ins.BestScore=e.data.gameScore,l.BPLS.ins.RocketCntBV.v=e.data.rocket_cnt,l.BPLS.ins.BombCntBV.v=e.data.bomb_cnt,l.BPLS.ins.SetFiveStarWinCount(e.data.fiveStar_count),h.GSDataCache.ins.StarCnt=e.data.LvStar_cnt,l.BPLS.ins.RocketPieceCntBV.v=e.data.rocket_piece_cnt,l.BPLS.ins.BombPieceCntBV.v=e.data.bomb_piece_cnt,null!==e.data.content&&""!==e.data.content&&(h.GSDataCache.ins._levelsData=JSON.parse(e.data.content)),i.updateShow())},o)}else this.updateShow()},e.prototype.updateShow=function(){this._bp_BestScoreLabel.string=""+l.BPLS.ins.BestScore,this._bp_uiStarDashboard.StarCnt=l.BPLS.ins.SummaryStar;var t=this.__gs_GetJudgeInfo();this._gs_uiJudgeDashboard.SetJudgeInfo(t.curJudge,t.totalJudge,!0),this._gs_uiStarDashboard.StarCnt=h.GSDataCache.ins.StarCnt},e.prototype.OnEnterBP=function(){var t=this;ii.App.ins.p.ad.ShowBanner(!1),ii.UIMgr.ins.LoadStage(c.BlockPuzzleCfg.BundleName,"BlockPuzzleGameScene",null,function(){return t.Close()})},e.prototype.OnEnterGS=function(){var t=this;ii.App.ins.p.ad.ShowBanner(!1),ii.UIMgr.ins.LoadStage(c.BlockPuzzleCfg.BundleName,"GetStarsGameScene",null,function(){return t.Close()})},e.prototype.__gs_GetJudgeInfo=function(){var t,e=0,o=u.GSJsonLevelsData.MaxLevel;t=3*(o+1);for(var i=0;i<=o;++i){var n=u.GSJsonLevelsData.GetLevelCfg(i);e+=h.GSDataCache.ins.GetJudge(n.id)}return{curJudge:e,totalJudge:t}},e.prototype.OnMoreGame_Solitaire=function(){cc.sys.openURL("itms-apps://itunes.apple.com/app/id1505718943")},r([d({type:cc.Label,visible:!0,tooltip:"\u7248\u672c\u53f7"})],e.prototype,"_versionLabel",void 0),r([d({type:cc.Node,visible:!0,tooltip:"\u661f\u661f\u9762\u677f\u5bb9\u5668\u8282\u70b9"})],e.prototype,"_bp_StarDashboardContainer",void 0),r([d({type:cc.Label,visible:!0,tooltip:"\u5206\u6570"})],e.prototype,"_bp_BestScoreLabel",void 0),r([d({type:cc.Node,visible:!0,tooltip:"\u8bc4\u5206\u9762\u677f\u5bb9\u5668\u8282\u70b9"})],e.prototype,"_gs_UIJudgeDashboardContainer",void 0),r([d({type:cc.Node,visible:!0,tooltip:"\u661f\u661f\u9762\u677f\u5bb9\u5668\u8282\u70b9"})],e.prototype,"_gs_StarDashboardContainer",void 0),r([d({type:cc.Node,visible:!0,tooltip:"\u66f4\u591a\u6e38\u620f\u6839\u8282\u70b9"})],e.prototype,"_moreGameRoot",void 0),r([_],e)}(ii.UIPanel);o.default=y,cc._RF.pop()},{"../../../../../StartScene/Script/GameApp":void 0,"../../../../../StartScene/Script/HttpMgr":void 0,"../../BPPrefabCfg":"BPPrefabCfg","../../BlockPuzzleCfg":"BlockPuzzleCfg","../../BlockPuzzleGame/BPLS":"BPLS","../../GetStarsGame/Cfg/JsonData/GSJsonLevelsData":"GSJsonLevelsData","../../GetStarsGame/GSDataCache":"GSDataCache"}],_BlockConfig:[function(t,e,o){"use strict";cc._RF.push(e,"e14dfQyDc1GEonNu/WUd79y","_BlockConfig"),Object.defineProperty(o,"__esModule",{value:!0}),o._BlockConfig=void 0,o._BlockConfig=[{kinds:[{width:1,height:1,tiles:[{col:0,row:0}]}]},{kinds:[{width:2,height:1,tiles:[{col:0,row:0},{col:1,row:0}]},{width:1,height:2,tiles:[{col:0,row:0},{col:0,row:1}]}]},{kinds:[{width:2,height:2,tiles:[{col:0,row:0},{col:1,row:1}]},{width:2,height:2,tiles:[{col:1,row:0},{col:0,row:1}]}]},{kinds:[{width:1,height:3,tiles:[{col:0,row:0},{col:0,row:1},{col:0,row:2}]},{width:3,height:1,tiles:[{col:0,row:0},{col:1,row:0},{col:2,row:0}]}]},{kinds:[{width:2,height:2,tiles:[{col:0,row:0},{col:1,row:0},{col:0,row:1}]},{width:2,height:2,tiles:[{col:0,row:0},{col:1,row:0},{col:1,row:1}]},{width:2,height:2,tiles:[{col:0,row:0},{col:0,row:1},{col:1,row:1}]},{width:2,height:2,tiles:[{col:1,row:0},{col:0,row:1},{col:1,row:1}]}]},{kinds:[{width:2,height:2,tiles:[{col:0,row:0},{col:1,row:0},{col:0,row:1},{col:1,row:1}]}]},{kinds:[{width:3,height:2,tiles:[{col:0,row:0},{col:1,row:0},{col:2,row:0},{col:1,row:1}]},{width:3,height:2,tiles:[{col:1,row:0},{col:0,row:1},{col:1,row:1},{col:2,row:1}]},{width:2,height:3,tiles:[{col:0,row:0},{col:0,row:1},{col:1,row:1},{col:0,row:2}]},{width:2,height:3,tiles:[{col:1,row:0},{col:0,row:1},{col:1,row:1},{col:1,row:2}]}]},{kinds:[{width:2,height:3,tiles:[{col:0,row:0},{col:1,row:0},{col:0,row:1},{col:0,row:2}]},{width:3,height:2,tiles:[{col:0,row:0},{col:1,row:0},{col:2,row:0},{col:2,row:1}]},{width:2,height:3,tiles:[{col:1,row:0},{col:1,row:1},{col:0,row:2},{col:1,row:2}]},{width:3,height:2,tiles:[{col:0,row:0},{col:0,row:1},{col:1,row:1},{col:2,row:1}]}]},{kinds:[{width:2,height:3,tiles:[{col:0,row:0},{col:1,row:0},{col:1,row:1},{col:1,row:2}]},{width:3,height:2,tiles:[{col:2,row:0},{col:0,row:1},{col:1,row:1},{col:2,row:1}]},{width:2,height:3,tiles:[{col:0,row:0},{col:0,row:1},{col:0,row:2},{col:1,row:2}]},{width:3,height:2,tiles:[{col:0,row:0},{col:1,row:0},{col:2,row:0},{col:0,row:1}]}]},{kinds:[{width:1,height:4,tiles:[{col:0,row:0},{col:0,row:1},{col:0,row:2},{col:0,row:3}]},{width:4,height:1,tiles:[{col:0,row:0},{col:1,row:0},{col:2,row:0},{col:3,row:0}]}]},{kinds:[{width:2,height:3,tiles:[{col:1,row:0},{col:0,row:1},{col:1,row:1},{col:0,row:2}]},{width:3,height:2,tiles:[{col:0,row:0},{col:1,row:0},{col:1,row:1},{col:2,row:1}]}]},{kinds:[{width:2,height:3,tiles:[{col:0,row:0},{col:0,row:1},{col:1,row:1},{col:1,row:2}]},{width:3,height:2,tiles:[{col:1,row:0},{col:2,row:0},{col:0,row:1},{col:1,row:1}]}]},{kinds:[{width:3,height:3,tiles:[{col:0,row:0},{col:1,row:0},{col:2,row:0},{col:0,row:1},{col:0,row:2}]},{width:3,height:3,tiles:[{col:0,row:0},{col:1,row:0},{col:2,row:0},{col:2,row:1},{col:2,row:2}]},{width:3,height:3,tiles:[{col:2,row:0},{col:2,row:1},{col:0,row:2},{col:1,row:2},{col:2,row:2}]},{width:3,height:3,tiles:[{col:0,row:0},{col:0,row:1},{col:0,row:2},{col:1,row:2},{col:2,row:2}]}]},{kinds:[{width:2,height:3,tiles:[{col:0,row:0},{col:1,row:0},{col:0,row:1},{col:0,row:2},{col:1,row:2}]},{width:3,height:2,tiles:[{col:0,row:0},{col:1,row:0},{col:2,row:0},{col:0,row:1},{col:2,row:1}]},{width:2,height:3,tiles:[{col:0,row:0},{col:1,row:0},{col:1,row:1},{col:0,row:2},{col:1,row:2}]},{width:3,height:2,tiles:[{col:0,row:0},{col:2,row:0},{col:0,row:1},{col:1,row:1},{col:2,row:1}]}]}],cc._RF.pop()},{}],_UIBoard:[function(t,e,o){"use strict";cc._RF.push(e,"b8afbz1cMRMqIafFx4M2PHj","_UIBoard");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,o,a):n(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../BPPrefabCfg"),s=cc._decorator,c=s.ccclass,l=s.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._transferRoot=null,e._scalerNode=null,e._tileOriginRoot=null,e._bgTileTemplate=null,e._bgTileRoot=null,e._tipRoot=null,e._shadowRoot=null,e._tileRoot=null,e._targetTipRoot=null,e.m_UIScaler=1,e.m_ShadowTileQueue=null,e.m_TipTileQueue=null,e.m_IsShowingTip=!1,e.m_TargetTipTileQueue=null,e}return n(e,t),Object.defineProperty(e.prototype,"TransferRoot",{get:function(){return this._transferRoot},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"TileOriginRoot",{get:function(){return this._tileOriginRoot},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"TileRoot",{get:function(){return this._tileRoot},enumerable:!1,configurable:!0}),e.prototype.OnCreate=function(){},e.prototype.OnRelease=function(){this.CloseTargetTipTileModule(),this.CloseShadowModule(),this.CloseTipModule()},e.prototype.OnOpen=function(){this.m_UIScaler=this.args.tileSize/62,this._tileOriginRoot.position=new cc.Vec3(-.5*this.args.tileSize*this.args.col,-.5*this.args.tileSize*this.args.row,0);for(var t=this.args.row-1;t>=0;--t)for(var e=this.args.col-1;e>=0;--e){var o=cc.instantiate(this._bgTileTemplate);o.scale=this.m_UIScaler,this.SetColRowPosition(o,e-.5*this.args.col,t-.5*this.args.row),this._bgTileRoot.addChild(o)}this._bgTileTemplate.active=!1,this.OpenShadowModule(function(){return ii.UIMgr.ins.Create(a.default.pub.comp.BPUIShadowTile.key)},9),this.OpenTipModule(function(){return ii.UIMgr.ins.Create(a.default.pub.comp.BPUITipTile.key)},9),this.OpenTargetTipTileModule(function(){return ii.UIMgr.ins.Create(a.default.pub.comp.BPUITargetTipTile.key)},9)},e.prototype.SetColRowPosition=function(t,e,o){t.x=(.5+e)*this.args.tileSize,t.y=(.5+o)*this.args.tileSize},e.prototype.GetColRowPosition=function(t,e){return new cc.Vec3((.5+t)*this.args.tileSize,(.5+e)*this.args.tileSize,0)},e.prototype.AddTileChild=function(t,e){this._tileRoot.addChild(t),t.position=this.GetColRowPosition(e.col,e.row)},e.prototype.OpenShadowModule=function(t,e){if(void 0===e&&(e=9),this.m_ShadowTileQueue=ii.AnyQueue.Borrow(),this.m_ShadowTileQueue.Count<e)for(var o=e-this.m_ShadowTileQueue.Count;o>0;--o){var i=t();i.node.scale=this.m_UIScaler,this._shadowRoot.addChild(i.node),i.node.active=!1,this.m_ShadowTileQueue.Enqueue(i)}},e.prototype.CloseShadowModule=function(){null!==this.m_ShadowTileQueue&&(this.m_ShadowTileQueue.RemoveAll(function(t){return t.Close()}),this.m_ShadowTileQueue.Return())},e.prototype.HideShadowTiles=function(){null!==this.m_ShadowTileQueue&&this.m_ShadowTileQueue.ForEach(function(t){return t.node.active=!1})},e.prototype.ShowShadowTile=function(t,e,o,i){if(null!==this.m_ShadowTileQueue){var n=this.m_ShadowTileQueue.Dequeue();this.m_ShadowTileQueue.Enqueue(n),n.node.active=!0,this.SetColRowPosition(n.node,o,i);var r=t(e);n.ShowShadow(r)}},e.prototype.ShowShadowTiles=function(t,e,o,i){var n=this;t.ForEach(function(t){n.ShowShadowTile(e,t,o+t.col,i+t.row)})},e.prototype.OpenTipModule=function(t,e){if(void 0===e&&(e=9),this.m_TipTileQueue=ii.AnyQueue.Borrow(),this.m_TipTileQueue.Count<e)for(var o=e-this.m_TipTileQueue.Count;o>0;--o){var i=t();this._tipRoot.addChild(i.node),i.node.scale=this.m_UIScaler,i.node.active=!1,this.m_TipTileQueue.Enqueue(i)}this.m_IsShowingTip=!1,this._tipRoot.active=!1},e.prototype.CloseTipModule=function(){null!==this.m_TipTileQueue&&(this.m_TipTileQueue.RemoveAll(function(t){return t.Close()}),this.m_IsShowingTip=!1,this._tipRoot.active=!1)},e.prototype.ShowTipTile=function(t,e,o,i){if(null!==this.m_TipTileQueue){var n=this.m_TipTileQueue.Dequeue();this.m_TipTileQueue.Enqueue(n),n.node.active=!0,this.SetColRowPosition(n.node,o,i),n.RunTipAction(t(e))}},e.prototype.ShowTipTiles=function(t,e,o,i){var n=this;this.m_TipTileQueue.ForEach(function(t){t.node.active=!1,t.StopTipAction()}),t.ForEach(function(t){n.ShowTipTile(e,t,o+t.col,i+t.row)})},e.prototype.HideTipTiles=function(t){this.m_IsShowingTip=t,this._tipRoot.active=t},e.prototype.HideTipOnDragStart=function(){this._tipRoot.active=!1},e.prototype.TryToResumeTipOnBack=function(){this.m_IsShowingTip&&(this._tipRoot.active=!0)},e.prototype.OpenTargetTipTileModule=function(t,e){if(void 0===e&&(e=9),this.m_TargetTipTileQueue=ii.AnyQueue.Borrow(),this.m_TargetTipTileQueue.Count<e)for(var o=e-this.m_TargetTipTileQueue.Count;o>0;--o){var i=t();i.node.scale=this.m_UIScaler,this._targetTipRoot.addChild(i.node),i.node.active=!1,this.m_TargetTipTileQueue.Enqueue(i)}},e.prototype.CloseTargetTipTileModule=function(){this.m_TargetTipTileQueue.RemoveAll(function(t){return t.Close()})},e.prototype.ShowTargetTipTile=function(t,e){var o=this.m_TargetTipTileQueue.Dequeue();this.m_TargetTipTileQueue.Enqueue(o),o.node.active=!0,this.SetColRowPosition(o.node,t,e)},e.prototype.ShowTargetTipTiles=function(t){var e=this;this.HideTargetTipTiles(),t.forEach(function(t){e.ShowTargetTipTile(t.col,t.row)})},e.prototype.HideTargetTipTiles=function(){this.m_TargetTipTileQueue.ForEach(function(t){return t.node.active=!1})},r([l({type:cc.Node,visible:!0,tooltip:"\u5931\u8d25\u65f6\uff0c\u4e34\u65f6\u63d0\u5347\u7684\u68cb\u76d8\u8282\u70b9"})],e.prototype,"_transferRoot",void 0),r([l({type:cc.Node,visible:!0,tooltip:"\u68cb\u76d8\u7edf\u4e00\u7f29\u653e\u8282\u70b9"})],e.prototype,"_scalerNode",void 0),r([l({type:cc.Node,visible:!0,tooltip:"\u68cb\u76d8\u539f\u70b9\u8282\u70b9\uff0c\u9700\u8981\u8bbe\u7f6e\u5230\u5de6\u4e0b\u89d2"})],e.prototype,"_tileOriginRoot",void 0),r([l({type:cc.Node,visible:!0,tooltip:"\u74e6\u7247\u80cc\u666f\u590d\u5236\u8282\u70b9"})],e.prototype,"_bgTileTemplate",void 0),r([l({type:cc.Node,visible:!0,tooltip:"\u74e6\u7247\u80cc\u666f\u6839\u8282\u70b9"})],e.prototype,"_bgTileRoot",void 0),r([l({type:cc.Node,visible:!0,tooltip:"\u552f\u4e00\u4f4d\u7f6e\u53ef\u653e\u7f6e\u63d0\u9192\u6839\u8282\u70b9"})],e.prototype,"_tipRoot",void 0),r([l({type:cc.Node,visible:!0,tooltip:"\u5f71\u5b50\u6839\u8282\u70b9"})],e.prototype,"_shadowRoot",void 0),r([l({type:cc.Node,visible:!0,tooltip:"\u74e6\u7247\u6839\u8282\u70b9"})],e.prototype,"_tileRoot",void 0),r([l({type:cc.Node,visible:!0,tooltip:"Empty Tile \u6839\u8282\u70b9"})],e.prototype,"_targetTipRoot",void 0),r([c],e)}(ii.UIComp);o.default=p,cc._RF.pop()},{"../../BPPrefabCfg":"BPPrefabCfg"}],_UIJudgeDashboard:[function(t,e,o){"use strict";cc._RF.push(e,"4ed02EQqv9FxbglMwpo6ssL","_UIJudgeDashboard");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,o,a):n(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._judgeInfoLabel=null,e._judgeProgressSprite=null,e}return n(e,t),e.prototype.OnCreate=function(){},e.prototype.OnRelease=function(){},e.prototype.OnOpen=function(){this._judgeInfoLabel.horizontalAlign=this.args.labelAlign,this._judgeInfoLabel.node.anchorX=this.HorizontalAlign2AnchorX(this.args.labelAlign);var t=this._judgeInfoLabel.node.position;t.x=this.HorizontalAlign2X(this.args.labelAlign)*(.5*this._judgeProgressSprite.node.width+(this.args.padding||16)),this._judgeInfoLabel.node.position=t},e.prototype.HorizontalAlign2X=function(t){switch(t){case cc.Label.HorizontalAlign.LEFT:return 1;case cc.Label.HorizontalAlign.CENTER:return 0;case cc.Label.HorizontalAlign.RIGHT:return-1;default:return 0}},e.prototype.HorizontalAlign2AnchorX=function(t){switch(t){case cc.Label.HorizontalAlign.LEFT:return 0;case cc.Label.HorizontalAlign.CENTER:return.5;case cc.Label.HorizontalAlign.RIGHT:return 1;default:return 0}},e.prototype.SetJudgeInfo=function(t,e,o){var i=this;o?ii.TweenUtil.IntegerTo(.3,0,t,function(t){i.__SetJudgeInfo(t,e)},!0):this.__SetJudgeInfo(t,e)},e.prototype.__SetJudgeInfo=function(t,e){this._judgeInfoLabel.string=t+"/"+e,this._judgeProgressSprite.fillRange=t/e},r([c({type:cc.Label,visible:!0})],e.prototype,"_judgeInfoLabel",void 0),r([c({type:cc.Sprite,visible:!0})],e.prototype,"_judgeProgressSprite",void 0),r([s],e)}(ii.UIComp);o.default=l,cc._RF.pop()},{}],_UIStarDashboard:[function(t,e,o){"use strict";cc._RF.push(e,"9059eEpkkVH7ZVya1dvkVxx","_UIStarDashboard");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,o,a):n(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../BPAudioCfg"),s=t("../../BPPrefabCfg"),c=cc._decorator,l=c.ccclass,p=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._starContainer=null,e._starCntLabel=null,e._uiTargetStar=null,e.m_UIStarCnt=0,e}return n(e,t),Object.defineProperty(e.prototype,"StarCnt",{get:function(){return this.m_UIStarCnt},set:function(t){this.m_UIStarCnt=t,this._starCntLabel.string=""+t,this._uiTargetStar.RunStarEffect()},enumerable:!1,configurable:!0}),e.prototype.OnCreate=function(){this._uiTargetStar=ii.UIMgr.ins.Create(s.default.pub.comp._UITargetStar.key,null,this._starContainer).CloseBy(this)},e.prototype.OnRelease=function(){},e.prototype.OnOpen=function(){},e.prototype.TweenStarCnt=function(t,e){var o=this;ii.TweenUtil.IntegerTo(t,this.m_UIStarCnt,e,function(t){o.StarCnt=t},!1)},e.prototype.PlayCollectStarEffect=function(t,e,o,i){var n=this,r=ii.UIMgr.ins.Create(s.default.pub.comp.BPUIActionStar.key);t.addChild(r.node),r.node.zIndex=9,r.node.position=t.convertToNodeSpaceAR(e);var c=this._uiTargetStar.StarNode.convertToWorldSpaceAR(cc.Vec2.ZERO),l=t.convertToNodeSpaceAR(c),p=30+20*Math.random(),u=.5+.1*i+.1*Math.random(),h=cc.v2(l.x,r.node.y+(l.y-r.node.y)/3),f=cc.v2(l.x+(l.x>r.node.x?100:-100),r.node.y+2*(l.y-r.node.y)/3);ii.AudioMgr.ins.PlayEffect(a.default.audio.star_pop),cc.tween(r.node).by(u,{scale:1.1,y:-p},{easing:cc.easing.elasticOut}).bezierTo(.5,h,f,l).call(function(){ii.Util.safeCall(o),ii.AudioMgr.ins.PlayEffect(a.default.audio.star_reach),++n.StarCnt,r.Close()}).start()},r([p({type:cc.Node,visible:!0,tooltip:"\u661f\u661f\u5bb9\u5668"})],e.prototype,"_starContainer",void 0),r([p({type:cc.Label,visible:!0,tooltip:"\u661f\u661f\u6570\u91cf"})],e.prototype,"_starCntLabel",void 0),r([l],e)}(ii.UIComp);o.default=u,cc._RF.pop()},{"../../BPAudioCfg":"BPAudioCfg","../../BPPrefabCfg":"BPPrefabCfg"}],_UITargetStar:[function(t,e,o){"use strict";cc._RF.push(e,"958b7lYNHlHfZZfzapEVdR9","_UITargetStar");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,o,a):n(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,l=function(){function t(){this.circle=null,this.star=null}return r([c({type:cc.ParticleSystem,tooltip:"\u661f\u661f\u5230\u8fbe Circle \u7c92\u5b50"})],t.prototype,"circle",void 0),r([c({type:cc.ParticleSystem,tooltip:"\u661f\u661f\u5230\u8fbe Star \u7c92\u5b50"})],t.prototype,"star",void 0),r([s("_UITargetStarParticleIndex")],t)}(),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._starSprite=null,e._particles=[],e.m_Index=0,e}return n(e,t),Object.defineProperty(e.prototype,"StarSprite",{get:function(){return this._starSprite},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"StarNode",{get:function(){return this._starSprite.node},enumerable:!1,configurable:!0}),e.prototype.OnCreate=function(){},e.prototype.OnRelease=function(){},e.prototype.OnOpen=function(){},e.prototype.RunStarEffect=function(){this.m_Index=++this.m_Index%this._particles.length,this.__RunStarEffect(this.m_Index)},e.prototype.__RunStarEffect=function(t){cc.tween(this._starSprite.node).to(.1,{scale:1.3},{easing:cc.easing.backIn}).to(.1,{scale:1},{easing:cc.easing.backOut}).start(),ii.Util.playParticleSystem(this._particles[t].circle),ii.Util.playParticleSystem(this._particles[t].star)},r([c({type:cc.Sprite,visible:!0,tooltip:"\u661f\u661f\u7cbe\u7075"})],e.prototype,"_starSprite",void 0),r([c({type:l,visible:!0})],e.prototype,"_particles",void 0),r([s],e)}(ii.UIComp);o.default=p,cc._RF.pop()},{}]},{},["BPAudioCfg","BPJsonCfg","BPPrefabCfg","BlockPuzzle","BlockPuzzleCfg","BPGameLayout","BPGoalGame","BPLS","BPUtil","BlockPuzzleGameScene","BPDataBlock","BPDataBomb","BPDataDragger","BPDataExplosion","BPDataRocket","BPDataRocketHalf","BPDataTile","BPHowToPlayFinishedUIPanel","BPClearInfo","BPDismissInfo","BPExplosionInfo","BPTipInfo","BPBlockLocationType","BPDismissType","BPExplosionType","BPTileType","BPToolType","BPContinueUIPanel","BPFiveStarUIPanel","BPGameUIPanel","BPGoalUIPanel","BPWinUIPanel","BPUEToolItem","BPUIBlock","BPUIBomb","BPUIDragger","BPUIParticleBoomSmoke","BPUIParticleRocketBoomCircle","BPUIParticleRocketTail","BPUIParticleRocketTail_1","BPUIRocket","BPUIRocketHalf","BPUIScoreWordEffect","BPUITile","GSJsonLevelsData","GSDataCache","GSTileType","GSGameLogic","GSBlock","GSDragger","GSTile","GetStarsGameCfg","GetStarsGameScene","GSGameUIPanel","GSGameUIPanelStepComponent","GSUIBlock","GSUIDragger","GSUITile","GSLevelUIPanel","GSLevelUIPanelItem","GSLevelUIPanelPage","GSLoseUIPanel","GSWinUIPanel","_BlockConfig","BPGuideModel","BPHowToPlayUIPanel","BPUIHowToPlayDialog","BPUIHowToPlayFinger","BPUIActionStar","BPUIShadowTile","BPUITargetTipTile","BPUITipTile","_UIBoard","_UIJudgeDashboard","_UIStarDashboard","_UITargetStar","BPActionUIPanel","BPLoadingADUIPanel","BPSettingUIPanel","_BPGameListUIPanel"]);