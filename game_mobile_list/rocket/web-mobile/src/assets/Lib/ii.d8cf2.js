window.numas={},window.ii=window.numas,window.__extends=this&&this.__extends||function(){let e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),function(e){let t=(n.Borrow=function(){return e.ReferencePool.Borrow(n)},n.prototype.Return=function(){e.ReferencePool.Return(n,this)},n.prototype.SetCallback=function(e){this.m_Callback=e},n.prototype.OnBindingValueChanged=function(e,t){return this.m_Callback(e,t)},n.prototype.Reset=function(){this.m_Callback=null},n);function n(){this.m_Callback=null}let i=(o.prototype.Reset=function(){null!=this.handler&&this.handler.Return(),this.handler=null,this.target=null},o.Borrow=function(){return e.ReferencePool.Borrow(o)},o.prototype.Return=function(){e.ReferencePool.Return(o,this)},o);function o(){this.handler=null,this.target=null}var r=(s.prototype.Reset=function(){this.UnbindAll(),this.m_CacheValue=null},s.prototype.ReturnBy=function(e){return e.AutoReturn(this)},Object.defineProperty(s.prototype,"v",{get:function(){return this.m_CacheValue},set:function(e){var t=this.m_CacheValue;this.IsEqual(e,t)||(this.m_CacheValue=e,this.NotifyObservers(e,t))},enumerable:!1,configurable:!0}),s.prototype.SetValueWithoutNotification=function(e){this.m_CacheValue=e},s.prototype.NotifyObservers=function(e,t){this.m_ObserversList.ForEach(function(n){return n.handler.OnBindingValueChanged(e,t)})},s.prototype.Bind=function(e,n,o){let r=t.Borrow();r.SetCallback(e);let s=i.Borrow();return s.handler=r,s.target=o,this.m_ObserversList.Enqueue(s),n&&r.OnBindingValueChanged(this.v,this.v),this},s.prototype.TargetUnbind=function(e){this.m_ObserversList.Remove(function(t){return t.target===e},function(e){return e.Return()})},s.prototype.UnbindAll=function(){this.m_ObserversList.RemoveAll(function(e){return e.Return()})},s);function s(t){this.m_CacheValue=null,this.m_ObserversList=null,this.m_ObserversList=e.AnyQueue.Borrow(),this.m_CacheValue=t}e.BV=r}(numas=numas||{}),function(e){var t,n,i,o,r,s=(t=e.BV,__extends(u,t),u.prototype.IsEqual=function(e,t){return e===t},u.Borrow=function(t){let n=e.ReferencePool.Borrow(u);return n.m_CacheValue=t,n},u.prototype.Return=function(){e.ReferencePool.Return(u,this)},u.BorrowAsLS=function(t,n,i){let o=e.ReferencePool.Borrow(u);return o.m_CacheValue=e.LSMgr.ins.getBoolWithDefault(t,n),o.Bind(function(n){return e.LSMgr.ins.setBool(t,n,i)},!1,o),o},u.BorrowAsUserLS=function(t,n,i){let o=e.ReferencePool.Borrow(u);return o.m_CacheValue=e.UserLSMgr.ins.getBoolWithDefault(t,n),o.Bind(function(n){return e.UserLSMgr.ins.setBool(t,n,i)},!1,o),o},u);function u(){return t.call(this,!1)||this}function a(){return n.call(this,0)||this}function l(){return i.call(this,0)||this}function c(){return o.call(this,"")||this}function p(){return r.call(this,null)||this}e.BooleanBV=s,n=e.BV,__extends(a,n),a.prototype.IsEqual=function(e,t){return e===t},a.Borrow=function(t){let n=e.ReferencePool.Borrow(a);return n.m_CacheValue=t,n},a.prototype.Return=function(){e.ReferencePool.Return(a,this)},a.BorrowAsLS=function(t,n,i){let o=e.ReferencePool.Borrow(a);return o.m_CacheValue=e.LSMgr.ins.getIntWithDefault(t,n),o.Bind(function(n){return e.LSMgr.ins.setInt(t,n,i)},!1,o),o},a.BorrowAsUserLS=function(t,n,i){let o=e.ReferencePool.Borrow(a);return o.m_CacheValue=e.UserLSMgr.ins.getIntWithDefault(t,n),o.Bind(function(n){return e.UserLSMgr.ins.setInt(t,n,i)},!1,o),o},s=a,e.NumberBV=s,i=e.BV,__extends(l,i),l.prototype.IsEqual=function(e,t){return e<=t},l.Borrow=function(t){let n=e.ReferencePool.Borrow(l);return n.m_CacheValue=t,n},l.prototype.Return=function(){e.ReferencePool.Return(l,this)},l.BorrowAsLS=function(t,n,i){let o=e.ReferencePool.Borrow(l);return o.m_CacheValue=e.LSMgr.ins.getIntWithDefault(t,n),o.Bind(function(n){return e.LSMgr.ins.setInt(t,n,i)},!1,o),o},l.BorrowAsUserLS=function(t,n,i){let o=e.ReferencePool.Borrow(l);return o.m_CacheValue=e.UserLSMgr.ins.getIntWithDefault(t,n),o.Bind(function(n){return e.UserLSMgr.ins.setInt(t,n,i)},!1,o),o},s=l,e.MaxNumberBV=s,o=e.BV,__extends(c,o),c.prototype.IsEqual=function(e,t){return e==t},c.Borrow=function(t){let n=e.ReferencePool.Borrow(c);return n.m_CacheValue=t,n},c.prototype.Return=function(){e.ReferencePool.Return(c,this)},c.BorrowAsLS=function(t,n,i){let o=e.ReferencePool.Borrow(c);return o.m_CacheValue=e.LSMgr.ins.getStringWithDefault(t,n),o.Bind(function(n){return e.LSMgr.ins.setString(t,n,i)},!1,o),o},c.BorrowAsUserLS=function(t,n,i){let o=e.ReferencePool.Borrow(c);return o.m_CacheValue=e.UserLSMgr.ins.getStringWithDefault(t,n),o.Bind(function(n){return e.UserLSMgr.ins.setString(t,n,i)},!1,o),o},s=c,e.StringBV=s,r=e.BV,__extends(p,r),p.prototype.IsEqual=function(){return!1},p.Borrow=function(t){let n=e.ReferencePool.Borrow(p);return n.m_CacheValue=t,n},p.prototype.Return=function(){e.ReferencePool.Return(p,this)},p.BorrowAsLS=function(t,n,i){let o=e.ReferencePool.Borrow(p);return o.m_CacheValue=e.LSMgr.ins.getObjectWithDefault(t,n),o.Bind(function(n){return e.LSMgr.ins.setObject(t,n,i)},!1,o),o},p.BorrowAsUserLS=function(t,n,i){let o=e.ReferencePool.Borrow(p);return o.m_CacheValue=e.UserLSMgr.ins.getObjectWithDefault(t,n),o.Bind(function(n){return e.UserLSMgr.ins.setObject(t,n,i)},!1,o),o},s=p,e.ObjectBV=s}(numas=numas||{}),function(e){let t=(n.prototype.Reset=function(){null!==this.target&&(this.target.decRef(),this.target=null)},n.Borrow=function(){return e.ReferencePool.Borrow(n)},n.prototype.Return=function(){e.ReferencePool.Return(n,this)},n.prototype.ReplaceWith=function(e){return e.addRef(),this.Reset(),this.target=e,this},n);function n(){this.target=null}var i,o=(i=cc.Component,__extends(r,i),r.prototype.onDestroy=function(){this.StopAllScheduler(),this.offGlobal(),this.RemoveAllAssetProperty(),this.Destroy_AutoRelease(),this.RemoveAllUserData()},Object.defineProperty(r.prototype,"_i_userdata",{get:function(){return null===this.__im_UserData&&(this.__im_UserData=new Map),this.__im_UserData},enumerable:!1,configurable:!0}),r.prototype.SetUserData=function(e,t){this._i_userdata.set(e,t)},r.prototype.GetUserData=function(e){return this._i_userdata.get(e)},r.prototype.HasUserData=function(e){return this._i_userdata.has(e)},r.prototype.RemoveUserData=function(e){this._i_userdata.delete(e)},r.prototype.RemoveAllUserData=function(){null!==this.__im_UserData&&this._i_userdata.clear()},r.prototype.onGlobal=function(t,n){return e.EventCenter.ins.on(t,n,this)},r.prototype.emitGlobal=function(t,n,i,o,r,s){e.EventCenter.ins.emit(t,n,i,o,r,s)},r.prototype.offGlobal=function(){e.EventCenter.ins.targetOff(this)},r.prototype.AutoReturn=function(t){return this._I_AutoReleaseItemQueue.Enqueue(e.AutoReleaseItem.Borrow(t,e.EItemType.IReference)),t},r.prototype.GetDataCache=function(t){return e.ResMgr.ins.GetDataCache(t)},r.prototype.AddAutoReleaseDataCache=function(t,n){e.ResMgr.ins.AddDataCache(t,n),this._I_AutoReleaseItemQueue.Enqueue(e.AutoReleaseItem.Borrow(t,e.EItemType.DataCache))},r.prototype.AutoReleaseRes=function(e){var t=this;"string"==typeof e?this.__AutoReleaseRes(e):e.forEach(function(e){return t.__AutoReleaseRes(e)})},r.prototype.__AutoReleaseRes=function(t){e.ResMgr.ins.AddResRef(t),this._I_AutoReleaseItemQueue.Enqueue(e.AutoReleaseItem.Borrow(t,e.EItemType.ResKey))},r.prototype.Destroy_AutoRelease=function(){null!=this._i_AutoQueue&&(e.ResMgr.ins.DestroyAutoReleaseItems(this._i_AutoQueue),this._i_AutoQueue.Return(),this._i_AutoQueue=null)},Object.defineProperty(r.prototype,"_I_AutoReleaseItemQueue",{get:function(){return null===this._i_AutoQueue&&(this._i_AutoQueue=e.AnyQueue.Borrow()),this._i_AutoQueue},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"_i_RefData",{get:function(){return null===this.__im_RefData&&(this.__im_RefData=new Map),this.__im_RefData},enumerable:!1,configurable:!0}),r.prototype.SetAssetProperty=function(e,n){return this._i_RefData.has(e)?this._i_RefData.get(e).ReplaceWith(n):this._i_RefData.set(e,t.Borrow().ReplaceWith(n)),n},r.prototype.RemoveAllAssetProperty=function(){null!==this.__im_RefData&&(this.__im_RefData.forEach(function(e){return e.Return()}),this.__im_RefData.clear(),this.__im_RefData=null)},Object.defineProperty(r.prototype,"_I_SchedulerMap",{get:function(){return null===this.__im_SchedulerMap&&(this.__im_SchedulerMap=new Map),this.__im_SchedulerMap},enumerable:!1,configurable:!0}),r.prototype.HasScheduler=function(e){return null!==this.__im_SchedulerMap&&this.__im_SchedulerMap.has(e)},r.prototype.RegisterScheduler=function(e,t){this.HasScheduler(e)&&console.error(this.name+".RegisterScheduler >> \u5df2\u6ce8\u518c\u6709\u8c03\u5ea6\u51fd\u6570 >> \u5173\u952e\u5b57"+e),this._I_SchedulerMap.set(e,t)},r.prototype.StartScheduler=function(e,t,n,i,o){void 0===i&&(i=cc.macro.REPEAT_FOREVER),void 0===o&&(o=0),this.HasScheduler(e)||(this.RegisterScheduler(e,t),this.schedule(t,n,i,o))},r.prototype.StopScheduler=function(e){var t;this.HasScheduler(e)&&(t=this.__im_SchedulerMap.get(e),this.__im_SchedulerMap.delete(e),this.unschedule(t))},r.prototype.StopAllScheduler=function(){var e=this;if(null!==this.__im_SchedulerMap){let t=this.__im_SchedulerMap;this.__im_SchedulerMap=null,t.forEach(function(t){return e.unschedule(t)}),t.clear()}},r);function r(){let e=null!==i&&i.apply(this,arguments)||this;return e.__im_UserData=null,e._i_AutoQueue=null,e.__im_RefData=null,e.__im_SchedulerMap=null,e}e.BaseComp=o}(numas=numas||{}),function(e){let t=(Object.defineProperty(n,"ins",{get:function(){return null===this._ins&&(this._ins=new n),this._ins},enumerable:!1,configurable:!0}),n._ins=null,n);function n(){this.loaderCnt=e.NumberBV.Borrow(0),this.totalTaskCnt=e.NumberBV.Borrow(0),this.finishTaskCnt=e.NumberBV.Borrow(0)}e.ResListLoaderInfo=t;var i,o=(i=e.BaseComp,__extends(r,i),Object.defineProperty(r,"LOAD_EVENT",{get:function(){return++this._s_LOAD_EVENT_ID,"_i_ResKeeper_"+this._s_LOAD_EVENT_ID},enumerable:!1,configurable:!0}),r.prototype.PositionTo=function(e,t,n){return this.node.setPosition(e,t,n),this},r.prototype.onDestroy=function(){this.RemoveAllIIClickHandler(),this.Destroy_LoadResKey(),i.prototype.onDestroy.call(this)},Object.defineProperty(r.prototype,"Task",{get:function(){return e.UIUtil.getOrAddComponent(this.node,e.task.TaskComponent)},enumerable:!1,configurable:!0}),r.prototype.UUID_GROUP_KEY=function(e){return""+this.uuid+e},r.prototype.LoadRes=function(t,n,i,o){var s=this;void 0===o&&(o=null),this._i_b_LoadFunctionCalled=!0;var u=r.LOAD_EVENT;e.ResMgr.ins.node.on(u,function(e,t){i&&s.AutoReleaseRes(t),n(e,t)},this),null!=o?e.ResMgr.ins.LoadWithEventByGroup(u,t,o):e.ResMgr.ins.LoadWithEvent(u,t)},r.prototype.Destroy_LoadResKey=function(){this._i_b_LoadFunctionCalled&&(this._i_b_LoadFunctionCalled=!1,e.ResMgr.ins.node.targetOff(this))},r.prototype.LoadResList=function(n,i,o,r,s){var u=this;if(void 0===o&&(o=!1),void 0===r&&(r=!1),void 0===s&&(s=5),0!=n.length){r?e.UIMgr.ins.AddWaitingRef():e.UIMgr.ins.AddBlockRef(),o||(t.ins.totalTaskCnt.v+=n.length,++t.ins.loaderCnt.v);let a=this.Task;n.forEach(function(n){u.AutoReleaseRes(n),a.AddFunc(function(i){e.ResMgr.ins.Load(n,function(){o||++t.ins.finishTaskCnt.v,i()})})}),a.Run(s,function(){o||(--t.ins.loaderCnt.v,0==t.ins.loaderCnt.v&&(t.ins.finishTaskCnt.v=0,t.ins.totalTaskCnt.v=0)),r?e.UIMgr.ins.DecWaitingRef():e.UIMgr.ins.DecBlockRef(),e.Util.safeCall(i)})}else e.Util.safeCall(i)},r.prototype.OnIIClick=function(e,t){if(null!=t){if(this.m_IIEventHandler.has(t))return this.m_IIEventHandler.get(t)(e);console.info("UIComp::OnIIClick >> \u70b9\u51fb\u4e8b\u4ef6 "+t+" \u6ca1\u6709\u54cd\u5e94\u51fd\u6570")}else console.info("UIComp::OnIIClick >> \u6309\u94ae\u70b9\u51fb\u672a\u8bbe\u7f6e\u5173\u952e\u5b57 CustomData")},r.prototype.SetIIClickHandler=function(t,n,i,o){void 0===i&&(i=!1),void 0===o&&(o=0),this.m_IIEventHandler.set(t,function(t){0<o&&e.UIMgr.ins.blockSeconds(o,null),i||e.AudioMgr.ins.PlayEffect(),n&&n(t)})},r.prototype.RemoveIIClickHandler=function(e){this.m_IIEventHandler.has(e)&&this.m_IIEventHandler.delete(e)},r.prototype.RemoveAllIIClickHandler=function(){this.m_IIEventHandler.clear()},r._s_LOAD_EVENT_ID=0,r);function r(){let e=null!==i&&i.apply(this,arguments)||this;return e._i_b_LoadFunctionCalled=!1,e.m_IIEventHandler=new Map,e}e.BaseUIComp=o}(numas=numas||{}),function(e){var t,n=(t=e.BaseUIComp,__extends(i,t),Object.defineProperty(i.prototype,"FrameRate",{get:function(){return 60},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"AppTracing",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"p",{get:function(){return this._platform},enumerable:!1,configurable:!0}),i.prototype.onLoad=function(){var t=this;null===i.ins?i.ins=this:this.destroy(),this._canvas=this.getComponent(cc.Canvas),this.AdapterCanvas(this._canvas),cc.game.addPersistRootNode(this.node),this.setDisplayStats(!1),this.setFrameRate(this.FrameRate),this.addComponent(e.LSMgr).UseDefaultHelper(),this.addComponent(e.UserLSMgr).UseDefaultHelper(),this.addComponent(e.ResMgr),this.addComponent(e.UIMgr),this.addComponent(e.AudioMgr).UseDefaultHelper(),this._platform=this.addComponent(this.GetPlatformComponent()).Init(this.sdkCfg),e.LangUtil.AddLangCfg(e._LangCfg_DefaultJson),e.registerPrefabCfg(e.IIStartPrefabCfg.dft,this.START_BUNDLE_NAME),e.registerPrefabCfg(this.StartBundlePrefabCfg,this.START_BUNDLE_NAME);var n=e.Util.onceCall(function(){t.__LoadStartResListAndOnLoad()},3);e.UIMgr.ins.Open(e.IIStartPrefabCfg.dft.panel.BlockInputUIPanel.key,null,n),e.UIMgr.ins.Open(e.IIStartPrefabCfg.dft.panel.LoadingUIPanel.key,null,n),e.UIMgr.ins.Open(e.IIStartPrefabCfg.dft.panel.WaitingUIPanel.key,null,n)},i.prototype.__LoadStartResListAndOnLoad=function(){let e=[];for(var t in this.StartBundlePrefabCfg.panel)e.push(this.StartBundlePrefabCfg.panel[t].key);for(var n in this.StartBundlePrefabCfg.comp)e.push(this.StartBundlePrefabCfg.comp[n].key);this.LoadResList(e,this.OnPreAppLoad.bind(this),!0,!0)},i.prototype.OnPreAppLoad=function(){var t=this;this.AppTracing&&e.PlatformUtil.IsiOS?e.iOSATT.ins.RequestTrackingAuthorization(function(){t.OnAppLoad()},!0):this.OnAppLoad()},i.prototype.EnterFirstGame=function(t){this.p.ad.InitByScript(),e.UIMgr.ins.LoadBundleStage(t)},i.prototype.setDisplayStats=function(e){return cc.debug.setDisplayStats(e),this},i.prototype.setFrameRate=function(e){return cc.game.setFrameRate(e),this},i.prototype.FitHeight=function(){this._canvas.fitHeight=!0,this._canvas.fitWidth=!1},i.prototype.FitWidth=function(){this._canvas.fitWidth=!0,this._canvas.fitHeight=!1},i.prototype.FitCanvas=function(){let e=this._canvas;var t=e.designResolution.width,n=e.designResolution.height;return cc.winSize.width*n<=t*cc.winSize.height?(e.fitHeight=!1,e.fitWidth=!0):(e.fitHeight=!0,e.fitWidth=!1),this},i.prototype.FitCanvasWithVisiableSize=function(e,t){let n=this._canvas;var i=n.designResolution.width,o=n.designResolution.height;return console.assert(e<=i&&t<=o,"\u5c4f\u5e55\u9002\u914d >> \u4f20\u5165\u7684\u53ef\u89c6\u533a\u57df\u5fc5\u987b\u5c0f\u4e8e\u8bbe\u8ba1\u5206\u8fa8\u7387"),n.designResolution=cc.size(e,t),cc.winSize.width*t<=e*cc.winSize.height?(n.fitHeight=!1,n.fitWidth=!0):(n.fitHeight=!0,n.fitWidth=!1),this.node.setContentSize(cc.winSize),this},i.prototype.delayCall=function(t,n,i){void 0===i&&(i=!1),i?e.UIMgr.ins.blockSeconds(t,n):this.scheduleOnce(n,t)},i.prototype.Debug=function(){console.info(">> App::Debug"),e.ResMgr.ins.Debug(),e.UIMgr.ins.Debug(),e.ReferencePool.Debug()},i.prototype.GetPlatformComponent=function(){return e.PlatformUtil.IsWechat?e.WeChatPlatform:e.PlatformUtil.IsiOS?e.iOSPlatform:e.DefaultPlatform},i.ins=null,i);function i(){let e=null!==t&&t.apply(this,arguments)||this;return e._canvas=null,e._platform=null,e.START_BUNDLE_NAME="StartBundle",e}e.App=n}(numas=numas||{}),(numas=numas||{}).Cfg={DefaultUserKey:"ii@1986"},function(e){var t=(n.IsSystemLanguageChinese=function(){return cc.sys.language==cc.sys.LANGUAGE_CHINESE},n.InitSysLang=function(){this._init||(this._init=!0,this.IsSystemLanguageChinese()?this._sysLang="zh":this._sysLang="en",this._sysLang="en")},n.Get=function(){let e=[];for(let i=0;i<arguments.length;i++)e[i]=arguments[i];if(0==e.length)throw new Error("LangUtil >> \u53c2\u6570\u4e2a\u6570\u4e0d\u80fd\u4e3a 0 \u4e2a");let t=this._lang[this._sysLang][e[0]];void 0===t&&(t=e[0]);for(let i=1;i<e.length;++i){var n=new RegExp("\\{"+(i-1)+"\\}","gm");t=t.replace(n,e[i])}return t},n.AddLangCfg=function(e){let t;for(var n in this.InitSysLang(),e){this._lang[n]=null!==(t=this._lang[n])&&void 0!==t?t:{};let r=this._lang[n];var i,o=e[n];for(i in o)r[i]=o[i]}},n._sysLang="en",n._lang={},n._init=!1,n);function n(){}e.LangUtil=t}(numas=numas||{}),function(e){var t=(n.safeCall=function(e){null!=e&&e()},n.playParticleSystem=function(e,t){void 0===t&&(t=0),(e.node.opacity=0)==t?(e.resetSystem(),e.scheduleOnce(function(){e.node.opacity=255},0)):e.scheduleOnce(function(){e.resetSystem(),e.scheduleOnce(function(){e.node.opacity=255},0)},t)},n.block=function(e){return function(t,n,i){let o=i.value,r=!1;return i.value=function(){let t=[];for(let e=0;e<arguments.length;e++)t[e]=arguments[e];r?console.info("ii.Util.block >> blocking"):(r=!0,setTimeout(function(){r=!1},1e3*e),o.apply(this,t))},i}},n.onceCall=function(e,t){return function(){0==--t&&e()}},n.onceCallEx=function(e,t){return function(n){0==--t&&e(n)}},n);function n(){}e.Util=t}(numas=numas||{}),function(e){let t;(e=t=e.UIZIndex||(e.UIZIndex={}))[e.Stage=0]="Stage",e[e.Normal=128]="Normal",e[e.PopUp=256]="PopUp",e[e.TopModule=512]="TopModule",e[e.TopMsg=1024]="TopMsg",e[e.SystemModule=2048]="SystemModule"}(numas=numas||{}),function(e){e.IIStartPrefabCfg={dft:{panel:{DialogUIPanel:{key:"DialogUIPanel",z:e.UIZIndex.TopMsg},MsgUIPanel:{key:"MsgUIPanel",z:e.UIZIndex.SystemModule},BlockInputUIPanel:{key:"BlockInputUIPanel",z:e.UIZIndex.SystemModule},LoadingUIPanel:{key:"LoadingUIPanel",z:e.UIZIndex.SystemModule},WaitingUIPanel:{key:"WaitingUIPanel",z:e.UIZIndex.SystemModule}},comp:{}}}}(numas=numas||{}),function(e){var t=(n.dft={dialog_title:"default.dialog_title",dialog_lablel0_ok:"default.dialog_lablel0_ok",dialog_lablel_sure:"default.dialog_lablel_sure",dialog_lablel_cancel:"default.dialog_lablel_cancel",login_game:"default.login_game",login_fail_msg:"default.login_fail_msg",login_retry:"default.login_retry"},n);function n(){}e.LangCfg=t}(numas=numas||{}),function(e){var t=(n.Create1=function(t,i,o,r){void 0===o&&(o=e.LangCfg.dft.dialog_lablel0_ok),void 0===r&&(r=e.LangCfg.dft.dialog_title);let s=new n;return s.btnCount=1,s.msg=t,s.title=r,s.label0=o,s.btnFunc0=i,s},n.Create2=function(t,i,o,r,s,u){void 0===r&&(r=e.LangCfg.dft.dialog_lablel_cancel),void 0===s&&(s=e.LangCfg.dft.dialog_lablel_sure),void 0===u&&(u=e.LangCfg.dft.dialog_title);let a=new n;return a.btnCount=2,a.msg=t,a.title=u,a.label0=r,a.btnFunc0=i,a.label1=s,a.btnFunc1=o,a},n.Create3=function(t,i,o,r,s,u,a,l){void 0===s&&(s=e.LangCfg.dft.dialog_lablel_cancel),void 0===u&&(u=e.LangCfg.dft.dialog_lablel_sure),void 0===l&&(l=e.LangCfg.dft.dialog_title);let c=new n;return c.btnCount=3,c.msg=t,c.title=l,c.label0=s,c.btnFunc0=i,c.label1=u,c.btnFunc1=o,c.label2=null!=a?a:c.label2,c.btnFunc2=r,c},n);function n(){this.btnCount=1,this.msg="",this.title="",this.label0="",this.label1="",this.label2=""}e.DialogUIPanelArgs=t}(numas=numas||{}),(numas=numas||{})._LangCfg_DefaultJson={en:{"default.dialog_title":"Tip","default.dialog_lablel0_ok":"OK","default.dialog_lablel_sure":"SURE","default.dialog_lablel_cancel":"CANCEL","default.login_game":"Login","default.login_fail_msg":"Login Failed","default.login_retry":"Retry"},zh:{"default.dialog_title":"\u63d0\u793a","default.dialog_lablel0_ok":"\u786e\u5b9a","default.dialog_lablel_sure":"\u786e\u5b9a","default.dialog_lablel_cancel":"\u53d6\u6d88","default.login_game":"\u767b\u9646","default.login_fail_msg":"\u767b\u9646\u5931\u8d25","default.login_retry":"\u91cd\u8bd5"}},function(e){var t,n=(t=cc.Component,__extends(i,t),i.prototype.onLoad=function(){var t=this;null===i.ins?i.ins=this:this.destroy(),this.m_ToPlayEffectQueue=e.AnyQueue.Borrow(),this._effectOffBV=e.BooleanBV.BorrowAsLS("ls_effect_off",!1,!1),this._musicOffBV=e.BooleanBV.BorrowAsLS("ls_music_off",!1,!1).Bind(function(e){e?t.IsMusicPlaying()&&t.StopMusic():t.IsMusicPlaying()||t.playMusic(t.m_LastMusicKey)},!1,this)},i.prototype.SetHelper=function(e){this.m_AudioHelper=e},i.prototype.UseDefaultHelper=function(){this.SetHelper(new e.DefaultAudioHelper)},i.prototype.AddPlayEffect=function(e){this.m_ToPlayEffectQueue.Contains(function(t){return t==e})||(this.m_ToPlayEffectQueue.Enqueue(e),this.__i_StartScheduler())},i.prototype.ScheduleToPlayEffectQueue=function(){var e=this;0<this.m_ToPlayEffectQueue.Count&&(this.m_ToPlayEffectQueue.RemoveAll(function(t){return e.PlayEffect_Impl(t)}),this.__i_StopScheduler())},i.prototype.__i_StartScheduler=function(){null===this.m_PlayEffectScheduler&&(this.m_PlayEffectScheduler=this.ScheduleToPlayEffectQueue.bind(this),this.schedule(this.m_PlayEffectScheduler,0))},i.prototype.__i_StopScheduler=function(){null!==this.m_PlayEffectScheduler&&(this.unschedule(this.m_PlayEffectScheduler),this.m_PlayEffectScheduler=null)},i.prototype.SetDefaultEffect=function(e){null!=e&&""!==e&&(this.DEFAULT_EFFECT=e)},Object.defineProperty(i.prototype,"effectOffBV",{get:function(){return this._effectOffBV},enumerable:!1,configurable:!0}),i.prototype.PlayEffect=function(t){this._effectOffBV.v||(t=t||this.DEFAULT_EFFECT)&&e.ResMgr.ins.HasRegister(t)&&this.AddPlayEffect(t)},Object.defineProperty(i.prototype,"effectVolume",{get:function(){return this.m_AudioHelper.GetEffectVolume()},set:function(e){this.m_AudioHelper.SetEffectVolume(e)},enumerable:!1,configurable:!0}),i.prototype.PlayEffect_Impl=function(t){var n=this;e.ResMgr.ins.Load(t,function(e){n.m_AudioHelper.PlayEffect(e)})},Object.defineProperty(i.prototype,"musicOffBV",{get:function(){return this._musicOffBV},enumerable:!1,configurable:!0}),i.prototype.playMusic=function(t,n){var i=this;void 0===n&&(n=!0),t&&(this.m_LastMusicKey=t,this._musicOffBV.v||e.ResMgr.ins.Load(t,function(e){i.m_AudioHelper.PlayMusic(e,n)}))},i.prototype.IsMusicPlaying=function(){return this.m_AudioHelper.IsMusicPlaying()},i.prototype.PauseMusic=function(){this.m_AudioHelper.PauseMusic()},i.prototype.ResumeMusic=function(){this.m_AudioHelper.ResumeMusic()},i.prototype.StopMusic=function(){this.m_AudioHelper.StopMusic()},Object.defineProperty(i.prototype,"musicVolume",{get:function(){return this.m_AudioHelper.GetMusicVolume()},set:function(e){this.m_AudioHelper.SetMusicVolume(e)},enumerable:!1,configurable:!0}),i.ins=null,i);function i(){let e=null!==t&&t.apply(this,arguments)||this;return e.m_AudioHelper=null,e.m_ToPlayEffectQueue=null,e.m_PlayEffectScheduler=null,e.DEFAULT_EFFECT="audio.default_effect",e._effectOffBV=null,e._musicOffBV=null,e.m_LastMusicKey=null,e}e.AudioMgr=n}(numas=numas||{}),function(e){let t=(n.prototype.Reset=function(){(this.id=null)!==this.clip&&(this.clip.decRef(),this.clip=null)},n.Borrow=function(t,i){let o=e.ReferencePool.Borrow(n);return o.id=t,(o.clip=i).addRef(),o},n.prototype.Return=function(){e.ReferencePool.Return(n,this)},n);function n(){this.id=null,this.clip=null}var i,o=(i=cc.EventTarget,__extends(r,i),r.prototype.PlayEffect=function(e){var n=cc.audioEngine.playEffect(e,!1);cc.audioEngine.setVolume(n,this.GetEffectVolume()),this._effectQueue.Enqueue(t.Borrow(n,e)),this._effectQueue.Remove(function(e){return-1==cc.audioEngine.getState(e.id)},function(e){return e.Return()})},r.prototype.GetEffectVolume=function(){return cc.audioEngine.getEffectsVolume()},r.prototype.SetEffectVolume=function(e){0<=e&&e<=1&&cc.audioEngine.setEffectsVolume(e)},r.prototype.StopAllEffect=function(){cc.audioEngine.stopAllEffects(),this._effectQueue.RemoveAll(function(e){return e.Return()})},r.prototype.PlayMusic=function(e,t){this.m_MusicClip!=e&&(e.addRef(),0<=this.m_CurMusicId&&this.StopMusic(),this.m_MusicClip=e,this.m_CurMusicId=cc.audioEngine.playMusic(e,t),cc.audioEngine.setVolume(this.m_CurMusicId,this.GetMusicVolume()))},r.prototype.IsMusicPlaying=function(){return 0<=this.m_CurMusicId},r.prototype.PauseMusic=function(){cc.audioEngine.pauseMusic()},r.prototype.ResumeMusic=function(){cc.audioEngine.resumeMusic()},r.prototype.StopMusic=function(){0<=this.m_CurMusicId&&(cc.audioEngine.stop(this.m_CurMusicId),this.m_MusicClip.decRef(),this.m_MusicClip=null,this.m_CurMusicId=-1)},r.prototype.GetMusicVolume=function(){return cc.audioEngine.getMusicVolume()},r.prototype.SetMusicVolume=function(e){0<=e&&e<=1&&cc.audioEngine.setMusicVolume(e)},r);function r(){let t=null!==i&&i.apply(this,arguments)||this;return t._effectQueue=e.AnyQueue.Borrow(),t.m_CurMusicId=-1,t.m_MusicClip=null,t}e.DefaultAudioHelper=o}(numas=numas||{}),function(e){var t,n=(t=cc.Component,__extends(i,t),Object.defineProperty(i.prototype,"EventQueue",{get:function(){return null===this.m_EventQueue&&(this.m_EventQueue=e.AnyQueue.Borrow()),this.m_EventQueue},enumerable:!1,configurable:!0}),i.prototype.WrapEventHandler=function(e,t){var n=this;return function(i){n.m_IsEventHandlable?e.call(t,i):n.EventQueue.Enqueue(function(){return e.call(t,i)})}},i.prototype.HandleEvents=function(){if(this.m_IsEventHandlable=!0,null!==this.m_EventQueue)for(;0<this.m_EventQueue.Count;)this.m_EventQueue.Dequeue()()},i.prototype.BlockEvents=function(){this.m_IsEventHandlable=!1},i.prototype.onDestroy=function(){null!==this.m_EventQueue&&(this.m_EventQueue.Return(),this.m_EventQueue=null)},i);function i(){let e=null!==t&&t.apply(this,arguments)||this;return e.m_IsEventHandlable=!1,e.m_EventQueue=null,e}e.DelayEventComponent=n}(numas=numas||{}),function(e){var t=(Object.defineProperty(n.prototype,"Count",{get:function(){return this.m_len},enumerable:!1,configurable:!0}),n.prototype.IndexOf=function(e){return this.__IndexOf(!0,e)},n.prototype.ReverseIndexOf=function(e){return this.__IndexOf(!1,e)},n.prototype.Fetch=function(e){return this.__Fetch(!0,e)},n.prototype.ReverseFetch=function(e){return this.__Fetch(!1,e)},n.prototype.FetchByIndex=function(e){return this.__FetchByIndex(!0,e)},n.prototype.ReverseFetchByIndex=function(e){return this.__FetchByIndex(!1,e)},n.prototype.Remove=function(e,t){this.__RemoveByFind(!0,e,t)},n.prototype.ReverseRemove=function(e,t){this.__RemoveByFind(!1,e,t)},n.prototype.RemoveFirst=function(e,t){this.__RemoveFirstByFind(!0,e,t)},n.prototype.ReverseRemoveFirst=function(e,t){this.__RemoveFirstByFind(!1,e,t)},n.prototype.RemoveAll=function(e){this.__RemoveByFind(!0,function(){return!0},e)},n.prototype.ReverseRemoveAll=function(e){this.__RemoveByFind(!0,function(){return!0},e)},n.prototype.For=function(e){return this.__For(!0,e)},n.prototype.ReverseFor=function(e){return this.__For(!1,e)},n.prototype.ForEach=function(e){this.__ForEach(!0,e)},n.prototype.ReverseForEach=function(e){this.__ForEach(!1,e)},n.prototype.CountIf=function(e){let t=0,n=this.m_front;for(;n.Next!=this.m_tail;)e(n.Next.Value)&&++t,n=n.Next;return t},n.prototype.Contains=function(e,t){let n=this.m_front;for(;n.Next!=this.m_tail;){if(e(n.Next.Value))return t&&t(n.Next.Value),!0;n=n.Next}return!1},n.prototype.FrontValue=function(){return this.m_front.Next.Value},n.prototype.TailValue=function(){return this.m_tail.Previous.Value},n.prototype.AddFront=function(e){this.AddNext(this.m_front,e)},n.prototype.AddTail=function(e){this.AddPrevious(this.m_tail,e)},n.prototype.Get=function(){if(0<this.Count)return this.RemoveNext(this.m_front);throw new Error("Ensure 'Count > 0' before Get!")},n.prototype.ReverseGet=function(){if(0<this.Count)return this.RemovePrevious(this.m_tail);throw new Error("Ensure 'Count > 0' before ReverseGet!")},n.prototype.Reset=function(){this.RemoveAll(),this.m_front.Next=this.m_tail,this.m_tail.Previous=this.m_front},n.prototype.AddNext=function(t,n){let i=e.LinkNode.Borrow();i.Value=n,i.Next=t.Next,(i.Previous=t).Next.Previous=i,t.Next=i,++this.m_len},n.prototype.AddPrevious=function(t,n){let i=e.LinkNode.Borrow();i.Value=n,i.Next=t,i.Previous=t.Previous,t.Previous.Next=i,t.Previous=i,++this.m_len},n.prototype.RemoveNext=function(e){var t=e.Next.Value;let n=e.Next;return(n.Next.Previous=e).Next=n.Next,--this.m_len,n.Return(),t},n.prototype.RemovePrevious=function(e){var t=e.Previous.Value;let n=e.Previous;return(n.Previous.Next=e).Previous=n.Previous,--this.m_len,n.Return(),t},n.prototype.__RemoveByFind=function(e,t,n){let i;if(e){let e=this.m_front;for(;e.Next!=this.m_tail;){var o;t(null===(i=e.Next)||void 0===i?void 0:i.Value)?(o=this.RemoveNext(e),n&&n(o)):e=e.Next}}else{let e=this.m_tail;for(;e.Previous!=this.m_front;){var r;t(e.Previous.Value)?(r=this.RemovePrevious(e),n&&n(r)):e=e.Previous}}},n.prototype.__RemoveFirstByFind=function(e,t,n){let i;if(e){let e=this.m_front;for(;e.Next!=this.m_tail;){if(t(null===(i=e.Next)||void 0===i?void 0:i.Value)){var o=this.RemoveNext(e);return void(n&&n(o))}e=e.Next}}else{let e=this.m_tail;for(;e.Previous!=this.m_front;){if(t(e.Previous.Value)){var r=this.RemovePrevious(e);return void(n&&n(r))}e=e.Previous}}},n.prototype.__IndexOf=function(e,t){let n=0;if(e){let e=this.m_front;for(;e.Next!=this.m_tail;){if(t(e.Next.Value))return n;e=e.Next,++n}}else{let e=this.m_tail;for(;e.Previous!=this.m_front;){if(t(e.Previous.Value))return n;e=e.Previous,++n}}return-1},n.prototype.__Fetch=function(e,t){if(e){let e=this.m_front;for(;e.Next!=this.m_tail;){if(t(e.Next.Value))return e.Next.Value;e=e.Next}}else{let e=this.m_tail;for(;e.Previous!=this.m_front;){if(t(e.Previous.Value))return e.Previous.Value;e=e.Previous}}throw new Error("Can't Fetch target object")},n.prototype.__FetchByIndex=function(e,t){let n=0;if(e){let e=this.m_front;for(;e.Next!=this.m_tail;){if(n==t)return e.Next.Value;e=e.Next,++n}}else{let e=this.m_tail;for(;e.Previous!=this.m_front;){if(n==t)return e.Previous.Value;e=e.Previous,++n}}throw new Error("Can't Fetch target object")},n.prototype.__For=function(e,t){if(e){let e=this.m_front;for(;e.Next!=this.m_tail;){if(t(e.Next.Value))return!0;e=e.Next}}else{let e=this.m_tail;for(;e.Previous!=this.m_front;){if(t(e.Previous.Value))return!0;e=e.Previous}}return!1},n.prototype.__ForEach=function(e,t){if(e){let e=this.m_front;for(;e.Next!=this.m_tail;)t(e.Next.Value),e=e.Next}else{let e=this.m_tail;for(;e.Previous!=this.m_front;)t(e.Previous.Value),e=e.Previous}},n);function n(){this.m_front=e.LinkNode.Borrow(),this.m_tail=e.LinkNode.Borrow(),this.m_len=0,this.m_front.Next=this.m_tail,this.m_tail.Previous=this.m_front}e.BaseLink=t}(numas=numas||{}),function(e){var t,n=(t=e.BaseLink,__extends(i,t),Object.defineProperty(i.prototype,"Front",{get:function(){return this.FrontValue()},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"Tail",{get:function(){return this.TailValue()},enumerable:!1,configurable:!0}),i.prototype.Enqueue=function(e){this.AddTail(e)},i.prototype.Dequeue=function(){return this.Get()},i.prototype.ReverseDequeue=function(){return this.ReverseGet()},i);function i(){return null!==t&&t.apply(this,arguments)||this}e.Queue=n}(numas=numas||{}),function(e){var t,n=(t=e.Queue,__extends(i,t),i.Borrow=function(){return e.ReferencePool.Borrow(i)},i.prototype.Return=function(){e.ReferencePool.Return(i,this)},i);function i(){return null!==t&&t.apply(this,arguments)||this}e.AnyQueue=n}(numas=numas||{}),function(e){var t,n=(t=e.BaseLink,__extends(i,t),Object.defineProperty(i.prototype,"Top",{get:function(){return this.FrontValue()},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"Bottom",{get:function(){return this.TailValue()},enumerable:!1,configurable:!0}),i.prototype.Push=function(e){this.AddFront(e)},i.prototype.Pop=function(){return this.Get()},i.prototype.ReversePop=function(){return this.ReverseGet()},i);function i(){return null!==t&&t.apply(this,arguments)||this}e.Stack=n}(numas=numas||{}),function(e){var t,n=(t=e.Stack,__extends(i,t),i.Borrow=function(){return e.ReferencePool.Borrow(i)},i.prototype.Return=function(){e.ReferencePool.Return(i,this)},i);function i(){return null!==t&&t.apply(this,arguments)||this}e.AnyStack=n}(numas=numas||{}),function(e){var t=(n.prototype.left=function(e){return 2*e+1},n.prototype.right=function(e){return 2*e+2},n.prototype.parent=function(e){return e%2==0?(e-2)/2:(e-1)/2},n.prototype.Add=function(e){this.data.push(e),this.siftUp(this.data.length-1)},n.prototype.siftUp=function(e){let t,n=this.parent(e);for(;0<e&&0<this.m_Compare(this.data[n],this.data[e]);)t=[this.data[e],this.data[n]],this.data[n]=t[0],this.data[e]=t[1],e=n,n=this.parent(e)},n.prototype.ExtractRoot=function(){console.assert(0<this.data.length);var e=this.data[0],t=this.data.pop();return 0<this.data.length&&(this.data[0]=t,this.siftDown(0)),e},n.prototype.siftDown=function(e){let t;function n(e,t){return t>=i.data.length?e>=i.data.length?-1:e:i.m_Compare(i.data[e],i.data[t])<=0?e:t}var i=this;let o=n(this.left(e),this.right(e));for(;0<=o&&0<this.m_Compare(this.data[e],this.data[o]);)t=[this.data[e],this.data[o]],this.data[o]=t[0],this.data[e]=t[1],e=o,o=n(this.left(e),this.right(e))},Object.defineProperty(n.prototype,"Count",{get:function(){return this.data.length},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"Root",{get:function(){if(0<this.data.length)return this.data[0];throw new Error("Check Count before get Root")},enumerable:!1,configurable:!0}),n.prototype.Clear=function(){for(;0<this.data.length;)this.ExtractRoot()},n);function n(e){this.m_Compare=e,this.data=[]}e.Heap=t}(numas=numas||{}),function(e){var t=(n.prototype.Reset=function(){this.Next=null,this.Previous=null,this.Value=null},n.Borrow=function(t){void 0===t&&(t=null);let i=e.ReferencePool.Borrow(n);return i.Value=t,i},n.prototype.Return=function(){e.ReferencePool.Return(n,this)},n);function n(){this.Next=null,this.Previous=null}e.LinkNode=t}(numas=numas||{}),function(e){let t=(n.encode=function(e){if(/([^\u0000-\u00ff])/.test(e))throw new Error("INVALID_CHARACTER_ERR");let t,n,i,o=0,r=[];for(;o<e.length;){switch(n=e.charCodeAt(o),i=o%3){case 0:r.push(this.base64hash.charAt(n>>2));break;case 1:r.push(this.base64hash.charAt((3&t)<<4|n>>4));break;case 2:r.push(this.base64hash.charAt((15&t)<<2|n>>6)),r.push(this.base64hash.charAt(63&n))}t=n,o++}return 0==i?(r.push(this.base64hash.charAt((3&t)<<4)),r.push("==")):1==i&&(r.push(this.base64hash.charAt((15&t)<<2)),r.push("=")),r.join("")},n.decode=function(e){e=e.replace(/\s|=/g,"");let t,n,i,o=0,r=[];for(;o<e.length;){switch(t=this.base64hash.indexOf(e.charAt(o)),i=o%4){case 0:break;case 1:r.push(String.fromCharCode(n<<2|t>>4));break;case 2:r.push(String.fromCharCode((15&n)<<4|t>>2));break;case 3:r.push(String.fromCharCode((3&n)<<6|t))}n=t,o++}return r.join("")},n.Test=function(){console.log(">>Test Base64:"),[{value:"Man",encode:"TWFu"},{value:"A",encode:"QQ=="},{value:"BC",encode:"QkM="}].forEach(function(e){var t=n.encode(e.value),i=n.decode(t);if(e.value!==i||t!==e.encode)throw"Error!";console.log(e.value," ----\x3e OK")})},n.base64hash="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n);function n(){}var i=(o.encodeBase64=function(e){return t.encode(e)},o.decodeBase64=function(e){return t.decode(e)},o);function o(){}e.encrypt=i}(numas=numas||{}),function(e){var t,n=(t=cc.EventTarget,__extends(i,t),Object.defineProperty(i,"ins",{get:function(){return null===this._ins&&(this._ins=new i),this._ins},enumerable:!1,configurable:!0}),i._ins=null,i);function i(){return t.call(this)||this}e.EventCenter=n}(numas=numas||{}),function(e){var t=(Object.defineProperty(n,"ins",{get:function(){return null===this._ins&&(this._ins=new n),this._ins},enumerable:!1,configurable:!0}),n.prototype.save=function(){},n.prototype.deleteKey=function(e){cc.sys.localStorage.removeItem(e)},n.prototype.hasKey=function(e){return null!=(e=cc.sys.localStorage.getItem(e))&&0!=e.length},n.prototype.setBool=function(e,t,n){this.setItem(e,t?"t":"f",n)},n.prototype.getBool=function(e){return"t"==this.getItem(e)},n.prototype.getBoolWithDefault=function(e,t){return this.hasKey(e)?this.getBool(e):t},n.prototype.setInt=function(e,t,n){this.setItem(e,t.toString(),n)},n.prototype.getInt=function(e){return Number(this.getItem(e))},n.prototype.getIntWithDefault=function(e,t){return this.hasKey(e)?this.getInt(e):t},n.prototype.setString=function(e,t,n){this.setItem(e,t,n)},n.prototype.getString=function(e){return this.getItem(e)},n.prototype.getStringWithDefault=function(e,t){return this.hasKey(e)?this.getString(e):t},n.prototype.setObject=function(e,t,n){this.setItem(e,JSON.stringify(t),n)},n.prototype.getObject=function(e){return JSON.parse(this.getItem(e))},n.prototype.getObjectWithDefault=function(e,t){return this.hasKey(e)?this.getObject(e):t},n.prototype.getItem=function(t){let n=cc.sys.localStorage.getItem(t);return 0===n.indexOf(this.PRE_FIX)&&(n=n.substring(this.PRE_FIX.length),n=e.encrypt.decodeBase64(n)),n},n.prototype.setItem=function(t,n,i){cc.sys.localStorage.removeItem(t),i&&(n=e.encrypt.encodeBase64(n),n=""+this.PRE_FIX+n),cc.sys.localStorage.setItem(t,n)},n._ins=null,n);function n(){this.PRE_FIX="#@!l0lzl(s_"}e.CocosLocalStorageHelper=t}(numas=numas||{}),function(e){var t,n=(t=cc.Component,__extends(i,t),i.prototype.onLoad=function(){null===i.ins?i.ins=this:this.destroy()},i.prototype.SetHelper=function(e){this.h=e},i.prototype.UseDefaultHelper=function(){this.SetHelper(e.CocosLocalStorageHelper.ins)},i.prototype.deleteKey=function(){},i.prototype.hasKey=function(e){return this.h.hasKey(e)},i.prototype.setBool=function(e,t,n){this.h.setBool(e,t,n)},i.prototype.getBool=function(e){return this.h.getBool(e)},i.prototype.getBoolWithDefault=function(e,t){return this.h.getBoolWithDefault(e,t)},i.prototype.setInt=function(e,t,n){this.h.setInt(e,t,n)},i.prototype.getInt=function(e){return this.h.getInt(e)},i.prototype.getIntWithDefault=function(e,t){return this.h.getIntWithDefault(e,t)},i.prototype.setString=function(e,t,n){this.h.setString(e,t,n)},i.prototype.getString=function(e){return this.h.getString(e)},i.prototype.getStringWithDefault=function(e,t){return this.h.getStringWithDefault(e,t)},i.prototype.setObject=function(e,t,n){this.h.setObject(e,t,n)},i.prototype.getObject=function(e){return this.h.getObject(e)},i.prototype.getObjectWithDefault=function(e,t){return this.h.getObjectWithDefault(e,t)},i.ins=null,i);function i(){let e=null!==t&&t.apply(this,arguments)||this;return e.h=null,e}e.LSMgr=n}(numas=numas||{}),function(e){var t,n=(t=cc.Component,__extends(i,t),i.prototype.onLoad=function(){null===i.ins?i.ins=this:this.destroy()},i.prototype.SetHelper=function(e){this.h=e},i.prototype.UseDefaultHelper=function(){this.SetHelper(e.CocosLocalStorageHelper.ins)},i.prototype.setUserId=function(e){console.warn("uid >> "+e),this.m_UserId=e},i.prototype.checkUserId=function(){if(null===this.m_UserId)throw new Error(">>>> please setUserId before use UserLSMgr")},i.prototype.key2UserKey=function(e){return this.m_UserId+"_"+e},i.prototype.deleteKey=function(){},i.prototype.hasKey=function(e){return this.checkUserId(),this.h.hasKey(this.key2UserKey(e))},i.prototype.setBool=function(e,t,n){this.checkUserId(),this.h.setBool(this.key2UserKey(e),t,n)},i.prototype.getBool=function(e){return this.checkUserId(),this.h.getBool(this.key2UserKey(e))},i.prototype.getBoolWithDefault=function(e,t){return this.checkUserId(),this.h.getBoolWithDefault(this.key2UserKey(e),t)},i.prototype.setInt=function(e,t,n){this.checkUserId(),this.h.setInt(this.key2UserKey(e),t,n)},i.prototype.getInt=function(e){return this.checkUserId(),this.h.getInt(this.key2UserKey(e))},i.prototype.getIntWithDefault=function(e,t){return this.checkUserId(),this.h.getIntWithDefault(this.key2UserKey(e),t)},i.prototype.setString=function(e,t,n){this.checkUserId(),this.h.setString(this.key2UserKey(e),t,n)},i.prototype.getString=function(e){return this.checkUserId(),this.h.getString(this.key2UserKey(e))},i.prototype.getStringWithDefault=function(e,t){return this.checkUserId(),this.h.getStringWithDefault(this.key2UserKey(e),t)},i.prototype.setObject=function(e,t,n){this.checkUserId(),this.h.setObject(this.key2UserKey(e),t,n)},i.prototype.getObject=function(e){return this.checkUserId(),this.h.getObject(this.key2UserKey(e))},i.prototype.getObjectWithDefault=function(e,t){return this.checkUserId(),this.h.getObjectWithDefault(this.key2UserKey(e),t)},i.ins=null,i);function i(){let e=null!==t&&t.apply(this,arguments)||this;return e.h=null,e.m_UserId=null,e}e.UserLSMgr=n}(numas=numas||{}),function(e){let t=(n.prototype.__C=function(e){return new cc.Node(this._k).addComponent(e)},n.prototype.Get=function(e){if(0<this._p.length){let e=this._p.pop();return e.node.active=!0,e}return this.__C(e)},n.prototype.Put=function(e){e.node.active=!1,this._p.push(e)},n.prototype.Clear=function(){for(;0<this._p.length;)this._p.pop().node.destroy()},n);function n(e){this._p=[],this._k="",this._k=e}var i=(o.Get=function(e,t){return this.GetPool(e).Get(t)},o.Put=function(e,t){this.GetPool(e).Put(t)},o.GetPool=function(e){let n=null;return this._m.has(e)?n=this._m.get(e):(n=new t(e),this._m.set(e,n)),n},o._m=new Map,o);function o(){}e.NodePool=i}(numas=numas||{}),function(e){var t=(n.Debug=function(){console.warn(" -------- ReferencePool::Debug begin -------- "),console.info(this.s_ReferenceCollections),console.warn(" -------- ReferencePool::Debug end -------- ")},Object.defineProperty(n,"Count",{get:function(){return this.s_ReferenceCollections.size},enumerable:!1,configurable:!0}),n.ClearAll=function(){var e=this;this.s_ReferenceCollections.forEach(function(t,n){e.s_ReferenceCollections.delete(n),t.RemoveAll()})},n.Borrow=function(e){return this.GetReferenceCollection(e).Borrow()},n.Return=function(e,t){if(!t)throw new Error("Reference is invalid.");this.GetReferenceCollection(e).Return(t)},n.Add=function(e,t){this.GetReferenceCollection(e).Add(t)},n.Remove=function(e,t){this.GetReferenceCollection(e).Remove(t)},n.RemoveAll=function(e){let t;this.s_ReferenceCollections.has(e)&&((t=this.s_ReferenceCollections.get(e)).RemoveAll(),this.s_ReferenceCollections.delete(e))},n.GetReferenceCollection=function(t){let n;return this.s_ReferenceCollections.has(t)?n=this.s_ReferenceCollections.get(t):(n=new e.ReferenceSinglePool(t),this.s_ReferenceCollections.set(t,n)),n},n.s_ReferenceCollections=new Map,n);function n(){}e.ReferencePool=t}(numas=numas||{}),function(e){var t=(Object.defineProperty(n.prototype,"UnusedReferenceCount",{get:function(){return this.m_References.length},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"UsingReferenceCount",{get:function(){return this.m_UsingReferenceCount},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"BorrowReferenceCount",{get:function(){return this.m_BorrowReferenceCount},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"ReleaseReferenceCount",{get:function(){return this.m_ReleaseReferenceCount},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"AddReferenceCount",{get:function(){return this.m_AddReferenceCount},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"RemoveReferenceCount",{get:function(){return this.m_RemoveReferenceCount},enumerable:!1,configurable:!0}),n.prototype.Borrow=function(){return this.m_UsingReferenceCount++,this.m_BorrowReferenceCount++,0<this.m_References.length?this.m_References.pop():(this.m_AddReferenceCount++,new this.m_New)},n.prototype.Return=function(e){if(e.Reset(),-1!==this.m_References.indexOf(e))throw new Error("The reference has been released.");this.m_References.push(e),++this.m_ReleaseReferenceCount,--this.m_UsingReferenceCount},n.prototype.Add=function(e){for(this.m_AddReferenceCount+=e;0<e--;)this.m_References.push(new this.m_New)},n.prototype.Remove=function(e){for(e>this.m_References.length&&(e=this.m_References.length),this.m_RemoveReferenceCount+=e;0<e--;)this.m_References.pop()},n.prototype.RemoveAll=function(){this.Remove(this.m_References.length)},n);function n(e){this.m_References=[],this.m_UsingReferenceCount=0,this.m_BorrowReferenceCount=0,this.m_ReleaseReferenceCount=0,this.m_AddReferenceCount=0,this.m_RemoveReferenceCount=0,this.m_New=e,this.m_UsingReferenceCount=0,this.m_BorrowReferenceCount=0,this.m_ReleaseReferenceCount=0,this.m_AddReferenceCount=0,this.m_RemoveReferenceCount=0}e.ReferenceSinglePool=t}(numas=numas||{}),function(e){let t;function n(e,t,n,i,r,s){if(t)try{return t.apply(e,[n,i,r].concat(s))}catch(t){return e.error(n,i,r,s,o.Error.INVALID_CALLBACK,"an exception occurred in a caller-provided callback function",t)}}function i(e,t,i,o,r){var s,u,a,l,c;a=i,l=o,c=r,n(s=e,s["onafter"+(u=t)]||s["on"+u],u,a,l,c),t=t,i=i,o=o,r=r,n(e=e,e.onafterevent||e.onevent,t,i,o,r)}var o;(o=t=e.StateMachine||(e.StateMachine={})).VERSION="2.3.5",o.Result={SUCCEEDED:1,NOTRANSITION:2,CANCELLED:3,PENDING:4},o.Error={INVALID_TRANSITION:100,PENDING_TRANSITION:200,INVALID_CALLBACK:300},o.WILDCARD="*",o.ASYNC="async",o.create=function(e,t){let r="string"==typeof e.initial?{state:e.initial}:e.initial;var s=e.terminal||e.final;let u=t||e.target||{};var a,l,c=e.events||[];let p=e.callbacks||{},h={},f={};function d(e){var t=e.from instanceof Array?e.from:e.from?[e.from]:[o.WILDCARD];h[e.name]=h[e.name]||{};for(let n=0;n<t.length;n++)f[t[n]]=f[t[n]]||[],f[t[n]].push(e.name),h[e.name][t[n]]=e.to||t[n]}r&&(r.event=r.event||"startup",d({name:r.event,from:"none",to:r.state}));for(let n=0;n<c.length;n++)d(c[n]);for(a in h)h.hasOwnProperty(a)&&(u[a]=function(e,t){return function(){var r=this.current,s=t[r]||t[o.WILDCARD]||r,u=Array.prototype.slice.call(arguments);if(this.transition)return this.error(e,r,s,u,o.Error.PENDING_TRANSITION,"event "+e+" inappropriate because previous transition did not complete");if(this.cannot(e))return this.error(e,r,s,u,o.Error.INVALID_TRANSITION,"event "+e+" inappropriate in current state "+this.current);if(!1===function(e,t,i,o,r){if(!1===function(e,t,i,o,r){return n(e,e["onbefore"+t],t,i,o,r)}(e,t,i,o,r)||!1===function(e,t,i,o,r){return n(e,e.onbeforeevent,t,i,o,r)}(e,t,i,o,r))return!1}(this,e,r,s,u))return o.Result.CANCELLED;if(r===s)return i(this,e,r,s,u),o.Result.NOTRANSITION;var a=this;this.transition=function(){var t,l,c,p,h,f,d,_,y;return a.transition=null,a.current=s,t=e,l=r,p=u,function(e,i){n(e,e["onenter"+i]||e["on"+i],t,l,i,p)}(h=a,c=s),function(e){n(e,e.onenterstate||e.onstate,t,l,c,p)}(h),f=e,d=r,_=s,y=u,n(h=a,h.onchangestate,f,d,_,y),i(a,e,r,s,u),o.Result.SUCCEEDED},this.transition.cancel=function(){a.transition=null,i(a,e,r,s,u)};var l=function(e,t,i,r,s){var u=function(e,t,i,o,r){return n(e,e["onleave"+i],t,i,o,r)}(e,t,i,r,s);return s=function(e,t,i,o,r){return n(e,e.onleavestate,t,i,o,r)}(e,t,i,r,s),!1!==u&&!1!==s&&(o.ASYNC===u||o.ASYNC===s?o.ASYNC:void 0)}(this,e,r,s,u);return!1===l?(this.transition=null,o.Result.CANCELLED):o.ASYNC===l?o.Result.PENDING:this.transition?this.transition():void 0}}(a,h[a]));for(l in p)p.hasOwnProperty(l)&&(u[l]=p[l]);return u.current="none",u.is=function(e){return e instanceof Array?0<=e.indexOf(this.current):this.current===e},u.can=function(e){return!this.transition&&(h[e].hasOwnProperty(this.current)||h[e].hasOwnProperty(o.WILDCARD))},u.cannot=function(e){return!this.can(e)},u.transitions=function(){return f[this.current]},u.isFinished=function(){return this.is(s)},u.error=e.error||function(e,t,n,i,o,r,s){throw s||r},r&&!r.defer&&u[r.event](),u}}(numas=numas||{}),function(e){let t;!function(t){let n;(s=n=t.ETaskStatus||(t.ETaskStatus={}))[s.NONE=0]="NONE",s[s.RUNNING=1]="RUNNING",s[s.DONE=2]="DONE",s[s.ERROR=3]="ERROR";let i=(o.Borrow=function(t){return e.ReferencePool.Borrow(o).Init(t)},o.prototype.Reset=function(){this.m_Status=n.NONE,this.m_Func=null},o.prototype.Return=function(){e.ReferencePool.Return(o,this)},o.prototype.Init=function(e){return this.m_Func=e,this},o.prototype.Run=function(){return this.m_Status===n.NONE&&this.m_Func(this.Resolve.bind(this),this.Reject.bind(this)),this},o.prototype.Resolve=function(){this.m_Status=n.DONE},o.prototype.Reject=function(){this.m_Status=n.ERROR,console.warn("\u4efb\u52a1\u5931\u8d25")},o.prototype.IsCompleted=function(){return this.m_Status===n.DONE},o);function o(){this.m_Func=null,this.m_Status=n.NONE}var r,s=(r=cc.Component,__extends(u,r),Object.defineProperty(u.prototype,"TaskQueue",{get:function(){return null===this._m_TaskQueue&&(this._m_TaskQueue=e.AnyQueue.Borrow()),this._m_TaskQueue},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"RunningTaskQueue",{get:function(){return null===this._m_RunningTaskQueue&&(this._m_RunningTaskQueue=e.AnyQueue.Borrow()),this._m_RunningTaskQueue},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"CallbackQueue",{get:function(){return null===this._m_CallbackQueue&&(this._m_CallbackQueue=e.AnyQueue.Borrow()),this._m_CallbackQueue},enumerable:!1,configurable:!0}),u.prototype.AddFunc=function(e){return e=i.Borrow(e),this.TaskQueue.Enqueue(e),this},u.prototype.Run=function(e,t){return null!=t&&this.CallbackQueue.Enqueue(t),this.StartTaskScheduler(e),this},u.prototype.RemoveSelf=function(){this.node.removeComponent(this)},u.prototype.StartTaskScheduler=function(e){var t=this;null===this.m_TaskScheduler&&(this.m_TaskScheduler=function(){return t.UpdateLoading(e)},this.schedule(this.m_TaskScheduler,0,cc.macro.REPEAT_FOREVER,0))},u.prototype.StopTaskScheduler=function(){null!==this.m_TaskScheduler&&(this.unschedule(this.m_TaskScheduler),this.m_TaskScheduler=null)},u.prototype.UpdateLoading=function(e){for(;0<this.TaskQueue.Count;)if(this.RunningTaskQueue.Enqueue(this.TaskQueue.Dequeue().Run()),--e<=0)return;if(0<this.RunningTaskQueue.Count)this.RunningTaskQueue.Remove(function(e){return e.IsCompleted()},function(e){return e.Return()});else if(this.StopTaskScheduler(),null!==this.CallbackQueue)for(;0<this.CallbackQueue.Count;)this.CallbackQueue.Dequeue()()},u.prototype.onDestroy=function(){this.StopTaskScheduler(),null!==this._m_TaskQueue&&this._m_TaskQueue.Return(),null!==this._m_RunningTaskQueue&&this._m_RunningTaskQueue.Return(),null!==this._m_CallbackQueue&&this._m_CallbackQueue.Return()},u);function u(){let e=null!==r&&r.apply(this,arguments)||this;return e._m_TaskQueue=null,e._m_RunningTaskQueue=null,e.m_TaskScheduler=null,e._m_CallbackQueue=null,e}t.TaskComponent=s}(t=e.task||(e.task={}))}(numas=numas||{}),function(e){var t=(n.TimeStamp2Date=function(e){return new Date(1e3*e)},n.Date2TimeStamp=function(e){return Math.floor(e.getTime()/1e3)},n.getTimeStamp=function(){return Math.floor((new Date).getTime()/1e3)},n.getMilliTimeStamp=function(){return(new Date).getTime()},n.IsSameDay=function(e,t){return e.toDateString()===t.toDateString()},n.IsSameDayTimeStamp=function(e,t){return this.IsSameDay(this.TimeStamp2Date(e),this.TimeStamp2Date(t))},n.zeroHourOfTimeStamp=function(e){return this.zeroHourTimeStampOfDate(this.TimeStamp2Date(e))},n.zeroHourTimeStampOfDate=function(e){return this.Date2TimeStamp(e)-(3600*e.getHours()+60*e.getMinutes()+e.getSeconds())},n.tomorrowTimeStamp=function(e){return this.zeroHourOfTimeStamp(e+86400)},n.tomorrowTimeStampOfDate=function(e){return this.tomorrowTimeStamp(this.Date2TimeStamp(e))},n.IsToday=function(e){return this.IsSameDayTimeStamp(e,this.getTimeStamp())},n.IsBeforToday=function(e){return!this.IsToday(e)&&e<this.getTimeStamp()},n.Format=function(e,t,n){var i,o;return void 0===t&&(t="hh:mm:ss"),void 0===n&&(n=!1),-1!=t.indexOf("dd")&&(e-=86400*(i=Math.floor(e/86400)),i=n||9<i?""+i:"0"+i,t=t.replace("dd",i)),-1!=t.indexOf("hh")&&(e-=3600*(o=Math.floor(e/3600)),o=n||9<o?""+o:"0"+o,t=t.replace("hh",o)),-1!=t.indexOf("mm")&&(e-=60*(o=Math.floor(e/60)),o=n||9<o?""+o:"0"+o,t=t.replace("mm",o)),-1!=t.indexOf("ss")&&(e=Math.floor(e),e=n||9<e?""+e:"0"+e,t=t.replace("ss",e)),t},n);function n(){}e.date=t}(numas=numas||{}),function(e){let t;(e=t=e.Dir||(e.Dir={}))[e.Right=0]="Right",e[e.Top=1]="Top",e[e.Left=2]="Left",e[e.Bottom=3]="Bottom"}(numas=numas||{}),function(e){var t,n=(t=e.BaseUIComp,__extends(i,t),i.prototype.GetUPH=function(){return this._$uph_},i.prototype.GetResKey=function(){return this._$uph_.GetResKey()},i.prototype.$__i_InitByUPH=function(e){this._$uph_=e,this.OnCreate()},i.prototype.$__i_CloseByUPH=function(){this._$isOpening_?console.error("UIPanel >> Open "+this.name+" \u65f6\u8c03\u7528\u4e86\u5173\u95ed\uff0c\u8fd9\u662f\u4e0d\u5141\u8bb8\u7684\u903b\u8f91"):(this._$isOpened_=!1,this.OnRelease(),this.__i_CloseAllAutoCloseUIComp())},i.prototype.$__i_OnOpen=function(e){this._$isOpened_?console.error("UIPanel >> \u5df2\u7ecf\u5904\u4e8e\u6253\u5f00\u72b6\u6001\uff0c\u4e0d\u5e94\u8be5\u91cd\u590d\u8c03\u7528\u6b64\u65b9\u6cd5"):(this._$isOpened_=!0,this._$isOpening_=!0,this.args=e,this.OnOpen(e),this._$isOpening_=!1)},i.prototype.Close=function(){this.TryNotifyGuideEvent(),e.UIMgr.ins.Close(this)},i.prototype.BindBV=function(e,t,n){e.Bind(t,n,this),this._m_BVList_.push(e)},i.prototype.UnbindAllBV=function(){for(;0<this._m_BVList_.length;)this._m_BVList_.pop().TargetUnbind(this)},i.prototype.onDestroy=function(){this._$isOpened_&&console.warn("\u4e0d\u89c4\u8303\u7684\u8c03\u7528\u65b9\u5f0f >> \u672a\u8c03\u7528 "+this.name+".Close() \u65b9\u6cd5\u8fdb\u884c\u5bf9\u8c61\u7684\u79fb\u9664"),this.UnbindAllBV(),this.__i_CloseAllAutoCloseUIComp(),t.prototype.onDestroy.call(this)},i.prototype.SetGuideNotificationActive=function(e){this._guideNotify=e},i.prototype.TryNotifyGuideEvent=function(){var t;this._guideNotify&&(t="guide.ui.close."+this.GetResKey(),console.info("\u5f15\u5bfc >> \u5168\u5c40\u5173\u95ed\u6d88\u606f >> \u6d3e\u53d1 "+t),e.EventCenter.ins.emit(t))},i.prototype.__i_AutoCloseUIComp=function(e){return this._I_AutoCloseUICompQueue.Enqueue(e),e},Object.defineProperty(i.prototype,"_I_AutoCloseUICompQueue",{get:function(){return null===this._i_UICompQueue&&(this._i_UICompQueue=e.AnyQueue.Borrow()),this._i_UICompQueue},enumerable:!1,configurable:!0}),i.prototype.__i_CloseAllAutoCloseUIComp=function(){null!==this._i_UICompQueue&&(this._i_UICompQueue.RemoveAll(function(e){return e.Close()}),this._i_UICompQueue.Return(),this._i_UICompQueue=null)},i);function i(){let e=null!==t&&t.apply(this,arguments)||this;return e.args=null,e._$isOpened_=!1,e._$isOpening_=!1,e._$uph_=null,e._m_BVList_=[],e._guideNotify=!1,e._i_UICompQueue=null,e}e.UIPanel=n}(numas=numas||{}),function(e){let t;!function(t){t.Event={DRAG_START:"ii.guide.DRAG_START",DRAG_END:"ii.guide.DRAG_END"},t.ActionType={fade:"fade",up_down:"up_down"},t.PositionType={related_to_node_id:"related_to_node_id"};let n=(Object.defineProperty(i.prototype,"NextStep",{get:function(){return this.m_NextStepOnceFunc},enumerable:!1,configurable:!0}),i.prototype.GetV=function(e){for(let t=0;t<this.m_Data.kv.length;++t)if(this.m_Data.kv[t].k==e)return this.m_Data.kv[t].v;console.error('[Error] k: "'+e+'" has no config in "'+this.typ+"\"'s kv")},i.prototype.GetVWithDefault=function(e,t){for(let n=0;n<this.m_Data.kv.length;++n)if(this.m_Data.kv[n].k==e)return this.m_Data.kv[n].v;return t},Object.defineProperty(i.prototype,"typ",{get:function(){return this.m_Data.typ},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"kv",{get:function(){return this.m_Data.kv},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"args",{get:function(){return this.GetVWithDefault("args",null)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"click_bg",{get:function(){return this.GetVWithDefault("click_bg",!1)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"color",{get:function(){return this.GetVWithDefault("color",0)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"col_row",{get:function(){return this.GetV("col_row")},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"dir",{get:function(){return this.GetV("dir")},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"dx",{get:function(){return this.GetV("dx")},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"dy",{get:function(){return this.GetV("dy")},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"enter_action",{get:function(){return this.GetV("enter_action")},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"exit_action",{get:function(){return this.GetV("exit_action")},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"path_action",{get:function(){return this.GetV("path_action")},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"position",{get:function(){return this.GetV("position")},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"res_key",{get:function(){return this.GetVWithDefault("res_key",null)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"text",{get:function(){return this.GetV("text")},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"time",{get:function(){return this.GetV("time")},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"tiles",{get:function(){return this.GetV("tiles")},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"node_id",{get:function(){return this.GetV("node_id")},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"next_step_event",{get:function(){return this.GetV("next_step_event")},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"x",{get:function(){return this.GetVWithDefault("x",0)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"y",{get:function(){return this.GetVWithDefault("y",0)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"z",{get:function(){return this.GetVWithDefault("z",0)},enumerable:!1,configurable:!0}),i.prototype.GetNodePosition=function(e,t){return this.m_Helper.GetNodePosition(e,t)},i.prototype.CheckColRow=function(e){if("check_col_row"!==this.typ)return!1;var t=this.col_row;return(e=t.col==e.col&&t.row==e.row)&&this.NextStep(),e},i);function i(e,t,n){this.m_Data=null,this.m_Helper=null,this.m_NextStepOnceFunc=null,this.m_Data=e,this.m_Helper=t,this.m_NextStepOnceFunc=n}t.Step=n;let o=(r.Run=function(e,t,n){switch(t.typ){case"fade":return this.RunFadeAction(e,t,n);case"up_down":return this.RunUpDownAction(e,t);default:throw new Error("\u672a\u5904\u7406\u7684\u52a8\u4f5c\u7c7b\u578b "+t.typ)}},r.RunFadeAction=function(t,n,i){return t.opacity=n.from,cc.tween(t).delay(n.delay).to(n.duration,{opacity:n.to}).call(function(){return e.Util.safeCall(i)}).start()},r.RunUpDownAction=function(e,t){return e.position=new cc.Vec3(e.position.x,t.from,e.position.z),t=cc.tween(e).to(t.duration,{y:t.to}).to(t.duration,{y:t.from}).to(t.duration,{y:t.to}).to(t.duration,{y:t.from}).delay(t.delay),cc.tween(e).repeatForever(t).start()},r);function r(){}t.ActionUtil=o;var s,u=(s=e.UIPanel,__extends(a,s),Object.defineProperty(a.prototype,"Delegate",{get:function(){return this.args.delegate},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"stepDatas",{get:function(){return this.args.guideData.steps},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"Step",{get:function(){return this._step},enumerable:!1,configurable:!0}),a.prototype.OnCreate=function(){this.Background.opacity=0,this.OnCreateSelf(),e.EventCenter.ins.on(t.Event.DRAG_START,this.Finger.OnDragStart.bind(this.Finger),this),e.EventCenter.ins.on(t.Event.DRAG_END,this.Finger.OnDragEnd.bind(this.Finger),this)},a.prototype.OnOpen=function(){var t=this;(this.args.guideCtrl.GuidePlayer=this).SetBackgroundClickHandler(function(){null!=t.m_OnBackgroundClick_&&(e.AudioMgr.ins.PlayEffect(),t.m_OnBackgroundClick_())}),this.OnOpenSelf(),this._bInitNextStep=!0,this.nextStep()},a.prototype.OnRelease=function(){this.OnReleaseSelf()},a.prototype.onDestroy=function(){e.EventCenter.ins.targetOff(this),this.m_NodeParentMap.clear(),this.m_NodeParentMap=null,s.prototype.onDestroy.call(this)},a.prototype.nextStep=function(){if(this._bInitNextStep){if(this._stepIndex+1>=this.stepDatas.length)return this.Delegate.OnGuideFinished(),this.args.onCompleted(),void this.Close();++this._stepIndex;var t=this.stepDatas[this._stepIndex];this._step=new n(t,this,e.Util.onceCall(this.nextStep.bind(this),1)),this.__doStep(this._step)}else console.error("\u53ea\u80fd\u5728 OnOpen \u4e4b\u540e\u8c03\u7528 nextStep")},a.prototype.__doStep=function(t){var n=this;switch(t.typ){case"delay":this.scheduleOnce(t.NextStep,t.time);break;case"transfer":{var i=t.node_id;let n=this.Delegate.OnGuideGetNode(i);this.m_NodeParentMap.set(i,n.parent),e.UIUtil.transferTo(n,this.TransferRoot,!1),n.zIndex=t.z,t.NextStep()}break;case"transfer_back":var r=t.node_id;i=this.Delegate.OnGuideGetNode(r),e.UIUtil.transferTo(i,this.m_NodeParentMap.get(r),!1),t.NextStep();break;case"show_bg":this.Background.opacity=0,o.Run(this.Background,t.enter_action,t.NextStep);break;case"hide_bg":o.Run(this.Background,t.exit_action,t.NextStep);break;case"dialog":r=e.Util.onceCall(function(){n.m_OnBackgroundClick_=null,n.Dialog.node.active=!1,t.NextStep()},1),t.click_bg&&(this.m_OnBackgroundClick_=r),this.Dialog.node.active=!0,this.Dialog.node.position=this.GetNodePosition(this.Dialog.node,t.position),this.Dialog.Show(t,r);break;case"finger":this.Finger.node.active=!0,this.Finger.Show(t),t.NextStep();break;case"hide_finger":this.Finger.Hide(),t.NextStep();break;case"open_ui":e.EventCenter.ins.once(t.next_step_event,function(){console.info("\u5f15\u5bfc >> \u5168\u5c40\u5173\u95ed\u6d88\u606f >> \u5904\u7406 "+t.next_step_event),t.NextStep()},this),e.UIMgr.ins.Open(t.res_key,t.args);break;case"audio":e.AudioMgr.ins.PlayEffect(t.res_key),t.NextStep();break;default:this.Delegate.OnGuideStep(t)}},a.prototype.GetNodePosition=function(e,t){if("related_to_node_id"===t.typ){let i=this.Delegate.OnGuideGetNode(t.node_id);var n=new cc.Vec3(i.position.x+t.dx,i.position.y+t.dy,i.position.z);return e.parent.convertToNodeSpaceAR(i.parent.convertToWorldSpaceAR(n))}console.error("Guide >> \u672a\u5904\u7406\u7684\u4f4d\u7f6e\u7c7b\u578b typ = "+t.typ)},a);function a(){let e=null!==s&&s.apply(this,arguments)||this;return e._stepIndex=-1,e._bInitNextStep=!1,e._step=null,e.m_OnBackgroundClick_=null,e.m_NodeParentMap=new Map,e}function l(e,t){this._guideKey=null,this._delegate=null,this._guidePlayer=null,this._guideKey=e,this._delegate=t}t.GuidePlayerUIPanel=u,l.GetIsGuiding=function(e){return!!this._playingDict.has(e)&&this._playingDict.get(e)},l.SetIsGuiding=function(e,t){this._playingDict.set(e,t)},l.Create=function(e,t){return new l(e,t)},l.prototype.Release=function(){},l.prototype.IsGuided=function(){return e.UserLSMgr.ins.getBoolWithDefault(this._guideKey,!1)},Object.defineProperty(l.prototype,"IsGuiding",{get:function(){return l.GetIsGuiding(this._guideKey)},enumerable:!1,configurable:!0}),l.prototype.StartGuide=function(t,n){console.assert(!this.IsGuiding,"\u9519\u8bef\u7684\u8c03\u7528\u903b\u8f91 >> \u5df2\u7ecf\u5728\u64ad\u653e\u5f15\u5bfc\u4e86\uff01"),l.SetIsGuiding(this._guideKey,!0),e.UIMgr.ins.Open(t,{guideCtrl:this,delegate:this._delegate,guideData:n,onCompleted:this.FinishGuide.bind(this)})},l.prototype.FinishGuide=function(){l.SetIsGuiding(this._guideKey,!1),e.UserLSMgr.ins.setBool(this._guideKey,!0,!0)},Object.defineProperty(l.prototype,"GuidePlayer",{get:function(){return this._guidePlayer},set:function(e){this._guidePlayer=e},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"Step",{get:function(){return this._guidePlayer.Step},enumerable:!1,configurable:!0}),l._playingDict=new Map,u=l,t.GuideCtrl=u}(t=e.guide||(e.guide={}))}(numas=numas||{}),function(e){var t=(n.Borrow=function(){return e.ReferencePool.Borrow(n)},n.prototype.Return=function(){e.ReferencePool.Return(n,this)},n.prototype.Reset=function(){},n.prototype.Init=function(e,t){return this.col=e,this.row=t,this},n);function n(){this.col=0,this.row=0}e.Tile=t}(numas=numas||{}),function(e){var t=(n.xxxx=function(){},n);function n(){}e.HttpUtil=t}(numas=numas||{}),function(e){var t=(n.Get=function(e,t,n,i){this.request(e,t,"GET",n,i)},n.Post=function(e,t,n,i){this.request(e,t,"POST",n,i)},n.request=function(e,t,n,i,o){window.wx.request({url:e,data:t,header:{"content-type":"application/json"},method:n,success:function(e){i(e.data)},fail:function(e){o(e)}})},n);function n(){}e.HttpWeChatUtil=t}(numas=numas||{}),function(e){var t=(n.IsWifi=function(){return cc.sys.getNetworkType()==cc.sys.NetworkType.LAN},n);function n(){}e.NetUtil=t}(numas=numas||{}),function(e){var t,n=(t=e.UIPanel,__extends(i,t),i.prototype.OnOpen=function(e){this.OnOpenLoadingAD(e)},i);function i(){return null!==t&&t.apply(this,arguments)||this}e.ALoadingADUIPanel=n}(numas=numas||{}),function(e){var t=(Object.defineProperty(n,"IsiOS",{get:function(){return cc.sys.platform==cc.sys.IPHONE||cc.sys.platform==cc.sys.IPAD},enumerable:!1,configurable:!0}),Object.defineProperty(n,"IsWechat",{get:function(){return cc.sys.platform===cc.sys.WECHAT_GAME},enumerable:!1,configurable:!0}),n.OpenAppStore=function(e){this.IsiOS&&cc.sys.openURL("itms-apps://itunes.apple.com/app/id"+e.iOS.AppId)},n);function n(){}e.PlatformUtil=t}(numas=numas||{}),function(e){var t,n=(t=e.BaseComp,__extends(i,t),i.prototype.Init=function(e){if(this._isInit)throw new Error("SDKBase >> \u91cd\u590d\u7684\u521d\u59cb\u5316\uff01");return this.sdkCfg=e,this.OnInit(e),this},i);function i(){let e=null!==t&&t.apply(this,arguments)||this;return e._isInit=!1,e.sdkCfg=null,e}e.SDKBase=n}(numas=numas||{}),function(e){var t,n=(t=e.SDKBase,__extends(i,t),i.prototype.IsInitByScript=function(){return this.m_InitByScript},i.prototype.InitByScript=function(){this.m_InitByScript||(this.m_InitByScript=!0,this.InitByScriptImpl(),this.__i_StartADTick())},i.prototype.ShowBanner=function(e){this.m_InitByScript&&(this.IsAdRemoved()||this.ShowBannerImpl(e))},i.prototype.IsInterstitialAvailable=function(){return!!this.m_InitByScript&&this.IsInterstitialAvailableImpl()},i.prototype.LoadInterstitial=function(){this.m_InitByScript&&this.LoadInterstitialImpl()},i.prototype.LoadInterstitialIfNotAvalable=function(){this.IsAdRemoved()||this.IsInterstitialAvailable()||this.LoadInterstitial()},i.prototype.ShowInterstitialWithBlocker=function(t,n,i){var o=this;this.IsAdRemoved()?e.Util.safeCall(t):this.IsInterstitialAvailable()?e.UIMgr.ins.Open(n,{duration:i,cb:function(){return o.__ShowInterstitial(t)}}):(this.LoadInterstitialIfNotAvalable(),e.Util.safeCall(t))},i.prototype.ShowInterstitial=function(t){this.IsAdRemoved()?e.Util.safeCall(t):this.IsInterstitialAvailable()?this.__ShowInterstitial(t):(this.LoadInterstitialIfNotAvalable(),e.Util.safeCall(t))},i.prototype.__ShowInterstitial=function(t){var n=this;let i=e.Util.onceCall(function(){e.Util.safeCall(t),n.LoadInterstitialIfNotAvalable()},1);this.ShowInterstitialImpl(function(t){switch(t){case e.EInterstitial.NOT_AVAILABLE:case e.EInterstitial.SHOW_ERROR:case e.EInterstitial.HIDE:i()}})},i.prototype.IsRewardedVideoAvailable=function(){return!!this.m_InitByScript&&this.IsRewardedVideoAvailableImpl()},i.prototype.ShowRewardedVideo=function(t){if(this.IsRewardedVideoAvailable()){let n=e.Util.onceCall(t,2);this.ShowRewardedVideoImpl(function(t,i){switch(t){case e.EInternalRewardedVideo.REWARDED:case e.EInternalRewardedVideo.HIDE:i&&n()}})}},i.prototype.ShowRewardedVideoEx=function(t){var n=this;if(this.IsRewardedVideoAvailable()){this.m_Tmp_IsReceivedRewardedEvent=!1,this.m_Tmp_IsReceivedHideEvent=!1;let i=e.Util.onceCall(function(){return t(e.ERewardedVideo.NOT_AVAILABLE,!1)},1),o=e.Util.onceCallEx(function(n){return t(e.ERewardedVideo.HIDE,n)},1);this.ShowRewardedVideoImpl(function(r,s){switch(r){case e.EInternalRewardedVideo.NOT_AVAILABLE:case e.EInternalRewardedVideo.SHOW_ERROR:i();break;case e.EInternalRewardedVideo.SHOW:t(e.ERewardedVideo.SHOW,!1);break;case e.EInternalRewardedVideo.HIDE:n.m_Tmp_IsReceivedRewardedEvent?o(s):(n.m_Tmp_IsReceivedHideEvent=!0,s?o(s):n.scheduleOnce(function(){o(s)},.05));break;case e.EInternalRewardedVideo.REWARDED:n.m_Tmp_IsReceivedHideEvent?o(s):n.m_Tmp_IsReceivedRewardedEvent=!0}})}else t(e.ERewardedVideo.NOT_AVAILABLE,!1)},i.prototype.RemoveAdsForSeconds=function(e){this.IsAdRemoved()||this.ShowBanner(!1),this.RemoveAdsSecondsBV.v+=e,this.__i_StartADTick()},i.prototype.__i_StartADTick=function(){0<this.RemoveAdsSecondsBV.v&&this.StartScheduler("__I_AD_TICK",this.__I_AD_TICK.bind(this),1,cc.macro.REPEAT_FOREVER)},i.prototype.__I_AD_TICK=function(){--this.RemoveAdsSecondsBV.v,0===this.RemoveAdsSecondsBV.v&&this.StopScheduler("__I_AD_TICK")},i.prototype.IsAdRemoved=function(){return 0<this.RemoveAdsSecondsBV.v},i);function i(){let n=null!==t&&t.apply(this,arguments)||this;return n.RewardedVideoBV=e.BooleanBV.Borrow(!1),n.RemoveAdsSecondsBV=e.NumberBV.BorrowAsLS("ls_remove_ads_seconds",0,!0),n.m_InitByScript=!1,n.m_Tmp_IsReceivedRewardedEvent=!1,n.m_Tmp_IsReceivedHideEvent=!1,n}e.ADBase=n}(numas=numas||{}),function(e){var t,n=(t=cc.Component,__extends(i,t),i.prototype.Init=function(e){if(this._isInit)throw new Error("PlatformBase >> \u91cd\u590d\u7684\u521d\u59cb\u5316\uff01");return this.sdkCfg=e,this._user=this.addComponent(this.GetUserClass()),this._user.Init(this.sdkCfg),this._ad=this.addComponent(this.GetADClass()),this._ad.Init(this.sdkCfg),this._vibrate=this.addComponent(this.GetVibrateClass()),this._vibrate.Init(this.sdkCfg),this},Object.defineProperty(i.prototype,"user",{get:function(){return this._user},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"ad",{get:function(){return this._ad},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"vibrate",{get:function(){return this._vibrate},enumerable:!1,configurable:!0}),i);function i(){let e=null!==t&&t.apply(this,arguments)||this;return e._isInit=!1,e.sdkCfg=null,e._user=null,e._ad=null,e._vibrate=null,e}e.PlatformBase=n}(numas=numas||{}),function(e){var t,n=(t=e.SDKBase,__extends(i,t),i.prototype.OnInit=function(){this.UserDefaultServerLoginHelper()},Object.defineProperty(i.prototype,"uid",{get:function(){return this.m_UserId},enumerable:!1,configurable:!0}),i.prototype.UserDefaultServerLoginHelper=function(){this._serverLoginHelper=new e.DefaultServerLoginHelper},i.prototype.LoginServer=function(t,n){var i=this;this._serverLoginHelper?this._serverLoginHelper.Login(t,function(t){i.m_UserId=t.success?t.uid:e.Cfg.DefaultUserKey,e.UserLSMgr.ins.setUserId(i.uid),t.success?(i.StartGameTimeScheduler(),i.OnLoginServerSuccess()):(i.StopGameSimeScheduler(),i.OnLoginServerFailed()),n(t)}):console.error("UserBase::Login >> \u8bf7\u5148\u4f7f\u7528 SetHelper(loginHelper: IServerLoginHelper) \u8bbe\u7f6e IServerLoginHelper")},i.prototype.Key2UserKey=function(e,t){return e+"_"+t},i.prototype.DevKey2RealKey=function(t){return e.CfgUtil.k2v(this.GetGameCenterCfg().Ranks,t)},i.prototype.RealKey2DevKey=function(t){return e.CfgUtil.v2k(this.GetGameCenterCfg().Ranks,t)},i.prototype.GetGameCenterBV=function(t,n){var i=this;if(t=this.Key2UserKey(t,n),this.m_Dict.has(t))return this.m_Dict.get(t);{let o=e.MaxNumberBV.BorrowAsLS(t,0,!0);return this.m_Dict.set(t,o),o.Bind(function(e){i.ReportScoreWithDevKey(n,e)},!1,this),o}},i.prototype.ReportScoreWithDevKey=function(e,t){this.ReportScore(this.DevKey2RealKey(e),t)},i.prototype.GetGameCenterVal=function(e){return this.GetGameCenterBV(this.uid,e).v},i.prototype.SetGameCenterVal=function(e,t){this.GetGameCenterBV(this.uid,e).v=t},i.prototype.UploadGameTime=function(){null!==this.m_ToUploadGameTimeLS&&0<this.m_ToUploadGameTimeLS.v&&(this.SetGameCenterVal("GameTime",this.GetGameCenterVal("GameTime")+this.m_ToUploadGameTimeLS.v),this.m_ToUploadGameTimeLS.v=0)},i.prototype.StartGameTimeScheduler=function(){null===this.m_GameTimeScheduler&&(this.m_GameTimeScheduler=this.GameTimeTick.bind(this),this.m_ToUploadGameTimeLS=e.NumberBV.BorrowAsUserLS("ii_user_touploadtime",0,!0),this.schedule(this.m_GameTimeScheduler,this.TIME_INC_INTERVAL,cc.macro.REPEAT_FOREVER))},i.prototype.StopGameSimeScheduler=function(){var e;null!==this.m_GameTimeScheduler&&(e=this.m_GameTimeScheduler,this.m_GameTimeScheduler=null,this.unschedule(e),null!==this.m_ToUploadGameTimeLS&&this.m_ToUploadGameTimeLS.Return())},i.prototype.GameTimeTick=function(){this.m_ToUploadGameTimeLS.v+=this.TIME_INC_INTERVAL,59<=this.m_ToUploadGameTimeLS.v&&this.UploadGameTime()},i);function i(){let n=null!==t&&t.apply(this,arguments)||this;return n.m_UserId=e.Cfg.DefaultUserKey,n._serverLoginHelper=null,n.m_Dict=new Map,n.m_ToUploadGameTimeLS=null,n.m_GameTimeScheduler=null,n.TIME_INC_INTERVAL=7,n}e.UserBase=n}(numas=numas||{}),function(e){var t,n=(t=e.SDKBase,__extends(i,t),Object.defineProperty(i.prototype,"off",{get:function(){return this._off},enumerable:!1,configurable:!0}),i.prototype.Toggle=function(){return this._off.v=!this._off.v,this._off.v},i.prototype.OnInit=function(){this._off=e.BooleanBV.BorrowAsLS("ll_vibrate_off",!1,!1)},i.prototype.Default=function(){this._off.v||this.DefaultImpl()},i);function i(){let e=null!==t&&t.apply(this,arguments)||this;return e._off=null,e}e.VibrateBase=n}(numas=numas||{}),function(e){var t=(n.k2v=function(e,t){if(null!=e)for(let n=e.length-1;0<=n;--n)if(e[n].k===t)return e[n].v;return null},n.v2k=function(e,t){if(null!=e)for(let n=e.length-1;0<=n;--n)if(e[n].v===t)return e[n].k;return null},n);function n(){}e.CfgUtil=t}(numas=numas||{}),function(e){let t;var n;let i,o;(n=t=e.EInterstitial||(e.EInterstitial={}))[n.NOT_AVAILABLE=0]="NOT_AVAILABLE",n[n.LOAD_ERROR=1]="LOAD_ERROR",n[n.SHOW=2]="SHOW",n[n.SHOW_ERROR=3]="SHOW_ERROR",n[n.CLICK=4]="CLICK",n[n.HIDE=5]="HIDE",(n=i=e.EInternalRewardedVideo||(e.EInternalRewardedVideo={}))[n.NOT_AVAILABLE=0]="NOT_AVAILABLE",n[n.SHOW_ERROR=1]="SHOW_ERROR",n[n.SHOW=2]="SHOW",n[n.HIDE=3]="HIDE",n[n.REWARDED=4]="REWARDED",(e=o=e.ERewardedVideo||(e.ERewardedVideo={}))[e.NOT_AVAILABLE=0]="NOT_AVAILABLE",e[e.SHOW=1]="SHOW",e[e.HIDE=2]="HIDE"}(numas=numas||{}),function(e){var t=(n.prototype.Login=function(e,t){setTimeout(function(){t({success:!0,uid:e.openid})},.1)},n);function n(){}e.DefaultServerLoginHelper=t}(numas=numas||{}),function(e){var t,n="org/cocos2dx/javascript/NMProxyAD",i=(t=e.ADBase,__extends(o,t),o.prototype.IsSupport=function(){return!0},o.prototype.InitByScriptImpl=function(){jsb.reflection.callStaticMethod(n,"initByScript","()V")},o.prototype.OnInit=function(){},o.prototype.ShowBannerImpl=function(e){e?jsb.reflection.callStaticMethod(n,"ShowBanner","()V"):jsb.reflection.callStaticMethod(n,"HideBanner","()V")},o.prototype.DestroyBanner=function(){jsb.reflection.callStaticMethod(n,"DestroyBanner","()V")},o.prototype.IsInterstitialAvailableImpl=function(){return jsb.reflection.callStaticMethod(n,"IsInterstitialAvailable","()Z")},o.prototype.LoadInterstitialImpl=function(){jsb.reflection.callStaticMethod(n,"LoadInterstitial","()V")},o.prototype.ShowInterstitialImpl=function(){jsb.reflection.callStaticMethod(n,"ShowInterstitial","()V")},o.prototype.IsRewardedVideoAvailableImpl=function(){return jsb.reflection.callStaticMethod(n,"IsRewardedVideoAvailable","()Z")},o.prototype.ShowRewardedVideoImpl=function(){jsb.reflection.callStaticMethod(n,"ShowRewardedVideo","()V")},o);function o(){return null!==t&&t.apply(this,arguments)||this}e.AndroidIronSource=i}(numas=numas||{}),function(e){var t,n=(t=e.ADBase,__extends(i,t),i.prototype.__I_SetRewardedVideoAvailable=function(e){this._i_RewardedVideoAvailable=e,this.RewardedVideoBV.v=e},i.prototype.IsSupport=function(){return!0},i.prototype.OnInit=function(){},i.prototype.ShowBannerImpl=function(e){console.info("DefaultAD >> "+(e?"\u663e\u793a\u6a2a\u5e45\u5e7f\u544a":"\u9690\u85cf\u6a2a\u5e45\u5e7f\u544a"))},i.prototype.IsInterstitialAvailableImpl=function(){return!1},i.prototype.LoadInterstitialImpl=function(){},i.prototype.ShowInterstitialImpl=function(t){t(e.EInterstitial.NOT_AVAILABLE)},i.prototype.IsRewardedVideoAvailableImpl=function(){return this._i_RewardedVideoAvailable},i.prototype.ShowRewardedVideoImpl=function(t){var n=this;this._i_RewardedVideoAvailable?(t(e.EInternalRewardedVideo.SHOW,!1),t(e.EInternalRewardedVideo.REWARDED,!0),t(e.EInternalRewardedVideo.HIDE,!0),this.__I_SetRewardedVideoAvailable(!1),this.scheduleOnce(function(){n.__I_SetRewardedVideoAvailable(!0)},2)):t(e.EInternalRewardedVideo.NOT_AVAILABLE,!1)},i.prototype.InitByScriptImpl=function(){var e=this;this.scheduleOnce(function(){e.__I_SetRewardedVideoAvailable(!0)},2)},i);function i(){let e=null!==t&&t.apply(this,arguments)||this;return e._i_RewardedVideoAvailable=!1,e}e.DefaultAD=n}(numas=numas||{}),function(e){var t,n=(t=e.PlatformBase,__extends(i,t),i.prototype.GetUserClass=function(){return e.DefaultUser},i.prototype.GetADClass=function(){return e.DefaultAD},i.prototype.GetVibrateClass=function(){return e.DefaultVibrate},i);function i(){return null!==t&&t.apply(this,arguments)||this}e.DefaultPlatform=n}(numas=numas||{}),function(e){var t,n=(t=e.UserBase,__extends(i,t),i.prototype.IsAuthedUserInfo=function(){return!0},i.prototype.AuthUserInfo=function(e,t){t()},i.prototype.LoginPlatform=function(e){e({success:!0,openid:"dev_openid"})},i.prototype.ReportScore=function(){},i.prototype.GetGameCenterCfg=function(){return this.sdkCfg.iOS.GameCenter},i.prototype.OnLoginServerSuccess=function(){},i.prototype.OnLoginServerFailed=function(){},i.prototype.FiveStar=function(){},i.prototype.IsSupportLeaderboard=function(){return!1},i.prototype.ShowDefaultLeaderboard=function(){},i.prototype.IsSupportRateUsByOpenUrl=function(){return!1},i.prototype.RateUsByOpenUrl=function(){},i.prototype.IsSupportContactUs=function(){return!1},i.prototype.ContactUs=function(){},i);function i(){return null!==t&&t.apply(this,arguments)||this}e.DefaultUser=n}(numas=numas||{}),function(e){var t,n=(t=e.VibrateBase,__extends(i,t),i.prototype.DefaultImpl=function(){},i);function i(){return null!==t&&t.apply(this,arguments)||this}e.DefaultVibrate=n}(numas=numas||{}),function(e){var t,n=(t=e.ADBase,__extends(i,t),i.prototype.IsSupport=function(){return!1},i.prototype.InitByScriptImpl=function(){console.warn("// WeChatAD >> InitByScriptImpl")},i.prototype.OnInit=function(){},i.prototype.ShowBannerImpl=function(){console.warn("// WeChatAD >> ShowBannerImpl")},i.prototype.IsInterstitialAvailableImpl=function(){return console.warn("// WeChatAD >> IsInterstitialAvailableImpl"),!1},i.prototype.LoadInterstitialImpl=function(){console.warn("// WeChatAD >> LoadInterstitialImpl")},i.prototype.ShowInterstitialImpl=function(t){console.warn("// WeChatAD >> ShowInterstitialImpl"),t(e.EInterstitial.NOT_AVAILABLE)},i.prototype.IsRewardedVideoAvailableImpl=function(){return console.warn("// WeChatAD >> IsRewardedVideoAvailableImpl"),!1},i.prototype.ShowRewardedVideoImpl=function(t){console.warn("// WeChatAD >> ShowRewardedVideoImpl"),t(e.EInternalRewardedVideo.NOT_AVAILABLE,!1)},i);function i(){return null!==t&&t.apply(this,arguments)||this}e.WeChatAD=n}(numas=numas||{}),function(e){let t;(n=t=e.WeChatAuthScope||(e.WeChatAuthScope={}))[n.userInfo=0]="userInfo",n[n.writePhotosAlbum=1]="writePhotosAlbum";var n=(i.IsAuthed=function(e){var t=this;let n=!1;return this.GetSetting(function(i){n=t.__IsAuth(i.authSetting,e)},function(){n=!1}),n},i.AuthUserInfo=function(n,i,o){this.IsAuthed(t.userInfo)?e.Util.safeCall(i):this.__AuthUserInfo(n,i,o)},i.GetSetting=function(t,n){window.wx.getSetting({success:function(e){t(e)},fail:function(){console.error("WeChatUtil >> Auth::getSetting failed."),e.Util.safeCall(n)}})},i.__IsAuth=function(e,n){if(!e)return!1;let i=null;switch(n){case t.userInfo:i="scope.userInfo";break;case t.writePhotosAlbum:i="scope.writePhotosAlbum";break;default:throw new Error("WeChatUtil >> __Typ2AuthSettingKey: \u672a\u5904\u7406\u7684\u6388\u6743\u7c7b\u578b typ = "+n)}return e[i]},i.__AuthUserInfo=function(t,n,i){let o=0,r=0,s=0,u=0;(t=t&&this.convertToWxPos(t))&&(o=t.left,r=t.top,s=t.width,u=t.height);let a=window.wx.createUserInfoButton({type:"image",image:"",style:{left:o,top:r,width:s,height:u,lineHeight:40,borderColor:"#00000000",borderWidth:0,backgroundColor:"#00000000",color:"#ffffffff",textAlign:"center",fontSize:16,borderRadius:4}});a.onTap(function(t){cc.isValid(a)&&a.destroy(),t.userInfo?e.Util.safeCall(n):e.Util.safeCall(i)})},i.convertToWxPos=function(e){if(!e)return null;var t=e.convertToWorldSpaceAR(cc.v2(-e.width*e.anchorX,-e.height*e.anchorY)),n=e.convertToWorldSpaceAR(cc.v2(e.width*(1-e.anchorX),e.height*(1-e.anchorY))),i=cc.view.getFrameSize();return e=cc.view.getVisibleSize(),{left:t.x/e.width*i.width,top:i.height-n.y/e.height*i.height,width:(n.x-t.x)/e.width*i.width,height:(n.y-t.y)/e.height*i.height}},i);function i(){}e.WeChatAuthUtil=n}(numas=numas||{}),function(e){var t,n=(t=e.PlatformBase,__extends(i,t),i.prototype.GetUserClass=function(){return e.WeChatUser},i.prototype.GetADClass=function(){return e.WeChatAD},i.prototype.GetVibrateClass=function(){return e.WeChatVibrate},i);function i(){return null!==t&&t.apply(this,arguments)||this}e.WeChatPlatform=n}(numas=numas||{}),function(e){var t,n=(t=e.UserBase,__extends(i,t),i.prototype.IsAuthedUserInfo=function(){return!0},i.prototype.AuthUserInfo=function(t,n,i){e.WeChatAuthUtil.AuthUserInfo(t,n,i)},i.prototype.LoginPlatform=function(t){t({success:!0,openid:e.Cfg.DefaultUserKey})},i.prototype.__GetUserInfo=function(){window.wx.getUserInfo({withCredentials:!1,success:function(e){(e=e.userInfo)&&(console.warn("\u83b7\u5f97\u7684\u7528\u6237\u4fe1\u606f >> \u6210\u529f"),console.warn(e))},fail:function(){console.warn("\u83b7\u5f97\u7684\u7528\u6237\u4fe1\u606f >> \u5931\u8d25")}})},i.prototype.OnLoginServerSuccess=function(){},i.prototype.OnLoginServerFailed=function(){},i.prototype.GetGameCenterCfg=function(){return this.sdkCfg.wx.GameCenter},i.prototype.ReportScore=function(){},i.prototype.FiveStar=function(){},i.prototype.IsSupportLeaderboard=function(){return!1},i.prototype.ShowDefaultLeaderboard=function(){},i.prototype.IsSupportRateUsByOpenUrl=function(){return!1},i.prototype.RateUsByOpenUrl=function(){},i.prototype.IsSupportContactUs=function(){return!1},i.prototype.ContactUs=function(){},i);function i(){return null!==t&&t.apply(this,arguments)||this}e.WeChatUser=n}(numas=numas||{}),function(e){var t,n=(t=e.VibrateBase,__extends(i,t),i.prototype.DefaultImpl=function(){this.vibrateShort("light")},i.prototype.vibrateShort=function(e){window.wx.vibrateShort({type:e})},i.prototype.vibrateLong=function(){window.wx.vibrateLong()},i);function i(){return null!==t&&t.apply(this,arguments)||this}e.WeChatVibrate=n}(numas=numas||{}),function(e){let t;(n=t=t||{}).AUTHORIZED="AUTHORIZED",n.DENIED="DENIED",n.RESTRICTED="RESTRICTED",n.NOT_DETERMINED="NOT_DETERMINED";var n=(Object.defineProperty(i,"ins",{get:function(){return null===this._ins&&(this._ins=new i),this._ins},enumerable:!1,configurable:!0}),i.prototype.Init=function(){var t=this;e.iOSMsgBridge.ins.on("NMEventATT",function(e){return t.iOSCallbackHandler(e)},this)},i.prototype.iOSCallbackHandler=function(e){"REQUEST_TRACKING_AUTHORIZATION"===e.event?this.HandleRequestTrackingAuthorizationResult(e):console.warn("Unhandled iOS Event >> "+e.event)},i.prototype.HandleRequestTrackingAuthorizationResult=function(e){if(null!==this.m_RequestIDFACallback){let n=this.m_RequestIDFACallback;this.m_RequestIDFACallback=null,n(e.status==t.AUTHORIZED)}},i.prototype.RequestTrackingAuthorization=function(t,n){this.m_RequestIDFACallback=e.Util.onceCall(t,1),jsb.reflection.callStaticMethod("NMProxyATT","RequestTrackingAuthorization:",n)},i._ins=null,i);function i(){this.m_RequestIDFACallback=null}e.iOSATT=n}(numas=numas||{}),function(e){var t=(Object.defineProperty(n,"ins",{get:function(){return null===this._ins&&(this._ins=new n),this._ins},enumerable:!1,configurable:!0}),n.prototype.Init=function(){var t=this;e.iOSMsgBridge.ins.on("NMEventUser",function(e){return t.iOSCallbackHandler(e)},this)},n.prototype.InvokeLoginCallback=function(e,t){if(this.m_LoginCallback){let n=this.m_LoginCallback;this.m_LoginCallback=null,n(e,t)}},n.prototype.Login=function(e){var t=this;this.m_LoginCallback=function(n,i){e(n?{success:!0,openid:t.GetUserId()}:{success:!1,error:i})},this.LoginGameCenter()},n.prototype.iOSCallbackHandler=function(e){switch(e.event){case"LOGIN":this.HandleLogin(e);break;case"REQUEST_LOCAL_PLAYER_SCORE":this.HandleRequestLocalPlayerScore(e);break;default:console.warn("Unhandled iOS Event >> "+e.event)}},n.prototype.HandleLogin=function(e){this.InvokeLoginCallback(e.success,e.reason)},n.prototype.HandleRequestLocalPlayerScore=function(e){var t=this.m_sync_uid;null!==this.m_SyncHandler&&(this.m_SyncHandler(e.identifier,e.score),this.SetIsSynced(t,!0))},n.prototype.SyncGameCenter=function(e,t,n){var i=this;this.GetIsSynced(e)||(this.m_SyncHandler=n,console.info("iOSGameCenter >> \u5f00\u59cb\u540c\u6b65\u670d\u52a1\u5668\u6570\u636e uid: "+e),this.m_sync_uid=e,t.Ranks.forEach(function(e){i.RequestLocalPlayScore(e.v)}))},n.prototype.GetIsSynced=function(t){return e.LSMgr.ins.getBoolWithDefault(t+"_ls_gamecenter_sync",!1)},n.prototype.SetIsSynced=function(t,n){e.LSMgr.ins.setBool(t+"_ls_gamecenter_sync",n,!1)},n.prototype.LoginGameCenter=function(){jsb.reflection.callStaticMethod("NMProxyUser","Login")},n.prototype.GetUserId=function(){return jsb.reflection.callStaticMethod("NMProxyUser","GetUserId")},n.prototype.IsAuthenticated=function(){return jsb.reflection.callStaticMethod("NMProxyUser","IsAuthenticated")},n.prototype.ReportScore=function(e,t){jsb.reflection.callStaticMethod("NMProxyUser","ReportScore:withScore:",e,t)},n.prototype.ReportAchievement=function(e,t){jsb.reflection.callStaticMethod("NMProxyUser","ReportAchievement:percentComplete:",e,t)},n.prototype.FiveStar=function(){jsb.reflection.callStaticMethod("NMProxyUser","FiveStar")},n.prototype.ShowDefaultLeaderboard=function(){jsb.reflection.callStaticMethod("NMProxyUser","ShowDefaultLeaderboard")},n.prototype.ShowLeaderboards=function(e,t){jsb.reflection.callStaticMethod("NMProxyUser","ShowLeaderboards:timeScope:",e,t)},n.prototype.ShowAchievement=function(){jsb.reflection.callStaticMethod("NMProxyUser","ShowAchievement")},n.prototype.RateUsByOpenUrl=function(e){jsb.reflection.callStaticMethod("NMProxyUser","RateUsByOpenUrl:",e)},n.prototype.RateUsWithinApp=function(e){jsb.reflection.callStaticMethod("NMProxyUser","RateUsWithinApp:",e)},n.prototype.RequestLocalPlayScore=function(e){this.IsAuthenticated()&&jsb.reflection.callStaticMethod("NMProxyUser","RequestLocalPlayScore:",e)},n._ins=null,n);function n(){this.m_LoginCallback=null,this.m_sync_uid=null,this.m_SyncHandler=null}e.iOSGameCenter=t}(numas=numas||{}),function(e){var t,n=(t=e.ADBase,__extends(i,t),i.prototype.IsSupport=function(){return!0},i.prototype.InitByScriptImpl=function(){var t=this;this._init_by_script||(this._init_by_script=!0,e.iOSMsgBridge.ins.on("NMEventAD",function(e){return t.iOSCallbackHandler(e)},this),jsb.reflection.callStaticMethod("NMProxyAD","initByScript:",e.CfgUtil.k2v(this.sdkCfg.iOS.kvs,"IronSourceAppKey")))},i.prototype.OnInit=function(){},i.prototype.ShowBannerImpl=function(e){e?jsb.reflection.callStaticMethod("NMProxyAD","ShowBanner"):jsb.reflection.callStaticMethod("NMProxyAD","HideBanner")},i.prototype.DestroyBanner=function(){jsb.reflection.callStaticMethod("NMProxyAD","DestroyBanner")},i.prototype.IsInterstitialAvailableImpl=function(){return jsb.reflection.callStaticMethod("NMProxyAD","IsInterstitialAvailable")},i.prototype.LoadInterstitialImpl=function(){jsb.reflection.callStaticMethod("NMProxyAD","LoadInterstitial")},i.prototype.ShowInterstitialImpl=function(e){this.m_ShowInterstitialCallback=e,jsb.reflection.callStaticMethod("NMProxyAD","ShowInterstitial")},i.prototype.IsRewardedVideoAvailableImpl=function(){return jsb.reflection.callStaticMethod("NMProxyAD","IsRewardedVideoAvailable")},i.prototype.ShowRewardedVideoImpl=function(t){this.m_ShowRewardedVideoCallback=t,e.iOSATT.ins.RequestTrackingAuthorization(function(){e.UIMgr.ins.blockSeconds(.05,function(){jsb.reflection.callStaticMethod("NMProxyAD","ShowRewardedVideo")})},!0)},i.prototype.onDestroy=function(){e.iOSMsgBridge.ins.targetOff(this),t.prototype.onDestroy.call(this)},i.prototype.ShowInterstitialCallback=function(e){this.m_ShowInterstitialCallback&&this.m_ShowInterstitialCallback(e)},i.prototype.ShowRewardedVideoCallback=function(e,t){this.m_ShowRewardedVideoCallback&&this.m_ShowRewardedVideoCallback(e,t)},i.prototype.iOSCallbackHandler=function(e){switch(e.type){case"RewardedVideo":this.HandleRewardedVideo(e);break;case"Interstitial":this.HandleInterstitial(e);break;case"Banner":this.HandleBanner(e)}},i.prototype.HandleBanner=function(e){e.event},i.prototype.HandleInterstitial=function(t){switch(t.event){case"LOADED":case"LOAD_ERROR":break;case"SHOW":this.ShowInterstitialCallback(e.EInterstitial.SHOW);break;case"SHOW_ERROR":this.ShowInterstitialCallback(e.EInterstitial.SHOW_ERROR);break;case"CLICK":this.ShowInterstitialCallback(e.EInterstitial.CLICK);break;case"CLOSE":this.ShowInterstitialCallback(e.EInterstitial.HIDE);break;default:this.ShowInterstitialCallback(e.EInterstitial.NOT_AVAILABLE)}},i.prototype.HandleRewardedVideo=function(t){switch(t.event){case"AVAILABLE_STATUS_CHANGED":this.RewardedVideoBV.v=t.available;break;case"SHOW":this.ShowRewardedVideoCallback(e.EInternalRewardedVideo.SHOW,t.rewarded);break;case"SHOW_ERROR":this.ShowRewardedVideoCallback(e.EInternalRewardedVideo.SHOW_ERROR,t.rewarded);break;case"REWARDED":this.ShowRewardedVideoCallback(e.EInternalRewardedVideo.REWARDED,t.rewarded);break;case"CLOSE":this.ShowRewardedVideoCallback(e.EInternalRewardedVideo.HIDE,t.rewarded);break;case"CLICK":break;default:this.ShowRewardedVideoCallback(e.EInternalRewardedVideo.NOT_AVAILABLE,t.rewarded)}},i);function i(){let e=null!==t&&t.apply(this,arguments)||this;return e._init_by_script=!1,e.m_ShowInterstitialCallback=null,e.m_ShowRewardedVideoCallback=null,e}e.iOSIronSourceAD=n}(numas=numas||{}),function(e){var t,n=(t=cc.EventTarget,__extends(i,t),Object.defineProperty(i,"ins",{get:function(){var e;return this._ins||(this._ins=new i,e=this,window._G_EventHandler=function(t,n){e._ins.EmitiOSEvent(t,n?JSON.parse(n):null)}),this._ins},enumerable:!1,configurable:!0}),i.prototype.EmitiOSEvent=function(e,t){this.emit(e,t)},i._ins=null,i);function i(){return null!==t&&t.apply(this,arguments)||this}e.iOSMsgBridge=n}(numas=numas||{}),function(e){var t,n=(t=e.PlatformBase,__extends(i,t),i.prototype.GetUserClass=function(){return e.iOSUser},i.prototype.GetADClass=function(){return e.iOSIronSourceAD},i.prototype.GetVibrateClass=function(){return e.iOSVibrate},i.prototype.Init=function(n){return t.prototype.Init.call(this,n),e.iOSATT.ins.Init(n),this},i);function i(){return null!==t&&t.apply(this,arguments)||this}e.iOSPlatform=n}(numas=numas||{}),function(e){var t,n=(t=e.UserBase,__extends(i,t),i.prototype.OnInit=function(n){t.prototype.OnInit.call(this,n),e.iOSGameCenter.ins.Init(n)},i.prototype.IsAuthedUserInfo=function(){return!0},i.prototype.AuthUserInfo=function(e,t){t()},i.prototype.LoginPlatform=function(t){e.iOSGameCenter.ins.Login(t)},i.prototype.OnLoginServerSuccess=function(){var t=this;e.iOSGameCenter.ins.SyncGameCenter(this.uid,this.sdkCfg.iOS.GameCenter,function(e,n){e=t.RealKey2DevKey(e),t.SetGameCenterVal(e,t.GetGameCenterVal(e)+n)})},i.prototype.OnLoginServerFailed=function(){},i.prototype.GetGameCenterCfg=function(){return this.sdkCfg.iOS.GameCenter},i.prototype.ReportScore=function(t,n){e.iOSGameCenter.ins.ReportScore(t,n)},i.prototype.FiveStar=function(){e.iOSGameCenter.ins.FiveStar()},i.prototype.IsSupportLeaderboard=function(){return!0},i.prototype.ShowDefaultLeaderboard=function(){this.UploadGameTime(),e.iOSGameCenter.ins.ShowDefaultLeaderboard()},i.prototype.IsSupportRateUsByOpenUrl=function(){return!0},i.prototype.RateUsByOpenUrl=function(){e.iOSGameCenter.ins.RateUsByOpenUrl(this.sdkCfg.iOS.AppId)},i.prototype.IsSupportContactUs=function(){return!0},i.prototype.ContactUs=function(){this.openSystemMailApp("huaxing_zheng@qq.com","")},i.prototype.openSystemMailApp=function(e,t,n,i,o){void 0===n&&(n=""),void 0===i&&(i=""),void 0===o&&(o=""),o="mailto:"+e+"?subject="+t+"&cc="+n+"&bcc="+i+"&body="+o,cc.sys.openURL(o)},i);function i(){return null!==t&&t.apply(this,arguments)||this}e.iOSUser=n}(numas=numas||{}),function(e){var t,n=(t=e.VibrateBase,__extends(i,t),i.prototype.DefaultImpl=function(){this.vibrateNormal()},i.prototype.vibrateNormal=function(){this.__bridgeVibrate("NORMAL")},i.prototype.vibratePeek=function(){this.__bridgeVibrate("PEEK")},i.prototype.vibratePop=function(){this.__bridgeVibrate("POP")},i.prototype.vibrateContinue=function(){this.__bridgeVibrate("CONTINUE")},i.prototype.__bridgeVibrate=function(e){jsb.reflection.callStaticMethod("NMVibrate","vibrate:",e)},i.prototype.tap_notification=function(e){void 0===e&&(e=2),jsb.reflection.callStaticMethod("NMVibrate","tap_notification:",e)},i.prototype.tap_selection=function(){jsb.reflection.callStaticMethod("NMVibrate","tap_selection")},i.prototype.tap_impact=function(e){void 0===e&&(e=4),jsb.reflection.callStaticMethod("NMVibrate","tap_impact:",e)},i.prototype.isSupportTapEngine=function(){return jsb.reflection.callStaticMethod("NMVibrate","isSupportTapEngine")},i);function i(){return null!==t&&t.apply(this,arguments)||this}e.iOSVibrate=n}(numas=numas||{}),function(e){var t,n=(Object.defineProperty(i.prototype,"seed",{get:function(){return this.kOriginRandomSeed},enumerable:!1,configurable:!0}),i.prototype.random=function(){var e=(this.kRandomSeed*this.kMultiplier+this.kConstant)%this.kModer,t=e/this.kModer;return this.kRandomSeed=e,this.bIsDebug&&(++this.kRandomCount,console.log(">>Rand{"+this.kOriginRandomSeed+"}: Count{"+this.kRandomCount+"} Seed{"+this.kRandomSeed+"} Ret:{"+t+"}")),t},i.prototype.range=function(e,t){return console.assert(e<t),Math.floor(this.random()*(t-e)+e)},i);function i(e,t,n,i,o){void 0===o&&(o=!1),this.kMultiplier=3125,this.kModer=34359738337,this.kConstant=0,this.kOriginRandomSeed=null,this.kRandomSeed=null,this.bIsDebug=!1,this.kRandomCount=0,this.kMultiplier=e,this.kModer=t,this.kConstant=n,i&&0!==i||(i=1),this.kOriginRandomSeed=i,this.kRandomSeed=i,this.bIsDebug=o}let o=(t=n,__extends(r,t),Object.defineProperty(r,"ins",{get:function(){return this._ins||(this._ins=new r(e.date.getMilliTimeStamp(),!1)),this._ins},enumerable:!1,configurable:!0}),r._ins=null,r);function r(e,n){return void 0===n&&(n=!1),t.call(this,3125,34359738337,0,e,n)||this}function s(){}e.MCGRand=o,s.IntBetween=function(e,t){return o.ins.range(e,t)},n=s,e.rand=n}(numas=numas||{}),function(e){var t,n=(t=e.UIPanel,__extends(i,t),i.prototype.OnCreate=function(){},i.prototype.OnRelease=function(){},i.prototype.OnOpen=function(){var t=this;this.BindBV(e.UIMgr.ins.block,function(e){return t.OnActiveChanged(e)},!0)},i);function i(){return null!==t&&t.apply(this,arguments)||this}e.BaseBlockInputUIPanel=n}(numas=numas||{}),function(e){var t,n=(t=e.UIPanel,__extends(i,t),i.prototype.OnCreate=function(){},i.prototype.OnRelease=function(){},i.prototype.OnOpen=function(){var t=this;this.BindBV(e.ResListLoaderInfo.ins.loaderCnt,function(n){t.OnActiveChanged(0<n),t.__OnLoading(e.ResListLoaderInfo.ins.finishTaskCnt.v,e.ResListLoaderInfo.ins.totalTaskCnt.v)},!0),this.BindBV(e.ResListLoaderInfo.ins.finishTaskCnt,function(n){t.__OnLoading(n,e.ResListLoaderInfo.ins.totalTaskCnt.v)},!0),this.BindBV(e.ResListLoaderInfo.ins.totalTaskCnt,function(n){t.__OnLoading(e.ResListLoaderInfo.ins.finishTaskCnt.v,n)},!0)},i.prototype.__OnLoading=function(t,n){0<e.ResListLoaderInfo.ins.loaderCnt.v&&this.OnLoading(t,n)},i);function i(){return null!==t&&t.apply(this,arguments)||this}e.BaseLoadingUIPanel=n}(numas=numas||{}),function(e){var t,n=(t=e.UIPanel,__extends(i,t),i.prototype.OnCreate=function(){this.SetUserData("K_INIT_POS",this.ActionNode.position)},i.prototype.OnRelease=function(){},i.prototype.OnOpen=function(){var t=this;this.MsgLabel.string=e.LangUtil.Get.apply(e.LangUtil,this.args.msg),cc.tween(this.ActionNode).to(.2,{opacity:255,position:cc.Vec3.ZERO}).delay(3).to(.2,{opacity:0,position:this.GetUserData("K_INIT_POS")}).call(function(){t.Close()}).start()},i);function i(){return null!==t&&t.apply(this,arguments)||this}e.BaseMsgUIPanel=n}(numas=numas||{}),function(e){var t,n=(t=e.UIPanel,__extends(i,t),i.prototype.OnCreate=function(){},i.prototype.OnRelease=function(){},i.prototype.OnOpen=function(){var t=this;this.BindBV(e.UIMgr.ins.waiting,function(e){return t.OnActiveChanged(e)},!0)},i);function i(){return null!==t&&t.apply(this,arguments)||this}e.BaseWaitingUIPanel=n}(numas=numas||{}),function(e){e.dirty=function(e){return function(t,n,i){let o=i.value;return i.value=function(){let t=[];for(let e=0;e<arguments.length;e++)t[e]=arguments[e];o.apply(this,t)&&this.markDirty(e)},i}};var t,n,i,o=(t=e.BaseComp,__extends(r,t),Object.defineProperty(r.prototype,"DataCacheName",{get:function(){return this._i_Name},set:function(e){this._i_Name=e},enumerable:!1,configurable:!0}),r.prototype.__i_Tick=function(e){this._i_Dirty&&(this._i_DirtySeconds+=e,this._i_DirtySeconds>=this._i_MaxSecondsToSave&&(this.__i_StopTick(),this.OnDirty()))},r.prototype.__i_StopTick=function(){this.GetUserData("_i_TICK")&&(this._i_MaxSecondsToSave=86400,this._i_Dirty=!1,this._i_DirtySeconds=0,this.unschedule(this.GetUserData("_i_TICK")))},r.prototype.__i_OnPreRegister=function(){},r.prototype.__i_OnRegisterTo=function(){this.__i_OnPreRegister(),this.OnRegister()},r.prototype.__i_OnUnRegister=function(){this.__i_StopTick(),this._i_Dirty&&this.OnDirty(),this.OnUnRegister()},r.prototype.markDirty=function(e){this._i_Dirty?e<this._i_MaxSecondsToSave&&(this._i_MaxSecondsToSave=e):(this._i_Dirty=!0,e<this._i_MaxSecondsToSave&&(this._i_MaxSecondsToSave=e),this.HasUserData("_i_TICK")||this.SetUserData("_i_TICK",this.__i_Tick.bind(this,1)),this.schedule(this.GetUserData("_i_TICK"),1,cc.macro.REPEAT_FOREVER))},r);function r(){let e=null!==t&&t.apply(this,arguments)||this;return e._i_Name=null,e._i_Dirty=!1,e._i_DirtySeconds=0,e._i_MaxSecondsToSave=86400,e}function s(){let e=null!==n&&n.apply(this,arguments)||this;return e._lsData=null,e}function u(){}function a(){let e=null!==i&&i.apply(this,arguments)||this;return e._i_AutoQueue=null,e._m_BVList_=[],e}e.DataCache=o,n=o,__extends(s,n),Object.defineProperty(s.prototype,"data",{get:function(){return this._lsData},enumerable:!1,configurable:!0}),s.prototype.Save=function(){e.UserLSMgr.ins.setObject(this.LSKey,this._lsData,!0)},s.prototype.OnDirty=function(){this.Save()},s.prototype.__i_OnPreRegister=function(){e.UserLSMgr.ins.hasKey(this.LSKey)?this._lsData=e.UserLSMgr.ins.getObject(this.LSKey):this._lsData=this.DefaultLSData},o=s,e.LSDataCache=o,u.GetDataCache=function(t){return e.ResMgr.ins.GetDataCache(t)},u.emitGlobal=function(t,n,i,o,r,s){e.EventCenter.ins.emit(t,n,i,o,r,s)},o=u,e.Logic=o,i=cc.EventTarget,__extends(a,i),a.prototype.Return=function(){this.Reset(),this.UnbindAllBV(),this.Destroy_AutoRelease()},a.prototype.ReturnBy=function(e){return e.AutoReturn(this)},a.prototype.AutoReturn=function(t){return this._I_AutoReleaseItemQueue.Enqueue(e.AutoReleaseItem.Borrow(t,e.EItemType.IReference)),t},Object.defineProperty(a.prototype,"_I_AutoReleaseItemQueue",{get:function(){return null===this._i_AutoQueue&&(this._i_AutoQueue=e.AnyQueue.Borrow()),this._i_AutoQueue},enumerable:!1,configurable:!0}),a.prototype.Destroy_AutoRelease=function(){null!=this._i_AutoQueue&&(e.ResMgr.ins.DestroyAutoReleaseItems(this._i_AutoQueue),this._i_AutoQueue.Return(),this._i_AutoQueue=null)},a.prototype.BindBV=function(e,t,n){e.Bind(t,n,this),this._m_BVList_.push(e)},a.prototype.UnbindAllBV=function(){for(;0<this._m_BVList_.length;)this._m_BVList_.pop().TargetUnbind(this)},o=a,e.Entity=o}(numas=numas||{}),function(e){var t=(Object.defineProperty(n,"ins",{get:function(){return null===this._ins&&(this._ins=new n),this._ins},enumerable:!1,configurable:!0}),n.prototype.GetBundleName=function(e){return this._m.get(e)},n.prototype.SetBundleName=function(e,t){this._m.set(e,t)},n.prototype.HasBundleName=function(e){return this._m.has(e)},n._ins=null,n);function n(){this._m=new Map}e.ResKey2BundleName=t}(numas=numas||{}),function(e){var t=(Object.defineProperty(n,"ins",{get:function(){return null===this._ins&&(this._ins=new n),this._ins},enumerable:!1,configurable:!0}),n.prototype.GetResType=function(e){return this._m.get(e)},n.prototype.SetResType=function(e,t){this._m.set(e,t)},n.prototype.HasResType=function(e){return this._m.has(e)},n._ins=null,n);function n(){this._m=new Map}e.ResKey2ResType=t}(numas=numas||{}),function(e){let t,n;function i(t,n,i){e.ResKey2BundleName.ins.SetBundleName(t,n),e.ResKey2ResType.ins.SetResType(t,i)}(o=t=e.EResType||(e.EResType={}))[o.Asset=0]="Asset",o[o.Audio=1]="Audio",o[o.Json=2]="Json",o[o.Prefab=3]="Prefab",o[o.Stage=4]="Stage",o[o.SpriteFrame=5]="SpriteFrame",o[o.Anim=6]="Anim",o[o.Spine=7]="Spine",o[o.LangJson=8]="LangJson",o[o.AutoAtlas=9]="AutoAtlas",e.registerRes=i,e.registerResDict=function(e,t,n){for(var o in e)i(e[o],t,n)},e.resDict2ResKeyList=function(e){let t=[];for(var n in e)t.push(e[n]);return t},e.registerPrefabCfg=function(n,o){for(var r in n.panel)e.registerUIPanel(n.panel[r].key,n.panel[r].z,o);for(var s in n.comp)i(n.comp[s].key,o,t.Prefab)},e.prefabCfg2ResKeyList=function(e){let t=[];for(var n in e)t.push(e[n].key);return t},e.registerLangJsonCfg=function(e,n){for(var o in e)i(e[o],n,t.LangJson)},(o=n=e.EItemType||(e.EItemType={}))[o.ResKey=0]="ResKey",o[o.DataCache=1]="DataCache",o[o.IReference=2]="IReference";var o=(r.Borrow=function(t,n){let i=e.ReferencePool.Borrow(r);return i.resKey=t,i.resTyp=n,i},r.prototype.Reset=function(){this.resKey=null,this.resTyp=null},r.prototype.Return=function(){e.ReferencePool.Return(r,this)},r);function r(){this.resKey=null,this.resTyp=null}e.AutoReleaseItem=o;let s=(u.Borrow=function(t,n){let i=e.ReferencePool.Borrow(u);return i.resKey=t,i.cb=n,i},u.prototype.Reset=function(){this.resKey=null,this.cb=null},u.prototype.Return=function(){e.ReferencePool.Return(u,this)},u);function u(){this.resKey=null,this.cb=null}var a;function l(){let t=null!==a&&a.apply(this,arguments)||this;return t._i_AssetCache=new d({addRef:function(e){return e.addRef()},decRef:function(e){e.decRef()},delete:function(){}}),t._i_LoadingGroupCache=new d({addRef:function(){},decRef:function(){},delete:function(e){e.Return()}}),t._i_DataCacheCache=new d({addRef:function(){},decRef:function(){},delete:function(e){e.__i_OnUnRegister(),t.node.removeComponent(e),e.destroy()}}),t._i_NextFrameToReleaseResQueue=e.AnyQueue.Borrow(),t._i_Next2FrameToReleaseResQueue=e.AnyQueue.Borrow(),t._i_TickScheduler=null,t.m_bLoadingGame=!1,t.m_Current=null,t}a=cc.Component,__extends(l,a),l.prototype.onLoad=function(){null===l.ins?l.ins=this:this.destroy()},l.prototype.AddResRef=function(e){this._i_AssetCache.AddRef(e)},l.prototype.DecResRef=function(e){this._i_AssetCache.DecRef(e)},l.prototype.GetRes=function(e){return this._i_AssetCache.GetRes(e)},l.prototype.HasRes=function(e){return this._i_AssetCache.HasRes(e)},l.prototype.SetRes=function(n,i){this._i_AssetCache.SetRes(n,i),e.ResKey2ResType.ins.GetResType(n)===t.LangJson&&e.LangUtil.AddLangCfg(i.json)},l.prototype.HasRegister=function(t){return e.ResKey2BundleName.ins.HasBundleName(t)&&e.ResKey2ResType.ins.HasResType(t)},l.prototype.GetOrLoadBundle=function(e,t){return c.GetOrLoadBundle(e,t)},l.prototype.__Load=function(n,i){var o,r=this;this._i_AssetCache.AddRef(n),this._i_AssetCache.HasRes(n)?(o=this._i_AssetCache.GetRes(n),i(o,n),this._i_AssetCache.DecRef(n)):(this._i_AssetCache.AddLoadingRef(n),o=e.ResKey2BundleName.ins.GetBundleName(n),c.GetOrLoadBundle(o,function(o){var s=e.ResKey2ResType.ins.GetResType(n),u=(u=n,"Res/"+t[s]+"/"+u);s=function(e){switch(e){case t.Asset:return cc.Asset;case t.Audio:return cc.AudioClip;case t.Json:return cc.JsonAsset;case t.Prefab:case t.Stage:return cc.Prefab;case t.SpriteFrame:return cc.SpriteFrame;case t.Anim:return cc.AnimationClip;case t.Spine:return sp.SkeletonData;case t.LangJson:return cc.JsonAsset;case t.AutoAtlas:return cc.SpriteFrame;default:throw new Error("\u672a\u77e5\u7684\u8d44\u6e90\u7c7b\u578b: "+e)}}(s),c.Load(o,u,s,function(e){r.SetRes(n,e),r._i_AssetCache.DecLoadingRef(n),i(e,n),r._i_AssetCache.DecRef(n)})}))},l.prototype.Load=function(t,n){void 0===e.ResKey2BundleName.ins.GetBundleName(t)&&console.error("\u627e\u4e0d\u5230 BundleName >> "+t),this.__Load(t,n)},l.prototype.LoadWithEvent=function(e,t){var n=this;this.Load(t,function(t,i){n.node.emit(e,t,i),n.node.off(e)})},l.prototype.LoadWithEventByGroup=function(e,t,n){var i=this;this.LoadByGroup(t,function(t,n){i.node.emit(e,t,n),i.node.off(e)},n)},l.prototype.LoadByGroup=function(t,n,i){var o=this;void 0===e.ResKey2BundleName.ins.GetBundleName(t)&&console.error("\u627e\u4e0d\u5230 BundleName >> "+t),this.HasLoadingGroup(i)?(this.AddLoadingGroup(i),this.GetLoadingGroup(i).Enqueue(s.Borrow(t,function(e,t){n(e,t),o.DecLoadingGroup(i)}))):(this.AddLoadingGroup(i),this.__Load(t,function(e,t){n(e,t),o.__i_TryToLoadNextGroupItem(i),o.DecLoadingGroup(i)}))},l.prototype.__i_TryToLoadNextGroupItem=function(e){if(this.HasLoadingGroup(e)){let i=this.GetLoadingGroup(e);if(0!=i.Count){let o=i.Dequeue();var t=o.resKey,n=o.cb;return o.Return(),this.LoadByGroup(t,n,e)}}},l.prototype.AddLoadingGroup=function(t){this._i_LoadingGroupCache.HasRes(t)?this._i_LoadingGroupCache.AddRef(t):(this._i_LoadingGroupCache.AddLoadingRef(t),this._i_LoadingGroupCache.AddRef(t),this._i_LoadingGroupCache.SetRes(t,e.AnyQueue.Borrow()),this._i_LoadingGroupCache.DecLoadingRef(t))},l.prototype.HasLoadingGroup=function(e){return this._i_LoadingGroupCache.HasRes(e)},l.prototype.GetLoadingGroup=function(e){return this._i_LoadingGroupCache.GetRes(e)},l.prototype.DecLoadingGroup=function(e){this._i_LoadingGroupCache.DecRef(e)},l.prototype.GetDataCache=function(e){return this._i_DataCacheCache.GetRes(e)},l.prototype.AddDataCache=function(e,t){if(this._i_DataCacheCache.HasRes(e))this._i_DataCacheCache.AddRef(e);else{this._i_DataCacheCache.AddLoadingRef(e),this._i_DataCacheCache.AddRef(e);let n=this.node.addComponent(t);n.DataCacheName=e,this._i_DataCacheCache.SetRes(n.DataCacheName,n),this._i_DataCacheCache.DecLoadingRef(e),n.__i_OnRegisterTo()}},l.prototype.hasDataCache=function(e){return this._i_DataCacheCache.HasRes(e)},l.prototype.DecDataCache=function(e){this._i_DataCacheCache.DecRef(e)},l.prototype.DestroyAutoReleaseItems=function(e){var t=this;e.RemoveAll(function(e){return t._i_NextFrameToReleaseResQueue.Enqueue(e)}),this.GC()},l.prototype.GC=function(){null===this._i_TickScheduler&&(0<this._i_NextFrameToReleaseResQueue.Count||0<this._i_Next2FrameToReleaseResQueue.Count)&&(this._i_TickScheduler=this.__i_Tick.bind(this),this.schedule(this._i_TickScheduler,0,cc.macro.REPEAT_FOREVER,0))},l.prototype.__i_StopTickSchedule=function(){null!==this._i_TickScheduler&&(this.unschedule(this._i_TickScheduler),this._i_TickScheduler=null)},l.prototype.__i_Tick=function(){if(!this.m_bLoadingGame)if(0<this._i_Next2FrameToReleaseResQueue.Count){let e=this._i_Next2FrameToReleaseResQueue.Dequeue();switch(e.resTyp){case n.ResKey:this.DecResRef(e.resKey);break;case n.DataCache:this.DecDataCache(e.resKey);break;case n.IReference:e.resKey.Return();break;default:console.error("ResMgr.DestroyAutoReleaseItems >> \u672a\u5904\u7406\u7684\u56de\u6536\u7c7b\u578b:"+n[e.resTyp])}}else 0<this._i_NextFrameToReleaseResQueue.Count?this._i_Next2FrameToReleaseResQueue.Enqueue(this._i_NextFrameToReleaseResQueue.Dequeue()):(this.__i_StopTickSchedule(),e.ReferencePool.ClearAll())},l.prototype.LoadStage=function(t,n,i,o){var r=this;e.registerUIStage(n,t),this.m_bLoadingGame=!0,e.UIMgr.ins.Open(n,i,function(t,n){null!==r.m_Current&&r.m_Current.Close(),(r.m_Current=t).__i_Init(function(){r.m_bLoadingGame=!1,e.Util.safeCall(o),r.GC()},n)})},l.prototype.LoadBundleStage=function(e,t,n){this.LoadStage(e,e,t,n)},l.prototype.Debug=function(){console.warn(" -------- ResMgr::Debug begin -------- "),this._i_AssetCache.Debug(),console.warn(" -------- ResMgr::Debug end -------- ")},l.ins=null,o=l,e.ResMgr=o;let c=(p.GetOrLoadBundle=function(t,n){var i=this,o=cc.assetManager.getBundle(t);if(o)n(o);else if(this._loadingBundleQueues.has(t))this._loadingBundleQueues.get(t).Enqueue(n);else{let o=e.AnyQueue.Borrow();o.Enqueue(n),this._loadingBundleQueues.set(t,o),cc.assetManager.loadBundle(t,function(e,n){if(e)console.error(e);else{let e=i._loadingBundleQueues.get(t);i._loadingResQueues.delete(t),e.RemoveAll(function(e){return e(n)}),e.Return()}})}},p.Load=function(t,n,i,o){var r=this,s=t.get(n,i);if(null==s)if(this._loadingResQueues.has(n))this._loadingResQueues.get(n).Enqueue(o);else{let s=e.AnyQueue.Borrow();s.Enqueue(o),this._loadingResQueues.set(n,s),t.load(n,i,function(e,t){if(e)console.error("L::load >> \u52a0\u8f7d\u8d44\u6e90\u51fa\u9519 "+n+" \u539f\u56e0: "+e.message);else{let e=r._loadingResQueues.get(n);r._loadingResQueues.delete(n),e.RemoveAll(function(e){return e(t)}),e.Return()}})}else o(s)},p.prototype.loadWithUUID=function(e,t){cc.assetManager.loadAny({uuid:e},function(e,n){e?console.error(e):t(n)})},p.DEBUG=!0,p._loadingResQueues=new Map,p._loadingBundleQueues=new Map,p);function p(){}let h=(f.Borrow=function(){return e.ReferencePool.Borrow(f)},f.prototype.Return=function(){e.ReferencePool.Return(f,this)},f.prototype.Reset=function(){this.loadingRef=0,this.addRef=0,this.decRef=0,this.ref=0,this.asset=null},f);function f(){this.loadingRef=0,this.addRef=0,this.decRef=0,this.ref=0,this.asset=null}let d=(_.prototype.AddLoadingRef=function(e){if(this._resCache.has(e))this._resCache.get(e).loadingRef+=1;else{let t=h.Borrow();t.loadingRef=1,this._resCache.set(e,t)}},_.prototype.DecLoadingRef=function(e){let t=this._resCache.get(e);if(--t.loadingRef,0===t.loadingRef){for(;0<t.addRef;)--t.addRef,++t.ref,this._i_Helper.addRef(t.asset,e);for(;0<t.decRef;)--t.decRef,--t.ref,this._i_Helper.decRef(t.asset,e);this.TryRelease(e)}},_.prototype.AddRef=function(e){if(this._resCache.has(e)){let t=this._resCache.get(e);0<t.ref?(this._i_Helper.addRef(t.asset,e),++t.ref):++t.addRef}else{let t=h.Borrow();t.addRef=1,this._resCache.set(e,t)}},_.prototype.DecRef=function(e){let t=this._resCache.get(e);0<t.loadingRef?++t.decRef:0<t.ref?(this._i_Helper.decRef(t.asset,e),--t.ref,this.TryRelease(e)):0<t.addRef?(--t.addRef,this.TryRelease(e)):console.error("\u8d44\u6e90\u7ba1\u7406\u903b\u8f91\u51fa\u73b0\u9519\u8bef _i_AC:DecRef >> resKey: "+e)},_.prototype.HasRes=function(e){return!!this._resCache.has(e)&&0<this._resCache.get(e).ref},_.prototype.GetRes=function(e){return this.HasRes(e)?this._resCache.get(e).asset:(console.error("_i_AC::getRes() >> \u627e\u4e0d\u5230\u8d44\u6e90\u5bf9\u8c61 resKey = "+e),null)},_.prototype.SetRes=function(e,t){let n=this._resCache.get(e);null==n.asset||n.asset==t?n.asset=t:console.error("_i_AC::setRes >> \u8d44\u6e90\u5173\u952e\u5b57 "+e+" \u7684\u8d44\u6e90\u53d1\u751f\u4e86\u66f4\u6539\uff0c\u8fd9\u662f\u9519\u8bef\u7684\uff01")},_.prototype.TryRelease=function(e){if(this._resCache.has(e)){let t=this._resCache.get(e);0===t.loadingRef&&0===t.addRef&&0===t.decRef&&0===t.ref&&(this._i_Helper.delete(t.asset,e),this._resCache.delete(e),t.Return())}},_.prototype.Debug=function(){console.info("           _resCache >>"),console.info(this._resCache)},_);function _(e){this._i_Helper=null,this._resCache=new Map,this._i_Helper=e}}(numas=numas||{}),function(e){var t,n=(t=e.BaseUIComp,__extends(i,t),i.prototype.$__internal_Create=function(){this.OnCreate()},i.prototype.Close=function(){this._i_Close||(this._i_Close=!0,this.OnRelease(),this.UnbindAllBV(),this.InterrupteAction(),this.__i_CloseAllAutoCloseUIComp(),this.node.removeFromParent(),this.node.destroy())},i.prototype.$__internal_OnOpen=function(e){this._$isOpened_?console.error("UIComp >> \u5df2\u7ecf\u5904\u4e8e\u6253\u5f00\u72b6\u6001\uff0c\u4e0d\u5e94\u8be5\u91cd\u590d\u8c03\u7528\u6b64\u65b9\u6cd5"):(this._$isOpening_=!0,this._$isOpened_=!0,this.args=e,this.OnOpen(e),this._$isOpening_=!1)},i.prototype.BindBV=function(e,t,n){e.Bind(t,n,this),this._m_BVList_.push(e)},i.prototype.UnbindAllBV=function(){for(;0<this._m_BVList_.length;)this._m_BVList_.pop().TargetUnbind(this)},i.prototype.CloseBy=function(e){return e.__i_AutoCloseUIComp(this)},i.prototype.__i_AutoCloseUIComp=function(e){return this._I_AutoCloseUICompQueue.Enqueue(e),e},Object.defineProperty(i.prototype,"_I_AutoCloseUICompQueue",{get:function(){return null===this._i_UICompQueue&&(this._i_UICompQueue=e.AnyQueue.Borrow()),this._i_UICompQueue},enumerable:!1,configurable:!0}),i.prototype.__i_CloseAllAutoCloseUIComp=function(){null!==this._i_UICompQueue&&(this._i_UICompQueue.RemoveAll(function(e){return e.Close()}),this._i_UICompQueue.Return(),this._i_UICompQueue=null)},i.prototype.onDestroy=function(){this._i_Close||(console.warn("\u4e0d\u89c4\u8303\u7684\u8c03\u7528\u65b9\u5f0f >> \u672a\u8c03\u7528 "+this.name+".Close() \u65b9\u6cd5\u8fdb\u884c\u5bf9\u8c61\u7684\u79fb\u9664"),this._i_Close=!0,this.OnRelease(),this.InterrupteAction(),this.__i_CloseAllAutoCloseUIComp(),this.UnbindAllBV()),t.prototype.onDestroy.call(this)},Object.defineProperty(i.prototype,"_I_StopCallLinkedList",{get:function(){return null===this._im_StopCallLinkedList&&(this._im_StopCallLinkedList=e.AnyQueue.Borrow()),this._im_StopCallLinkedList},enumerable:!1,configurable:!0}),i.prototype.AddStopActionCall=function(e){this._I_StopCallLinkedList.Enqueue(e)},i.prototype.RemoveStopCall=function(e){this._I_StopCallLinkedList.RemoveFirst(function(t){return t===e})},i.prototype.StopAllAction=function(){var e=this;this._I_StopCallLinkedList.RemoveAll(function(t){return t(e)}),this.node.stopAllActions()},i.prototype.InterrupteAction=function(){null!==this._im_StopCallLinkedList&&0<this._im_StopCallLinkedList.Count&&(this._im_StopCallLinkedList.RemoveAll(),this.node.stopAllActions())},i);function i(){let e=null!==t&&t.apply(this,arguments)||this;return e.args=null,e._$isOpened_=!1,e._$isOpening_=!1,e._i_Close=!1,e._m_BVList_=[],e._i_UICompQueue=null,e._im_StopCallLinkedList=null,e}e.UIComp=n}(numas=numas||{}),function(e){let t=(Object.defineProperty(n,"ins",{get:function(){return null===this._ins&&(this._ins=new n),this._ins},enumerable:!1,configurable:!0}),n.prototype.GetZIndex=function(e){return this._m.get(e)},n.prototype.SetZIndex=function(e,t){this._m.set(e,t)},n._ins=null,n);function n(){this._m=new Map}e.registerUIStage=function(n,i){t.ins.SetZIndex(n,e.UIZIndex.Stage),e.registerRes(n,i,e.EResType.Stage)},e.registerUIPanel=function(n,i,o){t.ins.SetZIndex(n,i),e.registerRes(n,o,e.EResType.Prefab)},e.registerUIComp=function(t,n){e.registerRes(t,n,e.EResType.Prefab)};var i,o=(i=cc.Component,__extends(r,i),r.prototype.onLoad=function(){var t,n=this;for(t in null===r.ins?r.ins=this:this.destroy(),e.UIZIndex)if(isNaN(t)){let n=new cc.Node("--"+t);n.setContentSize(this.node.getContentSize()),n.parent=this.node;var i=parseInt(e.UIZIndex[t]);n.zIndex=i,this._zs[i]=n}this.block_ref.Bind(function(e){return n.block.v=0<e},!0,this),this.waiting_ref.Bind(function(e){return n.waiting.v=0<e},!0,this)},r.prototype.onDestroy=function(){this.waiting_ref.TargetUnbind(this),this.waiting.TargetUnbind(this),this.block_ref.TargetUnbind(this),this.block.TargetUnbind(this)},r.prototype.LoadStage=function(t,n,i,o){e.ResMgr.ins.LoadStage(t,n,i,o)},r.prototype.LoadBundleStage=function(t,n,i){e.ResMgr.ins.LoadStage(t,t,n,i)},r.prototype.Create=function(t,n,i){var o=e.ResMgr.ins.GetRes(t);let r=cc.instantiate(o).getComponent(e.UIComp);return null==r&&console.error(">> "+t+" \u5bf9\u5e94\u7684\u7ec4\u4ef6\u8d44\u6e90\u6ca1\u6709\u63d0\u524d\u6ce8\u518c"),r.$__internal_Create(),null!=i&&(r.node.parent=i),r.$__internal_OnOpen(n),r},r.prototype.Exist=function(e){for(let t=this._phs.length-1;0<=t;--t)if(this._phs[t].IsSameResKey(e))return!0;return!1},r.prototype.Open=function(e,n,i){var o=t.ins.GetZIndex(e);null==o&&console.error(e+" \u62ff\u4e0d\u5230 ZIndex"),this.__Open(e,o,n,i)},r.prototype.__Open=function(t,n,i,o){n=this._zs[n];let r=e.UIPH.Borrow();this._phs.push(r),r.OpenUI(n,t,i,o)},r.prototype.Close=function(){let e=[];for(let i=0;i<arguments.length;i++)e[i]=arguments[i];if("string"==typeof e[0]){var t=e[0],n=e[1];for(let e=this._phs.length-1;0<=e;--e)if(this._phs[e].IsSameResKey(t)){let t=this._phs[e];if(this._phs.splice(e,1),t.CloseUI(),!n)return}}else{let t=e[0].GetUPH();for(let e=this._phs.length-1;0<=e;--e)if(this._phs[e]===t){this._phs.splice(e,1),t.CloseUI();break}}},r.prototype.AddWaitingRef=function(){++this.waiting_ref.v},r.prototype.DecWaitingRef=function(){--this.waiting_ref.v},r.prototype.AddBlockRef=function(){++this.block_ref.v},r.prototype.DecBlockRef=function(){--this.block_ref.v},r.prototype.blockSeconds=function(t,n){var i=this;++this.block_ref.v,this.scheduleOnce(function(){--i.block_ref.v,e.Util.safeCall(n)},t)},r.prototype.OpenDialog1=function(t,n,i,o){this.Open(e.IIStartPrefabCfg.dft.panel.DialogUIPanel.key,e.DialogUIPanelArgs.Create1(t,n,i,o))},r.prototype.OpenDialog2=function(t,n,i,o,r,s){this.Open(e.IIStartPrefabCfg.dft.panel.DialogUIPanel.key,e.DialogUIPanelArgs.Create2(t,n,i,o,r,s))},r.prototype.OpenDialog3=function(t,n,i,o,r,s,u,a){this.Open(e.IIStartPrefabCfg.dft.panel.DialogUIPanel.key,e.DialogUIPanelArgs.Create3(t,n,i,o,r,s,u,a))},r.prototype.ShowMsg=function(){let t=[];for(let e=0;e<arguments.length;e++)t[e]=arguments[e];this.Open(e.IIStartPrefabCfg.dft.panel.MsgUIPanel.key,{msg:t})},r.prototype.Debug=function(){console.info("UIMgr >> Debug");for(let e=0;e<this._phs.length;++e)console.info("z: "+this._phs[e].node.zIndex+" >> "+this._phs[e].GetResKey())},r.ins=null,r);function r(){let t=null!==i&&i.apply(this,arguments)||this;return t._zs={},t._phs=[],t.waiting_ref=e.NumberBV.Borrow(0),t.waiting=e.BooleanBV.Borrow(!1),t.block_ref=e.NumberBV.Borrow(0),t.block=e.BooleanBV.Borrow(!1),t}e.UIMgr=o}(numas=numas||{}),function(e){var t,n=(t=cc.Component,__extends(i,t),i.Borrow=function(){return e.NodePool.Get("__i_UIPH",i)},i.prototype.IsSameResKey=function(e){return this._prefabKey==e},i.prototype.GetResKey=function(){return this._prefabKey},i.prototype.OpenUI=function(t,n,i,o){var r=this;this._prefabKey=n,this._args=i,this._isLoading=!0,this.node.parent=t,this.node.setContentSize(t.getContentSize()),e.ResMgr.ins.Load(n,function(t,i){r._isLoading=!1;let s=cc.instantiate(t);s.parent=r.node,r.node.name="\u3010UIPH\u3011"+n.substring(n.lastIndexOf("/")+1),s.setContentSize(r.node.getContentSize());let u=s.getComponent(e.UIPanel);u.AutoReleaseRes(i),r._uiPanel=u,u.$__i_InitByUPH(r),u.$__i_OnOpen(r._args),o&&o(r._uiPanel,r._args),r._isCloseAfterLoading&&(r._isCloseAfterLoading=!1,r.CloseUI())})},i.prototype.CloseUI=function(){this._isLoading?this._isCloseAfterLoading=!0:this.__CloseUI()},i.prototype.__CloseUI=function(){this._uiPanel.$__i_CloseByUPH(),this._uiPanel.node.removeFromParent(!0),this._uiPanel.node.destroy(),this._uiPanel=null,this.node.removeFromParent(!0),this._isLoading=!1,this._args=null,this._prefabKey=null,e.NodePool.Put("__i_UIPH",this)},i);function i(){let e=null!==t&&t.apply(this,arguments)||this;return e._prefabKey=null,e._args=null,e._uiPanel=null,e._isLoading=!1,e._isCloseAfterLoading=!1,e}e.UIPH=n}(numas=numas||{}),function(e){var t,n=(t=e.UIPanel,__extends(i,t),i.prototype.OnCreate=function(){},i.prototype.OnRelease=function(){},i.prototype.OnOpen=function(){},i.prototype.__i_Init=function(t,n){this.m_Initialized?console.error(">> UIStage::OnOpen() >> \u5df2\u7ecf\u521d\u59cb\u5316\uff0c\u9519\u8bef\u7684\u4f7f\u7528\u65b9\u5f0f"):(this.m_Initialized=!0,e.AudioMgr.ins.SetDefaultEffect(this.GetDefaultEffectAudioKey()),this.OnInit(e.Util.onceCall(t,1),n))},i);function i(){let e=null!==t&&t.apply(this,arguments)||this;return e.m_Initialized=!1,e}e.UIStage=n}(numas=numas||{}),function(e){var t=(n.getOrAddComponent=function(e,t){let n=e.getComponent(t);return n||e.addComponent(t)},n.transferTo=function(e,t,n){var i;void 0===n&&(n=!1),e.parent!==t&&(i=t.convertToNodeSpaceAR(e.convertToWorldSpaceAR(cc.Vec3.ZERO)),e.removeFromParent(n),e.position=i,t.addChild(e))},n.positionInTarget=function(e,t){return e=e.convertToWorldSpaceAR(cc.Vec3.ZERO),t.convertToNodeSpaceAR(e)},n.fadeInBackgroundAction=function(e,t,n){void 0===t&&(t=255),void 0===n&&(n=.4),this.showAction(e,n,{opacity:t},null,0,!0)},n.fadeOutBackgroundAction=function(e,t,n,i,o){void 0===t&&(t=null),void 0===n&&(n=0),void 0===i&&(i=.3),void 0===o&&(o=.4),this.hideAction(e,i,{opacity:n},t,o,!0)},n.scaleAction=function(e,t){cc.tween(e).to(.15,{scale:t}).to(.2,{scale:1}).start()},n.moveAction=function(e,t,n,i,o,r,s){void 0===i&&(i=.8),void 0===r&&(r=0),void 0===s&&(s=cc.easing.backOut);let u=cc.tween(e);0<r&&u.delay(r),u.to(i,{position:t?cc.Vec3.ZERO:n},{easing:t?s:cc.easing.backIn}),o&&u.call(o),u.start()},n.hideAction=function(e,t,n,i,o,r){return void 0===i&&(i=null),void 0===o&&(o=0),void 0===r&&(r=!0),this.BaseAction(e,!1,t,n,i,o,r)},n.showAction=function(e,t,n,i,o,r){return void 0===i&&(i=null),void 0===o&&(o=0),void 0===r&&(r=!0),this.BaseAction(e,!0,t,n,i,o,r)},n.BaseAction=function(t,n,i,o,r,s,u){if(void 0===r&&(r=null),void 0===s&&(s=0),void 0===u&&(u=!0),0==i)return t.active=n,null===t.scale&&void 0===t.scale||(t.scale=o.scale),null===t.opacity&&void 0===t.opacity||(t.opacity=o.opacity),console.assert(0==s),void(r&&r(t));t.active=!0,u&&e.UIMgr.ins.AddBlockRef();let a=cc.tween(t);0<s&&a.delay(s),a.to(i,o).call(function(t){t.active=n,u&&e.UIMgr.ins.DecBlockRef(),r&&r(t)}).start()},n);function n(){}e.UIUtil=t}(numas=numas||{}),function(e){var t=(n.IntegerTo=function(e,t,n,i,o){this.__IntegerTo(e,t,n,i,o,this.LinearFloorIntegerProgress)},n.CeilIntegerTo=function(e,t,n,i,o){this.__IntegerTo(e,t,n,i,o,this.LinearCeilIntegerProgress)},n.RoundIntegerTo=function(e,t,n,i,o){this.__IntegerTo(e,t,n,i,o,this.LinearRoundIntegerProgress)},n.__IntegerTo=function(t,n,i,o,r,s){let u=e.NumberBV.Borrow(n);u.Bind(o,r,this),cc.tween(u).to(t,{v:i},s).call(function(e){return e.Return()}).start()},n.LinearProgress={progress:function(e,t,n,i){return e+(t-e)*i}},n.LinearFloorIntegerProgress={progress:function(e,t,n,i){return Math.floor(e+(t-e)*i)}},n.LinearCeilIntegerProgress={progress:function(e,t,n,i){return Math.ceil(e+(t-e)*i)}},n.LinearRoundIntegerProgress={progress:function(e,t,n,i){return Math.round(e+(t-e)*i)}},n);function n(){}e.TweenUtil=t}(numas=numas||{});