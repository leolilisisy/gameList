window.__require=function e(t,o,n){function i(s,r){if(!o[s]){if(!t[s]){var c=s.split("/");if(c=c[c.length-1],!t[c]){var l="function"==typeof __require&&__require;if(!r&&l)return l(c,!0);if(a)return a(c,!0);throw new Error("Cannot find module '"+s+"'")}}var u=o[s]={exports:{}};t[s][0].call(u.exports,function(e){return i(t[s][1][e]||e)},u,u.exports,e,t,o,n)}return o[s].exports}for(var a="function"==typeof __require&&__require,s=0;s<n.length;s++)i(n[s]);return i}({CommonInstallApp:[function(e,t,o){"use strict";cc._RF.push(t,"f6d3dnDeWFA4JHHRPmOqzPl","CommonInstallApp"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,i=n.ccclass,a=n.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.labTitle=null,t.rtDesc=null,t.btnOK=null,t.btnCancel=null,t.cbBtnOK=null,t}return __extends(t,e),t.prototype.onLoad=function(){},t.prototype.start=function(){},t.prototype.initLayer=function(e,t,o,n){void 0===e&&(e=""),void 0===t&&(t=null),void 0===o&&(o=null),void 0===n&&(n="\u63d0\u793a"),console.log("initLayerinitLayerinitLayer:"),this.labTitle.string=n,this.rtDesc.node.active=!0,this.rtDesc.string=e,this.cbBtnOK=t,this.cbBtnCancel=o},t.prototype.onBtnOK=function(){this.cbBtnOK&&this.cbBtnOK(),this.btnOK.active=!1},t.prototype.onBtnCancel=function(){this.cbBtnCancel&&this.cbBtnCancel(),this.btnCancel.active=!1,this.onClose()},t.prototype.onClose=function(){this.node.destroy()},__decorate([a(cc.Label)],t.prototype,"labTitle",void 0),__decorate([a(cc.RichText)],t.prototype,"rtDesc",void 0),__decorate([a(cc.Node)],t.prototype,"btnOK",void 0),__decorate([a(cc.Node)],t.prototype,"btnCancel",void 0),t=__decorate([i],t)}(cc.Component);o.default=s,cc._RF.pop()},{}],CommonPopTips:[function(e,t,o){"use strict";cc._RF.push(t,"65dfaz/LMpJ8olzIQGPC5tv","CommonPopTips"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,i=n.ccclass,a=n.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.labTitle=null,t.rtDesc=null,t.cbBtnOK=null,t}return __extends(t,e),t.prototype.onLoad=function(){},t.prototype.start=function(){},t.prototype.initLayer=function(e,t,o,n){void 0===e&&(e=""),void 0===t&&(t=null),void 0===o&&(o=null),void 0===n&&(n="\u63d0\u793a"),this.labTitle.string=n,this.rtDesc.node.active=!0,this.rtDesc.string=e,this.cbBtnOK=t,this.cbBtnCancel=o},t.prototype.onBtnOK=function(){this.cbBtnOK&&this.cbBtnOK(),this.onClose()},t.prototype.onBtnCancel=function(){this.cbBtnCancel&&this.cbBtnCancel(),this.onClose()},t.prototype.onClose=function(){this.node.destroy()},__decorate([a(cc.Label)],t.prototype,"labTitle",void 0),__decorate([a(cc.RichText)],t.prototype,"rtDesc",void 0),t=__decorate([i],t)}(cc.Component);o.default=s,cc._RF.pop()},{}],GameLayerLogic:[function(e,t,o){"use strict";cc._RF.push(t,"2b7faZ3inpBxJKZOWf9Ioo7","GameLayerLogic");var n=a(e("../../Common/TS_ResourceManager")),i=a(e("../../Common/RootNode"));function a(e){return e&&e.__esModule?e:{default:e}}cc.Class({extends:cc.Component,properties:{robot:{default:null,type:cc.Node},nowPointPrefab:{default:null,type:cc.Node},layerNowType:{default:null,type:cc.Node},starNumLabel:{default:null,type:cc.Label}},refreshComponents:function(){var e=$CommonData.gSData.serverData.currentStep,t="",o=0,n=-1;if(null==e)t="\u8bfe\u7a0b\u7ed3\u675f",o=0;else{for(var i=$CommonData.gSData.serverData.part_steps,a=0;a<i.length;a++){var s=i[a],r=s[0];if(s[1]==e.id){n=r;break}}if(-1!=n)for(var c=$CommonData.gSData.serverData.parts,l=0;l<c.length;l++){var u=c[l];if(u.id==n){t=u.partname;break}}var d=$CommonData.gSData.serverData.steps.length;o=($CommonData.gSData.serverData.stepSeq+1)/d}this.setLayerNowType(t),$CommonData.gCData.partname=t;var h=this.node.getChildByName("progressBoom"),g=h.getContentSize().width;h.getChildByName("progressTop").width=g*o},start:function(){this.layerType="",this.addStar=this.node.getChildByName("addStar"),$CommonData.gSData.serverData&&$CommonData.gSData.serverData.stars?this.starNumLabel&&(this.starNumLabel.string=$CommonData.gSData.serverData.stars):this.starNumLabel&&(this.starNumLabel.string=0);var e=this.node.getChildByName("showstep");$CommonData.gCData.greenPointEnable?e.active=!0:e.active=!1},setShowStarKuang:function(e){MKLog.log("starNum:"+e),this.starNumLabel&&(this.starNumLabel.string=e)},showPointLayer:function(){$CommonData.gCData.isShowVideo||($CommonData.gCData.isUpdatingClass?i.default.showTips("\u6b63\u5728\u66f4\u65b0\u8bfe\u524d\u590d\u4e60\uff0c\u8bf7\u7a0d\u5019\u3002"):(this.nowPointPrefab.active=!0,this.nowPointPrefab.getComponent("nowPointLogic").addItem()))},setLayerNowType:function(e){var t=this;if(MKLog.log("setLayerNowTypesetLayerNowType::",this.layerType),MKLog.log("setLayerNowTypesetLayerNowType::",e),this.layerType!=e){this.layerType=e;var o=!1,i="";if(!$CommonData.gCData.layerNodePath)switch(e){case"\u4e86\u89e3\u66f4\u591a":i="liaojiegengduo",o=!0;break;case"\u8bfe\u5802\u603b\u7ed3":case"\u8bfe\u7a0b\u603b\u7ed3":i="ketangzongjie",o=!0;break;case"\u6bcf\u8bfe\u4e00\u7ec3":i="meikeyilian",o=!0}MKLog.log("setLayerNowTypesetLayerNowType::",o),o?(i="public/uilayer/"+i,MKLog.log("sprsprsprsprspr::",i),n.default.loadUnitRes(i,cc.SpriteFrame,function(e,o){e?MKLog.log("err:"+e):(t.layerNowType.active=!0,t.layerNowType.getComponent(cc.Sprite).spriteFrame=o)})):this.layerNowType.active=!1}},setLayerNowTypeActive:function(e){this.layerNowType.active=e},showDebrisLayer:function(e){var t=this;n.default.loadUnitRes("public/debris/debrisLayer",cc.Prefab,function(o,n){if(o)MKLog.log("err:"+o);else{var i=cc.instantiate(n);i.parent=t.node,i.getComponent("debrisLayerLogic").setDebrisData(e)}})},goto_execisesSelectScene:function(){$CommonData.gCData.isUpdatingClass?i.default.showTips("\u6b63\u5728\u66f4\u65b0\u8bfe\u524d\u590d\u4e60\u5355\u5143\uff0c\u8bf7\u7a0d\u7b49."):(this.homeBtn=cc.find("home",this.node).getComponent(cc.Button),this.homeBtn.interactable=!1,cc.director.preloadScene("execisesSelectScene",function(){cc.director.loadScene("execisesSelectScene")}))},showStarPrefab:function(e){var t=this;if($CommonData.gCData.layerNodePath&&e)e();else{var o=this.node.getChildByName("showStarKuang"),i=cc.v2(o.x,o.y);if($CommonData.gCData.starPrefab){MKLog.log("-----------------this.starPrefab--------------------"),$CommonData.gCData.starPrefab.active=!0,$CommonData.gCData.starPrefab.opacity=255;n.default.loadUnitRes("public/audio/starMusic",cc.AudioClip,function(e,t){e||cc.audioEngine.playEffect(t,!1)}),$CommonData.gCData.starPrefab.scale=3,$CommonData.gCData.starPrefab.x=-1400,$CommonData.gCData.starPrefab.y=-420;cc.delayTime(1);var a=[cc.v2(-1400,-420),cc.v2(-200,420),cc.v2(i.x-85,i.y)],s=cc.bezierTo(1.2,a),r=cc.callFunc(function(o){$CommonData.gSData.serverData.stars>=0&&($CommonData.gSData.serverData.stars=Number($CommonData.gSData.serverData.stars)+1);var n=$CommonData.gSData.serverData.stars;n>=0||(n=1),t.setShowStarKuang(n),$CommonData.gCData.starPrefab.x=-1400,$CommonData.gCData.starPrefab.y=-420,$CommonData.gCData.starPrefab.opacity=0,t.addStar.active=!0,t.addStar.x=i.x+100,t.addStar.y=i.y;var a=cc.delayTime(.5),s=cc.moveBy(.2,cc.v2(0,50)),r=cc.callFunc(function(e){e.active=!1});t.addStar.runAction(cc.sequence(a,s,r)),e&&e()}),c=cc.scaleTo(1.2,2),l=cc.spawn(c,s);$CommonData.gCData.starPrefab.runAction(cc.sequence(l,r))}else{MKLog.log("-----------------starPrefab--------------------");n.default.loadUnitRes("public/uilayer/starNode",cc.Prefab,function(o,a){if(o)MKLog.log("err:"+o);else{var s=cc.instantiate(a);$CommonData.gCData.starPrefab=s,s.x=-1400,s.y=-420,s.parent=t.node,s.scale=3;n.default.loadTempRes("public/audio/starMusic",cc.AudioClip,function(e,t){e||cc.audioEngine.playEffect(t,!1)});var r=[cc.v2(-1400,-420),cc.v2(-200,420),cc.v2(i.x-85,i.y)],c=cc.bezierTo(1.2,r),l=cc.callFunc(function(o){$CommonData.gSData.serverData.stars&&($CommonData.gSData.serverData.stars=Number($CommonData.gSData.serverData.stars)+1);var n=$CommonData.gSData.serverData.stars;n>=0||(n=1),t.setShowStarKuang(n),$CommonData.gCData.starPrefab.x=-1400,$CommonData.gCData.starPrefab.y=-420,$CommonData.gCData.starPrefab.opacity=0,t.addStar.active=!0,t.addStar.x=i.x+100,t.addStar.y=i.y;var a=cc.delayTime(.5),s=cc.moveBy(.2,cc.v2(0,50)),r=cc.callFunc(function(e){e.active=!1});t.addStar.runAction(cc.sequence(a,s,r)),e&&e()}),u=cc.scaleTo(1.2,2),d=cc.spawn(u,c);$CommonData.gCData.starPrefab.runAction(cc.sequence(d,l))}})}}}}),cc._RF.pop()},{"../../Common/RootNode":"RootNode","../../Common/TS_ResourceManager":"TS_ResourceManager"}],GlobalGameData:[function(e,t,o){"use strict";cc._RF.push(t,"a2f022t9EpMeJoraWqjhVSO","GlobalGameData");var n=t.exports;n.init=function(){console.log("global.init====="),window.$CommonData=window.$CommonData||{},null!=window.$CommonData&&null!=window.$CommonData.gSData||(n._initCData(),n._initSData())},n._initSData=function(){console.log("global._initSData====="),window.CCC_DEBUGABLE=!1,window.$CommonData.gSData={},$CommonData.gSData.serverData={}},n._initCData=function(){console.log("global._initCData====="),$CommonData.gCData={},$CommonData.gCData.clientWidth=1920,$CommonData.gCData.gIsLogined=!1,$CommonData.gCData.gIsGameDownloading={},$CommonData.gCData.gameChecked={},$CommonData.gCData.gCurrentMusic=null,$CommonData.gCData.gNoticeAutoShowed=!1,$CommonData.gCData.gIsVoiceRecordOrPlay=!1,$CommonData.gCData.gLastUpdateInvite=0,$CommonData.gCData.phoneId=null,$CommonData.gCData.userId=null,$CommonData.gCData.unitid=null,$CommonData.gCData.ISCANTOUCH=!1,$CommonData.gCData.gameIsProceed=!1,$CommonData.gCData.NOWEXERCISE=-1,$CommonData.gCData.MAXERRNUM=5,$CommonData.gCData.succNum=5,$CommonData.gCData.failNum=2,$CommonData.gCData.effectIsTen=!1,$CommonData.gCData.endPos=cc.v2(0,0),$CommonData.gCData.errEffectArr=[],$CommonData.gCData.isSingleChoice=!1,$CommonData.gCData.isTopic=!1,$CommonData.gCData.isExeerciseMode=!1,$CommonData.gCData.videoNum=1,$CommonData.gCData.needShowLayer="miniGame|game_grow",$CommonData.gCData.needHideLayer=null,$CommonData.gCData.changeSceneName="",$CommonData.gCData.nowGameLogic="",$CommonData.gCData.deTimeNum=.5,$CommonData.gCData.isFirstOnGame=!0,$CommonData.gCData.userInfoButton=null,$CommonData.gCData.isTesting=!1,$CommonData.gCData.isTestingEND=!1,$CommonData.gCData.nowStepsNum=0,$CommonData.gCData.needHLayer=null,$CommonData.gCData.needSLayer=null,$CommonData.gCData.videoUrl=null,$CommonData.gCData.levelStarTime=null,$CommonData.gCData.Part_stepsID=-1,$CommonData.gCData.partname="",$CommonData.gCData.parasPath="",$CommonData.gCData.result=-1,$CommonData.gCData.sceneLogic=null,$CommonData.gCData.MusicVolume=.08,$CommonData.gCData.encryptedData="",$CommonData.gCData.iv="",$CommonData.gCData.gameHideCount=0,$CommonData.gCData.moveCloudNum=0,$CommonData.gCData.moveCloudNamw="",$CommonData.gCData.isShowAlert=!1,$CommonData.gCData.userHeadImg="",$CommonData.gCData.resFirstStep=null,$CommonData.gCData.termid=-1,$CommonData.gCData.currentTermId=-1,$CommonData.gCData.gameJson=null,$CommonData.gCData.layerNodePath=null,$CommonData.gCData.isShowVideo=!1,$CommonData.gCData.learnReportData={},$CommonData.gCData.starPrefab=null,$CommonData.gCData.openid=null,$CommonData.gCData.session_key=null,$CommonData.gCData.isFirstOnScene=!1,$CommonData.gCData.isSceneChange=!1,$CommonData.gCData.isLayerChange=!1,$CommonData.gCData.debrisLayer=null,$CommonData.gCData.mainCameraOffsetX=0,$CommonData.gCData.nowSceneName=null,$CommonData.gCData.isOnhide=!1,$CommonData.gCData.cuotibenIsCanTouch=!0,$CommonData.gCData.bgmEnable=!1,$CommonData.gCData.greenPointEnable=!1,$CommonData.gCData.isClickedUnit=!1,$CommonData.gCData.isShowPassword=!1,$CommonData.gCData.isShowConsultationLayer=!1,$CommonData.gCData.THIS=null,$CommonData.gCData.isPlayingStarBGM=!1,$CommonData.gCData.isUpdatingClass=!1,$CommonData.gCData.planetNum=0,$CommonData.gCData.nowLessonIndex=0},cc._RF.pop()},{}],LoadPlist:[function(e,t,o){"use strict";cc._RF.push(t,"947afrxgdxH4KAoz9xuI9kf","LoadPlist"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../Common/MUtils/MKUtils"),i=function(){function e(e){this.loadSrc="",this.plistRes=null,this.pngRes=null,this.loadSrc=e}return e.prototype._loadPlist=function(e){var t=this;n.default.runPromiseArray([function(){return new Promise(function(e,o){cc.loader.load({url:t.loadSrc+".plist"},function(o,n){if(o)return console.log("errPlist:"+o),null;t.plistRes=n,e()})})},function(){return new Promise(function(e,o){cc.loader.load({url:t.loadSrc+".png"},function(o,n){if(o)return console.log("errPng:"+o),null;t.pngRes=n,e()})})},function(){return new Promise(function(t,o){e()})}])},e.prototype.getNodeSetTexture=function(e){if(this.plistRes&&this.pngRes){var t=this.plistRes.frames[e+".png"];t=this.translateFrame(t);var o=new cc.SpriteFrame;return o.setTexture(this.pngRes,t.frame,t.rotated,t.offset,t.size),o}},e.prototype.translateFrame=function(e){if(!e)return null;var t={frame:null,rotated:null,offset:null,size:null},o=e.frame.match(/[0-9]+/g);return t.frame=cc.rect(parseInt(o[0]),parseInt(o[1]),parseInt(o[2]),parseInt(o[3])),t.rotated=e.rotated,o=e.offset.match(/(\-|[0-9])+/g),t.offset=cc.v2(parseInt(o[0]),parseInt(o[1])),o=e.sourceSize.match(/[0-9]+/g),t.size=cc.size(parseInt(o[0]),parseInt(o[1])),t},e}();o.default=i,cc._RF.pop()},{"../Common/MUtils/MKUtils":"MKUtils"}],MKEventDispatch:[function(e,t,o){"use strict";cc._RF.push(t,"1b06aDUUvVDaK57qHu7MMpl","MKEventDispatch"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(){this.list={}}return e.prototype.on=function(e,t,o){null==this.list[e]&&(this.list[e]=[]);var n={};n.func=t,n.node=o,this.list[e].push(n)},e.prototype.remove=function(e,t){if(this.list[e])for(var o=this.list[e],n=0;n<o.length;n++)o[n].node==t&&(o.splice(n,1),--n)},e.prototype.removeByNode=function(e){for(var t in this.list)for(var o=this.list[t],n=0;n<o.length;n++)o[n].node==e&&(o.splice(n,1),--n)},e.prototype.removeByKey=function(e){delete this.list[e]},e.prototype.emit=function(e,t){if(void 0===t&&(t=null),this.list[e])for(var o=this.list[e].concat(),n=0;n<o.length;n++)o[n].node&&cc.isValid(o[n].node)&&o[n].func(t,o[n].node)},Object.defineProperty(e,"I",{get:function(){return this.singleton||(this.singleton=new e),this.singleton},enumerable:!0,configurable:!0}),e}();o.default=n,window.MKEventDispatch=window.MKEventDispatch||n,cc._RF.pop()},{}],MKLog:[function(e,t,o){"use strict";cc._RF.push(t,"8dfbbTB9OBK+bE1mFiBMNC9","MKLog"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(){}return e.debug=function(t){for(var o=[],n=1;n<arguments.length;n++)o[n-1]=arguments[n];e.isOutputLog()&&console.debug.apply(console,[t].concat(o))},e.info=function(t){for(var o=[],n=1;n<arguments.length;n++)o[n-1]=arguments[n];e.isOutputLog()&&console.info.apply(console,[t].concat(o))},e.log=function(t){for(var o=[],n=1;n<arguments.length;n++)o[n-1]=arguments[n];e.isOutputLog()&&console.log.apply(console,[t].concat(o))},e.warn=function(t){for(var o=[],n=1;n<arguments.length;n++)o[n-1]=arguments[n];e.isOutputLog()&&console.warn.apply(console,[t].concat(o))},e.error=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];console.error.apply(console,[e].concat(t))},e.cccDebug=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o]},e.isOutputLog=function(){return!!window.CCC_DEBUGABLE},e.prototype.getDateString=function(){var e=new Date,t=String(e.getHours()),o="";return o+=(1==t.length?"0"+t:t)+":",o+=(1==(t=String(e.getMinutes())).length?"0"+t:t)+":",o+=(1==(t=String(e.getSeconds())).length?"0"+t:t)+":",1==(t=String(e.getMilliseconds())).length&&(t="00"+t),2==t.length&&(t="0"+t),o="["+(o+=t)+"]"},e}();o.default=n,window.MKLog=window.MKLog||n,cc._RF.pop()},{}],MKSound:[function(e,t,o){"use strict";cc._RF.push(t,"ac0c1LC21ZNuIkEpTke2xCf","MKSound"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../TS_ResourceManager"),i=e("./MKLog"),a=function(){function e(){cc.game.on(cc.game.EVENT_HIDE,function(){i.default.log("cc.audioEngine.pauseAll"),cc.audioEngine.pauseAll()}),cc.game.on(cc.game.EVENT_SHOW,function(){i.default.log("cc.audioEngine.resumeAll"),cc.audioEngine.resumeAll()})}return e.playFailEffect=function(){n.default.loadPersistentRes("public/audio/fail/fail_e1",cc.AudioClip,function(e,t){e?i.default.log("err:"+e):cc.audioEngine.playEffect(t,!1)})},e.getUrl=function(e){return cc.url.raw("resources/"+e)},e.playBGM=function(e){var t=this;if(i.default.log("[MKSound] playBGM url= ",e),i.default.log("[MKSound] this.bgmUrl= ",this.bgmUrl),this.bgmUrl!=e)if(i.default.log("[MKSound] url= ",e),i.default.log("[MKSound] this.bgmAudioID = ",this.bgmAudioID),this.bgmAudioID>=0)i.default.log("cc.audioEngine.isLoop(id) before::",cc.audioEngine.isLoop(this.bgmAudioID)),cc.audioEngine.setLoop(this.bgmAudioID,!1),i.default.log("cc.audioEngine.isLoop(id) after::",cc.audioEngine.isLoop(this.bgmAudioID)),setTimeout(function(){cc.audioEngine.stop(t.bgmAudioID),t.bgmUrl="",t.bgmAudioID=-1;var o=e;i.default.log("[MKSound] playBGM = ",o),i.default.log("this.bgmUrl before= ",t.bgmUrl),n.default.loadPersistentRes(o,cc.AudioClip,function(o,n){o?i.default.log("err:"+o):(i.default.log("this.bgmAudioID before= ",t.bgmAudioID),t.bgmAudioID=cc.audioEngine.playMusic(n,!0),i.default.log("this.bgmAudioID after= ",t.bgmAudioID),t.bgmUrl=e,i.default.log("this.bgmUrl after= ",t.bgmUrl))})},500);else{var o=e;i.default.log("[MKSound] playBGM = ",o),i.default.log("this.bgmUrl before= ",this.bgmUrl),n.default.loadPersistentRes(o,cc.AudioClip,function(o,n){o?i.default.log("err:"+o):(i.default.log("this.bgmAudioID before= ",t.bgmAudioID),t.bgmAudioID=cc.audioEngine.playMusic(n,!0),i.default.log("this.bgmAudioID after= ",t.bgmAudioID),t.bgmUrl=e,i.default.log("this.bgmUrl after= ",t.bgmUrl))})}},e.playEffect=function(e,t){var o=e;return i.default.log("playSFXplaySFXplaySFXplaySFX =",o),o&&this.sfxVolume>0&&n.default.loadTempRes(o,cc.AudioClip,function(e,o){if(!e){var n=cc.audioEngine.playEffect(o,!1);return cc.audioEngine.setFinishCallback(n,function(){t&&t()}),i.default.log("[MKSound] playSFX = ",n),n}i.default.log("err:"+e)}),0},e.setSFXVolume=function(e){this.sfxVolume!=e&&(cc.sys.localStorage.setItem("sfxVolume",e),this.sfxVolume=e)},e.setBGMVolume=function(e,t){this.bgmAudioID>=0&&(e>0?cc.audioEngine.resume(this.bgmAudioID):cc.audioEngine.pause(this.bgmAudioID)),(this.bgmVolume!=e||t)&&(cc.sys.localStorage.setItem("bgmVolume",e),this.bgmVolume=e,cc.audioEngine.setVolume(this.bgmAudioID,e))},e.pauseAll=function(){cc.audioEngine.pauseAll()},e.resumeAll=function(){cc.audioEngine.resumeAll()},e.stopAll=function(){cc.audioEngine.stopAll()},e.stopAppointAudio=function(e){cc.audioEngine.stop(e)},e.stopBGM=function(){var e=this;this.bgmAudioID>=0&&(cc.audioEngine.setLoop(this.bgmAudioID,!1),setTimeout(function(){cc.audioEngine.stop(e.bgmAudioID),e.bgmUrl=""},500))},e.playClickEffect=function(){n.default.loadPersistentRes("public/audio/clickEffect",cc.AudioClip,function(e,t){e?i.default.log("err:"+e):cc.audioEngine.playEffect(t,!1)})},e.playSuccessEffect=function(){n.default.loadPersistentRes("public/audio/succ/succ_e3",cc.AudioClip,function(e,t){e?i.default.log("err:"+e):cc.audioEngine.playEffect(t,!1)})},e.playRandSuccessEffect=function(e){var t="public/audio/succ/succ_"+(Math.floor(4*Math.random())+2);n.default.loadPersistentRes(t,cc.AudioClip,function(t,o){if(t)return i.default.log("err:"+t),void(e&&e());var n=cc.audioEngine.playEffect(o,!1);cc.audioEngine.setFinishCallback(n,function(){e&&e()})})},e.playOverEffect=function(e){n.default.loadPersistentRes("public/audio/overAudio",cc.AudioClip,function(t,o){if(t)i.default.log("err:"+t);else{var n=cc.audioEngine.playEffect(o,!1);MKEventDispatch.I.emit("robotDrag_sayHappy"),cc.audioEngine.setFinishCallback(n,function(){e&&e(),MKEventDispatch.I.emit("robotDrag_normal")})}})},e.playGameBGM=function(){var e=this;$CommonData.gCData.isPlayingStarBGM=!1;var t="public/audio/gameBGM2";this.bgmUrl!=t?n.default.loadPersistentRes(t,cc.AudioClip,function(o,n){o?i.default.log("err:"+o):(i.default.log("-------gameBGM2-----"),cc.audioEngine.stopMusic(),e.bgmUrl="",e.bgmAudioID=cc.audioEngine.playMusic(n,!0),e.bgmUrl=t)}):i.default.log("bgm already playing!++++++++"+t)},e.playStarGameBGM=function(){var e=this;$CommonData.gCData.isPlayingStarBGM=!0;var t="public/audio/gameBGM";n.default.loadPersistentRes(t,cc.AudioClip,function(o,n){o?i.default.log("err:"+o):(i.default.log("-------gameBGM-----"),cc.audioEngine.stopMusic(),e.bgmUrl="",e.bgmAudioID=cc.audioEngine.playMusic(n,!0),e.bgmUrl=t)})},e.starVictoryAudio=function(){var e=this,t="public/audio/ohyeah_"+(Math.floor(2*Math.random())+1);n.default.loadTempRes(t,cc.AudioClip,function(t,o){t?i.default.log("err:"+t):e.starVictoryAudio_aid=cc.audioEngine.playEffect(o,!1)})},e.stopVictoryAudio=function(){this.starVictoryAudio_aid>=0&&(cc.audioEngine.stopEffect(this.starVictoryAudio_aid),this.starVictoryAudio_aid=null)},e.specialEffects=function(e,t){i.default.log("effectRes:"+e),n.default.loadUnitRes(e,cc.AudioClip,function(e,o){if(e)return i.default.log("err:"+e),void(t&&t());var n=cc.audioEngine.playEffect(o,!1);cc.audioEngine.setFinishCallback(n,function(){t&&t()})})},e.playEffectFail=function(e){var t="public/audio/fail/fail_e"+Math.ceil(Math.random()*$CommonData.gCData.failNum);return i.default.log("playEffectFail =",t),t&&this.sfxVolume>0&&n.default.loadPersistentRes(t,cc.AudioClip,function(t,o){if(!t){var n=cc.audioEngine.playEffect(o,!1);return MKEventDispatch.I.emit("robotDrag_fail"),cc.audioEngine.setFinishCallback(n,function(){MKEventDispatch.I.emit("robotDrag_normal"),e&&e()}),i.default.log("[MKSound] playEffectFail = ",n),n}i.default.log("err:"+t)}),0},e.playStarArrayClip=function(e,t){var o=this;window.MKEventDispatch.I.emit("robotDrag_normal"),this.stopExeClip();for(var a=!1,s=[],r=function(e){s.push(function(){return new Promise(function(t,s){n.default.loadTempRes(e,cc.AudioClip,function(e,n){if(e)return i.default.log("err:"+e),void t();a||(MKEventDispatch.I.emit("robotDrag_sayHappy"),a=!0),o.exeClipAudio=cc.audioEngine.playEffect(n,!1),cc.audioEngine.setFinishCallback(o.exeClipAudio,function(){o.exeClipAudio>=0&&(o.exeClipAudio=-1,t())})})})})},c=0,l=e;c<l.length;c++){r(l[c])}s.push(function(){return new Promise(function(e,o){MKEventDispatch.I.emit("robotDrag_thinking"),t&&t(),e()})}),MKUtils.runPromiseArray(s)},e.playErrArrClip=function(e,t){var o=this;this.stopExeClip();var a=!1;window.$CommonData.gCData.ISCANTOUCH=!1;var s=window.$CommonData.gSData.serverData;setTimeout(function(){s.isReviewing||s.isTesting||(window.$CommonData.gCData.ISCANTOUCH=!0,t&&t())},1e3),this.isPlayErrAudio=!0;for(var r=[],c=function(e){r.push(function(){return new Promise(function(t,s){n.default.loadUnitRes(e,cc.AudioClip,function(e,n){if(o.isPlayErrAudio||s(),e)return i.default.log("err:"+e),void t();a||(a=!0,MKEventDispatch.I.emit("robotDrag_saySerious")),o.exeClipAudio=cc.audioEngine.playEffect(n,!1),cc.audioEngine.setFinishCallback(o.exeClipAudio,function(){o.exeClipAudio=-1,t()})})})})},l=0,u=e;l<u.length;l++){c(u[l])}r.push(function(){return new Promise(function(e,o){(s.isReviewing||s.isTesting)&&(window.$CommonData.gCData.ISCANTOUCH=!0,t&&t()),MKEventDispatch.I.emit("robotDrag_normal"),e()})}),MKUtils.runPromiseArray(r)},e.playEndArrayClip=function(e,t){var o=this;window.MKEventDispatch.I.emit("robotDrag_normal");var a=!1;window.$CommonData.gCData.ISCANTOUCH=!1;for(var s=[],r=function(e){s.push(function(){return new Promise(function(t,s){n.default.loadTempRes(e,cc.AudioClip,function(e,n){if(e)return i.default.log("err:"+e),void t();a||(o.exeClipAudio>=0&&(cc.audioEngine.stopEffect(o.exeClipAudio),o.exeClipAudio=-1),MKEventDispatch.I.emit("robotDrag_sayHappy"),a=!0);var s=cc.audioEngine.playEffect(n,!1);cc.audioEngine.setFinishCallback(s,function(){s>=0&&(s=-1,t())})})})})},c=0,l=e;c<l.length;c++){r(l[c])}s.push(function(){return new Promise(function(e,o){window.$CommonData.gCData.ISCANTOUCH=!0,MKEventDispatch.I.emit("robotDrag_thinking"),t&&t(),e()})}),MKUtils.runPromiseArray(s)},e.dragRobotSayArr=function(e,t){var o=!1;$CommonData.gCData.ISCANTOUCH=!1;for(var a=[],s=function(e){a.push(function(){return new Promise(function(t,a){n.default.loadTempRes(e,cc.AudioClip,function(e,n){if(e)return i.default.log("err:"+e),void t();o||(MKEventDispatch.I.emit("robotDrag_sayHappy"),o=!0);var a=cc.audioEngine.playEffect(n,!1);cc.audioEngine.setFinishCallback(a,function(){t()})})})})},r=0,c=e;r<c.length;r++){s(c[r])}a.push(function(){return new Promise(function(e,o){$CommonData.gCData.ISCANTOUCH=!0,MKEventDispatch.I.emit("robotDrag_normal"),t&&t(),e()})}),MKUtils.runPromiseArray(a)},e.dragRobotSay=function(e,t,o){i.default.log("audioRes:"+e),n.default.loadTempRes(e,cc.AudioClip,function(e,n){if(e)return i.default.log("err:"+e),MKEventDispatch.I.emit("robotDrag_sayHappy"),void(t&&t());i.default.log("robotDrag_sayHappy"),o&&o(),MKEventDispatch.I.emit("robotDrag_sayHappy");var a=cc.audioEngine.playEffect(n,!1);cc.audioEngine.setFinishCallback(a,function(){MKEventDispatch.I.emit("robotDrag_normal"),t&&t()})})},e.dragPuddingSay=function(e,t,o){i.default.log("audioRes:"+e),n.default.loadTempRes(e,cc.AudioClip,function(e,n){if(e)return i.default.log("err:"+e),void(t&&t());var a=cc.audioEngine.playEffect(n,!1);MKEventDispatch.I.emit("puddingDrag_shuohua"),o&&o(),cc.audioEngine.setFinishCallback(a,function(){MKEventDispatch.I.emit("puddingDrag_daiji"),t&&t()})})},e.playEffectEx=function(e,t,o){i.default.log("playEffectEx url=",e),n.default.loadTempRes(e,cc.AudioClip,function(n,a){if(n)return i.default.error("load res "+e+" failed! directly callback!"),void(o&&o());var s=new Promise(function(o,n){var s=cc.audioEngine.playEffect(a);s>=0?(t&&t(),cc.audioEngine.setFinishCallback(s,function(){i.default.info(" play res "+e+" successful! callback!"),o()})):(i.default.info(" play res "+e+" failed! callback!"),o())}),r=new Promise(function(e,t){setTimeout(function(){e()},25e3)});Promise.race([s,r]).then(function(){i.default.info("callback from commonutil"),o&&o()})})},e.playEffectEx1=function(e,t,o,a){i.default.log("playEffectEx1 url=",e),n.default.loadTempRes(e,cc.AudioClip,function(n,s){if(n)return i.default.error("load res "+e+" failed! directly callback!"),void(o&&o());var r=new Promise(function(o,n){a.scheduleOnce(function(){var n=cc.audioEngine.playEffect(s);n>=0?(t&&t(),cc.audioEngine.setFinishCallback(n,function(){i.default.info(" play res "+e+" successful! callback!"),o()})):(i.default.info(" play res "+e+" failed! callback!"),o())},0)}),c=new Promise(function(e,t){a.scheduleOnce(function(){i.default.info("2.timeout, callback!"),e()},25)});Promise.race([r,c]).then(function(){i.default.info("callback from promise commonutil"),a.scheduleOnce(function(){i.default.info("callback from promise commonutil111111111"),o&&o()},0)})})},e.playVoice_new=function(e,t,o){i.default.log("playVoice_new effectRes=",e),n.default.loadTempRes(e,cc.AudioClip,function(e,n){if(e)o&&o();else{var i=cc.audioEngine.playEffect(n,!1);Promise.race([new Promise(function(e,o){t.getComponent(dragonBones.ArmatureDisplay).playAnimation("shuohua"),cc.audioEngine.setFinishCallback(i,function(){t.getComponent(dragonBones.ArmatureDisplay).playAnimation("daiji"),e()})}),new Promise(function(e,t){setTimeout(function(){e()},3e4)})]).then(function(){o&&o()})}})},e.playStartEngine_new=function(e,t){$CommonData.gCData.ISCANTOUCH=!1,n.default.loadTempRes(e,cc.AudioClip,function(e,o){if(e)t&&t();else{var n=cc.audioEngine.playEffect(o,!1);MKEventDispatch.I.emit("robotDrag_sayHappy");Promise.race([new Promise(function(e,t){cc.audioEngine.setFinishCallback(n,function(){e()})}),new Promise(function(e,t){setTimeout(function(){e()},35e3)})]).then(function(){MKEventDispatch.I.emit("robotDrag_normal"),t&&t()})}})},e.stopExeClip=function(){window.$CommonData.gCData.ISCANTOUCH&&(this.isPlayErrAudio=!1,this.exeClipAudio>=0&&(cc.audioEngine.stopEffect(this.exeClipAudio),MKEventDispatch.I.emit("robotDrag_normal"),this.exeClipAudio=-1))},e.playVoice=function(e,t,o){n.default.loadTempRes(e,cc.AudioClip,function(e,n){if(e)t&&t();else if(o&&!0===o)cc.audioEngine.playEffect(n,!0);else{var i=cc.audioEngine.playEffect(n,!1),a=cc.audioEngine.getDuration(i);Promise.race([new Promise(function(e,t){cc.audioEngine.setFinishCallback(i,function(){e()})}),new Promise(function(e,t){$CommonData.gCData.THIS.scheduleOnce(function(){e()},25)})]).then(function(){t&&t(a)})}})},e.playVoiceEx=function(e,t,o){n.default.loadTempRes(e,cc.AudioClip,function(e,n){if(e)o&&o();else{var i=cc.audioEngine.playEffect(n,!1);i>=0&&t&&t();Promise.race([new Promise(function(e,t){cc.audioEngine.setFinishCallback(i,function(){e()})}),new Promise(function(e,t){$CommonData.gCData.THIS.scheduleOnce(function(){e()},25)})]).then(function(){o&&o()})}})},e.bgmVolume=1,e.sfxVolume=1,e.bgmAudioID=-1,e.bgmUrl="",e.sfxAudioID=-1,e.starVictoryAudio_aid=-1,e.exeClipAudio=-1,e.isPlayErrAudio=!1,e}();o.default=a,window.MKSound=window.MKSound||a,cc._RF.pop()},{"../TS_ResourceManager":"TS_ResourceManager","./MKLog":"MKLog"}],MKSystem:[function(e,t,o){"use strict";function n(){return cc.sys.isNative&&(cc.sys.os==cc.sys.OS_IOS||cc.sys.os==cc.sys.OS_ANDROID)}function i(){return cc.sys.os==cc.sys.OS_IOS}function a(){return cc.sys.os==cc.sys.OS_ANDROID}function s(){return cc.sys.platform==cc.sys.WECHAT_GAME}function r(){return!1}cc._RF.push(t,"3b0fej86xJLk6QboRugpgT7","MKSystem"),Object.defineProperty(o,"__esModule",{value:!0}),o.isNative=n,o.isOsIOS=i,o.isOsAndroid=a,o.isPlatWechatGame=s,o.isPlatTouTiaoGame=r,o.getPlatType=function(){return a()?"ANDROID":i()?"IOS":cc.sys.isBrowser?"H5":""},o.getSourceType=function(){return s()?"wx":"h5"},o.getApkVersionCode=function(){return jsb.reflection.callStaticMethod("org/cocos2dx/javascript/AppActivity","getVersionCode","()I")},o.getIpaVersion=function(){return jsb.reflection.callStaticMethod("reflectClass","getVersion")},o.getApkVersion=function(){return jsb.reflection.callStaticMethod("org/cocos2dx/javascript/AppActivity","getVersionName","()Ljava/lang/String;")},o.isWifi=function(){return!n()||(cc.sys.os===cc.sys.OS_ANDROID?jsb.reflection.callStaticMethod("org/cocos2dx/javascript/AppActivity","isWifi","()Z"):!jsb.reflection.callStaticMethod("reflectClass","isWifi"))},o.getDeviceID=function(){return i()&&n()?jsb.reflection.callStaticMethod("reflectClass","getDeviceId"):jsb.reflection.callStaticMethod("org/cocos2dx/javascript/AppActivity","getMac","()Ljava/lang/String;")},o.endGame=function(){n()?cc.sys.os===cc.sys.OS_ANDROID?cc.game.end():jsb.reflection.callStaticMethod("reflectClass","close"):cc.game.end()},o.getBattery=function(){return i()&&n()?100*jsb.reflection.callStaticMethod("reflectClass","getBattery"):jsb.reflection.callStaticMethod("org/cocos2dx/javascript/AppActivity","getBattery","()Ljava/lang/String;")},cc._RF.pop()},{}],MKTime:[function(e,t,o){"use strict";cc._RF.push(t,"3e3754g1iVLrKpj+KIgEOrK","MKTime"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(){}return e.pad=function(e,t){var o="0000000000000000000000000000"+e;return o.substr(o.length-t)},e.getMSeconds=function(){return(new Date).getTime()},e.formatHM=function(e){var t=new Date;e&&t.setTime(1e3*e);return this.pad(t.getHours(),2)+":"+this.pad(t.getMinutes(),2)},e.getNowTime=function(){var e=new Date,t=e.getFullYear(),o=Number(e.getMonth())+1,n=e.getDate(),i=e.getHours(),a=e.getMinutes(),s=e.getSeconds();return t+"-"+(o<10?"0"+o:o)+"-"+(n<10?"0"+n:n)+" "+(i<10?"0"+i:i)+":"+(a<10?"0"+a:a)+":"+(s<10?"0"+s:s)},e.getSeconds=function(){return Math.round(this.getMSeconds()/1e3)},e.formatTime=function(e){var t=Math.floor(e/3600),o=Math.floor((e-3600*t)/60),n=Math.ceil(e%60);return("0"+t).substring(("0"+t).length-2)+":"+("0"+o).substring(("0"+o).length-2)+":"+("0"+n).substring(("0"+n).length-2)},e.formatTimeAsciiSc=function(e){var t=Math.floor(e/3600),o=Math.floor((e-3600*t)/60),n=Math.ceil(e%60);return t+"\u5c0f\u65f6"+("0"+o).substring(("0"+o).length-2)+"\u5206"+("0"+n).substring(("0"+n).length-2)+"\u79d2"},e.formatTimeDDHHMMSS=function(e){var t=Math.floor(e/3600),o=Math.floor((e-3600*t)/60),n=Math.ceil(e%60),i=Math.floor(t/24);t-=24*i;return i>0?i+"\u5929"+t+"\u5c0f\u65f6"+("0"+o).substring(("0"+o).length-2)+"\u5206"+("0"+n).substring(("0"+n).length-2)+"\u79d2":t+"\u5c0f\u65f6"+("0"+o).substring(("0"+o).length-2)+"\u5206"+("0"+n).substring(("0"+n).length-2)+"\u79d2"},e.formatTimeMS=function(e){var t=Math.floor(e/3600),o=Math.floor((e-3600*t)/60),n=Math.floor(e%60);return("0"+o).substring(("0"+o).length-2)+":"+("0"+n).substring(("0"+n).length-2)},e.getNowFormatDate=function(e){var t=new Date;e&&t.setTime(1e3*e);var o=t.getMonth()+1,n=t.getDate();return o>=1&&o<=9&&(o="0"+o),n>=0&&n<=9&&(n="0"+n),t.getFullYear()+"-"+o+"-"+n+" "+this.pad(t.getHours(),2)+":"+this.pad(t.getMinutes(),2)+":"+this.pad(t.getSeconds(),2)},e.getTimeFormatDate=function(e){var t=new Date;e&&t.setTime(1e3*e);var o=t.getMonth()+1,n=t.getDate();return o>=1&&o<=9&&(o="0"+o),n>=0&&n<=9&&(n="0"+n),o+"-"+n+" "+this.pad(t.getHours(),2)+":"+this.pad(t.getMinutes(),2)},e.getDateYYYYMMDD=function(){var e=new Date,t=e.getMonth()+1,o=e.getDate();return t>=1&&t<=9&&(t="0"+t),o>=0&&o<=9&&(o="0"+o),String(e.getFullYear())+String(t)+String(o)},e.getTimeFormat=function(e){var t=new Date(e),o=t.getMonth()+1,n=t.getDate();return o>=1&&o<=9&&(o="0"+o),n>=0&&n<=9&&(n="0"+n),String(t.getFullYear())+"."+String(o)+"."+String(n)},e.getDateMMDDOrStr=function(e){var t=new Date;e&&t.setTime(1e3*e);var o=t.getMonth()+1,n=t.getDate();return o>=1&&o<=9&&(o="0"+o),n>=0&&n<=9&&(n="0"+n),o+"-"+n},e}();o.default=n,window.MKTime=window.MKTime||n,cc._RF.pop()},{}],MKUtils:[function(e,t,o){"use strict";cc._RF.push(t,"e6c9b8ZXRBEM5vMYMAQuADL","MKUtils"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(){}return e.clone=function(e){var t={};if("object"==typeof e)if(null===e)t=null;else if(e instanceof Array){t=[];for(var o=0,n=e.length;o<n;o++)t.push(this.clone(e[o]))}else for(var i in t={},e)t[i]=this.clone(e[i]);else t=e;return t},e.shortName=function(e){return e.length<=12?e:e.substr(0,11)+"..."},e.nameMaxCut=function(e,t){for(var o="",n=0,i=0;i<e.length;i++){var a=e[i];a.charCodeAt()>255?n+=2:n++,n<=t&&(o+=a)}return n>t?o+"..":o},e.isFun=function(e){return e&&"function"==typeof e},e.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},e.getCardValueByServerData=function(e){return 10*(e[0]-1)+e[1]},e.getServerCardVarlue=function(e){return[Math.floor(e/10)+1,e%10]},e.cutString=function(e,t){var o,n=e.length,i="1",a=0,s=!1;if(n<=t/2&&(o=e,s=!0),!s)for(var r=0;r<n;r++){if(this.isFull(e.charAt(r))?a+=2:a+=1,a>t){o=e.substring(0,r),s=!0;break}if(a==t){o=e.substring(0,r+1),s=!0;break}}return s||(o=e,s=!0),o.length==n&&(i="0"),{cutstring:o,cutflag:i}},e.isFull=function(e){for(var t=0;t<e.strLen;t++)return e.charCodeAt(t)>128},e.autoAddEllipsis=function(e,t){var o=this.cutString(e,t),n=o.cutflag,i=o.cutstring;return"1"==n?i+"...":i},e.getNumberChinese=function(e){var t="";switch(e){case 1:t="\u58f9";break;case 2:t="\u8d30";break;case 3:t="\u53c1";break;case 4:t="\u8086";break;case 5:t="\u4f0d";break;case 6:t="\u9646";break;case 7:t="\u67d2";break;case 8:t="\u634c";break;case 9:t="\u7396";break;case 0:t="\u62fe"}return t},e.getNumberCapital=function(e){var t="";switch(e){case 1:t="\u4e00";break;case 2:t="\u4e8c";break;case 3:t="\u4e09";break;case 4:t="\u56db";break;case 5:t="\u4e94";break;case 6:t="\u516d";break;case 7:t="\u4e03";break;case 8:t="\u516b";break;case 9:t="\u4e5d";break;case 0:t="\u5341"}return t},e.getConvertFormatNumber=function(t,o){var n;void 0===o&&(o=!0),n=o?e.getNumberCapital:e.getNumberChinese;var i=Math.floor(t/10),a=t%10,s="",r="";return i>0&&(s=1===i?n(0):n(i)+n(0)),a>0&&(r=n(a)),s+r},e.checkOtherChar=function(e){for(var t=["&","\\","/","*",">","<","@","!"],o=0;o<t.length;o++)for(var n=0;n<e.length;n++)if(t[o]==e.charAt(n))return!0;return!1},e.removeDupItem=function(e,t){for(var o=[],n=[],i=0;i<t.length;i++)o[t[i]]=!0;for(i=0;i<e.length;i++)o[e[i]]||n.push(e[i]);return n},e.compareVersion=function(e,t){e=e.split("."),t=t.split(".");for(var o=Math.max(e.length,t.length);e.length<o;)e.push("0");for(;t.length<o;)t.push("0");for(var n=0;n<o;n++){var i=parseInt(e[n]),a=parseInt(t[n]);if(i>a)return 1;if(i<a)return-1}return 0},e.runPromiseArray=function(e){for(var t=Promise.resolve(),o=0,n=e;o<n.length;o++){var i=n[o];t=t.then(i)}return t},e.changeNumberSort=function(e,t){for(var o=[],n=0;n<e.length;n++)if(e[n]!=t[n]){var i=t.indexOf(e[n]),a=t[n];t[n]=t[i],t[i]=a,o.push([n,i])}return o},e.setDragonAnimation=function(e,t,o){e.getComponent(dragonBones.ArmatureDisplay).armature().getSlot(t).childArmature.animation.play(o)},e.clearAllStorage=function(){console.log("clearAllStorageclearAllStorage:"),cc.sys.localStorage.removeItem("hall_Version_DB"),cc.sys.localStorage.removeItem("hall_BuildVersion_DB"),cc.sys.localStorage.removeItem("GameLocalData"),console.log("[main.js] \u70ed\u66f4\u65b0SearchPath before1111: "+cc.sys.localStorage.getItem("HotUpdateSearchPaths")),cc.sys.localStorage.removeItem("HotUpdateSearchPaths"),console.log("[main.js] \u70ed\u66f4\u65b0SearchPath after2222: "+cc.sys.localStorage.getItem("HotUpdateSearchPaths")),console.log("[main.js] HallBaseVersion before1111: "+cc.sys.localStorage.getItem("HallBaseVersion")),cc.sys.localStorage.removeItem("HallBaseVersion"),console.log("[main.js] HallBaseVersion after2222: "+cc.sys.localStorage.getItem("HallBaseVersion")),jsb.fileUtils.removeDirectory(jsb.fileUtils.getWritablePath())},e.showVideo=function(e,t){window.$CommonData.gCData.isShowVideo=!0,cc.audioEngine.pauseAllEffects(),cc.audioEngine.pauseMusic(),window.$CommonData.gCData.THIS.video&&(window.$CommonData.gCData.THIS.video.destroy(),window.$CommonData.gCData.THIS.video=null);var o=new cc.Node;window.$CommonData.gCData.THIS.videoPlayer=o.addComponent(cc.VideoPlayer),window.$CommonData.gCData.THIS.videoPlayer.node.parent=window.$CommonData.gCData.THIS.node,window.$CommonData.gCData.THIS.videoPlayer.active=!0;var n=window.$CommonData.gCData.THIS.videoPlayer.getComponent(cc.VideoPlayer);n.remoteURL=e,n.node.width=cc.winSize.width,n.node.height=cc.winSize.height,n.play(),n.node.on("completed",function(){cc.audioEngine.resumeAllEffects(),cc.audioEngine.resumeMusic(),o&&o.destroy(),window.$CommonData.gCData.isShowVideo=!1,t&&t()})},e}();o.default=n,window.MKUtils=window.MKUtils||n,cc._RF.pop()},{}],MessageBox:[function(e,t,o){"use strict";cc._RF.push(t,"05860g4YxRDmaUAF7akHL+f","MessageBox"),Object.defineProperty(o,"__esModule",{value:!0}),o.MessageType={BtnOKCancle:1,BtnOK:2},o.MessageBoxStyle={OKCancle:1,CustomerServiceCancle:2,ComeCancle:3};var n=cc._decorator,i=n.ccclass,a=n.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.label=null,t.tipLabel=null,t.titleLabel=null,t.LeftCallback=null,t.RightCallback=null,t.leftBtn=null,t.rightBtn=null,t}return __extends(t,e),t.prototype.onload=function(){},t.prototype.onClose=function(){this.node.getParent().destroy()},t.prototype.setLeftCallbck=function(e){this.LeftCallback=e},t.prototype.setRightCallbck=function(e){this.RightCallback=e},t.prototype.onClickLeft=function(){this.LeftCallback&&this.LeftCallback(),this.onClose()},t.prototype.onClickRight=function(){this.RightCallback&&this.RightCallback(),this.onClose()},t.prototype.onSetLabelStr=function(e){this.tipLabel.string=e},t.prototype.onSetTitleStr=function(e){this.titleLabel.string=e},t.prototype.setType=function(e){1!=e&&(this.leftBtn.node.active=!1,this.rightBtn.node.x=0)},t.prototype.setBtnStyle=function(e){var t=this;switch(void 0===e&&(e=1),e){case o.MessageBoxStyle.OKCancle:cc.loader.loadRes("shared/common/bt_public_enter_normal",cc.SpriteFrame,function(e,o){e||t.rightBtn&&cc.isValid(t.rightBtn)&&(t.rightBtn.normalSprite=o,t.rightBtn.hoverSprite=o)}),cc.loader.loadRes("shared/common/bt_public_enter_select",cc.SpriteFrame,function(e,o){e||t.rightBtn&&cc.isValid(t.rightBtn)&&(t.rightBtn.pressedSprite=o,t.rightBtn.disabledSprite=o)});break;case o.MessageBoxStyle.CustomerServiceCancle:cc.loader.loadRes("shared/common/img_public_qwkf_normal",cc.SpriteFrame,function(e,o){e||t.rightBtn&&cc.isValid(t.rightBtn)&&(t.rightBtn.normalSprite=o,t.rightBtn.hoverSprite=o)}),cc.loader.loadRes("shared/common/img_public_qwkf_select",cc.SpriteFrame,function(e,o){e||t.rightBtn&&cc.isValid(t.rightBtn)&&(t.rightBtn.pressedSprite=o,t.rightBtn.disabledSprite=o)});break;case o.MessageBoxStyle.ComeCancle:cc.loader.loadRes("shared/common/bt_public_qw1_normal",cc.SpriteFrame,function(e,o){e||t.rightBtn&&cc.isValid(t.rightBtn)&&(t.rightBtn.normalSprite=o,t.rightBtn.hoverSprite=o)}),cc.loader.loadRes("shared/common/bt_public_qw1_select",cc.SpriteFrame,function(e,o){e||t.rightBtn&&cc.isValid(t.rightBtn)&&(t.rightBtn.pressedSprite=o,t.rightBtn.disabledSprite=o)})}},__decorate([a(cc.Label)],t.prototype,"label",void 0),__decorate([a(cc.RichText)],t.prototype,"tipLabel",void 0),__decorate([a(cc.Label)],t.prototype,"titleLabel",void 0),__decorate([a(cc.Button)],t.prototype,"leftBtn",void 0),__decorate([a(cc.Button)],t.prototype,"rightBtn",void 0),t=__decorate([i],t)}(cc.Component);o.default=s,cc._RF.pop()},{}],MessageTip:[function(e,t,o){"use strict";cc._RF.push(t,"8e5eatQDFlA4bba44BsWCYK","MessageTip"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,i=n.ccclass,a=n.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.rtDesc=null,t.delayTime=1.5,t.fadeoutTime=.5,t}return __extends(t,e),t.prototype.onLoad=function(){},t.prototype.start=function(){},t.prototype.showTip=function(e){var t=this;this.node.stopAllActions(),this.node.active=!0,this.node.opacity=255,this.rtDesc.string=e;var o=cc.sequence(cc.delayTime(this.delayTime),cc.fadeOut(this.fadeoutTime),cc.callFunc(function(){t.node.active=!1},this.node));this.node.runAction(o)},__decorate([a(cc.RichText)],t.prototype,"rtDesc",void 0),__decorate([a],t.prototype,"delayTime",void 0),__decorate([a],t.prototype,"fadeoutTime",void 0),t=__decorate([i],t)}(cc.Component);o.default=s,cc._RF.pop()},{}],Review_RockJump_wx:[function(e,t,o){"use strict";cc._RF.push(t,"ad8edaIXFZHs5t0Q8EfUeEl","Review_RockJump_wx");var n=s(e("../../Common/TS_common")),i=s(e("../../Common/TS_ResourceManager")),a=s(e("../../Common/TS_NetCenter"));function s(e){return e&&e.__esModule?e:{default:e}}cc.Class({extends:cc.Component,properties:{},getLastUnitId:function(e){var t=-1,o=0;for(o=0;o<$CommonData.gSData.serverData.units.length;o++){if($CommonData.gSData.serverData.units[o].id==e){if(o>0){var n=$CommonData.gSData.serverData.units[o-1];if(console.log(n),t=n.id,"NORMAL"!==n.unitType)return this.getLastUnitId(t)}break}}return t},init:function(){var e=this;if(this.door=cc.find("BGNode/gameBG/chuansongmen_ske",this.node).getComponent(dragonBones.ArmatureDisplay),this.ani=cc.find("BGNode/gameBG/keqianceshi_ske",this.node).getComponent(dragonBones.ArmatureDisplay),this.winNode=cc.find("winNode",this.node),this.btnSkip=cc.find("skip",this.node),this.ready=!1,this.beginAudioID=-1,this.cacheDataJson=$CommonData.gCData.gameJson,this.cacheStepInfo=$CommonData.gSData.serverData.currentStep,this.dataJson=null,this.steps=[],this.scount=0,this.stageNode=this.node.parent,this.currentNode=null,$CommonData.gSData.serverData.isReviewing=!0,$CommonData.gSData.serverData.reviewNode=this.node,$CommonData.gSData.serverData.reviewUnitId=this.lastunitid,this.confirmButton=cc.find("Canvas/UILayer/confirmButton").getComponent(cc.Widget),this.confirmButton.bottom=400,this.laba=cc.find("Canvas/UILayer/laba"),this.laba.active=!1,this.laba.on("touchend",function(){$CommonData.gCData.ISCANTOUCH&&!$CommonData.gCData.isAtMiniGame&&(e.laba.getComponent(dragonBones.ArmatureDisplay).playAnimation("\u64ad\u653e",0),console.log("send say again message!!!"),MKEventDispatch.I.emit("sayAgain"))},this),this.lastunitid>=0){var t=n.default.getResnameByUnitId(this.lastunitid);this.jsonResUrl="S"+t+"Res/DataJson/S"+t+"DataJosn",i.default.loadUnitRes(this.jsonResUrl,cc.JsonAsset,function(t,o){if(t)return console.log("\u6ca1\u6709\u53d6\u5230JSON\u6570\u636e\uff01\u8df3\u8fc7\u8bfe\u524d\u590d\u4e60"),$CommonData.gSData.serverData.isReviewing=!1,e.confirmButton.bottom=100,void n.default.net_send_stepData(1,1);e.dataJson=o.json,$CommonData.gCData.gameJson=e.dataJson,console.log(n.default.gameJson),console.log(e.jsonResUrl+"----loaded!"),e.steps.length>0&&(e.ready=!0)})}var o={termid:$CommonData.gSData.serverData.currentTerm.id,userid:$CommonData.gCData.userId,unitid:this.lastunitid};a.default.httpGet("getReviewSteps",o,function(t){console.log("getReviewSteps:"+t),e.steps=JSON.parse(t),null!=e.dataJson&&(e.ready=!0)},function(){console.log("\u53d6\u4e0d\u5230\u590d\u4e60\u9898\u6570\u636e\uff01\u8df3\u8fc7\u8bfe\u524d\u590d\u4e60\uff01"),$CommonData.gSData.serverData.isReviewing=!1,e.confirmButton.bottom=100,n.default.net_send_stepData(1,1)}),this.node.on("QuestionOver",function(t){console.log("--------------QuestionOver-------------------");var o=t.getUserData(),n=1;o&&(n=o.isSuccess),e.gotoNext(n)},this),this.btnSkip.on("touchend",function(t){e.btnSkip.active=!1,e.beginAudioID>=0&&(cc.audioEngine.stopEffect(e.beginAudioID),e.beginAudioID=-1),$CommonData.gSData.serverData.isReviewing=!1,$CommonData.gSData.serverData.currentStep=e.cacheStepInfo,$CommonData.gCData.gameJson=e.cacheDataJson,e.confirmButton.bottom=100,$CommonData.gCData.levelStarTime=e.init_LevelStarTime,n.default.net_send_stepData(1,1)},this),this.startBtn=cc.find("startLayout/startBtn",this.node),this.startBtn.active=!0,this.startBtn.once(cc.Node.EventType.TOUCH_START,function(){this.btnSkip.active=!1,this.startLayout.active=!1,this.beginAudioID>=0&&(cc.audioEngine.stopEffect(this.beginAudioID),this.beginAudioID=-1),this.runStep_start()},this)},runStep:function(){var e=this;if($CommonData.gCData.THIS=this,this.init_LevelStarTime=MKTime.getNowTime(),this.unitid=$CommonData.gSData.serverData.currentUnitId,this.lastunitid=this.getLastUnitId(this.unitid),-1!=this.lastunitid){this.init();var t=new Array;t.push(function(){return new Promise(function(t,o){e.startLayout=cc.find("startLayout",e.node),e.startLayout.active=!0,i.default.loadTempRes("public/review/keqian-start",cc.AudioClip,function(o,n){o?console.log("err:"+o):(e.beginAudioID=cc.audioEngine.playEffect(n,!1),cc.audioEngine.setFinishCallback(e.beginAudioID,function(){t()}))})})}),t.push(function(){return new Promise(function(e,t){e()})}),MKUtils.runPromiseArray(t)}else console.log("\u6ca1\u6709\u4e0a\u4e00\u8bfe\uff0c\u6ca1\u6709\u53ef\u590d\u4e60\u7684\uff0c\u8df3\u8fc7\u8bfe\u524d\u590d\u4e60\u73af\u8282\uff01\uff01\uff01")},runStep_start:function(){var e=this,t=[];t.push(function(){return new Promise(function(t,o){e.ani.playAnimation("A0chuchang",1),e.ani.addEventListener(dragonBones.EventObject.COMPLETE,function(){e.ani.removeEventListener(dragonBones.EventObject.COMPLETE),e.ani.playAnimation("A1daiji0",0),cc.find("BGNode/gameBG/chuansongmen_ske",e.node).active=!0,e.door.playAnimation("1daiji",0)},e),MKSound.playVoice("public/review/rr_begin",function(){console.log("promise2 success!"),t()})})}),t.push(function(){return new Promise(function(t,o){console.log("check steps----"+e.steps),e.loadQuestion(),t()})}),MKUtils.runPromiseArray(t)},loadQuestion:function(){var e=this;$CommonData.gCData.levelStarTime=MKTime.getNowTime();var t=this.steps[0];if(null!=t){console.log("----load question--------");var o=t.paras,n=(o=JSON.parse(o)).scriptName;$CommonData.gCData.parasPath=o.path,$CommonData.gSData.serverData.currentStep=t;var a=o.path.lastIndexOf("/"),s="gameExercisePrefab/"+o.path.substring(a+1);console.log("prefab_path=="+s);var r=null;i.default.loadTempRes(s,cc.Prefab,function(t,o){t?console.log("\u52a0\u8f7d\u4e60\u9898prefab\u5931\u8d25\uff01"):(r=cc.instantiate(o),e.runStepNext(r,n))})}else console.log("\u6ca1\u6709\u6307\u5b9a\u8981\u6267\u884c\u7684\u73af\u8282\uff01")},runStepNext:function(e,t){var o=this.currentNode;o&&(o.active=!1),e.scale=.8,e.active=!0,this.stageNode.addChild(e);var n=e.getComponent(cc.Widget);n.bottom=200/3,n.left=-200/3,this.currentNode=e,console.log("scriptName:"+t);var i=e.getComponent(t);null==i?console.log("Review_RockJump\u6ca1\u6709\u83b7\u53d6\u5230\u811a\u672c\u5f15\u7528\uff01"):i.runStep(),this.confirmButton.bottom=800/3,this.laba.active=!0,this.laba.getComponent(dragonBones.ArmatureDisplay).playAnimation("\u64ad\u653e",0),console.log("-------------"),$CommonData.gSData.serverData.laba=this.laba,o&&(o.destroy(),o=null)},playError:function(){var e=this,t=this.scount,o="A2-3dashibai",n="A2-3-huanyuan",i="A1daiji0";1==t?(o="B2-3dashibai",n="B2-3-huanyuan",i="B1daiji"):2==t?(o="C2-3dashibai",n="C2-3-huayuan",i="C1daiji"):3==t&&(o="D2-3dashibai",n="D2-3-huanyuan",i="D1daiji");var a=[];a.push(function(){return new Promise(function(t,n){e.ani.playAnimation(o,1),e.ani.addEventListener(dragonBones.EventObject.COMPLETE,function(){e.ani.removeEventListener(dragonBones.EventObject.COMPLETE),console.log("promise1 success!"),t()},e),MKSound.playVoice("public/review/rr_fall",function(){})})}),a.push(function(){return new Promise(function(t,o){e.ani.playAnimation(n,1),e.ani.addEventListener(dragonBones.EventObject.COMPLETE,function(){e.ani.removeEventListener(dragonBones.EventObject.COMPLETE),e.ani.playAnimation(i,0)},e);var a="public/review/keqian-6";e.scount%2==0&&(a="public/review/keqian-7"),MKSound.playVoice(a,function(){console.log("promise3 success!"),t()})})}),a.push(function(){return new Promise(function(t,o){var n=e.steps.shift();e.steps.push(n),e.loadQuestion(),t()})}),MKUtils.runPromiseArray(a)},success_1:function(){var e=this,t=[];t.push(function(){return new Promise(function(t,o){e.ani.playAnimation("A2-1chenggongA-B",1),e.ani.addEventListener(dragonBones.EventObject.COMPLETE,function(){e.ani.removeEventListener(dragonBones.EventObject.COMPLETE),e.ani.playAnimation("B1daiji",0)},e),MKSound.playVoice("public/review/rr_jump",null),console.log("promise1 success!"),t()})}),t.push(function(){return new Promise(function(e,t){MKSound.playVoice("public/review/keqian-4",function(){e()})})}),t.push(function(){return new Promise(function(t,o){console.log("\u7b2c\u4e00\u6b65\u6210\u529f\uff0c\u8fd9\u91cc\u8be5\u5e72\u70b9\u4ec0\u4e48\u3002"),e.steps.shift(),e.loadQuestion(),t()})}),MKUtils.runPromiseArray(t)},success_2:function(){var e=this,t=[];t.push(function(){return new Promise(function(t,o){e.ani.playAnimation("B2-1chenggongB-C",1),e.ani.addEventListener(dragonBones.EventObject.COMPLETE,function(){e.ani.removeEventListener(dragonBones.EventObject.COMPLETE),e.ani.playAnimation("C1daiji",0)},e),MKSound.playVoice("public/review/rr_jump",null),console.log("promise1 success!"),t()})}),t.push(function(){return new Promise(function(e,t){MKSound.playVoice("public/review/keqian-5",function(){e()})})}),t.push(function(){return new Promise(function(t,o){console.log("\u7b2c\u4e8c\u6b65\u6210\u529f\uff0c\u8fd9\u91cc\u8be5\u5e72\u70b9\u4ec0\u4e48\u3002"),e.steps.shift(),e.loadQuestion(),t()})}),MKUtils.runPromiseArray(t)},success_3:function(){var e=this,t=[];t.push(function(){return new Promise(function(t,o){e.ani.playAnimation("C2-1chenggongC-D",1),e.ani.addEventListener(dragonBones.EventObject.COMPLETE,function(){e.ani.removeEventListener(dragonBones.EventObject.COMPLETE),e.ani.playAnimation("D1daiji",0)},e),MKSound.playVoice("public/review/rr_jump",null),console.log("promise1 success!"),t()})}),t.push(function(){return new Promise(function(e,t){MKSound.playVoice("public/review/keqian-4",function(){e()})})}),t.push(function(){return new Promise(function(t,o){console.log("\u7b2c\u4e09\u6b65\u6210\u529f\uff0c\u8fd9\u91cc\u8be5\u5e72\u70b9\u4ec0\u4e48\u3002"),e.steps.shift(),e.loadQuestion(),t()})}),MKUtils.runPromiseArray(t)},success_4:function(){var e=this,t=[];t.push(function(){return new Promise(function(t,o){e.ani.playAnimation("D2-1chenggongD-E",1),e.ani.addEventListener(dragonBones.EventObject.COMPLETE,function(){e.ani.removeEventListener(dragonBones.EventObject.COMPLETE),e.ani.playAnimation("E1daiji",0)},e),MKSound.playVoice("public/review/rr_jump",null),console.log("promise1 success!"),t()})}),t.push(function(){return new Promise(function(t,o){console.log("\u7b2c\u56db\u6b65\u6210\u529f\uff0c\u8be5\u7ed3\u675f\u4e86\u3002"),e.playEnd(),t()})}),MKUtils.runPromiseArray(t)},playEnd:function(){var e=this,t=[];t.push(function(){return new Promise(function(e,t){MKSound.playVoice("public/review/keqian-3",function(){e()})})}),t.push(function(){return new Promise(function(t,o){MKSound.playVoice("public/review/rr_enter",function(){}),e.ani.playAnimation("E2-1chenggongE-F",1),e.ani.addEventListener(dragonBones.EventObject.COMPLETE,function(){e.ani.removeEventListener(dragonBones.EventObject.COMPLETE),e.ani.playAnimation("F1daiji",0),console.log("promise2 success!"),t()},e)})}),t.push(function(){return new Promise(function(t,o){e.door.playAnimation("2jinru",1),e.door.addEventListener(dragonBones.EventObject.COMPLETE,function(){e.ani.removeEventListener(dragonBones.EventObject.COMPLETE),console.log("promise3 success!"),t()},e)})}),t.push(function(){return new Promise(function(t,o){e.winNode.active=!0;var n=cc.find("winNode/win",e.node);n.getComponent(dragonBones.ArmatureDisplay).playAnimation("1chuxian",1),n.getComponent(dragonBones.ArmatureDisplay).addEventListener(dragonBones.EventObject.COMPLETE,function(){n.getComponent(dragonBones.ArmatureDisplay).removeEventListener(dragonBones.EventObject.COMPLETE),n.getComponent(dragonBones.ArmatureDisplay).playAnimation("2daiji",0)},e),MKSound.playVoice("public/audio/win",function(){t()})})}),t.push(function(){return new Promise(function(t,o){var i=e.currentNode;i&&(i.active=!1,i.destroy(),i=null),$CommonData.gSData.serverData.isReviewing=!1,$CommonData.gSData.serverData.currentStep=e.cacheStepInfo,$CommonData.gCData.gameJson=e.cacheDataJson,e.confirmButton.bottom=100,$CommonData.gCData.levelStarTime=e.init_LevelStarTime,n.default.net_send_stepData(1,1),t()})}),MKUtils.runPromiseArray(t)},playSuccess:function(){if(this.scount++,1==this.scount)this.success_1();else if(2==this.scount)this.success_2();else if(3==this.scount)this.success_3();else{if(4!=this.scount)return void console.log("strange scount:"+this.scount);this.success_4()}},gotoNext:function(e){var t=this.currentNode;$CommonData.gCData.debrisLayer&&($CommonData.gCData.debrisLayer.destroy(),$CommonData.gCData.debrisLayer=null),t&&(t.active=!1),cc.find("Canvas/UILayer/confirmButton").active=!1,this.laba.active=!1,$CommonData.gSData.serverData.laba=null,e?this.playSuccess():this.playError()},start:function(){this.door=cc.find("BGNode/gameBG/chuansongmen_ske",this.node).getComponent(dragonBones.ArmatureDisplay),this.ani=cc.find("BGNode/gameBG/keqianceshi_ske",this.node).getComponent(dragonBones.ArmatureDisplay)}}),cc._RF.pop()},{"../../Common/TS_NetCenter":"TS_NetCenter","../../Common/TS_ResourceManager":"TS_ResourceManager","../../Common/TS_common":"TS_common"}],Review_RockJump:[function(e,t,o){"use strict";var n;cc._RF.push(t,"9e485x0kgtN7JEs0FWB4rVn","Review_RockJump");var i=r(e("../../Common/TS_common")),a=r(e("../../Common/TS_ResourceManager")),s=r(e("../../Common/TS_NetCenter"));function r(e){return e&&e.__esModule?e:{default:e}}function c(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}cc.Class((c(n={extends:cc.Component,properties:{progressLabel:{default:null,type:cc.Label}},onLoad:function(){MKLog.log("==========Review_rockJump onLoad======"),MKEventDispatch.I.on("loadReviewGame_over",this.runStep.bind(this),this.node),MKEventDispatch.I.on("loadReviewGame_cancel",this.skipStep.bind(this),this.node)},start:function(){MKLog.log("==========Review_rockJump startstartstart======")},onDestroy:function(){MKLog.log("==========Review_rockJump onDestroy======"),MKEventDispatch.I.removeByNode(this.node)},getLastUnitId:function(e){var t=-1,o=0;for(o=0;o<$CommonData.gSData.serverData.units.length;o++){if($CommonData.gSData.serverData.units[o].id==e){if(o>0){var n=$CommonData.gSData.serverData.units[o-1];if(MKLog.log(n),t=n.id,MKLog.log("lastunitidlastunitid::",t),MKLog.log("lastunit.unitType::",n.unitType),"NORMAL"!=n.unitType)return this.getLastUnitId(t)}break}}return t},init:function(){var e=this;if(MKLog.log("===========init=============="),this.door=cc.find("BGNode/gameBG/chuansongmen_ske",this.node).getComponent(dragonBones.ArmatureDisplay),this.ani=cc.find("BGNode/gameBG/keqianceshi_ske",this.node).getComponent(dragonBones.ArmatureDisplay),this.winNode=cc.find("winNode",this.node),this.btnSkip=cc.find("skip",this.node),this.ready=!1,this.beginAudioID=-1,this.cacheDataJson=$CommonData.gCData.gameJson,this.cacheStepInfo=$CommonData.gSData.serverData.currentStep,this.dataJson=null,this.steps=[],this.scount=0,this.stageNode=this.node.parent,this.currentNode=null,$CommonData.gSData.serverData.isReviewing=!0,$CommonData.gSData.serverData.reviewNode=this.node,$CommonData.gSData.serverData.reviewUnitId=this.lastunitid,this.confirmButton=cc.find("Canvas/UILayer/confirmButton").getComponent(cc.Widget),this.confirmButton.bottom=400,this.laba=cc.find("Canvas/UILayer/laba"),this.laba.active=!1,this.laba.on("touchend",function(){$CommonData.gCData.ISCANTOUCH&&(e.laba.getComponent(dragonBones.ArmatureDisplay).playAnimation("\u64ad\u653e",0),MKLog.log("send say again message!!!"),MKEventDispatch.I.emit("sayAgain"))},this),this.lastunitid>=0){var t=i.default.getResnameByUnitId(this.lastunitid);MKLog.log("resid:::",t),this.jsonResUrl="S"+t+"Res/DataJson/S"+t+"DataJosn",MKLog.log("this.jsonResUrl:::",this.jsonResUrl),cc.loader.loadRes(this.jsonResUrl,cc.JsonAsset,function(t,o){if(t)return MKLog.log("\u6ca1\u6709\u53d6\u5230JSON\u6570\u636e\uff01\u8df3\u8fc7\u8bfe\u524d\u590d\u4e60"),$CommonData.gSData.serverData.isReviewing=!1,e.confirmButton.bottom=100,void i.default.net_send_stepData(1,1);e.dataJson=o.json,$CommonData.gCData.gameJson=e.dataJson,MKLog.log($CommonData.gCData.gameJson),MKLog.log(e.jsonResUrl+"----loaded!"),e.steps.length>0&&(e.ready=!0)})}var o={termid:$CommonData.gSData.serverData.currentTerm.id,userid:$CommonData.gCData.userId,unitid:this.lastunitid};MKLog.log("getReviewSteps paras:"+JSON.stringify(o)),s.default.httpGet("getReviewSteps",o,function(t){MKLog.log("getReviewSteps:"+t),e.steps=JSON.parse(t),null!=e.dataJson&&(e.ready=!0)},function(){MKLog.log("\u53d6\u4e0d\u5230\u590d\u4e60\u9898\u6570\u636e\uff01\u8df3\u8fc7\u8bfe\u524d\u590d\u4e60\uff01"),$CommonData.gSData.serverData.isReviewing=!1,e.confirmButton.bottom=100,i.default.net_send_stepData(1,1)}),this.node.on("QuestionOver",function(t){MKLog.log("--------------QuestionOver-------------------");var o=t.getUserData(),n=1;o&&(n=o.isSuccess),MKLog.log("--------------QuestionOver-------------",n),e.gotoNext(n)},this),this.btnSkip.on("touchend",function(t){e.btnSkip.active=!1,e.beginAudioID>=0&&(cc.audioEngine.stopEffect(e.beginAudioID),e.beginAudioID=-1),$CommonData.gSData.serverData.isReviewing=!1,$CommonData.gSData.serverData.currentStep=e.cacheStepInfo,$CommonData.gCData.gameJson=e.cacheDataJson,e.confirmButton.bottom=100,$CommonData.gCData.levelStarTime=e.init_LevelStarTime,i.default.net_send_stepData(1,1)},this),this.startBtn=cc.find("startLayout/startBtn",this.node),this.startLayout=cc.find("startLayout",this.node),this.startBtn.active=!0,this.startBtn.once(cc.Node.EventType.TOUCH_START,function(){e.btnSkip.active=!1,e.startLayout.active=!1,e.beginAudioID>=0&&(cc.audioEngine.stopEffect(e.beginAudioID),e.beginAudioID=-1),e.runStep_start()},this),this.yuan_ske=cc.find("startLayout/yuan_ske",this.node),this.yuan_ske.active=!1,this.progressLabel.node.active=!1},skipStep:function(){MKLog.log("=======skipStep==========="),MKLog.log($CommonData.gSData.serverData.currentStep),$CommonData.gSData.serverData.isReviewing=!1,$CommonData.gCData.levelStarTime=this.init_LevelStarTime,$CommonData.gCData.isUpdatingClass=!1,i.default.net_send_stepData(1,1)},showWaitingUI:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];MKLog.log("=======showWaitingUI===========",t),t?a.default.loadUnitRes("prefab/SceneAnim/waitingLayer",cc.Prefab,function(t,o){t?cc.error(t):(e.waitingLayer=cc.instantiate(o),e.waitingLayer.parent=cc.find("Canvas"))}):(MKLog.log("=======showWaitingUI======22222222====="),MKLog.log(this.waitingLayer),this.waitingLayer&&(this.waitingLayer.destroy(),this.waitingLayer=null))},runStep:function(){var e=this;if(MKLog.log("=======runStep==========="),$CommonData.gCData.isUpdatingClass=!1,this.init_LevelStarTime=MKTime.getNowTime(),this.unitid=$CommonData.gSData.serverData.currentUnitId,this.lastunitid=this.getLastUnitId(this.unitid),MKLog.log("runStep() this.lastunitid::",this.lastunitid),-1==this.lastunitid)return MKLog.log("\u6ca1\u6709\u4e0a\u4e00\u8bfe\uff0c\u6ca1\u6709\u53ef\u590d\u4e60\u7684\uff0c\u8df3\u8fc7\u8bfe\u524d\u590d\u4e60\u73af\u8282\uff01\uff01\uff01"),$CommonData.gCData.levelStarTime=this.init_LevelStarTime,void i.default.net_send_stepData(1,1);if(205!=this.lastunitid){var t=UpdateHelper.isDownloaded(this.lastunitid);if(MKLog.log("\u5224\u65ad\u5b50\u8bfe\u662f\u5426\u4e0b\u8f7d\u8fc7:",t),!t){MKLog.log("\u8fd8\u672a\u4e0b\u8fc7,\u51c6\u5907\u4e0b\u8f7d\u524d\u4e00\u8bfe\u7684\u5b50\u8bfe\u8d44\u6e90",this.lastunitid);var o=this.node.getComponent("GameDownComponent");return void(o&&(MKLog.log("downCompdownCompdownCompdownComp gameType::",o.gameType),MKLog.log("downComp _checkIsGameDown()::",o._checkIsGameDown()),o.onUpdateCheckReview(this.lastunitid)))}if(!window["lesson_"+this.lastunitid])return void GameHelper.loadReviewGame(this.lastunitid)}MKLog.log("promise00promise00::",window["lesson_"+this.lastunitid]),this.init();var n=new Array;n.push(function(){return new Promise(function(t,o){e.startLayout=cc.find("startLayout",e.node),e.startLayout.active=!0,a.default.loadTempRes("public/review/keqian-start",cc.AudioClip,function(o,n){o?MKLog.log("err:"+o):(e.beginAudioID=cc.audioEngine.playEffect(n,!1),cc.audioEngine.setFinishCallback(e.beginAudioID,function(){t()}))})})}),n.push(function(){return new Promise(function(e,t){e()})}),MKUtils.runPromiseArray(n)},runStep_start:function(){var e=this;MKLog.log("runStep_start:::");var t=[];t.push(function(){return new Promise(function(t,o){MKSound.playEffectEx("public/review/rr_begin",function(){e.ani.playAnimation("A0chuchang",1),e.ani.addEventListener(dragonBones.EventObject.COMPLETE,function(){e.ani.removeEventListener(dragonBones.EventObject.COMPLETE),e.ani.playAnimation("A1daiji0",0),cc.find("BGNode/gameBG/chuansongmen_ske",e.node).active=!0,e.door.playAnimation("1daiji",0)},e)},function(){MKLog.log("promise2 success!"),t()})})}),t.push(function(){return new Promise(function(t,o){MKLog.log("check steps----"+e.steps),e.loadQuestion(),t()})}),MKUtils.runPromiseArray(t)},loadQuestion:function(){var e=this;MKLog.log("loadQuestion:::"),$CommonData.gCData.levelStarTime=MKTime.getNowTime();var t=this.steps[0];if(null!=t){MKLog.log("----load question--------");var o=t.paras,n=(o=JSON.parse(o)).scriptName;$CommonData.gCData.parasPath=o.path,$CommonData.gSData.serverData.currentStep=t;var i=o.path.lastIndexOf("/"),s="public/exercise/"+o.path.substring(i+1);MKLog.log("prefab_path=="+s);var r=null;a.default.loadTempRes(s,cc.Prefab,function(t,o){t?MKLog.log("\u52a0\u8f7d\u4e60\u9898prefab\u5931\u8d25\uff01"):(r=cc.instantiate(o),e.runStepNext(r,n))})}else MKLog.log("\u6ca1\u6709\u6307\u5b9a\u8981\u6267\u884c\u7684\u73af\u8282\uff01")},runStepNext:function(e,t){MKLog.log("runStepNextrunStepNextrunStepNext:");var o=this.currentNode;o&&(o.active=!1),e.scale=.85,e.active=!0,this.stageNode.addChild(e);var n=e.getComponent(cc.Widget);n.bottom=100,n.left=-100,this.currentNode=e,MKLog.log("scriptName:"+t),MKLog.log(e);var i=e.getComponent(t);null==i?MKLog.log("Review_RockJump\u6ca1\u6709\u83b7\u53d6\u5230\u811a\u672c\u5f15\u7528\uff01"):i.runStep(),this.confirmButton.bottom=800/3,this.laba.active=!0,this.laba.getComponent(dragonBones.ArmatureDisplay).playAnimation("\u64ad\u653e",0),MKLog.log("-------------"),$CommonData.gSData.serverData.laba=this.laba,o&&(o.destroy(),o=null),MKLog.log("=============")},playError:function(){var e=this;MKLog.log("playError:::");var t=this.scount,o="A2-3dashibai",n="A2-3-huanyuan",i="A1daiji0";1==t?(o="B2-3dashibai",n="B2-3-huanyuan",i="B1daiji"):2==t?(o="C2-3dashibai",n="C2-3-huayuan",i="C1daiji"):3==t&&(o="D2-3dashibai",n="D2-3-huanyuan",i="D1daiji");var a=[];a.push(function(){return new Promise(function(t,n){MKSound.playEffectEx("public/review/rr_fall",function(){e.ani.playAnimation(o,1),e.ani.addEventListener(dragonBones.EventObject.COMPLETE,function(){e.ani.removeEventListener(dragonBones.EventObject.COMPLETE),MKLog.log("promise1 success!"),t()},e)},function(){})})}),a.push(function(){return new Promise(function(t,o){e.ani.playAnimation(n,1),e.ani.addEventListener(dragonBones.EventObject.COMPLETE,function(){e.ani.removeEventListener(dragonBones.EventObject.COMPLETE),e.ani.playAnimation(i,0)},e);var a="public/review/keqian-6";e.scount%2==0&&(a="public/review/keqian-7"),MKSound.playEffect(a,function(){MKLog.log("promise3 success!"),t()})})}),a.push(function(){return new Promise(function(t,o){var n=e.steps.shift();e.steps.push(n),e.loadQuestion(),t()})}),MKUtils.runPromiseArray(a)},success_1:function(){var e=this;MKLog.log("success_1");var t=[];t.push(function(){return new Promise(function(t,o){MKSound.playEffectEx("public/review/rr_jump",function(){e.ani.playAnimation("A2-1chenggongA-B",1),e.ani.addEventListener(dragonBones.EventObject.COMPLETE,function(){e.ani.removeEventListener(dragonBones.EventObject.COMPLETE),e.ani.playAnimation("B1daiji",0)},e),MKLog.log("promise1 success!"),t()},function(){})})}),t.push(function(){return new Promise(function(e,t){MKSound.playEffect("public/review/keqian-4",function(){e()})})}),t.push(function(){return new Promise(function(t,o){MKLog.log("\u7b2c\u4e00\u6b65\u6210\u529f\uff0c\u8fd9\u91cc\u8be5\u5e72\u70b9\u4ec0\u4e48\u3002"),e.steps.shift(),e.loadQuestion(),t()})}),MKUtils.runPromiseArray(t)},success_2:function(){var e=this;MKLog.log("success_2");var t=[];t.push(function(){return new Promise(function(t,o){MKSound.playEffectEx("public/review/rr_jump",function(){e.ani.playAnimation("B2-1chenggongB-C",1),e.ani.addEventListener(dragonBones.EventObject.COMPLETE,function(){e.ani.removeEventListener(dragonBones.EventObject.COMPLETE),e.ani.playAnimation("C1daiji",0)},e),MKLog.log("promise1 success!"),t()},function(){})})}),t.push(function(){return new Promise(function(e,t){MKSound.playEffect("public/review/keqian-5",function(){e()})})}),t.push(function(){return new Promise(function(t,o){MKLog.log("\u7b2c\u4e8c\u6b65\u6210\u529f\uff0c\u8fd9\u91cc\u8be5\u5e72\u70b9\u4ec0\u4e48\u3002"),e.steps.shift(),e.loadQuestion(),t()})}),MKUtils.runPromiseArray(t)},success_3:function(){var e=this;MKLog.log("success_3");var t=[];t.push(function(){return new Promise(function(t,o){MKSound.playEffectEx("public/review/rr_jump",function(){e.ani.playAnimation("C2-1chenggongC-D",1),e.ani.addEventListener(dragonBones.EventObject.COMPLETE,function(){e.ani.removeEventListener(dragonBones.EventObject.COMPLETE),e.ani.playAnimation("D1daiji",0)},e),MKLog.log("promise1 success!"),t()},function(){})})}),t.push(function(){return new Promise(function(e,t){MKSound.playEffect("public/review/keqian-4",function(){e()})})}),t.push(function(){return new Promise(function(t,o){MKLog.log("\u7b2c\u4e09\u6b65\u6210\u529f\uff0c\u8fd9\u91cc\u8be5\u5e72\u70b9\u4ec0\u4e48\u3002"),e.steps.shift(),e.loadQuestion(),t()})}),MKUtils.runPromiseArray(t)},success_4:function(){var e=this;MKLog.log("success_4");var t=[];t.push(function(){return new Promise(function(t,o){MKSound.playEffectEx("public/review/rr_jump",function(){e.ani.playAnimation("D2-1chenggongD-E",1),e.ani.addEventListener(dragonBones.EventObject.COMPLETE,function(){e.ani.removeEventListener(dragonBones.EventObject.COMPLETE),e.ani.playAnimation("E1daiji",0)},e),MKLog.log("promise1 success!"),t()},function(){})})}),t.push(function(){return new Promise(function(t,o){MKLog.log("\u7b2c\u56db\u6b65\u6210\u529f\uff0c\u8be5\u7ed3\u675f\u4e86\u3002"),e.playEnd(),t()})}),MKUtils.runPromiseArray(t)},playEnd:function(){var e=this;MKLog.log("playEnd:::");var t=[];t.push(function(){return new Promise(function(e,t){MKSound.playEffect("public/review/keqian-3",function(){e()})})}),t.push(function(){return new Promise(function(t,o){MKSound.playEffect("public/review/rr_enter",function(){}),e.ani.playAnimation("E2-1chenggongE-F",1),e.ani.addEventListener(dragonBones.EventObject.COMPLETE,function(){e.ani.removeEventListener(dragonBones.EventObject.COMPLETE),e.ani.playAnimation("F1daiji",0),MKLog.log("promise2 success!"),t()},e)})}),t.push(function(){return new Promise(function(t,o){e.door.playAnimation("2jinru",1),e.door.addEventListener(dragonBones.EventObject.COMPLETE,function(){e.ani.removeEventListener(dragonBones.EventObject.COMPLETE),MKLog.log("promise3 success!"),t()},e)})}),t.push(function(){return new Promise(function(t,o){e.winNode.active=!0;var n=cc.find("winNode/win",e.node);n.getComponent(dragonBones.ArmatureDisplay).playAnimation("1chuxian",1),n.getComponent(dragonBones.ArmatureDisplay).addEventListener(dragonBones.EventObject.COMPLETE,function(){n.getComponent(dragonBones.ArmatureDisplay).removeEventListener(dragonBones.EventObject.COMPLETE),n.getComponent(dragonBones.ArmatureDisplay).playAnimation("2daiji",0)},e),MKSound.playEffect("public/audio/win",function(){t()})})}),t.push(function(){return new Promise(function(t,o){var n=e.currentNode;n&&(n.active=!1,n.destroy(),n=null),$CommonData.gSData.serverData.isReviewing=!1,$CommonData.gSData.serverData.currentStep=e.cacheStepInfo,$CommonData.gCData.gameJson=e.cacheDataJson,e.confirmButton.bottom=100,$CommonData.gCData.levelStarTime=e.init_LevelStarTime,i.default.net_send_stepData(1,1),t()})}),MKUtils.runPromiseArray(t)},playSuccess:function(){if(MKLog.log("playSuccess:::"),this.scount++,1==this.scount)this.success_1();else if(2==this.scount)this.success_2();else if(3==this.scount)this.success_3();else{if(4!=this.scount)return void MKLog.log("strange scount:"+this.scount);this.success_4()}},gotoNext:function(e){MKLog.log("gotoNext:::"),$CommonData.gCData.debrisLayer&&($CommonData.gCData.debrisLayer.destroy(),$CommonData.gCData.debrisLayer=null);var t=this.currentNode;t&&(t.active=!1),cc.find("Canvas/UILayer/confirmButton").active=!1,this.laba.active=!1,$CommonData.gSData.serverData.laba=null,e?(MKLog.log("playSuccess"),this.playSuccess()):(MKLog.log("playError"),this.playError())}},"start",function(){MKLog.log("start:::"),this.door=cc.find("BGNode/gameBG/chuansongmen_ske",this.node).getComponent(dragonBones.ArmatureDisplay),this.ani=cc.find("BGNode/gameBG/keqianceshi_ske",this.node).getComponent(dragonBones.ArmatureDisplay)}),c(n,"showDownloading",function(e,t){MKLog.log("showDownloading:::::::",e,t),e&&t&&(t>1&&(t=0),this.progressLabel.node.active=e,this.progressLabel.string=Math.floor(100*t)+"%")}),n)),cc._RF.pop()},{"../../Common/TS_NetCenter":"TS_NetCenter","../../Common/TS_ResourceManager":"TS_ResourceManager","../../Common/TS_common":"TS_common"}],RootNode:[function(e,t,o){"use strict";cc._RF.push(t,"abe88PnyehPe4xq6H9/Lu6q","RootNode"),Object.defineProperty(o,"__esModule",{value:!0}),o.NodeZorderCtr={MessageTips:1e3,MessageBox:999};var n=cc._decorator,i=n.ccclass,a=n.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.loading=null,t}var n;return __extends(t,e),n=t,t.prototype.onLoad=function(){var e=cc.director.getScene().getChildByName("Canvas").getContentSize();this.node.setContentSize(e),cc.game.addPersistRootNode(this.node),n.I=this},t.prototype.start=function(){},t.showTips=function(e){MKLog.log("showTipsshowTipsshowTipsshowTipsshowTipsshowTipsshowTips");var t=null;cc.loader.loadRes("public/gameTipBg",cc.Prefab,function(n,i){if(n);else{t=cc.instantiate(i);var a=cc.director.getScene().getChildByName("Canvas");a.getChildByName("UILayer")?a.getChildByName("UILayer").addChild(t,o.NodeZorderCtr.MessageTips):a.addChild(t,o.NodeZorderCtr.MessageTips),t.getComponent("MessageTip").showTip(e)}})},t.showMsg=function(e,t,n,i,a,s){void 0===s&&(s=1),MKLog.log("showMsgshowMsgshowMsgshowMsgshowMsgshowMsgshowMsg");var r=null;cc.loader.loadRes("public/commonTipNode",cc.Prefab,function(c,l){if(c);else{r=cc.instantiate(l);var u=cc.director.getScene().getChildByName("Canvas");u.getChildByName("UILayer")?u.getChildByName("UILayer").addChild(r,o.NodeZorderCtr.MessageBox):u.addChild(r,o.NodeZorderCtr.MessageBox);var d=r.getChildByName("rootNode").getComponent("MessageBox");d.setType(e),d.setLeftCallbck(i),d.setRightCallbck(a),d.onSetTitleStr(t),d.onSetLabelStr(n),d.setBtnStyle(s)}})},t.showCommonPopTips=function(e,t,o){void 0===o&&(o="\u63d0\u793a"),MKLog.log("showCommonPopTipsshowCommonPopTipsshowCommonPopTipsshowCommonPopTips"),cc.loader.loadRes("public/CommonPopTips",cc.Prefab,function(n,i){if(!n){var a=cc.instantiate(i);a.getComponent("CommonPopTips").initLayer(e,t,o);var s=cc.director.getScene().getChildByName("Canvas");s.getChildByName("UILayer")?s.getChildByName("UILayer").addChild(a):s.addChild(a)}})},__decorate([a(cc.Prefab)],t.prototype,"loading",void 0),t=n=__decorate([i],t)}(cc.Component);o.default=s,cc._RF.pop()},{}],S6101Logic:[function(e,t,o){"use strict";cc._RF.push(t,"15d19RkuNxH9K89o/KbPDLd","S6101Logic");var n=r(e("../../../Script/pub/Common/TS_common")),i=r(e("../../../Script/pub/Common/TS_ResourceManager")),a=r(e("../../../Script/pub/Common/MUtils/MKSound")),s=r(e("../../../Script/pub/Common/MUtils/MKUtils"));function r(e){return e&&e.__esModule?e:{default:e}}cc.Class({extends:cc.Component,properties:{},start:function(){},init:function(){this.handNode=cc.find("Canvas/UILayer/handNode"),this.robot=cc.find("robot",this.node),this.bdNode=cc.find("bdNode",this.node),this.bg1_1=cc.find("bg1_1",this.node),this.bg1_2=cc.find("bg1_2",this.node),this.bg2_1=cc.find("bg2_1",this.node),this.bg2_2=cc.find("bg2_2",this.node),this.bg1_1.x=cc.view.getVisibleSize().width/2,this.bg1_2.x=cc.view.getVisibleSize().width/2-4e3/3,this.bg2_1.x=cc.view.getVisibleSize().width/2,this.bg2_2.x=cc.view.getVisibleSize().width/2-4e3/3},runStep:function(){var e=this;$CommonData.gCData.THIS=this,n.default.levelStarTime=MKTime.getNowTime(),this.init();var t=new Array;t.push(function(){return new Promise(function(t,o){i.default.loadTempRes("S61Res/audio/61_01_0",cc.AudioClip,function(t,o){if(t)MKLog.info("err:"+t);else{var n=cc.audioEngine.playEffect(o,!1);cc.audioEngine.setFinishCallback(n,function(){e.bdNode.getComponent(dragonBones.ArmatureDisplay).playAnimation("dapenti",1),e.bdNode.getComponent(dragonBones.ArmatureDisplay).addEventListener(dragonBones.EventObject.COMPLETE,function(){MKLog.log("COMPLETE!"),e.bdNode.getComponent(dragonBones.ArmatureDisplay).removeEventListener(dragonBones.EventObject.COMPLETE),s.default.setDragonAnimation(e.bdNode,"mouth","changtai"),e.bdNode.getComponent(dragonBones.ArmatureDisplay).playAnimation("daiji",0)},e),i.default.loadTempRes("S61Res/audio/effect/pt",cc.AudioClip,function(e,t){e?MKLog.info("err:"+e):cc.audioEngine.playEffect(t,!1)})})}}),e.scheduleOnce(function(){MKLog.info("promise0 success"),t()},6)})}),t.push(function(){return new Promise(function(t,o){s.default.setDragonAnimation(e.bdNode,"mouth","shuohua"),a.default.playVoice("S61Res/audio/61_01_1",function(){s.default.setDragonAnimation(e.bdNode,"mouth","changtai"),MKLog.info("promise1 success"),t()})})}),t.push(function(){return new Promise(function(t,o){var i=e;e.robot.getComponent(dragonBones.ArmatureDisplay).playAnimation("\u8bf4\u8bdd",0),a.default.playVoice("S61Res/audio/61_01_2",function(){e.robot.getComponent(dragonBones.ArmatureDisplay).playAnimation("\u5e38\u6001",0),MKLog.info("promise2 success"),i.node&&1==i.node.active&&n.default.net_send_stepData(1,1),t()})})}),s.default.runPromiseArray(t)},update:function(){if(void 0!=this.bg1_1&&void 0!=this.bg1_2){this.bg1_1.x+=10,this.bg1_2.x+=10,this.bg1_1.x>=cc.view.getVisibleSize().width/2+4e3/3&&(this.bg1_1.x=cc.view.getVisibleSize().width/2-4e3/3),this.bg1_2.x>=cc.view.getVisibleSize().width/2+4e3/3&&(this.bg1_2.x=cc.view.getVisibleSize().width/2-4e3/3);this.bg2_1.x+=2,this.bg2_2.x+=2,this.bg2_1.x>=cc.view.getVisibleSize().width/2+4e3/3&&(this.bg2_1.x=cc.view.getVisibleSize().width/2-4e3/3),this.bg2_2.x>=cc.view.getVisibleSize().width/2+4e3/3&&(this.bg2_2.x=cc.view.getVisibleSize().width/2-4e3/3)}},onDisable:function(){MKLog.info("...disable"),this.unscheduleAllCallbacks()}}),cc._RF.pop()},{"../../../Script/pub/Common/MUtils/MKSound":"MKSound","../../../Script/pub/Common/MUtils/MKUtils":"MKUtils","../../../Script/pub/Common/TS_ResourceManager":"TS_ResourceManager","../../../Script/pub/Common/TS_common":"TS_common"}],S6102Logic:[function(e,t,o){"use strict";cc._RF.push(t,"94246EMoAlOeLrKYef/7Z+L","S6102Logic");var n=r(e("../../../Script/pub/Common/TS_common")),i=r(e("../../../Script/pub/Common/TS_ResourceManager")),a=r(e("../../../Script/pub/Common/MUtils/MKSound")),s=r(e("../../../Script/pub/Common/MUtils/MKUtils"));function r(e){return e&&e.__esModule?e:{default:e}}cc.Class({extends:cc.Component,properties:{},start:function(){console.log("startstartstart======")},init:function(){this.handNode=cc.find("Canvas/UILayer/handNode"),this.bdNodeCe=cc.find("bdNode",this.node),this.robotCe=cc.find("robot",this.node),this.clickAnimation=cc.find("click",this.node),this.clickAnimation&&(this.clickAnimation.active=!1),this.earthNode=cc.find("earthNode",this.node),this.earthNode1=cc.find("earthNode/earth1",this.node),this.earthNode0=cc.find("earthNode/earth0",this.node),this.earthNode&&(this.earthNode.active=!1,this.earthNode.x=0),this.earthNode0&&(this.earthNode0.active=!1),this.earthNode1&&(this.earthNode1.active=!1),this.sunNode=cc.find("sunNode",this.node),this.sunNode&&(this.sunNode.active=!1),this.sunLine=cc.find("sunLine",this.node),this.sunLine&&(this.sunLine.active=!1,this.sunLine.x=-20),this.ren1=cc.find("earthNode/ren1",this.node),this.ren2=cc.find("earthNode/ren2",this.node),this.line=cc.find("earthNode/line",this.node),this.yi=cc.find("robot/yi",this.node),this.yi&&(this.yi.active=!1),this.ren1&&(this.ren1.active=!1),this.ren2&&(this.ren2.active=!1),this.line&&(this.line.active=!1),this.bdNodeCe&&(this.bdNodeCe.active=!0),this.robotCe&&(this.robotCe.active=!0),this.jiangjie=cc.find("jiangjie",this.node),this.jiangjie&&(this.jiangjie.active=!1),this.bg2_jiangjie=cc.find("jiangjie/bg2/mask/2_60",this.node),this.bg2_jiangjie&&(this.bg2_jiangjie.active=!1),this.selectNodeArr=[cc.find("jiangjie/bg1",this.node),cc.find("jiangjie/bg2",this.node),cc.find("jiangjie/bg3",this.node)]},runStep:function(){var e=this;console.log("runSteprunSteprunSteprunStep======"),$CommonData.gCData.THIS=this,n.default.levelStarTime=MKTime.getNowTime(),this.init();var t=new Array;t.push(function(){return new Promise(function(t,o){e.robotCe.getComponent(dragonBones.ArmatureDisplay).playAnimation("\u8bf4\u8bdd",0),a.default.playVoice("S61Res/audio/61_02_1",function(){e.robotCe.getComponent(dragonBones.ArmatureDisplay).playAnimation("\u5e38\u6001",0),MKLog.info("promise4 success"),t()})})}),t.push(function(){return new Promise(function(t,o){e.robotCe.getComponent(dragonBones.ArmatureDisplay).playAnimation("\u8bf4\u8bdd",0),a.default.playVoice("S61Res/audio/61_02_3",function(){e.robotCe.getComponent(dragonBones.ArmatureDisplay).playAnimation("\u5e38\u6001",0),e.robotCe.getComponent(dragonBones.ArmatureDisplay).playAnimation("\u62ff\u51fa\u6295\u5f71",1),e.robotCe.getComponent(dragonBones.ArmatureDisplay).addEventListener(dragonBones.EventObject.COMPLETE,function(){e.robotCe.getComponent(dragonBones.ArmatureDisplay).removeEventListener(dragonBones.EventObject.COMPLETE),e.robotCe.getComponent(dragonBones.ArmatureDisplay).playAnimation("\u5e38\u6001",0)},e),e.scheduleOnce(function(){e.yi.active=!0,e.earthNode.active=!0,e.earthNode0.active=!0,e.clickAnimation.active=!0,e.earthNode.once(cc.Node.EventType.TOUCH_START,function(){a.default.playClickEffect(),this.clickAnimation.active=!1,this.line.active=!0,MKLog.info("promise3 success"),t()},e)},2.5)})})}),t.push(function(){return new Promise(function(t,o){e.earthNode.children[1].getComponent(dragonBones.ArmatureDisplay).playAnimation("Sprite",0),e.robotCe.getComponent(dragonBones.ArmatureDisplay).playAnimation("\u8bf4\u8bdd",0),a.default.playVoice("S61Res/audio/61_02_4",function(){e.clickAnimation.active=!0,e.earthNode.once(cc.Node.EventType.TOUCH_START,function(){a.default.playClickEffect(),this.clickAnimation.active=!1;var e=new cc.moveTo(2,cc.v2(240,80)),o=new cc.scaleTo(2,1),n=this,i=new cc.callFunc(function(e){n.sunNode.active=!0,n.earthNode1.active=!0,n.earthNode0.active=!1}),s=new cc.spawn(e,o);this.earthNode.runAction(new cc.sequence(s,i)),MKLog.info("promise4 success"),t()},e)})})}),t.push(function(){return new Promise(function(t,o){e.playVoice("S61Res/audio/61_02_5",e.robotCe,function(){this.clickAnimation.position=this.sunNode.position,this.clickAnimation.active=!0,this.sunNode.once(cc.Node.EventType.TOUCH_START,function(){a.default.playClickEffect(),this.clickAnimation.active=!1,this.sunNode.children[0].getComponent(dragonBones.ArmatureDisplay).playAnimation("\u71c3\u70e7",0),this.sunLine.active=!0;var e=this,o=new cc.moveBy(1,cc.v2(180,0)),n=new cc.callFunc(function(t){e.sunLine.x=-20}),i=new cc.sequence(o,n);this.sunLine.runAction(new cc.repeatForever(i)),MKLog.info("promise4 success"),t()},this)}.bind(e))})}),t.push(function(){return new Promise(function(t,o){e.playVoice("S61Res/audio/61_02_6_01",e.robotCe,function(){MKLog.info("promise6 success"),t()}.bind(e))})}),t.push(function(){return new Promise(function(t,o){e.playVoice("S61Res/audio/61_02_6_02",e.robotCe,function(){MKLog.info("promise6 success"),t()}.bind(e))})}),t.push(function(){return new Promise(function(t,o){e.playVoice("S61Res/audio/61_02_6_03",e.robotCe,function(){MKLog.info("promise6 success"),t()}.bind(e))})}),t.push(function(){return new Promise(function(t,o){e.playVoice("S61Res/audio/61_02_7",e.bdNodeCe,function(){this.clickAnimation.position=this.earthNode.position,this.clickAnimation.active=!0,this.earthNode.once(cc.Node.EventType.TOUCH_START,function(){a.default.playClickEffect(),this.clickAnimation.active=!1,this.ren1.active=!0,this.ren2.active=!0,this.ren1.runAction(new cc.blink(9,10)),this.ren2.runAction(new cc.blink(9,10)),MKLog.info("promise7 success"),t()},this)}.bind(e))})}),t.push(function(){return new Promise(function(t,o){e.playVoice("S61Res/audio/61_02_8",e.robotCe,function(){this.playVoice("S61Res/audio/61_02_9",this.bdNodeCe,function(){this.playVoice("S61Res/audio/61_02_10",this.robotCe,function(){MKLog.info("promise8 success"),t()}.bind(this))}.bind(this))}.bind(e))})}),t.push(function(){return new Promise(function(t,o){e.earthNode.active=!1,e.sunNode.active=!1,e.sunLine.active=!1,e.jiangjie.active=!0,e.clickAnimation.position=e.selectNodeArr[0],e.clickAnimation.active=!0,e.selectNodeArr[0].once(cc.Node.EventType.TOUCH_START,function(){var e=this;a.default.playClickEffect(),this.clickAnimation.active=!1,this.schedule(function(){var t=e.selectNodeArr[0].children[0].children[0],o=e.selectNodeArr[0].children[0].children[1],n=e.selectNodeArr[0].children[0].children[2];t.active=!t.active,o.active=!o.active;var i="\u590f\u5929\u8df3";i=t.active?"\u51ac\u5929\u8df3":"\u590f\u5929\u8df3",n.getComponent(dragonBones.ArmatureDisplay).playAnimation(i,0)},2),MKLog.info("promise9 success"),t()},e)})}),t.push(function(){return new Promise(function(t,o){e.playVoice("S61Res/audio/61_02_11",e.robotCe,function(){this.clickAnimation.position=this.selectNodeArr[1],this.clickAnimation.active=!0,this.selectNodeArr[1].once(cc.Node.EventType.TOUCH_START,function(){a.default.playClickEffect(),this.clickAnimation.active=!1,this.selectNodeArr[1].children[0].children[2].getComponent(dragonBones.ArmatureDisplay).playAnimation("\u98d8\u843d",0),this.bg2_jiangjie.active=!0,MKLog.info("promise10 success"),t()},this)}.bind(e))})}),t.push(function(){return new Promise(function(t,o){e.playVoice("S61Res/audio/61_02_12",e.robotCe,function(){this.clickAnimation.position=this.selectNodeArr[2],this.clickAnimation.active=!0,this.selectNodeArr[2].once(cc.Node.EventType.TOUCH_START,function(){a.default.playClickEffect(),this.clickAnimation.active=!1,this.selectNodeArr[2].children[0].children[1].getComponent(dragonBones.ArmatureDisplay).playAnimation("\u6447\u6446",0),this.selectNodeArr[2].children[0].children[2].getComponent(cc.Animation).play("flyBird"),MKLog.info("promise11 success"),t()},this)}.bind(e))})}),t.push(function(){return new Promise(function(t,o){e.playVoice("S61Res/audio/61_02_13",e.robotCe,function(){MKLog.info("promise12 success"),t()})})}),t.push(function(){return new Promise(function(t,o){e.playVoice("S61Res/audio/61_02_14",e.bdNodeCe,function(){MKLog.info("promise2 success"),t()})})}),t.push(function(){return new Promise(function(t,o){e.playVoice("S61Res/audio/61_02_15",e.robotCe,function(){e.node&&1==e.node.active&&n.default.net_send_stepData(1,1),MKLog.info("promise13 success"),t()})})}),s.default.runPromiseArray(t)},playVoice:function(e,t,o){var n=this;i.default.loadTempRes(e,cc.AudioClip,function(e,i){if(e)return MKLog.info("err:"+e),void(o&&o());var a=cc.audioEngine.playEffect(i,!1);Promise.race([new Promise(function(e,o){"robot"==t.name?t.getComponent(dragonBones.ArmatureDisplay).playAnimation("\u8bf4\u8bdd",0):s.default.setDragonAnimation(t,"mouth","shuohua"),cc.audioEngine.setFinishCallback(a,function(){"robot"==t.name?t.getComponent(dragonBones.ArmatureDisplay).playAnimation("\u5e38\u6001",0):s.default.setDragonAnimation(t,"mouth","daiji"),e()})}),new Promise(function(e,t){n.scheduleOnce(function(){e()},15)})]).then(function(){o&&o()})})},onDisable:function(){MKLog.info("...disable")}}),cc._RF.pop()},{"../../../Script/pub/Common/MUtils/MKSound":"MKSound","../../../Script/pub/Common/MUtils/MKUtils":"MKUtils","../../../Script/pub/Common/TS_ResourceManager":"TS_ResourceManager","../../../Script/pub/Common/TS_common":"TS_common"}],S6105Logic:[function(e,t,o){"use strict";cc._RF.push(t,"459b3i+WqNHgZ3fD619LDXd","S6105Logic");var n=s(e("../../../Script/pub/Common/TS_common")),i=s(e("../../../Script/pub/Common/TS_ResourceManager")),a=(s(e("../../../Script/pub/Common/MUtils/MKSound")),e("../../../Script/pub/Common/MUtils/WXApi"),s(e("../../../Script/pub/Common/MUtils/MKUtils")));function s(e){return e&&e.__esModule?e:{default:e}}cc.Class({extends:cc.Component,properties:{},start:function(){},onLoad:function(){},init:function(){this.handNode=cc.find("Canvas/UILayer/handNode"),this.bdNodeCe=cc.find("bdNode",this.node),this.robotCe=cc.find("robot",this.node)},runStep:function(){var e=this;$CommonData.gCData.THIS=this,n.default.levelStarTime=MKTime.getNowTime(),this.init();var t=new Array;t.push(function(){return new Promise(function(t,o){e.playVoice("S61Res/audio/61_05_1",e.bdNodeCe,function(){MKLog.info("promise1 success"),t()})})}),t.push(function(){return new Promise(function(t,o){e.playVoice("S61Res/audio/61_05_2",e.robotCe,function(){e.node&&1==e.node.active&&n.default.net_send_stepData(1,1),MKLog.info("promise2 success"),t()})})}),a.default.runPromiseArray(t)},playVoice:function(e,t,o){var n=this;i.default.loadTempRes(e,cc.AudioClip,function(e,i){if(e)return MKLog.info("err:"+e),void(o&&o());var s=cc.audioEngine.playEffect(i,!1);Promise.race([new Promise(function(e,o){"robot"==t.name?t.getComponent(dragonBones.ArmatureDisplay).playAnimation("\u8bf4\u8bdd",0):a.default.setDragonAnimation(t,"mouth","shuohua"),cc.audioEngine.setFinishCallback(s,function(){"robot"==t.name?t.getComponent(dragonBones.ArmatureDisplay).playAnimation("\u5e38\u6001",0):a.default.setDragonAnimation(t,"mouth","daiji"),e()})}),new Promise(function(e,t){n.scheduleOnce(function(){e()},15)})]).then(function(){o&&o()})})},onDisable:function(){MKLog.info("...disable"),this.unscheduleAllCallbacks()}}),cc._RF.pop()},{"../../../Script/pub/Common/MUtils/MKSound":"MKSound","../../../Script/pub/Common/MUtils/MKUtils":"MKUtils","../../../Script/pub/Common/MUtils/WXApi":"WXApi","../../../Script/pub/Common/TS_ResourceManager":"TS_ResourceManager","../../../Script/pub/Common/TS_common":"TS_common"}],S6106Logic:[function(e,t,o){"use strict";cc._RF.push(t,"75650np7uxAaYJxvpzlT8mm","S6106Logic");a(e("../../../Script/pub/Common/TS_ResourceManager"));var n=a(e("../../../Script/pub/Common/TS_common")),i=a(e("../../../Script/pub/Common/MUtils/MKUtils"));function a(e){return e&&e.__esModule?e:{default:e}}cc.Class({extends:cc.Component,properties:{circleNode:{default:null,type:cc.Node}},start:function(){},playLayer:function(){var e=this;MKLog.info("play Layer"),this.hideCircle(),this.biglayer.active=!0;var t=[];t.push(function(){return new Promise(function(t,o){var n=cc.moveTo(4,cc.v2(0,-50)),a=cc.callFunc(function(){i.default.setDragonAnimation(e.bigpudding,"mouth","daiji"),t()});e.bigfirefly.runAction(cc.sequence([n,a]))})}),t.push(function(){return new Promise(function(t,o){i.default.setDragonAnimation(e.bigpudding,"mouth","shuohua"),MKSound.playVoice("S61Res/audio/61_6_3",function(){i.default.setDragonAnimation(e.bigpudding,"mouth","daiji"),t()})})}),t.push(function(){return new Promise(function(t,o){i.default.setDragonAnimation(e.bigpudding,"mouth","shuohua"),MKSound.playVoice("S61Res/audio/61_6_4",function(){i.default.setDragonAnimation(e.bigpudding,"mouth","daiji"),t()})})}),t.push(function(){return new Promise(function(t,o){var n=cc.moveTo(4,cc.v2(1e3,-50)),i=cc.callFunc(function(){MKLog.info("layer play end !"),e.isPlaying=!1,e.biglayer.active=!1,t()});e.bigfirefly.runAction(cc.sequence([n,i]))})}),t.push(function(){return new Promise(function(t,o){e.scheduleOnce(function(){e.light.active=!0,e.fire.active=!0},3),e.xiaopai.getComponent(dragonBones.ArmatureDisplay).playAnimation("\u8bf4\u8bdd",0),MKSound.playVoice("S61Res/audio/61_6_5",function(){e.xiaopai.getComponent(dragonBones.ArmatureDisplay).playAnimation("\u5e38\u6001",0),e.light.active=!1,e.fire.active=!1,t()})})}),t.push(function(){return new Promise(function(t,o){i.default.setDragonAnimation(e.pudding,"mouth","shuohua"),MKSound.playVoice("S61Res/audio/61_6_6_1",function(){i.default.setDragonAnimation(e.pudding,"mouth","daiji"),t()})})}),t.push(function(){return new Promise(function(t,o){e.arrow1.active=!0,e.xiaopai.getComponent(dragonBones.ArmatureDisplay).playAnimation("\u8bf4\u8bdd",0),MKSound.playVoice("S61Res/audio/61_6_6_2",function(){e.xiaopai.getComponent(dragonBones.ArmatureDisplay).playAnimation("\u5e38\u6001",0),e.arrow1.active=!1,t()})})}),t.push(function(){return new Promise(function(t,o){i.default.setDragonAnimation(e.pudding,"mouth","shuohua"),MKSound.playVoice("S61Res/audio/61_6_6",function(){i.default.setDragonAnimation(e.pudding,"mouth","daiji"),t()})})}),t.push(function(){return new Promise(function(t,o){e.xiaopai.getComponent(dragonBones.ArmatureDisplay).playAnimation("\u62ff\u51fa\u6295\u5f71",1),e.xiaopai.getComponent(dragonBones.ArmatureDisplay).addEventListener(dragonBones.EventObject.COMPLETE,function(){e.xiaopai.getComponent(dragonBones.ArmatureDisplay).removeEventListener(dragonBones.EventObject.COMPLETE),e.projector.active=!0,e.projector.getComponent(dragonBones.ArmatureDisplay).playAnimation("\u6295\u5f712\u5faa\u73af",0),t()})})}),t.push(function(){return new Promise(function(t,o){e.kuang.active=!0,e.xiaopai.getComponent(dragonBones.ArmatureDisplay).playAnimation("\u8bf4\u8bdd",0),MKSound.playVoice("S61Res/audio/61_6_7",function(){e.xiaopai.getComponent(dragonBones.ArmatureDisplay).playAnimation("\u5e38\u6001",0),t()})})}),t.push(function(){return new Promise(function(t,o){i.default.setDragonAnimation(e.pudding,"mouth","shuohua"),MKSound.playVoice("S61Res/audio/61_6_9",function(){i.default.setDragonAnimation(e.pudding,"mouth","daiji"),t()})})}),t.push(function(){return new Promise(function(t,o){e.xiaopai.getComponent(dragonBones.ArmatureDisplay).playAnimation("\u8bf4\u8bdd",0),MKSound.playVoice("S61Res/audio/61_6_10",function(){e.xiaopai.getComponent(dragonBones.ArmatureDisplay).playAnimation("\u5e38\u6001",0),e.arrow1.active=!1,t()})})}),t.push(function(){return new Promise(function(t,o){MKLog.info("S6 is over!"),e.node&&1==e.node.active&&n.default.net_send_stepData(1,1),t()})}),i.default.runPromiseArray(t)},init:function(){this.xiaopai=cc.find("beach_night/\u5c0f\u6d3e\u4fa7\u9762",this.node),this.pudding=cc.find("beach_night/\u5e03\u4e01\u5750\u5728\u6c99\u6ee9\u4e0a",this.node),this.xiaopai.getComponent(dragonBones.ArmatureDisplay).playAnimation("\u5e38\u6001",0),i.default.setDragonAnimation(this.pudding,"mouth","daiji"),this.biglayer=cc.find("beach_night_bg",this.node),this.bigfirefly=cc.find("beach_night_bg/\u8424\u706b\u866b",this.node),this.bigpudding=cc.find("beach_night_bg/\u5e03\u4e01\u8424\u706b\u866b\u7279\u5199",this.node),this.light=cc.find("beach_night/light",this.node),this.fire=cc.find("beach_night/fire",this.node),this.arrow1=cc.find("beach_night/arrow1",this.node),this.kuang=cc.find("beach_night/kuang",this.node),this.projector=cc.find("beach_night/\u6295\u5f71\u4eea",this.node),this.projector.active=!1,this.isPlaying=!0,this.bg1=cc.find("beach_night/mask1/beach_night_bg1",this.node),this.bg2=cc.find("beach_night/mask2/beach_night_bg1",this.node),this.bg3=cc.find("beach_night/mask3/beach_night_bg1",this.node),this.bg4=cc.find("beach_night/mask4/beach_night_bg1",this.node),this.firefly1=cc.find("beach_night/firefly1",this.node),this.firefly2=cc.find("beach_night/firefly2",this.node),this.firefly3=cc.find("beach_night/firefly3",this.node)},runStep:function(){var e=this;$CommonData.gCData.THIS=this,this.init();this.circleNode.on("touchend",function(t){e.isPlaying||(MKSound.playClickEffect(),MKLog.info("circle touchend"),e.playLayer())},this);var t=[];t.push(function(){return new Promise(function(t,o){e.bg1.getComponent(cc.Animation).play("bg"),e.bg2.getComponent(cc.Animation).play("bg"),e.bg3.getComponent(cc.Animation).play("bg"),e.bg4.getComponent(cc.Animation).play("bg"),e.scheduleOnce(function(){e.firefly1.getComponent(cc.Animation).play("firefly1"),e.firefly2.getComponent(cc.Animation).play("firefly4"),e.firefly3.getComponent(cc.Animation).play("firefly3")},3),e.xiaopai.getComponent(dragonBones.ArmatureDisplay).playAnimation("\u8bf4\u8bdd",0),MKSound.playVoice("S61Res/audio/61_add_1",function(){e.xiaopai.getComponent(dragonBones.ArmatureDisplay).playAnimation("\u5e38\u6001",0),MKLog.info("promise0 is over"),t()})})}),t.push(function(){return new Promise(function(t,o){i.default.setDragonAnimation(e.pudding,"mouth","shuohua"),MKSound.playVoice("S61Res/audio/61_6_1",function(){i.default.setDragonAnimation(e.pudding,"mouth","daiji"),MKLog.info("promise0 is over"),t()})})}),t.push(function(){return new Promise(function(t,o){e.xiaopai.getComponent(dragonBones.ArmatureDisplay).playAnimation("\u8bf4\u8bdd",0),MKSound.playVoice("S61Res/audio/61_6_2",function(){e.xiaopai.getComponent(dragonBones.ArmatureDisplay).playAnimation("\u5e38\u6001",0),e.showCircle(),e.isPlaying=!1,t()})})}),i.default.runPromiseArray(t)},showCircle:function(){this.circleNode.setPosition(cc.v2(0,-200)),this.circleNode.active=!0},hideCircle:function(){this.circleNode.active=!1},onDestroy:function(){this.unscheduleAllCallbacks()}}),cc._RF.pop()},{"../../../Script/pub/Common/MUtils/MKUtils":"MKUtils","../../../Script/pub/Common/TS_ResourceManager":"TS_ResourceManager","../../../Script/pub/Common/TS_common":"TS_common"}],S6109Logic:[function(e,t,o){"use strict";cc._RF.push(t,"b9b43vep3RHQYlBy5e/8/ab","S6109Logic");var n=a(e("../../../Script/pub/Common/TS_common")),i=a(e("../../../Script/pub/Common/MUtils/MKUtils"));function a(e){return e&&e.__esModule?e:{default:e}}cc.Class({extends:cc.Component,properties:{circleNode:{default:null,type:cc.Node}},start:function(){},init:function(){this.xiaopai=cc.find("beach_night/\u5c0f\u6d3e\u4fa7\u9762",this.node),this.pudding=cc.find("beach_night/\u5e03\u4e01\u5750\u5728\u6c99\u6ee9\u4e0a",this.node),this.xiaopai.getComponent(dragonBones.ArmatureDisplay).playAnimation("\u5e38\u6001",0),i.default.setDragonAnimation(this.pudding,"mouth","daiji"),this.biglayer=cc.find("beach_night_bg",this.node),this.bigfirefly=cc.find("beach_night_bg/\u8424\u706b\u866b",this.node),this.bigpudding=cc.find("beach_night_bg/\u5e03\u4e01\u8424\u706b\u866b\u7279\u5199",this.node),this.light=cc.find("beach_night/light",this.node),this.fire=cc.find("beach_night/fire",this.node),this.arrow1=cc.find("beach_night/arrow1",this.node),this.kuang=cc.find("beach_night/kuang",this.node),this.projector=cc.find("beach_night/\u6295\u5f71\u4eea",this.node),this.projector.active=!1,this.isPlaying=!0,this.firefly1=cc.find("beach_night/firefly1",this.node),this.firefly2=cc.find("beach_night/firefly2",this.node),this.firefly3=cc.find("beach_night/firefly3",this.node)},runStep:function(){var e=this;$CommonData.gCData.THIS=this,this.init(),this.firefly1.getComponent(cc.Animation).play("firefly1"),this.firefly2.getComponent(cc.Animation).play("firefly4"),this.firefly3.getComponent(cc.Animation).play("firefly3");var t=[];t.push(function(){return new Promise(function(t,o){i.default.setDragonAnimation(e.pudding,"mouth","shuohua"),MKSound.playVoice("S61Res/audio/61_9_1",function(){i.default.setDragonAnimation(e.pudding,"mouth","daiji"),t()})})}),t.push(function(){return new Promise(function(t,o){e.xiaopai.getComponent(dragonBones.ArmatureDisplay).playAnimation("\u8bf4\u8bdd",0),MKSound.playVoice("S61Res/audio/61_9_2",function(){e.xiaopai.getComponent(dragonBones.ArmatureDisplay).playAnimation("\u5e38\u6001",0),t()})})}),t.push(function(){return new Promise(function(t,o){MKLog.log("S9 is over!"),e.node&&1==e.node.active&&n.default.net_send_stepData(1,1),t()})}),i.default.runPromiseArray(t)}}),cc._RF.pop()},{"../../../Script/pub/Common/MUtils/MKUtils":"MKUtils","../../../Script/pub/Common/TS_common":"TS_common"}],S6110Logic:[function(e,t,o){"use strict";cc._RF.push(t,"71247tlBq1MK7cetLltTMb7","S6110Logic");var n=r(e("../../../Script/pub/Common/TS_common")),i=r(e("../../../Script/pub/Common/TS_ResourceManager")),a=r(e("../../../Script/pub/Common/MUtils/MKSound")),s=r(e("../../../Script/pub/Common/MUtils/MKUtils"));function r(e){return e&&e.__esModule?e:{default:e}}cc.Class({extends:cc.Component,properties:{},start:function(){},init:function(){this.bdNode=cc.find("bdNode",this.node),this.bdNodeCe=cc.find("bdNodeCe",this.node),this.bdNodeT=cc.find("bdNodeT",this.node),this.robot=cc.find("robot",this.node),this.robotCe=cc.find("robotCe",this.node),this.bdNodeCe.active=!0,this.robotCe.active=!0,this.shatanNode=cc.find("sha",this.node),this.stoneNode=cc.find("10_7",this.node),this.haiNode=cc.find("hai",this.node),this.shuNode=cc.find("10_1",this.node),this.jiangjie=cc.find("jiangjie",this.node),this.jiangjie.active=!1,this.row1=cc.find("10_7/rowNode1",this.node),this.row2=cc.find("rowNode2",this.node),this.row3=cc.find("rowNode3",this.node),this.row4=cc.find("rowNode4",this.node),this.row1.active=!1,this.row2.active=!1,this.row3.active=!1,this.row4.active=!1,this.circleNode=cc.find("circleNode",this.node),this.selectNodeArr=[cc.find("jiangjie/bg1/mask/gui6110",this.node),cc.find("jiangjie/bg2/mask/shai6110",this.node),cc.find("jiangjie/bg3/mask/hua6110",this.node),cc.find("jiangjie/bg4/mask/chi6110",this.node)],this.bgNodeArr=[cc.find("jiangjie/bg1",this.node),cc.find("jiangjie/bg2",this.node),cc.find("jiangjie/bg3",this.node),cc.find("jiangjie/bg4",this.node)],this.animalArr=[0,0,0,0]},runStep:function(){var e=this;$CommonData.gCData.THIS=this,n.default.levelStarTime=MKTime.getNowTime(),this.init();var t=new Array;t.push(function(){return new Promise(function(t,o){i.default.loadTempRes("S61Res/audio/61_10_0",cc.AudioClip,function(e,t){e?MKLog.log("err:"+e):cc.audioEngine.playEffect(t,!1)});var n=new cc.moveTo(4,cc.v2(e.stoneNode.x-260/3,e.bdNodeCe.y)),a=new cc.moveTo(4,cc.v2(e.stoneNode.x-1100/3,e.robotCe.y)),r=new cc.callFunc(function(o){e.bdNodeCe.active=!1,e.bdNodeT.x=e.bdNodeCe.x,e.bdNodeT.y=e.bdNodeCe.y,e.bdNodeT.getComponent(dragonBones.ArmatureDisplay).playAnimation("tiao",1),s.default.setDragonAnimation(e.bdNodeT,"eye","bukaixin"),s.default.setDragonAnimation(e.bdNodeT,"mouth","shuohua-bukaixin"),i.default.loadTempRes("S61Res/audio/61_10_1_01",cc.AudioClip,function(e,t){e?MKLog.log("err:"+e):cc.audioEngine.playEffect(t,!1)}),e.robotCe.active=!1,e.robot.x=e.robotCe.x-20,e.robot.y=e.robotCe.y,e.robot.active=!0,e.scheduleOnce(function(){e.bdNodeT.active=!1,e.bdNode.x=e.bdNodeCe.x-60,e.bdNode.y=e.bdNodeCe.y+20,MKLog.log("promise0 success"),t()},1)});e.bdNodeCe.runAction(cc.sequence(n,r)),e.robotCe.runAction(a)})}),t.push(function(){return new Promise(function(t,o){e.scheduleOnce(function(){t()},1)})}),t.push(function(){return new Promise(function(t,o){s.default.setDragonAnimation(e.bdNode,"mouth","shuohua"),a.default.playVoice("S61Res/audio/61_10_1_02",function(){s.default.setDragonAnimation(e.bdNode,"mouth","daiji"),t()})})}),t.push(function(){return new Promise(function(t,o){s.default.setDragonAnimation(e.robot,"mouth","shuohua"),a.default.playVoice("S61Res/audio/61_10_2",function(){s.default.setDragonAnimation(e.robot,"mouth","changtai"),t()})})}),t.push(function(){return new Promise(function(t,o){s.default.setDragonAnimation(e.bdNode,"mouth","shuohua"),a.default.playVoice("S61Res/audio/61_10_3",function(){s.default.setDragonAnimation(e.bdNode,"mouth","daiji"),t()})})}),t.push(function(){return new Promise(function(t,o){s.default.setDragonAnimation(e.robot,"mouth","shuohua"),a.default.playVoice("S61Res/audio/61_10_4_01",function(){s.default.setDragonAnimation(e.robot,"mouth","changtai"),t()})})}),t.push(function(){return new Promise(function(t,o){s.default.setDragonAnimation(e.robot,"mouth","shuohua"),a.default.playVoice("S61Res/audio/61_10_4_02",function(){s.default.setDragonAnimation(e.robot,"mouth","changtai"),t()})})}),t.push(function(){return new Promise(function(t,o){s.default.setDragonAnimation(e.robot,"mouth","shuohua"),a.default.playVoice("S61Res/audio/61_10_5",function(){s.default.setDragonAnimation(e.robot,"mouth","changtai"),t()}),e.scheduleOnce(function(){e.row1.active=!0,e.row2.active=!0,e.row1.runAction(new cc.blink(2,5)),e.row2.runAction(new cc.blink(2,5))},5),e.scheduleOnce(function(){e.row1.active=!1,e.row2.active=!1},8)})}),t.push(function(){return new Promise(function(t,o){s.default.setDragonAnimation(e.robot,"mouth","shuohua"),a.default.playVoice("S61Res/audio/61_10_6_01",function(){s.default.setDragonAnimation(e.robot,"mouth","changtai"),t()}),e.scheduleOnce(function(){e.row3.active=!0,e.row4.active=!0,e.row3.runAction(new cc.blink(2,5)),e.row4.runAction(new cc.blink(2,5))},3),e.scheduleOnce(function(){e.row3.active=!1,e.row4.active=!1},6)})}),t.push(function(){return new Promise(function(t,o){s.default.setDragonAnimation(e.robot,"mouth","shuohua"),a.default.playVoice("S61Res/audio/61_10_6_02",function(){s.default.setDragonAnimation(e.robot,"mouth","changtai"),t()})})}),t.push(function(){return new Promise(function(t,o){s.default.setDragonAnimation(e.bdNode,"mouth","shuohua"),a.default.playVoice("S61Res/audio/61_10_7",function(){s.default.setDragonAnimation(e.bdNode,"mouth","daiji"),t()})})}),t.push(function(){return new Promise(function(t,o){e.jiangjie.active=!0,s.default.setDragonAnimation(e.robot,"mouth","shuohua"),a.default.playVoice("S61Res/audio/61_10_8_01",function(){s.default.setDragonAnimation(e.robot,"mouth","changtai"),t()})})}),t.push(function(){return new Promise(function(t,o){s.default.setDragonAnimation(e.robot,"mouth","shuohua"),a.default.playVoice("S61Res/audio/61_10_8_02",function(){s.default.setDragonAnimation(e.robot,"mouth","changtai"),t()})})}),t.push(function(){return MKLog.log("promise9 start=============="),new Promise(function(t,o){$CommonData.gCData.ISCANTOUCH=!0,e.showClickWarn(e.bgNodeArr[0]),e.selectNodeArr[0].once(cc.Node.EventType.TOUCH_START,function(){var e=this;MKLog.log("promise9 TOUCH_START=============="),a.default.playClickEffect(),this.hideCircle(),s.default.setDragonAnimation(this.robot,"mouth","shuohua"),this.selectNodeArr[0].children[0].getComponent(dragonBones.ArmatureDisplay).playAnimation("\u722c",0),a.default.playVoice("S61Res/audio/61_10_d0",function(){MKLog.log("promise9 resolve\uff08\uff09=============="),s.default.setDragonAnimation(e.robot,"mouth","changtai"),t()})},e)})}),t.push(function(){return new Promise(function(t,o){$CommonData.gCData.ISCANTOUCH=!0,e.showClickWarn(e.bgNodeArr[1]),e.selectNodeArr[1].once(cc.Node.EventType.TOUCH_START,function(){var e=this;a.default.playClickEffect(),this.hideCircle(),s.default.setDragonAnimation(this.robot,"mouth","shuohua"),this.selectNodeArr[1].children[0].getComponent(dragonBones.ArmatureDisplay).playAnimation("\u6652\u5e72\u52a8\u753b",0),a.default.playVoice("S61Res/audio/61_10_d1",function(){s.default.setDragonAnimation(e.robot,"mouth","changtai"),t()})},e)})}),t.push(function(){return new Promise(function(t,o){$CommonData.gCData.ISCANTOUCH=!0,e.showClickWarn(e.bgNodeArr[2]),e.selectNodeArr[2].once(cc.Node.EventType.TOUCH_START,function(){var e=this;a.default.playClickEffect(),this.hideCircle(),s.default.setDragonAnimation(this.robot,"mouth","shuohua"),this.selectNodeArr[2].children[0].getComponent(dragonBones.ArmatureDisplay).playAnimation("\u878d\u5316",0),a.default.playVoice("S61Res/audio/61_10_d2",function(){s.default.setDragonAnimation(e.robot,"mouth","changtai"),t()})},e)})}),t.push(function(){return new Promise(function(t,o){$CommonData.gCData.ISCANTOUCH=!0,e.showClickWarn(e.bgNodeArr[3]),e.selectNodeArr[3].once(cc.Node.EventType.TOUCH_START,function(){a.default.playClickEffect(),this.hideCircle(),this.clickedFinish()},e),MKLog.log("promise12 success"),t()})}),s.default.runPromiseArray(t)},clickedFinish:function(){var e=this;MKLog.log("clickedFinish...");var t=new Array;t.push(function(){return new Promise(function(t,o){var n=e.selectNodeArr[3].children[0].getComponent(dragonBones.ArmatureDisplay);n.playAnimation("\u878d\u5316\u52a8\u753b",1),n.addEventListener(dragonBones.EventObject.COMPLETE,function(){MKLog.log("COMPLETE!"),n.removeEventListener(dragonBones.EventObject.COMPLETE),n.playAnimation("\u878d\u5316\u540e",0)},e),s.default.setDragonAnimation(e.bdNode,"mouth","shuohua"),a.default.playVoice("S61Res/audio/61_10_d3",function(){s.default.setDragonAnimation(e.bdNode,"mouth","daiji"),t()})})}),t.push(function(){return new Promise(function(t,o){s.default.setDragonAnimation(e.robot,"mouth","shuohua"),a.default.playVoice("S61Res/audio/61_10_d4",function(){s.default.setDragonAnimation(e.robot,"mouth","changtai"),e.node&&1==e.node.active&&n.default.net_send_stepData(1,1),t()})})}),s.default.runPromiseArray(t)},showClickWarn:function(e){this.circleNode.active=!0,this.circleNode.position=e.position},hideCircle:function(){this.circleNode.active=!1},onDisable:function(){MKLog.log("...disable"),this.unscheduleAllCallbacks()}}),cc._RF.pop()},{"../../../Script/pub/Common/MUtils/MKSound":"MKSound","../../../Script/pub/Common/MUtils/MKUtils":"MKUtils","../../../Script/pub/Common/TS_ResourceManager":"TS_ResourceManager","../../../Script/pub/Common/TS_common":"TS_common"}],S6113Logic:[function(e,t,o){"use strict";cc._RF.push(t,"f8754EdtRBKOZC9yTkCq6V0","S6113Logic");var n=s(e("../../../Script/pub/Common/TS_common")),i=s(e("../../../Script/pub/Common/MUtils/MKSound")),a=s(e("../../../Script/pub/Common/MUtils/MKUtils"));function s(e){return e&&e.__esModule?e:{default:e}}cc.Class({extends:cc.Component,properties:{},start:function(){},init:function(){this.handNode=cc.find("Canvas/UILayer/handNode"),this.bdNode=cc.find("bdNode",this.node),this.robot=cc.find("robot",this.node)},runStep:function(){var e=this;$CommonData.gCData.THIS=this,n.default.levelStarTime=MKTime.getNowTime(),this.init();var t=new Array;t.push(function(){return new Promise(function(t,o){a.default.setDragonAnimation(e.bdNode,"mouth","shuohua"),i.default.playVoice("S61Res/audio/61_13_1",function(){a.default.setDragonAnimation(e.bdNode,"mouth","daiji"),t()})})}),t.push(function(){return new Promise(function(t,o){a.default.setDragonAnimation(e.robot,"mouth","shuohua"),i.default.playVoice("S61Res/audio/61_13_2",function(){a.default.setDragonAnimation(e.robot,"mouth","changtai"),t()})})}),t.push(function(){return new Promise(function(t,o){a.default.setDragonAnimation(e.bdNode,"mouth","shuohua"),i.default.playVoice("S61Res/audio/61_13_3",function(){a.default.setDragonAnimation(e.bdNode,"mouth","daiji"),e.node&&1==e.node.active&&n.default.net_send_stepData(1,1),t()})})}),a.default.runPromiseArray(t)},onDisable:function(){MKLog.log("...disable"),this.unscheduleAllCallbacks()}}),cc._RF.pop()},{"../../../Script/pub/Common/MUtils/MKSound":"MKSound","../../../Script/pub/Common/MUtils/MKUtils":"MKUtils","../../../Script/pub/Common/TS_common":"TS_common"}],S6114Logic:[function(e,t,o){"use strict";cc._RF.push(t,"83820aIqNFJQZ/96ZoWmMM2","S6114Logic");var n=a(e("../../../Script/pub/Common/TS_common")),i=a(e("../../../Script/pub/Common/TS_ResourceManager"));function a(e){return e&&e.__esModule?e:{default:e}}cc.Class({extends:cc.Component,properties:{},start:function(){},init:function(){n.default.moveCloudNum=0,n.default.moveCloudName="",this.currentStep=1,this.robotUILayer=cc.find("Canvas/UILayer/rotot"),this.robotUILayer.x=-cc.view.getVisibleSize().width/2+200,this.robotUILayer.active=!1,this.robot=cc.find("robot",this.node),this.robot.active=!0,this.robot.on(cc.Node.EventType.TOUCH_START,function(){if(n.default.IS_CANTOUCH){n.default.IS_CANTOUCH=!1,sceneCommon.playStartEngine("S61Res/audio/61_14_1",function(){n.default.IS_CANTOUCH=!0})}},this),this.handNode=cc.find("Canvas/UILayer/handNode"),this.sun=cc.find("sun",this.node),this.sunBg=cc.find("sunBg",this.node),this.sunBg.active=!1,this.cloud1_1=cc.find("cloud1_1",this.node),this.cloud1_2=cc.find("cloud1_2",this.node),this.cloud1_3=cc.find("cloud1_3",this.node),this.cloud2_1=cc.find("cloud2_1",this.node),this.cloud2_2=cc.find("cloud2_2",this.node),this.cloud2_3=cc.find("cloud2_3",this.node),this.cloud2_4=cc.find("cloud2_4",this.node),this.initPos1=this.cloud1_1.position,this.initPos2=this.cloud1_2.position,this.initPos3=this.cloud1_3.position,this.initPos2_1=this.cloud2_1.position,this.initPos2_2=this.cloud2_2.position,this.initPos2_3=this.cloud2_3.position,this.initPos2_4=this.cloud2_4.position},runStep:function(){var e=this;$CommonData.gCData.THIS=this,this.init();MKUtils.setDragonAnimation(this.robot,"mouth","shuohua"),MKSound.playVoice("S61Res/audio/61_14_1",function(){MKUtils.setDragonAnimation(e.robot,"mouth","changtai"),n.default.IS_CANTOUCH=!0})},nextStep:function(){var e=this;n.default.moveCloudNum=0,this.currentStep++,this.sunBg.active=!0,this.sun.getComponent(dragonBones.ArmatureDisplay).playAnimation("\u5f00\u5fc3",0),i.default.loadTempRes("public/audio/win",cc.AudioClip,function(t,o){if(t)MKLog.info("err:"+t);else{var i=cc.audioEngine.playEffect(o,!1);cc.audioEngine.setFinishCallback(i,function(){2==e.currentStep?(e.cloud1_1.active=!1,e.cloud1_2.active=!1,e.cloud1_3.active=!1,e.cloud2_1.active=!0,e.cloud2_2.active=!0,e.cloud2_3.active=!0,e.cloud2_4.active=!0):3==e.currentStep&&(e.cloud1_1.position=e.initPos1,e.cloud1_2.position=e.initPos2,e.cloud1_3.position=e.initPos3,e.cloud1_1.getComponent("S6114MoveNode").setIscanMove(),e.cloud1_2.getComponent("S6114MoveNode").setIscanMove(),e.cloud1_3.getComponent("S6114MoveNode").setIscanMove(),e.cloud1_1.active=!0,e.cloud1_2.active=!0,e.cloud1_3.active=!0,e.cloud2_1.position=e.initPos2_1,e.cloud2_2.position=e.initPos2_2,e.cloud2_3.position=e.initPos2_3,e.cloud2_4.position=e.initPos2_4,e.cloud2_1.getComponent("S6114MoveNode").setIscanMove(),e.cloud2_2.getComponent("S6114MoveNode").setIscanMove(),e.cloud2_3.getComponent("S6114MoveNode").setIscanMove(),e.cloud2_4.getComponent("S6114MoveNode").setIscanMove(),e.cloud2_1.active=!0,e.cloud2_2.active=!0,e.cloud2_3.active=!0,e.cloud2_4.active=!0),e.currentStep<=3&&(e.sunBg.active=!1,e.sun.getComponent(dragonBones.ArmatureDisplay).playAnimation("\u59d4\u5c48",0));var t="S61Res/audio/61_14_"+e.currentStep;MKUtils.setDragonAnimation(e.robot,"mouth","shuohua"),MKSound.playVoice(t,function(){MKUtils.setDragonAnimation(e.robot,"mouth","changtai"),e.sunBg.active=!1,n.default.IS_CANTOUCH=!0,e.currentStep>3&&e.node&&1==e.node.active&&n.default.net_send_stepData(1,1)})})}})},update:function(e){1==this.currentStep&&n.default.moveCloudNum>=3&&this.nextStep(),2==this.currentStep&&n.default.moveCloudNum>=4&&this.nextStep(),3==this.currentStep&&n.default.moveCloudNum>=7&&this.nextStep()},onDisable:function(){MKLog.info("...disable"),this.unscheduleAllCallbacks()}}),cc._RF.pop()},{"../../../Script/pub/Common/TS_ResourceManager":"TS_ResourceManager","../../../Script/pub/Common/TS_common":"TS_common"}],S6114MoveNode:[function(e,t,o){"use strict";cc._RF.push(t,"91d12aGZdVL4ZNBga6rR/od","S6114MoveNode");var n=a(e("../../../Script/pub/Common/TS_common")),i=a(e("../../../Script/pub/Common/TS_ResourceManager"));function a(e){return e&&e.__esModule?e:{default:e}}cc.Class({extends:cc.Component,properties:{nodeName:""},start:function(){this.node.on(cc.Node.EventType.TOUCH_START,this.touchStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.touchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.touchEnd,this),this.groupName=null,this.isCanMove=!0,this.starPos=cc.v2(cc.v2(this.node.x,this.node.y)),this.targetNode=this.node.parent},setIscanMove:function(){this.isCanMove=!0},touchStart:function(e){MKLog.info("touchStart"),n.default.IS_CANTOUCH&&this.isCanMove&&(this.initSiblingIndex=this.node.getSiblingIndex(),this.initPos=this.node.position,this.node.setSiblingIndex(100),MKSound.playClickEffect())},touchMove:function(e){if(e.stopPropagation(),n.default.IS_CANTOUCH&&this.isCanMove){var t=e.touch.getLocation();t=this.node.parent.convertToNodeSpaceAR(t),this.node.x=t.x,this.node.y=t.y}},touchEnd:function(e){if(e.stopPropagation(),n.default.IS_CANTOUCH&&this.isCanMove){var t=e.touch.getLocation();t=this.node.parent.convertToNodeSpaceAR(t),this.node.setSiblingIndex(this.initSiblingIndex),"cloud1"==this.nodeName&&(this.node.x<-480||this.node.x>300||this.node.y<-450?(this.successPlay(),this.isCanMove=!1):this.failPlay()),"cloud2"==this.nodeName&&(this.node.x<-460||this.node.x>250||this.node.y<-450?(this.successPlay(),this.isCanMove=!1):this.failPlay()),"cloud3"==this.nodeName&&(this.node.x<-460||this.node.x>250||this.node.y<-450?(this.successPlay(),this.isCanMove=!1):this.failPlay())}},successPlay:function(){n.default.moveCloudNum++,i.default.loadTempRes("public/audio/succ/succ_e1",cc.AudioClip,function(e,t){e?MKLog.info("err:"+e):cc.audioEngine.playEffect(t,!1)})},failPlay:function(){this.node.position=this.initPos,n.default.moveCloudName=this.nodeName,i.default.loadTempRes("public/audio/fail/fail_e2",cc.AudioClip,function(e,t){e?MKLog.info("err:"+e):cc.audioEngine.playEffect(t,!1)})}}),cc._RF.pop()},{"../../../Script/pub/Common/TS_ResourceManager":"TS_ResourceManager","../../../Script/pub/Common/TS_common":"TS_common"}],S6115Logic:[function(e,t,o){"use strict";cc._RF.push(t,"7892fOOiFJEZ7XMDYXXI+B8","S6115Logic");var n=s(e("../../../Script/pub/Common/TS_common")),i=s(e("../../../Script/pub/Common/MUtils/MKSound")),a=s(e("../../../Script/pub/Common/MUtils/MKUtils"));function s(e){return e&&e.__esModule?e:{default:e}}cc.Class({extends:cc.Component,properties:{},start:function(){},init:function(){this.robotUIlayer=cc.find("Canvas/UILayer/rotot"),this.robotUIlayer.active=!1,this.handNode=cc.find("Canvas/UILayer/handNode"),this.bdNode=cc.find("bdNode",this.node),this.robot=cc.find("robot",this.node),this.robot.x=-cc.view.getVisibleSize().width/2+200,this.bdNode.x=cc.view.getVisibleSize().width/2,this.robot.active=!0,this.bg1=cc.find("bg1",this.node),this.bg2=cc.find("bg2",this.node),this.bg3=cc.find("bg3",this.node),this.bg4=cc.find("bg4",this.node),this.bg5=cc.find("bg5",this.node),this.bg6=cc.find("bg6",this.node)},runStep:function(){var e=this;$CommonData.gCData.THIS=this,n.default.levelStarTime=MKTime.getNowTime(),this.init();var t=new Array;t.push(function(){return new Promise(function(t,o){a.default.setDragonAnimation(e.robot,"mouth","shuohua"),i.default.playVoice("S61Res/audio/61_15_1",function(){a.default.setDragonAnimation(e.robot,"mouth","changtai"),t()}),e.scheduleOnce(function(){e.bg1.active=!0},4),e.scheduleOnce(function(){e.bg2.active=!0,e.bg3.active=!0},8)})}),t.push(function(){return new Promise(function(t,o){e.bg1.active=!1,e.bg2.active=!1,e.bg3.active=!1,e.bg4.active=!0,a.default.setDragonAnimation(e.bdNode,"mouth","shuohua"),i.default.playVoice("S61Res/audio/61_15_2",function(){a.default.setDragonAnimation(e.bdNode,"mouth","daiji"),t()}),e.scheduleOnce(function(){e.bg4.active=!1,e.bg5.active=!0},3),e.scheduleOnce(function(){e.bg5.active=!1,e.bg6.active=!0},7)})}),t.push(function(){return new Promise(function(t,o){a.default.setDragonAnimation(e.robot,"mouth","shuohua"),i.default.playVoice("S61Res/audio/61_15_3",function(){a.default.setDragonAnimation(e.robot,"mouth","changtai"),e.node&&1==e.node.active&&n.default.net_send_stepData(1,1),t()})})}),a.default.runPromiseArray(t)},onDisable:function(){MKLog.log("...disable"),this.unscheduleAllCallbacks()}}),cc._RF.pop()},{"../../../Script/pub/Common/MUtils/MKSound":"MKSound","../../../Script/pub/Common/MUtils/MKUtils":"MKUtils","../../../Script/pub/Common/TS_common":"TS_common"}],S61FireFly:[function(e,t,o){"use strict";cc._RF.push(t,"c5f1aFrsV9PZ4Hch40vzYoD","S61FireFly"),cc.Class({extends:cc.Component,properties:{tNode:{default:null,type:cc.Node},bg:{default:null,type:cc.Node},offsetx:0,offsety:0},start:function(){},update:function(e){this.tNode&&(this.node.x=this.tNode.x,this.node.y=this.tNode.y,this.bg.x=-this.node.x+this.offsetx,this.bg.y=-this.node.y+this.offsety)}}),cc._RF.pop()},{}],StepChooser:[function(e,t,o){"use strict";cc._RF.push(t,"6d6b3wOmHZJ/r2PMWiwp/0u","StepChooser"),cc.Class({extends:cc.Component,properties:{stepTemplate:{default:null,type:cc.Prefab}},reloadData:function(){var e=this;this.node.removeAllChildren();for(var t=!1,o=0;o<$CommonData.gSData.serverData.steps.length;o++){if($CommonData.gSData.serverData.steps[o].stepname.indexOf("\u95ef\u5173\u6545\u4e8b")>=0){t=!0;break}}MKLog.info("to show steps......."),MKLog.info("is exists adv node.."+t);for(var n=function(o){var n=$CommonData.gSData.serverData.steps[o],i=n.id+":"+n.stepname;if(t&&"\u95ef\u5173\u9898"==n.steptype)return"continue";a=cc.instantiate(e.stepTemplate),a.getChildByName("steplabel").getComponent(cc.Label).string=i,a.scale=2*a.scale/3,e.node.addChild(a),a.on(cc.Node.EventType.TOUCH_START,function(){if($CommonData.gSData.serverData.isReviewing||$CommonData.gSData.serverData.isTesting)MKLog.log("\u8bfe\u524d\u7ec3\u4e60\u548c\u6d4b\u8bd5\u4e0d\u80fd\u8df3\u8f6c");else{MKLog.log("stepbutton been clicked!");var t=new cc.Event.EventCustom("GotoStep",!1);t.setUserData({stepid:n.id}),cc.find("Canvas").dispatchEvent(t),e.node.active=!1}},e)},i=0;i<$CommonData.gSData.serverData.steps.length;i++){var a;n(i)}this.node.on(cc.Node.EventType.TOUCH_START,this.touchStart,this)},start:function(){},touchStart:function(e){e.stopPropagation(),this.node.active=!1}}),cc._RF.pop()},{}],SwitchLayer:[function(e,t,o){"use strict";cc._RF.push(t,"98409aKhbpI46Tt439eXGU0","SwitchLayer");var n={node:{setParent:function(e,t,o){if(e!==t.parent)if(!0===o){var i=n.node.getWorldPosition(t),a=n.node.getWorldRotation(t),s=n.node.getWorldScale(t);if(t.parent=e,n.node.setWorldPosition(t,i),n.node.setWorldRotation(t,a),e){var r=n.node.getWorldScale(e);s.x/=r.x,s.y/=r.y,t.scale=s}else t.scale=s}else t.parent=e},getWorldPosition:function(e){return e.parent.convertToWorldSpaceAR(e.position)},setWorldPosition:function(e,t){var o=e.parent;return e.position=o?o.convertToNodeSpaceAR(t):t,e.position},getWorldRotation:function(e){return n.node.getNodeToWorldRotation(e.parent,e.rotation)},setWorldRotation:function(e,t){return e.rotation=n.node.getWorldToNodeRotation(e.parent,t),e.rotation},getWorldScale:function(e){return n.node.getNodeToWorldScale(e.parent,e.scaleX,e.scaleY)},setWorldScale:function(e,t){var o=n.node.getWorldToNodeScale(e.parent,t.x,t.y);return e.scale=o,e.scale},getNodeToWorldPosition:function(e,t){return null===e?t:e.convertToWorldSpaceAR(t)},getWorldToNodePosition:function(e,t){return null===e?t:e.convertToNodeSpaceAR(t)},getNodeToWorldScale:function(e,t,o){for(var n=t,i=o,a=e;a;)n*=a.scaleX,i*=a.scaleY,a=a.parent;return new cc.Vec2(n,i)},getWorldToNodeScale:function(e,t,o){var i=n.node.getWorldScale(e);return new cc.Vec2(t/i.x,o/i.y)},getNodeToWorldRotation:function(e,t){for(var o=t,n=e;n;)o+=n.rotation,n=n.parent;return o},getWorldToNodeRotation:function(e,t){for(var o=t,n=e;n;)o-=n.rotation,n=n.parent;return o}}};t.exports=n,cc._RF.pop()},{}],TS_Alert:[function(e,t,o){"use strict";cc._RF.push(t,"c49e2rpq7JIfbXIMnzp34Xi","TS_Alert"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../Common/TS_ResourceManager"),i={_alert:null,_lb_dec:null,_alert_ok:null,_lb_ok:null,_alert_cancel:null,_lb_cancel:null,_alert_free:null,_enterCallBack:null,_animSpeed:.3,_lb_free_left:null,_lb_free_right:null};cc.Class({extends:cc.Component,properties:{},statics:{show:function(e,t,o,a,s,r){var c=this;void 0==i._alert&&(i._animSpeed=r||i._animSpeed,n.default.loadUnitRes("prefab/Alert",cc.Prefab,function(n,l){if(n)cc.error(n);else{var u=cc.instantiate(l);i._alert=u;var d=cc.callFunc(c.onFadeOutFinish,c),h=cc.callFunc(c.onFadeInFinish,c);c.actionFadeIn=cc.sequence(cc.spawn(cc.fadeTo(i._animSpeed,255),cc.scaleTo(i._animSpeed,1)),h),c.actionFadeOut=cc.sequence(cc.spawn(cc.fadeTo(i._animSpeed,0),cc.scaleTo(i._animSpeed,2)),d),i._lb_dec=cc.find("alert_background/lb_dec",u).getComponent(cc.Label),i._alert_cancel=cc.find("alert_background/alert_cancel",u),i._lb_cancel=cc.find("alert_background/alert_cancel/lb_cancel",u).getComponent(cc.Label),i._alert_ok=cc.find("alert_background/alert_ok",u),i._lb_ok=cc.find("alert_background/alert_ok/lb_ok",u).getComponent(cc.Label),i._alert_free=cc.find("alert_background/alert_free",u),i._lb_free_left=cc.find("alert_background/alert_free/lb_free_left",u).getComponent(cc.Label),i._lb_free_right=cc.find("alert_background/alert_free/lb_free_right",u).getComponent(cc.Label);var g=o.replace("###","");void 0!=o&&g!=o?(i._alert_ok.active=!1,i._alert_cancel.active=!1,i._alert_free.active=!0):(i._alert_ok.active=!0,i._alert_cancel.active=!0,i._alert_free.active=!1),o=g,i._alert_ok.on("click",c.onButtonClicked,c),i._alert_cancel.on("click",c.onButtonClicked,c),i._alert_free.on("click",c.onButtonClicked,c),i._alert.parent=e,c.startFadeIn(),c.configAlert(t,o,a,s,r),$CommonData.gCData.isShowAlert=!0}}),c.configAlert=function(e,t,o,n,a){if(i._enterCallBack=n,i._lb_dec.string=void 0==e?"":e,i._alert_free.active)return i._lb_free_left.string=""+t,void(i._lb_free_right.string=""+o);var s;(i._lb_ok.string=""+t,i._lb_cancel.string=""+o,""==o)?(i._alert_cancel.active=!0,(s=i._alert_ok.getComponent(cc.Widget))&&(s.left=50,s.isAlignLeft=!0,s.updateAlignment())):(i._alert_cancel.active=!1,(s=i._alert_ok.getComponent(cc.Widget))&&(s.isAlignHorizontalCenter=!0,s.updateAlignment()))},c.startFadeIn=function(){i._alert&&(i._alert.position=cc.v2(0,0),i._alert.setScale(2),i._alert.opacity=0,i._alert.runAction(c.actionFadeIn))},c.startFadeOut=function(){i._alert&&i._alert.runAction(c.actionFadeOut)},c.onFadeInFinish=function(){},c.onFadeOutFinish=function(){c.onDestory()},c.onButtonClicked=function(e){"alert_ok"==e.target.name?(MKLog.log("\u786e\u8ba4\u6309\u94ae"),i._enterCallBack&&i._enterCallBack(),c.startFadeOut()):"alert_free"==e.target.name?(MKLog.log("\u7533\u8bf7\u514d\u8d39\u4f53\u9a8c\u6309\u94ae"),i._enterCallBack&&i._enterCallBack(),i._lb_ok.string):(MKLog.log("\u53d6\u6d88\u6309\u94ae"),c.startFadeOut())},c.onDestory=function(){i._alert.destroy(),i._enterCallBack=null,i._alert=null,i._lb_dec=null,i._alert_cancel=null,i._lb_cancel=null,i._alert_ok=null,i._lb_ok=null,i._alert_free=null,i._animSpeed=.3,i._lb_free_left=null,i._lb_free_right=null,$CommonData.gCData.isShowAlert=!1})},onDestoryNode:function(){i._alert&&(i._alert.destroy(),i._alert=null)}},start:function(){}}),cc._RF.pop()},{"../Common/TS_ResourceManager":"TS_ResourceManager"}],TS_Collider_colliderLogic:[function(e,t,o){"use strict";cc._RF.push(t,"6193bdjRjZAbK6jkA6rcA+a","TS_Collider_colliderLogic"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,i=n.ccclass,a=(n.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.collierANum=-1,t.collierBNum=-1,t}return __extends(t,e),t.prototype.start=function(){this.collierANum=-1,this.collierBNum=-1},t.prototype.onCollisionEnter=function(e,t){"selectA"==e.node.group?this.collierANum=e.node.getComponent("TS_Node_ligatureLogic").ItemIndex:"selectB"==e.node.group&&(this.collierBNum=e.node.getComponent("TS_Node_ligatureLogic").ItemIndex)},t.prototype.onCollisionStay=function(e,t){"selectA"==e.node.group?this.collierANum=e.node.getComponent("TS_Node_ligatureLogic").ItemIndex:"selectB"==e.node.group&&(this.collierBNum=e.node.getComponent("TS_Node_ligatureLogic").ItemIndex)},t.prototype.onCollisionExit=function(e,t){"selectA"==e.node.group?this.collierANum=-1:"selectB"==e.node.group&&(this.collierBNum=-1)},t=__decorate([i],t)}(cc.Component));o.default=a,cc._RF.pop()},{}],TS_NetCenter:[function(e,t,o){"use strict";cc._RF.push(t,"7d550AW7v1LhoJsBD6iwoby","TS_NetCenter"),Object.defineProperty(o,"__esModule",{value:!0});var n={NET_CONST_PATH:"https://test.10fenkexue.com/api/minigame/",NET_CONFIG_PATH:"https://test.10fenkexue.com/api/config/",dataArray:[],init:function(){MKLog.log("NetCenter init()============"),window.CCC_DEBUGABLE?(this.NET_CONST_PATH="https://test.10fenkexue.com/api/minigame/",this.NET_CONFIG_PATH="https://test.10fenkexue.com/api/config/"):(this.NET_CONST_PATH="https://api.10fenkexue.com/api/minigame/",this.NET_CONFIG_PATH="https://api.10fenkexue.com/api/config/"),console.log("this.NET_CONST_PATH============",this.NET_CONST_PATH),console.log("this.NET_CONFIG_PATH============",this.NET_CONFIG_PATH)},send_stepData:function(e,t){MKLog.log("-------------"),MKLog.log(e);var o=this;this.httpPost("stepReport",e,function(e){if(MKLog.log("send_stepData succ:"),MKLog.log(e),o.dataArray.length>0){var n=o.dataArray.shift();o.send_stepData(n)}t&&t(e)},function(){MKLog.log("send_stepData fail:"),o.dataArray.push(e),MKLog.log("\u6728\u6709\u6536\u5230\u670d\u52a1\u5668\u6d88\u606f\u4e0b\u884c"),t&&t()})},httpGet:function(e,t,o,n){var i=new XMLHttpRequest;i.onreadystatechange=function(){if(4==i.readyState)if(i.status>=200&&i.status<400){var e=i.responseText;o(e)}else n()},i.ontimeout=function(e){MKLog.log(e)},i.onerror=function(e){MKLog.log(e)};var a=this.NET_CONST_PATH+e;if(null!=t){for(var s in a+="?",t)a+=s+"="+t[s]+"&";MKLog.log("httprequest, uri is:"+a)}i.open("GET",a,!0),i.send()},httpPost:function(e,t,o,n){var i=new XMLHttpRequest;i.onreadystatechange=function(){if(4==i.readyState)if(i.status>=200&&i.status<400){var e=i.responseText;o(e)}else n()},i.ontimeout=function(e){MKLog.log(e)},i.onerror=function(e){MKLog.log(e)};var a=this.NET_CONST_PATH+e,s="";if(null!=t){for(var r in t)s+=r+"="+t[r]+"&";MKLog.log("httprequest, uri is:"+a)}i.open("POST",this.NET_CONST_PATH+e,!0),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),MKLog.log("POST Data:"),MKLog.log(s),i.send(s)}};o.default=n,cc._RF.pop()},{}],TS_Node_ligatureLogic:[function(e,t,o){"use strict";cc._RF.push(t,"f39ce09oshOMoveH2CYjVUr","TS_Node_ligatureLogic"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,i=n.ccclass,a=n.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.starNode=null,t.ItemIndex=-1,t}return __extends(t,e),t.prototype.start=function(){this.getNodeWorldPos()},t.prototype.getNodeWorldPos=function(){var e=this.node.convertToWorldSpaceAR(cc.v2(this.starNode.x,this.starNode.y));return e=this.node.getParent().convertToNodeSpaceAR(e)},__decorate([a(cc.Node)],t.prototype,"starNode",void 0),t=__decorate([i],t)}(cc.Component);o.default=s,cc._RF.pop()},{}],TS_Node_moveChange2Logic:[function(e,t,o){"use strict";cc._RF.push(t,"58f08uMhS9NFKF6KHHox0sR","TS_Node_moveChange2Logic"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,i=n.ccclass,a=(n.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.seleIndex=-1,t.selfKuang=null,t.starPos=cc.v2(0,0),t.isCanMove=!0,t.isTouch=!1,t.otherNode=null,t.restartPos=cc.v2(0,0),t.restartIndex=0,t.touchPos=cc.v2(0,0),t}return __extends(t,e),t.prototype.start=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.touchStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.touchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.touchEnd,this),this.starPos=cc.v2(this.node.x,this.node.y),this.isTouch=!1,this.otherNode=null,this.restartPos=cc.v2(this.node.x,this.node.y),this.restartIndex=this.seleIndex},t.prototype.touchStart=function(e){if($CommonData.gCData.ISCANTOUCH&&this.isCanMove&&$CommonData.gCData.gameIsProceed){this.isTouch=!0;var t=e.touch.getLocation();t=this.node.getParent().convertToNodeSpaceAR(t),this.touchPos=cc.v2(this.node.x,this.node.y),this.node.x=t.x,this.node.y=t.y,MKSound.playClickEffect()}},t.prototype.touchMove=function(e){if($CommonData.gCData.ISCANTOUCH&&this.isTouch){var t=e.touch.getLocation();t=this.node.getParent().convertToNodeSpaceAR(t),this.node.x=t.x,this.node.y=t.y,this.node.zIndex=10}},t.prototype.touchEnd=function(e){if($CommonData.gCData.ISCANTOUCH&&this.isTouch)if(this.isTouch=!1,this.node.zIndex=1,this.otherNode){var t=this.otherNode.getComponent("dottedKuangLogic");this.seleIndex==t.arrIndex?(this.node.x=this.otherNode.x,this.node.y=this.otherNode.y,this.node.scale=this.otherNode.scale,this.isCanMove=!1,this.node.dispatchEvent(new cc.Event.EventCustom("step_success",!0))):(this.node.x=this.starPos.x,this.node.y=this.starPos.y,this.node.dispatchEvent(new cc.Event.EventCustom("step_fail",!0)))}else this.node.x=this.touchPos.x,this.node.y=this.touchPos.y},t.prototype.restartNode=function(){this.node.x=this.restartPos.x,this.node.y=this.restartPos.y,this.seleIndex=this.restartIndex,this.selfKuang=null},t.prototype.overMovePos=function(e){var t=this;this.node.zIndex=10;var o=cc.moveTo(1,cc.v2(e.x,e.y)),n=cc.callFunc(function(){t.node.zIndex=1});this.node.runAction(cc.sequence(o,n))},t.prototype.onCollisionStay=function(e,t){"selectC"==e.node.group&&(this.otherNode=e.node)},t.prototype.onCollisionExit=function(e,t){"selectC"==e.node.group&&(this.otherNode=null)},t=__decorate([i],t)}(cc.Component));o.default=a,cc._RF.pop()},{}],TS_Node_moveChangeLogic:[function(e,t,o){"use strict";cc._RF.push(t,"1e6b4//QflNlbdHosCRdX8i","TS_Node_moveChangeLogic"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,i=n.ccclass,a=(n.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.seleIndex=-1,t.starPos=cc.v2(0,0),t.isCanMove=!1,t.isTouch=!1,t.otherNode=null,t.restartPos=cc.v2(0,0),t.restartIndex=0,t}return __extends(t,e),t.prototype.start=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.touchStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.touchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.touchEnd,this),this.starPos=cc.v2(this.node.x,this.node.y),this.isCanMove=!0,this.isTouch=!1,this.otherNode=null,this.restartPos=cc.v2(this.node.x,this.node.y),this.restartIndex=this.seleIndex},t.prototype.touchStart=function(e){if($CommonData.gCData.ISCANTOUCH&&this.isCanMove&&$CommonData.gCData.gameIsProceed){this.isTouch=!0;var t=e.touch.getLocation();t=this.node.getParent().convertToNodeSpaceAR(t),this.node.x=t.x,this.node.y=t.y,MKSound.playClickEffect()}},t.prototype.touchMove=function(e){if($CommonData.gCData.ISCANTOUCH&&this.isTouch){var t=e.touch.getLocation();t=this.node.getParent().convertToNodeSpaceAR(t),this.node.x=t.x,this.node.y=t.y,this.node.zIndex=10}},t.prototype.touchEnd=function(e){if($CommonData.gCData.ISCANTOUCH&&this.isTouch)if(this.isTouch=!1,this.node.zIndex=1,this.otherNode){var t=this.otherNode.getComponent("TS_Node_moveChangeLogic");this.node.x=t.starPos.x,this.node.y=t.starPos.y,this.otherNode.x=this.starPos.x,this.otherNode.y=this.starPos.y;var o=this.starPos;this.starPos=cc.v2(this.node.x,this.node.y),t.starPos=o;var n=this.seleIndex;this.seleIndex=t.seleIndex,t.seleIndex=n}else this.node.x=this.starPos.x,this.node.y=this.starPos.y},t.prototype.restartNode=function(){this.node.x=this.restartPos.x,this.node.y=this.restartPos.y,this.seleIndex=this.restartIndex},t.prototype.overMovePos=function(e){var t=this,o=cc.moveTo(1,cc.v2(e.x,e.y)),n=cc.callFunc(function(){var e=t.otherNode.getComponent("TS_Node_moveChangeLogic");t.node.x=e.starPos.x,t.node.y=e.starPos.y,t.otherNode.x=t.starPos.x,t.otherNode.y=t.starPos.y});this.node.runAction(cc.sequence(o,n))},t.prototype.onCollisionStay=function(e,t){"exchange"==e.node.group&&(this.otherNode=e.node)},t.prototype.onCollisionExit=function(e,t){"exchange"==e.node.group&&(this.otherNode=null)},t=__decorate([i],t)}(cc.Component));o.default=a,cc._RF.pop()},{}],TS_Node_selectNodeLogic:[function(e,t,o){"use strict";cc._RF.push(t,"6700dbbpp1G67v0XbgZYG/Z","TS_Node_selectNodeLogic"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../Common/TS_ResourceManager"),i=cc._decorator,a=i.ccclass,s=(i.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scalebig=-1,t.scaleSmall=-1,t.isTouch=!1,t.isSelect=!1,t.sceneName="",t.mengLayer=null,t}return __extends(t,e),t.prototype.start=function(){var e=this;this.isTouch=!1,this.isSelect=!1,this.node.on(cc.Node.EventType.TOUCH_START,this.touchStart,this),this.node.on(cc.Node.EventType.TOUCH_END,this.touchEnd,this);var t=this.node.getChildByName("selectSign");t.zIndex=10,t.width=90,t.height=90;var o,i=new cc.Node,a=i.addComponent(cc.Sprite);"selectNode"==this.node.name||"selectCircleNode"==this.node.name||"exercise_select_circle"==this.node.name?(o="public/exercise/mask_Cricle",t.x=120,t.y=-90):(o="public/exercise/mask_Square",t.x=.35*this.node.width,t.y=.35*-this.node.height),n.default.loadUnitRes(o,cc.SpriteFrame,function(t,o){t?MKLog.info("err:"+t):(a.spriteFrame=o,i.width=e.node.width,i.height=e.node.height)}),this.node.addChild(i),this.mengLayer=i,this.mengLayer.active=!1},t.prototype.touchStart=function(e){$CommonData.gCData.ISCANTOUCH&&$CommonData.gCData.gameIsProceed&&(this.isTouch=!0,MKSound.playClickEffect())},t.prototype.touchEnd=function(e){this.isTouch&&(this.isTouch=!1,this.isSelect=!this.isSelect,this.isSelect?(this.mengLayer.active=!0,this.node.getChildByName("selectSign").active=!0,$CommonData.gCData.isSingleChoice&&this.node.dispatchEvent(new cc.Event.EventCustom("SingleChoice",!0))):("S52"!=this.sceneName?this.mengLayer.active=!1:-1==this.scaleSmall?this.node.scale=1:this.node.scale=this.scaleSmall,this.node.getChildByName("selectSign").active=!1))},t.prototype.restartNode=function(){"S52"!=this.sceneName&&this.mengLayer?this.mengLayer.active=!1:-1==this.scaleSmall?this.node.scale=1:this.node.scale=this.scaleSmall,this.isSelect=!1,this.node.getChildByName("selectSign").active=!1},t.prototype.selfSelect=function(){this.isSelect=!0,"S52"!=this.sceneName&&this.mengLayer?this.mengLayer.active=!0:-1==this.scalebig?this.node.scale=1.2:this.node.scale=this.scalebig,this.node.getChildByName("selectSign").active=!0},t=__decorate([a],t)}(cc.Component));o.default=s,cc._RF.pop()},{"../../Common/TS_ResourceManager":"TS_ResourceManager"}],TS_Node_touchMoveLogic:[function(e,t,o){"use strict";cc._RF.push(t,"94e7cBCadZL3LCvh/og0aQp","TS_Node_touchMoveLogic"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,i=n.ccclass,a=(n.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isSuccceNode=!1,t.layerIndex=-1,t.audioIndex=-1,t.starPos=cc.v2(0,0),t.collierANum=0,t.otherNode=null,t.isCanMove=!0,t.isTouch=!0,t}return __extends(t,e),t.prototype.start=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.touchStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.touchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.touchEnd,this),this.starPos=cc.v2(this.node.x,this.node.y),this.collierANum=-1,this.otherNode=null,this.isCanMove=!0},t.prototype.touchStart=function(e){$CommonData.gCData.ISCANTOUCH&&this.isCanMove&&$CommonData.gCData.gameIsProceed&&(this.isTouch=!0,MKSound.playClickEffect())},t.prototype.touchMove=function(e){if($CommonData.gCData.ISCANTOUCH&&(this.isTouch||!this.isCanMove)){var t=e.touch.getLocation();t=this.node.getParent().convertToNodeSpaceAR(t),this.node.x=t.x,this.node.y=t.y}},t.prototype.touchEnd=function(e){if($CommonData.gCData.ISCANTOUCH&&(this.isTouch||!this.isCanMove))if(1==this.collierANum&&this.isSuccceNode)this.otherNode&&(this.otherNode.children[this.layerIndex].active=!0),this.node.active=!1,this.isCanMove=!1,this.node.dispatchEvent(new cc.Event.EventCustom("step_success",!0));else if(this.node.x=this.starPos.x,this.node.y=this.starPos.y,this.isSuccceNode){var t="public/audio/fail/fail_e"+Math.ceil(Math.random()*$CommonData.gCData.failNum);MKSound.playVoice(t)}else this.node.dispatchEvent(new cc.Event.EventCustom("step_fail",!0))},t.prototype.onCollisionStay=function(e,t){"selectC"==e.node.group&&(this.collierANum=1,this.otherNode=e.node)},t.prototype.onCollisionExit=function(e,t){"selectC"==e.node.group&&(this.collierANum=-1,this.otherNode=null)},t.prototype.restartNode=function(){this.isCanMove=!0,this.node.active=!0,this.starPos&&(this.node.x=this.starPos.x,this.node.y=this.starPos.y)},t.prototype.moveSelfPos=function(e){var t=this,o=this.node.getParent().getParent().convertToWorldSpaceAR(e);o=this.node.getParent().convertToNodeSpaceAR(o);var n=cc.moveTo(1,cc.v2(o.x,o.y)),i=cc.callFunc(function(){t.otherNode&&(t.otherNode.children[t.layerIndex].active=!0),t.node.active=!1});this.node.runAction(cc.sequence(n,i))},t=__decorate([i],t)}(cc.Component));o.default=a,cc._RF.pop()},{}],TS_Node_touchSelectMoveLogic:[function(e,t,o){"use strict";cc._RF.push(t,"ff615Mz2wRKT6yuAAq7hALM","TS_Node_touchSelectMoveLogic"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,i=n.ccclass,a=(n.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.targetGroup="",t.layerIndex=-1,t.audioIndex=-1,t.starPos=cc.v2(0,0),t.collierANum=-1,t.collierGroup="",t.otherNode=null,t.isCanMove=!1,t.isTouch=!1,t}return __extends(t,e),t.prototype.start=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.touchStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.touchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.touchEnd,this),this.starPos=cc.v2(this.node.x,this.node.y),this.collierANum=-1,this.collierGroup=null,this.otherNode=null,this.isCanMove=!0},t.prototype.touchStart=function(e){$CommonData.gCData.ISCANTOUCH&&this.isCanMove&&$CommonData.gCData.gameIsProceed&&(this.isTouch=!0,MKSound.playClickEffect())},t.prototype.touchMove=function(e){if($CommonData.gCData.ISCANTOUCH&&(this.isTouch||!this.isCanMove)){var t=e.touch.getLocation();t=this.node.getParent().convertToNodeSpaceAR(t),this.node.x=t.x,this.node.y=t.y}},t.prototype.touchEnd=function(e){!$CommonData.gCData.ISCANTOUCH||!this.isTouch&&this.isCanMove||(this.collierGroup==this.targetGroup?(this.otherNode&&(this.otherNode.children[this.layerIndex+1].active=!0),this.node.active=!1,this.isCanMove=!1,this.node.dispatchEvent(new cc.Event.EventCustom("step_success",!0))):(this.node.x=this.starPos.x,this.node.y=this.starPos.y,this.node.dispatchEvent(new cc.Event.EventCustom("step_fail",!0))))},t.prototype.onCollisionStay=function(e,t){this.collierGroup=e.node.group,this.otherNode=e.node},t.prototype.onCollisionExit=function(e,t){this.collierGroup==e.node.group&&(this.collierGroup=null,this.otherNode=null)},t.prototype.restartNode=function(){this.isCanMove=!0,this.node.active=!0,this.node.x=this.starPos.x,this.node.y=this.starPos.y},t.prototype.moveSelfPos=function(e){var t=this,o=this.node.getParent().getParent().convertToWorldSpaceAR(e);o=this.node.getParent().convertToNodeSpaceAR(o);var n=cc.moveTo(1,cc.v2(o.x,o.y)),i=cc.callFunc(function(){t.otherNode&&(t.otherNode.children[t.layerIndex+1].active=!0),t.node.active=!1});this.node.runAction(cc.sequence(n,i))},t=__decorate([i],t)}(cc.Component));o.default=a,cc._RF.pop()},{}],TS_ResourceManager:[function(e,t,o){"use strict";cc._RF.push(t,"01160CMoF1OyKyCd5FrqOEx","TS_ResourceManager"),Object.defineProperty(o,"__esModule",{value:!0});var n={tempRes:[],unitRes:[],persistentRes:[],_resMap:{},_defaultAudio:cc.AudioClip,init:function(){this.tempRes=[],this.unitRes=[],this.persistentRes=[],this._defaultAudio=null},_loadDefaultAudio:function(e,t){MKLog.log("_loadDefaultAudio!!! rarray ===== "+t);var o=this;cc.loader.loadRes("public/audio/default",cc.AudioClip,function(n,i){n||(t.push("public/audio/default"),o._resMap["public/audio/default"]=i),MKLog.log("callback:"+n+",,"+i),e&&e(n,i)})},_loadRes:function(e,t,o,n,i){var a=this;MKLog.log("_loadRes_loadRes_loadRes_loadRes!!! url ===== "+e),cc.loader.loadRes(e,t,function(s,r){if(s&&(MKLog.error("_loadRes!!! url = "+e),MKLog.error(JSON.stringify(s))),s){if(i<5)setTimeout(function(){a._loadRes(e,t,o,n,i+1)},500);else if(t===cc.AudioClip)return void a._loadDefaultAudio(o,n)}else n.push(e),a._resMap[e]=r,o&&o(s,r)})},loadTempRes:function(e,t,o){MKLog.log("========================loadTempRes ========================:");void 0==this._resMap[e]?this._loadRes(e,t,o,this.tempRes):o&&o(0,this._resMap[e])},loadUnitRes:function(e,t,o){MKLog.log("========================loadUnitRes ========================:");void 0==this._resMap[e]?this._loadRes(e,t,o,this.unitRes):o&&o(0,this._resMap[e])},loadPersistentRes:function(e,t,o){MKLog.log("========================loadPersistentRes ========================:");void 0==this._resMap[e]?this._loadRes(e,t,o,this.persistentRes):o&&o(0,this._resMap[e])},releaseTempResExceptPrefab:function(){MKLog.log("========================releaseTempResExceptPrefab ========================:"),MKLog.log("========================releaseTempResExceptPrefab tempRes========================:",this.tempRes);for(var e=0;e<this.tempRes.length;e++){var t=this.tempRes[e],o=this._resMap[t];if(o instanceof cc.AudioClip)MKLog.log("release audio:"+t),cc.audioEngine.uncache(o),cc.loader.release(o);else if(o instanceof cc.SpriteAtlas){MKLog.log("release temp spriteatlas:"+t);var n=cc.loader.getDependsRecursively(o);cc.loader.release(n)}else cc.loader.release(o);delete this._resMap[t]}this.tempRes=[]},releaseTempRes:function(){MKLog.log("========================releaseTempRes ========================:"),MKLog.log("========================releaseAllRes tempRes========================:",this.tempRes);for(var e=0;e<this.tempRes.length;e++){var t=this.tempRes[e],o=this._resMap[t];if(o instanceof cc.AudioClip)MKLog.log("release audio:"+t),cc.audioEngine.uncache(o),cc.loader.release(o);else if(o instanceof cc.Prefab){MKLog.log("release prefab:"+t),MKLog.log("tempres, not really release"),cc.loader.setAutoRelease(o,!0);var n=cc.loader.getDependsRecursively(o);cc.loader.release(n)}else if(o instanceof cc.SpriteAtlas){MKLog.log("release temp spriteatlas:"+t);n=cc.loader.getDependsRecursively(o);cc.loader.release(n)}else cc.loader.release(o);delete this._resMap[t]}this.tempRes=[]},releaseUnitRes:function(){MKLog.log("========================releaseUnitRes ========================:"),MKLog.log("========================releaseAllRes unitRes========================:",this.unitRes),this.releaseTempRes();for(var e=0;e<this.unitRes.length;e++){var t=this.unitRes[e],o=this._resMap[t];if(o instanceof cc.AudioClip)MKLog.log("release audio:"+t),cc.audioEngine.uncache(o),cc.loader.release(o);else if(o instanceof cc.Prefab){MKLog.log("release unitres prefab:"+t),cc.loader.setAutoRelease(o,!0);var n=cc.loader.getDependsRecursively(o);cc.loader.release(n)}else if(o instanceof cc.SpriteAtlas){MKLog.log("release unit spriteatlas:"+t);n=cc.loader.getDependsRecursively(o);cc.loader.release(n)}else cc.loader.release(o);delete this._resMap[t]}this.unitRes=[]},releaseAllRes:function(e){MKLog.log("========================releaseAllRes========================:"),MKLog.log("========================releaseAllRes persistentRes========================:",this.persistentRes),this.releaseTempRes(),this.releaseUnitRes();for(var t=0;t<this.persistentRes.length;t++){var o=this.persistentRes[t],n=this._resMap[o];if(!(e&&e.indexOf(o)>=0)){if(n instanceof cc.AudioClip)MKLog.log("release audio:"+o),cc.audioEngine.uncache(n),cc.loader.release(n);else if(n instanceof cc.Prefab){MKLog.log("========================release persistenceres prefab========================:"+o),cc.loader.setAutoRelease(n,!0);var i=cc.loader.getDependsRecursively(n);MKLog.log("========================release persistenceres deps========================:"+i),cc.loader.release(i)}else if(n instanceof cc.SpriteAtlas){MKLog.log("=======================release persistenceres spriteatlas===================:"+o);i=cc.loader.getDependsRecursively(n);MKLog.log("=======================release persistenceres deps===================:"+i),cc.loader.release(i)}else cc.loader.release(n);delete this._resMap[o]}}this.persistentRes=[],e&&(this.persistentRes=e)},releaseAllAudioRes:function(){MKLog.log("========================releaseAllAudioRes ========================:"),MKLog.log("========================releaseAllAudioRes tempRes========================:",this.tempRes),MKLog.log("========================releaseAllAudioRes unitRes========================:",this.unitRes),MKLog.log("========================releaseAllAudioRes persistentRes========================:",this.persistentRes);for(var e=0;e<this.tempRes.length;e++){var t=this.tempRes[e];(o=this._resMap[t])instanceof cc.AudioClip&&(MKLog.log("release temp audio:"+t),cc.audioEngine.uncache(o),cc.loader.release(o),delete this._resMap[t])}for(e=0;e<this.unitRes.length;e++){t=this.unitRes[e];(o=this._resMap[t])instanceof cc.AudioClip&&(MKLog.log("release unit audio:"+t),cc.audioEngine.uncache(o),cc.loader.release(o),delete this._resMap[t])}for(e=0;e<this.persistentRes.length;e++){var o;t=this.persistentRes[e];(o=this._resMap[t])instanceof cc.AudioClip&&(MKLog.log("release persistence audio:"+t),cc.audioEngine.uncache(o),cc.loader.release(o),delete this._resMap[t])}},preloadRes:function(e,t,o){var n=this;cc.loader.loadResDir(e,t,null,function(t,i,a){if(t)return MKLog.log("preloadRes failed resurl="+e),void(o&&o());var s;for(s=0;s<i.length;s++)n._resMap[a[s]]=i[s];o&&o()})}};o.default=n,cc._RF.pop()},{}],TS_common:[function(e,t,o){"use strict";cc._RF.push(t,"0c1d196S6tKHYD0RgiAXZCr","TS_common"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./TS_NetCenter"),i=e("./TS_ResourceManager"),a={getStarNameFromUnitId:function(e){if(void 0!=$CommonData.gSData.serverData.units)for(var t=$CommonData.gSData.serverData.units,o=0;o<t.length;o++)if(t[o].id==e)return"star"+(o%5+1);return""},getPathFirstStep:function(e){if(!$CommonData.gSData.serverData.currentStep.paras)return MKLog.log($CommonData.gSData.serverData),"";var t=JSON.parse($CommonData.gSData.serverData.currentStep.paras),o=t.path,n="S"+e+"Res/prefab/"+o;if("\u4e60\u9898"==$CommonData.gSData.serverData.currentStep.steptype||"\u95ef\u5173\u9898"==$CommonData.gSData.serverData.currentStep.steptype){var i=o.lastIndexOf("/");n="public/exercise/"+t.path.substring(i+1)}return"\u8bfe\u524d\u590d\u4e60"==$CommonData.gSData.serverData.currentStep.stepname&&(n="public/review/"+t.path),"\u95ef\u5173\u9898\u5c01\u9762"==$CommonData.gSData.serverData.currentStep.stepname&&(n="public/breakthrough/breakthrough"),"\u5355\u5143\u6d4b\u8bd5"==$CommonData.gSData.serverData.currentStep.steptype&&(n="public/test/"+t.path),"\u8bfe\u524d\u89c6\u9891"==$CommonData.gSData.serverData.currentStep.steptype&&(n="public/test/beforePrefab"),"\u4e86\u89e3\u66f4\u591a"==$CommonData.gSData.serverData.currentStep.steptype&&(n="public/test/morePrefab"),"\u8bfe\u7a0b\u603b\u7ed3-\u5f55\u97f3"==$CommonData.gSData.serverData.currentStep.steptype&&(n="public/test/speakPrefab"),MKLog.log("prefabPath==="+n),n},getResnameByUnitId:function(e){MKLog.log($CommonData.gSData.serverData.units);var t=-1,o=0;for(MKLog.log("unitid:"+e),o=0;o<$CommonData.gSData.serverData.units.length;o++)e==$CommonData.gSData.serverData.units[o].id&&(t=$CommonData.gSData.serverData.units[o].resname);return t},loadResFirstStep:function(e,t,o){MKLog.log("loadResFirstStep");var n=this.getResnameByUnitId(e),a=this.getPathFirstStep(n);if(MKLog.log("loadResFirstStep:",a),""==a&&o)o();else{var s=!1,r=!1;"public/test/testPrefab"==a&&(r=!0),i.default.loadUnitRes(a,cc.Prefab,function(e,n){if(!e)return MKLog.log("ResourceManager.loadUnitRes:",a),MKLog.log("$CommonData.gCData.resFirstStep:",$CommonData.gCData.resFirstStep),cc.isValid($CommonData.gCData.resFirstStep)||($CommonData.gCData.resFirstStep=cc.instantiate(n),$CommonData.gCData.pathFirstStep=a),(s=!0)&&r&&t?(MKLog.log("prefabIsload callback"),void t()):void 0;o&&o()});$CommonData.gSData.serverData.currentUnitId;if(MKLog.log(r),!r){var c="S"+n+"Res/DataJson/S"+n+"DataJosn";MKLog.log("jsonRes:"+c),i.default.loadUnitRes(c,cc.JsonAsset,function(e,n){return e?(o&&o(),void MKLog.log("err:"+e)):(MKLog.log(n),MKLog.log(JSON.stringify(n)),$CommonData.gCData.gameJson=n.json,r=!0,s&&r&&t?(MKLog.log("loadJson callback"),void t()):void 0)})}}},getLayerNode:function(e){if(e&&$CommonData.gCData.layerNodePath&&""!=$CommonData.gCData.layerNodePath){var t=cc.find($CommonData.gCData.layerNodePath);if(t){var o=e.indexOf("/");return cc.find(e.substring(o+1),t)}}return cc.find(e)},net_send_stepData:function(e,t){var o=this,i=MKTime.getNowTime();$CommonData.gCData.nowStepsNum=$CommonData.gSData.serverData.stepSeq;var a=$CommonData.gCData.nowStepsNum;a<0&&(a=0);var s={beginTime:$CommonData.gCData.levelStarTime,endTime:i,lessonid:61,numOfTrials:e,result:t,score:1,stepName:"",stepid:$CommonData.gSData.serverData.currentStep.id,unitid:$CommonData.gSData.serverData.currentUnitId,userid:256,unitrecordid:$CommonData.gSData.serverData.currentUnitRecordId};MKLog.log("net_send_stepData stepData::::"),MKLog.log(JSON.stringify(s)),n.default.send_stepData(s,function(e){MKLog.log("-----------\u670d\u52a1\u5668\u4e0b\u884c-------------"),MKLog.log(e),e?(e=JSON.parse(e)).pintuData&&e.pintuData.pieceno>=0?(MKLog.log("-----------debris--------------"),o.nextStep_common(e.pintuData,"debris")):(MKLog.log("-----------result****1--------------",t),o.nextStep_common(t)):(MKLog.log("-----------result*****2--------------"),o.nextStep_common(t))})},nextStep_common:function(e,t){if("debris"==t){var o=cc.find("Canvas/UILayer");o&&o.getComponent("GameLayerLogic").showDebrisLayer(e)}else{MKLog.log("---------------------StepOver------------------------");var n=new cc.Event.EventCustom("StepOver",!1);n.setUserData({isSuccess:e});var i=cc.find("Canvas");i&&i.dispatchEvent(n),MKLog.log("send message to canvas!")}},ImageLoadRes:function(e,t){cc.loader.loadRes(t,cc.SpriteFrame,function(t,o){t?console.log("err:"+t):e.spriteFrame=o})},ImageLoadInWeb:function(e,t){cc.loader.load(t,function(t,o){t?console.log("err:"+t):e.spriteFrame=new cc.SpriteFrame(o)})},ImageLoadOutWeb:function(e,t){cc.loader.load({url:t,type:"png"},function(t,o){t?console.log("err:"+t):e.spriteFrame=new cc.SpriteFrame(o)})},openCustomerServiceConversation:function(){console.log("openCustomerServiceConversation")},getWechatSetting:function(e,t){console.log("getWechatSetting")},getWechatSetting_JC:function(e){console.log("getWechatSetting_JC")},getWechatUserInfo:function(e){console.log("getWechatUserInfo")}};o.default=a,cc._RF.pop()},{"./TS_NetCenter":"TS_NetCenter","./TS_ResourceManager":"TS_ResourceManager"}],TS_exerciseLineLayerLogic:[function(e,t,o){"use strict";cc._RF.push(t,"ec4d2hmGB5Ndrnjqj8FifDP","TS_exerciseLineLayerLogic"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../Common/TS_ResourceManager"),i=cc._decorator,a=i.ccclass,s=i.property,r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.colliderNode=null,t.graphicsNumArr=[],t.numArr=[],t.graphicsArr=[],t.graphicsNum=0,t.collierANum=0,t.collierBNum=0,t.collierA=0,t.collierB=0,t.starCollier="",t.ctx=null,t.isTouch=!1,t.ligatureA_Arr=[],t.ligatureB_Arr=[],t.ANodeIsAdd=!1,t.BNodeIsAdd=!1,t.clipCount=-1,t.clipIsPlaying=!1,t}return __extends(t,e),t.prototype.start=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.touchStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.touchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.touchEnd,this)},t.prototype.runStep=function(){var e=this,t=$CommonData.gSData.serverData.currentStep.paras,o=(t=JSON.parse(t)).showGameLayerIndex;this.node.getParent().getParent().getComponent("gameSceneLogic").setNowGameLayer(o,this.node,function(t){e.startGame(t)})},t.prototype.startGame=function(e){this.addChildNode(e)},t.prototype.initGameData=function(e){var t=e.plist_ligatureA_res.length+1;this.graphicsNumArr=[],this.numArr=this.getNumArr(t),this.graphicsArr=this.selfAddGraphics(t),this.graphicsNum=this.getGraphicsArrIndex(),this.collierANum=-1,this.collierBNum=-1,this.collierA=-1,this.collierB=-1,this.starCollier="",this.ctx=null},t.prototype.touchStart=function(e){var t=this;if($CommonData.gCData.ISCANTOUCH&&$CommonData.gCData.gameIsProceed){var o=e.touch.getLocation();o=this.node.getParent().convertToNodeSpaceAR(o),this.colliderNode.x=o.x,this.colliderNode.y=o.y,setTimeout(function(){t.collierANum=t.colliderNode.getComponent("TS_Collider_colliderLogic").collierANum,t.collierBNum=t.colliderNode.getComponent("TS_Collider_colliderLogic").collierBNum,t.collierA=t.collierANum,t.collierB=t.collierBNum,t.ctx=t.graphicsArr[t.graphicsNum],t.ctx&&(t.collierANum>=0?(t.isTouch=!0,t.starCollier="A",MKSound.playClickEffect()):t.collierBNum>=0&&(t.isTouch=!0,t.starCollier="B",MKSound.playClickEffect()))},50)}},t.prototype.touchMove=function(e){if($CommonData.gCData.ISCANTOUCH&&this.isTouch){var t=e.touch.getLocation();if(t=this.node.getParent().convertToNodeSpaceAR(t),this.colliderNode.x=t.x,this.colliderNode.y=t.y,this.ctx){this.ctx.getComponent(cc.Graphics).clear();var o=void 0;"A"==this.starCollier?o=this.ligatureA_Arr[this.collierA].getComponent("TS_Node_ligatureLogic").getNodeWorldPos():"B"==this.starCollier&&(o=this.ligatureB_Arr[this.collierB].getComponent("TS_Node_ligatureLogic").getNodeWorldPos()),this.ctx.getComponent(cc.Graphics).moveTo(o.x,o.y),this.ctx.getComponent(cc.Graphics).lineTo(t.x,t.y),this.ctx.getComponent(cc.Graphics).stroke()}}},t.prototype.touchEnd=function(e){if($CommonData.gCData.ISCANTOUCH&&this.isTouch){if(this.isTouch=!1,this.colliderNode.x=-1e3,this.colliderNode.y=-1e3,this.collierANum=this.colliderNode.getComponent("TS_Collider_colliderLogic").collierANum,this.collierBNum=this.colliderNode.getComponent("TS_Collider_colliderLogic").collierBNum,"A"==this.starCollier&&this.collierBNum>=0){this.setGraphicsArr(this.collierA,this.collierBNum),this.numArr[this.collierA]=[this.collierA,this.collierBNum,this.graphicsNum],this.graphicsNumArr[this.graphicsNum]=1;var t=this.ligatureA_Arr[this.collierA].getComponent("TS_Node_ligatureLogic").getNodeWorldPos(),o=this.ligatureB_Arr[this.collierBNum].getComponent("TS_Node_ligatureLogic").getNodeWorldPos();this.ctx.getComponent(cc.Graphics).clear(),this.ctx.getComponent(cc.Graphics).moveTo(t.x,t.y),this.ctx.getComponent(cc.Graphics).lineTo(o.x,o.y),this.ctx.getComponent(cc.Graphics).stroke()}else if("B"==this.starCollier&&this.collierANum>=0){this.setGraphicsArr(this.collierANum,this.collierB),this.numArr[this.collierANum]=[this.collierANum,this.collierB,this.graphicsNum],this.graphicsNumArr[this.graphicsNum]=1;t=this.ligatureA_Arr[this.collierANum].getComponent("TS_Node_ligatureLogic").getNodeWorldPos(),o=this.ligatureB_Arr[this.collierB].getComponent("TS_Node_ligatureLogic").getNodeWorldPos();this.ctx.getComponent(cc.Graphics).clear(),this.ctx.getComponent(cc.Graphics).moveTo(o.x,o.y),this.ctx.getComponent(cc.Graphics).lineTo(t.x,t.y),this.ctx.getComponent(cc.Graphics).stroke()}else this.ctx.getComponent(cc.Graphics).clear();this.starCollier="",this.ctx=null,this.collierA=-1,this.collierB=-1,this.graphicsNum=this.getGraphicsArrIndex()}},t.prototype.getNumArr=function(e){for(var t=[],o=0;o<e;o++)t.push([-1,-1,-1]);return t},t.prototype.setGraphicsArr=function(e,t){for(var o=this.numArr.length,n=0;n<o;n++)this.numArr[n][0]!=e&&this.numArr[n][1]!=t||(this.graphicsArr[this.numArr[n][2]].getComponent(cc.Graphics).clear(),this.graphicsNumArr[this.numArr[n][2]]=-1,this.numArr[n]=[-1,-1,-1])},t.prototype.selfAddGraphics=function(e){for(var t=[],o=0;o<e;o++){var n=new cc.Node;n.anchorX=0,n.anchorY=0;var i=n.addComponent(cc.Graphics);i.lineWidth=10,i.strokeColor=cc.color(255,215,137),i.lineCap=1,this.node.addChild(n),n.zIndex=5,t.push(n),this.graphicsNumArr.push(-1)}return t},t.prototype.getGraphicsArrIndex=function(){for(var e=this.graphicsNumArr.length,t=0;t<e;t++)if(-1==this.graphicsNumArr[t])return t},t.prototype.resullAllgraphicsNum=function(){for(var e=this.graphicsNumArr.length,t=0;t<e;t++)this.graphicsNumArr[t]=-1},t.prototype.clearAllGraphics=function(){if(this.graphicsArr&&0!=this.graphicsArr.length){for(var e=this.graphicsArr.length,t=0;t<e;t++)this.graphicsArr[t].getComponent(cc.Graphics).clear();var o=this.numArr.length;this.numArr=this.getNumArr(o),this.resullAllgraphicsNum(),this.graphicsNum=this.getGraphicsArrIndex()}},t.prototype.addLineGraphics=function(e,t,o){var n=e.getComponent("TS_Node_ligatureLogic").getNodeWorldPos(),i=t.getComponent("TS_Node_ligatureLogic").getNodeWorldPos();this.graphicsArr[o].getComponent(cc.Graphics).moveTo(n.x,n.y),this.graphicsArr[o].getComponent(cc.Graphics).lineTo(i.x,i.y),this.graphicsArr[o].getComponent(cc.Graphics).stroke()},t.prototype.resullLayer=function(){this.collierANum=-1,this.collierBNum=-1,this.collierA=-1,this.collierB=-1,this.starCollier="",this.ctx=null,this.graphicsNumArr=[],this.clearAllGraphics()},t.prototype.addChildNode=function(e){var t=this,o=e.plist;MKLog.info("exerciseLineLayerLogic addChildNode atlasRes:"+o),n.default.loadUnitRes(o,cc.SpriteAtlas,function(o,n){o?MKLog.info("err:"+o):(t.add_A_Node(e,n),t.add_B_Node(e,n),t.initGameData(e))})},t.prototype.add_A_Node=function(e,t){var o=this;this.ligatureA_Arr=[];var i=e.plist_ligatureA_res,a=i.length;n.default.loadPersistentRes("public/exercise/exercise_line",cc.Prefab,function(n,s){if(n)MKLog.info("err:"+n);else{o.ANodeIsAdd=!0,o.showRobot();for(var r=0;r<a;r++){var c=cc.instantiate(s);c.x=e.ligatureA_Pos[r][0],c.y=e.ligatureA_Pos[r][1],o.node.addChild(c),c.getComponent("TS_Node_ligatureLogic").ItemIndex=r,o.ligatureA_Arr.push(c),c.group="selectA","yellow"==e.ligatureA_Color?c.getChildByName("circleDi").color=cc.color(253,192,4):"blue"==e.ligatureA_Color&&(c.getChildByName("circleDi").color=cc.color(0,156,191)),c.getChildByName("starNode").y=-100,c.scaleX=e.NodeSize[0]/c.width,c.scaleY=e.NodeSize[1]/c.height;var l=c.getChildByName("showNode");l.getComponent(cc.Sprite).spriteFrame=t.getSpriteFrame(i[r]),e.AScaleArr?l.scale=e.AScaleArr[r]:e.A_isAllScale?l.scale=c.width/l.width:(l.width>200&&(l.scale=200/l.width),l.height>200&&(l.scale=200/l.height))}}})},t.prototype.add_B_Node=function(e,t){var o=this;this.ligatureB_Arr=[];var i=e.plist_ligatureB_res,a=i.length;n.default.loadPersistentRes("public/exercise/exercise_line",cc.Prefab,function(s,r){if(s)MKLog.info("err:"+s);else{o.BNodeIsAdd=!0,o.showRobot();for(var c=0;c<a;c++){var l=cc.instantiate(r);l.x=e.ligatureB_Pos[c][0],l.y=e.ligatureB_Pos[c][1],o.node.addChild(l),l.getComponent("TS_Node_ligatureLogic").ItemIndex=c,o.ligatureB_Arr.push(l),l.group="selectB","yellow"==e.ligatureA_Color?l.getChildByName("circleDi").color=cc.color(253,192,4):"blue"==e.ligatureA_Color&&(l.getChildByName("circleDi").color=cc.color(0,156,191)),l.getChildByName("starNode").y=100,l.scaleX=e.NodeSize[0]/l.width,l.scaleY=e.NodeSize[1]/l.height;var u=l.getChildByName("showNode");u.getComponent(cc.Sprite).spriteFrame=t.getSpriteFrame(i[c]),e.isMusicType&&(l.on(cc.Node.EventType.TOUCH_END,function(t){if(o.touchEnd(null),$CommonData.gCData.ISCANTOUCH||o.clipIsPlaying){MKSound.stopExeClip();var i=t.target.getComponent("TS_Node_ligatureLogic").ItemIndex,a=e.musicSite+i;n.default.loadTempRes(a,cc.AudioClip,function(e,t){e?MKLog.log("err:"+e):($CommonData.gCData.ISCANTOUCH=!1,o.clipIsPlaying=!0,o.clipCount>=0&&(cc.audioEngine.stopEffect(o.clipCount),o.clipCount=-1),o.clipCount=cc.audioEngine.playEffect(t,!1),cc.audioEngine.setFinishCallback(o.clipCount,function(){o.clipCount=-1,$CommonData.gCData.ISCANTOUCH=!0,o.clipIsPlaying=!1}))})}},o),l.on(cc.Node.EventType.TOUCH_CANCEL,function(e){o.touchEnd(null)},o)),e.BScaleArr?u.scale=e.BScaleArr[c]:e.B_isAllScale?u.scale=l.width/u.width*.98:(u.width>200&&(u.scale=200/u.width),u.height>200&&(u.scale=200/u.height))}}})},t.prototype.isMusicTouchEnd=function(e){},t.prototype.showRobot=function(){if(this.ANodeIsAdd&&this.BNodeIsAdd){if("exeScene"==$CommonData.gCData.nowSceneName)return;if("homeScene"==$CommonData.gCData.nowSceneName)return void this.node.getParent().getParent().getComponent("wrongExercisesLogic").playStarClip();this.node.getParent().getParent().getComponent("gameSceneLogic").showRobotAndconfirmButton(!0)}},t.prototype.cleraAllNode=function(){for(var e=0,t=this.ligatureA_Arr;e<t.length;e++){var o=t[e];o.destroy(),o=null}this.ligatureA_Arr=[];for(var n=0,i=this.ligatureB_Arr;n<i.length;n++){var a=i[n];a.destroy(),a=null}this.ligatureB_Arr=[],this.resullLayer()},t.prototype.onDestroy=function(){},__decorate([s(cc.Node)],t.prototype,"colliderNode",void 0),t=__decorate([a],t)}(cc.Component);o.default=r,cc._RF.pop()},{"../../Common/TS_ResourceManager":"TS_ResourceManager"}],TS_exerciseMoveKuangLogic:[function(e,t,o){"use strict";cc._RF.push(t,"e73376PjtBJR64RDNRute8O","TS_exerciseMoveKuangLogic"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../Common/TS_ResourceManager"),i=cc._decorator,a=i.ccclass,s=i.property,r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.movePrefab=null,t.moveCirclePrefab=null,t.moveNodeArr=[],t.showNodeArr=[],t}return __extends(t,e),t.prototype.start=function(){},t.prototype.runStep=function(){var e=this,t=$CommonData.gSData.serverData.currentStep.paras,o=(t=JSON.parse(t)).showGameLayerIndex;this.node.getParent().getParent().getComponent("gameSceneLogic").setNowGameLayer(o,this.node,function(t){e.startGame(t)})},t.prototype.startGame=function(e){this.addChildNode(e)},t.prototype.addChildNode=function(e){var t=this;this.moveNodeArr=[],this.showNodeArr=[];var o=0,i=e.plist;MKLog.info("exerciseMoveKuangLayerLogic addChildNode atlasRes:"+i),n.default.loadUnitRes(i,cc.SpriteAtlas,function(n,i){if(n)MKLog.info("err:"+n);else{var a=e.plist_res;MKLog.info("exerciseMoveKuangLayerLogic ResourceManager.loadUnitRes dataRes:"+a);for(var s=a.length,r=0;r<s;r++){var c=cc.instantiate(t.movePrefab);c.x=e.nodePos[r][0],c.y=e.nodePos[r][1],t.node.addChild(c),t.moveNodeArr.push(c);var l=c.getChildByName("showNode").getComponent("TS_Node_touchMoveLogic");if(e.resullArr[r]){l.isSuccceNode=!0,l.layerIndex=o;var u=e.showNodeScale;t.addShowNode(i,e.showNodePos[o],u,a[r]),o++}else l.isSuccceNode=!1,l.layerIndex=r;if(l.audioIndex=r,c.scaleX=e.NodeSize[0]/c.width,c.scaleY=e.NodeSize[1]/c.height,c.getChildByName("showNode").getComponent(cc.Sprite).spriteFrame=i.getSpriteFrame(a[r]),c.getChildByName("showNode_hui").getComponent(cc.Sprite).spriteFrame=i.getSpriteFrame(e.plist_res_hui[r]),c.getChildByName("showNode_hui").opacity=100,"exeScene"==$CommonData.gCData.nowSceneName)return;if("homeScene"==$CommonData.gCData.nowSceneName)return void t.node.getParent().getParent().getComponent("wrongExercisesLogic").playStarClip();t.node.getParent().getParent().getComponent("gameSceneLogic").showRobotAndconfirmButton(!0)}}})},t.prototype.addShowNode=function(e,t,o,n){var i=new cc.Node;this.node.getChildByName("showNodeLayer").addChild(i),i.addComponent(cc.Sprite).spriteFrame=e.getSpriteFrame(n),i.x=t[0],i.y=t[1],i.scale=o,i.active=!1,this.showNodeArr.push(i)},t.prototype.restartAllChildNode=function(){for(var e=0,t=this.moveNodeArr;e<t.length;e++){t[e].getChildByName("showNode").getComponent("TS_Node_touchMoveLogic").restartNode()}for(var o=0,n=this.showNodeArr;o<n.length;o++){n[o].active=!1}},t.prototype.cleraAllNode=function(){for(var e=0,t=this.moveNodeArr;e<t.length;e++){var o=t[e];o.destroy(),o=null}this.moveNodeArr=[];for(var n=0,i=this.showNodeArr;n<i.length;n++){var a=i[n];a.destroy(),a=null}this.showNodeArr=[]},t.prototype.onDestroy=function(){},__decorate([s(cc.Prefab)],t.prototype,"movePrefab",void 0),__decorate([s(cc.Prefab)],t.prototype,"moveCirclePrefab",void 0),t=__decorate([a],t)}(cc.Component);o.default=r,cc._RF.pop()},{"../../Common/TS_ResourceManager":"TS_ResourceManager"}],TS_exerciseMovetLayerLogic:[function(e,t,o){"use strict";cc._RF.push(t,"623f3USxBlFwY+fu9LzlKHE","TS_exerciseMovetLayerLogic"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../Common/TS_ResourceManager"),i=cc._decorator,a=i.ccclass,s=(i.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.moveNodeArr=[],t.showNodeArr=[],t}return __extends(t,e),t.prototype.start=function(){},t.prototype.runStep=function(){var e=this,t=$CommonData.gSData.serverData.currentStep.paras,o=(t=JSON.parse(t)).showGameLayerIndex;this.node.getParent().getParent().getComponent("gameSceneLogic").setNowGameLayer(o,this.node,function(t){e.startGame(t)})},t.prototype.startGame=function(e){e.isShowKuang&&this.addShowKuang(e.isBreakthrough,e.kuangSize),this.addChildNode(e)},t.prototype.addChildNode=function(e){var t=this;this.moveNodeArr=[],this.showNodeArr=[];var o=0,i=e.plist;MKLog.info("exerciseMoveLayerLogic addChildNode atlasRes:"+i),n.default.loadUnitRes(i,cc.SpriteAtlas,function(i,a){if(i)MKLog.info("err"+i);else{var s=e.plist_res;MKLog.info("exerciseMoveLayerLogic ResourceManager.loadUnitRes dataRes:"+s);var r=s.length,c="";c=e.isShowCirclePrefab?"public/exercise/exercise_move_circle":"public/exercise/exercise_move",n.default.loadPersistentRes(c,cc.Prefab,function(n,i){if(n)MKLog.info("err"+n);else{for(var c=0;c<r;c++){var l=cc.instantiate(i);l.x=e.nodePos[c][0],l.y=e.nodePos[c][1],l.zIndex=5,t.node.addChild(l),t.moveNodeArr.push(l);var u=l.getChildByName("showNode"),d=l.getChildByName("showNode_hui");l.zIndex=5;var h=u.getComponent("TS_Node_touchMoveLogic");if(e.resullArr[c]){h.isSuccceNode=!0,h.layerIndex=o;var g=e.showNodeScale;t.addShowNode(a,e.showNodePos[o],g,s[c]),o++}else h.isSuccceNode=!1,h.layerIndex=c;h.audioIndex=c,l.scaleX=e.NodeSize[0]/l.width,l.scaleY=e.NodeSize[1]/l.height,l.getChildByName("showNode").getComponent(cc.Sprite).spriteFrame=a.getSpriteFrame(s[c]),l.getChildByName("showNode_hui").getComponent(cc.Sprite).spriteFrame=a.getSpriteFrame(e.plist_res_hui[c]),l.getChildByName("showNode_hui").opacity=100,e.isAllScale&&(u.scale=.95*l.width/u.width,d.scale=.95*l.width/u.width)}"exeScene"!=$CommonData.gCData.nowSceneName&&("homeScene"!=$CommonData.gCData.nowSceneName?t.node.getParent().getParent().getComponent("gameSceneLogic").showRobotAndconfirmButton(!0):t.node.getParent().getParent().getComponent("wrongExercisesLogic").playStarClip())}})}})},t.prototype.addShowNode=function(e,t,o,n){var i=new cc.Node,a=this.node.getChildByName("showNodeLayer");a.addChild(i),i.addComponent(cc.Sprite).spriteFrame=e.getSpriteFrame(n),i.x=t[0],i.y=t[1],i.scale=o,i.active=!1,this.showNodeArr.push(i),a.zIndex=10},t.prototype.restartAllChildNode=function(){for(var e=0,t=this.moveNodeArr;e<t.length;e++){t[e].getChildByName("showNode").getComponent("TS_Node_touchMoveLogic").restartNode()}for(var o=0,n=this.showNodeArr;o<n.length;o++){n[o].active=!1}},t.prototype.addShowKuang=function(e,t){var o=this,i="";i=e?"public/exercise/selectKuang":"public/exercise/selectKuang2",n.default.loadPersistentRes(i,cc.Prefab,function(e,n){if(e)MKLog.info("err"+e);else{var i=cc.instantiate(n);i.x=0,i.y=-160,i.width=t[0],i.height=t[1],o.node.addChild(i)}})},t.prototype.cleraAllNode=function(){for(var e=0,t=this.moveNodeArr;e<t.length;e++){var o=t[e];o.destroy(),o=null}this.moveNodeArr=[];for(var n=0,i=this.showNodeArr;n<i.length;n++){var a=i[n];a.destroy(),a=null}this.showNodeArr=[]},t.prototype.onDestroy=function(){},t=__decorate([a],t)}(cc.Component));o.default=s,cc._RF.pop()},{"../../Common/TS_ResourceManager":"TS_ResourceManager"}],TS_exerciseSelectLayerLogic:[function(e,t,o){"use strict";cc._RF.push(t,"26e68M+l8BG1LJil5BcRV3W","TS_exerciseSelectLayerLogic"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../Common/TS_ResourceManager"),i=e("../../Common/MUtils/MKSound"),a=cc._decorator,s=a.ccclass,r=(a.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.selfSelectNodeArr=[],t.musicNodeArr=[],t}return __extends(t,e),t.prototype.start=function(){},t.prototype.runStep=function(){var e=this,t=$CommonData.gSData.serverData.currentStep.paras,o=(t=JSON.parse(t)).showGameLayerIndex;this.node.getParent().getParent().getComponent("gameSceneLogic").setNowGameLayer(o,this.node,function(t){e.startGame(t)})},t.prototype.startGame=function(e){this.addChildNode(e)},t.prototype.addChildNode=function(e){var t=this;this.selfSelectNodeArr=[];var o=e.plist;n.default.loadUnitRes(o,cc.SpriteAtlas,function(o,a){if(o)MKLog.info("err:"+o);else{var s=e.plist_res,r=s.length,c="";if(c=e.isShowCirclePrefab?"public/exercise/exercise_select_circle":"public/exercise/exercise_select",n.default.loadPersistentRes(c,cc.Prefab,function(o,n){if(o)MKLog.info("err:"+o);else{for(var i=0;i<r;i++){var c=cc.instantiate(n);c.x=e.nodePos[i][0],c.y=e.nodePos[i][1],t.node.addChild(c),t.selfSelectNodeArr.push(c),c.getChildByName("showNodeKuang").color=cc.color(253,192,4);var l=1;e.isSetScale||(l=1.1),e.NodeSize[0]>700?(c.width=e.NodeSize[0],c.height=e.NodeSize[1]):(c.scaleX=e.NodeSize[0]/c.width*l,c.scaleY=e.NodeSize[1]/c.height*l);var u=c.getChildByName("showNode");u.getComponent(cc.Sprite).spriteFrame=a.getSpriteFrame(s[i]),e.isAllScale?u.scale=.95*c.width/u.width:u.width>.85*c.width?u.scale=.85*c.width/u.width:u.height>.85*c.height&&(u.scale=.85*c.height/u.height)}"exeScene"!=$CommonData.gCData.nowSceneName&&("homeScene"!=$CommonData.gCData.nowSceneName?t.node.getParent().getParent().getComponent("gameSceneLogic").showRobotAndconfirmButton(!0):t.node.getParent().getParent().getComponent("wrongExercisesLogic").playStarClip())}}),e.isMusicType)for(var l=function(o){var n=new cc.Node;n.addComponent(cc.Sprite).spriteFrame=a.getSpriteFrame("musicImage"),t.node.addChild(n),n.x=e.musicNodePos[o][0],n.y=e.musicNodePos[o][1],n.scale=.66,n.on(cc.Node.EventType.TOUCH_START,function(t){if($CommonData.gCData.ISCANTOUCH){i.default.stopExeClip();var n=e.musicSite+o;$CommonData.gCData.ISCANTOUCH=!1,i.default.specialEffects(n,function(){$CommonData.gCData.ISCANTOUCH=!0})}},t),t.musicNodeArr.push(n)},u=0;u<r;u++)l(u)}})},t.prototype.restartAllChildNode=function(){for(var e=0,t=this.selfSelectNodeArr;e<t.length;e++){t[e].getComponent("TS_Node_selectNodeLogic").restartNode()}},t.prototype.resullLayer=function(){for(var e=0,t=this.selfSelectNodeArr;e<t.length;e++){var o=t[e].getComponent("TS_Node_selectNodeLogic");o.restartNode(),o.isTouch=!1,o.isSelect=!1}},t.prototype.cleraAllNode=function(){for(var e=0,t=this.selfSelectNodeArr;e<t.length;e++){var o=t[e];o.destroy(),o=null}this.selfSelectNodeArr=[];for(var n=0,i=this.musicNodeArr;n<i.length;n++){var a=i[n];a.destroy(),a=null}this.musicNodeArr=[]},t.prototype.onDestroy=function(){},t=__decorate([s],t)}(cc.Component));o.default=r,cc._RF.pop()},{"../../Common/MUtils/MKSound":"MKSound","../../Common/TS_ResourceManager":"TS_ResourceManager"}],TS_exerciseSelectMoveLayerLogic:[function(e,t,o){"use strict";cc._RF.push(t,"680941G0QxNMa4JIACzkzWx","TS_exerciseSelectMoveLayerLogic"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../Common/TS_ResourceManager"),i=cc._decorator,a=i.ccclass,s=(i.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.A_kuang_NodeArr=[],t.A_kuang=null,t.B_kuang_NodeArr=[],t.B_kuang=null,t.selectMoveNodeArr=[],t.ANodeIsAdd=!1,t.BNodeIsAdd=!1,t}return __extends(t,e),t.prototype.start=function(){},t.prototype.runStep=function(){var e=this,t=$CommonData.gSData.serverData.currentStep.paras,o=(t=JSON.parse(t)).showGameLayerIndex;this.node.getParent().getParent().getComponent("gameSceneLogic").setNowGameLayer(o,this.node,function(t){e.startGame(t)})},t.prototype.startGame=function(e){this.initData(e)},t.prototype.initData=function(e){var t=this,o=e.plist;MKLog.info("exerciseSelectMoveLayerLogic addChildNode atlasRes:"+o),n.default.loadUnitRes(o,cc.SpriteAtlas,function(o,n){o?MKLog.info("err:"+o):(t.init_A_kuang(e,n),t.init_B_kuang(e,n),t.init_seleceMoveNode(e,n))})},t.prototype.init_A_kuang=function(e,t){var o=this,i="";i=e.isBreakthrough?"public/exercise/selectKuang":"public/exercise/selectKuang2",n.default.loadPersistentRes(i,cc.Prefab,function(n,i){if(n)MKLog.info("err:"+n);else{o.ANodeIsAdd=!0,o.showRobot();var a=cc.instantiate(i);a.x=e.Kuang_A_Pos[0],a.y=e.Kuang_A_Pos[1],a.group="selectA",o.node.addChild(a),e.isShowShowNode&&(a.getChildByName("showNode").active=!0,e.kuangShowNodeScale&&(a.getChildByName("showNode").scale=e.kuangShowNodeScale)),o.A_kuang_NodeArr=[];var s=e.plist_Kuang_A_childRes;s&&(a.getChildByName("showNode").getComponent(cc.Sprite).spriteFrame=t.getSpriteFrame(s));for(var r=e.plist_Kuang_A_res,c=r.length,l=0;l<c;l++){var u=new cc.Node;a.addChild(u),u.addComponent(cc.Sprite).spriteFrame=t.getSpriteFrame(r[l]),u.x=e.Kuang_A_NodePos[l][0],u.y=e.Kuang_A_NodePos[l][1],o.A_kuang_NodeArr.push(u),e.nodeSamllScale&&(u.scale=.8*e.nodeSamllScale),u.active=!1}o.A_kuang=a}})},t.prototype.init_B_kuang=function(e,t){var o=this,i="";i=e.isBreakthrough?"public/exercise/selectKuang":"public/exercise/selectKuang2",n.default.loadPersistentRes(i,cc.Prefab,function(n,i){if(n)MKLog.info("err:"+n);else{o.BNodeIsAdd=!0,o.showRobot();var a=cc.instantiate(i);a.x=e.Kuang_B_Pos[0],a.y=e.Kuang_B_Pos[1],a.group="selectB",o.node.addChild(a),e.isShowShowNode&&(a.getChildByName("showNode").active=!0,e.kuangShowNodeScale&&(a.getChildByName("showNode").scale=e.kuangShowNodeScale)),o.B_kuang_NodeArr=[];var s=e.plist_Kuang_B_childRes;s&&(a.getChildByName("showNode").getComponent(cc.Sprite).spriteFrame=t.getSpriteFrame(s));for(var r=e.plist_Kuang_B_res,c=r.length,l=0;l<c;l++){var u=new cc.Node;a.addChild(u),u.addComponent(cc.Sprite).spriteFrame=t.getSpriteFrame(r[l]),u.x=e.Kuang_B_NodePos[l][0],u.y=e.Kuang_B_NodePos[l][1],e.nodeSamllScale&&(u.scale=.8*e.nodeSamllScale),u.active=!1,o.B_kuang_NodeArr.push(u)}o.B_kuang=a}})},t.prototype.showRobot=function(){if(this.ANodeIsAdd&&this.BNodeIsAdd){if("exeScene"==$CommonData.gCData.nowSceneName)return;if("homeScene"==$CommonData.gCData.nowSceneName)return void this.node.getParent().getParent().getComponent("wrongExercisesLogic").playStarClip();this.node.getParent().getParent().getComponent("gameSceneLogic").showRobotAndconfirmButton(!0)}},t.prototype.init_seleceMoveNode=function(e,t){var o=this;this.selectMoveNodeArr=[];var i=0,a=0,s=e.plist_res,r=s.length;n.default.loadPersistentRes("public/exercise/exercise_selectMove",cc.Prefab,function(n,c){if(n)MKLog.info("err:"+n);else for(var l=0;l<r;l++){var u=cc.instantiate(c);u.x=e.nodePos[l][0],u.y=e.nodePos[l][1],o.node.addChild(u),o.selectMoveNodeArr.push(u),u.zIndex=5;var d=u.getChildByName("showNode").getComponent("TS_Node_touchSelectMoveLogic");e.resullArr[l]?(d.targetGroup="selectB",d.layerIndex=i,i++):(d.targetGroup="selectA",d.layerIndex=a,a++),"yellow"==e.NodeColor&&(u.getChildByName("selectMoveDI").color=cc.color(253,192,4)),d.audioIndex=l;var h=u.getChildByName("showNode");h.getComponent(cc.Sprite).spriteFrame=t.getSpriteFrame(s[l]),u.scaleX=e.NodeSize[0]/u.width,u.scaleY=e.NodeSize[1]/u.height;var g=u.getChildByName("showNode_hui");g.opacity=100,g.getComponent(cc.Sprite).spriteFrame=t.getSpriteFrame(e.plist_res_hui[l]),e.isAllScale?(h.scaleX=u.width/h.width*.95,h.scaleY=u.height/h.height*.95,g.scaleX=u.width/h.width*.95,g.scaleY=u.height/h.height*.95):e.showNodeScale&&(h.scale=e.showNodeScale,g.scale=e.showNodeScale)}})},t.prototype.restartAllChildNode=function(){for(var e=0,t=this.A_kuang_NodeArr;e<t.length;e++){t[e].active=!1}for(var o=0,n=this.B_kuang_NodeArr;o<n.length;o++){n[o].active=!1}for(var i=0,a=this.selectMoveNodeArr;i<a.length;i++){a[i].getChildByName("showNode").getComponent("TS_Node_touchSelectMoveLogic").restartNode()}},t.prototype.cleraAllNode=function(){for(var e=0,t=this.selectMoveNodeArr;e<t.length;e++){var o=t[e];o.destroy(),o=null}this.selectMoveNodeArr=[],this.A_kuang.destroy(),this.A_kuang=null,this.B_kuang.destroy(),this.B_kuang=null},t.prototype.onDestroy=function(){},t=__decorate([a],t)}(cc.Component));o.default=s,cc._RF.pop()},{"../../Common/TS_ResourceManager":"TS_ResourceManager"}],TS_moveChangeLayer2Logic:[function(e,t,o){"use strict";cc._RF.push(t,"da7188v9cNCAouB7XZlOMBk","TS_moveChangeLayer2Logic"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../Common/TS_ResourceManager"),i=cc._decorator,a=i.ccclass,s=(i.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.selfmoveChangeNodeArr=[],t.KuangArr=[],t.arrowArr=[],t.sampleNode=null,t.showFirstNode=null,t.showFirstKuang=null,t}return __extends(t,e),t.prototype.start=function(){},t.prototype.runStep=function(){var e=this,t=$CommonData.gSData.serverData.currentStep.paras,o=(t=JSON.parse(t)).showGameLayerIndex;this.node.getParent().getParent().getComponent("gameSceneLogic").setNowGameLayer(o,this.node,function(t){e.startGame(t)})},t.prototype.startGame=function(e){this.addChildNode(e)},t.prototype.addChildNode=function(e){var t=this;this.selfmoveChangeNodeArr=[],this.KuangArr=[];var o=e.plist;MKLog.info("moveChangeLayer2Logic addChildNode atlasRes:"+o);var i=e.resullArr;n.default.loadUnitRes(o,cc.SpriteAtlas,function(o,a){if(o)MKLog.info("err:"+o);else{t.addArrowNode(e);var s=e.plist_res;MKLog.info("moveChangeLayer2Logic ResourceManager.loadUnitRes dataRes:"+s);var r=s.length;n.default.loadPersistentRes("public/exercise/moveChange2",cc.Prefab,function(o,n){if(o)MKLog.info("err:"+o);else{for(var i=0;i<r;i++){var c=cc.instantiate(n);c.x=e.nodePos[i][0],c.y=e.nodePos[i][1],t.node.addChild(c),t.selfmoveChangeNodeArr.push(c),c.getComponent("TS_Node_moveChange2Logic").seleIndex=i,c.getChildByName("showNodeKuang").color=cc.color(253,192,4),c.scaleX=e.NodeSize[0]/c.width,c.scaleY=e.NodeSize[1]/c.height;var l=c.getChildByName("showNode");l.getComponent(cc.Sprite).spriteFrame=a.getSpriteFrame(s[i]),l.width>.9*c.width&&(l.scale=.9*c.width/l.width),e.isAllScale?l.scale=.95*c.width/l.width:l.width>.85*c.width?l.scale=.85*c.width/l.width:l.height>.85*c.height&&(l.scale=.85*c.height/l.height)}e.isShowFirstKuang&&t.addFirstKuang(e,a,e.isShowFirstKuang,e.FirstKuangPos),e.isShowLastKuang&&t.addFirstKuang(e,a,e.isShowLastKuang,e.LastKuangPos),"exeScene"!=$CommonData.gCData.nowSceneName&&("homeScene"!=$CommonData.gCData.nowSceneName?t.node.getParent().getParent().getComponent("gameSceneLogic").showRobotAndconfirmButton(!0):t.node.getParent().getParent().getComponent("wrongExercisesLogic").playStarClip())}});n.default.loadPersistentRes("public/exercise/dottedKuang",cc.Prefab,function(o,n){if(o)MKLog.log("err:"+o);else for(var a=0;a<r;a++){var s=cc.instantiate(n);s.x=e.KuangPos[a][0],s.y=e.KuangPos[a][1],t.node.addChild(s);var c=e.NodeSize;e.smallKuangSize&&(c=e.smallKuangSize);var l=1;e.kuangScale&&(l=e.kuangScale),s.scaleX=c[0]/s.width*l,s.scaleY=c[1]/s.height*l,s.zIndex=5,s.getComponent("dottedKuangLogic").arrIndex=i[a],t.KuangArr.push(s)}})}})},t.prototype.addFirstKuang=function(e,t,o,i){var a=this;n.default.loadPersistentRes("public/exercise/moveChange2",cc.Prefab,function(s,r){if(s)MKLog.info("err:"+s);else{var c=cc.instantiate(r);c.x=i[0],c.y=i[1],console.log("pos:"+i[1]),a.node.addChild(c);var l=c.getChildByName("showNodeKuang");c.getComponent("TS_Node_moveChange2Logic").isCanMove=!1,l.color=cc.color(253,192,4);var u=e.NodeSize;e.smallKuangSize&&(u=e.smallKuangSize);var d=1;e.kuangScale&&(d=e.kuangScale),c.scaleX=u[0]/c.width*d,c.scaleY=u[1]/c.height*d;var h=c.getChildByName("showNode");h.getComponent(cc.Sprite).spriteFrame=t.getSpriteFrame(o),h.width>.9*c.width&&(h.scale=.9*c.width/h.width),e.isAllScale?h.scale=.95*c.width/h.width:h.width>.85*c.width?h.scale=.85*c.width/h.width:h.height>.85*c.height&&(h.scale=.85*c.height/h.height);n.default.loadPersistentRes("public/exercise/dottedKuang",cc.Prefab,function(t,o){if(t)MKLog.info("err:"+t);else{var n=cc.instantiate(o);n.x=e.FirstKuangPos[0],n.y=e.FirstKuangPos[1],a.node.addChild(n);var i=e.NodeSize;e.smallKuangSize&&(i=e.smallKuangSize),n.scaleX=i[0]/n.width*d,n.scaleY=i[1]/n.height*d,a.showFirstNode=c,a.showFirstKuang=n}})}})},t.prototype.addArrowNode=function(e){var t=this,o=e.arrowPos;this.arrowArr=[];for(var i=o.length,a=function(e){n.default.loadUnitRes("public/exercise/whiteArrow",cc.SpriteFrame,function(n,i){if(!n){var a=new cc.Node;a.addComponent(cc.Sprite).spriteFrame=i,a.x=o[e][0],a.y=o[e][1],a.scale=.7,t.node.addChild(a),t.arrowArr.push(a)}})},s=0;s<i;s++)a(s)},t.prototype.addsampleNode=function(e,t){var o=new cc.Node;o.addComponent(cc.Sprite).spriteFrame=t.getSpriteFrame(e.sampleRes),o.x=e.samplePos[0],o.y=e.samplePos[1],this.node.addChild(o),this.sampleNode=o},t.prototype.getIndexArr=function(){for(var e=[],t=0,o=this.selfmoveChangeNodeArr;t<o.length;t++){var n=o[t].getComponent("TS_Node_moveChange2Logic").seleIndex;e.push(n)}return e},t.prototype.setNoderesull=function(e){this.selfmoveChangeNodeArr[e].getComponent("TS_Node_moveChange2Logic").restartNode()},t.prototype.restartAllChildNode=function(){for(var e=0,t=this.selfmoveChangeNodeArr;e<t.length;e++){t[e].getComponent("TS_Node_moveChange2Logic").restartNode()}for(var o=0,n=this.KuangArr;o<n.length;o++){n[o].getComponent("dottedKuangLogic").arrIndex=-1}},t.prototype.resullLayer=function(){for(var e=0,t=this.selfmoveChangeNodeArr;e<t.length;e++){var o=t[e].getComponent("TS_Node_moveChange2Logic");o.restartNode(),o.isTouch=!1,o.isSelect=!1}this.sampleNode&&(this.sampleNode.destroy(),this.sampleNode=null)},t.prototype.cleraAllNode=function(){for(var e=0,t=this.selfmoveChangeNodeArr;e<t.length;e++){var o=t[e];o.destroy(),o=null}this.selfmoveChangeNodeArr=[],this.sampleNode&&(this.sampleNode.destroy(),this.sampleNode=null);for(var n=0,i=this.KuangArr;n<i.length;n++){var a=i[n];a.destroy(),a=null}for(var s=0,r=this.arrowArr;s<r.length;s++){var c=r[s];c.destroy(),c=null}this.showFirstNode&&(this.showFirstNode.destroy(),this.showFirstNode=null),this.showFirstKuang&&(this.showFirstKuang.destroy(),this.showFirstKuang=null)},t.prototype.onDestroy=function(){},t=__decorate([a],t)}(cc.Component));o.default=s,cc._RF.pop()},{"../../Common/TS_ResourceManager":"TS_ResourceManager"}],TS_moveChangeLayerLogic:[function(e,t,o){"use strict";cc._RF.push(t,"94b431/xltIGLOee7SEb64+","TS_moveChangeLayerLogic"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../Common/TS_ResourceManager"),i=cc._decorator,a=i.ccclass,s=(i.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.selfmoveChangeNodeArr=[],t.sampleNode=null,t}return __extends(t,e),t.prototype.start=function(){},t.prototype.runStep=function(){var e=this,t=$CommonData.gSData.serverData.currentStep.paras,o=(t=JSON.parse(t)).showGameLayerIndex;this.node.getParent().getParent().getComponent("gameSceneLogic").setNowGameLayer(o,this.node,function(t){e.startGame(t)})},t.prototype.startGame=function(e){this.addChildNode(e)},t.prototype.addChildNode=function(e){var t=this;this.selfmoveChangeNodeArr=[];var o=e.plist;MKLog.log("moveChangeLayerLogic addChildNode atlasRes:"+o),n.default.loadUnitRes(o,cc.SpriteAtlas,function(o,i){if(o)MKLog.log("err"+o);else{t.addsampleNode(e,i);var a=e.plist_res;MMKLog.log("moveChangeLayerLogic ResourceManager.loadUnitRes dataRes:"+a);var s=a.length;n.default.loadPersistentRes("public/exercise/moveChangePrefab",cc.Prefab,function(o,n){if(o)MKLog.log("err"+o);else{for(var r=0;r<s;r++){var c=cc.instantiate(n);c.x=e.nodePos[r][0],c.y=e.nodePos[r][1],t.node.addChild(c),t.selfmoveChangeNodeArr.push(c),c.getComponent("TS_Node_moveChangeLogic").seleIndex=r;var l=c.getChildByName("whileDi");"yellow"==e.NodeColor?l.color=cc.color(253,192,4):"blue"==e.NodeColor&&(l.color=cc.color(0,156,191)),c.scaleX=e.NodeSize[0]/c.width*.66,c.scaleY=e.NodeSize[1]/c.height*.66;var u=c.getChildByName("showNode");u.getComponent(cc.Sprite).spriteFrame=i.getSpriteFrame(a[r]),u.width>.9*c.width&&(u.scale=.9*c.width/u.width),e.isAllScale?u.scale=.95*c.width/u.width:u.width>.85*c.width?u.scale=.85*c.width/u.width:u.height>.85*c.height&&(u.scale=.85*c.height/u.height)}"exeScene"!=$CommonData.gCData.nowSceneName&&("homeScene"!=$CommonData.gCData.nowSceneName?t.node.getParent().getParent().getComponent("gameSceneLogic").showRobotAndconfirmButton(!0):t.node.getParent().getParent().getComponent("wrongExercisesLogic").playStarClip())}})}})},t.prototype.addsampleNode=function(e,t){var o=new cc.Node;o.addComponent(cc.Sprite).spriteFrame=t.getSpriteFrame(e.sampleRes),o.x=e.samplePos[0],o.y=e.samplePos[1],this.node.addChild(o),o.scale=.66,this.sampleNode=o},t.prototype.getIndexArr=function(){for(var e=[],t=0,o=this.selfmoveChangeNodeArr;t<o.length;t++){var n=o[t].getComponent("TS_Node_moveChangeLogic").seleIndex;e.push(n)}return e},t.prototype.restartAllChildNode=function(){for(var e=0,t=this.selfmoveChangeNodeArr;e<t.length;e++){t[e].getComponent("TS_Node_moveChangeLogic").restartNode()}},t.prototype.resullLayer=function(){for(var e=0,t=this.selfmoveChangeNodeArr;e<t.length;e++){var o=t[e].getComponent("TS_Node_moveChangeLogic");o.restartNode(),o.isTouch=!1,o.isSelect=!1}this.sampleNode&&(this.sampleNode.destroy(),this.sampleNode=null)},t.prototype.cleraAllNode=function(){for(var e=0,t=this.selfmoveChangeNodeArr;e<t.length;e++){var o=t[e];o.destroy(),o=null}this.selfmoveChangeNodeArr=[],this.sampleNode&&(this.sampleNode.destroy(),this.sampleNode=null)},t.prototype.onDestroy=function(){},t=__decorate([a],t)}(cc.Component));o.default=s,cc._RF.pop()},{"../../Common/TS_ResourceManager":"TS_ResourceManager"}],TS_password:[function(e,t,o){"use strict";cc._RF.push(t,"a621daKZrZNNbD06ENbPXKj","TS_password");var n={_password:null,_enterCallBack:null,_animSpeed:.3,_input_pwd:0,_save_pwd:0,_lb_pwd:null};cc.Class({extends:cc.Component,properties:{},statics:{show:function(e,t,o){var i=this;this.isFinish=!1,n._animSpeed=o||n._animSpeed,n._enterCallBack=t||null,cc.loader.loadRes("prefab/password",cc.Prefab,function(t,o){if(t)cc.error(t);else{var a=cc.instantiate(o);n._password=a,n._password.parent=e;var s=cc.callFunc(i.onFadeOutFinish,i),r=cc.callFunc(i.onFadeInFinish,i);i.actionFadeIn=cc.sequence(cc.spawn(cc.fadeTo(n._animSpeed,255),cc.scaleTo(n._animSpeed,1)),r),i.actionFadeOut=cc.sequence(cc.spawn(cc.fadeTo(n._animSpeed,0),cc.scaleTo(n._animSpeed,2)),s),n._lb_pwd=cc.find("lb_key/lb_pwd",a).getComponent(cc.Label),MKLog.log("prefab/password btn_closebtn_closebtn_close:"),cc.find("keyboard/btn_1",a).on("click",i.onButtonClicked,i),cc.find("keyboard/btn_2",a).on("click",i.onButtonClicked,i),cc.find("keyboard/btn_3",a).on("click",i.onButtonClicked,i),cc.find("keyboard/btn_4",a).on("click",i.onButtonClicked,i),cc.find("keyboard/btn_5",a).on("click",i.onButtonClicked,i),cc.find("keyboard/btn_6",a).on("click",i.onButtonClicked,i),cc.find("keyboard/btn_7",a).on("click",i.onButtonClicked,i),cc.find("keyboard/btn_8",a).on("click",i.onButtonClicked,i),cc.find("keyboard/btn_9",a).on("click",i.onButtonClicked,i),cc.find("keyboard/btn_9",a).on("click",i.onButtonClicked,i),cc.find("lb_key/lb_pwd",a).on("click",i.onButtonClicked,i),cc.find("btn_close",a).on("click",i.onButtonClicked,i),i.startFadeIn(),n._input_pwd=0,n._save_pwd=i.GetRandomNumOnly(),i.displayPwd(n._input_pwd,n._save_pwd)}}),i.startFadeIn=function(){n._password&&(n._password.position=cc.v2(0,0))},i.startFadeOut=function(){n._password&&i.onDestory()},i.onFadeInFinish=function(){},i.onFadeOutFinish=function(){i.onDestory()},i.onButtonClicked=function(e){MKLog.log("self.onButtonClicked:"),MKSound.playClickEffect();var t=0;if("btn_1"==e.target.name)t=1;else if("btn_2"==e.target.name)t=2;else if("btn_3"==e.target.name)t=3;else if("btn_4"==e.target.name)t=4;else if("btn_5"==e.target.name)t=5;else if("btn_6"==e.target.name)t=6;else if("btn_7"==e.target.name)t=7;else if("btn_8"==e.target.name)t=8;else if("btn_9"==e.target.name)t=9;else if("btn_close"==e.target.name)return void i.onFadeOutFinish();if(t>0&&t<=9){n._input_pwd=10*n._input_pwd+t;var o=cc.find("keyboard/btn_"+t,n._password);if(o.getComponent(cc.Button).interactable=!1,cc.find("pwd_key",o).active=!0,n._input_pwd>=100)if(n._input_pwd==n._save_pwd){for(var a=1;a<10;a++){cc.find("keyboard/btn_"+a,n._password).getComponent(cc.Button).interactable=!1}n._enterCallBack&&n._enterCallBack(),i.isFinish=!0,i.onFadeOutFinish()}else{n._input_pwd=0,n._save_pwd=i.GetRandomNumOnly();for(a=1;a<10;a++){var s=cc.find("keyboard/btn_"+a,n._password);s.getComponent(cc.Button).interactable=!0,cc.find("pwd_key",s).active=!1}}i.displayPwd(n._input_pwd,n._save_pwd)}},i.displayPwd=function(e,t){if(n._lb_pwd){var o=""+t;o=(o=(o=(o=(o=(o=(o=(o=(o=o.replace("1"," \u58f9")).replace("2"," \u8d30")).replace("3"," \u53c1")).replace("4"," \u8086")).replace("5"," \u4f0d")).replace("6"," \u9646")).replace("7"," \u67d2")).replace("8"," \u634c")).replace("9"," \u7396"),n._lb_pwd.string=o}},i.GetRandomNum=function(){var e=Math.random();return Math.round(9*e+.5)},i.GetRandomNumOnly=function(){for(var e=[],t=0,o=0;o<3;o++){for(var n=0;n=i.GetRandomNum(),!i.isOnly(e,n););e[o]=n,t=10*t+n}return t},i.isOnly=function(e,t){for(var o=0;o<e.length;o++)if(e[o]==t)return!1;return!0},i.onDestory=function(){$CommonData.gCData.isShowPassword=!1,MKLog.info("self.onDestory $CommonData.gCData.isShowPassword:",$CommonData.gCData.isShowPassword),i.isFinish=!1,n._enterCallBack=null,n._password&&n._password.destroy(),n._animSpeed=.3,n._input_pwd=0,n._save_pwd=0,n._lb_pwd=null,n._lb_pwd=null}}},start:function(){}}),cc._RF.pop()},{}],TS_puddingDrag:[function(e,t,o){"use strict";cc._RF.push(t,"669efU1wEZJbKoZP3mNF4rD","TS_puddingDrag"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,i=n.ccclass,a=(n.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.start=function(){this.puddingDrag=this.node.getComponent(dragonBones.ArmatureDisplay),MKEventDispatch.I.on("puddingDrag_shuohua",this.shuohua.bind(this),this.node),MKEventDispatch.I.on("puddingDrag_daiji",this.daiji.bind(this),this.node)},t.prototype.shuohua=function(){this.puddingDrag&&this.puddingDrag.playAnimation("shuohua",0)},t.prototype.daiji=function(){this.puddingDrag&&this.puddingDrag.playAnimation("daiji",0)},t=__decorate([i],t)}(cc.Component));o.default=a,cc._RF.pop()},{}],TS_robotDrag:[function(e,t,o){"use strict";cc._RF.push(t,"5fe47+xf2hLx7FrCAkPOtm/","TS_robotDrag"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../Common/MUtils/MKUtils"),i=cc._decorator,a=i.ccclass,s=(i.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.start=function(){this.robotDrag=this.node.getComponent(dragonBones.ArmatureDisplay),window.MKEventDispatch.I.on("robotDrag_saySerious",this.saySerious.bind(this),this.node),window.MKEventDispatch.I.on("robotDrag_sayHappy",this.sayHappy.bind(this),this.node),window.MKEventDispatch.I.on("robotDrag_thinking",this.thinking.bind(this),this.node),window.MKEventDispatch.I.on("robotDrag_normal",this.normal.bind(this),this.node),window.MKEventDispatch.I.on("robotDrag_happyRoll",this.happyRoll.bind(this),this.node),window.MKEventDispatch.I.on("robotDrag_fail",this.fail.bind(this),this.node),this.node.on(cc.Node.EventType.TOUCH_START,function(e){window.MKEventDispatch.I.emit("sayAgain")},this)},t.prototype.saySerious=function(){this.robotDrag.playAnimation("yansu",0),n.default.setDragonAnimation(this.node,"mouth","shuohua-bukaixin")},t.prototype.sayHappy=function(){n.default.setDragonAnimation(this.node,"mouth","shuohua")},t.prototype.thinking=function(){this.robotDrag.playAnimation("sikao",0),n.default.setDragonAnimation(this.node,"mouth","changtai"),n.default.setDragonAnimation(this.node,"eye","changtai-zhayan")},t.prototype.normal=function(){this.robotDrag.playAnimation("changtai",0),n.default.setDragonAnimation(this.node,"mouth","changtai"),n.default.setDragonAnimation(this.node,"eye","changtai-zhayan")},t.prototype.happyRoll=function(){this.robotDrag.playAnimation("tiaoqifangun",1)},t.prototype.fail=function(){this.robotDrag.playAnimation("baishou",1),n.default.setDragonAnimation(this.node,"eye","xulei")},t=__decorate([a],t)}(cc.Component));o.default=s,cc._RF.pop()},{"../Common/MUtils/MKUtils":"MKUtils"}],UnitRunner:[function(e,t,o){"use strict";cc._RF.push(t,"af191D4yu9MtKSprAQWHfVU","UnitRunner");var n=function(e){return e&&e.__esModule?e:{default:e}}(e("../pub/Common/TS_ResourceManager")),i=e("../pub/Common/MUtils/MKSystem");cc.Class({extends:cc.Component,properties:{stepCount:0},gotoStepById:function(e){for(var t=$CommonData.gSData.serverData.steps,o=-1,n=0;n<t.length;n++)t[n].id==e&&(o=n);if(o>-1){if(cc.audioEngine.stopAllEffects(),MKSound.playGameBGM(),o<0&&(o=0),o>=$CommonData.gSData.serverData.steps.length)return void console.log("gotoStepById \u8d8a\u754c:"+o);$CommonData.gSData.serverData.currentStep=$CommonData.gSData.serverData.steps[o],$CommonData.gSData.serverData.stepSeq=o,this.runStep()}else console.log("\u627e\u4e0d\u5230\u73af\u8282\uff1a"+e)},gotoStepBySeq:function(e){e<0&&(e=0),e>=$CommonData.gSData.serverData.steps.length?console.log("gotoStepBySeq \u8d8a\u754c:"+e):($CommonData.gSData.serverData.currentStep=$CommonData.gSData.serverData.steps[e],$CommonData.gSData.serverData.stepSeq=e,this.runStep())},runUnitFinishLayer:function(){console.log("runUnitFinishLayer"),$CommonData.gSData.serverData.currentStep=null},gotoNextStep:function(e){console.log("----------gotoNextStep---------------");var t=$CommonData.gSData.serverData.currentStep;this.getCurrentPart().partname.startsWith("\u6bcf\u8bfe\u4e00\u7ec3")&&0==e&&$CommonData.gSData.serverData.steps.push(t);var o=$CommonData.gSData.serverData.stepSeq+1;o>=$CommonData.gSData.serverData.steps.length?this.runUnitFinishLayer():this.gotoStepBySeq(o)},retryExercise:function(){this.restoreSteps(),this.gotoPartByName("\u6bcf\u8bfe\u4e00\u7ec3")},runStep:function(){var e=this;this.stepCount++;var t=$CommonData.gSData.serverData.currentStep;if(null!=t){console.log("----UnitRunner runStep()--------");var o=t.paras;console.log("paras:"),console.log(o),o=JSON.parse(o),$CommonData.gCData.parasPath=o.path,$CommonData.gSData.serverData.isTesting_moduleid=o.moduleid;var a=o.scriptName;if((0,i.isPlatWechatGame)())cc.find("UILayer",this.node).getComponent("GameLayerLogic").refreshComponents();$CommonData.gCData.levelStarTime=MKTime.getNowTime(),console.log("try to release tempres......."),n.default.releaseTempResExceptPrefab(),cc.find("UILayer/rotot",this.node).active=!1,cc.find("UILayer/handNode",this.node).active=!1,cc.find("UILayer/click",this.node).active=!1,cc.find("UILayer/confirmButton",this.node).active=!1,$CommonData.gCData.ISCANTOUCH=!0;var s="S61Res/prefab/"+o.path;if(console.log("prefab_path : "+s+"--------------------------------------stepinfo.stepname:"+t.stepname),"\u4e60\u9898"==t.steptype||"\u95ef\u5173\u9898"==t.steptype){var r=o.path.lastIndexOf("/");return s="public/exercise/"+o.path.substring(r+1),void this.gotoNextStep()}if("\u95ef\u5173\u9898\u5c01\u9762"==t.stepname)return s="public/breakthrough/breakthrough",void this.gotoNextStep();if("\u8bfe\u524d\u590d\u4e60"==t.stepname)return s="ReviewPrefab/"+o.path,void this.gotoNextStep();if("\u5355\u5143\u6d4b\u8bd5"==t.steptype)return s="TestPrefab/"+o.path,$CommonData.gSData.serverData.isTesting=!0,void this.gotoNextStep();if("\u8bfe\u524d\u89c6\u9891"==t.steptype)return s="TestPrefab/beforePrefab",void this.gotoNextStep();if("\u4e86\u89e3\u66f4\u591a"==t.steptype)return s="TestPrefab/morePrefab",void this.gotoNextStep();if("\u8bfe\u7a0b\u603b\u7ed3-\u5f55\u97f3"==t.steptype)return s="TestPrefab/speakPrefab",void this.gotoNextStep();console.log("prefab_path=="+s);var c=null;s==$CommonData.gCData.pathFirstStep?(console.log("\u76f4\u63a5\u8c03\u5f80\u4e0b\u4e00\u4e2a\u73af\u8282"),console.log("--pathFirstStep: ",$CommonData.gCData.pathFirstStep),c=$CommonData.gCData.resFirstStep,this.runStepNext(c,a),$CommonData.gCData.pathFirstStep=""):(console.log("\u52a0\u8f7d\u73af\u8282\u73af\u8282"),n.default.loadTempRes(s,cc.Prefab,function(t,o){if(t)return console.log("err:"+t),void e.gotoNextStep();console.log("DDDDDDDDDDDDDDDDDDDDDD"),c=cc.instantiate(o),e.runStepNext(c,a)}))}else console.log("\u6ca1\u6709\u6307\u5b9a\u8981\u6267\u884c\u7684\u73af\u8282\uff01")},runStepNext:function(e,t){console.log("--runStepNext--: ",e,t);var o=$CommonData.gSData.serverData.currentLayer;o&&(o.destroy(),o=null),e.active=!0,this.stageNode.addChild(e),$CommonData.gSData.serverData.currentLayer=e,console.log("scriptName:"+t);var i=e.getComponent(t);if(null==i)console.log("UnitRunner\u6ca1\u6709\u83b7\u53d6\u5230\u811a\u672c\u5f15\u7528\uff01");else{if(console.log("$CommonData.gSData.serverData.stepSeq:"+$CommonData.gSData.serverData.stepSeq+" $CommonData.gCData.isFirstOnScene:"+$CommonData.gCData.isFirstOnScene),$CommonData.gCData.isFirstOnScene&&$CommonData.gSData.serverData.stepSeq>0){n.default.loadPersistentRes("prefab/continueClassLayer",cc.Prefab,function(o,n){if(o)console.log("err:"+o);else{console.log("---------classLayerRes----------");var i=cc.instantiate(n);cc.find("Canvas").addChild(i);var a=i.getComponent("continueClassLayer");a.setLayerDate(e,t),a.runStep()}})}else i.myID=this.stepCount,$CommonData.gSData.serverData.currentStepCount=this.stepCount,i.runStep();$CommonData.gCData.isFirstOnScene=!1}$CommonData.gCData.debrisLayer&&($CommonData.gCData.debrisLayer.destroy(),$CommonData.gCData.debrisLayer=null)},Home_backCall:function(){$CommonData.gCData.layerNodePath=null,MKSound.stopVictoryAudio(),cc.director.preloadScene("execisesSelectScene",function(){cc.director.loadScene("execisesSelectScene")})},Home_return:function(){MKSound.playClickEffect(),$CommonData.gCData.layerNodePath&&($CommonData.gCData.layerNodePath=null),MKSound.stopVictoryAudio(),cc.audioEngine.stopAllEffects(),MKSound.playGameBGM(),this.node.destroy()},showStepLayer:function(){var e=cc.find("Canvas/stepChooser");e.getComponent("StepChooser").reloadData(),e.active=!0},showTestAudio:function(){console.log("\u6253\u5f00\u97f3\u9891\u754c\u9762")},gotoPart:function(e){for(var t=-1,o=$CommonData.gSData.serverData.part_steps,n=0;n<o.length;n++){var i=o[n];if(i[0]==e){t=i[1];break}}-1!=t?this.gotoStepById(t):console.log("\u627e\u4e0d\u5230\u5355\u5143\u5bf9\u5e94\u7684\u73af\u8282\uff0c\u6570\u636e\u6709\u95ee\u9898\uff01")},gotoPartByName:function(e){for(var t=-1,o=0;o<$CommonData.gSData.serverData.parts.length;o++){var n=$CommonData.gSData.serverData.parts[o];if(n.partname.startsWith(e)){t=n.id;break}}-1!=t?this.gotoPart(t):console.log("\u627e\u4e0d\u5230\u6a21\u5757\uff1a"+e)},start:function(){var e=this;this.node.on("StepOver",function(t){console.log("--------------StepOver-------------------");var o=t.getUserData(),n=1;if(o&&(n=o.isSuccess),1!=$CommonData.gSData.serverData.isReviewing)if(1!=$CommonData.gSData.serverData.isTesting)e.gotoNextStep(n);else{(a=new cc.Event.EventCustom("QuestionOver",!1)).setUserData({isSuccess:n});var i=$CommonData.gSData.serverData.testNode;i&&i.dispatchEvent(a)}else{var a;(a=new cc.Event.EventCustom("QuestionOver",!1)).setUserData({isSuccess:n});var s=$CommonData.gSData.serverData.reviewNode;s&&s.dispatchEvent(a)}},this),this.node.on("GotoStep",function(t){if(!$CommonData.gSData.serverData.isReviewing){var o=t.getUserData();o.stepid&&(console.log("GotoStep:"+o.stepid),e.gotoStepById(o.stepid))}},this),this.node.on("GotoPart",function(t){if(!$CommonData.gSData.serverData.isReviewing){var o=t.getUserData();o.partid&&e.gotoPart(o.partid)}},this),this.node.on("RetryExercise",function(){console.log("receive RetryExercise notify!"),e.retryExercise()},this),console.log("UnitRunner start in gameScene!"),this.stageNode=cc.find("Stage",this.node),(0,i.isPlatWechatGame)()&&(n.default.releaseAllAudioRes(),cc.audioEngine.uncacheAll(),console.log("call playGameBGM"))},getPartByName:function(e){for(var t=0;t<$CommonData.gSData.serverData.parts.length;t++){var o=$CommonData.gSData.serverData.parts[t];if(o.partname.startsWith(e)){o.id;break}}},backupSteps:function(){if(this.stepsBak=[],$CommonData.gSData.serverData.steps)for(var e=0;e<$CommonData.gSData.serverData.steps.length;e++)this.stepsBak.push($CommonData.gSData.serverData.steps[e])},restoreSteps:function(){$CommonData.gSData.serverData.steps=[];for(var e=0;e<this.stepsBak.length;e++)$CommonData.gSData.serverData.steps.push(this.stepsBak[e])},getCurrentPart:function(){var e=$CommonData.gSData.serverData.currentStep;if(null==e)return null;for(var t=-1,o=$CommonData.gSData.serverData.part_steps,n=0;n<o.length;n++){var i=o[n],a=i[0];if(i[1]==e.id){t=a;break}}if(-1!=t)for(var s=$CommonData.gSData.serverData.parts,r=0;r<s.length;r++){var c=s[r];if(c.id==t)return c}return null}}),cc._RF.pop()},{"../pub/Common/MUtils/MKSystem":"MKSystem","../pub/Common/TS_ResourceManager":"TS_ResourceManager"}],WXApi:[function(e,t,o){"use strict";cc._RF.push(t,"31079D6BQRIsL2uAYmR06Z/","WXApi"),Object.defineProperty(o,"__esModule",{value:!0}),o.getWindowWX=function(){return window.wx},o.sendWxRequest=function(e,t,o,n){window.wx.request({url:e,data:t,header:{"Content-Type":"application/x-www-form-urlencoded"},method:o,success:function(e){MKLog.log("\u53d1\u9001wx requests\u6210\u529f \u89e3\u6790res = "+JSON.stringify(e)),n()},fail:function(e){MKLog.log("\u53d1\u9001\u5931\u8d25")},complete:function(e){MKLog.log("\u53d1\u9001\u5b8c\u6210")}})},o.getWxLogin=function(e){window.wx.login({success:function(t){MKLog.log("\u83b7\u53d6\u767b\u9646\u51ed\u8bc1 getWxLogin = "+JSON.stringify(t)),e(t.code)}})},o.getWxUserInfo=function(e){window.wx.getUserInfo({success:function(t){MKLog.log("getUserInfo data = "+JSON.stringify(t)),MKLog.log("\u89e3\u5bc6\u540e data \u683c\u5f0f\u5316Json = "+JSON.stringify(t.userInfo)),e(t.userInfo)},fail:function(t){MKLog.log("[WxApi] \u83b7\u53d6\u4e2a\u4eba\u4fe1\u606f\u5931\u8d25"),e(-1)}})},o.checkSessionValid=function(e){window.wx.checkSession({success:function(){MKLog.log("\u9a8c\u8bc1 sesion\u6709\u6548"),e(!0)},fail:function(){MKLog.log("\u9a8c\u8bc1 sesion\u5df2\u8fc7\u671f"),e(!1)}})},o.getShowShareMenu=function(){return window.wx.showShareMenu()},o.getHideShareMenu=function(){return window.wx.hideShareMenu()},o.updateShareTicket=function(e){window.wx.updateShareMenu({withShareTicket:!1})},o.onShareApp=function(e,t){MKLog.log("[WxApi] onShareApp [\u76d1\u542c\u8f6c\u53d1\u53c2\u6570 ==== ]",t),window.wx.onShareAppMessage(function(){MKLog.log("\u7528\u6237\u70b9\u51fb\u4e86\u201c\u8f6c\u53d1\u201d\u6309\u94ae")})},o.sendShare=function(e,t,o,n){void 0===n&&(n=""),MKLog.log("[WxApi] sendShare \u7528\u6237\u53d1\u8d77\u4e86\u4e3b\u52a8\u8f6c\u53d1\u7684\u8bf7\u6c42"),cc.sys.isBrowser&&MKLog.log("\u6d4f\u89c8\u5668\u73af\u5883")},o.sendShareRedPack=function(e){MKLog.log("\u7528\u6237\u53d1\u8d77\u4e86\u4e3b\u52a8\u8f6c\u53d1\u7684\u8bf7\u6c42")},o.ListenUpdateRes=function(){if(isPlatWechatGame()&&"function"==typeof window.wx.getUpdateManager){var e=window.wx.getUpdateManager();e.onCheckForUpdate(function(e){MKLog.log("[wxApi] ListenWxUpdate \u76d1\u542c\u66f4\u65b0\u56de\u8c03 = ",e.hasUpdate)}),e.onUpdateReady(function(){e.applyUpdate()}),e.onUpdateFailed(function(){})}},o.WeChatPay=function(e,t,o,n,i){MKLog.log("[WeChatPay] extend =",o,"price =",t,", extend =",o),cc.sys.isBrowser?n&&n():isOsIOS()},o.getSavedFileList=function(){window.wx.getSavedFileList({success:function(e){MKLog.log("\u6d4b\u8bd5\u83b7\u53d6\u7f13\u5b58 =",e.fileList)}})},o.removeSavedFile=function(){window.wx.getSavedFileList({success:function(e){e.fileList.length>0&&window.wx.removeSavedFile({filePath:e.fileList[0].filePath,complete:function(e){MKLog.log(e)}})}})},o.getFileSystemManager=function(){return window.wx.getFileSystemManager()},o.exitMiniProgram=function(){window.wx.exitMiniProgram({success:function(e){},fail:function(e){},complete:function(e){}})},o.reportMonitor=function(e,t){window.wx.reportMonitor(e,t)},o.openCustomerServiceConversation=function(){window.wx.openCustomerServiceConversation({sessionFrom:"test01",showMessageCard:!1,sendMessageTitle:"111",sendMessagePath:"222",sendMessageImg:"",success:function(){MKLog.log("\u5ba2\u670d\u6d88\u606f\u8c03\u8d77\u6210\u529f === ok")},fail:function(e){MKLog.log("\u5ba2\u670d\u6d88\u606f\u8c03\u8d77\u5931\u8d25 === err")},complete:function(){MKLog.log("\u5ba2\u670d\u6d88\u606f\u8c03\u8d77\u5b8c\u6210 === com")}})},o.setKeepScreenOn=function(){window.wx.setKeepScreenOn({keepScreenOn:!0})},o.onNetworkStatusChange=function(){window.wx.onNetworkStatusChange(function(e){MKLog.log(e.isConnected),MKLog.log(e.networkType)})},o.offDeviceOrientationChange=function(){window.wx.offDeviceOrientationChange(function(){MKLog.log("\u5173\u95ed\u76d1\u542c\u6a2a\u7ad6\u5c4f")})},o.onDeviceOrientationChange=function(){window.wx.onDeviceOrientationChange(function(){MKLog.log("\u5f00\u542f\u76d1\u542c\u6a2a\u7ad6\u5c4f")})},o.onMemoryWarning=function(){window.wx.onMemoryWarning(function(){MKLog.log("onMemoryWarningReceive")})},o.triggerGC=function(){window.wx.triggerGC()},o.setEnableDebug=function(e){window.wx.setEnableDebug({enableDebug:e})},o.getSystemInfo=function(){window.wx.getSystemInfo({success:function(e){MKLog.log("[\u7cfb\u7edf\u4fe1\u606f] AppData =",e)}})},o.setPreferredFramesPerSecond=function(e){window.wx.setPreferredFramesPerSecond(e)},o.checkIsUserAdvisedToRest=function(e){window.wx.checkIsUserAdvisedToRest({todayPlayedTime:e,success:function(e){MKLog.log("[WXApi] \u9632\u6c89\u8ff7\u8fd4\u56de\u7ed3\u679c =",e.result)},fail:function(){},complete:function(){}})};var n=function(){function e(){}return e.getNetworkType=function(e){window.wx.getNetworkType({success:function(t){e(t)}})},e}();o.default=n,o.getEnterPathInfo=function(){},o.backGamePathInfo=function(){window.wx.onShow(function(e){e&&e.scene})},cc._RF.pop()},{}],bloodBarScript:[function(e,t,o){"use strict";cc._RF.push(t,"dc11371l/pJl7WMlF7pK5jb","bloodBarScript"),cc.Class({extends:cc.Component,properties:{},start:function(){},bloodCut:function(){cc.find("b1",this.node).active?cc.find("b1",this.node).active=!1:this.node.removeFromParent()}}),cc._RF.pop()},{}],breakthroughLogic:[function(e,t,o){"use strict";cc._RF.push(t,"90112I4sitAOLzAY4TnqmmW","breakthroughLogic");var n=a(e("../../Common/TS_common")),i=a(e("../../Common/MUtils/MKSound"));function a(e){return e&&e.__esModule?e:{default:e}}cc.Class({extends:cc.Component,properties:{},start:function(){},runStep:function(){$CommonData.gCData.THIS=this;i.default.playVoice("public/audio/chuangguan",function(){n.default.net_send_stepData(1,1)})}}),cc._RF.pop()},{"../../Common/MUtils/MKSound":"MKSound","../../Common/TS_common":"TS_common"}],classTestScript:[function(e,t,o){"use strict";cc._RF.push(t,"f1ceePdBVpKR4L8BivYA+ML","classTestScript");var n=r(e("../../Common/TS_common")),i=r(e("../../Common/TS_ResourceManager")),a=r(e("../../Common/TS_NetCenter")),s=r(e("../../Common/RootNode"));function r(e){return e&&e.__esModule?e:{default:e}}cc.Class({extends:cc.Component,properties:{progressLabel:{default:null,type:cc.Label},monsterArray:[cc.Prefab]},bInitStatus:!1,onLoad:function(){MKEventDispatch.I.on("loadReviewGame_over",this.runStep.bind(this),this.node)},start:function(){},init:function(){var e=this;MKLog.log("initinitinitinit==============="),$CommonData.gCData.ISCANTOUCH=!1,$CommonData.gCData.isTesting=!0,$CommonData.gCData.isUpdatingClass=!1,$CommonData.gCData.isTestingEND=!1,cc.find("Canvas/UILayer/progressBoom").active=!1,cc.find("Canvas/UILayer/nowPointButton").active=!1,this.daijiNameArray=["A2daiji","B2daiji","C2daiji","D2daiji"],this.fasheNameArray=["A3fashepaodan","B3fashepaodan","C3fashepaodan","D3fashepaodan"],this.shoujiNameArray=["A4zaoshougongjiA-B","B4zaoshougongjiB-C","C4zaoshougongjiC-D","D4zhuihui"],this.currentStatueIndex=0,this.bg_0=cc.find("bg_0",this.node),this.bg_1=cc.find("bg_1",this.node),this.bg_1.x=3370-cc.view.getVisibleSize().width/2,this.bg2_0=cc.find("bg2_0",this.node),this.bg2_1=cc.find("bg2_1",this.node),this.bg2_1.x=1915-cc.view.getVisibleSize().width/2,this.monsterNum=cc.find("monster/numLabel",this.node).getComponent(cc.Label),this.leftMonster=10,this.monsterNum.string=this.leftMonster+"/10",this.robotFly=cc.find("robotFlyNode",this.node),this.robotFly.active=!1,this.robotFly.x=-cc.view.getVisibleSize().width/4,this.paodan=cc.find("paodanNode",this.node),this.paodan.active=!1,this.monsterLayout=cc.find("monsterLayout",this.node),this.monsterItemIndex=-1,this.stageNode=cc.find("Canvas/Stage"),this.winLayout=cc.find("winNode",this.node),this.winLayout.active=!1,this.questionBg=cc.find("questionBg",this.node),this.questionBg.active=!1,$CommonData.gSData.serverData.testNode=this.node,this.currentNode=null,this.node.on("QuestionOver",function(t){MKLog.log("--------------QuestionOver-------------------"),cc.find("Canvas").getComponent("gameSceneLogic").showRobotAndconfirmButton(!1);var o=t.getUserData(),n=1;o&&(n=o.isSuccess),e.questionBg.active=!1,e.robot.active=!1,e.gotoNext(n)},this),this.confirmButton=cc.find("Canvas/UILayer/confirmButton").getComponent(cc.Widget),this.robot=cc.find("Canvas/UILayer/rotot"),this.robot.active=!1,this.startLayout=cc.find("startLayout",this.node),this.startLayout.active=!0,this.startBtn=cc.find("startLayout/startBtn",this.node),this.startBtn.active=!1},getModuleExamData:function(){var e=this;MKLog.log("getModuleExamDatagetModuleExamData::");var t={moduleid:$CommonData.gSData.serverData.isTesting_moduleid,userid:$CommonData.gCData.userId};a.default.httpGet("moduleExam",t,function(t){if(MKLog.log(t),e.questions=JSON.parse(t),e.jsonMap={},e.unitids=[],MKLog.log(e.questions),e.questions&&e.questions.length>0)for(var o=0;o<e.questions.length;o++){for(var n=e.questions[o],i=!1,a=0;a<e.unitids.length;a++)if(e.unitids[a]==n.unitid){i=!0;break}i||e.unitids.push(n.unitid)}MKLog.log("this.unitidsthis.unitidsthis.unitids1111::",JSON.stringify(e.unitids)),e.checkModuleExamRes()},function(){MKLog.log("\u53d6\u4e0d\u5230\u6d4b\u8bd5\u5355\u5143\u9898\u6570\u636e\uff01"),s.default.showTips("\u53d6\u4e0d\u5230\u6d4b\u8bd5\u5355\u5143\u9898\u6570\u636e\uff01")})},checkModuleExamRes:function(){if(MKLog.log("checkModuleExamRescheckModuleExamRes:",this.unitids),this.unitids==[])return this.yuan_ske=cc.find("startLayout/yuan_ske",this.node),this.yuan_ske.active=!1,this.startBtn=cc.find("startLayout/startBtn",this.node),this.startBtn.active=!0,void(this.progressLabel.node.active=!1);var e=this.unitids.shift();if(MKLog.log("\u5224\u65ad\u5b50\u8bfe\u662f\u5426\u4e0b\u8f7d\u8fc7 unitid:",e),MKLog.log("\u5224\u65ad\u5b50\u8bfe\u662f\u5426\u4e0b\u8f7d\u8fc7 JSON.stringify(this.unitids):",JSON.stringify(this.unitids)),e&&e>0){var t=UpdateHelper.isDownloaded(e);if(MKLog.log("\u5224\u65ad\u5b50\u8bfe\u662f\u5426\u4e0b\u8f7d\u8fc7:",t),!t){MKLog.log("\u8fd8\u672a\u4e0b\u8fc7,\u51c6\u5907\u4e0b\u8f7d\u524d\u4e00\u8bfe\u7684\u5b50\u8bfe\u8d44\u6e90",e);var o=this.node.getComponent("GameDownComponent");return void(o&&(MKLog.log("downCompdownCompdownCompdownComp gameType::",o.gameType),MKLog.log("downComp _checkIsGameDown()::",o._checkIsGameDown()),o.onUpdateCheckReview(e)))}if(!window["lesson_"+e])return MKLog.log("checkModuleExamRes \u5408\u5e76\u8d44\u6e90\u5904\u7406\uff1a\uff1a\uff1a\uff1b",e),void GameHelper.loadReviewGame(e);MKLog.log("checkModuleExamRes \u5df2\u7ecf\u5408\u5e76\u8fc7\u7684\u8d44\u6e90\u5904\u7406\uff1a\uff1a\uff1a",this.unitids),this.unitids==[]||void 0==this.unitids[0]||window["lesson_"+this.unitids[0]]?(this.yuan_ske=cc.find("startLayout/yuan_ske",this.node),this.yuan_ske.active=!1,this.startBtn=cc.find("startLayout/startBtn",this.node),this.startBtn.active=!0,this.progressLabel.node.active=!1):this.checkModuleExamRes()}},gotoNext:function(e){MKLog.log("==========gotoNext============"),this.currentNode&&(this.currentNode.active=!1,this.confirmButton.active=!1),$CommonData.gCData.debrisLayer&&($CommonData.gCData.debrisLayer.destroy(),$CommonData.gCData.debrisLayer=null);var t=this.questions.shift();e?(MKLog.log("success next"),this.animation_succ()):(MKLog.log("error next"),this.questions.push(t),this.animation_fail()),this.isMoving=!0},showQuestion:function(){var e=this;$CommonData.gCData.levelStarTime=MKTime.getNowTime();var t=this.questions[0];if(null!=t){this.questionBg.active=!0,this.robot.active=!0;var o="S"+t.unitid;$CommonData.gSData.serverData.testUnitId=t.unitid,MKLog.log("----load question--------");var n=t.paras,a=(n=JSON.parse(n)).scriptName;$CommonData.gCData.parasPath=n.path,$CommonData.gSData.serverData.currentStep=t;var s=n.path.lastIndexOf("/"),r="public/exercise/"+n.path.substring(s+1);MKLog.log("prefab_path=="+r);var c=null;i.default.loadTempRes(r,cc.Prefab,function(t,n){t?MKLog.log("\u52a0\u8f7d\u4e60\u9898prefab\u5931\u8d25\uff01"):(MKLog.log("sunitidsunitid:",o),$CommonData.gCData.gameJson=e.jsonMap[o],MKLog.log("$CommonData.gCData.gameJson::",$CommonData.gCData.gameJson),c=cc.instantiate(n),e.runStepNext(c,a))})}else MKLog.log("\u6ca1\u6709\u6307\u5b9a\u8981\u6267\u884c\u7684\u73af\u8282\uff01")},runStepNext:function(e,t){var o=this.currentNode;o&&(o.active=!1),e.scale=.85,e.active=!0,this.stageNode.addChild(e),e.getComponent(cc.Widget).bottom=50,this.currentNode=e,MKLog.log("scriptName:"+t);var n=e.getComponent(t);null==n?MKLog.log("\u6ca1\u6709\u83b7\u53d6\u5230\u811a\u672c\u5f15\u7528\uff01"):$CommonData.gCData.gameJson?n.runStep():s.default.showTips("\u83b7\u53d6\u5355\u5143\u6d4b\u8bd5\u9898\u6570\u636e\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5\uff01"),o&&(o.destroy(),o=null)},runStep:function(){var e=this;$CommonData.gCData.THIS=this,$CommonData.gCData.isUpdatingClass=!1,this.init();var t=new Array;t.push(function(){return new Promise(function(t,o){e.startLayout=cc.find("startLayout",e.node),e.startLayout.active=!0,MKSound.playVoice("public/test/audio/test_start",function(){t()})})}),t.push(function(){return new Promise(function(t,o){e.startBtn=cc.find("startLayout/startBtn",e.node),e.startBtn.active=!0,e.startBtn.once(cc.Node.EventType.TOUCH_START,function(){this.startLayout.active=!1,MKSound.playClickEffect(),this.runStep_start(),t()},e)})}),MKUtils.runPromiseArray(t)},runStep_start:function(){var e=this;this.addMonster(),this.animation_ruchang();var t=new Array;t.push(function(){return new Promise(function(e,t){MKSound.playVoice("public/test/audio/danyuan-2",function(){e()})})}),t.push(function(){return new Promise(function(t,o){var n={moduleid:$CommonData.gSData.serverData.isTesting_moduleid,userid:$CommonData.gCData.userId};a.default.httpGet("moduleExam",n,function(o){e.questions=JSON.parse(o),e.jsonMap={};var n=e.questions.length,a=0,s=0,r=function(){var t="S"+e.questions[a].unitid;if(null==e.jsonMap[t]){var o=t+"Res/DataJson/"+t+"DataJosn";i.default.loadUnitRes(o,cc.JsonAsset,function(i,a){i?console.log("\u6ca1\u6709\u53d6\u5230JSON\u6570\u636e\uff01"+t):(e.jsonMap[t]=a.json,console.log(o+"----loaded!"),++s==n&&(e.isReady=!0))})}else s++;s==n&&(e.isReady=!0)};for(a=0;a<n;a++)r();t()},o)})}),t.push(function(){return new Promise(function(t,o){e.animation_fashe(),t()})}),MKUtils.runPromiseArray(t)},monsterCut:function(){this.leftMonster--,this.monsterNum.string=this.leftMonster+"/10",this.leftMonster},addMonster:function(){MKLog.log("===========addMonster============");var e=1;-1==this.monsterItemIndex&&(e=3,this.monsterItemIndex=0),MKLog.log("index: ",this.monsterItemIndex+", len: ",e),MKLog.log("width: ",cc.view.getVisibleSize().width),this.leftMonster<3&&this.isSucc&&(e=0);for(var t=0;t<e;t++){var o=0,n=0;this.leftMonster<3&&(o=this.monsterLayout.childrenCount,n=this.monsterLayout.children[o-1].x);var i=cc.instantiate(this.monsterArray[this.monsterItemIndex%9]);i.scale=.8,i.parent=this.monsterLayout;var a=this.monsterItemIndex*(cc.view.getVisibleSize().width/4),s=this.monsterItemIndex%2==0?-50:50;this.leftMonster<3&&(a=n+cc.view.getVisibleSize().width/4),i.position=cc.v2(a,s),this.monsterItemIndex++}},animation_ruchang:function(){this.robotFly.active=!0,this.robotFly.children[0].getComponent(dragonBones.ArmatureDisplay).playAnimation("A1ruchang",1),this.robotFly.children[0].getComponent(dragonBones.ArmatureDisplay).addEventListener(dragonBones.EventObject.COMPLETE,function(){this.robotFly.children[0].getComponent(dragonBones.ArmatureDisplay).playAnimation("A2daiji")},this)},animation_win:function(){$CommonData.gCData.levelStarTime=this.init_LevelStarTime,$CommonData.gSData.serverData.currentStep.id=$CommonData.gSData.serverData.currentStepId,MKLog.log("currentStepId: ",$CommonData.gSData.serverData.currentStepId),this.winLayout.active=!0,this.robotFly.children[0].getComponent(dragonBones.ArmatureDisplay).playAnimation("Echenggong1",1),this.robotFly.children[0].getComponent(dragonBones.ArmatureDisplay).addEventListener(dragonBones.EventObject.COMPLETE,function(){this.robotFly.children[0].getComponent(dragonBones.ArmatureDisplay).playAnimation("Echenggong-daiji"),MKSound.playVoice("public/audio/win"),MKSound.playVoice("public/test/audio/winVoice",function(){$CommonData.gCData.isTestingEND=!0,n.default.net_send_stepData(1,1)});var e={unitid:$CommonData.gSData.serverData.currentUnitId,unitrecordid:$CommonData.gSData.serverData.currentUnitRecordId,userid:$CommonData.gCData.userId};a.default.httpPost("unitSummary",e,function(e){e=JSON.parse(e),MKLog.log("unitSummary: ",e)},function(){MKLog.log("\u6570\u636e\u52a0\u8f7d\u5931\u8d25")})},this),this.winLayout.children[1].active=!1,this.winLayout.children[0].getComponent(dragonBones.ArmatureDisplay).playAnimation("1chuxian",1),this.winLayout.children[0].getComponent(dragonBones.ArmatureDisplay).addEventListener(dragonBones.EventObject.COMPLETE,function(){this.winLayout.children[0].getComponent(dragonBones.ArmatureDisplay).playAnimation("2daiji"),this.winLayout.children[1].active=!0},this)},animation_fashe:function(){MKLog.log("fashe...."),this.leftMonster<=0?this.animation_win():(MKSound.playVoice("public/test/audio/shut"),this.robotFly.children[0].getComponent(dragonBones.ArmatureDisplay).removeEventListener(dragonBones.EventObject.COMPLETE),this.robotFly.children[0].getComponent(dragonBones.ArmatureDisplay).playAnimation(this.fasheNameArray[this.currentStatueIndex],1),this.robotFly.children[0].getComponent(dragonBones.ArmatureDisplay).addEventListener(dragonBones.EventObject.COMPLETE,function(){var e=this;this.paodan.active=!0;var t=new cc.moveBy(.5,cc.v2(200,0)),o=new cc.callFunc(function(){e.showQuestion()});this.paodan.runAction(new cc.sequence(t,o)),this.robotFly.children[0].getComponent(dragonBones.ArmatureDisplay).playAnimation(this.daijiNameArray[this.currentStatueIndex])},this))},animation_succ:function(){var e=this;MKLog.log("animation_succ....");var t=this.monsterItemIndex%2==0?-10:10,o=new cc.moveTo(.5,cc.v2(0,t)),n=new cc.callFunc(function(){e.paodan.active=!1,e.paodan.x=e.robotFly.x,e.paodan.y=e.robotFly.y-100,e.paodan.rotation=0,MKSound.playVoice("public/test/audio/jizhong"),e.monsterLayout.children[0].children[0].getComponent(dragonBones.ArmatureDisplay).removeEventListener(dragonBones.EventObject.COMPLETE),e.monsterLayout.children[0].children[0].getComponent(dragonBones.ArmatureDisplay).playAnimation("3zhuangji(zhuiluo)",1),e.monsterLayout.children[0].children[0].getComponent(dragonBones.ArmatureDisplay).addEventListener(dragonBones.EventObject.COMPLETE,function(){this.monsterLayout.children[0].removeFromParent(),this.monsterCut(),this.animation_move(!0)},e)});this.paodan.runAction(new cc.sequence(o,n))},animation_fail:function(){var e=this;MKLog.log("animation_fail fashe...."),this.paodan.getComponent(cc.Animation).play("paodan"),this.scheduleOnce(function(){e.paodan.active=!1,e.paodan.x=e.robotFly.x,e.paodan.y=e.robotFly.y-100,e.paodan.rotation=0,e.animation_move(!1)},1.5)},animation_move:function(e){var t=this;if(MKLog.log("move...."),this.leftMonster<=0)this.animation_win();else{var o=e?"public/test/audio/succ_":"public/test/audio/fail_";o=e?o+Math.ceil(4*Math.random()):o+Math.ceil(2*Math.random()),MKSound.playVoice(o,function(){t.animation_fashe()}),this.isSucc=e,this.addMonster();for(var n=0;n<this.monsterLayout.childrenCount;n++)this.monsterLayout.children[n].children[0].getComponent(dragonBones.ArmatureDisplay).playAnimation("2yidong");var i=new cc.moveBy(2,cc.v2(-cc.view.getVisibleSize().width/4+20,0)),a=new cc.callFunc(function(o){for(var n=0;n<t.monsterLayout.childrenCount;n++)t.monsterLayout.children[n].children[0].getComponent(dragonBones.ArmatureDisplay).playAnimation("1daiji(feixing)");e||(MKSound.playVoice("public/test/audio/baozha"),t.robotFly.children[0].getComponent(dragonBones.ArmatureDisplay).removeEventListener(dragonBones.EventObject.COMPLETE),t.robotFly.children[0].getComponent(dragonBones.ArmatureDisplay).playAnimation(t.shoujiNameArray[t.currentStatueIndex],1),t.robotFly.children[0].getComponent(dragonBones.ArmatureDisplay).addEventListener(dragonBones.EventObject.COMPLETE,function(){this.currentStatueIndex++,this.currentStatueIndex>3?(this.currentStatueIndex=0,this.robotFly.children[0].getComponent(dragonBones.ArmatureDisplay).removeEventListener(dragonBones.EventObject.COMPLETE),this.animation_ruchang()):this.robotFly.children[0].getComponent(dragonBones.ArmatureDisplay).playAnimation(this.daijiNameArray[this.currentStatueIndex])},t),t.monsterLayout.children[0].children[0].getComponent(dragonBones.ArmatureDisplay).removeEventListener(dragonBones.EventObject.COMPLETE),t.monsterLayout.children[0].children[0].getComponent(dragonBones.ArmatureDisplay).playAnimation("3zhuangji(zhuiluo)",1),t.monsterLayout.children[0].children[0].getComponent(dragonBones.ArmatureDisplay).addEventListener(dragonBones.EventObject.COMPLETE,function(){this.monsterLayout.children[0].removeFromParent()},t))});this.monsterLayout.runAction(new cc.sequence(i,a))}},home_btn:function(){MKSound.playClickEffect(),cc.director.preloadScene("execisesSelectScene",function(){cc.director.loadScene("execisesSelectScene")})},restart_btn:function(){MKSound.playClickEffect(),this.runStep()},update:function(e){this.bg_0.x-=1,this.bg_1.x-=1,this.bg2_0.x-=2,this.bg2_1.x-=2,this.bg_0.x<=-cc.view.getVisibleSize().width/2-3370&&(this.bg_0.x=3370-cc.view.getVisibleSize().width/2),this.bg_1.x<=-cc.view.getVisibleSize().width/2-3370&&(this.bg_1.x=3370-cc.view.getVisibleSize().width/2),this.bg2_0.x<=-cc.view.getVisibleSize().width/2-1915&&(this.bg2_0.x=1915-cc.view.getVisibleSize().width/2),this.bg2_1.x<=-cc.view.getVisibleSize().width/2-1915&&(this.bg2_1.x=1915-cc.view.getVisibleSize().width/2)},showDownloading:function(e,t){MKLog.log("showDownloading:::::::",e,t),e&&t&&(t>1&&(t=0),this.progressLabel.node.active=e,this.progressLabel.string=Math.floor(100*t)+"%")}}),cc._RF.pop()},{"../../Common/RootNode":"RootNode","../../Common/TS_NetCenter":"TS_NetCenter","../../Common/TS_ResourceManager":"TS_ResourceManager","../../Common/TS_common":"TS_common"}],continueClassLayer:[function(e,t,o){"use strict";cc._RF.push(t,"9ee75OYLnpCqZOcaGS72lOU","continueClassLayer"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../Common/TS_ResourceManager"),i=e("../../Common/MUtils/MKUtils"),a=cc._decorator,s=a.ccclass,r=(a.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.showNode=null,t.script="",t.CircleNode=null,t.audioCount=-1,t.NodeIsActive=!1,t.restartNode=null,t.coutinueNode=null,t}return __extends(t,e),t.prototype.start=function(){this.node.on(cc.Node.EventType.TOUCH_START,function(e){event.stopPropagation()},this),this.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){event.stopPropagation()},this),this.node.on(cc.Node.EventType.TOUCH_END,function(e){event.stopPropagation()},this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,function(e){event.stopPropagation()},this)},t.prototype.runStep=function(){var e=this;this.NodeIsActive=!0;var t=this.node.getChildByName("continueKuang");this.restartNode=t.getChildByName("restartClassButton"),this.coutinueNode=t.getChildByName("continueClassButton"),this.CircleNode=t.getChildByName("CircleNode");for(var o=[],a=function(t){var i="public/continue/xuanze_"+t;o.push(function(){return new Promise(function(o,a){n.default.loadUnitRes(i,cc.AudioClip,function(n,i){n?MKLog.log("err:"+n):e.NodeIsActive&&(e.audioCount=cc.audioEngine.playEffect(i,!1),cc.audioEngine.setFinishCallback(e.audioCount,function(){e.audioCount=-1,e.NodeIsActive&&(1==t?(e.CircleNode.active=!0,e.CircleNode.x=e.restartNode.x,e.CircleNode.y=e.restartNode.y):2==t?(e.CircleNode.x=e.coutinueNode.x,e.CircleNode.y=e.coutinueNode.y):3==t&&(e.CircleNode.active=!1),o())}))})})})},s=1;s<4;s++)a(s);i.default.runPromiseArray(o)},t.prototype.restart_callback=function(){this.stopAnimation(),$CommonData.gCData.levelStarTime=MKTime.getNowTime();var e=$CommonData.gSData.serverData.steps[0],t=new cc.Event.EventCustom("GotoStep",!1);t.setUserData({stepid:e.id}),cc.find("Canvas").dispatchEvent(t),this.node.active=!1},t.prototype.continue_callback=function(){this.nextGame()},t.prototype.closeLayer=function(){this.nextGame()},t.prototype.setLayerDate=function(e,t){this.showNode=e,this.script=t},t.prototype.nextGame=function(){this.stopAnimation(),$CommonData.gCData.levelStarTime=MKTime.getNowTime();var e=this.showNode.getComponent(this.script);e?e.runStep():MKLog.log("\u811a\u672c\u5462\uff1f\uff1f\uff1f"),this.node.active=!1},t.prototype.stopAnimation=function(){this.NodeIsActive=!1,this.audioCount>=0&&(cc.audioEngine.stopEffect(this.audioCount),this.audioCount=-1,this.CircleNode&&(this.CircleNode.active=!1))},t.prototype.onDestroy=function(){this.NodeIsActive=!1},t=__decorate([s],t)}(cc.Component));o.default=r,cc._RF.pop()},{"../../Common/MUtils/MKUtils":"MKUtils","../../Common/TS_ResourceManager":"TS_ResourceManager"}],debrisLayerLogic:[function(e,t,o){"use strict";cc._RF.push(t,"4ec9ez8LI1BbKUP1PqYxluj","debrisLayerLogic");var n=s(e("../../Common/TS_common")),i=s(e("../../Common/TS_ResourceManager")),a=s(e("../../Common/MUtils/MKUtils"));function s(e){return e&&e.__esModule?e:{default:e}}cc.Class({extends:cc.Component,properties:{showArr:{default:[],type:cc.Node},robot:{default:null,type:cc.Node},showNode:{default:null,type:cc.Node},pintuAudio:{default:null,type:cc.AudioClip},pintuAllAudio:{default:null,type:cc.AudioClip}},start:function(){this.node.on(cc.Node.EventType.TOUCH_START,this.touchStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.touchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.touchEnd,this),this.isCanTouch=!0,this.clipNum=-1},touchStart:function(e){$CommonData.gCData.ISCANTOUCH&&this.isCanTouch&&(e.stopPropagation(),console.log("????"),$CommonData.gCData.debrisLayer=this.node,$CommonData.gCData.ISCANTOUCH=!1,this.isCanTouch=!1,n.default.nextStep_common(1))},touchMove:function(e){e.stopPropagation()},touchEnd:function(e){e.stopPropagation()},setDebrisData:function(e){var t=this,o=e.pictureno;0==o&&(o=1);var n="deb"+o;$CommonData.gCData.ISCANTOUCH=!1;var i=e.piecetypearray;if(this.node.getChildByName("kuang").getChildByName("debDiKaung"+i[o-1]).active=!0,8==e.gotPieces.length){a.default.setDragonAnimation(this.robot,"mouth","shuohua");var s=cc.audioEngine.playEffect(this.pintuAllAudio,!1);cc.audioEngine.setFinishCallback(s,function(){$CommonData.gCData.ISCANTOUCH=!0,a.default.setDragonAnimation(t.robot,"mouth","changtai"),t.playAUdio()})}else{a.default.setDragonAnimation(this.robot,"mouth","shuohua");var r=cc.audioEngine.playEffect(this.pintuAudio,!1);cc.audioEngine.setFinishCallback(r,function(){$CommonData.gCData.ISCANTOUCH=!0,a.default.setDragonAnimation(t.robot,"mouth","changtai"),t.playAUdio()})}var c=e.gotPieces;if(c.length>0){var l=!0,u=!1,d=void 0;try{for(var h,g=c[Symbol.iterator]();!(l=(h=g.next()).done);l=!0){var p=h.value;this.addGotPieces(p,n)}}catch(e){u=!0,d=e}finally{try{!l&&g.return&&g.return()}finally{if(u)throw d}}}var m=e.pieceno,f=cc.v2(this.robot.x,this.robot.y),C=this.showArr[m-1],v=cc.v2(C.x,C.y);v=C.parent.convertToWorldSpaceAR(v),v=this.node.convertToNodeSpaceAR(v);var y=cc.v2(f.x,200),_="http://bonusimage.10fenkexue.com/image1/"+n+"/"+m+".png";console.log("sprLoad:"+_),cc.loader.load(_,function(e,o){if(!e){var n=new cc.Node;n.addComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(o);var i=[f,y,v],a=cc.bezierTo(1.3,i);n.x=f.x,n.y=f.y,n.parent=t.node;var s=new cc.scaleTo(.8,.86),r=new cc.scaleTo(.6,.57),c=new cc.sequence(s,r),l=new cc.spawn(a,c);n.runAction(l),n.zIndex=10}});var S="http://bonusimage.10fenkexue.com/image1/"+n+"/showImg.png";cc.loader.load(S,function(e,o){e?console.log("err:"+e):t.showNode.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(o)})},playAUdio:function(){var e=this;i.default.loadTempRes("public/audio/pintu2",cc.AudioClip,function(t,o){e.node&&e.node.active&&(e.clipNum=cc.audioEngine.playEffect(o,!1))})},addGotPieces:function(e,t){var o=this;console.log("\u62fc\u56fe\u788e\u7247\uff1a"+e);var n=this.showArr[e-1],i=cc.v2(n.x,n.y);i=n.parent.convertToWorldSpaceAR(i),i=this.node.convertToNodeSpaceAR(i);var a="http://bonusimage.10fenkexue.com/image1/"+t+"/"+e+".png";cc.loader.load(a,function(e,t){if(!e){var n=new cc.Node;n.addComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t),n.x=i.x,n.y=i.y,n.scale=.57,n.parent=o.node}})},onDestroy:function(){console.log("\u62fc\u56fe\u754c\u9762\u88ab\u5220\u9664"),this.clipNum>=0&&cc.audioEngine.stopEffect(this.clipNum)}}),cc._RF.pop()},{"../../Common/MUtils/MKUtils":"MKUtils","../../Common/TS_ResourceManager":"TS_ResourceManager","../../Common/TS_common":"TS_common"}],dottedKuangLogic:[function(e,t,o){"use strict";cc._RF.push(t,"84276rdCB9Esacqm3lquSb+","dottedKuangLogic"),cc.Class({extends:cc.Component,properties:{arrIndex:-1},start:function(){}}),cc._RF.pop()},{}],finishLogic:[function(e,t,o){"use strict";cc._RF.push(t,"7e5edZhBNJDyKRmyFBVqD1D","finishLogic");var n=a(e("../../../Script/pub/Common/MUtils/MKSound")),i=a(e("../../../Script/pub/Common/TS_common"));function a(e){return e&&e.__esModule?e:{default:e}}cc.Class({extends:cc.Component,properties:{},start:function(){},succFun:function(){n.default.playVoice("public/audio/win"),this.node.active=!0,this.node.children[1].active=!1,this.node.children[2].active=!0},failFun:function(){n.default.playVoice("public/audio/effect_fail"),this.node.active=!0,this.node.children[1].active=!0,this.node.children[2].active=!1},reStart:function(e){this.node.active=!1,$CommonData.gCData.THIS.reset(),$CommonData.gCData.IS_CANTOUCH=!0},finishGame:function(e){this.node.active=!1,i.default.net_send_stepData(1,1)}}),cc._RF.pop()},{"../../../Script/pub/Common/MUtils/MKSound":"MKSound","../../../Script/pub/Common/TS_common":"TS_common"}],gameSceneLogic:[function(e,t,o){"use strict";cc._RF.push(t,"352f99PFzhGP41NvS9jMxLG","gameSceneLogic"),Object.defineProperty(o,"__esModule",{value:!0}),e("GlobalGameData").init();var n=e("../pub/Common/TS_common"),i=e("../pub/Common/TS_ResourceManager"),a=e("../pub/Common/MUtils/MKSystem"),s=e("../pub/Common/TS_NetCenter"),r=cc._decorator,c=r.ccclass,l=r.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handNode=null,t.confirm=null,t.robot=null,t.data_JSON=null,t.scount=0,t.ecount=0,t.resultsDemonstration_isOver=!1,t.audio_isOver=!1,t.layerLogic="",t.nowGameLayer=null,t.currentUnitId="",t.nowUnitId=61,t.uiLayer=null,t.updateTime1=0,t}return __extends(t,e),t.prototype.onLoad=function(){console.log("==========gameScene onload======"),$CommonData.gCData.greenPointEnable=!0},t.prototype.start=function(){var e=this;this.schedule(function(){console.log("this.schedule")},0,0,10),console.log("==========gameScene start======"),this.uiLayer=this.node.getChildByName("UILayer"),this.handNode=n.default.getLayerNode("Canvas/UILayer/handNode"),this.confirm=n.default.getLayerNode("Canvas/UILayer/confirmButton"),this.robot=n.default.getLayerNode("Canvas/UILayer/rotot"),window.$CommonData.gCData.nowSceneName="gameScene",cc.loader.loadRes("S"+this.nowUnitId+"Res/DataJson/S"+this.nowUnitId+"DataJosn",cc.JsonAsset,function(t,o){t?console.log("err:"+t):(e.data_JSON=o.json,e.enterUnit())});var t=cc.director.getCollisionManager();if(t.enabled=!0,t.enabledDrawBoundingBox=!0,window.$CommonData.gCData.pudding=this.robot.getComponent(sp.Skeleton),this.scount=0,this.ecount=0,this.resultsDemonstration_isOver=!1,this.audio_isOver=!1,a.isPlatWechatGame()){var o=window.$CommonData.gSData.serverData;this.currentUnitId=""+o.currentUnitId}this.node.on("step_success",function(e){var t=this;console.log("step_success:::",this.scount),this.scount++;var o=this.data_JSON[this.layerLogic].resullNum;window.$CommonData.gSData.serverData;if(this.scount>=o){var n=!1,i=!1;window.$CommonData.gCData.gameIsProceed=!1,MKEventDispatch.I.emit("robotDrag_happyRoll");var a=!1;MKSound.playRandSuccessEffect(function(){if((n=!0)&&i){if(a)return;a=!0,t.nextPlayEndClip()}}),this.uiLayer.getComponent("GameLayerLogic").showStarPrefab(function(){if(console.log("ssssssssssssssssss"),i=!0,n&&i){if(a)return;a=!0,t.nextPlayEndClip()}}),setTimeout(function(){a||(a=!0,t.nextPlayEndClip())},5e3)}else MKSound.playSuccessEffect()},this),this.node.on("step_fail",function(e){var t=this;this.ecount++;window.$CommonData.gSData.serverData;window.$CommonData.gCData.ISCANTOUCH=!1,this.ecount>=window.$CommonData.gCData.MAXERRNUM?(window.$CommonData.gCData.gameIsProceed=!1,this.resultsDemonstration(function(){t.resultsDemonstration_isOver=!0,t.step_fail_nextLayer()})):MKSound.playEffectFail(function(){t.playErrClip(e)})},this),this.node.on("SingleChoice",function(t){e.select_confirBack()}),this.node.on("sayAgain",function(){e.nowGameLayer&&e.playStarClip()}),MKEventDispatch.I.on("sayAgain",function(){e.nowGameLayer&&$CommonData.gCData.ISCANTOUCH&&e.playStarClip()},this.node),this.node.on("closeLayerNode",function(){window.$CommonData.gCData.layerNodePath&&(MKSound.stopVictoryAudio(),window.$CommonData.gCData.layerNodePath=null),e.node.destroy()}),a.isPlatWechatGame()},t.prototype.nextPlayEndClip=function(){var e=this;this.playEndClip(function(){e.nextLayer(1)})},t.prototype.addStarprefab=function(){var e=this;i.default.loadUnitRes("public/uilayer/starNode",cc.Prefab,function(t,o){if(t)MKLog.info("err:"+t);else{var n=cc.instantiate(o);n.x=-2e3,n.y=-2e3,e.node.getChildByName("UILayer").addChild(n),n.active=!1,window.$CommonData.gCData.starPrefab=n}})},t.prototype.runStep=function(){},t.prototype.loadGameJson=function(){var e=this,t=-1;a.isPlatWechatGame()?t=window.$CommonData.gSData.serverData.currentUnitId:t=54;this.currentUnitId=t.toString();var o=n.default.getResnameByUnitId(this.currentUnitId),s="S"+o+"Res/DataJson/S"+o+"DataJosn";i.default.loadPersistentRes(s,cc.JsonAsset,function(t,o){t?MKLog.info("err:"+t):e.data_JSON=o.json})},t.prototype.showRobotAndconfirmButton=function(e){var t=window.$CommonData.gSData.serverData;if(e&&(t.isReviewing||t.isTesting)){var o=this.data_JSON[this.layerLogic].isShowConfirmButton;return this.confirm.active=!!o,void this.playStarClip()}if(e){var n=cc.view.getVisibleSize();this.robot.active=!0,this.robot.x=-n.width/2+150,this.robot.y=-n.height/2+120;o=this.data_JSON[this.layerLogic].isShowConfirmButton;this.confirm.active=!!o;var i=this.confirm.getComponent(cc.Widget);this.confirm.y=-n.height/2+150,i.bottom=100,this.playStarClip()}else this.robot.active=!1,this.confirm.active=!1},t.prototype.setNowGameLayer=function(e,t,o){console.log("setNowGameLayer::"),window.$CommonData.gCData.isAtMiniGame=!1,window.$CommonData.gCData.NOWEXERCISE=e,this.layerLogic="exercise_"+window.$CommonData.gCData.NOWEXERCISE,console.log(this.data_JSON);var n=this.data_JSON[this.layerLogic],i=this.data_JSON[this.layerLogic].SingleChoice;window.$CommonData.gCData.isSingleChoice=!!i,window.$CommonData.gSData.serverData.isReviewing&&(this.robot.active=!1),window.$CommonData.gCData.pudding=this.robot.getComponent(sp.Skeleton),this.scount=0,this.ecount=0,window.$CommonData.gCData.gameIsProceed=!0;var a=this.data_JSON[this.layerLogic].isBreakthrough;this.setShowBG(a),this.nowGameLayer=t,o&&o(n)},t.prototype.setShowBG=function(e){window.$CommonData.gSData.serverData.isReviewing||(e?(this.node.getChildByName("spacemanBG").active=!0,this.node.getChildByName("blackboardBG").active=!1):(this.node.getChildByName("spacemanBG").active=!1,this.node.getChildByName("blackboardBG").active=!0))},t.prototype.noSelectNodeCallBack=function(e){this.ecount++,window.$CommonData.gCData.ISCANTOUCH=!1,MKSound.playEffectFail(function(){window.$CommonData.gCData.ISCANTOUCH=!0,e&&e()})},t.prototype.confirmButton_callback=function(e){if(window.$CommonData.gCData.ISCANTOUCH&&window.$CommonData.gCData.gameIsProceed)switch(this.data_JSON[this.layerLogic].showLayer){case"exerciseSelectLayer":this.select_confirBack();break;case"exerciseLineLayer":this.ligature_confirBack();break;case"moveChangeLayer":this.moveChange_confirBack();break;case"moveChange2Layer":this.moveChange2_confirBack()}},t.prototype.select_confirBack=function(){for(var e=this.nowGameLayer.getComponent("TS_exerciseSelectLayerLogic").selfSelectNodeArr,t=this.data_JSON[this.layerLogic].resullArr,o=[],n=e.length,i=!0,a=!1,s=0;s<n;s++){var r=e[s].getComponent("TS_Node_selectNodeLogic").isSelect;r&&(a=!0),r!=t[s]&&(i=!1,t[s]||o.push(s))}a?i?this.node.dispatchEvent(new cc.Event.EventCustom("step_success",!0)):this.node.dispatchEvent(new cc.Event.EventCustom("step_fail",!0)):this.noSelectNodeCallBack()},t.prototype.ligature_confirBack=function(){for(var e=this,t=this.nowGameLayer.getComponent("TS_exerciseLineLayerLogic").numArr,o=this.data_JSON[this.layerLogic].resullArr,n=o.length,i=0;i<n;i++)if(-1==t[i][0]||-1==t[i][1])return void this.noSelectNodeCallBack(function(){var t=e.data_JSON[e.layerLogic].layerLogic;e.nowGameLayer.getComponent(""+t).clearAllGraphics()});for(i=0;i<n;i++)if(t[i][0]!=o[i][0]||t[i][1]!=o[i][1])return void this.node.dispatchEvent(new cc.Event.EventCustom("step_fail",!0));this.node.dispatchEvent(new cc.Event.EventCustom("step_success",!0))},t.prototype.moveChange_confirBack=function(){for(var e=this.nowGameLayer.getComponent("TS_moveChangeLayerLogic").selfmoveChangeNodeArr,t=this.data_JSON[this.layerLogic].resullArr,o=[],n=0,i=e;n<i.length;n++){var a=i[n].getComponent("TS_Node_moveChangeLogic").seleIndex;o.push(a)}for(var s=!1,r=0,c=t;r<c.length;r++){if(c[r].toString()==o.toString()){s=!0;break}}s?this.node.dispatchEvent(new cc.Event.EventCustom("step_success",!0)):this.node.dispatchEvent(new cc.Event.EventCustom("step_fail",!0))},t.prototype.moveChange2_confirBack=function(){for(var e=this.nowGameLayer.getComponent("TS_moveChangeLayer2Logic").KuangArr,t=[],o=e.length,n=0;n<o;n++){var i=e[n].getComponent("dottedKuangLogic");t.push(i.arrIndex)}var a=this.data_JSON[this.layerLogic].resullArr;t.toString()==a.toString()?this.node.dispatchEvent(new cc.Event.EventCustom("step_success",!0)):this.node.dispatchEvent(new cc.Event.EventCustom("step_fail",!0))},t.prototype.playStarClip=function(){console.log("playStarClip:::");var e=window.$CommonData.gSData.serverData.currentLayer;if(e&&"overLayer"==e.name)MKSound.playOverEffect();else if(e){var t=this.data_JSON[this.layerLogic].starClip;console.log("starClip:"+t),MKSound.playStarArrayClip(t,function(){window.$CommonData.gSData.serverData.laba&&window.$CommonData.gSData.serverData.laba.getComponent(dragonBones.ArmatureDisplay).playAnimation("\u9759\u6b62",0)})}},t.prototype.playEndClip=function(e){var t=this.data_JSON[this.layerLogic].endClip;t&&""!=t?MKSound.playStarArrayClip(t,function(){e&&e()}):e&&e()},t.prototype.playErrClip=function(e){var t=this,o=window.$CommonData.gSData.serverData;o.isReviewing?this.nowUnitId=o.reviewUnitId:o.isTesting&&(this.nowUnitId=o.testUnitId);var i=n.default.getResnameByUnitId(this.nowUnitId);console.log("resid:"+i+"---this.nowUnitId:"+this.nowUnitId);for(var a,s=this.data_JSON[this.layerLogic].errAudioisOne,r=this.data_JSON[this.layerLogic].resullArr,c=this.data_JSON[this.layerLogic].layerLogic,l=this.nowGameLayer.getComponent(""+c),u=this.data_JSON[this.layerLogic].noAllSelect,d=[],h=[],g=0,p=0,m=r;p<m.length;p++){m[p]&&g++}switch(console.log("logic:"+c),c){case"TS_exerciseSelectLayerLogic":for(var f=l.selfSelectNodeArr,C=0;C<f.length;C++){if(f[C].getComponent("TS_Node_selectNodeLogic").isSelect!=r[C])if(r[C])h.push(C);else{var v="S"+i+"Res/audio/exerciseAudio/"+window.$CommonData.gCData.NOWEXERCISE+"-e-"+C;d.push(v)}}a=function(){l.restartAllChildNode()};break;case"TS_exerciseLineLayerLogic":var y=l.numArr,_=y.length-1;for(C=0;C<_;C++)if(-1!=y[C][0]&&-1!=y[C][1]&&-1!=y[C][2]){if(y[C][0]==r[C][0]&&y[C][1]!=r[C][1]){v="S"+i+"Res/audio/exerciseAudio/"+window.$CommonData.gCData.NOWEXERCISE+"-e-"+C;d.push(v)}}else d=[];a=function(){l.clearAllGraphics()};break;case"TS_exerciseMovetLayerLogic":var S=e.target,D=S.getComponent("TS_Node_touchMoveLogic").layerIndex;v="S"+i+"Res/audio/exerciseAudio/"+window.$CommonData.gCData.NOWEXERCISE+"-e-"+D;d.push(v),a=function(){S.getComponent("TS_Node_touchMoveLogic").restartNode()};break;case"TS_exerciseSelectMoveLayerLogic":var b=e.target.getComponent("TS_Node_touchSelectMoveLogic").audioIndex;v="S"+i+"Res/audio/exerciseAudio/"+window.$CommonData.gCData.NOWEXERCISE+"-e-"+b;d.push(v),a=function(){};break;case"TS_moveChangeLayerLogic":case"TS_moveChangeLayer2Logic":b=e.target.getComponent("TS_Node_moveChange2Logic").seleIndex,v="S"+i+"Res/audio/exerciseAudio/"+window.$CommonData.gCData.NOWEXERCISE+"-e-"+b;d.push(v),a=function(){}}if(d.length>0)s&&(d=["S"+i+"Res/audio/exerciseAudio/"+window.$CommonData.gCData.NOWEXERCISE+"-e-0"]);else if(u||0!=h.length){var N=g-h.length;if(h.length>0)if(1!=N||u){if(u)for(var w=0,A=h;w<A.length;w++){var v=""+u+A[w];d.push(v)}else if(0==d.length){v="audio/public/noAll/noAll-"+Math.floor(3*Math.random());d.push(v)}else if(s){d=["S"+i+"Res/audio/exerciseAudio/"+window.$CommonData.gCData.NOWEXERCISE+"-e-0"]}}else d=["audio/public/noAll/noAll_selectOne"];else d=[v="audio/public/noAllSelect"]}else{d=["S"+i+"Res/audio/exerciseAudio/"+window.$CommonData.gCData.NOWEXERCISE+"-e-0"]}console.log(d),console.log(o),MKSound.playStarArrayClip(d,function(){o.isReviewing||o.isTesting?t.nextLayer(0):a()})},t.prototype.step_fail_nextLayer=function(){this.resultsDemonstration_isOver&&this.audio_isOver&&this.nextLayer(0)},t.prototype.nextLayer=function(e){this.resultsDemonstration_isOver=!1,this.audio_isOver=!1,this.nowGameLayer=null;$CommonData.gSData.serverData;var t=1+this.ecount;n.default.net_send_stepData(t,e)},t.prototype.resultsDemonstration=function(e){var t=this,o=this.data_JSON[this.layerLogic].layerLogic;this.playEndClip(function(){t.audio_isOver=!0,t.step_fail_nextLayer()});var n=window.$CommonData.gSData.serverData;if(n.isTesting||n.isReviewing)this.nextLayer(0);else switch(o){case"TS_exerciseSelectLayerLogic":this.exercise_resultsDemonstration(o,e);break;case"TS_exerciseLineLayerLogic":this.ligature_resultsDemonstration(o,e);break;case"TS_exerciseMovetLayerLogic":this.touchMove_resultsDemonstration(o,e);break;case"TS_exerciseSelectMoveLayerLogic":this.touchSelectMove_resultsDemonstration(o,e);break;case"TS_moveChangeLayerLogic":this.moveChange_resultsDemonstration(o,e);break;case"TS_moveChangeLayer2Logic":this.moveChange2_resultsDemonstration(o,e)}},t.prototype.exercise_resultsDemonstration=function(e,t){this.handNode.active=!0;var o=cc.v2(this.handNode.x,this.handNode.y),n=this.nowGameLayer.getComponent(""+e);n.restartAllChildNode();var i=n.selfSelectNodeArr,a=this.data_JSON[this.layerLogic].resullArr,s=cc.delayTime(.5),r=[];r.push(s);for(var c=0;c<a.length;c++)if(a[c]){var l=this.exercise_action(i[c]);r=r.concat(l)}if(!window.$CommonData.gCData.isSingleChoice){var u=this.exercise_action(this.confirm);r=r.concat(u)}var d=cc.callFunc(function(e){e.x=o.x,e.y=o.y,e.active=!1,t()});r.push(d),this.handNode.runAction(cc.sequence(r))},t.prototype.exercise_action=function(e){var t=cc.callFunc(function(e){e.getComponent("handLogic").normal()}),o=(cc.callFunc(function(e){e.getComponent("handLogic").touchDown()}),cc.callFunc(function(e){e.getComponent("handLogic").click()})),n=cc.moveTo(1,cc.v2(e.x,e.y)),i=cc.delayTime(window.$CommonData.gCData.deTimeNum);return[t,n,o,cc.callFunc(function(){var t=e.getComponent("TS_Node_selectNodeLogic");t&&t.selfSelect()}),i,t]},t.prototype.ligature_resultsDemonstration=function(e,t){this.handNode.active=!0;var o=cc.v2(this.handNode.x,this.handNode.y),n=this.nowGameLayer.getComponent(""+e);n.clearAllGraphics();var i=n.ligatureA_Arr,a=n.ligatureB_Arr,s=this.data_JSON[this.layerLogic].resullArr,r=cc.delayTime(.5),c=[];c.push(r);for(var l=0,u=0,d=s;u<d.length;u++){var h=d[u],g=this.ligature_action(i[h[0]],a[h[1]],l);c=c.concat(g),l++}var p=this.exercise_action(this.confirm);c=c.concat(p);var m=cc.callFunc(function(e){e.x=o.x,e.y=o.y,e.active=!1,t()});c.push(m),this.handNode.runAction(cc.sequence(c))},t.prototype.ligature_action=function(e,t,o){var n=this,i=cc.callFunc(function(e){e.getComponent("handLogic").normal()}),a=cc.callFunc(function(e){e.getComponent("handLogic").touchDown()}),s=(cc.callFunc(function(e){e.getComponent("handLogic").click()}),cc.moveTo(1,cc.v2(e.x,e.y))),r=cc.moveTo(1,cc.v2(t.x,t.y)),c=cc.delayTime(window.$CommonData.gCData.deTimeNum);return[s,a,c,r,i,cc.callFunc(function(){n.nowGameLayer.getComponent("TS_exerciseLineLayerLogic").addLineGraphics(e,t,o)}),c]},t.prototype.touchMove_resultsDemonstration=function(e,t){this.handNode.active=!0;var o=cc.v2(this.handNode.x,this.handNode.y),n=this.nowGameLayer.getComponent(""+e);n.restartAllChildNode();var i=n.moveNodeArr,a=this.nowGameLayer.getChildByName("showNodeLayer"),s=this.data_JSON[this.layerLogic].resullArr,r=cc.delayTime(.5),c=[];c.push(r);for(var l=0;l<s.length;l++)if(s[l]){var u=this.touchMove_action(i[l],a);c=c.concat(u)}var d=cc.callFunc(function(e){e.x=o.x,e.y=o.y,e.active=!1,t()});c.push(d),this.handNode.runAction(cc.sequence(c))},t.prototype.touchMove_action=function(e,t){var o=cc.callFunc(function(e){e.getComponent("handLogic").normal()}),n=cc.callFunc(function(e){e.getComponent("handLogic").touchDown()}),i=(cc.callFunc(function(e){e.getComponent("handLogic").click()}),cc.moveTo(1,cc.v2(e.x,e.y))),a=cc.moveTo(1,cc.v2(t.x,t.y)),s=cc.delayTime($CommonData.gCData.deTimeNum);return[i,n,s,cc.callFunc(function(){var o=cc.v2(t.x,t.y);e.getChildByName("showNode").getComponent("TS_Node_touchMoveLogic").moveSelfPos(o)}),a,o,s]},t.prototype.touchSelectMove_resultsDemonstration=function(e,t){this.handNode.active=!0;var o=cc.v2(this.handNode.x,this.handNode.y),n=this.nowGameLayer.getComponent(""+e);n.restartAllChildNode();var i=n.selectMoveNodeArr,a=n.A_kuang,s=n.B_kuang,r=this.data_JSON[this.layerLogic].resullArr,c=cc.delayTime(.5),l=[];l.push(c);for(var u=0;u<r.length;u++){var d=null;d=r[u]?s:a;var h=this.selectMove_action(i[u],d);l=l.concat(h)}var g=cc.callFunc(function(e){e.x=o.x,e.y=o.y,e.active=!1,t()});l.push(g),this.handNode.runAction(cc.sequence(l))},t.prototype.selectMove_action=function(e,t){var o=cc.callFunc(function(e){e.getComponent("handLogic").normal()}),n=cc.callFunc(function(e){e.getComponent("handLogic").touchDown()}),i=(cc.callFunc(function(e){e.getComponent("handLogic").click()}),cc.moveTo(1,cc.v2(e.x,e.y))),a=cc.moveTo(1,cc.v2(t.x,t.y)),s=cc.delayTime(window.$CommonData.gCData.deTimeNum);return[i,n,s,cc.callFunc(function(){var o=cc.v2(t.x,t.y);e.getChildByName("showNode").getComponent("TS_Node_touchSelectMoveLogic").moveSelfPos(o)}),a,o,s]},t.prototype.moveChange_resultsDemonstration=function(e,t){this.handNode.active=!0;var o=cc.v2(this.handNode.x,this.handNode.y),i=this.nowGameLayer.getComponent(""+e);i.restartAllChildNode();var a=i.selfmoveChangeNodeArr,s=this.data_JSON[this.layerLogic].resullArr[0],r=i.getIndexArr(),c=n.default.changeNumberSort(s,r),l=cc.delayTime(.5),u=[];u.push(l);for(var d=0;d<c.length;d++){var h=this.MoveChange_action(a[c[d][0]],a[c[d][1]]);u=u.concat(h)}var g=this.exercise_action(this.confirm);u=u.concat(g);var p=cc.callFunc(function(e){e.x=o.x,e.y=o.y,e.active=!1,t()});u.push(p),this.handNode.runAction(cc.sequence(u))},t.prototype.MoveChange_action=function(e,t){var o=cc.callFunc(function(e){e.getComponent("handLogic").normal()}),n=cc.callFunc(function(e){e.getComponent("handLogic").touchDown()}),i=(cc.callFunc(function(e){e.getComponent("handLogic").click()}),cc.moveTo(1,cc.v2(e.x,e.y))),a=cc.moveTo(1,cc.v2(t.x,t.y));return[o,i,n,cc.delayTime(window.$CommonData.gCData.deTimeNum),cc.callFunc(function(){e.getComponent("TS_Node_moveChangeLogic").overMovePos(t)}),a]},t.prototype.moveChange2_resultsDemonstration=function(e,t){this.handNode.active=!0;var o=cc.v2(this.handNode.x,this.handNode.y),n=this.nowGameLayer.getComponent(""+e);n.restartAllChildNode();var i=n.selfmoveChangeNodeArr,a=n.KuangArr,s=this.data_JSON[this.layerLogic].resullArr,r=cc.delayTime(.5),c=[];c.push(r);for(var l=0;l<i.length;l++){var u=this.MoveChange2_action(i[s[l]],a[l]);c=c.concat(u)}var d=cc.callFunc(function(e){e.x=o.x,e.y=o.y,e.active=!1,t()});c.push(d),this.handNode.runAction(cc.sequence(c))},t.prototype.MoveChange2_action=function(e,t){var o=cc.callFunc(function(e){e.getComponent("handLogic").normal()}),n=cc.callFunc(function(e){e.getComponent("handLogic").touchDown()}),i=(cc.callFunc(function(e){e.getComponent("handLogic").click()}),cc.moveTo(1,cc.v2(e.x,e.y))),a=cc.moveTo(1,cc.v2(t.x,t.y));return[o,i,n,cc.delayTime(window.$CommonData.gCData.deTimeNum),cc.callFunc(function(){e.getComponent("TS_Node_moveChange2Logic").overMovePos(t)}),a,o]},t.prototype.enterUnit=function(){MKLog.log("==========enterUnit===========",window.$CommonData.gSData.serverData);var e={userid:171,unitid:this.nowUnitId,lessonid:49,classid:37,termid:30},t=this;s.default.httpGet("mylessons",{userid:171},function(e){console.log("-----------mylessons------"),e=JSON.parse(e),console.log(e),window.$CommonData.gSData.serverData.units=e.units,console.log("units"),console.log(window.$CommonData.gSData.serverData.units)},function(){}),s.default.httpGet("enterunit",e,function(e){e=JSON.parse(e),window.$CommonData.gSData.serverData.unitRecord=e.unitrecord,window.$CommonData.gSData.serverData.currentUnitId=window.$CommonData.gCData.unitid,window.$CommonData.gSData.serverData.currentStepId=e.currentstepid,window.$CommonData.gSData.serverData.currentUnitRecordId=e.unitrecord.id,window.$CommonData.gSData.serverData.steps=e.steps,window.$CommonData.gSData.serverData.stepSeq=0,window.$CommonData.gSData.serverData.currentStep=e.steps[0],window.$CommonData.gSData.serverData.parts=e.parts,window.$CommonData.gSData.serverData.part_steps=e.part_steps,window.$CommonData.gSData.serverData.stars=e.stars,window.$CommonData.gSData.serverData.stepSeq=2,window.$CommonData.gSData.serverData.currentStep=e.steps[2],console.log("***********************************"),console.log(window.$CommonData.gSData.serverData),t.node.getComponent("UnitRunner").runStep()},function(){})},__decorate([l(cc.Node)],t.prototype,"handNode",void 0),__decorate([l(cc.Node)],t.prototype,"confirm",void 0),__decorate([l(cc.Node)],t.prototype,"robot",void 0),t=__decorate([c],t)}(cc.Component);o.default=u,cc._RF.pop()},{"../pub/Common/MUtils/MKSystem":"MKSystem","../pub/Common/TS_NetCenter":"TS_NetCenter","../pub/Common/TS_ResourceManager":"TS_ResourceManager","../pub/Common/TS_common":"TS_common",GlobalGameData:"GlobalGameData"}],handLogic:[function(e,t,o){"use strict";cc._RF.push(t,"93ec2bGWQxJtrOr1ZvlStwI","handLogic"),cc.Class({extends:cc.Component,properties:{},start:function(){},touchDown:function(){this.node.getComponent(dragonBones.ArmatureDisplay).playAnimation("\u6309\u4e0b",1)},click:function(){this.node.getComponent(dragonBones.ArmatureDisplay).playAnimation("\u70b9\u51fb",1)},normal:function(){this.node.getComponent(dragonBones.ArmatureDisplay).playAnimation("\u5e38\u6001",0)},clickRepeat:function(){this.node.getComponent(dragonBones.ArmatureDisplay).playAnimation("\u70b9\u51fb",0)}}),cc._RF.pop()},{}],nowPointItemLogic:[function(e,t,o){"use strict";cc._RF.push(t,"25470XJgelFcYlkEN3u58+m","nowPointItemLogic"),cc.Class({extends:cc.Component,properties:{itemName:{default:null,type:cc.Label},arrow:{default:null,type:cc.Node},leftArrNode:{default:null,type:cc.Node},itemData:null},start:function(){this.node.on(cc.Node.EventType.TOUCH_START,this.touchStart,this)},touchStart:function(e){for(var t=this.itemData.id,o=$CommonData.gSData.serverData.part_steps,n=o.length,i=-1,a=0;a<n;a++)if(o[a][0]==t){i=a;break}var s=o[i][1],r=new cc.Event.EventCustom("GotoStep",!1);r.setUserData({stepid:s}),cc.find("Canvas").dispatchEvent(r),this.node.parent.active=!1},setItemData:function(e){this.itemData=e,console.log("itemData"),console.log(e)},setItemLabel:function(e){this.itemName.string=e},setSelect:function(){this.node.color=cc.color(93,179,180)},setArrow:function(){MKLog.log("setArrow===="),this.arrow.active=!0},setShowLeftArrow:function(){this.leftArrNode.active=!0},setArrowLeft:function(){this.arrow.active=!0,this.leftArrNode.active=!0}}),cc._RF.pop()},{}],nowPointLogic:[function(e,t,o){"use strict";cc._RF.push(t,"870c11N1RNFYpmJZ8Eu3xGA","nowPointLogic"),cc.Class({extends:cc.Component,properties:{nowPointPrefab:{default:null,type:cc.Prefab}},start:function(){this.node.on(cc.Node.EventType.TOUCH_START,this.touchStart,this)},addItem:function(){MKLog.log("addItemaddItem\uff1a\uff1a\uff1a\uff1a"),this.itemArr=[];for(var e=$CommonData.gSData.serverData.parts,t=e.length,o=0;o<t;o++){var n=cc.instantiate(this.nowPointPrefab);n.scale=.8;var i=n.getComponent("nowPointItemLogic");i.setItemLabel(e[o].partname),i.setItemData(e[o]),n.x=-1130/3+o%5*285*2/3,n.y=t>5?2*(o>4?-100:135)/3:0,4!=o&&o!=t-1&&i.setArrow(),5==o&&(6==t?i.setShowLeftArrow():i.setArrowLeft()),n.parent=this.node,MKLog.log("$CommonData.gCData.partname ==parts[i].partname"),MKLog.log($CommonData.gCData.partname),MKLog.log(e[o].partname),$CommonData.gCData.partname==e[o].partname&&i.setSelect(),this.itemArr.push(n),n.on(cc.Node.EventType.TOUCH_START,function(){},this)}},touchStart:function(e){e.stopPropagation();var t=!0,o=!1,n=void 0;try{for(var i,a=this.itemArr[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){i.value.destroy()}}catch(e){o=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(o)throw n}}this.itemArr=[],this.node.active=!1}}),cc._RF.pop()},{}],particle:[function(e,t,o){"use strict";cc._RF.push(t,"6576d9cR6JFaqoX+crrxdpP","particle"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){},start:function(){var e=this.node.getComponent(cc.ParticleSystem);e.custom=!0,e.positionType=cc.ParticleSystem.PositionType.FREE}}),cc._RF.pop()},{}],scrollView:[function(e,t,o){"use strict";cc._RF.push(t,"28161W3z51LQKH7I0/vDHhp","scrollView");var n=function(){function e(e,t){var o=[],n=!0,i=!1,a=void 0;try{for(var s,r=e[Symbol.iterator]();!(n=(s=r.next()).done)&&(o.push(s.value),!t||o.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{!n&&r.return&&r.return()}finally{if(i)throw a}}return o}return function(t,o){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,o);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();cc.Class({extends:cc.Component,properties:{scrollView:cc.Node,itemsArr:[cc.Prefab],Vertical:!1,gap_x:0,gap_y:0},onLoad:function(){},init:function(){var e=this;this.scrView=this.scrollView.getComponent(cc.ScrollView),this.content=this.scrView.content,this.height=this.content.height,this.width=this.content.width,this.node_pools=new Map,this.item_templates=new Map,this.itemsArr.forEach(function(t,o){t.data.active=!1,e.item_templates.set(o,t.data)}),this.scrollView.on("scrolling",this.on_scrolling,this)},on_scrolling:function(){if(this.items&&this.items.length)if(this.Vertical){var e=this.content.y;e<0&&(e=0),e>this.content.height-this.height&&(e=this.content.height-this.height);for(var t=0,o=this.items.length-1,n=-e,i=n-this.height;this.items[t].y-this.items[t].height>n;)t++;for(;this.items[o].y<i;)o--;t!=this.start_index&&o!=this.stop_index&&(this.start_index=t,this.stop_index=o,this.render_items())}else{var a=this.content.x;a>0&&(a=0),a<this.width-this.content.width&&(a=this.width-this.content.width);for(var s=0,r=this.items.length-1,c=-a,l=c+this.width;this.items[s].x+this.items[s].width<c;)s++;for(;this.items[r].x>l;)r--;s!=this.start_index&&r!=this.stop_index&&(this.start_index=s,this.stop_index=r,this.render_items())}},spawn_node:function(e){var t=void 0,o=this.node_pools.get(e);return o&&o.length>0?t=o.pop():(t=cc.instantiate(this.item_templates.get(e))).active=!0,t.parent=this.content,t},recycle_item:function(e){if(e.node&&cc.isValid(e.node)){var t=this.node_pools.get(e.data.key);t||(t=[],this.node_pools.set(e.data.key,t)),t.push(e.node),e.node.removeFromParent(),e.node=null}},clear_items:function(){var e=this;this.items&&this.items.forEach(function(t){e.recycle_item(t)})},render_items:function(){for(var e=void 0,t=0;t<this.start_index;t++)(e=this.items[t]).node&&this.recycle_item(e);for(var o=this.items.length-1;o>this.stop_index;o--)(e=this.items[o]).node&&this.recycle_item(e);for(var n=this.start_index;n<=this.stop_index+1;n++){if(!this.items[n])return;(e=this.items[n]).node||(e.node=this.spawn_node(e.data.key),this.item_setter(e.node,e.data)),e.node.setPosition(e.x,e.y)}},pack_item:function(e,t){var o=this.spawn_node(t.key),i=this.item_setter(o,t),a=n(i,2),s={x:0,y:0,width:a[0],height:a[1],data:t,node:o};return this.recycle_item(s),s},item_setter:function(e,t){return e.getComponent(cc.Component).itemDataAssignment(t),[e.width,e.height]},layout_items:function(e){if(!(this.items.length<=0)){var t=0;if(e>0){var o=this.items[e-1];t=this.Vertical?o.y-o.height-this.gap_y:o.x+o.width+this.gap_x}for(var n=e,i=this.items.length;n<i;n++){var a=this.items[n];this.Vertical?(a.x=0,a.y=t,t-=a.height+this.gap_y):(a.y=0,a.x=t,t+=a.width+this.gap_x)}}},resize_content:function(){if(this.items.length<=0)return this.content.width=0,void(this.content.height=0);var e=this.items[this.items.length-1];this.Vertical?this.content.height=Math.max(this.height,e.height-e.y):this.content.width=Math.max(this.width,e.x+e.width)},set_data:function(e){var t=this;this.clear_items(),this.items=[],e.forEach(function(e,o){var n=t.pack_item(o,e);t.items.push(n)}),this.layout_items(0),this.resize_content(),this.start_index=-1,this.stop_index=-1,this.Vertical?this.content.y=0:this.content.x=0,this.items.length>0&&this.on_scrolling()},insert_data:function(e,t){var o,n=this;if(0!=t.length)if(this.items||(this.items=[]),e<0||e>this.items.length)MKLog.log("\u65e0\u6548\u7684index",e);else{this.items.length;var i=[];t.forEach(function(e,t){var o=n.pack_item(t,e);i.push(o)}),(o=this.items).splice.apply(o,[e,0].concat(i)),this.layout_items(e),this.resize_content(),this.start_index=-1,this.stop_index=-1,this.on_scrolling()}},append_data:function(e){this.items||(this.items=[]),this.insert_data(this.items.length,e)},scroll_to_end:function(){this.Vertical?this.scrView.getComponent(cc.ScrollView).scrollToBottom(2):this.scrView.getComponent(cc.ScrollView).scrollToRight(2)},destroy_items:function(){this.clear_items(),this.node_pools.forEach(function(e,t){e.forEach(function(e){e.destroy()})}),this.node_pools=null,this.items=null,cc.isValid(this.scrollview)&&this.scrollview.off("scrolling",this.on_scrolling,this)}}),cc._RF.pop()},{}],speakLogic:[function(e,t,o){"use strict";cc._RF.push(t,"b56b1loqoxGap5Amx2Hopss","speakLogic");var n=a(e("../../Common/TS_common")),i=a(e("../../Common/TS_ResourceManager"));a(e("../../Common/MUtils/MKTime"));function a(e){return e&&e.__esModule?e:{default:e}}cc.Class({extends:cc.Component,properties:{sptFrameArray:[cc.SpriteFrame]},start:function(){},init:function(){var e=this;this.UILayer=n.default.getLayerNode("Canvas/UILayer"),$CommonData.gCData.ISCANTOUCH=!1,cc.find("confirmButton",this.UILayer).active=!1,cc.find("rotot",this.UILayer).active=!1,this.handNode=cc.find("handNode",this.UILayer),this.icon1=cc.find("bg/icon1",this.node),this.b1=cc.find("bg/icon1/b1",this.node),this.lab1=cc.find("bg/icon1/lab1",this.node).getComponent(cc.Label),this.speak1=cc.find("bg/icon1/speak1",this.node),this.icon2=cc.find("bg/icon2",this.node),this.head=cc.find("bg/icon2/head",this.node),this.speak2=cc.find("bg/icon2/speak2",this.node),this.lab2=cc.find("bg/icon2/lab2",this.node).getComponent(cc.Label),this.b2=cc.find("bg/icon2/b2",this.node),this.speakBtn=cc.find("bg/speak",this.node),this.isCanTouch=!1,this.isTouching=!1;var t=$CommonData.gSData.serverData.currentStep.paras;t=JSON.parse(t),MKLog.log("stepinfo: ",JSON.stringify(t)),t&&(t.startVoice&&(this.startVoice1=t.startVoice),t.startDuration&&(this.lab1.string=t.startDuration),t.endVoice&&(this.endVoice=t.endVoice)),$CommonData.gCData.userHeadImg="https://wx.qlogo.cn/mmopen/vi_32/DYAIOgq83eryWeGhypWhPpbVRJgpKhs0n3dbmvicVga62V9SSdRQuykN48QoowfKnx9JSmiaMPTiavQxfTiceNa19Q/132",this.icon1.active=!0,cc.loader.load({url:$CommonData.gCData.userHeadImg,type:"png"},function(t,o){t?MKLog.log("err:"+t):e.head.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(o)}),this.speak1.on(cc.Node.EventType.TOUCH_START,function(e){this.isCanTouch&&(MKSound.playClickEffect(),this.isCanTouch=!1,this.playVoice(this.startVoice1,this.b1))},this),this.speakBtn.on(cc.Node.EventType.TOUCH_START,function(e){this.isCanTouch&&(this.isCanTouch=!1,this.isTouching=!0,this.speakBtn.getComponent(cc.Sprite).spriteFrame=this.sptFrameArray[1])},this),this.speakBtn.on(cc.Node.EventType.TOUCH_END,function(e){this.isTouching&&(this.isCanTouch=!0,this.isTouching=!1,this.speakBtn.getComponent(cc.Sprite).spriteFrame=this.sptFrameArray[0],this.finish())},this),this.speakBtn.on(cc.Node.EventType.TOUCH_CANCEL,function(e){this.isTouching&&(this.isCanTouch=!0,this.isTouching=!1,this.speakBtn.getComponent(cc.Sprite).spriteFrame=this.sptFrameArray[0])},this)},playVoice:function(e,t){var o=this;i.default.loadTempRes(e,cc.AudioClip,function(e,n){if(e)o.isCanTouch=!0;else{var i=cc.audioEngine.playEffect(n,!1);t.getComponent(dragonBones.ArmatureDisplay).playAnimation("1\u52a8\u753b");Promise.race([new Promise(function(e,t){cc.audioEngine.setFinishCallback(i,function(){e()})}),new Promise(function(e,t){o.scheduleOnce(function(){e()},25)})]).then(function(){t.getComponent(dragonBones.ArmatureDisplay).playAnimation("0\u9759\u6b62"),o.isCanTouch=!0})}})},finish:function(){MKLog.log("finishfinishfinishfinish:"),this.isCanTouch=!1,MKSound.playVoice(this.endVoice,function(){n.default.net_send_stepData(1,1)})},runStep:function(){$CommonData.gCData.THIS=this,this.init(),this.playVoice(this.startVoice1,this.b1)}}),cc._RF.pop()},{"../../Common/MUtils/MKTime":"MKTime","../../Common/TS_ResourceManager":"TS_ResourceManager","../../Common/TS_common":"TS_common"}],timeLogic:[function(e,t,o){"use strict";cc._RF.push(t,"d1c21UC3e1FFpddLXGP0zY8","timeLogic");var n=function(e){return e&&e.__esModule?e:{default:e}}(e("../../../Script/pub/Common/MUtils/MKSound"));cc.Class({extends:cc.Component,properties:{},diFun:function(){n.default.playVoice("public/audio/di")},doFun:function(){n.default.playVoice("public/audio/do")}}),cc._RF.pop()},{"../../../Script/pub/Common/MUtils/MKSound":"MKSound"}],videoPlayerLogic:[function(e,t,o){"use strict";cc._RF.push(t,"81b0dUqZopDQIPtvy/J0p7P","videoPlayerLogic");var n=function(e){return e&&e.__esModule?e:{default:e}}(e("../../Common/TS_common"));cc.Class({extends:cc.Component,properties:{videoPlayer:cc.Node},onLoad:function(){MKLog.log("onLoad videoPlayer:::"),MKEventDispatch.I.on("Custom_Event_skipBeforeVideo",this.onVideoSkiped.bind(this),this.node)},start:function(){MKLog.log("start videoPlayer:::")},onDestroy:function(){MKLog.log("videoPlayerLogic onDestroy:::"),$CommonData.gCData.isShowVideo=!1,MKEventDispatch.I.removeByNode(this.node),MKSound.playGameBGM()},runStep:function(){MKLog.log("runStep videoPlayer:::"),MKEventDispatch.I.emit("Custom_Event_ShowVideoBG"),this.showVideo()},showVideo:function(){var e=this;MKLog.log("videoPlayer showVideoshowVideoshowVideo:::"),cc.find("Canvas/UILayer/nowPointButton").getComponent(cc.Button).interactable=!1,cc.find("Canvas/UILayer/rotot").active=!1,this.videoPlayer&&(this.videoPlayer.active=!0,this.videoPlayer.height=.75*cc.view.getVisibleSize().height,this.videoPlayer.width=.75*cc.view.getVisibleSize().height*(16/9),this.videoPlayer.y=this.videoPlayer.y-15,MKLog.log("this.videoPlayer.height:::",this.videoPlayer.height),MKLog.log("this.videoPlayer.width:::",this.videoPlayer.width),MKLog.log("this.videoPlayer.x:::",this.videoPlayer.x),MKLog.log("this.videoPlayer..y:::",this.videoPlayer.y)),MKLog.log("this.videoPlayer.:::",this.videoPlayer),$CommonData.gCData.isShowVideo=!0,$CommonData.gCData.levelStarTime=MKTime.getNowTime(),cc.audioEngine.stopMusic(),MKSound.stopBGM();var t=this;t.position=0,MKLog.log("videoNetChange:::");var o=$CommonData.gSData.serverData.currentStep.paras;o=JSON.parse(o),MKLog.log("video_Player.paras:::",JSON.stringify(o)),this.videoPlayer.active=!0;var i=this.videoPlayer.getComponent(cc.VideoPlayer);if(i){var a=o.src;a||(a="https://video-sfkx.oss-cn-beijing.aliyuncs.com/s32/intro.mp4"),i.remoteURL=a,MKLog.log("video_Player.remoteURL:::",i.remoteURL),i.play(),i.node.on("completed",function(){MKLog.log("video_Player.completed:::");var o=cc.find("skipBtn",e.node);o&&(o.active=!1),n.default.net_send_stepData(1,1),t.videoPlayer.active=!1,cc.find("Canvas/UILayer/nowPointButton").getComponent(cc.Button).interactable=!0})}},getStatus:function(e){switch(MKLog.log("video_Player.event:::",e),e){case cc.VideoPlayer.EventType.PLAYING:return"PLAYING";case cc.VideoPlayer.EventType.PAUSED:return"PAUSED";case cc.VideoPlayer.EventType.STOPPED:return"STOPPED";case cc.VideoPlayer.EventType.COMPLETED:return"COMPLETED";case cc.VideoPlayer.EventType.META_LOADED:return"META_LOADED";case cc.VideoPlayer.EventType.CLICKED:return"CLICKED";case cc.VideoPlayer.EventType.READY_TO_PLAY:return"READY_TO_PLAY";default:return"NONE"}},onVideoPlayerEvent:function(e,t){MKLog.log("onVideoPlayerEvent:::",t);var o=this.videoPlayer.getComponent(cc.VideoPlayer);if(t===cc.VideoPlayer.EventType.META_LOADED)o.getDuration();else t===cc.VideoPlayer.EventType.CLICKED||cc.VideoPlayer.EventType.READY_TO_PLAY},onVideoSkiped:function(){MKLog.log("Custom_Event_skipBeforeVideo onVideoSkiped:::");var e=this.videoPlayer.getComponent(cc.VideoPlayer);MKLog.log("video_Player:::",e),e&&e.destroy(),n.default.net_send_stepData(1,1)},skipBtnClicked:function(){MKLog.log("skipBtnClickedskipBtnClickedskipBtnClicked:::");var e=cc.find("skipBtn",this.node);MKLog.log("skipBtn:::",e),e&&(e.getComponent(cc.Button).interactable=!1);var t=this.videoPlayer.getComponent(cc.VideoPlayer);MKLog.log("video_Player:::",t),t&&t.destroy(),n.default.net_send_stepData(1,1)},onDisable:function(){MKLog.log("onDisableonDisableonDisable:::"),$CommonData.gCData.isShowVideo=!1,cc.find("Canvas/UILayer/nowPointButton").getComponent(cc.Button).interactable=!0}}),cc._RF.pop()},{"../../Common/TS_common":"TS_common"}]},{},["CommonInstallApp","CommonPopTips","GlobalGameData","LoadPlist","MKEventDispatch","MKLog","MKSound","MKSystem","MKTime","MKUtils","WXApi","MessageBox","MessageTip","RootNode","SwitchLayer","TS_Alert","TS_NetCenter","TS_ResourceManager","TS_common","TS_password","TS_puddingDrag","TS_robotDrag","breakthroughLogic","continueClassLayer","debrisLayerLogic","TS_Collider_colliderLogic","TS_Node_ligatureLogic","TS_Node_moveChange2Logic","TS_Node_moveChangeLogic","TS_Node_selectNodeLogic","TS_Node_touchMoveLogic","TS_Node_touchSelectMoveLogic","TS_exerciseLineLayerLogic","TS_exerciseMoveKuangLogic","TS_exerciseMovetLayerLogic","TS_exerciseSelectLayerLogic","TS_exerciseSelectMoveLayerLogic","TS_moveChangeLayer2Logic","TS_moveChangeLayerLogic","dottedKuangLogic","StepChooser","Review_RockJump","Review_RockJump_wx","bloodBarScript","classTestScript","GameLayerLogic","handLogic","nowPointItemLogic","nowPointLogic","speakLogic","videoPlayerLogic","UnitRunner","gameSceneLogic","S6101Logic","S6102Logic","S6105Logic","S6106Logic","S6109Logic","S6110Logic","S6113Logic","S6114Logic","S6114MoveNode","S6115Logic","S61FireFly","scrollView","particle","finishLogic","timeLogic"]);