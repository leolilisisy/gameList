window.__require=function e(t,o,n){function i(a,c){if(!o[a]){if(!t[a]){var s=a.split("/");if(s=s[s.length-1],!t[s]){var l="function"==typeof __require&&__require;if(!c&&l)return l(s,!0);if(r)return r(s,!0);throw new Error("Cannot find module '"+a+"'")}a=s}var u=o[a]={exports:{}};t[a][0].call(u.exports,function(e){return i(t[a][1][e]||e)},u,u.exports,e,t,o,n)}return o[a].exports}for(var r="function"==typeof __require&&__require,a=0;a<n.length;a++)i(n[a]);return i}({AStarRoadSeeker:[function(e,t,o){"use strict";cc._RF.push(t,"a3a193EdkVIWoDgtJ/bBisA","AStarRoadSeeker"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(e){this.COST_STRAIGHT=10,this.COST_DIAGONAL=14,this.maxStep=1e3,this._round=[[0,-1],[1,-1],[1,0],[1,1],[0,1],[-1,1],[-1,0],[-1,-1]],this.handle=-1,this.optimize=!0,this._roadNodes=e}return e.prototype.seekPath=function(e,t){if(this._startNode=e,this._currentNode=e,this._targetNode=t,!this._startNode||!this._targetNode)return[];if(1==this._targetNode.value)return console.log("\u76ee\u6807\u4e0d\u53ef\u8fbe\u5230\uff1a"),[];this._openlist=[],this._closelist=[];for(var o=0;;){if(o>this.maxStep)return console.log("\u6ca1\u627e\u5230\u76ee\u6807\u8ba1\u7b97\u6b65\u9aa4\u4e3a\uff1a",o),[];if(o++,this.searchRoundNodes(this._currentNode),0==this._openlist.length)return console.log("\u6ca1\u627e\u5230\u76ee\u6807\u8ba1\u7b97\u6b65\u9aa4\u4e3a\uff1a",o),[];if(this._openlist.sort(this.sortNode),this._currentNode=this._openlist.shift(),this._currentNode==this._targetNode)return console.log("\u627e\u5230\u76ee\u6807\u8ba1\u7b97\u6b65\u9aa4\u4e3a\uff1a",o),this.getPath();this._closelist.push(this._currentNode)}return[]},e.prototype.seekPath2=function(e,t){if(this._startNode=e,this._currentNode=e,this._targetNode=t,!this._startNode||!this._targetNode)return[];this._openlist=[],this._closelist=[];for(var o=0,n=null;;){if(o>this.maxStep)return console.log("\u6ca1\u627e\u5230\u76ee\u6807\u8ba1\u7b97\u6b65\u9aa4\u4e3a\uff1a",o),this.seekPath(e,n);if(o++,this.searchRoundNodes(this._currentNode),0==this._openlist.length)return console.log("\u6ca1\u627e\u5230\u76ee\u6807\u8ba1\u7b97\u6b65\u9aa4\u4e3a\uff1a",o),this.seekPath(e,n);if(this._openlist.sort(this.sortNode),this._currentNode=this._openlist.shift(),null==n?n=this._currentNode:this._currentNode.h<n.h&&(n=this._currentNode),this._currentNode==this._targetNode)return console.log("\u627e\u5230\u76ee\u6807\u8ba1\u7b97\u6b65\u9aa4\u4e3a\uff1a",o),this.getPath();this._closelist.push(this._currentNode)}return this.seekPath(e,n)},e.prototype.sortNode=function(e,t){return e.f<t.f?-1:e.f>t.f?1:0},e.prototype.getPath=function(){for(var e=[],t=this._targetNode;t!=this._startNode;)e.unshift(t),t=t.parent;if(e.unshift(this._startNode),!this.optimize)return e;for(var o=1;o<e.length-1;o++){var n=e[o-1],i=e[o],r=e[o+1],a=i.cx==n.cx&&i.cx==r.cx,c=i.cy==n.cy&&i.cy==r.cy,s=(i.cx-n.cx)/(i.cy-n.cy)*((r.cx-i.cx)/(r.cy-i.cy))==1;(a||c||s)&&(e.splice(o,1),o--)}return e},e.prototype.testSeekPathStep=function(e,t,o,n,i){var r=this;if(void 0===i&&(i=100),this._startNode=e,this._currentNode=e,this._targetNode=t,1!=this._targetNode.value){this._openlist=[],this._closelist=[];var a=0;clearInterval(this.handle),this.handle=setInterval(function(){return a>r.maxStep?(console.log("\u6ca1\u627e\u5230\u76ee\u6807\u8ba1\u7b97\u6b65\u9aa4\u4e3a\uff1a",a),void clearInterval(r.handle)):(a++,r.searchRoundNodes(r._currentNode),0==r._openlist.length?(console.log("\u6ca1\u627e\u5230\u76ee\u6807\u8ba1\u7b97\u6b65\u9aa4\u4e3a\uff1a",a),void clearInterval(r.handle)):(r._openlist.sort(r.sortNode),r._currentNode=r._openlist.shift(),void(r._currentNode==r._targetNode?(console.log("\u627e\u5230\u76ee\u6807\u8ba1\u7b97\u6b65\u9aa4\u4e3a\uff1a",a),clearInterval(r.handle),o.apply(n,[r._startNode,r._targetNode,r._currentNode,r._openlist,r._closelist,r.getPath()])):(r._closelist.push(r._currentNode),o.apply(n,[r._startNode,r._targetNode,r._currentNode,r._openlist,r._closelist,null])))))},i)}},e.prototype.searchRoundNodes=function(e){for(var t=0;t<this._round.length;t++){var o=e.cx+this._round[t][0],n=e.cy+this._round[t][1],i=this._roadNodes[o+"_"+n];null==i||i==this._startNode||1==i.value||this.isInCloseList(i)||this.inInCorner(i)||this.setNodeF(i)}},e.prototype.setNodeF=function(e){var t;if(t=e.cx==this._currentNode.cx||e.cy==this._currentNode.cy?this._currentNode.g+this.COST_STRAIGHT:this._currentNode.g+this.COST_DIAGONAL,this.isInOpenList(e)){if(!(t<e.g))return;e.g=t}else e.g=t,this._openlist.push(e);e.parent=this._currentNode,e.h=(Math.abs(this._targetNode.cx-e.cx)+Math.abs(this._targetNode.cy-e.cy))*this.COST_STRAIGHT,e.f=e.g+e.h},e.prototype.isInOpenList=function(e){return-1!=this._openlist.indexOf(e)},e.prototype.isInCloseList=function(e){return-1!=this._closelist.indexOf(e)},e.prototype.inInCorner=function(e){if(e.cx==this._currentNode.cx||e.cy==this._currentNode.cy)return!1;var t=this._roadNodes[this._currentNode.cx+"_"+e.cy],o=this._roadNodes[e.cx+"_"+this._currentNode.cy];return null==t||0!=t.value||null==o||0!=o.value},e.prototype.dispose=function(){this._roadNodes=null,this._round=null},e}();o.default=n,cc._RF.pop()},{}],AccountData:[function(e,t,o){"use strict";cc._RF.push(t,"a4205+A/aBJIL/KlNfNdMid","AccountData"),Object.defineProperty(o,"__esModule",{value:!0}),function(e){e.LEVEL_CHANGE="AccountDataEvent.LEVEL_CHANGE",e.EXP_CHANGE="AccountDataEvent.EXP_CHANGE",e.GOLD_CHANGE="AccountDataEvent.GOLD_CHANGE",e.AVATAR_CHANGE="AccountDataEvent.AVATAR_CHANGE"}(o.AccountDataEvent||(o.AccountDataEvent={}));var n=function(){function e(){this.level=0,this._diamond=0,this._credit=null,this._fame=null,this._win=null,this._winTotal=null,this._loginTime=null,this._nowDate=null,this.accountId="",this._data=null}return Object.defineProperty(e.prototype,"diamond",{get:function(){return this._diamond},set:function(e){this._diamond=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"credit",{get:function(){return this._credit},set:function(e){this._credit=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fame",{get:function(){return this._fame},set:function(e){this._fame=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"win",{get:function(){return this._win},set:function(e){this._win=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"winTotal",{get:function(){return this._winTotal},set:function(e){this._winTotal=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loginTime",{get:function(){return this._loginTime},set:function(e){this._loginTime=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nowDate",{get:function(){return this._nowDate},set:function(e){this._nowDate=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currency",{get:function(){return this._data.userInfo.currency},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),e.prototype.setData=function(e){this._data=e,this.uid=e.uid,this.nickName=e.nickName||this.accountId,cc.log("[AccountData] \u6536\u5230\u767b\u5f55\u6570\u636e",e)},e.prototype.logout=function(){},e}();o.AccountData=n,cc._RF.pop()},{}],Account:[function(e,t,o){"use strict";cc._RF.push(t,"2d03cn7VdtPrIeFFW2qhI67","Account");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i,r=e("../../core/Engine"),a=e("../../core/event/EventDispatcher"),c=e("../../Main"),s=e("../config/Config"),l=e("../server/Server"),u=e("../Service"),p=e("./AccountData"),d=e("./LoginType"),h=e("./RequestAccount");(function(e){e.LOGINED="AccountEvent.LOGINED",e.LOGIN_FAILED="AccountEvent.LOGIN_FAILED",e.LOGOUT="AccountEvent.LOGOUT",e.VISITOR_BIND_SUCCESS="AccountEvent.VISITOR_BIND_SUCCESS",e.VISITOR_BIND_FAILED="AccountEvent.VISITOR_BIND_FAILED"})(i=o.AccountEvent||(o.AccountEvent={}));var f=function(e){function t(t){var o=e.call(this)||this;return o._isReconnect=!1,o._isLogined=!1,o._data=null,o._server=null,o._server=t,o._data=new p.AccountData,t.addEventListener(l.ServerEvent.DISCONNECTED_TICK,o.eventHandler,o),o._server.addProtocolListener("onKick",o.onKick.bind(o)),cc.log("[Account] constructor"),o}return n(t,e),Object.defineProperty(t.prototype,"isReconnected",{get:function(){return this._isReconnect},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isLogined",{get:function(){return this._isLogined},enumerable:!0,configurable:!0}),t.prototype.getRequestAccount=function(){return h.RequestAccountPool.get(this.currentPlatform)},Object.defineProperty(t.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentPlatform",{get:function(){return cc.sys.localStorage.getItem("logintype")||d.LoginType.unlogin},set:function(e){cc.sys.localStorage.setItem("logintype",e)},enumerable:!0,configurable:!0}),t.prototype.login=function(e){var t=this;this.currentPlatform=e;var o=function(o){t.$loginServer(e,o)};if(this._server.state==l.ServerState.DISCONNECTED){this._isLogined=!1;var n=s.default.game.data.server;cc.log("[Account] \u8fde\u63a5\u6e38\u620f",n),this._server.connect([n,n,n],o)}else this._server.state==l.ServerState.CONNECTTED?o(!0):cc.log("[Account] \u6b63\u5728\u8fde\u63a5\u670d\u52a1\u5668\uff01")},t.prototype.$loginServer=function(e,t){var o=this;if(!t)return cc.log("[Account]\u670d\u52a1\u5668\u8fde\u63a5\u5931\u8d25"),void(this.currentPlatform=e);var n=h.RequestAccountPool.get(e);n?n&&n.login(function(t){o.accountLoginHandler(e,t)}):cc.error(" "+e+" is null!")},t.prototype.accountLoginHandler=function(e,t){if(!t)return cc.log("[Account] \u767b\u5f55\u5931\u8d25"),this.dispatchEvent(i.LOGIN_FAILED),void u.service.server.disconnect(!0);this.currentPlatform=e,cc.log(" [Account] \u767b\u5f55\u6210\u529f",JSON.stringify(t.userInfo,null,2)),this._data.setData(t);var o=t.serverTime||t.timeStamp;r.default.timer.serverTimeElasped(o-Date.now()),this._isReconnect=!1,this._isLogined=!0,this._server.resendSafetyCacheRequest(),r.default.log.info("\u53d1\u9001LOGINED\u4e8b\u4ef6"),this.dispatchEvent(i.LOGINED),u.service.prompt.netInstableClose(),this._server.closeDisconnectAlertTimer()},t.prototype.visitorBindHandler=function(e,t){t?(cc.log(" [Account] \u7ed1\u5b9a\u6210\u529f",JSON.stringify(t,null,2)),t.userInfo,this.data.nickName=t.nickname,this.data.accountId=t.accountId,this.currentPlatform=e,this.dispatchEvent(i.VISITOR_BIND_SUCCESS)):(cc.log("[Account] \u7ed1\u5b9a\u5931\u8d25"),this.dispatchEvent(i.VISITOR_BIND_FAILED))},t.prototype.relogin=function(e){this._isReconnect=!0,cc.warn("\u89e6\u53d1\u91cd\u65b0\u767b\u9646\u6d41\u7a0b"),this.login(e)},t.prototype.bindAccount=function(e){var t=this;if(this.currentPlatform===d.LoginType.visitor){var o=h.RequestAccountPool.get(e);switch(e){case d.LoginType.facebook:cc.log("[Account] \u6267\u884c\u7ed1\u5b9aFacebook\u8d26\u53f7"),o&&o.bindAccount(function(o){t.visitorBindHandler(e,o)});break;case d.LoginType.google:o&&cc.log("[Account] [Account]\u6267\u884c\u7ed1\u5b9agoogle\u8d26\u53f7"),o.bindAccount(function(o){t.visitorBindHandler(e,o)})}}else cc.log("[Account] \u53ea\u6709\u6e38\u5ba2\u8d26\u53f7\u624d\u53ef\u4ee5\u7ed1\u5b9a\uff01\uff01\uff01")},t.prototype.logout=function(){var e=h.RequestAccountPool.get(this.currentPlatform);e||cc.error(" "+this.currentPlatform+" is null!"),e&&e.logout(),this.currentPlatform=d.LoginType.unlogin,this._isLogined=!1,this._data.logout(),this._server.disconnect(),this.dispatchEvent(i.LOGOUT)},t.prototype.onKick=function(e){if(cc.log("[Account]  User is kicked! msg=",e),4==e.reason)return cc.log("[Account] \u957f\u65f6\u95f4\u672a\u64cd\u4f5c\u81ea\u52a8\u91cd\u8fde"),void this.relogin(this.currentPlatform);this.logout(),u.service.prompt.errorCodePrompt(1e4+parseInt(e.reason),function(){c.default.module.exitHall()})},t.prototype.eventHandler=function(e,t){var o=this;switch(e){case l.ServerEvent.DISCONNECTED_TICK:var n=u.service.server.stepTryConnectTime();if(n>0)return cc.log("[Account] \u91cd\u8fde\u5269\u4f59\u6b21\u6570"+n),void this.relogin(this.currentPlatform);u.service.prompt.netInstableClose(),u.service.prompt.hasPopView()||(cc.log("[Account] \u5927\u5385\u670d\u52a1\u5668 \u65ad\u7ebf\u91cd\u8fde"),u.service.prompt.hallServerDisconnected(function(){cc.log("\u7528\u6237\u9009\u62e9\u91cd\u8fde\uff01"),u.service.prompt.netInstableOpen(),o.relogin(o.currentPlatform)},function(){cc.log("\u7528\u6237\u9009\u62e9\u8fd4\u56de\u767b\u5f55\u754c\u9762\uff01"),c.default.module.exitHall()}))}},t}(a.EventDispatcher);o.Account=f,cc._RF.pop()},{"../../Main":"Main","../../core/Engine":"Engine","../../core/event/EventDispatcher":"EventDispatcher","../Service":"Service","../config/Config":"Config","../server/Server":"Server","./AccountData":"AccountData","./LoginType":"LoginType","./RequestAccount":"RequestAccount"}],ActionX:[function(e,t,o){"use strict";cc._RF.push(t,"42ad9jiHGRLKK3HBKKxmJoB","ActionX");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../../core/ui/ComponentExtends"),a=cc._decorator,c=a.ccclass,s=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.range=5,t.duration=.2,t.isAway=!1,t.initX=0,t}return n(t,e),t.prototype.onLoad=function(){this.initX=this.node.x,this.action()},t.prototype.action=function(){var e=this,t=this.isAway?this.range:0;this.node.RunAction(ezaction.moveTo(this.duration,{x:this.initX+this.range})).onStoped(function(){e.node.RunAction(ezaction.moveTo(e.duration,{x:e.initX-t})).onStoped(function(){e.action()})})},t.prototype.onDestroy=function(){this.initX=null,e.prototype.onDestroy.call(this)},i([s],t.prototype,"range",void 0),i([s],t.prototype,"duration",void 0),i([s({tooltip:"\u662f\u5426\u5de6\u53f3\u6446\u52a8 {\u76f8\u5bf9\u521d\u59cb\u5750\u6807}"})],t.prototype,"isAway",void 0),t=i([c],t)}(r.ComponentExtends);o.default=l,cc._RF.pop()},{"../../../core/ui/ComponentExtends":"ComponentExtends"}],ActionYSet:[function(e,t,o){"use strict";cc._RF.push(t,"106454aOQVJ3rRXLCdIkY+8","ActionYSet");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../../core/ui/ComponentExtends"),a=cc._decorator,c=a.ccclass,s=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.range=5,t.duration=.2,t._initY=0,t}return n(t,e),t.prototype.onLoad=function(){},Object.defineProperty(t.prototype,"initY",{get:function(){return this._initY},set:function(e){this._initY=e,this.node.y=e,this.action()},enumerable:!0,configurable:!0}),t.prototype.action=function(){var e=this;this.node.RunAction(ezaction.moveTo(this.duration,{y:this.initY+this.range})).onStoped(function(){e.node.RunAction(ezaction.moveTo(e.duration,{y:e.initY-e.range})).onStoped(function(){e.action()})})},t.prototype.onDestroy=function(){this.initY=null,e.prototype.onDestroy.call(this)},i([s],t.prototype,"range",void 0),i([s],t.prototype,"duration",void 0),t=i([c],t)}(r.ComponentExtends);o.default=l,cc._RF.pop()},{"../../../core/ui/ComponentExtends":"ComponentExtends"}],ActionY:[function(e,t,o){"use strict";cc._RF.push(t,"85f02PPJs1Hb6u8Kt1xj8dB","ActionY");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../../core/ui/ComponentExtends"),a=cc._decorator,c=a.ccclass,s=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.range=5,t.duration=.2,t.initY=0,t}return n(t,e),t.prototype.onLoad=function(){this.initY=this.node.y,this.action()},t.prototype.action=function(){var e=this;this.node.RunAction(ezaction.moveTo(this.duration,{y:this.initY+this.range})).onStoped(function(){e.node.RunAction(ezaction.moveTo(e.duration,{y:e.initY-e.range})).onStoped(function(){e.action()})})},t.prototype.onDestroy=function(){this.initY=null,e.prototype.onDestroy.call(this)},i([s],t.prototype,"range",void 0),i([s],t.prototype,"duration",void 0),t=i([c],t)}(r.ComponentExtends);o.default=l,cc._RF.pop()},{"../../../core/ui/ComponentExtends":"ComponentExtends"}],AdvControl:[function(e,t,o){"use strict";cc._RF.push(t,"fe4b0jzfyVHFL0200Sv3bX8","AdvControl");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r,a,c=e("../../../core/event/MessageManager"),s=e("../../../core/ezplugin/ezplugin"),l=e("../../../core/ui/ComponentExtends"),u=e("../../../Main"),p=e("../../../service/Service"),d=e("../../CalcUiShow");(function(e){e.PLAY="play",e.ADV_SUCCESS="adv_success",e.ADV_ERROR="adv_error"})(r=o.AdvMessage||(o.AdvMessage={})),function(e){e[e.NONE=0]="NONE",e[e.OFFLINE_REWARD=1]="OFFLINE_REWARD",e[e.NPC_7_1=2]="NPC_7_1",e[e.NPC_7_2=3]="NPC_7_2",e[e.NPC_9=4]="NPC_9",e[e.FAME_MUTI=5]="FAME_MUTI",e[e.DAY_TASK=6]="DAY_TASK",e[e.MAIN_MUTI=7]="MAIN_MUTI",e[e.GIFT_DIAMOND=8]="GIFT_DIAMOND",e[e.LANDMARK=9]="LANDMARK",e[e.GET_FAME=10]="GET_FAME"}(a=o.AdvRewardType||(o.AdvRewardType={}));var h=cc._decorator,f=h.ccclass,g=(h.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isPlayAdv=!1,t.currentRewardType=a.NONE,t.currentCallback=null,t}return n(t,e),t.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchHandler,this),c.Message.on(r.PLAY,this.onEventHandler,this),c.Message.on(r.ADV_SUCCESS,this.onAdvStatusHandler,this),c.Message.on(r.ADV_ERROR,this.onAdvStatusHandler,this)},t.prototype.onAdvStatusHandler=function(e,t){var o=this;switch(e){case r.ADV_SUCCESS:if(!this.isPlayAdv)break;if(p.service.prompt.netInstableClose(),t.rewardType){cc.log("AdvControl:\u89c2\u770b\u5b8c\u5e7f\u544a==>"+JSON.stringify(t));var n=u.default.module.calcUiShow.changeTaskListByTypeCount(d.TaskType.WATCH_AD,1);if(u.default.module.gameProtocol.sendTaskList(n,function(e){u.default.module.vm.taskList=n}),u.default.module.vm.advCount<5){var i=u.default.module.vm.advCount+1;u.default.module.gameProtocol.sendAdvCount(i,function(){u.default.module.vm.advCount=i,o.currentCallback&&o.currentCallback(!0,o.currentRewardType)})}else this.currentCallback&&this.currentCallback(!0,this.currentRewardType)}else cc.log("AdvControl:\u672a\u89c2\u770b\u5b8c\u5e7f\u544a==>"+JSON.stringify(t)),p.service.analytics.logEvent("ad_close","",""),this.currentCallback&&this.currentCallback(!1,this.currentRewardType);this.isPlayAdv=!1;break;case r.ADV_ERROR:if(!this.isPlayAdv)break;p.service.prompt.netInstableClose(),this.isPlayAdv=!1,cc.log("AdvControl:\u5e7f\u544a\u52a0\u8f7d\u9519\u8bef"),this.currentRewardType=a.NONE,this.currentCallback&&this.currentCallback(!1,this.currentRewardType)}},t.prototype.onEventHandler=function(e,t){switch(e){case r.PLAY:if(cc.sys.isBrowser)return;if(this.isPlayAdv)return;cc.log("AdvControl:\u64ad\u653e\u5e7f\u544a"),p.service.prompt.netInstableOpen(),t.callback&&(this.currentCallback=t.callback),t.type&&(this.currentRewardType=t.type),this.isPlayAdv=!0;var o=s.ezplugin.get("PluginTopon");o?o.excuteInUIThread("play",""):cc.error("\u4e0d\u652f\u6301\u8be5\u5e73\u53f0\uff01")}},t.prototype.onTouchHandler=function(e){e.target.name},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this),this.isPlayAdv=null,this.currentRewardType=null,this.currentCallback=null,c.Message.removeEventTarget(this),this.currentCallback=null},t=i([f],t)}(l.ComponentExtends));o.default=g,cc._RF.pop()},{"../../../Main":"Main","../../../core/event/MessageManager":"MessageManager","../../../core/ezplugin/ezplugin":"ezplugin","../../../core/ui/ComponentExtends":"ComponentExtends","../../../service/Service":"Service","../../CalcUiShow":"CalcUiShow"}],AdvLoop:[function(e,t,o){"use strict";cc._RF.push(t,"b244exH8m9HRZjsHnyq/xo8","AdvLoop");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../../core/ui/ComponentExtends"),a=cc._decorator,c=a.ccclass,s=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.onLoad=function(){this.action()},t.prototype.action=function(){var e=this,t=1;this.schedule(function(){var o=e.node.getChildByName("spr");t>11&&(t=1),o.getComponent(cc.Sprite).spriteFrame=cc.loader.getRes("main/adv/adv1/gg1_"+t,cc.SpriteFrame),t++},5/60)},t.prototype.onDestroy=function(){this.unscheduleAllCallbacks(),e.prototype.onDestroy.call(this)},t=i([c],t)}(r.ComponentExtends));o.default=s,cc._RF.pop()},{"../../../core/ui/ComponentExtends":"ComponentExtends"}],AdvMainMuti:[function(e,t,o){"use strict";cc._RF.push(t,"46245dsqOtBuaU2ppl+0a6c","AdvMainMuti");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../../core/event/MessageManager"),a=e("../../../core/gui/GUI"),c=e("../../../core/language/LanguageLabel"),s=e("../../../core/ui/ComponentExtends"),l=e("../../../Main"),u=e("../../CalcUiShow"),p=e("./AdvControl"),d=cc._decorator,h=d.ccclass,f=d.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.timeLab=null,t.btnLab=null,t.callback=null,t.mainControl=null,t}return n(t,e),t.prototype.onLoad=function(){this.node.hasEventListener(cc.Node.EventType.TOUCH_END)||this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchHandler,this)},t.prototype.onAdded=function(e){cc.log("AdvMainMuti\u754c\u9762\u5f39\u7a97"),this.mainControl=e.mainControl},t.prototype.onTouchHandler=function(e){var t=this;switch(e.target.name){case"btn_poster":if(cc.sys.isBrowser){cc.log("\u6d4f\u89c8\u5668\u76f4\u63a5\u53d1\u653e\u4e3b\u754c\u9762\u91d1\u5e01\u7ffb\u500d\u5956\u52b1"),this.mainControl.cacheMainMutiTime();var o=l.default.module.calcUiShow.changeTaskListByTypeCount(u.TaskType.WATCH_AD,1);return void l.default.module.gameProtocol.sendTaskList(o,function(e){l.default.module.vm.taskList=o})}r.Message.dispatchEvent(p.AdvMessage.PLAY,{callback:function(e,o){o==p.AdvRewardType.MAIN_MUTI&&(e?(cc.log("\u4e3b\u754c\u9762\u91d1\u5e01\u5956\u52b1\u7ffb\u500d\u89c2\u770b\u5e7f\u544a\u6210\u529f"),t.mainControl.cacheMainMutiTime()):cc.log("\u4e3b\u754c\u9762\u91d1\u5e01\u5956\u52b1\u7ffb\u500d\u89c2\u770b\u5e7f\u544a\u5931\u8d25"))},type:p.AdvRewardType.MAIN_MUTI});break;case"spr":case"bg":cc.log("AdvMainMuti:\u9009\u62e9\u4e0d\u89c2\u770b\u89c6\u9891bg");break;default:cc.log("AdvMainMuti:\u9009\u62e9\u4e0d\u89c2\u770b\u89c6\u9891"),a.gui.delete(this.node)}},t.prototype.update=function(){this.timeLab.string=l.default.module.calcUiShow.formatTime(this.mainControl.mainAdMutiEndTime),this.node.getChildByName("progress_spr").width=this.mainControl.mainAdMutiEndTime/432e5*390,this.mainControl.mainAdMutiEndTime>=m?(this.node.getChildByName("btn_full").active=!0,this.node.getChildByName("progress_spr").active=!0,this.node.getChildByName("progress_bg").active=!0,this.node.getChildByName("time_bg").active=!0,this.node.getChildByName("btn_poster").active=!1):(this.node.getChildByName("btn_full").active=!1,this.node.getChildByName("btn_poster").active=!0,this.mainControl.mainAdMutiEndTime>0?(this.btnLab.dataID="ui_sale_10",this.node.getChildByName("progress_spr").active=!0,this.node.getChildByName("progress_bg").active=!0,this.node.getChildByName("time_bg").active=!0,this.node.getChildByName("btn_poster").y=-210):(this.btnLab.dataID="ui_sale_9",this.node.getChildByName("progress_spr").active=!1,this.node.getChildByName("progress_bg").active=!1,this.node.getChildByName("time_bg").active=!1,this.node.getChildByName("btn_poster").y=-190))},t.prototype.onDestroy=function(){this.callback=null,this.mainControl=null,r.Message.removeEventTarget(this),this.node.off(cc.Node.EventType.TOUCH_END),e.prototype.onDestroy.call(this)},i([f(cc.Label)],t.prototype,"timeLab",void 0),i([f(c.LanguageLabel)],t.prototype,"btnLab",void 0),t=i([h],t)}(s.ComponentExtends);o.default=g;var m=4314e4;cc._RF.pop()},{"../../../Main":"Main","../../../core/event/MessageManager":"MessageManager","../../../core/gui/GUI":"GUI","../../../core/language/LanguageLabel":"LanguageLabel","../../../core/ui/ComponentExtends":"ComponentExtends","../../CalcUiShow":"CalcUiShow","./AdvControl":"AdvControl"}],AdvRewardChoose:[function(e,t,o){"use strict";cc._RF.push(t,"33314ew9aRHibocqaBaN8vy","AdvRewardChoose");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../../core/event/MessageManager"),a=e("../../../core/gui/GUI"),c=e("../../../core/language/LanguageLabel"),s=e("../../../core/ui/ComponentExtends"),l=e("../../../core/ui/label/LabelChangeSymbol"),u=e("../../../Main"),p=e("../../CalcUiShow"),d=e("./AdvControl"),h=cc._decorator,f=h.ccclass,g=(h.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.callback=null,t.chooseType=0,t}return n(t,e),t.prototype.onLoad=function(){this.node.hasEventListener(cc.Node.EventType.TOUCH_END)||this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchHandler,this)},t.prototype.onAdded=function(e){var t=this;if(cc.log("AdvRewardChoose\u9009\u62e9\u754c\u9762\u5f39\u7a97"),this.node.active=!1,this.node.getChildByName("spr").scale=e.type-1==1?.8:1,cc.loader.loadRes("popup/adv_choose/ad_bg_"+(e.type-1),cc.SpriteFrame,function(e,o){e?cc.error(e):(t.node.active=!0,t.node.getChildByName("spr").getComponent(cc.Sprite).spriteFrame=o)}),this.node.getChildByName("content").active=e.type==d.AdvRewardType.NPC_7_1,this.node.getChildByName("content").getComponent(c.LanguageLabel).dataID="popup_reward_"+(e.type-1),this.callback=e.callback,e.reward){var o=u.default.module.calcTool.calcMutiNum(e.reward,{num:5,numE:0});this.node.getChildByName("btn_poster").getChildByName("coin").getComponent(l.LabelChangeSymbol).num=o}this.node.getChildByName("btn_poster").getChildByName("coin").active=e.type==d.AdvRewardType.NPC_7_1,this.node.getChildByName("btn_poster").getChildByName("damond").active=e.type==d.AdvRewardType.NPC_7_2||e.type==d.AdvRewardType.NPC_9,this.node.getChildByName("coin_spr").active=e.type-1==1,this.node.getChildByName("zuanshi").active=e.type-1==2,this.node.getChildByName("random_prop").active=e.type-1==3,this.node.getChildByName("btn_poster").y=e.type-1==2?-195:-210,this.chooseType=e.type},t.prototype.onTouchHandler=function(e){var t=this;switch(e.target.name){case"btn_poster":var o=d.AdvRewardType.NPC_7_1;if(2==this.chooseType?o=d.AdvRewardType.NPC_7_2:3==this.chooseType&&(o=d.AdvRewardType.NPC_9),cc.sys.isBrowser){cc.log("\u6d4f\u89c8\u5668\u76f4\u63a5\u53d1\u653e\u5356\u697c\u5956\u52b1"),this.node.destroy();var n=u.default.module.calcUiShow.changeTaskListByTypeCount(p.TaskType.WATCH_AD,1);return u.default.module.gameProtocol.sendTaskList(n,function(e){u.default.module.vm.taskList=n}),void(this.callback&&this.callback(!0,o))}cc.log("AdvRewardChoose:\u9009\u62e9\u89c2\u770b\u89c6\u9891"),r.Message.dispatchEvent(d.AdvMessage.PLAY,{callback:function(e,o){t.node.destroy(),t.callback&&t.callback(e,o)},type:o});break;case"spr":case"bg":cc.log("AdvRewardChoose:\u9009\u62e9\u4e0d\u89c2\u770b\u89c6\u9891bg");break;default:cc.log("AdvRewardChoose:\u9009\u62e9\u4e0d\u89c2\u770b\u89c6\u9891"),a.gui.delete(this.node),this.callback&&this.callback(!1,this.chooseType)}},t.prototype.onDestroy=function(){this.callback=null,this.chooseType=null,r.Message.removeEventTarget(this),this.node.off(cc.Node.EventType.TOUCH_END),e.prototype.onDestroy.call(this)},t=i([f],t)}(s.ComponentExtends));o.default=g,cc._RF.pop()},{"../../../Main":"Main","../../../core/event/MessageManager":"MessageManager","../../../core/gui/GUI":"GUI","../../../core/language/LanguageLabel":"LanguageLabel","../../../core/ui/ComponentExtends":"ComponentExtends","../../../core/ui/label/LabelChangeSymbol":"LabelChangeSymbol","../../CalcUiShow":"CalcUiShow","./AdvControl":"AdvControl"}],AppResManager:[function(e,t,o){"use strict";cc._RF.push(t,"4c450qA5X5Bia9Gwp5G7QNs","AppResManager"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../core/Engine"),i=e("../service/config/Config"),r=e("./AssetsHotUpdate"),a=function(){function e(e){this.appresUrlHelper=null,this.isReview=!1,this.assetsHotUpdate=null,this.appresUrlHelper=e,this.assetsHotUpdate=new r.AssetsHotUpdate}return e.prototype.start=function(e,t){var o=this,n=this.appresUrlHelper;this.assetsHotUpdate.refreshUrlAndPath(n.url_assets_patch,n.local_assets_patch_path),this.checkApp(function(n,i){switch(n){case r.AssetsHotUpdateEVent.EVENT_PATCH_NEED:if(e)return void o.assetsHotUpdate.start(t)}t(n,i)})},e.prototype.checkApp=function(e){var t=this;cc.sys.isBrowser?e(r.AssetsHotUpdateEVent.EVENT_PATCH_NONEED,"0"):this.checkAppVersion(function(o){switch(o){case 0:t.isReview=!0,cc.log("\u672c\u5730\u7248\u672c\u5927\u4e8e\u7ebf\u4e0a\u7248\u672c\uff0c\u5f53\u524d\u53ef\u80fd\u6b63\u5728\u5ba1\u6838"),e(r.AssetsHotUpdateEVent.EVENT_PATCH_NONEED,"0");break;case 1:t.isReview=!1,cc.log("\u672c\u5730\u7248\u672c\u5c0f\u4e8e\u7ebf\u4e0a\u7248\u672c\uff0c\u4e0b\u4e00\u6b65\u8fdb\u5165app\u66f4\u65b0\uff01"),e(r.AssetsHotUpdateEVent.EVENT_APP_UPDATE,"1");break;case-1:t.isReview=!1,e(r.AssetsHotUpdateEVent.EVENT_PATCH_NONEED,"0");break;default:t.isReview=!1,t.checkHotUpdateVersion(function(t){e(t?r.AssetsHotUpdateEVent.EVENT_PATCH_NONEED:r.AssetsHotUpdateEVent.EVENT_PATCH_NEED,"0")})}})},e.prototype.checkHotUpdateVersion=function(e){var t=i.default.game.data.res_mtime;if(!t)return cc.log("\u6ca1\u6709res_mtime\u6570\u636e, \u4e0d\u9700\u8981\u70ed\u66f4\u65b0"),void e(!0);var o=this.assetsHotUpdate.getLocalMd5FileContent();if(o){var n=(o=o.substr(0,64)).split("\n")[0].split("|")[0];return cc.log("\u672c\u5730\u7684md5filelist res_mtime "+n),void e(n===t)}e(!1)},e.prototype.checkAppVersion=function(e){var t=i.default.game.data.version,o=n.default.appVersion,r=this.versionToInt(o),a=this.versionToInt(t);r>a?e(0):r<a?e(1):(cc.log("\u672c\u5730\u7248\u672c\u7b49\u4e8e\u7ebf\u4e0a\u7248\u672c\uff0c\u4e0b\u4e00\u6b65\u68c0\u67e5\u70ed\u66f4\u65b0"),e(2))},e.prototype.versionToInt=function(e){for(var t=0,o=[1e6,1e4,100,1],n=e.split("."),i=0;i<n.length;i++)t+=parseInt(n[i])*o[i];return t},e}();o.AppResManager=a,cc._RF.pop()},{"../core/Engine":"Engine","../service/config/Config":"Config","./AssetsHotUpdate":"AssetsHotUpdate"}],AppResUrl:[function(e,t,o){"use strict";cc._RF.push(t,"20d2csw2l5KnqwlCnM8exMk","AppResUrl"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(e){if(this.appVersion="",this.res_server="",this.url_res_server="",this.local_assets_patch_path="",this.local_games_assets_patch_path="",this.appVersion=e,"undefined"!=typeof jsb){var t=jsb.fileUtils.getWritablePath();this.local_assets_patch_path=cc.path.join(t,"assetspatch"),this.local_games_assets_patch_path=cc.path.join(t,"gamesassetspatch"),jsb.fileUtils.createDirectory(this.local_games_assets_patch_path)}}return Object.defineProperty(e.prototype,"url_assets_patch",{get:function(){return this.url_res_server+"/assetspatch"+this.appVersion},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"url_hall_games",{get:function(){return this.res_server+"/hallgames"},enumerable:!0,configurable:!0}),e.prototype.setResServer=function(e){"/"==e[e.length-1]&&(e=e.substring(0,e.length-2)),this.res_server=e,this.url_res_server=e+"/"+cc.sys.os.toLowerCase()},e}();o.AppResUrl=n,cc._RF.pop()},{}],AssetsHotUpdate:[function(e,t,o){"use strict";cc._RF.push(t,"c3a55LgqbxLVZYdouuRogJT","AssetsHotUpdate"),Object.defineProperty(o,"__esModule",{value:!0});var n,i=e("../core/Engine");(function(e){e.EVENT_PATCH_NEED="EVENT_PATCH_NEED",e.EVENT_PATCH_START="EVENT_PATCH_START",e.EVENT_PATCH_PROGRESS="EVENT_PATCH_PROGRESS",e.EVENT_PATCH_FAILED="EVENT_PATCH_FAILED",e.EVENT_PATCH_FINISHED="EVENT_PATCH_FINISHED",e.EVENT_PATCH_NONEED="EVENT_PATCH_NONEED",e.EVENT_APP_UPDATE="EVENT_APP_UPDATE"})(n=o.AssetsHotUpdateEVent||(o.AssetsHotUpdateEVent={}));var r=function(){function e(){if(this.MD5FILE_NAME="md5fileList.txt",this.url_assets_patch="",this.local_assets_patch_path="",this.local_assets_patch_path_temp="",this.needdownloadList=[],this.downloadIndex=0,this.eventCallback=null,this.isLock=!1,"undefined"!=typeof jsb){var e=jsb.fileUtils.getWritablePath();this.local_assets_patch_path_temp=cc.path.join(e,"assetsHotUpdateTemp"),jsb.fileUtils.removeDirectory(this.local_assets_patch_path_temp)}}return e.prototype.refreshUrlAndPath=function(e,t){this.url_assets_patch=e,this.local_assets_patch_path=t},e.prototype.getLocalMd5FileContent=function(){return jsb.fileUtils.getStringFromFile(this.MD5FILE_NAME)||""},e.prototype.start=function(e){var t=this;if("undefined"!=typeof jsb)if(this.isLock)cc.log("[AssetsHotUpdate] \u5f53\u524dLock\u72b6\u6001, \u4e0d\u80fd\u8fdb\u884c\u70ed\u66f4\u65b0\uff01");else{this.isLock=!0;var o=jsb.fileUtils.getStringFromFile(this.MD5FILE_NAME);if(!o)return cc.error("[AssetsHotUpdate] \u672c\u5730md5fileList.txt is empty!"),this.isLock=!1,void e(n.EVENT_PATCH_NONEED,"");this.downloadIndex=0;var r=cc.path.join(this.url_assets_patch,this.MD5FILE_NAME)+"?t="+Date.now(),a=cc.path.join(this.local_assets_patch_path_temp,this.MD5FILE_NAME);cc.log("remoteMd5FileListUrl = 5"),i.default.downloader.download(r,a,2,99,function(i){var r=jsb.fileUtils.getStringFromFile(a);t.needdownloadList=t.compareLocalAndRemote(o,r),t.needdownloadList.length>0?(cc.log("[AssetsHotUpdate] assetsDownload  file count = "+t.needdownloadList.length),e(n.EVENT_PATCH_START,""),t.eventCallback=e,t.downloadIndex=0,t.assetsDownload()):(t.isLock=!1,e(n.EVENT_PATCH_NONEED,""))})}else e(n.EVENT_PATCH_NONEED,"")},e.prototype.compareLocalAndRemote=function(e,t){if(e==t)return cc.log("[AssetsHotUpdate] \u672c\u5730\u548c\u8fdc\u7a0bmd5\u4e00\u81f4\u4e0d\u9700\u8981\u70ed\u66f4\u65b0!"),[];for(var o=[],n=jsb.fileUtils,i=function(e){for(var t={},o=0,n=e.split("\n");o<n.length;o++){var i=n[o].split("|"),r=i[0],a=i[1];(r||a)&&(t[r]=a)}return t}(e),r=!1,a=0,c=t.split("\n");a<c.length;a++){var s=c[a].split("|"),l=s[0],u=s[1];l&&u&&(u.match(/\.json$/g)&&-1===u.indexOf("_megaJson.json")?r=!0:!r&&u.indexOf("_megaJson.json")>-1||i[l]&&n.isFileExist(u)||o.push(u))}return o},e.prototype.assetsDownload=function(){var e=this;if(this.downloadIndex>=this.needdownloadList.length)this.moveFiles();else{var t=this.needdownloadList[this.downloadIndex],o=cc.path.join(this.url_assets_patch,t),r=cc.path.join(this.local_assets_patch_path_temp,t);i.default.downloader.download(o,r,3,1,function(t){t?(e.downloadIndex=e.downloadIndex+1,e.eventCallback&&e.eventCallback(n.EVENT_PATCH_PROGRESS,(e.downloadIndex/e.needdownloadList.length).toFixed(2)),e.assetsDownload()):(cc.log("[AssetsHotUpdate]\u70ed\u66f4\u65b0\u5931\u8d25 "+o+" \n  "+r+" "),e.isLock=!1,e.eventCallback&&e.eventCallback(n.EVENT_PATCH_FAILED,""))})}},e.prototype.moveFiles=function(){for(var e=jsb.fileUtils,t=0,o=this.needdownloadList;t<o.length;t++){var i=o[t],r=cc.path.join(this.local_assets_patch_path_temp,i),a=cc.path.join(this.local_assets_patch_path,i);e.removeFile(a),e.createDirectory(cc.path.dirname(a)),e.renameFile(r,a)&&cc.log(r+" \u8f6c\u79fb\u5230 "+a),i.indexOf("_megaJson.json")>-1&&this.backJsonData(a)}this.isLock=!1,this.eventCallback&&this.eventCallback(n.EVENT_PATCH_FINISHED,this.needdownloadList.length+""),this.needdownloadList=[]},e.prototype.backJsonData=function(e){cc.log("\u5f00\u59cb\u89e3\u6790\u5408\u5e76\u5de5\u5177",e);var t=jsb.fileUtils,o=JSON.parse(t.getStringFromFile(e));for(var n in o){var i=o[n],r=cc.path.join(this.local_assets_patch_path,n);t.isFileExist(r)&&t.removeFile(r),t.createDirectory(cc.path.dirname(r)),t.writeStringToFile(JSON.stringify(i),r),cc.log("\u5199\u5165\u5408\u5e76\u8d44\u6e90",r)}t.removeFile(e)},e}();o.AssetsHotUpdate=r,cc._RF.pop()},{"../core/Engine":"Engine"}],AssetsLoader:[function(e,t,o){"use strict";cc._RF.push(t,"24f94uUhxVBhLftSzn9K08y","AssetsLoader");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i,r=e("../event/EventDispatcher"),a=e("../net/Network"),c=e("../util/HashMap");(function(e){e[e.LOADING=0]="LOADING",e[e.WAIT=1]="WAIT"})(i||(i={}));var s=function(e){function t(t){var o=e.call(this)||this;return o._urls=[],o._state=i.WAIT,o._callbacks=new c.HashMap,o._assetsType=null,o.complete=null,o._assetsType=t,o.on(a.NetworkEvent.CHANGE,o.netchangeHandler,o),o}return n(t,e),t.prototype.dispose=function(){this._urls=[],this.complete=null,this._callbacks.clear(),this._callbacks=null,this.destroy()},t.prototype.setUrls=function(e){for(var t=0,o=e;t<o.length;t++){var n=o[t];this._urls.indexOf(n)<0&&this._urls.push(n)}this.netchangeHandler()},t.prototype.add=function(e){this._urls.indexOf(e)<0&&(this._urls.push(e),this.netchangeHandler())},t.prototype.getRes=function(e,t){var o=cc.loader.getRes(e,this._assetsType);if(o)t(o);else{var n=this._urls.indexOf(e);n>0?(this._urls.splice(n,1),this._urls.unshift(e)):n<0&&(cc.log("[AssetsLoader] \u83b7\u53d6\u7684\u8d44\u6e90\u4e0d\u5728\u4e0b\u8f7d\u5217\u8868\u5f53\u4e2d\uff0c\u5373\u5c06\u6dfb\u52a0\u5230\u4e0b\u8f7d\u5217\u8868\u4e2d",e),this._urls.unshift(e));var i=this._callbacks.get(e);i?i.push(t):this._callbacks.set(e,[t]),this._loadRes(this._urls[0])}},Object.defineProperty(t.prototype,"canLoadview",{get:function(){return!cc.sys.isBrowser||a.network.state===a.NetworkState.ONLINE},enumerable:!0,configurable:!0}),t.prototype._loadRes=function(e){var t=this;if(e)if(this.canLoadview){if(this._state!=i.LOADING){var o=cc.loader.getRes(e,this._assetsType);o?this._$loadComplete(e,o):(this._state=i.LOADING,cc.loader.loadRes(e,this._assetsType,function(o,n){if(o||!n){if(cc.log("[AssetsLoader] \u4e0b\u8f7d\u5931\u8d25"+e,o),!t.canLoadview)return void(t._state=i.WAIT);var r=t._urls.indexOf(e);return r>=0&&(t._urls.splice(r,1),t._urls.push(e)),void t._loadRes(t._urls[0])}t._$loadComplete(e,n)}))}}else this._state=i.WAIT},t.prototype._$loadComplete=function(e,t){this._state=i.WAIT;var o=this._callbacks.get(e);o&&(this._callbacks.delete(e),o.forEach(function(e){e(t)}));var n=this._urls.indexOf(e);n>=0&&this._urls.splice(n,1),this._urls.length>0?this._loadRes(this._urls[0]):this.complete&&this.complete()},t.prototype.netchangeHandler=function(){this._state==i.WAIT&&this.canLoadview&&this._urls.length>0&&this._loadRes(this._urls[0])},t}(r.EventDispatcher);o.AssetsLoader=s,cc._RF.pop()},{"../event/EventDispatcher":"EventDispatcher","../net/Network":"Network","../util/HashMap":"HashMap"}],AssetsQueueLoader:[function(e,t,o){"use strict";cc._RF.push(t,"7d14cQOwoBOtawhsF2hifrh","AssetsQueueLoader"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(){}return e.loadResArrayDir=function(e,t,o){var n=[],i=[],r=cc.loader._resources;r||(r=cc.loader._assetTables.assets);for(var a=0;a<e.length;a++){for(var c=e[a],s=[],l=r.getUuidArray(c,null,s),u=0;u<s.length;u++)n.push(s[u]);for(var p=0;p<l.length;p++)i.push(l[p])}var d=[],h=0,f={},g=!1;cc.loader._loadResUuids(i,function(e,n,r){if(r.error&&d.push(r.error),n=Math.max(n,i.length),f[r.url]=!0,e=Object.keys(f).length,t){var a=e/n;h<a&&(h=a),h>1&&(h=1),t(h,r)}if(e>=n){if(g)return;g=!0,o&&(d.length>0?o(d,[]):o(null,[]))}},function(e,t){g||(g=!0,o&&(e?o(e,t):d.length>0?o(d,t):o(null,t)))},n)},e}();o.AssetsQueueLoader=n,cc._RF.pop()},{}],AstarHoneycombRoadSeeker:[function(e,t,o){"use strict";cc._RF.push(t,"470f8oyv3xHR719BwQrvDie","AstarHoneycombRoadSeeker"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(e){this.COST_STRAIGHT=10,this.COST_DIAGONAL=10,this.maxStep=1e3,this._round1=[[0,-1],[1,-1],[1,0],[0,1],[-1,0],[-1,-1]],this._round2=[[0,-1],[1,0],[1,1],[0,1],[-1,1],[-1,0]],this.handle=-1,this.optimize=!0,this._roadNodes=e}return e.prototype.seekPath=function(e,t){if(this._startNode=e,this._currentNode=e,this._targetNode=t,!this._startNode||!this._targetNode)return[];if(1==this._targetNode.value)return console.log("\u76ee\u6807\u4e0d\u53ef\u8fbe\u5230\uff1a"),[];this._openlist=[],this._closelist=[];for(var o=0;;){if(o>this.maxStep)return console.log("\u6ca1\u627e\u5230\u76ee\u6807\u8ba1\u7b97\u6b65\u9aa4\u4e3a\uff1a",o),[];if(o++,this.searchRoundNodes(this._currentNode),0==this._openlist.length)return console.log("\u6ca1\u627e\u5230\u76ee\u6807\u8ba1\u7b97\u6b65\u9aa4\u4e3a\uff1a",o),[];if(this._openlist.sort(this.sortNode),this._currentNode=this._openlist.shift(),this._currentNode==this._targetNode)return console.log("\u627e\u5230\u76ee\u6807\u8ba1\u7b97\u6b65\u9aa4\u4e3a\uff1a",o),this.getPath();this._closelist.push(this._currentNode)}return[]},e.prototype.seekPath2=function(e,t){if(this._startNode=e,this._currentNode=e,this._targetNode=t,!this._startNode||!this._targetNode)return[];this._openlist=[],this._closelist=[];for(var o=0,n=null;;){if(o>this.maxStep)return console.log("\u6ca1\u627e\u5230\u76ee\u6807\u8ba1\u7b97\u6b65\u9aa4\u4e3a\uff1a",o),this.seekPath(e,n);if(o++,this.searchRoundNodes(this._currentNode),0==this._openlist.length)return console.log("\u6ca1\u627e\u5230\u76ee\u6807\u8ba1\u7b97\u6b65\u9aa4\u4e3a\uff1a",o),this.seekPath(e,n);if(this._openlist.sort(this.sortNode),this._currentNode=this._openlist.shift(),null==n?n=this._currentNode:this._currentNode.h<n.h&&(n=this._currentNode),this._currentNode==this._targetNode)return console.log("\u627e\u5230\u76ee\u6807\u8ba1\u7b97\u6b65\u9aa4\u4e3a\uff1a",o),this.getPath();this._closelist.push(this._currentNode)}return this.seekPath(e,n)},e.prototype.sortNode=function(e,t){return e.f<t.f?-1:e.f>t.f?1:0},e.prototype.getPath=function(){for(var e,t,o,n=[],i=this._targetNode;i!=this._startNode;)n.unshift(i),i=i.parent;if(n.unshift(this._startNode),!this.optimize)return n;for(var r=1;r<n.length-1;r++){e=n[r-1],t=n[r],o=n[r+1];var a=!1,c=null;2==Math.abs(o.cx-e.cx)&&e.cy==o.cy&&(c=t.cx%2==0?t.cy==e.cy?this._roadNodes[t.cx+"_"+(t.cy+1)]:this._roadNodes[t.cx+"_"+(t.cy-1)]:t.cy==e.cy?this._roadNodes[t.cx+"_"+(t.cy-1)]:this._roadNodes[t.cx+"_"+(t.cy+1)]),c&&(a=1!=c.value),a&&(n.splice(r,1),r--)}for(r=1;r<n.length-1;r++){e=n[r-1],t=n[r],o=n[r+1];var s=t.cx==e.cx&&t.cx==o.cx,l=t.cy==e.cy&&t.cy==o.cy&&e.cx%2==t.cx%2&&t.cx%2==o.cx%2,u=e.cy-Math.floor(e.cx/2)==t.cy-Math.floor(t.cx/2)&&t.cy-Math.floor(t.cx/2)==o.cy-Math.floor(o.cx/2),p=e.cy+Math.ceil(e.cx/2)==t.cy+Math.ceil(t.cx/2)&&t.cy+Math.ceil(t.cx/2)==o.cy+Math.ceil(o.cx/2);(s||l||u||p)&&(n.splice(r,1),r--)}return n},e.prototype.testSeekPathStep=function(e,t,o,n,i){var r=this;if(void 0===i&&(i=100),this._startNode=e,this._currentNode=e,this._targetNode=t,1!=this._targetNode.value){this._openlist=[],this._closelist=[];var a=0;clearInterval(this.handle),this.handle=setInterval(function(){return a>r.maxStep?(console.log("\u6ca1\u627e\u5230\u76ee\u6807\u8ba1\u7b97\u6b65\u9aa4\u4e3a\uff1a",a),void clearInterval(r.handle)):(a++,r.searchRoundNodes(r._currentNode),0==r._openlist.length?(console.log("\u6ca1\u627e\u5230\u76ee\u6807\u8ba1\u7b97\u6b65\u9aa4\u4e3a\uff1a",a),void clearInterval(r.handle)):(r._openlist.sort(r.sortNode),r._currentNode=r._openlist.shift(),void(r._currentNode==r._targetNode?(console.log("\u627e\u5230\u76ee\u6807\u8ba1\u7b97\u6b65\u9aa4\u4e3a\uff1a",a),clearInterval(r.handle),o.apply(n,[r._startNode,r._targetNode,r._currentNode,r._openlist,r._closelist,r.getPath()])):(r._closelist.push(r._currentNode),o.apply(n,[r._startNode,r._targetNode,r._currentNode,r._openlist,r._closelist,null])))))},i)}},e.prototype.searchRoundNodes=function(e){var t;t=e.cx%2==0?this._round1:this._round2;for(var o=0;o<t.length;o++){var n=e.cx+t[o][0],i=e.cy+t[o][1],r=this._roadNodes[n+"_"+i];null==r||r==this._startNode||1==r.value||this.isInCloseList(r)||this.setNodeF(r)}},e.prototype.setNodeF=function(e){var t;if(t=e.cx==this._currentNode.cx||e.cy==this._currentNode.cy?this._currentNode.g+this.COST_STRAIGHT:this._currentNode.g+this.COST_DIAGONAL,this.isInOpenList(e)){if(!(t<e.g))return;e.g=t}else e.g=t,this._openlist.push(e);e.parent=this._currentNode,e.h=(Math.abs(this._targetNode.cx-e.cx)+Math.abs(this._targetNode.cy-e.cy))*this.COST_STRAIGHT,e.f=e.g+e.h},e.prototype.isInOpenList=function(e){return-1!=this._openlist.indexOf(e)},e.prototype.isInCloseList=function(e){return-1!=this._closelist.indexOf(e)},e.prototype.inInCorner=function(e){if(e.cx==this._currentNode.cx||e.cy==this._currentNode.cy)return!1;var t=this._roadNodes[this._currentNode.cx+"_"+e.cy],o=this._roadNodes[e.cx+"_"+this._currentNode.cy];return null==t||0!=t.value||null==o||0!=o.value},e.prototype.dispose=function(){this._roadNodes=null,this._round1=null,this._round2=null},e}();o.default=n,cc._RF.pop()},{}],AsyncQueue:[function(e,t,o){"use strict";cc._RF.push(t,"a6f36QhYL1Dlp0z+aogVSxK","AsyncQueue"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(){this._runningAsyncTask=null,this._queues=[],this._isProcessingTaskUUID=0,this._enable=!0,this.complete=null}return Object.defineProperty(e.prototype,"queues",{get:function(){return this._queues},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enable",{get:function(){return this._enable},set:function(e){this._enable!==e&&(this._enable=e,e&&this.size>0&&this.play())},enumerable:!0,configurable:!0}),e.prototype.push=function(t,o){void 0===o&&(o=null);var n=e._$uuid_count++;return this._queues.push({uuid:n,callbacks:[t],params:o}),n},e.prototype.pushMulti=function(t){for(var o=[],n=1;n<arguments.length;n++)o[n-1]=arguments[n];var i=e._$uuid_count++;return this._queues.push({uuid:i,callbacks:o,params:t}),i},e.prototype.remove=function(e){if(this._runningAsyncTask.uuid!==e){for(var t=0;t<this._queues.length;t++)if(this._queues[t].uuid===e){this._queues.splice(t,1);break}}else cc.warn("\u6b63\u5728\u6267\u884c\u7684\u4efb\u52a1\u4e0d\u53ef\u4ee5\u79fb\u9664")},Object.defineProperty(e.prototype,"size",{get:function(){return this._queues.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isProcessing",{get:function(){return this._isProcessingTaskUUID>0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isStop",{get:function(){return!(this._queues.length>0)&&!this.isProcessing},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"runningParams",{get:function(){return this._runningAsyncTask?this._runningAsyncTask.params:null},enumerable:!0,configurable:!0}),e.prototype.clear=function(){this._queues=[],this._isProcessingTaskUUID=0,this._runningAsyncTask=null},e.prototype.next=function(e,t){void 0===t&&(t=null),this._isProcessingTaskUUID===e?(this._isProcessingTaskUUID=0,this._runningAsyncTask=null,this.play(t)):this._runningAsyncTask&&cc.log(this._runningAsyncTask)},e.prototype.step=function(){this.isProcessing&&this.next(this._isProcessingTaskUUID)},e.prototype.play=function(e){var t=this;if(void 0===e&&(e=null),!this.isProcessing&&this._enable){var o=this._queues.shift();if(o){this._runningAsyncTask=o;var n=o.uuid;this._isProcessingTaskUUID=n;var i=o.callbacks;if(1==i.length){var r=function(e){void 0===e&&(e=null),t.next(n,e)};i[0](r,o.params,e)}else for(var a=i.length,c=[],s=(r=function(e){void 0===e&&(e=null),--a,c.push(e||null),0===a&&t.next(n,c)},a),l=0;l<s;l++)i[l](r,o.params,e)}else this._isProcessingTaskUUID=0,this._runningAsyncTask=null,this.complete&&this.complete(e)}},e.prototype.yieldTime=function(e,t){void 0===t&&(t=null);this.push(function(o,n,i){var r=setTimeout(function(){clearTimeout(r),t&&t(),o(i)},e)},{des:"AsyncQueue.yieldTime"})},e.excuteTimes=function(e,t){void 0===t&&(t=null);var o=e;return function(){0==--o&&t&&t()}},e._$uuid_count=1,e}();o.AsyncQueue=n,cc._RF.pop()},{}],AudioImp:[function(e,t,o){"use strict";cc._RF.push(t,"50b79QDINlDJbO1PrU37gyi","AudioImp"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(){this.tag="AudioImp"}return e.prototype.play=function(e,t,o,n){void 0===n&&(n=null),console.log(22,e);var i=cc.loader.getRes(e,cc.AudioClip);if(i){var r=cc.audioEngine.play(i,t,o);return n&&cc.audioEngine.setFinishCallback(r,n),r}cc.error("["+this.tag+"] play "+e+" \u97f3\u4e50\u8d44\u6e90\u4e0d\u5b58\u5728\uff01")},e.prototype.setVolume=function(e,t,o){void 0===o&&(o=null),cc.audioEngine.setVolume(e,t),o&&o(e)},e.prototype.getVolume=function(e){return cc.audioEngine.getVolume(e)},e.prototype.stop=function(e,t){void 0===t&&(t=null),cc.audioEngine.stop(e),t&&t(e)},e.prototype.fade=function(e,t,o,n,i){var r=this;void 0===i&&(i=null);cc.tween({volume:t}).to(n,{volume:o},{progress:function(t,o,n,i){var r=t+(o-t)*i;cc.audioEngine.setVolume(e,r)}}).start().call(function(){cc.log("["+r.tag+"] "+e+" fade from = "+t+" to = "+o+" \u5b8c\u6210 "),i&&i(e)})},e.prototype.pause=function(e){cc.audioEngine.pause(e)},e.prototype.resume=function(e){cc.audioEngine.resume(e)},e.prototype.isPlaying=function(e){return cc.audioEngine.getState(e)===cc.audioEngine.AudioState.PLAYING},e.prototype.pauseAll=function(){cc.audioEngine.pauseAll()},e.prototype.resumeAll=function(){cc.audioEngine.resumeAll()},e}();o.AudioImp=n,cc._RF.pop()},{}],AudioMessage:[function(e,t,o){"use strict";cc._RF.push(t,"eeba39WbpZCCpGfSCfTCXtb","AudioMessage"),Object.defineProperty(o,"__esModule",{value:!0}),function(e){e.BGM="bgm",e.BGM2="bgm2",e.EFFECT="effect",e.BUILD_EFFECT="build_effect"}(o.AudioMessage||(o.AudioMessage={})),cc._RF.pop()},{}],Audio:[function(e,t,o){"use strict";cc._RF.push(t,"c5fa9q3s9xDGaJkgGZtoH+v","Audio");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i=e("../event/EventDispatcher"),r=e("./AudioImp"),a="audio_volume",c="effect_volume",s="MUSIC_SWITCH",l="EFFECT_SWITCH",u="game_audio",p=.5,d=function(e){function t(){var t=e.call(this)||this;t.curMusic={},t.effectDict={},t.todoMusicUrl=null,t._audioEngine=null,t._audioLocalObj={},t.effectVolume=0;var o=cc.sys.localStorage.getItem(u);if(o)try{t._audioLocalObj=JSON.parse(o)}catch(e){t._audioLocalObj={}}return t._audioLocalObj.hasOwnProperty(a)?t._audioLocalObj[a]<p&&(t._audioLocalObj[a]=p,t._audioLocalObj[c]=p):(t._audioLocalObj[a]=p,t._audioLocalObj[c]=p),t._audioLocalObj.hasOwnProperty(s)||(t._audioLocalObj[s]=!0),t._audioLocalObj.hasOwnProperty(l)||(t._audioLocalObj[l]=!0),t}return n(t,e),Object.defineProperty(t.prototype,"audioEngine",{get:function(){return this._audioEngine||(this._audioEngine=new r.AudioImp),this._audioEngine},enumerable:!0,configurable:!0}),t.prototype.save=function(){var e=JSON.stringify(this._audioLocalObj);cc.sys.localStorage.setItem(u,e)},t.prototype.setMusicVolume=function(e,t){void 0===t&&(t=!0),null!=this.curMusic.id&&this.audioEngine.setVolume(this.curMusic.id,e),t&&(this._audioLocalObj[a]=e,this.setEffectsVolume(1*e),this.save())},t.prototype.getMusicVolume=function(){return this.getAudioSwitch()?this._audioLocalObj[a]:0},t.prototype.getEffectVolume=function(){return this.effectSwitch?this._audioLocalObj[c]:0},t.prototype.setAudioSwitch=function(e){this.musicSwitch=e,this.effectSwitch=e},t.prototype.getAudioSwitch=function(){return this.musicSwitch},Object.defineProperty(t.prototype,"musicSwitch",{get:function(){return this._audioLocalObj[s]},set:function(e){if(this._audioLocalObj[s]=e,this.save(),e){this.todoMusicUrl&&null==this.curMusic.id&&this.playMusic(this.todoMusicUrl);var t=this.getMusicVolume();this.setMusicVolume(t,!1)}else this.todoMusicUrl=this.curMusic.url,this.setMusicVolume(0,!1)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"effectSwitch",{get:function(){return this._audioLocalObj[l]},set:function(e){if(this._audioLocalObj[l]=e,this.save(),e){var t=this.getEffectVolume();this.setEffectsVolume(t)}else this.setEffectsVolume(0)},enumerable:!0,configurable:!0}),t.prototype.transMusicSwitch=function(){},t.prototype.playMusic=function(e,o,n){var i=this;if(void 0===o&&(o=!0),void 0===n&&(n=null),this.curMusic.url==e&&o)return-1;return null!=this.curMusic.id&&this.stopMusic(),function(){try{var r=i.playMusicWithFade(e,o,i.getMusicVolume(),t.FadeDuration,n);return i.curMusic={id:r,url:e},r}catch(e){cc.warn(e)}}(),0},t.prototype.playMusicWithFade=function(e,t,o,n,i){void 0===i&&(i=null);var r=this.audioEngine.play(e,t,0,i);return this.audioEngine.fade(r,0,o,n,function(t){i&&i(e)}),r},t.prototype.stopMusicWithFade=function(e,t){void 0===t&&(t=null);var o=this.curMusic.id,n=this.curMusic.url;this.audioEngine.fade(o,this.getMusicVolume(),0,e,function(e){t&&t(n)})},t.prototype.pauseMusictWithFade=function(){var e=this;this.curMusic.id&&this.audioEngine.fade(this.curMusic.id,this.getMusicVolume(),0,t.FadeDuration,function(t){e.audioEngine.pause(e.curMusic.id),e.curMusic.paused=!0})},t.prototype.resumeMusicWithFade=function(e){this.curMusic.id?this.curMusic.paused&&(this.audioEngine.resume(this.curMusic.id),this.audioEngine.fade(this.curMusic.id,0,this.getMusicVolume(),t.FadeDuration),this.curMusic.paused=!1):this.playMusic(e,!0)},t.prototype.pauseMusic=function(){null!=this.curMusic.id&&this.audioEngine.pause(this.curMusic.id)},t.prototype.resumeMusic=function(){null!=this.curMusic.id&&this.audioEngine.resume(this.curMusic.id)},t.prototype.stopMusic=function(){this.todoMusicUrl=null,this.stopMusicWithFade(t.FadeDuration)},t.prototype.stopMusicWithout=function(){null!=this.curMusic.id&&(this.stopMusicWithFade(t.FadeDuration),this.curMusic={})},t.prototype.playEffect=function(e,t,o){void 0===t&&(t=!1),void 0===o&&(o=null);try{var n=this.audioEngine.play(e,t,this.getEffectVolume(),function(){o&&o(e)});return this.effectDict[n]={id:n,url:e,timer:null},n}catch(e){cc.warn(e)}return 0},t.prototype.pauseEffectWithFade=function(e){var o=this,n=this.getEffectInfo(e);n&&(n.isPause=!0,this.audioEngine.fade(n.id,this.getMusicVolume(),0,t.FadeDuration,function(e){o.audioEngine.pause(n.id),n.isFadePauseing=!0}))},t.prototype.resumeEffectWithFade=function(e){var o=this.getEffectInfo(e);o?(this.audioEngine.resume(o.id),this.audioEngine.fade(o.id,0,this.getMusicVolume(),t.FadeDuration)):this.playMusic(e,!0)},t.prototype.stopEffectWithFade=function(e){var o=this,n=this.getEffectInfo(e);n&&this.audioEngine.fade(n.id,this.getMusicVolume(),0,t.FadeDuration,function(){o.stopEffect(n.id)})},t.prototype.setEffectVolume=function(e,t){var o=this.getEffectInfo(e);o&&this.audioEngine.setVolume(o.id,t)},t.prototype.playEffectWithFade=function(e,o,n){void 0===n&&(n=null);var i=null;return this.getEffectInfo(e)?(i=this.getEffectInfo(e).id,this.audioEngine.setVolume(i,this.getMusicVolume(),function(){n&&n(e)})):(i=this.playEffect(e,o),this.audioEngine.fade(i,0,this.getMusicVolume(),t.FadeDuration,function(){n&&n(e)})),i},t.prototype.pauseEffect=function(e){for(var t in this.effectDict){var o=this.effectDict[t];o.id!=e&&o.url!=e||(o.isPause=!0,this.audioEngine.pause(o.id))}},t.prototype.resumeEffect=function(e){for(var t in this.effectDict){var o=this.effectDict[t];o.id!=e&&o.url!=e||!o.isPause||(o.isPause=!1,this.audioEngine.resume(o.id),this.audioEngine.setVolume(o.id,this.getEffectVolume()))}},t.prototype.getEffectInfo=function(e){for(var t in this.effectDict)if(this.effectDict[t].url==e||this.effectDict[t].id==e)return this.effectDict[t];return null},t.prototype.stopEffect=function(e){for(var t in this.effectDict){var o=this.effectDict[t];o.id!=e&&o.url!=e||(this.audioEngine.stop(o.id),delete this.effectDict[t])}},t.prototype.stopAllEffects=function(){for(var e in this.effectDict){var t=this.effectDict[e];this.audioEngine.stop(t.id)}this.effectDict={}},t.prototype.setEffectsVolume=function(e){for(var t in this.effectDict)this.audioEngine.setVolume(parseInt(t),e)},t.prototype.setOneEffectVolume=function(e,t){for(var o in this.effectDict)o==e.toString()&&this.audioEngine.setVolume(e,t)},t.prototype.resumeAll=function(){this.audioEngine.resumeAll()},t.prototype.stopEffectWithFade20=function(e){var o=this.getEffectInfo(e);o&&this.audioEngine.fade(o.id,this.getMusicVolume(),.2*this.getMusicVolume(),t.FadeDuration,function(){})},t.prototype.halfMusicVolmue=function(){null!=this.curMusic.id&&this.audioEngine.setVolume(this.curMusic.id,this.getMusicVolume()/2)},t.prototype.resumeMusicVolmue=function(){null!=this.curMusic.id&&this.audioEngine.setVolume(this.curMusic.id,this.getMusicVolume())},t.prototype.pauseAll=function(){this.audioEngine.pauseAll()},t.prototype.findEffectByUrl=function(e){for(var t in this.effectDict)for(var o in this.effectDict[t])if(this.effectDict[t][o]==e)return t;return""},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.stopAllEffects(),this.curMusic.id&&this._audioEngine.stop(this.curMusic.id),this.curMusic=null,this.effectDict=null,this._audioEngine=null},t.FadeDuration=1,t}(i.EventDispatcher);o.Audio=d,cc._RF.pop()},{"../event/EventDispatcher":"EventDispatcher","./AudioImp":"AudioImp"}],BTActionGreet:[function(e,t,o){"use strict";cc._RF.push(t,"cd4f0pVewpMC793UUZZsiM8","BTActionGreet");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../../core/behaviorTree/BTAction"),r=e("../../../core/behaviorTree/BTNode"),a=e("../BTreeEntity"),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.getDatabase=function(){return this.database},t.prototype.Enter=function(){cc.log("\u5f00\u59cb\u6253\u62db\u547c")},t.prototype.Exit=function(){cc.log("\u7ed3\u675f\u6253\u62db\u547c")},t.prototype.Execute=function(){var e=this,t=this.getDatabase().nearestNpcDatabase;return t?(this.getDatabase().npcState.msg!=a.MsgState.GREET&&(this.getDatabase().npcState.msg=a.MsgState.GREET,t.npcMsg.receiveId=1101,t.npcState.msg=a.MsgState.REPLY_WAIT,setTimeout(function(){e.getDatabase().npcMsg.sendId=0,e.getDatabase().npcState.msg=a.MsgState.NONE;var t=e.getDatabase().nearestNpcDatabase;t&&(t.npcMsg.receiveId=1101,t.npcState.msg=a.MsgState.REPLY,e.getDatabase().nearestNpcDatabase=null)},2e3)),r.BTResult.Running):r.BTResult.Ended},t}(i.BTAction);o.BTActionGreet=c,cc._RF.pop()},{"../../../core/behaviorTree/BTAction":"BTAction","../../../core/behaviorTree/BTNode":"BTNode","../BTreeEntity":"BTreeEntity"}],BTActionIdle:[function(e,t,o){"use strict";cc._RF.push(t,"e2ae3SCh5NKK5YSZP9RiwEY","BTActionIdle");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../../core/behaviorTree/BTAction"),r=e("../../../map/charactor/Charactor"),a=e("../../../core/behaviorTree/BTNode"),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.getDatabase=function(){return this.database},t.prototype.Enter=function(){cc.log("\u5f00\u59cb IDLE"),this.getDatabase().npc.state=r.CharactorState.stand},t.prototype.Exit=function(){cc.log("\u7ed3\u675f IDLE")},t.prototype.Execute=function(){return a.BTResult.Running},t}(i.BTAction);o.BTActionIdle=c,cc._RF.pop()},{"../../../core/behaviorTree/BTAction":"BTAction","../../../core/behaviorTree/BTNode":"BTNode","../../../map/charactor/Charactor":"Charactor"}],BTActionReply:[function(e,t,o){"use strict";cc._RF.push(t,"30ce7dakudAoZ9lGTIdXbyX","BTActionReply");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../../core/behaviorTree/BTAction"),r=e("../BTreeEntity"),a=e("../../../core/behaviorTree/BTNode"),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.getDatabase=function(){return this.database},t.prototype.Enter=function(){cc.log("\u5f00\u59cb\u56de\u590d")},t.prototype.Exit=function(){cc.log("\u7ed3\u675f\u56de\u590d")},t.prototype.Execute=function(){var e=this;return 0==this.getDatabase().npcMsg.receiveId||this.getDatabase().npcState.msg!=r.MsgState.REPLY?a.BTResult.Ended:(setTimeout(function(){e.getDatabase().npcMsg.receiveId=0,e.getDatabase().npcState.msg=r.MsgState.NONE},1111),a.BTResult.Running)},t}(i.BTAction);o.BTActionReply=c,cc._RF.pop()},{"../../../core/behaviorTree/BTAction":"BTAction","../../../core/behaviorTree/BTNode":"BTNode","../BTreeEntity":"BTreeEntity"}],BTActionWalk:[function(e,t,o){"use strict";cc._RF.push(t,"c9ceaU4ZDFEypJyos9qvoOR","BTActionWalk");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../../core/behaviorTree/BTAction"),r=e("../../../core/behaviorTree/BTNode"),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.getDatabase=function(){return this.database},t.prototype.Enter=function(){cc.log("\u5f00\u59cb walk")},t.prototype.Exit=function(){cc.log("\u7ed3\u675f walk")},t.prototype.Execute=function(){return r.BTResult.Running},t}(i.BTAction);o.BTActionWalk=a,cc._RF.pop()},{"../../../core/behaviorTree/BTAction":"BTAction","../../../core/behaviorTree/BTNode":"BTNode"}],BTAction:[function(e,t,o){"use strict";cc._RF.push(t,"69a74t2wopBspshZBa1O1DE","BTAction");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i,r=e("./BTNode");(function(e){e[e.Ready=1]="Ready",e[e.Running=2]="Running"})(i=o.BTActionStatus||(o.BTActionStatus={}));var a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._status=i.Ready,t}return n(t,e),t.prototype.Enter=function(){},t.prototype.Exit=function(){},t.prototype.Execute=function(){return r.BTResult.Running},t.prototype.Clear=function(){this._status!=i.Ready&&(this.Exit(),this._status=i.Ready)},t.prototype.Tick=function(){var e=r.BTResult.Ended;return this._status==i.Ready&&(this.Enter(),this._status=i.Running),this._status==i.Running&&(e=this.Execute())!=r.BTResult.Running&&(this.Exit(),this._status=i.Ready),e},t.prototype.AddChild=function(e){cc.error("BTAction: Cannot add a node into BTAction.")},t.prototype.RemoveChild=function(e){cc.error("BTAction: Cannot remove a node into BTAction.")},t}(r.BTNode);o.BTAction=a,cc._RF.pop()},{"./BTNode":"BTNode"}],BTConditions:[function(e,t,o){"use strict";cc._RF.push(t,"ad11dBcZ3BHI5iQawzvtLcn","BTConditions");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../core/behaviorTree/BTPrecondition"),r=e("./BTreeEntity"),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.getDatabase=function(){return this.database},t.prototype.Check=function(){var e=this.getDatabase().npcMsg.receiveId;return this.getDatabase().npcState.msg==r.MsgState.REPLY&&e>0},t}(i.BTPrecondition);o.BTConditionReceiveMsg=a;var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.getDatabase=function(){return this.database},t.prototype.Check=function(){if(this.getDatabase().npcState.msg!=r.MsgState.NONE)return!1;this.getDatabase().nearestNpcDatabase=null;for(var e=null,t=9999999,o=r.BTNPCDatabase.npcDatabases,n=this.getDatabase().npc,i=0;i<o.length;i++)if(o[i].npc.uuid!=n.uuid&&o[i].npcState.msg==r.MsgState.NONE){var a=o[i].npc.node.x-n.node.x,c=o[i].npc.node.y-n.node.y,s=a*a+c*c;s<200&&s<t&&(t=s,e=o[i])}return!!e&&(this.getDatabase().nearestNpcDatabase=e,!0)},t}(i.BTPrecondition);o.BTConditionLookAround=c;var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.getDatabase=function(){return this.database},t.prototype.Check=function(){var e=this.getDatabase().idleTime;do{if(0==e){e=Date.now()+3e3*Math.random();break}if(e<=Date.now()&&Math.random()<.22){e=Date.now()+1e3+3e3*Math.random();break}}while(0);return this.getDatabase().idleTime=e,e>Date.now()},t}(i.BTPrecondition);o.BTConditionIDLE=s;var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.getDatabase=function(){return this.database},t.prototype.Check=function(){var e=this.getDatabase();return e.walkTarget?(e.sceneMap.movePlayer(e.npc,e.walkTarget.x,e.walkTarget.y),e.walkTarget=null,!0):!!e.npc.moving},t}(i.BTPrecondition);o.BTPreConditionWalk=l,cc._RF.pop()},{"../../core/behaviorTree/BTPrecondition":"BTPrecondition","./BTreeEntity":"BTreeEntity"}],BTDatabase:[function(e,t,o){"use strict";cc._RF.push(t,"6d0ac7La+xHEIXHMIGWSw3E","BTDatabase"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.GetDataId=function(e){return 0},e.prototype.GetData=function(e){return 0},e}();o.BTDatabase=n,cc._RF.pop()},{}],BTNode:[function(e,t,o){"use strict";var n;cc._RF.push(t,"29e2eFhq15FCrpuEcvzXipU","BTNode"),Object.defineProperty(o,"__esModule",{value:!0}),function(e){e[e.Ended=1]="Ended",e[e.Running=2]="Running"}(n=o.BTResult||(o.BTResult={}));var i=function(){function e(e){this._children=null,this.precondition=null,this.database=null,this.interval=0,this._lastTimeEvaluated=0,this.activated=!1,this.precondition=e}return Object.defineProperty(e.prototype,"children",{get:function(){return this._children},enumerable:!0,configurable:!0}),e.prototype.Activate=function(e){if(this.database=e,this.precondition&&this.precondition.Activate(e),this._children)for(var t=0,o=this._children;t<o.length;t++){o[t].Activate(e)}this.activated=!0},e.prototype.Evaluate=function(){var e=this.CheckTimer();return this.activated&&e&&(!this.precondition||this.precondition.Check())&&this.DoEvaluate()},e.prototype.DoEvaluate=function(){return!0},e.prototype.Tick=function(){return n.Ended},e.prototype.Clear=function(){},e.prototype.AddChild=function(e){this._children||(this._children=[]),e&&this._children.push(e)},e.prototype.RemoveChild=function(e){if(this._children&&e){var t=this._children.indexOf(e);t>=0&&this._children.splice(t,1)}},e.prototype.CheckTimer=function(){var e=Date.now();return e-this._lastTimeEvaluated>this.interval&&(this._lastTimeEvaluated=e,!0)},e}();o.BTNode=i,cc._RF.pop()},{}],BTParallelFlexible:[function(e,t,o){"use strict";cc._RF.push(t,"18a34YhUuBGlq7S3O/15+ny","BTParallelFlexible");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i=e("./BTNode"),r=function(e){function t(t){var o=e.call(this,t)||this;return o._activeList=[],o._children=[],o}return n(t,e),t.prototype.DoEvaluate=function(){for(var e=0,t=0;t<this._children.length;t++){this._children[t].Evaluate()?(this._activeList[t]=!0,e++):this._activeList[t]=!1}return 0!=e},t.prototype.Tick=function(){for(var e=0,t=0;t<this._children.length;t++){if(this._activeList[t])this._children[t].Tick()==i.BTResult.Running&&e++}return 0==e?i.BTResult.Ended:i.BTResult.Running},t.prototype.AddChild=function(t){e.prototype.AddChild.call(this,t),this._activeList.push(!1)},t.prototype.RemoveChild=function(t){var o=this._children.indexOf(t);o>=0&&this._activeList.splice(o,1),e.prototype.RemoveChild.call(this,t)},t.prototype.Clear=function(){e.prototype.Clear.call(this);for(var t=0,o=this._children;t<o.length;t++){o[t].Clear()}},t}(i.BTNode);o.BTParallelFlexible=r,cc._RF.pop()},{"./BTNode":"BTNode"}],BTParallel:[function(e,t,o){"use strict";cc._RF.push(t,"12170hXXSdIEIQ1Ih+Rh5HG","BTParallel");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i,r=e("./BTNode");(function(e){e[e.And=1]="And",e[e.Or=2]="Or"})(i=o.BTParallelFunction||(o.BTParallelFunction={}));var a=function(e){function t(t,o){var n=e.call(this,o)||this;return n._func=i.Or,n._results=[],n._func=t,n._children=[],n}return n(t,e),t.prototype.DoEvaluate=function(){if(this._children)for(var e=0,t=this._children;e<t.length;e++){if(!t[e].Evaluate())return!1}return!0},t.prototype.Tick=function(){for(var e=0,t=0;t<this._children.length;t++)if(this._func==i.And)this._results[t]==r.BTResult.Running&&(this._results[t]=this._children[t].Tick()),this._results[t]!=r.BTResult.Running&&e++;else if(this._results[t]==r.BTResult.Running&&(this._results[t]=this._children[t].Tick()),this._results[t]!=r.BTResult.Running)return this.ResetResults(),r.BTResult.Ended;return e==this._children.length?(this.ResetResults(),r.BTResult.Ended):r.BTResult.Running},t.prototype.Clear=function(){this.ResetResults();for(var e=0,t=this._children;e<t.length;e++){t[e].Clear()}},t.prototype.AddChild=function(t){t&&(e.prototype.AddChild.call(this,t),this._results.push(r.BTResult.Running))},t.prototype.RemoveChild=function(t){var o=this._children.indexOf(t);o>=0&&this._results.splice(o,1),e.prototype.RemoveChild.call(this,t)},t.prototype.ResetResults=function(){for(var e=0;e<this._results.length;e++)this._results[e]=r.BTResult.Running},t}(r.BTNode);o.BTParallel=a,cc._RF.pop()},{"./BTNode":"BTNode"}],BTPrecondition:[function(e,t,o){"use strict";cc._RF.push(t,"b116elwx/xJvL+iHg5MID/H","BTPrecondition");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i,r=e("./BTNode");(function(e){e[e.LessThan=1]="LessThan",e[e.GreaterThan=2]="GreaterThan",e[e.EqualTo=3]="EqualTo"})(i||(i={}));var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.Check=function(){return!1},t.prototype.Tick=function(){return this.Check()?r.BTResult.Ended:r.BTResult.Running},t}(r.BTNode);o.BTPrecondition=a;var c=function(e){function t(t){var o=e.call(this)||this;return o._dataToCheck=t,o}return n(t,e),t.prototype.Activate=function(t){e.prototype.Activate.call(this,t),this._dataIdToCheck=t.GetDataId(this._dataToCheck)},t}(a);o.BTPreconditionUseDB=c;var s=function(e){function t(t,o,n){var i=e.call(this,t)||this;return i.rhs=o,i.func=n,i}return n(t,e),t.prototype.Check=function(){var e=this.database.GetData(this._dataIdToCheck);switch(this.func){case i.LessThan:return e<this.rhs;case i.GreaterThan:return e>this.rhs;case i.EqualTo:return e==this.rhs;default:return!1}},t}(c);o.BTPreconditionFloat=s,cc._RF.pop()},{"./BTNode":"BTNode"}],BTPrioritySelector:[function(e,t,o){"use strict";cc._RF.push(t,"f86d3mbF8NBw5H5rNhmamXk","BTPrioritySelector");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i=e("./BTNode"),r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._activeChild=null,t}return n(t,e),t.prototype.DoEvaluate=function(){for(var e=0,t=this._children;e<t.length;e++){var o=t[e];if(o.Evaluate())return this._activeChild&&this._activeChild!=o&&this._activeChild.Clear(),this._activeChild=o,!0}return this._activeChild&&(this._activeChild.Clear(),this._activeChild=null),!1},t.prototype.Clear=function(){this._activeChild&&(this._activeChild.Clear(),this._activeChild=null)},t.prototype.Tick=function(){if(!this._activeChild)return i.BTResult.Ended;var e=this._activeChild.Tick();return e!=i.BTResult.Running&&(this._activeChild.Clear(),this._activeChild=null),e},t}(i.BTNode);o.BTPrioritySelector=r,cc._RF.pop()},{"./BTNode":"BTNode"}],BTSequence:[function(e,t,o){"use strict";cc._RF.push(t,"38effvfnlxFzJdE2JPBMBGA","BTSequence");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i=e("./BTNode"),r=function(e){function t(t){var o=e.call(this,t)||this;return o._activeChild=null,o._activeIndex=-1,o._children=[],o}return n(t,e),t.prototype.DoEvaluate=function(){if(this._activeChild){var e=this._activeChild.Evaluate();return e||(this._activeChild.Clear(),this._activeChild=null,this._activeIndex=-1),e}return this._children.length>0&&this.children[0].Evaluate()},t.prototype.Tick=function(){null==this._activeChild&&(this._activeChild=this._children[0],this._activeIndex=0);var e=this._activeChild.Tick();return e==i.BTResult.Ended&&(this._activeIndex++,this._activeIndex>=this._children.length?(this._activeChild.Clear(),this._activeChild=null,this._activeIndex=-1):(this._activeChild.Clear(),this._activeChild=this._children[this._activeIndex],e=i.BTResult.Running)),e},t.prototype.Clear=function(){null!=this._activeChild&&(this._activeChild=null,this._activeIndex=-1);for(var e=0,t=this._children;e<t.length;e++){t[e].Clear()}},t}(i.BTNode);o.BTSequence=r,cc._RF.pop()},{"./BTNode":"BTNode"}],BTreeEntity:[function(e,t,o){"use strict";cc._RF.push(t,"be890WzIXRFm7r0p73dtao5","BTreeEntity");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i,r=e("../../core/behaviorTree/BTDatabase"),a=e("../../core/behaviorTree/BTPrioritySelector"),c=e("./actions/BTActionIdle"),s=e("./BTConditions"),l=e("./actions/BTActionWalk"),u=function(){function e(){this.database=null,this.btree=null,this.btree=new a.BTPrioritySelector;var e=new l.BTActionWalk(new s.BTPreConditionWalk),t=new c.BTActionIdle(new s.BTPreConditionWalk);this.btree.AddChild(t),this.btree.AddChild(e)}return e.prototype.Tick=function(){this.btree&&(this.btree.Activate(this.database),this.btree.Tick())},e}();o.BTreeEntity=u,function(e){e[e.NONE=0]="NONE",e[e.GREET=1]="GREET",e[e.REPLY_WAIT=2]="REPLY_WAIT",e[e.REPLY=2]="REPLY"}(i=o.MsgState||(o.MsgState={}));var p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.npcState={msg:i.NONE},t.sceneMap=null,t.npc=null,t.walkTarget=null,t.nearestNpcDatabase=null,t.idleTime=0,t.npcMsg={receiveId:0,sendId:0},t}return n(t,e),t.npcDatabases=[],t}(r.BTDatabase);o.BTNPCDatabase=p,cc._RF.pop()},{"../../core/behaviorTree/BTDatabase":"BTDatabase","../../core/behaviorTree/BTPrioritySelector":"BTPrioritySelector","./BTConditions":"BTConditions","./actions/BTActionIdle":"BTActionIdle","./actions/BTActionWalk":"BTActionWalk"}],BalloonAnim:[function(e,t,o){"use strict";cc._RF.push(t,"eb6faDW1BlLiqNIxzTXPjyl","BalloonAnim");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../../core/event/MessageManager"),a=e("../../../core/ui/ComponentExtends"),c=e("../../AudioMessage"),s=cc._decorator,l=s.ccclass,u=s.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id=1,t.isAction=!1,t}return n(t,e),t.prototype.onLoad=function(){var e=this.node.getComponent(sp.Skeleton);this.node.parent.on(cc.Node.EventType.TOUCH_END,this.action.bind(this),this),e.setAnimation(0,"reward_"+this.id+"_idle",!0)},t.prototype.action=function(){var e=this;if(this.node._touchListener&&this.node._touchListener.setSwallowTouches(!1),!this.isAction){this.isAction=!0,r.Message.dispatchEvent(c.AudioMessage.EFFECT,"wind");var t=this.node.getComponent(sp.Skeleton);t.setCompleteListener(function(o){o.animation.name=="reward_"+e.id&&(t.setAnimation(0,"reward_"+e.id+"_idle",!0),e.scheduleOnce(function(){t.setAnimation(0,"reward_"+e.id,!1)},5))}),t.setAnimation(0,"reward_"+this.id,!1)}},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},i([u],t.prototype,"id",void 0),t=i([l],t)}(a.ComponentExtends);o.default=p,cc._RF.pop()},{"../../../core/event/MessageManager":"MessageManager","../../../core/ui/ComponentExtends":"ComponentExtends","../../AudioMessage":"AudioMessage"}],BirdAnimLeft:[function(e,t,o){"use strict";cc._RF.push(t,"d445bBda1xNO66c1a1BQ97Y","BirdAnimLeft");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../../core/ui/ComponentExtends"),a=cc._decorator,c=a.ccclass,s=a.property,l=[cc.v2(-2484,-326),cc.v2(-2446,-1598)],u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.duration=10,t.cutDownTime=3,t.getRandom=function(e,t){return Math.random()*(t-e)+e},t.getRandomNum=function(e,t){return Math.round(Math.random()*(t-e)+e)},t}return n(t,e),t.prototype.onLoad=function(){this.action()},t.prototype.action=function(){var e=this,t=cc.v2(this.getRandom(l[0].x,l[1].x),this.getRandom(l[0].y,l[1].y));this.node.setPosition(t),this.node.RunAction(ezaction.moveTo(this.duration,{x:t.x+5024,y:t.y+4157})).onStoped(function(){e.scheduleOnce(function(){e.action()},e.cutDownTime)})},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},i([s],t.prototype,"duration",void 0),i([s({tooltip:"\u95f4\u9694\u65f6\u95f4"})],t.prototype,"cutDownTime",void 0),t=i([c],t)}(r.ComponentExtends);o.default=u,cc._RF.pop()},{"../../../core/ui/ComponentExtends":"ComponentExtends"}],BirdAnimRight:[function(e,t,o){"use strict";cc._RF.push(t,"1d49ee5YKlET4WJol3gtTUq","BirdAnimRight");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../../core/ui/ComponentExtends"),a=cc._decorator,c=a.ccclass,s=a.property,l=[cc.v2(2019,-2076),cc.v2(3372,-836)],u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.duration=10,t.cutDownTime=3,t.getRandom=function(e,t){return Math.random()*(t-e)+e},t.getRandomNum=function(e,t){return Math.round(Math.random()*(t-e)+e)},t}return n(t,e),t.prototype.onLoad=function(){this.action()},t.prototype.action=function(){var e=this,t=cc.v2(this.getRandom(l[0].x,l[1].x),this.getRandom(l[0].y,l[1].y));this.node.setPosition(t),this.node.RunAction(ezaction.moveTo(this.duration,{x:t.x-5309,y:t.y+2943})).onStoped(function(){e.scheduleOnce(function(){e.action()},e.cutDownTime)})},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},i([s],t.prototype,"duration",void 0),i([s({tooltip:"\u95f4\u9694\u65f6\u95f4"})],t.prototype,"cutDownTime",void 0),t=i([c],t)}(r.ComponentExtends);o.default=u,cc._RF.pop()},{"../../../core/ui/ComponentExtends":"ComponentExtends"}],ButtonEffectAnim:[function(e,t,o){"use strict";cc._RF.push(t,"0f79eI190pDzaafNjyihRlR","ButtonEffectAnim");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("./ButtonEffect"),a=cc._decorator,c=a.ccclass,s=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.range=5,t}return n(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this);var t=this.node.getPosition();this.scaleDownAction=cc.moveTo(this.duration,t.x,t.y-this.range),this.scaleUpAction=cc.moveTo(this.duration,t.x,t.y+this.range)},i([s],t.prototype,"range",void 0),t=i([c],t)}(r.default);o.default=l,cc._RF.pop()},{"./ButtonEffect":"ButtonEffect"}],ButtonEffectSprite:[function(e,t,o){"use strict";cc._RF.push(t,"27b72D0VmFG973HzXUa0N7u","ButtonEffectSprite");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("./ButtonEffect"),a=cc._decorator,c=a.ccclass,s=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.stateSpr=[],t}return n(t,e),Object.defineProperty(t.prototype,"canTouch",{get:function(){return this._canTouch},set:function(e){this._canTouch=e,this.node.getComponent(cc.Sprite).spriteFrame=this._canTouch?this.stateSpr[0]:this.stateSpr[1]},enumerable:!0,configurable:!0}),i([s({type:cc.SpriteFrame,tooltip:"\u72b6\u6001sprite"})],t.prototype,"stateSpr",void 0),t=i([c],t)}(r.default);o.default=l,cc._RF.pop()},{"./ButtonEffect":"ButtonEffect"}],ButtonEffect:[function(e,t,o){"use strict";cc._RF.push(t,"1be36hrGO5Oz6Eapg6ygW03","ButtonEffect");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../../Main"),a=e("../../Engine"),c=e("./ButtonSimple"),s=cc._decorator,l=s.ccclass,u=s.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.disabledeffect=!1,t.duration=.1,t.scale=.95,t.sourceScaleX=1,t.sourceScaleY=1,t.scaleDownAction=null,t.scaleUpAction=null,t.startTime=1,t._canTouch=!0,t.touchStartCallback=null,t.touchEndCallback=null,t}var o;return n(t,e),o=t,Object.defineProperty(t.prototype,"canTouch",{get:function(){return this._canTouch},set:function(e){this._canTouch=e},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){this.sourceScaleX=this.node.scaleX,this.sourceScaleY=this.node.scaleY,this.scaleDownAction=cc.scaleTo(this.duration,this.scale*this.sourceScaleX,this.scale*this.sourceScaleY),this.scaleUpAction=cc.scaleTo(this.duration,this.sourceScaleX,this.sourceScaleY),this.startTime=1,e.prototype.onLoad.call(this)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this),this.touchEndCallback=null,this.touchStartCallback=null,this.scaleDownAction=null,this.scaleUpAction=null},t.prototype.onTouchtStart=function(t){if(!this.disabledeffect){if(r.default.module.vm.isMoving)return a.default.log.info(this.node.name+"ButtonEffect,onTouchtStart"),void(this.node._touchListener&&this.node._touchListener.setSwallowTouches(!1));((new Date).getTime()-this.startTime>400&&0!=this.startTime||1==Math.abs(this.node.scaleX)&&1==Math.abs(this.node.scaleY))&&(this.node.stopAllActions(),this._canTouch&&(this.node.runAction(this.scaleDownAction),this.touchStartCallback&&this.touchStartCallback(this),o.default.touchStartCallback&&o.default.touchStartCallback(this))),e.prototype.onTouchtStart.call(this,t)}},t.prototype.onTouchEnd=function(t){if(!this.disabledeffect){if(r.default.module.vm.isMoving)return this.node._touchListener&&this.node._touchListener.setSwallowTouches(!1),void a.default.log.info(this.node.name+"ButtonEffect,onTouchEnd");this.node.stopAllActions(),this.startTime=(new Date).getTime();this.node.getComponent(cc.Button);this.node.runAction(this.scaleUpAction),e.prototype.onTouchEnd.call(this,t),this.touchEndCallback&&this.touchEndCallback(this),o.default.touchEndCallback&&o.default.touchEndCallback(this)}},t.default={},i([u({tooltip:"\u662f\u5426\u5f00\u542f"})],t.prototype,"disabledeffect",void 0),i([u({tooltip:"\u6309\u94ae\u52a8\u753b\u64ad\u653e\u65f6\u95f4"})],t.prototype,"duration",void 0),i([u({tooltip:"\u6309\u94ae\u52a8\u753b\u7f29\u653e\u6bd4\u4f8b"})],t.prototype,"scale",void 0),t=o=i([l],t)}(c.default);o.default=p,cc._RF.pop()},{"../../../Main":"Main","../../Engine":"Engine","./ButtonSimple":"ButtonSimple"}],ButtonGear:[function(e,t,o){"use strict";cc._RF.push(t,"e49dazdnd9GqZWqfkD68MnR","ButtonGear");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("./ButtonEffect"),a=cc._decorator,c=a.ccclass,s=(a.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._currentFrameIndex=0,t}return n(t,e),Object.defineProperty(t.prototype,"currentFrameIndex",{get:function(){return this._currentFrameIndex},set:function(e){this._currentFrameIndex=e,e>this.node.children.length-1&&(this._currentFrameIndex=0)},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.onEnable=function(){},t.prototype.onDisable=function(){},t.prototype.onTouchEnd=function(t){this.canTouch&&(e.prototype.onTouchEnd.call(this,t),this.currentFrameIndex++)},t=i([c],t)}(r.default));o.default=s,cc._RF.pop()},{"./ButtonEffect":"ButtonEffect"}],ButtonMulti:[function(e,t,o){"use strict";cc._RF.push(t,"7c3c1J9I7BHBrTGxefBGo24","ButtonMulti");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("./ButtonEffect"),a=cc._decorator,c=a.ccclass,s=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.normalFrame=null,t.pressedFrame=null,t.hoverFrame=null,t.disabledFrame=null,t.isPressed=!1,t.isHover=!1,t}return n(t,e),Object.defineProperty(t.prototype,"spriteFrame",{get:function(){return this.node.getComponent(cc.Sprite).spriteFrame},set:function(e){this.node.getComponent(cc.Sprite).spriteFrame=e},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.node.on(cc.Node.EventType.MOUSE_MOVE,this.onMouseMove,this),this.node.on(cc.Node.EventType.MOUSE_LEAVE,this.onMouseLeave,this)},t.prototype.onEnable=function(){this.changeState()},t.prototype.onDisable=function(){this.isHover=!1,this.changeState()},t.prototype.onMouseMove=function(e){this.canTouch&&(this.isHover=!0,this.changeState())},t.prototype.onMouseLeave=function(e){this.canTouch&&(this.isHover=!1,this.changeState())},t.prototype.onTouchtStart=function(t){this.canTouch&&(e.prototype.onTouchtStart.call(this,t),this.isPressed=!0,this.changeState())},t.prototype.onTouchEnd=function(t){this.canTouch&&(e.prototype.onTouchEnd.call(this,t),this.isPressed=!1,this.changeState())},t.prototype.changeState=function(){this.enabled?this.isPressed?this.spriteFrame=this.pressedFrame:this.isHover?this.spriteFrame=this.hoverFrame:this.spriteFrame=this.normalFrame:this.spriteFrame=this.disabledFrame},i([s(cc.SpriteFrame)],t.prototype,"normalFrame",void 0),i([s(cc.SpriteFrame)],t.prototype,"pressedFrame",void 0),i([s(cc.SpriteFrame)],t.prototype,"hoverFrame",void 0),i([s(cc.SpriteFrame)],t.prototype,"disabledFrame",void 0),t=i([c],t)}(r.default);o.default=l,cc._RF.pop()},{"./ButtonEffect":"ButtonEffect"}],ButtonSelect:[function(e,t,o){"use strict";cc._RF.push(t,"f3938wI0j9OTIcSBcHc25Gv","ButtonSelect");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r,a=e("./SpriteSelect"),c=cc._decorator,s=c.ccclass;c.property;(function(e){e.CHANGE="ButtonSelectEvent.CHANGE"})(r=o.ButtonSelectEvent||(o.ButtonSelectEvent={}));var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this)},t.prototype.onTouchEnd=function(){this.state=!this.state,this.node.dispatchEvent(new cc.Event.EventCustom(r.CHANGE,!0))},t=i([s],t)}(a.SpriteSelect);o.ButtonSelect=l,cc._RF.pop()},{"./SpriteSelect":"SpriteSelect"}],ButtonSimple:[function(e,t,o){"use strict";cc._RF.push(t,"8d645yObX1FvJfk2sbi0rxp","ButtonSimple");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../Engine"),a=cc._decorator,c=a.ccclass,s=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.once=!1,t.interval=5,t.reflectCallback="",t.touchCount=0,t.touchtEndTime=0,t}return n(t,e),t.prototype.onLoad=function(){this.onListen()},t.prototype.onTouchtStart=function(e){},t.prototype.onTouchEnd=function(e){if(this.once){if(this.touchCount>0)return void e.stopPropagation();this.touchCount++}this.touchtEndTime&&r.default.timer.getTime()-this.touchtEndTime<this.interval?(e.stopPropagation(),cc.warn("\u9632\u8fde\u70b9\u4e8b\u4ef6\u89e6\u53d1")):this.touchtEndTime=r.default.timer.getTime()},t.prototype.onDestroy=function(){this.reflectCallback=null,this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchtStart,this),this.node.off(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},t.prototype.onListen=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchtStart,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},i([s({tooltip:"\u662f\u5426\u53ea\u80fd\u89e6\u53d1\u4e00\u6b21"})],t.prototype,"once",void 0),i([s({tooltip:"\u6bcf\u6b21\u89e6\u53d1\u95f4\u9694"})],t.prototype,"interval",void 0),i([s({tooltip:"\u56de\u8c03\u65b9\u6cd5\u540d\u79f0"})],t.prototype,"reflectCallback",void 0),t=i([c],t)}(cc.Component);o.default=l,cc._RF.pop()},{"../../Engine":"Engine"}],ButtonSprite:[function(e,t,o){"use strict";cc._RF.push(t,"ddba3EPFgdKEplX7pStUcVQ","ButtonSprite");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("./ButtonSimple"),a=cc._decorator,c=a.ccclass,s=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.normal=null,t.pressed=null,t}return n(t,e),t.prototype.onTouchtStart=function(e){this.enabled&&(this.node.getComponent(cc.Sprite).spriteFrame=this.pressed)},t.prototype.onTouchEnd=function(t){this.enabled&&(this.node.getComponent(cc.Sprite).spriteFrame=this.normal,e.prototype.onTouchEnd.call(this,t))},i([s({type:cc.SpriteFrame,tooltip:"\u666e\u901a\u72b6\u6001\u4e0b\u6309\u94ae\u6240\u663e\u793a\u7684\u56fe\u7247"})],t.prototype,"normal",void 0),i([s({type:cc.SpriteFrame,tooltip:"\u6309\u4e0b\u72b6\u6001\u65f6\u6309\u94ae\u6240\u663e\u793a\u7684\u56fe\u7247"})],t.prototype,"pressed",void 0),t=i([c],t)}(r.default);o.default=l,cc._RF.pop()},{"./ButtonSimple":"ButtonSimple"}],ButtonSwitch:[function(e,t,o){"use strict";cc._RF.push(t,"a7adaa/R7JDJpwDR8Y6tAnW","ButtonSwitch");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,a=r.ccclass,c=r.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.trueBg=null,t.falseBg=null,t.trueBtnBg=null,t.falseBtnBg=null,t.truePos=0,t.falsePos=0,t.bg=null,t.btn=null,t.canTouch=!0,t._state=!1,t.onChange=null,t}return n(t,e),Object.defineProperty(t.prototype,"state",{get:function(){return this._state},set:function(e){this._state=e,this.refresh(),this.onChange&&this.onChange(e)},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){this.refresh(),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this)},t.prototype.refresh=function(){this.btn.getComponent(cc.Sprite).spriteFrame=this.state?this.trueBtnBg:this.falseBtnBg,this.bg.spriteFrame=this.state?this.trueBg:this.falseBg,this.btn.x=this.state?this.truePos:this.falsePos},t.prototype.onTouchEnd=function(){this.canTouch&&(this.state=!this.state)},i([c({type:cc.SpriteFrame,tooltip:"true\u72b6\u6001\u4e0b\u7684\u80cc\u666f"})],t.prototype,"trueBg",void 0),i([c({type:cc.SpriteFrame,tooltip:"false\u72b6\u6001\u4e0b\u7684\u80cc\u666f"})],t.prototype,"falseBg",void 0),i([c({type:cc.SpriteFrame,tooltip:"true\u72b6\u6001\u4e0b\u6309\u94ae\u7684\u80cc\u666f"})],t.prototype,"trueBtnBg",void 0),i([c({type:cc.SpriteFrame,tooltip:"false\u72b6\u6001\u4e0b\u6309\u94ae\u7684\u80cc\u666f"})],t.prototype,"falseBtnBg",void 0),i([c({type:cc.Float,tooltip:"true\u72b6\u6001\u4e0b\u6309\u94ae\u7684\u4f4d\u7f6e"})],t.prototype,"truePos",void 0),i([c({type:cc.Float,tooltip:"false\u72b6\u6001\u4e0b\u6309\u94ae\u7684\u4f4d\u7f6e"})],t.prototype,"falsePos",void 0),i([c({type:cc.Sprite,tooltip:"\u80cc\u666f"})],t.prototype,"bg",void 0),i([c({type:cc.Node,tooltip:"\u6309\u94ae"})],t.prototype,"btn",void 0),i([c({tooltip:"\u662f\u5426\u80fd\u70b9\u51fb"})],t.prototype,"canTouch",void 0),t=i([a],t)}(cc.Component);o.ButtonSwitch=s,cc._RF.pop()},{}],ButtonTouchLong:[function(e,t,o){"use strict";cc._RF.push(t,"da96en7WYpPTaPIkO1l/Nux","ButtonTouchLong");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("./ButtonEffect");(function(e){e.LONG_TOUCH="ButtonTouchLongEvent.LONG_TOUCH"})(o.ButtonTouchLongEvent||(o.ButtonTouchLongEvent={}));var a=cc._decorator,c=a.ccclass,s=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.time=1,t._isTouchLong=!0,t._passTime=0,t._event=null,t.longTouchCallback=null,t}return n(t,e),Object.defineProperty(t.prototype,"isLongTouch",{get:function(){return this._isTouchLong},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){this._isTouchLong=!1,e.prototype.onLoad.call(this)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this),this._event=null,this.longTouchCallback=null},t.prototype.onTouchtStart=function(t){this.canTouch&&(this._event=t,this._passTime=0,e.prototype.onTouchtStart.call(this,t))},t.prototype.onTouchEnd=function(t){this.canTouch&&(this._passTime>this.time&&t.stopPropagation(),this._event=null,this._passTime=0,this._isTouchLong=!1,e.prototype.onTouchEnd.call(this,t))},t.prototype.removeTouchLong=function(){this._event=null,this._isTouchLong=!1},t.prototype.update=function(e){this.canTouch&&this._event&&!this._isTouchLong&&(this._passTime+=e,this._passTime>=this.time&&(this._isTouchLong=!0,this.longTouchCallback(this._event),this.removeTouchLong()))},i([s({tooltip:"\u957f\u6309\u65f6\u95f4"})],t.prototype,"time",void 0),t=i([c],t)}(r.default);o.ButtonTouchLong=l,cc._RF.pop()},{"./ButtonEffect":"ButtonEffect"}],CalcTool:[function(e,t,o){"use strict";cc._RF.push(t,"8d6b0l3VJpE8aVatdPQRSPp","CalcTool"),Object.defineProperty(o,"__esModule",{value:!0}),function(e){e[e.muti=1]="muti",e[e.uplv=2]="uplv",e[e.collect=3]="collect",e[e.fame=4]="fame"}(o.ClerkReward||(o.ClerkReward={})),function(e){e[e.muti=1]="muti",e[e.uplv=2]="uplv",e[e.raiseLv=3]="raiseLv",e[e.fame=4]="fame"}(o.fameReward||(o.fameReward={}));var n=function(){function e(e){this.themeConfig=null,this.themeConfig=e}return e.prototype.compare=function(e,t){if(0==e.numE&&0==t.numE)return Math.floor(e.num)>=Math.floor(t.num);var o=[e.num,e.numE],n=[t.num,t.numE],i=(Math.floor(o[0])+"").split("").length-1,r=(Math.floor(n[0])+"").split("").length-1;return o[0]=o[0]/Math.pow(10,i),n[0]=n[0]/Math.pow(10,r),o[1]=o[1]+i,n[1]=n[1]+r,0==e.numE&&0==t.numE?e.num>=t.num:e.num>0&&t.num<0||!(e.num<0&&t.num>0)&&(o[1]>n[1]||o[1]==n[1]&&o[0]>=n[0])},e.prototype.compareLess=function(e,t){if(0==e.numE&&0==t.numE)return Math.floor(e.num)<=Math.floor(t.num);var o=[e.num,e.numE],n=[t.num,t.numE],i=(Math.floor(o[0])+"").split("").length-1,r=(Math.floor(n[0])+"").split("").length-1;return o[0]=o[0]/Math.pow(10,i),n[0]=n[0]/Math.pow(10,r),o[1]=o[1]+i,n[1]=n[1]+r,0==e.numE&&0==t.numE?e.num<=t.num:e.num<0&&t.num>0||!(e.num>0&&t.num<0)&&(o[1]<n[1]||o[1]==n[1]&&o[0]<=n[0])},e.prototype.produce=function(e){var t="";switch(e){case 0:t="";break;case 1:t="K";break;case 2:t="m";break;case 3:t="B";break;case 4:t="T";break;default:for(var o=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"][(e-5)%52],n=Math.ceil((e-4)/52)+1,i=0;i<n;i++)t+=o}return t},e.prototype.formatNum=function(e,t){if(void 0===t&&(t=!0),e.numE<3&&t){var o=Math.floor(e.num*Math.pow(10,e.numE));e={num:Number(o.toFixed(0)),numE:0}}var n=this.calcConvertNum(e.num,e.numE),i=n.num,r=n.num.toString().indexOf("99999");-1!=r&&(i=Number(n.num.toFixed(r-1)));var a=n.numE;if(0==i)return{base:0,gear:""};if(a<0){for(var c={num:i,numE:a};c.numE<0;)c.num/=10,c.numE+=1;return{base:Math.floor(c.num),gear:""}}if(a<3&&t)return{base:Math.floor(e.num),gear:""};i<0&&cc.warn("\u8d1f\u6570\u4e0d\u53efformat");var s=(Math.floor(i)+"").split("").length-1,l=Math.floor((a+s)/3),u=i*Math.pow(10,a-3*l),p=i.toString().split(".");p&&p.length>1&&(u=Number(p[0])*Math.pow(10,a-3*l)+Number("0."+p[1])*Math.pow(10,a-3*l));var d=this.produce(l),h=3;return d.split("").length>2&&(h=2),""==d&&t?{base:Math.floor(u),gear:""}:{base:function(e,t){if(void 0===t&&(t=3),e.toString().split(".")[1]){for(var o=e.toString().split(".")[0].split("").length,n=e.toString().substr(0,o+1+t),i=n.split(".")[1].split(""),r=i.length-1;r>=0&&"0"==i[r];r--)i.splice(r,1);var a=0==i.length?"":".";return parseFloat(""+n.split(".")[0]+a+i.join(""))}return e}(u,h),gear:d}},e.prototype.calcConvertNum=function(e,t){var o={num:e,numE:t};if(666==e&&cc.log(o),0!=e&&e>0){for(;o.num>10;)o.num=o.num/10,o.numE=o.numE+1;for(;o.num<1;)o.num=10*o.num,o.numE=o.numE-1}return o},e.prototype.calcAddNum=function(e,t,o){void 0===o&&(o=!0);var n=e.num,i=e.numE,r=t.num,a=t.numE;if(0==i&&o&&(n=Math.floor(n)),0==a&&o&&(r=Math.floor(r)),i<3&&a<3&&o){var c=Math.floor(n*Math.pow(10,i)),s=Math.floor(r*Math.pow(10,a));return{num:Number((c+s).toFixed(0)),numE:0}}if(0==r);else if(0==n)i=a;else{for(;i>a;)a++,r/=10;for(;i<a;)i++,n/=10}return this.calcConvertNum(n+r,i)},e.prototype.calcMinusNum=function(e,t,o){void 0===o&&(o=!0);var n=e.num,i=e.numE,r=t.num,a=t.numE;if(0==i&&o&&(n=Math.floor(n)),0==a&&o&&(r=Math.floor(r)),i<3&&a<3&&o){var c=Math.floor(n*Math.pow(10,i)),s=Math.floor(r*Math.pow(10,a));return{num:Number((c-s).toFixed(0)),numE:0}}if(0==r)return e;if(0==e.num)return{num:-t.num,numE:t.numE};for(;i>a;)a++,r/=10;for(;i<a;)i++,n/=10;return this.calcConvertNum(n-r,i)},e.prototype.calcDivideNum=function(e,t){return 0==e.num?{num:0,numE:0}:0!==t.num?this.calcConvertNum(e.num/t.num,e.numE-t.numE):e},e.prototype.calcMutiNum=function(e,t){return this.calcConvertNum(e.num*t.num,e.numE+t.numE)},e.prototype.sort=function(e){e.sort(function(e,t){return e<t?-1:e>t?1:0})},e}();o.CalcTool=n,cc._RF.pop()},{}],CalcUiShow:[function(e,t,o){"use strict";cc._RF.push(t,"3d472U3NJ1GfrgKeyZAGzOc","CalcUiShow"),Object.defineProperty(o,"__esModule",{value:!0});var n,i=e("../core/Engine"),r=e("../core/util/HashMap"),a=e("../Main"),c=function(){function e(e,t){this.themeConfig=null,this.calcTool=null,this.nextRefreshDate=null,this.nextRefreshStoreListDate=null,this.themeConfig=e,this.calcTool=t,this.nextRefreshDate=this.getSeverCurrentTime()+2e3,this.nextRefreshStoreListDate=this.getSeverCurrentTime()+2e3}return e.prototype.getTimeStageReward=function(e){var t=a.default.module.gamedata.rewardTotalAvg;return this.calcTool.calcMutiNum(t,{num:e,numE:0})},e.prototype.refreshCredit=function(e,t,o){void 0===o&&(o=!1);var n=a.default.module.vm,i=this.getCreditInfo(e),r=function(){n.credit=i.credit,n.win=i.win,n.winTotal=i.winTotal,n.refreshCreditUi=n.credit,t&&t()},c=this.getSeverCurrentTime();c>=this.nextRefreshDate||o?(this.nextRefreshDate=c+2e3,r(),a.default.module.gameProtocol.requestAccountChange(i,function(e){})):r()},e.prototype.getSeverCurrentTime=function(){var e=i.default.timer.serverTimeElasped();return(new Date).getTime()+e},e.prototype.refreshReturnRewardTime=function(e,t){void 0===t&&(t=!1);var o=a.default.module.vm,n=this.getSeverCurrentTime();n>=this.nextRefreshStoreListDate||t?(this.nextRefreshStoreListDate=n+2e3,o.storeList=e,a.default.module.gameProtocol.sendStoreList(e,function(e){})):o.storeList=e},e.prototype.getCreditInfo=function(e){var t=a.default.module.vm,o=this.calcTool.calcAddNum(t.credit,e),n=this.calcTool.calcAddNum(t.win,e),i=this.calcTool.calcAddNum(t.winTotal,e);if(e.num<0){var r={num:-e.num,numE:e.numE};o=this.calcTool.calcMinusNum(t.credit,r),n=t.win,i=t.winTotal}return{credit:o,win:n,winTotal:i}},e.prototype.refreshFame=function(e,t){var o=a.default.module.vm,n=this.getFameInfo(e),i=function(){o.fame=n.fame,t&&t()};i&&i(),a.default.module.gameProtocol.requestAccountChange(n,function(e){})},e.prototype.getFameInfo=function(e){var t=a.default.module.vm,o=a.default.module.calcTool.calcAddNum(t.fame,e);if(e.num<0){var n={num:-e.num,numE:e.numE};o=this.calcTool.calcMinusNum(t.fame,n)}return{fame:o}},e.prototype.sellStores=function(e){var t=a.default.module.vm,o={num:0,numE:0},n={};n.credit=o,n.win=o,n.winTotal=t.winTotal,n.level=t.level+1;var i=function(){t.credit=n.credit,t.win=n.win,t.winTotal=n.winTotal,t.refreshCreditUi=t.credit,e&&e()};i&&i(),a.default.module.gameProtocol.requestAccountChange(n,function(e){})},e.prototype.calcTargetPrice=function(e,t,o){var n=1;if(a.default.module.vm.clerkList){var i="clerk_"+parseInt(e.split("_")[1]),r=a.default.module.vm.clerkList[i].level,c=this.themeConfig.getClerkConfigBytagLv(i,r),s=1;c&&(s=c.clerkLevelUpCostDiv),n*=s}if(a.default.module.vm.fameList){var l="fame_"+parseInt(e.split("_")[1]),u=a.default.module.vm.fameList[l].level,p=this.themeConfig.getFameConfigByTagLv(l,u),d=1;p&&(d=p.levelUpCostDiv),n*=d}for(var h={num:0,numE:0},f=1;f<=o;f++){var g=this.themeConfig.getStoreLvConfigByTag(e,t+f);if(!g)break;h=this.calcTool.calcAddNum(h,{num:g.price,numE:g.priceE},!1)}var m=a.default.module.gameMainControl.propCostAdd;return this.calcTool.calcMutiNum(h,{num:n*m,numE:0})},e.prototype.calcCollectSpeed=function(e){var t=this;void 0===e&&(e=1);var o=a.default.module.vm.storeList,n=a.default.module.vm.clerkList,i=a.default.module.vm.fameList,c=new r.HashMap;for(var s in o){for(var l=new r.HashMap,u=this.themeConfig.getStoreBaseConfigByTag(s),p=u.reward,d=u.timeStamp,h=o[s].level,f=this.themeConfig.getStoreSpeedLvConfigByTag(s),g=f.keys(),m=0,v=0;v<g.length;v++)if(h<g[v]){0!=v&&(m=g[v-1]);break}h>=this.themeConfig.getStoreMaxLvById(f.get(g[0]).id)&&(m=g[g.length-1]);var _={num:p*h,numE:0};if(0!=m){_=this.calcTool.calcConvertNum(_.num,_.numE);var y=this.themeConfig.getStoreSpeedLvConfigByTag(s).get(m),b=this.calcTool.calcMutiNum(_,{num:y.multiTotal,numE:y.multiTotalE}),C=d/y.timeDivTotal;l.set("reward",b),l.set("timeStamp",C)}else l.set("reward",_),l.set("timeStamp",d);0==h&&(_={num:0,numE:0},l.set("reward",_),l.set("timeStamp",0)),c.set(s,l)}var T=new r.HashMap;if(n)for(var s in n){var S=this.themeConfig.getClerkConfigBytagLv(s,n[s].level);if(S){var E={num:S.clerkMultiTotal,numE:S.clerkMultiTotalE};T.set(s,E)}else T.set(s,{num:1,numE:0})}var L=new r.HashMap;if(i)for(var s in i){var w=this.themeConfig.getFameConfigByTagLv(s,i[s].level);if(w){E={num:w.multiTotal,numE:w.multiTotalE};L.set(s,E)}else L.set(s,{num:1,numE:0})}T.keys().forEach(function(e){var o=parseInt(e.split("_")[1]);if(o<11){var n=t.calcTool.calcMutiNum(c.get("store_"+o).get("reward"),T.get(e));c.get("store_"+o).set("reward",n)}else{c.keys().forEach(function(o){var n=t.calcTool.calcMutiNum(c.get(o).get("reward"),T.get(e));c.get(o).set("reward",n)})}}),L.keys().forEach(function(e){var o=parseInt(e.split("_")[1]);if(o<11){var n=t.calcTool.calcMutiNum(c.get("store_"+o).get("reward"),L.get(e));c.get("store_"+o).set("reward",n)}else{c.keys().forEach(function(o){var n=t.calcTool.calcMutiNum(c.get(o).get("reward"),L.get(e));c.get(o).set("reward",n)})}});var k=a.default.module.gamedata.storesIdLv.values();this.sort(k);var P=this.themeConfig.getStoreSpeedLvConfigByTag("store_11"),N=P.keys(),A={num:1,numE:0},O=1,I=0;for(v=0;v<N.length;v++){if(k[0]<N[v]){if(v>0){var R=P.get(N[v-1]);A={num:R.multiTotal,numE:R.multiTotalE},O=R.timeDivTotal}break}I=v}if(I===N.length-1){var M=P.get(N[N.length-1]);O=M.timeDivTotal}var x=c.keys(),B=a.default.module.calcTool.calcAddNum(this.rewardAdd(),{num:1,numE:0},!1),D={num:1,numE:0};a.default.module.vm.goodsInfo&&(D={num:a.default.module.vm.goodsInfo.multiTotal,numE:a.default.module.vm.goodsInfo.multiTotalE}),x.forEach(function(e){var o=t.calcTool.calcMutiNum(c.get(e).get("reward"),A),n=t.calcTool.calcMutiNum(o,B),i=t.calcTool.calcMutiNum(n,D),r=c.get(e).get("timeStamp")/O;c.get(e).set("reward",i),c.get(e).set("timeStamp",r)}),c.keys().forEach(function(o){var n=c.get(o).get("reward");n=t.calcTool.calcMutiNum(n,{num:e,numE:0}),c.get(o).set("reward",n)}),1!=e&&cc.log("\u901f\u5ea6\u8ba1\u7b97:\u9053\u5177\u63d0\u5347\u901f\u5ea6"+e+"\u500d");var F="",j="";c.keys().forEach(function(e){var o=c.get(e).get("reward"),n=t.calcTool.formatNum(o),i=c.get(e).get("timeStamp");if(i<100&&0!=i){var r=t.calcTool.calcMutiNum(o,{num:1e3/i,numE:0});c.get(e).set("rewardAvg",r);var a=t.calcTool.formatNum(r);j+=e+" =>"+a.base+a.gear+"/s\n"}F+=e+" =>"+n.base+n.gear+"/"+i+"\n"}),cc.log("\u3010\u6240\u6709\u5e97\u94fa\u6536\u96c6\u901f\u5ea6\u3011"+F,"timeStamp<100\u7684\u6536\u96c6\u901f\u5ea6"+j);var U=new r.HashMap,H={num:0,numE:0};c.keys().forEach(function(e){var o=c.get(e),n=o.get("reward"),i=o.get("timeStamp"),r={num:0,numE:0},s=parseInt(e.split("_")[1]),l=0;a.default.module.vm.clerkList&&(l=a.default.module.vm.clerkList["clerk_"+s].level),r=0==i||0==l?{num:0,numE:0}:{num:1e3*n.num/o.get("timeStamp"),numE:n.numE},H=t.calcTool.calcAddNum(H,r,!1)}),U.set("reward",H),U.set("timeStamp",1e3),a.default.module.gamedata.rewardTotalAvg=U.get("reward");var V=this.calcTool.formatNum(U.get("reward"));return cc.log("\u3010\u5e73\u5747\u6536\u96c6\u901f\u5ea6 =>"+V.base+V.gear+"/\u6bcf\u79d2\u3011"),a.default.module.gamedata.storeBaseRewardList=c,c},e.prototype.calcCollectSpeedSupport=function(e,t){for(var o=this,n=a.default.module.gameMainControl.mainAdMuti*a.default.module.themeConfig.getBuildingConfigById(a.default.module.vm.level).multi,i=a.default.module.gameMainControl.propMutiAdd*n,c=e,s=a.default.module.vm.clerkList,l=a.default.module.vm.fameList,u=new r.HashMap,p="store_"+t,d=this.themeConfig.getStoreBaseConfigByTag(p),h=d.reward,f=d.timeStamp,g=c[p].level,m=this.themeConfig.getStoreSpeedLvConfigByTag(p),v=0,_=m.keys(),y=0;y<_.length;y++)if(g<_[y]){0!=y&&(v=_[y-1]);break}g>=this.themeConfig.getStoreMaxLvById(m.get(_[0]).id)&&(v=_[_.length-1]);var b={num:h*g,numE:0};if(0!=v){b=this.calcTool.calcConvertNum(b.num,b.numE);var C=this.themeConfig.getStoreSpeedLvConfigByTag(p).get(v),T=this.calcTool.calcMutiNum(b,{num:C.multiTotal,numE:C.multiTotalE}),S=f/C.timeDivTotal;u.set("reward",T),u.set("timeStamp",S)}else u.set("reward",b),u.set("timeStamp",f);0==g&&(b={num:0,numE:0},u.set("reward",b),u.set("timeStamp",0));var E=new r.HashMap;if(s)for(var L in s){var w=this.themeConfig.getClerkConfigBytagLv(L,s[L].level);if(w){var k={num:w.clerkMultiTotal,numE:w.clerkMultiTotalE};E.set(L,k)}else E.set(L,{num:1,numE:0})}var P=new r.HashMap;if(l)for(var N in l){var A=this.themeConfig.getFameConfigByTagLv(N,l[N].level);if(A){k={num:A.multiTotal,numE:A.multiTotalE};P.set(N,k)}else P.set(N,{num:1,numE:0})}E.keys().forEach(function(e){var n=parseInt(e.split("_")[1]);if(11==n||n==t||12==n){var i=o.calcTool.calcMutiNum(u.get("reward"),E.get(e));u.set("reward",i)}}),P.keys().forEach(function(e){var n=parseInt(e.split("_")[1]);if(11==n||n==t){var i=o.calcTool.calcMutiNum(u.get("reward"),P.get(e));u.set("reward",i)}});var O=a.default.module.gamedata.storesIdLv.values();this.sort(O);var I=this.themeConfig.getStoreSpeedLvConfigByTag("store_11"),R=I.keys(),M={num:1,numE:0},x=1,B=0;for(y=0;y<R.length;y++){if(O[0]<R[y]){var D;if(y>0)M={num:(D=I.get(R[y-1])).multiTotal,numE:D.multiTotalE},x=D.timeDivTotal;break}B=y}B===R.length-1&&(x=(D=I.get(R[R.length-1])).timeDivTotal);var F=a.default.module.calcTool.calcAddNum(this.rewardAdd(),{num:1,numE:0},!1),j={num:1,numE:0};a.default.module.vm.goodsInfo&&(j={num:a.default.module.vm.goodsInfo.multiTotal,numE:a.default.module.vm.goodsInfo.multiTotalE});var U=this.calcTool.calcMutiNum(u.get("reward"),M),H=this.calcTool.calcMutiNum(U,F),V=this.calcTool.calcMutiNum(H,j),z=u.get("timeStamp")/x;u.set("reward",V),u.set("timeStamp",z);var G=u.get("reward");G=this.calcTool.calcMutiNum(G,{num:i,numE:0}),u.set("reward",G),1!=i&&cc.log("\u901f\u5ea6\u8ba1\u7b97:\u9053\u5177\u63d0\u5347\u901f\u5ea6"+i+"\u500d");var W,q="",Y=u.get("reward"),J=this.calcTool.formatNum(Y),X=u.get("timeStamp");if(X<100&&0!=X){var Q=this.calcTool.calcMutiNum(Y,{num:1e3/X,numE:0});u.set("rewardAvg",Q);var K=this.calcTool.formatNum(Q);q+="=>"+K.base+K.gear+"/s\n"}return W="=>"+J.base+J.gear+"/"+X+"\n",cc.log("\u3010\u6a21\u62dfstore"+t+"\u5e97\u94fa\u6536\u96c6\u901f\u5ea6\u3011"+W,"timeStamp<100\u7684\u6536\u96c6\u901f\u5ea6"+q),u},e.prototype.rewardAdd=function(e){return void 0===e&&(e={num:0,numE:0}),a.default.module.vm.clerkList&&a.default.module.vm.fameList&&(a.default.module.vm.fame.num>0||e.num>0)?this.calcTool.calcMutiNum(a.default.module.calcTool.calcAddNum(a.default.module.vm.fame,e,!1),{num:this.oneFameAdd(),numE:0}):{num:0,numE:0}},e.prototype.oneFameAdd=function(){var e=a.default.module.vm.clerkList.clerk_12.level||0,t=0,o=this.themeConfig.getClerkMaxLvById(12);e>0&&e<=o&&(t=this.themeConfig.getClerkConfigBytagLv("clerk_12",e).clerkFameMultiTotal);var n=a.default.module.vm.fameList.fame_11.level||0,i=0,r=this.themeConfig.getFameMaxLvById(11);n>0&&n<=r&&(i=this.themeConfig.getFameConfigByTagLv("fame_11",n).fameMultiTotal);return.02+t+i},e.prototype.checkLockStoreIdByLevel=function(){var e=4;switch(a.default.module.vm.level){case 1:e=4;break;case 2:e=5;break;case 3:e=7;break;case 4:e=9;break;case 5:case 6:case 7:case 8:case 9:case 10:e=10}return e},e.prototype.calcCurrentCanGetFame=function(){var e=this.calcTool.calcAddNum({num:1,numE:0},this.rewardAdd()),t=this.calcTool.calcMutiNum({num:5,numE:12},e),o=this.calcTool.calcDivideNum(a.default.module.vm.win,t);o.numE<0?o={num:0,numE:0}:o=""==a.default.module.calcTool.formatNum(o).gear?{num:Math.floor(o.num*Math.pow(10,o.numE)),numE:0}:o;return a.default.module.calcTool.calcAddNum({num:1,numE:2},o)},e.prototype.calcPassBarrier=function(){var e=a.default.module.vm.level,t=a.default.module.themeConfig.getBuildingConfigById(e),o=a.default.module.calcTool.compare(a.default.module.vm.credit,{num:t.target,numE:t.targetE});a.default.module.vm.isPass=o?1:0,o&&0==a.default.module.vm.isPass&&a.default.module.gameProtocol.writeCacheData("isPass",a.default.module.vm.isPass,function(e){})},e.prototype.calcPostNum=function(e,t){for(var o=a.default.module.themeConfig.getStoreSpeedLvConfigByTag("store_"+e),n=a.default.module.vm.storeList["store_"+e].level,i=o.values(),r=0,c=0;c<i.length;c++)if(n<i[c].level){r=c;break}var s=0;for(c=r;c<i.length&&n+t>=i[c].level;c++)s++;return s+this.calcPostNumStore11(e,n+t)},e.prototype.calcPostNumStore11=function(e,t){var o=a.default.module.gamedata.storesIdLv.values();a.default.module.calcTool.sort(o);var n=o[0],i=new r.HashMap;a.default.module.gamedata.storesIdLv.keys().forEach(function(e){i.set(e,a.default.module.gamedata.storesIdLv.get(e))}),i.set(e,t);var c=i.values();a.default.module.calcTool.sort(c);for(var s=c[0],l=a.default.module.themeConfig.getStoreSpeedLvConfigByTag("store_11").values(),u=-1,p=0;p<l.length;p++)if(n<l[p].level){u=p;break}var d=0;if(-1==u)return d;for(p=u;p<l.length&&s>=l[p].level;p++)d++,p;return d},e.prototype.checkTaskListChange=function(e,t){if(!e)return!0;for(var o in e)if("endTime"!=o&&"dateKey"!=o&&(e[o].taskValue!=t[o].taskValue||e[o].status!=t[o].status))return!0;return!1},e.prototype.changeTaskListByTypeCount=function(e,t){var o=a.default.module.vm.taskList;if(0==a.default.module.vm.noviceProgress.novice_7&&1==a.default.module.vm.level)return o;var n=this.getTaskIds(e),i=0,r={};for(var c in o){var s=o[c];if("dateKey"!=c&&"endTime"!=c){var l=c.split("_")[1];i<4&&3!=s.status&&-1!=n.indexOf(l)?r[c]={id:s.id,taskType:s.taskType,status:s.taskValue+t>=s.taskTag?2:0,taskTag:s.taskTag,taskValue:s.taskValue+t>=s.taskTag?s.taskTag:s.taskValue+t}:r[c]=s,3!=s.status&&i++}else r[c]=s}return r},e.prototype.getTaskIds=function(e){var t=[];switch(e){case n.STORE_UP:t=["1","2","3"];break;case n.STORE_CHALLENGE:t=["4","5"];break;case n.OFF_LINE:t=["6","7"];break;case n.LUCKY_reward:t=["8","9"];break;case n.SELL_STORES:t=["10"];break;case n.CLERK_UP:t=["11","12","13"];break;case n.WATCH_AD:t=["8","9","14","15"];break;case n.FAME_UP:t=["16","17","18"];break;case n.USE_PROP:t=["19","20"]}return t},e.prototype.sort=function(e){e.sort(function(e,t){return e<t?-1:e>t?1:0})},e.prototype.formatTime=function(e,t){if(void 0===t&&(t=!0),e<=0)return(t?"00:":"")+"00:00";var o=Math.floor(e/36e5),n="";o<10&&(n="0");var i=Math.floor((e-36e5*o)/6e4),r="";i<10&&(r="0");var a=Math.floor((e-36e5*o-6e4*i)/1e3),c="";return a<10&&(c="0"),(t?""+n+o+":":"")+r+i+":"+c+a},e}();o.CalcUiShow=c,function(e){e[e.STORE_UP=1]="STORE_UP",e[e.STORE_CHALLENGE=2]="STORE_CHALLENGE",e[e.OFF_LINE=3]="OFF_LINE",e[e.LUCKY_reward=4]="LUCKY_reward",e[e.SELL_STORES=5]="SELL_STORES",e[e.CLERK_UP=6]="CLERK_UP",e[e.WATCH_AD=7]="WATCH_AD",e[e.FAME_UP=8]="FAME_UP",e[e.USE_PROP=9]="USE_PROP"}(n=o.TaskType||(o.TaskType={})),cc._RF.pop()},{"../Main":"Main","../core/Engine":"Engine","../core/util/HashMap":"HashMap"}],Charactor:[function(e,t,o){"use strict";cc._RF.push(t,"cbc16hPLjJAiKeEPBR8m28x","Charactor");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r,a=e("./MovieClip"),c=cc._decorator,s=c.ccclass,l=c.property;(function(e){e[e.stand=0]="stand",e[e.run=1]="run",e[e.sitdown=2]="sitdown",e[e.sitdown_run=3]="sitdown_run",e[e.stop_move=4]="stop_move"})(r=o.CharactorState||(o.CharactorState={}));var u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="",t.skeleton=null,t._movieClip=null,t._direction=0,t._state=0,t._alpha=1,t.sceneMap=null,t.moving=!1,t.moveSpeed=48,t._moveAngle=0,t._roadNodeArr=[],t._nodeIndex=0,t.gateId="",t}return n(t,e),Object.defineProperty(t.prototype,"movieClip",{get:function(){return this._movieClip||(this._movieClip=this.getComponentInChildren(a.default)),this._movieClip},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"direction",{get:function(){return this._direction},set:function(e){this._direction=e;var t=this.skeleton.animation;switch(this.direction){case 0:case 1:case 2:t="reward_move_1",this.skeleton.node.scaleX=1;break;case 3:case 4:t="reward_move_4",this.skeleton.node.scaleX=1;break;case 5:t="reward_move_2",this.skeleton.node.scaleX=1;break;case 6:t="reward_move_4",this.skeleton.node.scaleX=1;break;case 7:t="reward_move_3",this.skeleton.node.scaleX=1}t!=this.skeleton.animation&&this.skeleton.setAnimation(0,t,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return this._state},set:function(e){this._state=e;var t=this.skeleton.animation;switch(this._state){case r.stand:t=t.indexOf("move_1")>0?t.replace("move","idle"):t.indexOf("move_2")>0?t.replace("move_2","idle_3"):t.indexOf("move_3")>0?t.replace("move","idle"):(t.indexOf("move_4"),t.replace("move_4","idle_1"));break;case r.run:t="reward_show_1",this.skeleton.setAnimation(0,"reward_show_1",!1);break;case r.sitdown:t="reward_show_1";break;case r.stop_move:break;case r.sitdown_run:t="reward_show_1"}t!=this.skeleton.animation&&(this.skeleton.setMix(this.skeleton.animation,t,.1),this.skeleton.setAnimation(0,t,"reward_show_1"!=t||"reward_show_1"==t&&e==r.sitdown))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return this._alpha},set:function(e){this._alpha=e,this.node.opacity=Math.floor(e/1*255)},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){},t.prototype.start=function(){this.direction=0,this.state=3,this.node.anchorY=.25},t.prototype.update=function(e){if(this.sceneMap){if(this.node.zIndex=9999-this.node.y,this.moving){var t=this._roadNodeArr[this._nodeIndex],o=t.px-this.node.x,n=t.py-this.node.y,i=this.moveSpeed*e;if(o*o+n*n>=i*i){if(0==this._moveAngle){this._moveAngle=Math.atan2(n,o);var r=Math.round((-this._moveAngle+Math.PI)/(Math.PI/4));this.direction=r>5?r-6:r+2}var a=Math.cos(this._moveAngle)*i,c=Math.sin(this._moveAngle)*i;this.node.x+=a,this.node.y+=c}else o*o+n*n>i?(this.node.x=t.px,this.node.y=t.py):(this._moveAngle=0,this._nodeIndex==this._roadNodeArr.length-1?(this.node.x=t.px,this.node.y=t.py,this.stop()):this.walk())}this.setPlayerStateByNode()}},t.prototype.setPlayerStateByNode=function(){if(this.sceneMap){var e=this.sceneMap.getMapNodeByPixel(this.node.x,this.node.y);if(e!=this._currentNode&&(this._currentNode=e,this._currentNode))switch(this._currentNode.value){case 2:.4!=this.alpha&&(this.alpha=.4);break;case 3:this.alpha>0&&(this.alpha=0);break;default:this.alpha<1&&(this.alpha=1)}}},t.prototype.walkByRoad=function(e,t){this.gateId=t,this._roadNodeArr=e,this._nodeIndex=0,this._moveAngle=0,this.walk(),this.move()},t.prototype.walk=function(){this._nodeIndex<this._roadNodeArr.length-1&&this._nodeIndex++},t.prototype.move=function(){this.moving=!0,this.state=r.run},t.prototype.stopAndMove=function(){this.moving=!0,this.state=r.stop_move},t.prototype.stop=function(){this.moving=!1,this.state=r.stand;parseInt(this.node.name.split("_")[1])},t.prototype.down=function(){this.moving=!1,this.state=r.sitdown},i([l(sp.Skeleton)],t.prototype,"skeleton",void 0),t=i([s],t)}(cc.Component);o.default=u,cc._RF.pop()},{"./MovieClip":"MovieClip"}],ClerkComponent:[function(e,t,o){"use strict";cc._RF.push(t,"9341bRWHk5ItZeIgJduzMjV","ClerkComponent");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../core/Engine"),a=e("../../core/language/LanguageLabel"),c=e("../../core/ui/ComponentExtends"),s=cc._decorator,l=s.ccclass,u=s.property,p=new cc.Vec2(255,-230),d=new cc.Vec2(870,-570),h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.skeleton=null,t.dataIds=[],t.storePos=null,t.leftPos=null,t.rightPos=null,t.initX=610,t}return n(t,e),t.prototype.onLoad=function(){var e=this,t=this.node.name.split("_")[1];cc.loader.loadRes("animator/clerk_skeleton/clerk_"+t+"/clerk_"+t,sp.SkeletonData,function(o,n){o?cc.error(o):(e.skeleton.skeletonData=n,"2"==t&&(e.skeleton.premultipliedAlpha=!0),e.ObverseReverseSpecial())}),"11"==t?(this.storePos=d,this.rightPos=new cc.Vec2(2250,1455),this.leftPos=new cc.Vec2(2040,1350)):"12"==t?(this.storePos=p,this.rightPos=new cc.Vec2(2760,1080),this.leftPos=new cc.Vec2(2520,960)):parseInt(t)<5?(this.storePos=this.node.parent.getChildByName("store_"+t).getPosition(),this.rightPos=new cc.Vec2(this.storePos.x+140,this.storePos.y),this.leftPos=new cc.Vec2(this.storePos.x-20,this.storePos.y-60)):(this.storePos=this.node.parent.getChildByName("store_"+t).getPosition(),this.rightPos=new cc.Vec2(this.storePos.x+200,this.storePos.y+0),this.leftPos=new cc.Vec2(this.storePos.x-20,this.storePos.y-80)),this.node.setPosition(this.rightPos),this.initX=this.node.x,this.loopPlayLabStr(t)},t.prototype.loopPlayLabStr=function(e){var t=this,o=this.node.name.split("_")[1];this.schedule(function(){var e=t.node.getChildByName("emoticon").getComponent(sp.Skeleton);e.setSkin("clerk_"+o),e.setAnimation(0,"reward",!1)},10+8*e)},t.prototype.ObverseReverseSpecial=function(){this.moveAction(4,400)},t.prototype.getRandomNum=function(e,t){return Math.random()*(t-e)+e},t.prototype.moveAction=function(e,t){var o=this,n=new cc.Vec2((this.leftPos.x+this.rightPos.x)/2,(this.leftPos.y+this.rightPos.y)/2);this.skeleton.setAnimation(0,"reward_move_1",!0);var i=function(){o.node.RunAction(ezaction.moveTo(2,{x:o.leftPos.x,y:o.leftPos.y})).onStoped(function(){o.skeleton.setAnimation(0,"reward_move_2",!0),o.node.RunAction(ezaction.moveTo(e,{x:o.rightPos.x,y:o.rightPos.y})).onStoped(function(){o.moveAction(4,400)})})};this.skeleton.setCompleteListener(function(e){"reward_show_1"==e.animation.name&&(o.skeleton.setAnimation(0,"reward_move_1",!0),i())}),this.node.RunAction(ezaction.moveTo(2,{x:n.x,y:n.y})).onStoped(function(){o.skeleton.setAnimation(0,"reward_show_1",!1)})},t.prototype.update=function(){var e=this.node.name.split("_")[1];this.node.zIndex="11"==e||"12"==e?0:9999-this.node.y,this.skeleton.node.active||cc.warn("\u5e97\u5458\u52a8\u753bactive\u53d8\u6210false\u6216\u8005\u52a8\u753bData\u52a0\u8f7d\u5f02\u5e38"+this.skeleton.node.active)},t.prototype.panelAnim=function(){var e=this.node.getChildByName("panel");e.active=!0,e.scaleY=0,e.RunAction(ezaction.scaleTo(.5,{scaleY:1})).onStoped(function(){e.RunAction(ezaction.scaleTo(.5,{scaleY:0,delay:3}))})},t.prototype.setDataId=function(){var e=Math.round(Math.random()*(this.dataIds.length-1)+1),t=this.dataIds[e-1];this.node.getChildByName("panel").getChildByName("lab").getComponent(a.LanguageLabel).dataID=t},t.prototype.initDataIds=function(e){for(var t=1;t<10;t++){var o="npc_clerk_"+e+"_"+t;r.default.i18n.getLangByID(o)&&this.dataIds.push(o)}this.node.getChildByName("panel").scaleY=0,this.loopPlayLabStr(e)},t.prototype.onDestroy=function(){this.dataIds=null,this.storePos=null,this.leftPos=null,this.rightPos=null,e.prototype.onDestroy.call(this)},i([u(sp.Skeleton)],t.prototype,"skeleton",void 0),t=i([l],t)}(c.ComponentExtends);o.default=h,cc._RF.pop()},{"../../core/Engine":"Engine","../../core/language/LanguageLabel":"LanguageLabel","../../core/ui/ComponentExtends":"ComponentExtends"}],CommonPrompt:[function(e,t,o){"use strict";cc._RF.push(t,"bbb990YmpdHN7ycDuI8i/44","CommonPrompt");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../core/gui/GUI"),a=e("../../core/ui/ViewLayout"),c=cc._decorator,s=c.ccclass,l=c.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.titleLab=null,t.contentLab=null,t.closeBtn=null,t.okBtn=null,t.okLab=null,t.cancelBtn=null,t.cancelLab=null,t.config={},t}return n(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.okBtn.on(cc.Node.EventType.TOUCH_END,this.onOk,this),this.closeBtn.on(cc.Node.EventType.TOUCH_END,this.onClose,this),this.cancelBtn.on(cc.Node.EventType.TOUCH_END,this.onCancel,this),this.node.active=!1},t.prototype.onAdded=function(e){void 0===e&&(e={}),this.config=e||{},void 0===this.config.useI18n&&(this.config.useI18n=!0),this.setTitle(),this.setContent(),this.setOkWord(),this.setClose(),this.setCancelBtn(),this.node.active=!0},t.prototype.onDestroy=function(){"function"==typeof this.config.cleanFunc&&this.config.cleanFunc(),this.config=null,e.prototype.onDestroy.call(this)},t.prototype.setTitle=function(){if(this.config.title){var e=this.titleLab.getComponent(cc.Label);if(this.config.useI18n)this.titleLab.getComponent("LanguageLabel").dataID=this.config.title||"system_prompt";else e.string=this.config.title;this.config.type&&"hall"===this.config.type&&(e.string=e.string.toLocaleUpperCase())}else{this.titleLab.getComponent(cc.Label).string=""}},t.prototype.setContent=function(){if(this.config.useI18n){var e=this.contentLab.getComponent("LanguageLabel");e&&(e.dataID=this.config.content)}else this.contentLab.getComponent(cc.Label).string=this.config.content},t.prototype.setOkWord=function(){!1===this.config.showOk?this.okLab.parent.active=this.config.showOk:this.config.useI18n?this.okLab.getComponent("LanguageLabel").dataID=this.config.okWord="determine":this.okLab.getComponent(cc.Label).string=this.config.okWord},t.prototype.setClose=function(){this.closeBtn.active=null==this.config.needClose||this.config.needClose},t.prototype.setCancelBtn=function(){this.config.useI18n?this.cancelLab.getComponent("LanguageLabel").dataID=this.config.cancelWord="popup_cancel":this.cancelLab.getComponent(cc.Label).string=this.config.cancelWord;this.cancelBtn.active=this.config.needCancel||!1},t.prototype.onOk=function(){"function"==typeof this.config.okFunc&&this.config.okFunc(),this.close()},t.prototype.onClose=function(){"function"==typeof this.config.closeFunc&&this.config.closeFunc(),this.close()},t.prototype.onCancel=function(){"function"==typeof this.config.cancelFunc&&this.config.cancelFunc(),this.close()},t.prototype.close=function(){r.gui.delete(this.node)},i([l(cc.Node)],t.prototype,"titleLab",void 0),i([l(cc.Node)],t.prototype,"contentLab",void 0),i([l(cc.Node)],t.prototype,"closeBtn",void 0),i([l(cc.Node)],t.prototype,"okBtn",void 0),i([l(cc.Node)],t.prototype,"okLab",void 0),i([l(cc.Node)],t.prototype,"cancelBtn",void 0),i([l(cc.Node)],t.prototype,"cancelLab",void 0),t=i([s],t)}(a.ViewLayout);o.default=u,cc._RF.pop()},{"../../core/gui/GUI":"GUI","../../core/ui/ViewLayout":"ViewLayout"}],ComponentExtends:[function(e,t,o){"use strict";cc._RF.push(t,"0cea9d0cNxPC7rPR7nLmfdx","ComponentExtends");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i=e("../event/EventDispatcher"),r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._eventDispatcher=null,t._isBindMessageActive=!1,t}return n(t,e),Object.defineProperty(t.prototype,"eventDispatcher",{get:function(){return this._eventDispatcher||(this._eventDispatcher=new i.EventDispatcher),this._eventDispatcher},enumerable:!0,configurable:!0}),t.prototype.bindMessageActive=function(){this._isBindMessageActive=!0},t.prototype.unbindMessageActive=function(){this._isBindMessageActive=!1},t.prototype.on=function(e,t,o){var n=this;this.eventDispatcher.on(e,function(e,i){n.isValid?n._isBindMessageActive?n.node.active&&t.call(o,e,i):t.call(o,e,i):n._eventDispatcher&&(n._eventDispatcher.destroy(),n._eventDispatcher=null)},o)},t.prototype.off=function(e){this._eventDispatcher&&this._eventDispatcher.off(e)},t.prototype.dispatchEvent=function(e,t){void 0===t&&(t=null),this.eventDispatcher.dispatchEvent(e,t)},t.prototype.onDestroy=function(){this._eventDispatcher&&(this._eventDispatcher.destroy(),this._eventDispatcher=null)},t}(cc.Component);o.ComponentExtends=r,cc._RF.pop()},{"../event/EventDispatcher":"EventDispatcher"}],Config:[function(e,t,o){"use strict";cc._RF.push(t,"2f208nl7EtG/KCHb2wZ7C9P","Config"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./GameConfig"),i=e("./QueryConfig"),r=function(){function e(){}return e.init=function(t){e.game=new n.default(t)},e.game=null,e.query=new i.default,e}();o.default=r,cc._RF.pop()},{"./GameConfig":"GameConfig","./QueryConfig":"QueryConfig"}],CreatorEx:[function(e,t,o){"use strict";cc._RF.push(t,"b3634kJK39BjYc+LWmA6h+a","CreatorEx"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./ezplugin/ezplugin");cc.screen.$exitFullScreen=cc.screen.exitFullScreen,cc.screen.exitFullScreen=function(){},cc.screen.$requestFullScreen=cc.screen.requestFullScreen,cc.screen.requestFullScreen=function(){};var i=function(){return function(){if(window.__errorHandler=function(e,t,o,i){var r=n.ezplugin.get("PluginBugly");r&&r.excute("log",{file:e,line:t,msg:o,error:i})},!cc.sys.isBrowser){var e=cc.error;cc.error=function(){for(var t="",o=0;o<arguments.length;o++)t+=arguments[o].toString();var i=n.ezplugin.get("PluginBugly");i&&i.excute("log",{file:"ccerror",line:0,msg:"",error:t}),e(arguments)}}var t=function(){};Object.defineProperty(cc,"log",{configurable:!1,get:function(){return t}}),Object.defineProperty(cc,"warn",{configurable:!1,get:function(){return t}})}}();o.CreatorEx=i,cc._RF.pop()},{"./ezplugin/ezplugin":"ezplugin"}],Defines:[function(e,t,o){"use strict";cc._RF.push(t,"82d3a9c71JEkI95d3qscHm8","Defines"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],DelegateComponent:[function(e,t,o){"use strict";cc._RF.push(t,"d8f1fGRD7dBzIeBSkOpd/Py","DelegateComponent");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.viewParams=null,t._onBeforeRemoveCalled=0,t}return n(t,e),t.prototype.addView=function(){var e=this.viewParams;e&&(this.applyComponentsFunction(this.node,"onAdded",e.params),"function"==typeof e.callbacks.onAdded&&e.callbacks.onAdded(this.node,e.params))},t.prototype.removeView=function(){var e=this.viewParams;e&&e.valid&&0===this._onBeforeRemoveCalled&&(this._onBeforeRemoveCalled=1,this.applyComponentsFunction(this.node,"onBeforeRemove",e.params),e.callbacks&&"function"==typeof e.callbacks.onBeforeRemove?e.callbacks.onBeforeRemove(this.node,this.onceDestroy.bind(this)):this.node.destroy(),e.valid=!1)},t.prototype.onceDestroy=function(){1===this._onBeforeRemoveCalled&&this.node.destroy(),this._onBeforeRemoveCalled=2},t.prototype.onDestroy=function(){var e=this.viewParams;this.viewParams=null,e&&(e.valid=!1,this.applyComponentsFunction(this.node,"onRemoved",e.params),e.callbacks&&"function"==typeof e.callbacks.onRemoved&&e.callbacks.onRemoved(this.node,e.params),e.callbacks=null,e.params=null)},t.prototype.applyComponentsFunction=function(e,t,o){var n=e._components;if(n)for(var i=0;i<n.length;i++){var r=n[i],a=r[t];a&&a.call(r,o)}},t}(cc.Component);o.default=i,cc._RF.pop()},{}],DeviceMotionComponent:[function(e,t,o){"use strict";cc._RF.push(t,"fa534lwDp9MEaPpcvzcbQQh","DeviceMotionComponent");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,a=r.ccclass,c=r.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ratioX=30,t.ratioY=30,t.rate=.15,t._x=0,t._y=0,t._originX=0,t._originY=0,t}return n(t,e),t.prototype.onLoad=function(){cc.sys.isMobile&&(this._x=this.node.x,this._y=this.node.y,this._originX=this._x,this._originY=this._y,cc.systemEvent.setAccelerometerEnabled(!0),cc.systemEvent.on(cc.SystemEvent.EventType.DEVICEMOTION,this.onDeviceMotionEvent,this))},t.prototype.reactive=function(){this._x=this.node.x,this._y=this.node.y,this._originX=this._x,this._originY=this._y},t.prototype.onDestroy=function(){cc.systemEvent.off(cc.SystemEvent.EventType.DEVICEMOTION,this.onDeviceMotionEvent,this)},t.prototype.onDeviceMotionEvent=function(e){cc.sys.isMobile&&(this._x=this._originX+e.acc.x*this.ratioX,this._y=this._originY+e.acc.y*this.ratioY)},t.prototype.update=function(){if(cc.sys.isMobile){if(Math.abs(this._x-this.node.x)<.01)return;this.node.x=this.node.x+(this._x-this.node.x)*this.rate,this.node.y=this.node.y+(this._y-this.node.y)*this.rate}},i([c(cc.Float)],t.prototype,"ratioX",void 0),i([c(cc.Float)],t.prototype,"ratioY",void 0),i([c(cc.Float)],t.prototype,"rate",void 0),t=i([a],t)}(cc.Component);o.default=s,cc._RF.pop()},{}],Downloader:[function(e,t,o){"use strict";cc._RF.push(t,"4618c9t8vhMSZ9xAznVwFrh","Downloader"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../ezplugin/ezplugin"),i=e("./HashMap"),r=function(){function e(e){if(this._downdloadTasks=new i.HashMap,this._waitDownloadTasks=[],this._freeLoaders=[],"undefined"!=typeof jsb)for(var t=0;t<e;t++){var o=new jsb.Downloader;this._freeLoaders.push(o),o.setOnFileTaskSuccess(this._taskSuccessHandler.bind(this)),o.setOnTaskError(this._taskErrorHandler.bind(this))}}return e.prototype.abort=function(e){for(var t=[],o=0,n=this._waitDownloadTasks;o<n.length;o++){var i=n[o];e.indexOf(i.storagePath)<0&&t.push(i)}this._waitDownloadTasks=t},e.prototype.download=function(e,t,o,n,i){if(void 0===i&&(i=null),"undefined"!=typeof jsb)if(e&&t){var r=this._downdloadTasks.get(t);if(r)"function"==typeof i&&r.callbacks.push(i);else{for(var a=0,c=this._waitDownloadTasks;a<c.length;a++){var s=c[a];if(s.storagePath===t)return"function"==typeof i&&s.callbacks.push(i),void(s.priority<n&&(s.priority=n,this._waitDownloadTasks.sort(function(e,t){return t.priority-e.priority})))}var l={requestURL:e,storagePath:t,downloader:null,callbacks:[i],retry:o,priority:n||0};this._waitDownloadTasks.push(l),this._waitDownloadTasks.sort(function(e,t){return t.priority-e.priority}),this.checkWaitTasks()}}else cc.error("[ TS Downloader ] \u53c2\u6570\u9519\u8bef\uff0curl\u548cstoragePath\u4e0d\u80fd\u4e3a\u7a7a\uff01")},e.prototype.checkWaitTasks=function(){if(this._waitDownloadTasks&&this._freeLoaders&&this._freeLoaders.length>0&&this._waitDownloadTasks.length>0){var e=this._waitDownloadTasks.shift();if(e){e.downloader=this._freeLoaders.pop(),jsb.fileUtils.isFileExist(e.storagePath)&&jsb.fileUtils.removeFile(e.storagePath),jsb.fileUtils.isFileExist(e.storagePath+".tmp")&&jsb.fileUtils.removeFile(e.storagePath+".tmp");var t=e.downloader.createDownloadFileTask(e.requestURL,e.storagePath,e.storagePath);this._downdloadTasks.set(t.identifier,e),this.checkWaitTasks()}}},e.prototype._taskSuccessHandler=function(e){cc.log("[TS Downloader] \u4e0b\u8f7d\u6210\u529f "+e.storagePath);var t=this._downdloadTasks.get(e.identifier);if(t){var o=!0;jsb.fileUtils.isFileExist(e.storagePath)||(cc.error("[TS Downloader]\u4e0b\u8f7d\u6210\u529f\u4f46\u65e0\u6cd5\u627e\u5230\u8be5\u6587\u4ef6 "+e.storagePath),o=!1);for(var n=0,i=t.callbacks;n<i.length;n++){var r=i[n];"function"==typeof r&&r(o)}t.callbacks=null,this._freeLoaders.push(t.downloader),t.downloader=null,this._downdloadTasks.delete(e.identifier),this.checkWaitTasks()}},e.prototype._taskErrorHandler=function(e,t,o,i){if(cc.log("[TS Downloader] \u4e0b\u8f7d\u5931\u8d25 "+e.requestURL+" errorCode="+t+" "+i),this._downdloadTasks&&this._freeLoaders){var r=this._downdloadTasks.get(e.identifier);if(r.retry>0)jsb.fileUtils.removeFile(e.storagePath),r.retry=r.retry-1,cc.log("[TS Downloader] \u5c1d\u8bd5\u91cd\u65b0\u4e0b\u8f7d "+e.requestURL),r.downloader.createDownloadFileTask(r.requestURL,e.storagePath,r.storagePath);else{for(var a=0,c=r.callbacks;a<c.length;a++){var s=c[a];"function"==typeof s&&s(!1)}r.callbacks=null,this._freeLoaders.push(r.downloader),r.downloader=null,this._downdloadTasks.delete(e.identifier),this.checkWaitTasks();var l=n.ezplugin.get("PluginBugly");l&&l.excute("log",{file:"Downloader",line:"download failed",msg:r.requestURL,error:"storagePath:"+r.storagePath+",errorCode:"+t+",errorCodeInternal:"+o})}}},e.prototype.destroy=function(){this._downdloadTasks.clear(),this._downdloadTasks=null,this._waitDownloadTasks=null,this._freeLoaders=null},e}();o.Downloader=r,cc._RF.pop()},{"../ezplugin/ezplugin":"ezplugin","./HashMap":"HashMap"}],EdgeMaskComponent:[function(e,t,o){"use strict";cc._RF.push(t,"3b8cf1T8/ZLtZZXc7Q+/uO0","EdgeMaskComponent");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,a=r.ccclass,c=(r.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.spriteOrSpine=null,t}return n(t,e),t.prototype.onLoad=function(){if(this.spriteOrSpine=this.node.getComponent(sp.Skeleton),this.spriteOrSpine){var e=cc.loader.getRes("common/materials/matl_spineMask",cc.Material);this.spriteOrSpine.setMaterial(0,e)}else{this.spriteOrSpine=this.node.getComponent(cc.Sprite);var t=cc.loader.getRes("common/materials/matl_spriteMask",cc.Material);this.spriteOrSpine.setMaterial(0,t)}},t.prototype.enableSpineMask=function(e){this.spriteOrSpine.getMaterial(0).setProperty("u_enableMask",e?1:0)},t.prototype.setYs=function(e,t){this.spriteOrSpine.getMaterial(0).setProperty("u_startYs",{x:e,y:t})},t=i([a],t)}(cc.Component));o.default=c,cc._RF.pop()},{}],EditBoxControl:[function(e,t,o){"use strict";cc._RF.push(t,"7bf56yCv+hI+7okqxQCnvj8","EditBoxControl");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../../core/ui/button/ButtonEffect"),a=e("../../../core/ui/ComponentExtends"),c=e("../../../Main"),s=e("../../../service/Service"),l=cc._decorator,u=l.ccclass,p=l.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.btn=null,t.initStr="",t}return n(t,e),t.prototype.onLoad=function(){},t.prototype.onEditBoxChanged=function(){cc.log("onEditBoxChanged");for(var e=this.node.getComponent(cc.EditBox),t="",o=new RegExp(/^[\u4e00-\u9fa5]|[A-Za-z0-9]/),n=0;n<e.string.split("").length;n++)o.test(e.string.charAt(n))&&(t+=e.string.charAt(n));e.string=t,e.string!=this.initStr&&(""!=e.string||(e.string=this.initStr))},t.prototype.onEditBoxEnded=function(){var e=this;cc.log("onEditBoxEnded");var t=this.node.getComponent(cc.EditBox);s.service.analytics.logEvent("set_click_name","",""),c.default.module.gameProtocol.sendNickName(t.string,function(){e.initStr=t.string,c.default.module.gamedata.nickName=e.initStr})},t.prototype.update=function(){},t.prototype.onDestroy=function(){this.initStr=null,e.prototype.onDestroy.call(this)},i([p(r.default)],t.prototype,"btn",void 0),t=i([u],t)}(a.ComponentExtends);o.default=d,cc._RF.pop()},{"../../../Main":"Main","../../../core/ui/ComponentExtends":"ComponentExtends","../../../core/ui/button/ButtonEffect":"ButtonEffect","../../../service/Service":"Service"}],EngineMessage:[function(e,t,o){"use strict";cc._RF.push(t,"dcd39UlzhdCV4LSWiLjUJEf","EngineMessage"),Object.defineProperty(o,"__esModule",{value:!0}),function(e){e.GAME_ENTER="EngineMessage.GAME_ENTER",e.GAME_EXIT="EngineMessage.GAME_EXIT",e.GAME_RESIZE="EngineMessage.GAME_RESIZE",e.ENGINE_START="EngineMessage.ENGINE_START"}(o.EngineMessage||(o.EngineMessage={})),cc._RF.pop()},{}],EngineTime:[function(e,t,o){"use strict";cc._RF.push(t,"db344Z/DfVDKpYZCoAHlmVw","EngineTime");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i=function(){for(var e="",t=1;t<=32;t++){e+=Math.floor(16*Math.random()).toString(16),8!=t&&12!=t&&16!=t&&20!=t||(e+="-")}return e},r=function(e){function t(t){var o=e.call(this)||this;return o.schedules={},o._scheduleCount=1,o.initTime=(new Date).getTime(),o._$serverTimeElasped=0,o.component=t,o.schedule(o.onUpdate,1),o}return n(t,e),t.prototype.serverTimeElasped=function(e){return e&&(this._$serverTimeElasped=e),this._$serverTimeElasped},t.prototype.format=function(e,t){var o={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds(),"q+":Math.floor((t.getMonth()+3)/3),S:t.getMilliseconds()};for(var n in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length))),o)new RegExp("("+n+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?o[n]:("00"+o[n]).substr((""+o[n]).length)));return e},t.prototype.getTime=function(){return this.getLocalTime()-this.initTime},t.prototype.getLocalTime=function(){return Date.now()},t.prototype.schedule=function(e,t){var o="schedule+"+this._scheduleCount++;return this.schedules[o]=e,this.component.schedule(e,t),o},t.prototype.scheduleOnce=function(e,t){var o=this;void 0===t&&(t=0);var n="scheduleOnce+"+this._scheduleCount++;return this.schedules[n]=e,this.component.scheduleOnce(function(){var e=o.schedules[n];e&&e(),o.unschedule(n)},Math.max(t,0)),n},t.prototype.unschedule=function(e){var t=this.schedules[e];t&&(this.component.unschedule(t),delete this.schedules[e])},t.prototype.unscheduleAllCallbacks=function(){for(var e in this.schedules)this.component.unschedule(this.schedules[e]);this.schedules={}},t.prototype.onUpdate=function(e){for(var o in t.times){var n=t.times[o];n.object[n.field]>0&&(n.object[n.field]--,0==n.object[n.field]?(n.onComplete&&n.onComplete.call(n.object),n.event&&this.dispatchEvent(n.event)):n.onSecond&&n.onSecond.call(n.object))}},t.prototype.save=function(){for(var e in t.times)t.times[e].startTime=this.getTime()},t.prototype.load=function(){for(var e in t.times){var o=Math.floor((this.getTime()-(t.times[e].startTime||this.getTime()))/1e3),n=t.times[e];n.object[n.field]=n.object[n.field]-o,n.object[n.field]<0&&(n.object[n.field]=0),t.times[e].startTime=null}},t.prototype.registerObject=function(e,o,n,r){var a={};return a.id=i(),a.object=e,a.field=o,a.onSecond=n,a.onComplete=r,t.times[a.id]=a,a.id},t.prototype.unRegisterObject=function(e){t.times[e]&&delete t.times[e]},t.prototype.register=function(e,o,n){var i={};i.id=e,i.event=e,i.object=o,i.field=n,t.times[i.id]=i},t.prototype.unRegister=function(e){t.times[e]&&delete t.times[e]},t.times={},t}(e("../event/EventDispatcher").EventDispatcher);o.EngineTime=r;var a=function(){function e(e){void 0===e&&(e=1),this.step=e,this.elapsedTime=0}return e.prototype.update=function(e){return this.elapsedTime+=e,this.elapsedTime>this.step&&(this.elapsedTime-=this.step,!0)},e.prototype.reset=function(){this.elapsedTime=0},e}();o.Timer=a,cc._RF.pop()},{"../event/EventDispatcher":"EventDispatcher"}],Engine:[function(e,t,o){"use strict";cc._RF.push(t,"ba40chjvNVLaKrp4dskHF0z","Engine");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("./audio/Audio"),a=e("./CreatorEx"),c=e("./EngineMessage"),s=e("./gui/GUI"),l=e("./language/Language"),u=e("./language/LanguageI18nEnum"),p=e("./net/Network"),d=e("./ui/ComponentExtends"),h=e("./util/EngineTime"),f=e("./util/Ex"),g=e("./util/ValueExtends"),m=e("./util/Downloader"),v=e("./Log"),_=cc._decorator.ccclass,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._updateSizeState=0,t._originDesignResolution=cc.size(0,0),t}var o;return n(t,e),o=t,t.prototype.onLoad=function(){new a.CreatorEx,this.initEngine(),this.initManagers(),this.initEvents(),s.gui.init(this.node),this.run(),this.dispatchEvent(c.EngineMessage.ENGINE_START)},t.prototype.initEngine=function(){o.canvas=cc.find("Canvas");var e=o.canvas.getComponent(cc.Canvas);this._originDesignResolution=cc.size(e.designResolution),cc.debug.setDisplayStats(!1),cc.game.setFrameRate(60),cc.log("[Engine] initEngine")},t.prototype.initManagers=function(){o.i18n=new l.LanguageManager(u.LanguageI18nEnum.DEFAULT),o.network=p.network,o.timer=new h.EngineTime(this),o.audio=new r.Audio,o.ex=new f.Ex,o.downloader=new m.Downloader(3),cc.log("[Engine] initManagers")},t.prototype.initEvents=function(){var e=this;cc.game.on(cc.game.EVENT_SHOW,function(){cc.log("cc.game.EVENT_SHOW"),o.isShow=!0,o.timer.load(),e.dispatchEvent(c.EngineMessage.GAME_ENTER,o.timer.getLocalTime())}),cc.game.on(cc.game.EVENT_HIDE,function(){cc.log("cc.game.EVENT_HIDE"),o.isShow=!1,o.timer.save(),e.dispatchEvent(c.EngineMessage.GAME_EXIT,o.timer.getLocalTime())}),cc.view.setResizeCallback(function(){e._updateSizeState=1}),this.gameFitHandler(),cc.log("[Engine] initEvents")},t.prototype.update=function(){switch(this._updateSizeState){case 1:this.gameFitHandler(),this._updateSizeState=2;break;case 2:this.dispatchEvent(c.EngineMessage.GAME_RESIZE),this._updateSizeState=0}},t.prototype.gameFitHandler=function(){var e=cc.view.getCanvasSize();switch(cc.log("[engin] ,canvasSize "+e.width+" "+e.height+" "),o.orientation){case cc.macro.ORIENTATION_PORTRAIT:o.fit=!0;break;case cc.macro.ORIENTATION_LANDSCAPE:o.fit=!1;break;default:cc.sys.isMobile?o.fit=e.width<e.height:o.fit=!1}var t=o.canvas.getComponent(cc.Canvas),n=this._originDesignResolution,i=Math.min(n.width,n.height),r=Math.max(n.width,n.height);o.fit?t.designResolution=cc.size(i,r):t.designResolution=cc.size(r,i),o.designHeight=t.designResolution.height,o.designWidth=t.designResolution.width,cc.log("------------- engine.fit="+o.fit+" designResolution="+o.designWidth+" "+o.designHeight)},t.prototype.run=function(){},t.fit=!1,t.designWidth=0,t.designHeight=0,t.audio=null,t.i18n=null,t.network=null,t.timer=null,t.ex=null,t.value=new g.ValueExtends,t.canvas=null,t.orientation=cc.macro.ORIENTATION_AUTO,t.isShow=!0,t.downloader=null,t.appVersion="",t.log=new v.Log,t=o=i([_],t)}(d.ComponentExtends);o.default=y,cc._RF.pop()},{"./CreatorEx":"CreatorEx","./EngineMessage":"EngineMessage","./Log":"Log","./audio/Audio":"Audio","./gui/GUI":"GUI","./language/Language":"Language","./language/LanguageI18nEnum":"LanguageI18nEnum","./net/Network":"Network","./ui/ComponentExtends":"ComponentExtends","./util/Downloader":"Downloader","./util/EngineTime":"EngineTime","./util/Ex":"Ex","./util/ValueExtends":"ValueExtends"}],EntityLayer:[function(e,t,o){"use strict";cc._RF.push(t,"6639ayo4DFKZYCU2OBZzyb+","EntityLayer");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,a=r.ccclass,c=(r.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.start=function(){},t.prototype.clear=function(){},t=i([a],t)}(cc.Component));o.default=c,cc._RF.pop()},{}],EventDispatcher:[function(e,t,o){"use strict";cc._RF.push(t,"e718eJZxktJ+7AfmyovKw5s","EventDispatcher"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./MessageManager"),i=function(){function e(){this._msg=null}return e.prototype.on=function(e,t,o){null==this._msg&&(this._msg=new n.MessageEventData),this._msg.on(e,t,o)},e.prototype.off=function(e){this._msg&&this._msg.off(e)},e.prototype.dispatchEvent=function(e,t){void 0===t&&(t=null),null==this._msg&&(this._msg=new n.MessageEventData),this._msg.dispatchEvent(e,t)},e.prototype.destroy=function(){this._msg&&this._msg.removes(),this._msg=null},e}();o.EventDispatcher=i,cc._RF.pop()},{"./MessageManager":"MessageManager"}],EventEmitter:[function(e,t,o){"use strict";cc._RF.push(t,"061000rcmNCk4isXofDHYlp","EventEmitter");var n=Array.isArray;function i(){}void 0!==t&&t.exports?t.exports.EventEmitter=i:window.EventEmitter=i;i.prototype.setMaxListeners=function(e){this._events||(this._events={}),this._maxListeners=e},i.prototype.destroy=function(){this._events=null},i.prototype.emit=function(){var e=arguments[0];if("error"===e&&(!this._events||!this._events.error||n(this._events.error)&&!this._events.error.length)){if(this.domain){var t=arguments[1];return t.domain_emitter=this,t.domain=this.domain,t.domain_thrown=!1,this.domain.emit("error",t),!1}throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.")}if(!this._events)return!1;var o=this._events[e];if(!o)return!1;if("function"==typeof o){switch(this.domain&&this.domain.enter(),arguments.length){case 1:o.call(this);break;case 2:o.call(this,arguments[1]);break;case 3:o.call(this,arguments[1],arguments[2]);break;default:for(var i=arguments.length,r=new Array(i-1),a=1;a<i;a++)r[a-1]=arguments[a];o.apply(this,r)}return this.domain&&this.domain.exit(),!0}if(n(o)){this.domain&&this.domain.enter();for(var c=arguments.length,s=new Array(c-1),l=1;l<c;l++)s[l-1]=arguments[l];for(var u=o.slice(),p=0,d=u.length;p<d;p++)u[p].apply(this,s);return this.domain&&this.domain.exit(),!0}return!1},i.prototype.addListener=function(e,t){if("function"!=typeof t)throw new Error("addListener only takes instances of Function");var o;(this._events||(this._events={}),this.emit("newListener",e,"function"==typeof t.listener?t.listener:t),this._events[e]?n(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,n(this._events[e])&&!this._events[e].warned)&&((o=void 0!==this._maxListeners?this._maxListeners:10)&&o>0&&this._events[e].length>o&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),console.trace()));return this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(e,t){if("function"!=typeof t)throw new Error(".once only takes instances of Function");var o=this;function n(){o.removeListener(e,n),t.apply(this,arguments)}return n.listener=t,o.on(e,n),this},i.prototype.removeListener=function(e,t){if("function"!=typeof t)throw new Error("removeListener only takes instances of Function");if(!this._events||!this._events[e])return this;var o=this._events[e];if(n(o)){for(var i=-1,r=0,a=o.length;r<a;r++)if(o[r]===t||o[r].listener&&o[r].listener===t){i=r;break}if(i<0)return this;o.splice(i,1)}else(o===t||o.listener&&o.listener===t)&&delete this._events[e];return this},i.prototype.removeAllListeners=function(e){if(0===arguments.length)return this._events={},this;var t=this._events&&this._events[e];return t?(n(t)?t.splice(0):this._events[e]=null,this):this},i.prototype.listeners=function(e){return this._events||(this._events={}),this._events[e]||(this._events[e]=[]),n(this._events[e])||(this._events[e]=[this._events[e]]),this._events[e]},t.exports=i,cc._RF.pop()},{}],EventObjectEmitter:[function(e,t,o){"use strict";cc._RF.push(t,"08b27AP1KZCbqxGgbj0G5fM","EventObjectEmitter"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../util/HashMap"),i=function(){function e(){this._eventHash=new n.HashMap,this._maxListeners=20}return e.prototype.destroy=function(){this._eventHash.clear(),this._eventHash=null},e.prototype.setMaxListeners=function(e){this._maxListeners=e},e.prototype.emit=function(e,t){var o=this._eventHash.get(e);if(o)for(var n=0,i=o;n<i.length;n++){var r=i[n];r.thisObj?r.listener.call(r.thisObj,e,t):r.listener(e,t)}},e.prototype.addEventListener=function(e,t,o){var n=this._eventHash.get(e);n||(n=[],this._eventHash.set(e,n)),n.push({thisObj:o,listener:t})},e.prototype.once=function(e,t,o){this.addEventListener(e,t,o)},e.prototype.removeEventListener=function(e,t,o){if(this._eventHash){var n=this._eventHash.get(e);if(n&&n.length>0){for(var i=[],r=0,a=n;r<a.length;r++){var c=a[r];c.listener!=t&&i.push(c)}if(i.length===n.length)return;n=null,i.length<0?this._eventHash.delete(e):this._eventHash.set(e,i)}}},e.prototype.removeEventListeners=function(e){this._eventHash&&this._eventHash.delete(e)},e}();o.default=i,cc._RF.pop()},{"../util/HashMap":"HashMap"}],ExToggleGroup:[function(e,t,o){"use strict";cc._RF.push(t,"8c131LMZ+BH0KSWMdeysWXQ","ExToggleGroup");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,a=r.ccclass,c=(r.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._callback=null,t.firstIndex=-1,t}return n(t,e),t.prototype.start=function(){var e=this,t=0;this.node.children.forEach(function(o,n){var i=o.getComponent(cc.Toggle);i&&(o.on("toggle",e.toggleCallback,e),i.isChecked=t===e.firstIndex,t++)})},t.prototype.setIndex=function(e){for(var t=this.node.children,o=0,n=0;n<t.length;n++){var i=t[n].getComponent(cc.Toggle);i&&(i.isChecked=o===e,o++)}this.firstIndex=e},t.prototype.getIndex=function(){for(var e=this.node.children,t=0,o=0;o<e.length;o++){var n=e[o].getComponent(cc.Toggle);if(n){if(n.isChecked)return t;t++}}return-1},t.prototype.getItems=function(){for(var e=[],t=this.node.children,o=0;o<t.length;o++){t[o].getComponent(cc.Toggle)&&e.push(t[o])}return e},t.prototype.getSelectedItem=function(){for(var e=this.node.children,t=0;t<e.length;t++){var o=e[t].getComponent(cc.Toggle);if(o&&o.isChecked)return e[t]}return null},t.prototype.toggleCallback=function(e){this._callback&&this._callback(e,this)},t.prototype.registerCallback=function(e){this._callback=e},t.prototype.onDestroy=function(){var e=this;this._callback=null,this.node.children.forEach(function(t){cc.isValid(t)&&(t.getComponent(cc.Toggle)&&t.off("toggle",e.toggleCallback,e))})},t=i([a],t)}(cc.ToggleContainer));o.default=c,cc._RF.pop()},{}],Ex:[function(e,t,o){"use strict";cc._RF.push(t,"8475a///V1PgKtONhvxu319","Ex"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.vibrate=function(e){cc.sys.isBrowser&&cc.sys.isMobile&&(navigator.vibrate=navigator.vibrate||navigator.webkitVibrate||navigator.mozVibrate||navigator.msVibrate,navigator.vibrate&&navigator.vibrate(e))},e.prototype.shake=function(e,t){var o=e.runAction(cc.repeatForever(cc.sequence(cc.moveTo(.02,cc.v2(5,7)),cc.moveTo(.02,cc.v2(-6,7)),cc.moveTo(.02,cc.v2(-13,3)),cc.moveTo(.02,cc.v2(3,-6)),cc.moveTo(.02,cc.v2(-5,5)),cc.moveTo(.02,cc.v2(2,-8)),cc.moveTo(.02,cc.v2(-8,-10)),cc.moveTo(.02,cc.v2(3,10)),cc.moveTo(.02,cc.v2(0,0)))));setTimeout(function(){e.stopAction(o)},1e3*t)},e}();o.Ex=n,cc._RF.pop()},{}],FameConfirm:[function(e,t,o){"use strict";cc._RF.push(t,"3e4abg2GglMcrtjJCtFsCNz","FameConfirm");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../core/Engine"),a=e("../../core/language/LanguageLabel"),c=e("../../core/ui/ComponentExtends"),s=cc._decorator,l=s.ccclass,u=(s.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.clickCallback=null,t}return n(t,e),t.prototype.onLoad=function(){this.node.hasEventListener(cc.Node.EventType.TOUCH_END)||this.node.on(cc.Node.EventType.TOUCH_END,this.onBtnHandler,this)},t.prototype.onBtnHandler=function(e){switch(e.target.name){case"btn_close":case"btn_cancel":this.node.destroy();break;case"btn_ok":this.clickCallback&&this.clickCallback()}},t.prototype.onAdded=function(e){var t=this,o=this.node.getChildByName("skeleton").getComponent(sp.Skeleton),n="zh"==r.default.i18n.currentLanguage?"cn":"en";this.node.getChildByName("btn_ok").active=!1,this.node.getChildByName("btn_cancel").active=!1,this.node.getChildByName("btn_close").active=!1,o.setCompleteListener(function(e){"reward_fadein"==e.animation.name&&(o.setAnimation(0,"reward_loop",!0),t.node.getChildByName("btn_ok").active=!0,t.node.getChildByName("btn_close").active=!0,t.node.getChildByName("btn_cancel").active=!0)}),this.node.getChildByName("result_lab").getComponent(a.LanguageLabel).setVars("prestige_info_1",e.per),o.setSkin(n),o.setAnimation(0,"reward_fadein",!1),this.node.getChildByName("result_spr").scale=0;var i=cc.loader.getRes("main/icon/icon"+e.id,cc.SpriteFrame);this.node.getChildByName("result_spr").getComponent(cc.Sprite).spriteFrame=i,this.node.getChildByName("result_spr").RunAction(ezaction.scaleTo(5/30,{scale:1.1*1.5})).onStoped(function(){t.node.getChildByName("result_spr").RunAction(ezaction.scaleTo(10/30,{scale:1.1*1.5})).onStoped(function(){})}),this.node.getChildByName("result_lab").scale=0,this.node.getChildByName("result_lab").RunAction(ezaction.scaleTo(5/30,{scale:1.1})).onStoped(function(){t.node.getChildByName("result_lab").RunAction(ezaction.scaleTo(10/30,{scale:1})).onStoped(function(){})}),this.node.getChildByName("title_spr").scale=0;var c="en"==n?.8:1;this.node.getChildByName("title_spr").RunAction(ezaction.scaleTo(5/30,{scale:1.1*c})).onStoped(function(){t.node.getChildByName("title_spr").RunAction(ezaction.scaleTo(10/30,{scale:1*c})).onStoped(function(){})})},t.prototype.onDestroy=function(){this.node.off(cc.Node.EventType.TOUCH_END,this.onBtnHandler,this),e.prototype.onDestroy.call(this),this.clickCallback=null},t=i([l],t)}(c.ComponentExtends));o.default=u,cc._RF.pop()},{"../../core/Engine":"Engine","../../core/language/LanguageLabel":"LanguageLabel","../../core/ui/ComponentExtends":"ComponentExtends"}],FameGetComponent:[function(e,t,o){"use strict";cc._RF.push(t,"5e251+KcDpNlrkdDhaQaANx","FameGetComponent");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../core/event/MessageManager"),a=e("../../core/gui/GUI"),c=e("../../core/language/LanguageLabel"),s=e("../../core/ui/ComponentExtends"),l=e("../../core/ui/label/LabelChangeSymbol"),u=e("../../core/ui/ViewUtils"),p=e("../../Main"),d=e("../CalcUiShow"),h=e("./adv/AdvControl"),f=cc._decorator,g=f.ccclass,m=(f.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.nodes=null,t}return n(t,e),t.prototype.onLoad=function(){this.init()},t.prototype.init=function(){var e=this;this.nodes=u.ViewUtils.nodeTreeInfoLite(this.node),this.setInfo(),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchHandler,this),this.refreshMutiInfo(),this.schedule(function(){e.refreshMutiInfo()},.5)},t.prototype.setInfo=function(){this.nodes.get("fame_lab").getComponent(l.LabelChangeSymbol).num=p.default.module.vm.fame;var e=p.default.module.calcTool.formatNum(p.default.module.calcTool.calcAddNum(p.default.module.calcUiShow.rewardAdd(),{num:1,numE:0},!1),!1),t=""+e.base+e.gear;this.nodes.get("muti_lab").getComponent(c.LanguageLabel).setVars("ui_personal_7",t);var o=p.default.module.themeConfig.getBuildingConfigById(p.default.module.vm.level).fameCount;this.nodes.get("times").getComponent(cc.Label).string=(p.default.module.gamedata.fameNpcNum>o?o:p.default.module.gamedata.fameNpcNum)+"/"+o,this.nodes.get("right_finish").active=p.default.module.gamedata.fameNpcNum>=o,this.nodes.get("right_no_finish").active=p.default.module.gamedata.fameNpcNum<o,this.nodes.get("new_muti_lab").getComponent(c.LanguageLabel).dataID="ui_personal_9",this.toggleConent()},t.prototype.refreshMutiInfo=function(){var e=p.default.module.calcUiShow,t=p.default.module.gamedata.getFameTime-e.getSeverCurrentTime();this.nodes.get("cut_time").getComponent(cc.Label).string=p.default.module.calcUiShow.formatTime(t),this.nodes.get("left_finish").active=t<=0,this.nodes.get("left_no_finish").active=t>0;var o=e.calcCurrentCanGetFame();this.nodes.get("can_get").getComponent(l.LabelChangeSymbol).num=o;var n=p.default.module.calcTool.formatNum(p.default.module.calcTool.calcAddNum(p.default.module.calcUiShow.rewardAdd(o),{num:1,numE:0},!1),!1),i=""+n.base+n.gear;this.nodes.get("new_muti_lab").getComponent(c.LanguageLabel).setVars("ui_personal_9",i),this.toggleConent()},t.prototype.onDestroy=function(){this.nodes=null,this.node.off(cc.Node.EventType.TOUCH_END,this.onTouchHandler,this),this.unscheduleAllCallbacks(),e.prototype.onDestroy.call(this)},t.prototype.update=function(){},t.prototype.getFameCallback=function(e){var t=p.default.module.calcUiShow.calcCurrentCanGetFame();p.default.module.calcUiShow.refreshFame(t),p.default.module.gamedata.getFameTime=p.default.module.calcUiShow.getSeverCurrentTime()+108e5,p.default.module.gamedata.fameNpcNum=0,cc.sys.localStorage.setItem("fameNpcNum",0),this.setInfo();var o={touchClose:!0,modal:!1,onAdded:function(e,t){},onRemoved:function(t,o){e&&e&&e()}};a.gui.popup.add("popup/fame_result",{},o)},t.prototype.onTouchHandler=function(e){switch(e.target.name){case"btn_get":this.getFameCallback();break;case"btn_close":a.gui.delete(this.node);break;case"btn_watch":if(cc.sys.isBrowser){cc.log("\u6d4f\u89c8\u5668\u76f4\u63a5\u53d1\u653e\u4e3b\u754c\u9762\u91d1\u5e01\u7ffb\u500d\u5956\u52b1");var t=p.default.module.calcUiShow.changeTaskListByTypeCount(d.TaskType.WATCH_AD,1);return p.default.module.gameProtocol.sendTaskList(t,function(e){p.default.module.vm.taskList=t}),p.default.module.gamedata.getFameTime=p.default.module.calcUiShow.getSeverCurrentTime(),void p.default.module.gameProtocol.writeCacheData("getFameTime",p.default.module.gamedata.getFameTime,function(e){})}r.Message.dispatchEvent(h.AdvMessage.PLAY,{callback:function(e,t){t==h.AdvRewardType.GET_FAME&&(e?(cc.log("\u83b7\u53d6\u58f0\u671b\u5012\u8ba1\u65f6\u8fbe\u6210\u89c2\u770b\u5e7f\u544a\u6210\u529f"),p.default.module.gamedata.getFameTime=p.default.module.calcUiShow.getSeverCurrentTime(),p.default.module.gameProtocol.writeCacheData("getFameTime",p.default.module.gamedata.getFameTime,function(e){})):cc.log("\u83b7\u53d6\u58f0\u671b\u5012\u8ba1\u65f6\u8fbe\u6210\u89c2\u770b\u5e7f\u544a\u5931\u8d25"))},type:h.AdvRewardType.GET_FAME})}},t.prototype.toggleConent=function(){var e=p.default.module.calcUiShow,t=p.default.module.gamedata.getFameTime-e.getSeverCurrentTime(),o=p.default.module.themeConfig.getBuildingConfigById(p.default.module.vm.level).fameCount;this.nodes.get("content1").active=t>0||p.default.module.gamedata.fameNpcNum<o,this.nodes.get("content2").active=t<=0&&p.default.module.gamedata.fameNpcNum>=o,0==p.default.module.vm.noviceProgress.novice_13&&(this.nodes.get("content2").active=!0,this.nodes.get("content1").active=!1)},t=i([g],t)}(s.ComponentExtends));o.default=m,cc._RF.pop()},{"../../Main":"Main","../../core/event/MessageManager":"MessageManager","../../core/gui/GUI":"GUI","../../core/language/LanguageLabel":"LanguageLabel","../../core/ui/ComponentExtends":"ComponentExtends","../../core/ui/ViewUtils":"ViewUtils","../../core/ui/label/LabelChangeSymbol":"LabelChangeSymbol","../CalcUiShow":"CalcUiShow","./adv/AdvControl":"AdvControl"}],GUI:[function(e,t,o){"use strict";cc._RF.push(t,"f927fJk+ClDKJM8VzQlXXJJ","GUI"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../EngineMessage"),i=e("../event/MessageManager"),r=e("./DelegateComponent"),a=e("./LayerCustomPopUp"),c=e("./LayerDialog"),s=e("./LayerFloat"),l=e("./LayerLoading"),u=e("./LayerNotify"),p=e("./LayerPopup"),d=e("./LayerUI"),h=function(){function e(){}return e.init=function(t){if(e.ui)cc.warn("\u3010gui\u3011\u91cd\u590d\u8c03\u7528\u521d\u59cb\u5316\uff01");else{e.ui=new d.LayerUI("LayerUI",new cc.Node),e.customPopup=new a.LayerCustomPopUp("LayerCustomPopUp",null),e.float=new s.LayerFloat("LayerFloat",new cc.Node),e.popup=new p.LayerPopUp("LayerPopUp",new cc.Node),e.loading=new l.LayerLoading("LayerLoading",new cc.Node),e.dialog=new c.LayerDialog("LayerDialog",new cc.Node),e.alert=new c.LayerDialog("LayerAlert",new cc.Node),e.notify=new u.LayerNotify("LayerNotify",new cc.Node),t.addChild(e.ui.layer),t.addChild(e.float.layer),t.addChild(e.popup.layer),t.addChild(e.loading.layer),t.addChild(e.dialog.layer),t.addChild(e.alert.layer),t.addChild(e.notify.layer);var o=function(){var t=cc.winSize.width,o=cc.winSize.height;e.ui.layout(t,o),e.float.layout(t,o),e.popup.layout(t,o),e.loading.layout(t,o),e.dialog.layout(t,o),e.alert.layout(t,o),e.notify.layout(t,o)};o(),i.Message.on(n.EngineMessage.GAME_RESIZE,o,t),window.$gui=e}},e.releaseAll=function(){e.ui.clear(),e.float.clear(),e.popup.clear(),e.loading.clear(),e.dialog.clear(),e.alert.clear(),e.notify.clear()},e.delete=function(e){if(e instanceof cc.Node){var t=e.getComponent(r.default);t&&t.viewParams?t.removeView():(cc.warn("\u3010gui\u3011\u5f53\u524d\u5220\u9664\u7684node\u4e0d\u662f\u901a\u8fc7gui\u6846\u67b6\u6dfb\u52a0\u5230\u821e\u53f0\u4e0a\uff01"),e.destroy())}else;},e.ui=null,e.float=null,e.popup=null,e.loading=null,e.dialog=null,e.alert=null,e.notify=null,e.customPopup=null,e}();o.gui=h,cc._RF.pop()},{"../EngineMessage":"EngineMessage","../event/MessageManager":"MessageManager","./DelegateComponent":"DelegateComponent","./LayerCustomPopUp":"LayerCustomPopUp","./LayerDialog":"LayerDialog","./LayerFloat":"LayerFloat","./LayerLoading":"LayerLoading","./LayerNotify":"LayerNotify","./LayerPopup":"LayerPopup","./LayerUI":"LayerUI"}],GameAudio:[function(e,t,o){"use strict";cc._RF.push(t,"3bc17VkWw5I6JgmbaqjsizZ","GameAudio"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../core/Engine"),i=e("../core/event/MessageManager"),r=e("./AudioMessage"),a=function(){function e(){this.ext=".mp3",this.currentBuildId=-1,this.currentTimer="",this.musicNum=0,this.getRandom=function(e,t){return Math.round(Math.random()*(t-e)+e)},i.Message.on(r.AudioMessage.BGM,this.onHandler,this),i.Message.on(r.AudioMessage.BGM2,this.onHandler,this),i.Message.on(r.AudioMessage.EFFECT,this.onHandler,this),i.Message.on(r.AudioMessage.BUILD_EFFECT,this.onHandler,this),this.dirPath="main/audio/"}return e.prototype.onHandler=function(e,t){switch(e){case r.AudioMessage.BGM:this.playBGM();break;case r.AudioMessage.BGM2:this.playBGM2();break;case r.AudioMessage.EFFECT:this.playEffect(t);break;case r.AudioMessage.BUILD_EFFECT:this.playBuildEffect(t)}},e.prototype.playBuildEffect=function(e){var t=this;if(e!=this.currentBuildId){if(-1!=this.currentBuildId){var o=this.getRealUrl("build"+this.currentBuildId);cc.log("\u505c\u6b62\u5efa\u7b51\u58f0=>"+this.currentBuildId),n.default.audio.stopEffect(o)}var i=this.getRealUrl("build"+e);cc.log("\u64ad\u653e\u5efa\u7b51\u58f0=>"+e),n.default.audio.playEffect(i),this.currentBuildId=e,n.default.timer.unschedule(this.currentTimer),this.currentTimer=n.default.timer.scheduleOnce(function(){t.currentBuildId=-1},8)}},e.prototype.playNumMusicLoop=function(e,t){var o=this;n.default.audio.playMusic(e,!1,function(){1==o.musicNum++?t&&t():(cc.log("\u80cc\u666f\u97f3\u4e50\u5faa\u73af"+o.musicNum),o.playNumMusicLoop(e,t))})},e.prototype.playBGM=function(){var e=this;cc.log("\u64ad\u653e\u666e\u901a\u7684\u80cc\u666f\u97f3\u4e50"),this.musicNum=0;var t=this.getRandom(1,3),o=this.getRealUrl("bgm"+t);this.playNumMusicLoop(o,function(){var t=e.getRealUrl("bgs");n.default.audio.playMusic(t,!1,function(){e.playBGM()})})},e.prototype.playBGM2=function(){cc.log("\u5207\u6362\u5730\u6807 \u5207\u6362\u80cc\u666f\u97f3\u4e50"),this.playBGM()},e.prototype.playEffect=function(e){cc.log("\u64ad\u653e\u97f3\u6548",e);var t=this.getRealUrl(e);n.default.audio.playEffect(t)},e.prototype.getRealUrl=function(e){var t=this.dirPath+e+this.ext;return console.log(111,t),t},e}();o.GameAudio=a,cc._RF.pop()},{"../core/Engine":"Engine","../core/event/MessageManager":"MessageManager","./AudioMessage":"AudioMessage"}],GameConfig:[function(e,t,o){"use strict";cc._RF.push(t,"00d524dw2FMdaDkmM7kaSH8","GameConfig"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../core/ezplugin/ezplugin"),i=e("../../core/http/Http"),r=e("../../core/Engine"),a=function(){function e(e){this._data=null;var t=e;this._data=t}return Object.defineProperty(e.prototype,"language",{get:function(){return this._data.language},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),e.prototype.setData=function(e){for(var t in e)this._data[t]=e[t];r.default.log.info("[GameConfig] \u5408\u5e76\u540e\u7684\u6e38\u620f\u914d\u7f6e\u6570\u636e",JSON.stringify(this._data,null,2))},e.prototype.checkGateServer=function(e){var t=this._data.gate_server,o={packageName:n.ezplugin.sysInfo.packageName||this._data.packageName,os:cc.sys.isBrowser?"web":cc.sys.os.toLowerCase(),version:r.default.appVersion};cc.log(t+"\u8bf7\u6c42\u53c2\u6570",o),i.http.post(t,o,{headers:{"Content-type":"application/json"},callback:function(o,n){if(o)return r.default.log.info(t+"\u8bf7\u6c42\u9519\u8bef\uff0c"+o.code+" message:"+o.message),cc.error(o),void e(o);n&&cc.log(n),e(o,n.data.data||null)}})},e}();o.default=a,cc._RF.pop()},{"../../core/Engine":"Engine","../../core/ezplugin/ezplugin":"ezplugin","../../core/http/Http":"Http"}],GameData:[function(e,t,o){"use strict";cc._RF.push(t,"f5aaaBC3FpPk5KRCSFDE7Hd","GameData"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../core/util/HashMap"),i=function(){return function(){this.storesIdLv=new n.HashMap,this.clerksIdLv=new n.HashMap,this.fameIdLv=new n.HashMap,this.collectSpeedData=new n.HashMap,this.rewardTotalAvg=null,this.storeBaseRewardList=new n.HashMap,this.updateTime=0,this.headId=null,this.nickName="",this.cityId=0,this.fame=0,this.npcConfig=new n.HashMap,this.npcData=null,this.newPropId=[],this.mainMutiEndTime=0,this.getFameTime=0,this.fameNpcNum=0}}();o.GameData=i,cc._RF.pop()},{"../core/util/HashMap":"HashMap"}],GameMainControl:[function(e,t,o){"use strict";cc._RF.push(t,"38e4f6QoKhFuK3288mBDM8F","GameMainControl");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../core/event/MessageManager"),a=e("../../core/gui/GUI"),c=e("../../core/language/LanguageLabel"),s=e("../../core/ui/button/ButtonEffect"),l=e("../../core/ui/ComponentExtends"),u=e("../../core/ui/ExToggleGroup"),p=e("../../core/ui/label/LabelChangeSymbol"),d=e("../../core/ui/ViewUtils"),h=e("../../core/util/HashMap"),f=e("../../Main"),g=e("../../map/SceneMap"),m=e("../../service/config/Config"),v=e("../../service/Service"),_=e("../AudioMessage"),y=e("./adv/LandmarkProgress"),b=e("./effect/MapControl"),C=e("./effect/PosterTip"),T=e("./novice/MainTaskTip"),S=e("./ShopComponent"),E=e("./ShoppingComponent"),L=e("./StoreComponent"),w=e("./StoreOperation"),k=e("./StoreUnLock"),P=ezaction.HCustomEase.create("ce","M0,0 C0.029,0.214 0.033,0.386 0.044,0.521 0.062,0.772 0.095,0.98 0.138,1.016 0.145,1.022 0.145,0.96 0.216,0.96 0.23,0.96 0.267,1 0.3,1 0.472,1 0.757,1 1,1"),N=ezaction.ease.customEase(P),A=function(){return function(){this.prop_5=0,this.prop_6=0,this.prop_7=0,this.prop_8=0,this.prop_9=0,this.prop_10=0,this.prop_11=0}}();o.PropAddType=A;var O=cc._decorator,I=O.ccclass,R=(O.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.mainNodes=null,t.popup_container=null,t.propAddType=new A,t.storeOperation=null,t.landMarkCom=null,t.mainTaskTip=null,t.preCredit={num:0,numE:0},t.preCreditUi={num:0,numE:0},t.preStoreList=null,t.onceEntry=!0,t.isProtocol=!1,t._clerkChangeId=null,t.preFameList=null,t.prePropStorageList=null,t.preTaskList=null,t.preLevel=null,t.preNoviceProgress=null,t.isPublicGetFame=!1,t.propAddInfo=new h.HashMap,t.propMutiAdd=1,t.propCostAdd=1,t.mainAdMuti=1,t.mainAdMutiEndTime=0,t.pop_storeunlock_id="",t.isNovicePackage=!1,t.currentPop="",t.isShopClerkPoint=!1,t.isShopFamePoint=!1,t}return n(t,e),t.prototype.checkCollidPoints=function(e){var t=d.ViewUtils.nodeTreeInfoLite(f.default.module.mainScene.node);return!!cc.Intersection.pointInPolygon(e,t.get("adv_colid").getComponent(cc.PolygonCollider).world.points)},t.prototype.onLoad=function(){var e=this;this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchHandler,this),this.mainNodes=d.ViewUtils.nodeTreeInfoLite(this.node),this.popup_container=this.mainNodes.get("popup_container"),this.popup_container.active=!1,a.gui.customPopup.setLayer(this.popup_container),this.mainNodes.get("muti_spr").active=!1,this.mainNodes.get("cost_spr").active=!1,this.mainNodes.get("adv_panel").active=!1,this.mainNodes.get("main_time_lab").active=!1;var t=cc.sys.getSafeAreaRect();this.mainNodes.get("top_panel_1").active=!1,this.mainNodes.get("diamond_lab").getComponent(cc.Label).string="",cc.winSize.height>t.height&&(this.mainNodes.get("top_panel_1").active=!0,this.mainNodes.get("top").getComponent(cc.Widget).updateAlignment(),this.mainNodes.get("left").getComponent(cc.Widget).top=this.mainNodes.get("top").height),this.scheduleOnce(function(){e.mainNodes.get("main_tip").getComponent(cc.Widget).top=e.mainNodes.get("top").height+15,e.mainNodes.get("main_tip").width=cc.winSize.width,e.mainNodes.get("main_tip").getComponent(cc.Widget).updateAlignment()}),this.popup_container.on(cc.Node.EventType.CHILD_REMOVED,function(){e.currentPop="",e.mainNodes.get("bottom").active=!0},this),f.default.module.gamedata.mainMutiEndTime=cc.sys.localStorage.getItem("mainMutiEndTime")||0,f.default.module.gamedata.fameNpcNum=cc.sys.localStorage.getItem("fameNpcNum")||0},t.prototype.initUserView=function(){var e=this,t=f.default.module.vm;this.showButtonEffect(this.mainNodes.get("btn_task"),!1),this.showButtonEffect(this.mainNodes.get("btn_shop"),!1),this.showButtonEffect(this.mainNodes.get("btn_shopping"),!1),this.showButtonEffect(this.mainNodes.get("btn_world"),!1),this.showButtonEffect(this.mainNodes.get("btn_package"),!1),this.mainTaskTip=this.mainNodes.get("main_tip").getComponent(T.default);var o=f.default.module.calcTool;this.preCredit=t.credit,this.preCreditUi=t.credit,this.preLevel=t.level,this.preNoviceProgress=t.noviceProgress,this.mainNodes.get("lab_credit").getComponent(p.LabelChangeSymbol).num=t.credit,this.mainNodes.get("red_point_package").active=!1,this.mainNodes.get("red_point_gift").active=-1==v.service.account.data.loginTime.indexOf(v.service.account.data.nowDate),this.mainNodes.get("red_point_ranking").active=-1==v.service.account.data.loginTime.indexOf(v.service.account.data.nowDate),this.mainNodes.get("btn_gift").getComponent(sp.Skeleton).setAnimation(0,"animation",!0),this.mainNodes.get("adv_").getComponent(sp.Skeleton).setAnimation(0,"animation",!0),t.watch("cityId",function(t){t&&(e.onceEntry,e.onceEntry=!1)},this),t.watch("diamond",function(t){e.mainNodes.get("diamond_lab").getComponent(cc.Label).string=t},this),t.watch("fame",function(o){o.num!=t.fame.num&&o.numE!=t.fame.numE&&t.fameList,e.refreshShopFameRedPoint()},this),t.watch("credit",function(t){if(t){var n=o.formatNum(t).base,i=o.formatNum(e.preCredit).base,r=o.formatNum(t).gear,a=o.formatNum(e.preCredit).gear;Number(n.toFixed(1))==Number(i.toFixed(1))&&r==a||(e.refreshShopClerkRedPoint(),e.mainNodes.get("lab_credit").getComponent(p.LabelChangeSymbol).num=t,e.refreshUpTip(),e.storeOperation&&f.default.module.calcTool.compareLess(e.preCredit,t)&&e.storeOperation.setLvGear()),e.mainTaskTip.refreshMainProgressInfo(),e.preCredit=t,f.default.module.calcUiShow.calcPassBarrier()}},this),t.watch("refreshCreditUi",function(e){},this),t.watch("isPass",function(t){e.mainNodes.get("red_point_world").active=1==t&&1==f.default.module.vm.noviceProgress.novice_7},this),t.watch("storeList",function(o){if(o){if(!e.checkStoreListLv(e.preStoreList,o))return;f.default.module.mainScene.storesNode.children.forEach(function(e){var t=e.getComponent(L.default);t&&(t.refreshUi(o[t.storeTag]),t.noviceStart(o[t.storeTag].level))}),e.storeOperation&&(e.storeOperation.setBasePrice(),e.refreshStoreProgress(e.storeOperation.currentViewStoreId)),e.refreshShopClerkRedPoint(),e.refreshStoresCollectSpeed(),f.default.module.calcTool.compare(t.credit,{num:4,numE:0})&&1==t.storeList.store_1.level&&0==t.noviceProgress.novice_3&&1==t.level&&f.default.module.noviceHandle.noviceUpStore(function(){var t=f.default.module.calcUiShow.calcTargetPrice("store_1",1,1);f.default.module.mainScene.storesNode.getChildByName("store_1").getComponent(L.default).upLvHandler(1,t,!1,function(){e.storeOperation.loadStoreBaseInfo()})}),e.mainTaskTip.refreshMainProgressInfo(),f.default.module.mapNpcController.createNpcs(e.getUnlockStoreIds()),e.preStoreList=o}},this),t.watch("clerkList",function(t){if(t){var o=f.default.module.mainScene.storesNode;for(var n in o.children.forEach(function(e){var o=e.getComponent(L.default);o&&o.storeId==t["clerk_"+o.storeId].id&&(o.currentClerkLv=t["clerk_"+o.storeId].level)}),t){var i=t[n];f.default.module.gamedata.clerksIdLv.set(i.id,i.level)}e.mainTaskTip.refreshMainProgressInfo(),e.refreshShopClerkRedPoint(),e.refreshStoresCollectSpeed()}},this),t.watch("fameList",function(t){if(t){for(var o in t){var n=parseInt(t[o].id),i=t[o];f.default.module.gamedata.fameIdLv.set(n,i.level)}e.preFameList=t,e.refreshShopFameRedPoint(),e.refreshStoresCollectSpeed()}},this),t.watch("goodsInfo",function(t){t&&e.refreshStoresCollectSpeed()},this),t.watch("level",function(t){if(e.mainNodes.get("red_point_task").active=e.preLevel!=t,e.preLevel!=t){e.supClickEvent(t),r.Message.dispatchEvent(_.AudioMessage.BGM),e.mainNodes.get("city_lab").getComponent(c.LanguageLabel).dataID="ui_map_"+t;var o=cc.loader.getRes("main/country/country_"+t,cc.SpriteFrame);e.mainNodes.get("country").getComponent(cc.Sprite).spriteFrame=o,t=t>9?9:t,f.default.module.mainScene.exchangeScene(t),f.default.module.mainScene.refreshStores(t)}var n=t,i=[cc.v2(530,-335),cc.v2(585,-330),cc.v2(640,-335),cc.v2(545,-530)],a=i[0];switch(t){case 1:n=3;break;case 2:n=1,a=i[0];break;case 3:n=2,a=i[1];break;case 4:case 5:case 6:n=3,a=i[2];break;case 7:case 8:case 9:case 10:n=4,a=i[3]}f.default.module.mainScene.storesNode.getComponent(g.default).initMapData(n);var s=f.default.module.mainScene.node.getChildByName("content").getChildByName("adv");s.active=1!=t,s.setPosition(a),s.getChildByName("spine").getComponent(sp.Skeleton).setSkin("db_"+t),e.refreshGraden(t),e.preLevel=t},this),t.watch("advCount",function(t){d.ViewUtils.nodeTreeInfoLite(e.landMarkCom.node.parent).get("adv_skeleton").getComponent(sp.Skeleton).setAnimation(0,t>=5?"reward_2":"reward",!0)},this),t.watch("sellNum",function(t){e.mainTaskTip.refreshMainProgressInfo()},this),t.watch("npcNum",function(t){e.mainTaskTip.refreshMainProgressInfo()},this),t.watch("mainProgress",function(t){e.mainTaskTip.refreshMainProgressInfo()},this),t.watch("noviceProgress",function(t){t&&(e.mainNodes.get("btn_gift").active=1==t.novice_7||f.default.module.vm.level>1||"1"===m.default.query.gift,e.mainNodes.get("btn_ranking").active=1==t.novice_7||f.default.module.vm.level>1,e.mainNodes.get("btn_adv").active=1==t.novice_7||f.default.module.vm.level>1,e.landMarkCom.node.parent.getChildByName("circle").active=1==t.novice_7||f.default.module.vm.level>1,e.showButtonEffect(e.mainNodes.get("btn_task"),1==t.novice_5||f.default.module.vm.level>1),e.showButtonEffect(e.mainNodes.get("btn_shop"),1==t.novice_4||f.default.module.vm.level>1||f.default.module.vm.clerkList.clerk_1.level>0),e.showButtonEffect(e.mainNodes.get("btn_shopping"),1==t.novice_6||f.default.module.vm.level>1),e.showButtonEffect(e.mainNodes.get("btn_world"),1==t.novice_7||f.default.module.vm.level>1),e.showButtonEffect(e.mainNodes.get("btn_package"),1==t.novice_9),e.showButtonEffect(e.mainNodes.get("btn_add"),1==f.default.module.vm.noviceProgress.novice_7||f.default.module.vm.level>1),e.mainTaskTip.refreshMainProgressInfo(),e.preNoviceProgress=t)},this),t.watch("propStorageList",function(t){if(t){for(var o in t){var n=e.prePropStorageList[o],i=t[o];!n&&i.totalCount>0?f.default.module.gamedata.newPropId.push(i.pid):i.totalCount>n.totalCount&&f.default.module.gamedata.newPropId.push(i.pid)}cc.log(f.default.module.gamedata.newPropId),e.prePropStorageList=t}},this),t.watch("taskList",function(t){if(t){if(!f.default.module.calcUiShow.checkTaskListChange(e.preTaskList,t))return;var o=0;for(var n in e.preTaskList){2==e.preTaskList[n].status&&o++}var i=0;for(var n in t){2==t[n].status&&i++}i>o&&(e.mainNodes.get("red_point_task").active=!0),e.preTaskList=t}},this),t.watch("propList",function(t){t&&(e.setPropEndTime(t),e.refreshStoresCollectSpeed())},this),f.default.module.gameProtocol.requestPropStorageList(function(o){e.prePropStorageList=o.propStorageList,t.propStorageList=o.propStorageList}),f.default.module.gameProtocol.requestTaskList(function(e){t.taskList=e.taskList}),this.mainTaskTip.entryNoviceNoFinish()},t.prototype.refreshGraden=function(e){d.ViewUtils.nodeTreeInfoLite(f.default.module.mainScene.node).get("scene_bg").children.forEach(function(t){var o=f.default.module.calcUiShow.checkLockStoreIdByLevel();t.active=parseInt(t.name.split("_")[1])>o&&e>1})},Object.defineProperty(t.prototype,"clerkChangeId",{get:function(){return this._clerkChangeId},set:function(e){this._clerkChangeId=e,this.clerkChangeAnim()},enumerable:!0,configurable:!0}),t.prototype.clerkChangeAnim=function(){var e=this,t=f.default.module.mainScene.node.getChildByName("content").getComponent(b.MapControl);if(t.node.StopAllActions(),this.clerkChangeId){var o=f.default.module.mainScene.storesNode.getChildByName("clerk_"+this.clerkChangeId);t.followTargetPos(o,.5,function(){var n=o.getChildByName("clerk_up").getComponent(sp.Skeleton);n.setCompleteListener(function(o){"reward_1"==o.animation.name&&(e._clerkChangeId=null,t.isMoving=!1)}),n.setAnimation(0,"reward_1",!1)},!0)}else t.isMoving=!1},t.prototype.supClickEvent=function(e){switch(e){case 2:v.service.analytics.logEvent("unlock_laos_num","","");break;case 3:v.service.analytics.logEvent("unlock_thai_num","","");break;case 4:v.service.analytics.logEvent("unlock_cam_num","","");break;case 5:v.service.analytics.logEvent("unlock_mal_num","","");break;case 6:v.service.analytics.logEvent("unlock_sing_num","","");break;case 7:v.service.analytics.logEvent("unlock_ind_num","","");break;case 8:v.service.analytics.logEvent("unlock_jap_num","","");break;case 9:v.service.analytics.logEvent("unlock_kor_num","","");break;case 10:v.service.analytics.logEvent("unlock_chi_num","","")}},t.prototype.update=function(){this.calcCurrentPropAdd();var e=f.default.module.gamedata.getFameTime-f.default.module.calcUiShow.getSeverCurrentTime(),t=f.default.module.themeConfig.getBuildingConfigById(f.default.module.vm.level).fameCount;this.isPublicGetFame=e<=0&&f.default.module.gamedata.fameNpcNum>=t,this.isPublicGetFame?this.mainNodes.get("red_point_clerk").active=!0:this.isShopFamePoint||this.isShopClerkPoint||(this.mainNodes.get("red_point_clerk").active=!1)},t.prototype.openStoreOperationBtnState=function(e){void 0===e&&(e=!1),this.mainTaskTip.lockMainTaskTip(e),this.showButtonEffect(this.mainNodes.get("btn_gift"),!e),this.showButtonEffect(this.mainNodes.get("btn_adv"),!e),this.showButtonEffect(this.mainNodes.get("btn_ranking"),!e),this.showButtonEffect(this.mainNodes.get("muti_spr"),!e),this.showButtonEffect(this.mainNodes.get("cost_spr"),!e)},t.prototype.refreshUpTip=function(){f.default.module.mainScene.storesNode.children.forEach(function(e){var t=e.getComponent(L.default);t&&t.refreshUpTip()})},t.prototype.setPropEndTime=function(e){for(var t in e)this.propAddType[t]=e[t].endTime,this.propAddInfo.set(e[t].pid,e[t].endTime)},t.prototype.calcCurrentPropAdd=function(){var e=this.propAddInfo.keys(),t=f.default.module.calcUiShow.getSeverCurrentTime(),o=f.default.module.gamedata.mainMutiEndTime;if(0!=e.length||!(0==o||o<=t)){f.default.module.calcUiShow.sort(e);for(var n=1,i=0,r=1,c=0,s=0;s<e.length;s++)if(e[s]<9){var l=this.propAddInfo.get(e[s]);if(l>t)n*=f.default.module.themeConfig.getPropConfigByTag("add_"+e[s]).addValue[0],i=l}else if(e[s]>8&&e[s]<12){var u=this.propAddInfo.get(e[s]);if(u>t)r*=f.default.module.themeConfig.getPropConfigByTag("add_"+e[s]).addValue[0],c=u}var d,h=1,g=0;if(0==o||o-t<=0?(h=1,g=0):o-t>0&&(h=3,g=o-t),this.mainNodes.get("muti_spr").active=1!=n,this.mainNodes.get("cost_spr").active=1!=r,this.mainNodes.get("main_time_lab").active=1!=h,n!=this.propMutiAdd||h!=this.mainAdMuti)if(this.propMutiAdd=n,this.mainAdMuti=h,this.refreshStoresCollectSpeed(),this.storeOperation&&this.storeOperation.setSpeedLab(),this.popup_container.getChildByName("shopping")&&this.popup_container.getChildByName("shopping").getComponent(E.default).refreshList(),a.gui.popup.has("popup/landmark_progress"))if((d=a.gui.popup.$get("popup/landmark_progress")[0])&&d.getComponent(y.default)){var m=d.getChildByName("layout").getChildByName("coin_num"),v=f.default.module.calcUiShow.getTimeStageReward(300);0==v.num&&(v={num:1,numE:3}),m.getComponent(p.LabelChangeSymbol).num=v}if(r!=this.propCostAdd)if(this.propCostAdd=r,this.refreshUpTip(),this.storeOperation&&this.storeOperation.setBasePrice(),a.gui.popup.get(this.pop_storeunlock_id))(d=a.gui.popup.get(this.pop_storeunlock_id)).getComponent(k.default).refreshLab();this.mainNodes.get("muti_num").getComponent(cc.Label).string="x"+n,this.mainNodes.get("muti_lab").getComponent(cc.Label).string=f.default.module.calcUiShow.formatTime(i-t),this.mainNodes.get("cost_num").getComponent(cc.Label).string=Math.floor(100*r)+"%",this.mainNodes.get("cost_lab").getComponent(cc.Label).string=f.default.module.calcUiShow.formatTime(c-t),this.mainNodes.get("main_time_lab").getComponent(cc.Label).string=f.default.module.calcUiShow.formatTime(g),this.mainAdMutiEndTime=g}},t.prototype.checkStoreListLv=function(e,t){if(!e)return!0;for(var o in e)if(e[o].level!=t[o].level)return!0;return!1},t.prototype.shopFameIsShow=function(){return f.default.module.vm.noviceProgress.novice_9>0},t.prototype.refreshStoresCollectSpeed=function(){var e=f.default.module.vm,t=this.propMutiAdd*this.mainAdMuti*f.default.module.themeConfig.getBuildingConfigById(e.level).multi;if(e.storeList&&e.clerkList&&e.fameList&&e.goodsInfo){var o=f.default.module.calcUiShow.calcCollectSpeed(t);f.default.module.mainScene.storesNode.children.forEach(function(e){var t=e.getComponent(L.default);t&&t.setSpeedLab(o.get(t.storeTag))})}},t.prototype.refreshStoreProgress=function(e){void 0===e&&(e=-1),f.default.module.mainScene.storesNode.children.forEach(function(t){var o=t.getComponent(L.default);if(o){var n=f.default.module.themeConfig.getStoreMaxLvById(o.storeId),i=f.default.module.calcUiShow.calcTargetPrice(o.storeTag,o.currentStoreLv,1);f.default.module.calcTool.compare(f.default.module.vm.credit,i)&&o.currentStoreLv;(o.storeId==e||-1==e)&&o.currentStoreLv>0?o.mainNodes.get("btn_progress").active=!0:o.mainNodes.get("btn_progress").active=!1,o.storeId!=e&&-1!=e||0!=o.currentStoreLv?o.mainNodes.get("btn_lock").active=!1:o.mainNodes.get("btn_lock").active=!0}})},t.prototype.cacheMainMutiTime=function(){var e=f.default.module.calcUiShow.getSeverCurrentTime()+432e5,t=f.default.module.calcUiShow.getSeverCurrentTime();0==f.default.module.gamedata.mainMutiEndTime||f.default.module.gamedata.mainMutiEndTime<=t?f.default.module.gamedata.mainMutiEndTime=t+72e5:f.default.module.gamedata.mainMutiEndTime+=72e5,f.default.module.gamedata.mainMutiEndTime>=e&&(f.default.module.gamedata.mainMutiEndTime=e),cc.sys.localStorage.setItem("mainMutiEndTime",JSON.stringify(f.default.module.gamedata.mainMutiEndTime))},t.prototype.openMainPop=function(e,t){var o=this;if(r.Message.dispatchEvent(_.AudioMessage.EFFECT,"window"),!this.node.parent.getChildByName("content").getComponent(b.MapControl).isMoving){this.storeOperation&&(this.storeOperation.currentViewStoreId=-1,this.storeOperation=null);var n=e.split("_")[1];if(this.currentPop!=n){a.gui.customPopup.clear(),this.currentPop=n,this.mainNodes.get("bottom").active="world"!=n,this.popup_container.active=!0,v.service.prompt.netInstableOpen();var i={modal:!0,touchClose:!1,opacity:150,onAdded:function(e,i){if(v.service.prompt.netInstableClose(),o.currentPop=n,e.x=0,"credit"==n||"fame"==n||"setting"==n){var r=o.mainNodes.get("btn_credit").parent.convertToWorldSpaceAR(o.mainNodes.get("btn_credit").getPosition()),a=o.popup_container.convertToNodeSpaceAR(r);e.y=a.y-e.height/2,e.RunAction(ezaction.moveTo(.2,{y:30})),t&&t()}else e.y=-cc.winSize.height/2,e.RunAction(ezaction.moveTo(.2,{y:30})),t&&t()},onBeforeRemove:function(e,t){o.currentPop="",e.destroy(),t()}};a.gui.customPopup.add("popup/"+n,{},i)}}},t.prototype.openStoreOperation=function(e){var t=this;if(void 0===e&&(e=-1),!this.node.parent.getChildByName("content").getComponent(b.MapControl).isMoving&&"operation"!=this.currentPop){a.gui.popup.clear(),a.gui.customPopup.clear(),this.currentPop="operation",this.mainNodes.get("bottom").active=!0,this.popup_container.active=!0,v.service.prompt.netInstableOpen();var o={touchClose:!1,onAdded:function(e,o){t.storeOperation=e.getComponent(w.default),t.currentPop="operation",e.x=0,e.y=-cc.winSize.height/2,v.service.prompt.netInstableClose(),e.RunAction(ezaction.moveTo(1,{y:30}).easing(N)).onStoped(function(){})},onRemoved:function(){t.currentPop="",t.storeOperation=null}};a.gui.customPopup.add("main/store_operation",{contentNode:this.node.parent.getChildByName("content"),storesNode:f.default.module.mainScene.storesNode,storeId:e},o)}},t.prototype.onTouchHandler=function(e){if(f.default.module.mainScene.mapControl.isMoving)this.node._touchListener&&this.node._touchListener.setSwallowTouches(!1);else switch(e.target.name){case"btn_setting":case"btn_shopping":case"btn_shop":case"btn_task":case"btn_package":case"btn_world":if(e.target.getComponent(s.default)&&!e.target.getComponent(s.default).canTouch)return;this.openMainPop(e.target.name);break;case"btn_credit":this.openMainPop("btn_credit");break;case"pic_diamond":case"btn_add":return void(0==f.default.module.vm.noviceProgress.novice_7&&f.default.module.vm.level);case"btn_adv":if(e.target.getComponent(s.default)&&!e.target.getComponent(s.default).canTouch)return;var t={touchClose:!0,modal:!0,opacity:120,onAdded:function(e,t){e.x=0,e.y=30,e.scale=.1,e.RunAction(ezaction.scaleTo(.3,{scale:1}))},onBeforeRemove:function(e,t){e.RunAction(ezaction.scaleTo(.2,{scale:.1})).onStoped(t)}};a.gui.popup.add("popup/adv_main_muti",{mainControl:this},t)}},t.prototype.openMenu=function(e){this.mainNodes.get("menu").active=e},t.prototype.getUnlockStoreIds=function(){var e=[],t=f.default.module.vm.storeList;for(var o in t)t[o].level>0&&e.push(t[o].id+"");return e},t.prototype.showButtonEffect=function(e,t){var o=t?cc.Color.WHITE:cc.Color.GRAY,n=e.getComponent(s.default);e.color=o,n&&(n.canTouch=t);var i=function(e){if(0!=e.children.length)for(var t=0,n=e.children;t<n.length;t++){var r=n[t];r.color=o,i(r)}};i(e)},t.prototype.openPosterTip=function(e){var t=cc.loader.getRes("main/poster_finish",cc.Prefab),o=cc.instantiate(t),n={id:e.id,type:e.type,value:e.value};o.getComponent(C.default).setData(n),o.parent=this.node.getChildByName("main");var i=this.node.getChildByName("main").width;this.node.getChildByName("main").height;o.x=-i,o.y=480,o.RunAction(ezaction.moveTo(.5,{x:-i/2})).onStoped(function(){25==e.level&&f.default.module.vm.noviceProgress.novice_4}),r.Message.dispatchEvent(_.AudioMessage.EFFECT,"shop_warn")},t.prototype.openShop=function(e,t){var o=this;this.openMainPop("btn_shop",function(){var n=o.popup_container.getChildByName("shop");o.scheduleOnce(function(){n.getComponent(S.default).scollviewSwitch(0==e),n.getComponent(S.default).mainNodes.get("toggle_group").getComponent(u.default).setIndex(e),t&&t()})})},t.prototype.playCreditEffect=function(e,t){var o=this;r.Message.dispatchEvent(_.AudioMessage.EFFECT,"additional_coin");var n=this.mainNodes.get("lab_credit").parent.convertToWorldSpaceAR(this.mainNodes.get("lab_credit").getPosition()),i=this.mainNodes.get("effect").convertToNodeSpaceAR(n),a=new cc.Node,c=a.addComponent(sp.Skeleton);c.skeletonData=cc.loader.getRes("main/skeleton/offline_gold",sp.SkeletonData),a.parent=this.mainNodes.get("effect"),a.setPosition(i);var s=cc.loader.getRes("main/effect_prefab/credit_skeleton",cc.Prefab),l=cc.instantiate(s);l.parent=this.mainNodes.get("effect"),l.x=0,l.y=0;var u=l.getChildByName("lab");u.scale=0,u.getComponent(p.LabelChangeSymbol).num=e,u.RunAction(ezaction.scaleTo(.5,{scale:3})).onStoped(function(){u.RunAction(ezaction.moveTo(.5,{y:i.y-20,delay:1})).onStoped(function(){u.active=!1,l.destroy(),t&&t(e)}),u.RunAction(ezaction.fadeTo(.5,50,{delay:1})).onStoped(function(){})});var d=null;c.setEventListener(function(e,t){if("1"==t.data.name){var n=cc.loader.getRes("main/effect_prefab/credit_effect",cc.Prefab);(d=cc.instantiate(n)).parent=o.mainNodes.get("effect"),d.setPosition(i)}}),c.setCompleteListener(function(){a.destroy()}),c.setAnimation(0,"reward",!1)},t.prototype.playAdDiamondEffect=function(e){var t=this;r.Message.dispatchEvent(_.AudioMessage.EFFECT,"additional_gem");var o=this.mainNodes.get("diamond_panel").parent.convertToWorldSpaceAR(this.mainNodes.get("diamond_panel").getPosition()),n=this.mainNodes.get("effect").convertToNodeSpaceAR(o),i=new cc.Node,a=i.addComponent(sp.Skeleton);a.premultipliedAlpha=!1,a.skeletonData=cc.loader.getRes("main/skeleton/offline_zuanshi",sp.SkeletonData),i.parent=this.mainNodes.get("effect"),i.setPosition(n);var c=cc.loader.getRes("main/effect_prefab/credit_skeleton",cc.Prefab),s=cc.instantiate(c);s.parent=this.mainNodes.get("effect"),s.x=0,s.y=0,s.getChildByName("lab").active=!1,this.scheduleOnce(function(){s.destroy()},3);var l=null;a.setEventListener(function(o,i){if("1"==i.data.name){var r=cc.loader.getRes("main/effect_prefab/credit_effect",cc.Prefab);(l=cc.instantiate(r)).parent=t.mainNodes.get("effect"),l.setPosition(n),e&&e()}}),a.setCompleteListener(function(){i.destroy()}),a.setAnimation(0,"reward",!1)},t.prototype.playDiamondffect=function(e){var t=this;r.Message.dispatchEvent(_.AudioMessage.EFFECT,"additional_coin");var o=cc.loader.getRes("main/effect_prefab/diamond_effect",cc.Prefab),n=this.mainNodes.get("diamond_panel").parent.convertToWorldSpaceAR(this.mainNodes.get("diamond_panel").getPosition()),i=this.mainNodes.get("effect").convertToNodeSpaceAR(n),a=cc.instantiate(o);a.setPosition(i),a.parent=this.mainNodes.get("effect"),this.scheduleOnce(function(){var e=cc.loader.getRes("main/effect_prefab/diamond_effect2",cc.Prefab),o=cc.instantiate(e);o.parent=t.mainNodes.get("effect"),o.setPosition(i)},.7),this.scheduleOnce(function(){e&&e()},1.2)},t.prototype.clearContainer=function(){this.mainNodes.get("effect").children.forEach(function(e){e.destroy()})},t.prototype.playPackageffect=function(e){var t=this;r.Message.dispatchEvent(_.AudioMessage.EFFECT,"additional_coin");var o=cc.loader.getRes("main/effect_prefab/package_effect",cc.Prefab),n=this.mainNodes.get("btn_package").parent.convertToWorldSpaceAR(this.mainNodes.get("btn_package").getPosition()),i=this.mainNodes.get("effect").convertToNodeSpaceAR(n),a=cc.instantiate(o);a.setPosition(i),a.parent=this.mainNodes.get("effect"),this.scheduleOnce(function(){var e=cc.loader.getRes("main/effect_prefab/package_effect2",cc.Prefab),o=cc.instantiate(e);o.parent=t.mainNodes.get("effect"),o.setPosition(i)},.7),this.scheduleOnce(function(){e&&e(),1==f.default.module.vm.noviceProgress.novice_9&&(t.mainNodes.get("red_point_package").active=!0)},1.2)},t.prototype.refreshShopClerkRedPoint=function(){var e=this,t=f.default.module.gamedata.clerksIdLv.keys();this.mainNodes.get("red_point_clerk").active=!1,this.isShopClerkPoint=!1;var o=!1,n=f.default.module.vm.clerkList;if(0!=f.default.module.vm.mainProgress.progress_1){for(var i in n)if(n[i].level>=1){o=!0;break}f.default.module.vm.level>1&&(o=!0),f.default.module.calcTool.compare(f.default.module.vm.credit,{num:200,numE:0})&&(o=!0),t.forEach(function(t){var n=f.default.module.themeConfig.getClerkConfigBytagLv("clerk_"+t,f.default.module.gamedata.clerksIdLv.get(t)+1),i=!1;n&&(i=f.default.module.calcTool.compare(f.default.module.vm.credit,{num:n.clerkPrice,numE:n.clerkPriceE})),11==t||12==t?i&&o&&(e.isShopClerkPoint=!0):i&&f.default.module.gamedata.storesIdLv.get(t)>0&&o&&(e.isShopClerkPoint=!0)}),this.isShopClerkPoint?this.mainNodes.get("red_point_clerk").active=!0:this.isShopFamePoint&&(this.mainNodes.get("red_point_clerk").active=!0)}},t.prototype.refreshShopFameRedPoint=function(){var e=this,t=f.default.module.gamedata.fameIdLv.keys();this.isShopFamePoint=!1,this.shopFameIsShow()&&(t.forEach(function(t){var o=f.default.module.themeConfig.getFameConfigByTagLv("fame_"+t,f.default.module.gamedata.fameIdLv.get(t)+1),n=!1;o&&(n=f.default.module.calcTool.compare(f.default.module.calcTool.calcDivideNum(f.default.module.vm.fame,{num:1,numE:2}),{num:o.price,numE:o.priceE})),n&&e.shopFameIsShow()&&(e.isShopFamePoint=!0)}),this.isShopFamePoint&&(this.mainNodes.get("red_point_clerk").active=!0),this.isShopFamePoint&&(this.mainNodes.get("red_point_clerk").active=!0))},t.prototype.unwatchTargetAll=function(){f.default.module.vm.unwatchTargetAll(this)},t.prototype.onDestroy=function(){a.gui.customPopup.clear(),e.prototype.onDestroy.call(this),f.default.module.vm.unwatchTargetAll(this),this.mainNodes=null,this.popup_container=null,this.propAddType=null,this.storeOperation=null,this.preCredit=null,this.preCreditUi=null,this.preStoreList=null,this.onceEntry=null,this.isProtocol=null,this.propAddInfo=null,this.propMutiAdd=null,this.propCostAdd=null,this.isNovicePackage=null,this.preFameList=null,this.prePropStorageList=null,this.preTaskList=null,this.preLevel=null,this.currentPop=null,this.isShopClerkPoint=null,this.isShopFamePoint=null,this.landMarkCom=null,this.node.off(cc.Node.EventType.TOUCH_END,this.onTouchHandler,this)},t=i([I],t)}(l.ComponentExtends));o.default=R,cc._RF.pop()},{"../../Main":"Main","../../core/event/MessageManager":"MessageManager","../../core/gui/GUI":"GUI","../../core/language/LanguageLabel":"LanguageLabel","../../core/ui/ComponentExtends":"ComponentExtends","../../core/ui/ExToggleGroup":"ExToggleGroup","../../core/ui/ViewUtils":"ViewUtils","../../core/ui/button/ButtonEffect":"ButtonEffect","../../core/ui/label/LabelChangeSymbol":"LabelChangeSymbol","../../core/util/HashMap":"HashMap","../../map/SceneMap":"SceneMap","../../service/Service":"Service","../../service/config/Config":"Config","../AudioMessage":"AudioMessage","./ShopComponent":"ShopComponent","./ShoppingComponent":"ShoppingComponent","./StoreComponent":"StoreComponent","./StoreOperation":"StoreOperation","./StoreUnLock":"StoreUnLock","./adv/LandmarkProgress":"LandmarkProgress","./effect/MapControl":"MapControl","./effect/PosterTip":"PosterTip","./novice/MainTaskTip":"MainTaskTip"}],GameMessage:[function(e,t,o){"use strict";cc._RF.push(t,"feff8CW/CdD+Ktdk8ZmXqws","GameMessage"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(){}return e.RECEIVED_NEW_MAIL="received_new_mail",e.EXIT_VIP_HALL="exit_vip_hall",e.ENTER_VIP_HALL="enter_vip_hall",e}();o.GameMessage=n,cc._RF.pop()},{}],GameProtocol:[function(e,t,o){"use strict";cc._RF.push(t,"c0ddaXU5GpIFLv2NPypoghi","GameProtocol"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../Main"),i=e("../service/Service");(function(e){e.ONREWARDRESULT="onRewardResult"})(o.EventProtocol||(o.EventProtocol={}));var r=function(){function e(e){this._server=null,this.getRandomNum=function(e,t){return Math.round(Math.random()*(t-e)+e)},this._server=e,e.setErrorCodeHandler(this.errorCodeHandler.bind(this))}return e.prototype.errorCodeHandler=function(e,t){switch(cc.warn("\u3010Server\u3011, \u6536\u5230\u670d\u52a1\u5668\u9519\u8bef "+t),i.service.analytics.logEvent("server_error_code",e,t.toString()),t){case 302:break;default:return i.service.prompt.errorCodePrompt(t),!1}},e.prototype.startPay=function(e,t,o){this._server.safetyRequest("connector.cashHandler.handler",{title:"rechargeBegin",goodsId:e},t,o)},e.prototype.finishApplePay=function(e,t,o,n){cc.log("\u9a8c\u8bc1Apple\u8ba2\u5355\uff0c",JSON.stringify(t));var i={title:"rechargeResult",data:{payType:"apple",status:e}};if(2==e)for(var r in t)i.data[r]=t[r];this._server.safetyRequest("connector.cashHandler.handler",i,o,n)},e.prototype.finishGooglePay=function(e,t,o,n){var i={title:"rechargeResult",data:{payType:"google",status:e}};if(2==e)for(var r in t)i.data[r]=t[r];cc.log("\u9a8c\u8bc1google\u8ba2\u5355\uff0c",JSON.stringify(i)),this._server.safetyRequest("connector.cashHandler.handler",i,o,n)},e.prototype.onRewardResult=function(e){},e.prototype.entry=function(e,t){var o="connector.cashHandler.entry";this._server.request(o,null,function(t){cc.log("\u3010\u6570\u636e\u534f\u8bae\u3011\u8fdb\u5165\u4e3b\u6e38\u620f\u6210\u529f",t),e(t)},function(e){cc.log(o+" \u9519\u8bef",e),t&&t(e)})},e.prototype.requestCashRead=function(e,t){this._server.request("connector.cashHandler.read",e,function(o){cc.log(e.title,o),t&&t(o)},function(e){t&&t(null)})},e.prototype.requestStoreList=function(e){var t=cc.sys.localStorage.getItem("storeList");if(t)t=JSON.parse(t);else{for(var o={},n=0;n<10;n++){var i={id:n+1,level:0,rewardTime:0};o["store_"+(n+1)]=i}t={storeList:o},cc.sys.localStorage.setItem("storeList",JSON.stringify(t))}cc.log("storeList",t),e&&e(t)},e.prototype.requestClerkList=function(e){var t=cc.sys.localStorage.getItem("clerkList");if(t)t=JSON.parse(t);else{for(var o={},n=0;n<12;n++){var i={id:n+1,level:0};o["clerk_"+(n+1)]=i}t={clerkList:o},cc.sys.localStorage.setItem("clerkList",JSON.stringify(t))}cc.log("clerkList",t),e&&e(t)},e.prototype.requestFameList=function(e){var t=cc.sys.localStorage.getItem("fameList");if(t)t=JSON.parse(t);else{for(var o={},n=0;n<11;n++){var i={id:n+1,level:0};o["fame_"+(n+1)]=i}t={fameList:o},cc.sys.localStorage.setItem("fameList",JSON.stringify(t))}cc.log("fameList",t),e&&e(t)},e.prototype.requestGoodsList=function(e){var t=cc.sys.localStorage.getItem("goodsList");if(t)t=JSON.parse(t);else{for(var o={},n=0;n<11;n++){var i={id:n+1,level:0};o["fame_"+(n+1)]=i}t={goodsList:o},cc.sys.localStorage.setItem("goodsList",JSON.stringify(t))}cc.log("goodsList",t),e&&e(t)},e.prototype.checkBuyRecord=function(e,t){var o={title:"checkBuyRecord",goodsId:e};this._server.request("connector.cashHandler.handler",o,function(e){cc.log(o.title,e),t&&t(e)},function(e){t&&t(null)})},e.prototype.requestTaskList=function(e){var t=cc.sys.localStorage.getItem("taskList");if(t)t=JSON.parse(t);else{for(var o={},i=0;i<11;i++){var r={id:i+1,status:0,taskValue:0,taskTag:n.default.module.themeConfig.getTaskConfigByTag("task_"+(i+1)).taskTag};o["task_"+(i+1)]=r}t={taskList:o},cc.sys.localStorage.setItem("taskList",JSON.stringify(t))}cc.log("taskList",t),e&&e(t)},e.prototype.requestPropStorageList=function(e){var t=cc.sys.localStorage.getItem("propStorageList");if(t)t=JSON.parse(t);else{for(var o={},n=0;n<11;n++){var i={pid:n+1,totalCount:0,usedCount:0};o["prop_"+(n+1)]=i}t={propStorageList:o},cc.sys.localStorage.setItem("propStorageList",JSON.stringify(t))}cc.log("propStorageList",t),e&&e(t)},e.prototype.requestDayTaskReward=function(e,t){var o=n.default.module.themeConfig.getTaskConfigByTag("task_"+e);if(2==o.rewardType){n.default.module.vm.propStorageList["prop_"+this.getRandomNum(1,11)].totalCount+=1;var i={propStorageList:n.default.module.vm.propStorageList};cc.sys.localStorage.setItem("propStorageList",JSON.stringify(i)),t&&t()}else{n.default.module.vm.diamond+=o.rewardValue;var r=cc.sys.localStorage.getItem("entryData"),a=JSON.parse(r);a.diamond=n.default.module.vm.diamond,cc.sys.localStorage.setItem("entryData",JSON.stringify(a)),t&&t()}},e.prototype.requestUseProp=function(e,t){n.default.module.vm.propStorageList["prop_"+e].totalCount-=1;var o={propStorageList:n.default.module.vm.propStorageList};cc.sys.localStorage.setItem("propStorageList",JSON.stringify(o)),t&&t()},e.prototype.requestPropList=function(e){this.requestCashRead({title:"propList"},e)},e.prototype.requestRankingList=function(e){this.requestCashRead({title:"rankingList"},e)},e.prototype.requestLikeInfo=function(e){this.requestCashRead({title:"likeInfo"},e)},e.prototype.requestGoodsInfo=function(e){this.requestCashRead({title:"goodsData"},e)},e.prototype.requestNpcConfig=function(e){this.requestCashRead({title:"npcConfig"},e)},e.prototype.requestNpcData=function(e){this.requestCashRead({title:"npcData"},e)},e.prototype.requestAdRechargeCount=function(e){this.requestCashRead({title:"adRechargeCount",goodsId:16},e)},e.prototype.requestAdvCount=function(e){this.requestCashRead({title:"taskData",taskId:31},e)},e.prototype.requestCashWrite=function(e,t,o){this._server.request("connector.cashHandler.write",{title:e,data:t},function(t){cc.log(e,t),o&&o(t)},function(e){o&&o(null)})},e.prototype.sendAdvCount=function(e,t){this._server.request("connector.cashHandler.write",{title:"taskData",taskId:31,count:e},function(e){cc.log("taskData",e),t&&t(e)},function(e){t&&t(null)})},e.prototype.sendStoreList=function(e,t){var o={storeList:e};cc.sys.localStorage.setItem("storeList",JSON.stringify(o)),t&&t()},e.prototype.sendClerkList=function(e,t){var o={clerkList:e};cc.sys.localStorage.setItem("clerkList",JSON.stringify(o)),t&&t()},e.prototype.sendFameList=function(e,t){var o={fameList:e};cc.sys.localStorage.setItem("fameList",JSON.stringify(o)),t&&t()},e.prototype.sendTaskList=function(e,t){var o={taskList:e};n.default.module.calcUiShow.checkTaskListChange(n.default.module.vm.taskList,e)?(cc.sys.localStorage.setItem("taskList",JSON.stringify(o)),t&&t(e)):t&&t(e)},e.prototype.requestAccountChange=function(e,t){var o="accountChange",n=cc.sys.localStorage.getItem("entryData");n=JSON.parse(n),e.credit&&(n.credit=e.credit.num,n.creditE=e.credit.numE),e.win&&(n.win=e.win.num,n.winE=e.win.numE),e.winTotal&&(n.winTotal=e.winTotal.num,n.winTotalE=e.winTotal.numE),e.fame&&(n.fame=e.fame.num,n.fameE=e.fame.numE),e.level&&(n.level=e.level),cc.sys.localStorage.setItem("entryData",JSON.stringify(n)),function(e){cc.log(o,e),t&&t(e)}(n)},e.prototype.requestClickLike=function(e,t,o){var n={title:"like",uid:e,index:t};this._server.request("connector.cashHandler.handler",n,function(e){cc.log(n.title,e),o&&o(e)},function(e){o&&o(null)})},e.prototype.requestDiamondInfo=function(e,t){var o={title:"goodsBuy",goodsId:e};this._server.request("connector.cashHandler.handler",o,function(e){cc.log(o.title,e),t&&t(e)},function(e){t&&t(null)})},e.prototype.requestDiamondChange=function(e,t){var o={title:"doCost",cost:e};this._server.request("connector.cashHandler.handler",o,function(e){cc.log(o.title,e),t&&t(e)},function(e){t&&t(null)})},e.prototype.rechargeBegin=function(e){this._server.request("connector.cashHandler.handler",{title:"rechargeBegin",goodsId:16},function(t){cc.log("rechargeBegin",t),e&&e(t)},function(t){e&&e(null)})},e.prototype.requestMainTaskReward=function(e){var t={title:"levelReward"};this._server.request("connector.cashHandler.handler",t,function(o){cc.log(t.title,o),e&&e(o)},function(t){e&&e(null)})},e.prototype.requestNpcReward=function(e,t,o,n,i){var r={title:"npcReward",npcId:e,index:t,isWatch:o};this._server.request("connector.cashHandler.handler",r,function(e){cc.log(r.title,e),n&&n(e)},function(e){n&&n(null)})},e.prototype.requestHead=function(e,t){var o={title:"userIcon",uid:e};this._server.request("connector.cashHandler.read",o,function(e){cc.log(o.title,e),t&&t(e)},function(e){t&&t(null)})},e.prototype.sendHead=function(e,t){var o={title:"userIcon",icon:e};this._server.request("connector.cashHandler.write",o,function(e){cc.log(o.title),t&&t(e)},function(e){t&&t(null)})},e.prototype.sendNickName=function(e,t){var o={title:"nickName",nickName:e};this._server.request("connector.cashHandler.write",o,function(e){cc.log(o.title),t&&t(e)},function(e){t&&t(null)})},e.prototype.writeCacheData=function(e,t,o){var n={title:"clientConfig",configName:e,configValue:t};this._server.request("connector.cashHandler.write",n,function(e){cc.log(n.title),o&&o(e)},function(e){o&&o(null)})},e}();o.GameProtocol=r,cc._RF.pop()},{"../Main":"Main","../service/Service":"Service"}],GameViewModel:[function(e,t,o){"use strict";cc._RF.push(t,"5d8d79Ug4lOeZK4oSy0Fbpq","GameViewModel"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../core/event/MessageManager"),i=e("../core/mvvm/MVVM"),r=e("./ThemeMessage"),a="gear_key",c=function(){function e(e){this.mvvm=null,this._localStorageObj=null,this.key="",this.mvvm=new i.MVVM,this.mvvm.data=e,this.lang=e.lang,this.gear=this.localStorageObj[a]}return Object.defineProperty(e.prototype,"localStorageObj",{get:function(){if(!this._localStorageObj){var e=cc.sys.localStorage.getItem("global_key"+this.key);if(e)try{this._localStorageObj=JSON.parse(e)}catch(e){this._localStorageObj={}}else this._localStorageObj={};this._localStorageObj.hasOwnProperty(a)||(this._localStorageObj[a]=1)}return this._localStorageObj},enumerable:!0,configurable:!0}),e.prototype.save=function(){cc.sys.localStorage.setItem("global_key"+this.key,JSON.stringify(this.localStorageObj))},e.prototype.watch=function(e,t,o){return void 0===o&&(o=null),this.mvvm.watch(e,t,o)},e.prototype.unwatch=function(e,t){return this.mvvm.unwatch(e,t)},e.prototype.unwatchTargetAll=function(e){this.mvvm.unwatchTargetAll(e)},Object.defineProperty(e.prototype,"lang",{get:function(){return this.mvvm.data.lang},set:function(e){this.mvvm.data.lang=e,cc.sys.localStorage.setItem("language",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gear",{get:function(){return this.mvvm.data.gear},set:function(e){this.mvvm.data.gear=e,this.localStorageObj[a]=e,this.save()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"diamond",{get:function(){return this.mvvm.data.diamond},set:function(e){this.mvvm.data.diamond=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cityId",{get:function(){return this.mvvm.data.cityId},set:function(e){this.mvvm.data.cityId=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"level",{get:function(){return this.mvvm.data.level},set:function(e){this.mvvm.data.level=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"credit",{get:function(){return this.mvvm.data.credit},set:function(e){this.mvvm.data.credit=e,n.Message.dispatchEvent(r.ThemeMessage.CREDIT)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"win",{get:function(){return this.mvvm.data.win},set:function(e){this.mvvm.data.win=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"winTotal",{get:function(){return this.mvvm.data.winTotal},set:function(e){this.mvvm.data.winTotal=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"refreshCreditUi",{set:function(e){this.mvvm.data.refreshCreditUi=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"refreshClerkLv",{set:function(e){this.mvvm.data.refreshClerkLv=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"storeList",{get:function(){return this.mvvm.data.storeList},set:function(e){this.mvvm.data.storeList=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"clerkList",{get:function(){return this.mvvm.data.clerkList},set:function(e){this.mvvm.data.clerkList=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fameList",{get:function(){return this.mvvm.data.fameList},set:function(e){this.mvvm.data.fameList=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"goodsList",{get:function(){return this.mvvm.data.goodsList},set:function(e){this.mvvm.data.goodsList=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rankingList",{get:function(){return this.mvvm.data.rankingList},set:function(e){this.mvvm.data.rankingList=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"goodsInfo",{get:function(){return this.mvvm.data.goodsInfo},set:function(e){this.mvvm.data.goodsInfo=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"advCount",{get:function(){return this.mvvm.data.advCount},set:function(e){this.mvvm.data.advCount=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"taskList",{get:function(){return this.mvvm.data.taskList},set:function(e){this.mvvm.data.taskList=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"propStorageList",{get:function(){return this.mvvm.data.propStorageList},set:function(e){this.mvvm.data.propStorageList=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"propList",{get:function(){return this.mvvm.data.propList},set:function(e){this.mvvm.data.propList=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"noviceProgress",{get:function(){return this.mvvm.data.noviceProgress},set:function(e){cc.log(this.mvvm.data.noviceProgress),this.mvvm.data.noviceProgress=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mainProgress",{get:function(){return this.mvvm.data.mainProgress},set:function(e){this.mvvm.data.mainProgress=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sellNum",{get:function(){return this.mvvm.data.sellNum},set:function(e){this.mvvm.data.sellNum=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isPass",{get:function(){return this.mvvm.data.isPass},set:function(e){this.mvvm.data.isPass=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"npcNum",{get:function(){return this.mvvm.data.npcNum},set:function(e){this.mvvm.data.npcNum=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fame",{get:function(){return this.mvvm.data.fame},set:function(e){this.mvvm.data.fame=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"levelReward",{get:function(){return this.mvvm.data.levelReward},set:function(e){this.mvvm.data.levelReward=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"audio",{get:function(){return this.mvvm.data.audio},set:function(e){this.mvvm.data.audio=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"message",{get:function(){return this.mvvm.data.message},set:function(e){this.mvvm.data.message=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isMoving",{get:function(){return this.mvvm.data.isMoving},set:function(e){this.mvvm.data.isMoving=e},enumerable:!0,configurable:!0}),e}();o.default=c,cc._RF.pop()},{"../core/event/MessageManager":"MessageManager","../core/mvvm/MVVM":"MVVM","./ThemeMessage":"ThemeMessage"}],GiftComponent:[function(e,t,o){"use strict";cc._RF.push(t,"363fcziuF9AOL6nze6/fEKZ","GiftComponent");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../core/event/MessageManager"),a=e("../../core/gui/GUI"),c=e("../../core/ui/button/ButtonEffect"),s=e("../../core/ui/ComponentExtends"),l=e("../../core/ui/ViewUtils"),u=e("../../core/util/AsyncQueue"),p=e("../../Main"),d=e("../../service/Service"),h=e("../AudioMessage"),f=e("../CalcUiShow"),g=e("./adv/AdvControl"),m=e("./GiftListItem"),v=cc._decorator,_=v.ccclass,y=v.property,b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.item_node=null,t.item_adv=null,t.giftAdvNum=0,t}return n(t,e),t.prototype.onLoad=function(){d.service.analytics.logEvent("gift_click_open","",""),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchHandler,this),this.node.active=!1,this.refreshList(),p.default.module.gameMainControl.mainNodes.get("red_point_gift").active=!1},t.prototype.refreshList=function(){var e=this;this.item_node.active=!1;var t=!1,o=l.ViewUtils.nodeTreeInfoLite(this.node).get("content");o.children.forEach(function(t){t.uuid!=e.item_node.uuid&&t.uuid!=e.item_adv.uuid&&t.destroy()});var n=0,i=u.AsyncQueue.excuteTimes(3,function(){e.item_adv.on(cc.Node.EventType.TOUCH_END,e.advItemClickHandler.bind(e),e),e.node.active=!0,e.item_node.active=t});d.service.prompt.netInstableOpen(),p.default.module.gameProtocol.requestGoodsList(function(t){for(var r in d.service.prompt.netInstableClose(),p.default.module.vm.goodsList=t.goodsList,p.default.module.vm.goodsList){var a=p.default.module.vm.goodsList[r];if(1==a.priceType){var c={id:a.id,goods_type:a.goods_type,price:a.price,priceType:a.priceType,value:a.value},s=null;if(0==n)e.item_node.active=!0,(s=e.item_node.getComponent(m.default)).setData(c);else{var l=cc.instantiate(e.item_node);l.parent=o,(s=l.getComponent(m.default)).setData(c)}s.clickCallback=e.itemClickHandler.bind(e),s.node.zIndex=n+2,n++}}i()}),p.default.module.gameProtocol.checkBuyRecord(1,function(e){t=0==e.count,i()}),p.default.module.gameProtocol.requestAdRechargeCount(function(t){e.giftAdvNum=t.adCount.count||0,e.initAdvItem(),i()})},t.prototype.initAdvItem=function(){this.item_adv.getChildByName("progress").getComponent(cc.Label).string="("+this.giftAdvNum+"/5)",this.item_adv.zIndex=this.giftAdvNum<5?1:200,this.item_adv.active=this.giftAdvNum<5},t.prototype.advItemClickHandler=function(){var e=this;if(!(this.giftAdvNum>=5)&&this.item_adv.getComponent(c.default).canTouch){this.item_adv.getComponent(c.default).canTouch=!1;var t=function(){d.service.prompt.netInstableOpen(),p.default.module.gameProtocol.rechargeBegin(function(t){d.service.prompt.netInstableClose();var o=p.default.module.vm;e.item_adv.getComponent(c.default).canTouch=!0,e.giftAdvNum+=1,o.diamond=t.userAccount.credit,e.initAdvItem()})};if(cc.sys.isBrowser){cc.log("\u6d4f\u89c8\u5668\u76f4\u63a5\u53d1\u653e\u793c\u5305\u754c\u9762\u94bb\u77f3\u5956\u52b1");var o=p.default.module.calcUiShow.changeTaskListByTypeCount(f.TaskType.WATCH_AD,1);return p.default.module.gameProtocol.sendTaskList(o,function(e){p.default.module.vm.taskList=o}),void p.default.module.gameMainControl.playAdDiamondEffect(function(){t&&t()})}r.Message.dispatchEvent(g.AdvMessage.PLAY,{callback:function(o,n){n==g.AdvRewardType.GIFT_DIAMOND&&(o?(cc.log("\u793c\u5305\u754c\u9762\u94bb\u77f3\u5956\u52b1\u89c2\u770b\u5e7f\u544a\u6210\u529f"),d.service.analytics.logEvent("ad_complete_store","",""),p.default.module.gameMainControl.playAdDiamondEffect(function(){t&&t()})):(cc.log("\u793c\u5305\u754c\u9762\u94bb\u77f3\u5956\u52b1\u89c2\u770b\u5e7f\u544a\u5931\u8d25"),e.item_adv.getComponent(c.default).canTouch=!0))},type:g.AdvRewardType.GIFT_DIAMOND})}},t.prototype.itemClickHandler=function(e){var t=this;r.Message.dispatchEvent(h.AudioMessage.EFFECT,"buy_gem"),p.default.module.gameProtocol.startPay(e,function(o){cc.log("[SHop]\uff0c\u5145\u503c\u8ba2\u5355\u6d88\u606f",o);var n=o.payData.billNo;if(n&&p.default.module.pay.doPay(n,"globaltycoon.product_"+e),1==e){var i=p.default.module.calcUiShow.getTimeStageReward(604800);0==i.num&&0==i.numE&&(i={num:1,numE:3}),a.gui.popup.add("popup/shopping_result",{id:10,goodsType:2,reward:i},{modal:!0,opacity:150}),p.default.module.calcUiShow.refreshCredit(i,function(){},!0)}t.refreshList()})},t.prototype.onDestroy=function(){this.giftAdvNum=null,this.node.off(cc.Node.EventType.TOUCH_END,this.onTouchHandler,this),e.prototype.onDestroy.call(this)},t.prototype.onTouchHandler=function(e){switch(e.target.name){case"btn_close":a.gui.delete(this.node)}},i([y(cc.Node)],t.prototype,"item_node",void 0),i([y(cc.Node)],t.prototype,"item_adv",void 0),t=i([_],t)}(s.ComponentExtends);o.default=b,cc._RF.pop()},{"../../Main":"Main","../../core/event/MessageManager":"MessageManager","../../core/gui/GUI":"GUI","../../core/ui/ComponentExtends":"ComponentExtends","../../core/ui/ViewUtils":"ViewUtils","../../core/ui/button/ButtonEffect":"ButtonEffect","../../core/util/AsyncQueue":"AsyncQueue","../../service/Service":"Service","../AudioMessage":"AudioMessage","../CalcUiShow":"CalcUiShow","./GiftListItem":"GiftListItem","./adv/AdvControl":"AdvControl"}],GiftListItem:[function(e,t,o){"use strict";cc._RF.push(t,"fca521+Z2dE06uDEh/sSYwe","GiftListItem");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../core/language/LanguageLabel"),a=e("../../core/ui/ComponentExtends"),c=e("../../core/ui/ViewUtils"),s=e("../../service/Service"),l=cc._decorator,u=l.ccclass,p=(l.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.clickCallback=null,t.goodsId=7,t.diamond_num=0,t}return n(t,e),t.prototype.onLoad=function(){this.node.hasEventListener(cc.Node.EventType.TOUCH_END)||this.node.on(cc.Node.EventType.TOUCH_END,this.onBtnHandler,this)},t.prototype.onBtnHandler=function(e){this.clickCallback&&(s.service.analytics.logEvent("gift_buy_new","",""),this.clickCallback(this.goodsId,this))},t.prototype.setData=function(e){var t=this;this.goodsId=e.id,this.diamond_num=e.value;var o=c.ViewUtils.nodeTreeInfoLite(this.node);o.get("zuanshi").active=!1,cc.loader.loadRes("popup/gift/zuanshi"+(e.id>1?e.id-1:e.id),cc.SpriteFrame,function(e,o){if(!e){var n=c.ViewUtils.nodeTreeInfoLite(t.node);n.get("zuanshi").getComponent(cc.Sprite).spriteFrame=o,n.get("zuanshi").active=!0}}),o.get("title").getComponent(r.LanguageLabel).dataID="gift_"+e.id,o.get("hua").active=1==e.id,o.get("diamond_num").getComponent(cc.Label).string="x"+e.value.value1,o.get("type").getComponent(cc.Label).string="\u83b7\u53d6",o.get("price").getComponent(cc.Label).string="USD"+e.price,o.clear()},t.prototype.onDestroy=function(){this.node.off(cc.Node.EventType.TOUCH_END,this.onBtnHandler,this),this.goodsId=null,this.diamond_num=null,this.clickCallback=null,e.prototype.onDestroy.call(this)},t=i([u],t)}(a.ComponentExtends));o.default=p,cc._RF.pop()},{"../../core/language/LanguageLabel":"LanguageLabel","../../core/ui/ComponentExtends":"ComponentExtends","../../core/ui/ViewUtils":"ViewUtils","../../service/Service":"Service"}],GradenClick:[function(e,t,o){"use strict";cc._RF.push(t,"a2c731TnsJBLLzCuTqvbA6v","GradenClick");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../../core/Engine"),a=e("../../../core/language/LanguageLabel"),c=e("../../../core/ui/ComponentExtends"),s=e("../../../core/ui/ViewUtils"),l=cc._decorator,u=l.ccclass,p=(l.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.onLoad=function(){var e=s.ViewUtils.nodeTreeInfoLite(this.node);e.get("pop_tip").active=!1;var t=this.node.name,o="";switch(parseInt(t.split("_")[1])){case 6:case 7:o=r.default.i18n.getLangByID("ui_map_3");break;case 8:case 9:o=r.default.i18n.getLangByID("ui_map_4");break;case 10:o=r.default.i18n.getLangByID("ui_map_5")}e.get("tip_lab").getComponent(a.LanguageLabel).setVars("ui_mission_5",o),this.init()},t.prototype.init=function(){var e=new cc.Node;e.width=300,e.height=150,e.parent=this.node,e.on(cc.Node.EventType.TOUCH_END,this.click.bind(this),this)},t.prototype.click=function(e){this.node._touchListener&&this.node._touchListener.setSwallowTouches(!1);var t=s.ViewUtils.nodeTreeInfoLite(this.node);t.get("pop_tip").active=!t.get("pop_tip").active},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t=i([u],t)}(c.ComponentExtends));o.default=p,cc._RF.pop()},{"../../../core/Engine":"Engine","../../../core/language/LanguageLabel":"LanguageLabel","../../../core/ui/ComponentExtends":"ComponentExtends","../../../core/ui/ViewUtils":"ViewUtils"}],HActionBezier:[function(e,t,o){"use strict";function n(e,t,o,n,i){return Math.pow(1-i,3)*e+3*i*Math.pow(1-i,2)*t+3*Math.pow(i,2)*(1-i)*o+Math.pow(i,3)*n}cc._RF.push(t,"aba39+US8xMR4vYS2eAKHll","HActionBezier");var i=cc.Class({extends:e("HActionInterval"),ctor:function(){this._config=[],this._startPosition=cc.v2(0,0),this._previousPosition=cc.v2(0,0)},init:function(e,t,o){this._super(e,o),this._config=t},startWithTarget:function(e){this._super(e);var t=this.target.x,o=this.target.y;this._previousPosition.x=t,this._previousPosition.y=o,this._startPosition.x=t,this._startPosition.y=o},update:function(e){this._super(e);var t=this.getProgress(),o=this._config,i=o[0].x,r=o[1].x,a=o[2].x,c=o[0].y,s=o[1].y,l=o[2].y,u=n(0,i,r,a,t),p=n(0,c,s,l,t),d=this._startPosition;if(cc.macro.ENABLE_STACKABLE_ACTIONS){var h=this.target.x,f=this.target.y,g=this._previousPosition;d.x=d.x+h-g.x,d.y=d.y+f-g.y,u+=d.x,p+=d.y,g.x=u,g.y=p,this.target.setPosition(u,p)}else this.target.setPosition(d.x+u,d.y+p)},cloneSelf:function(){var e=new i;return e.init(this.getDuration(),this._config,this.getlets()),e.easing(this.easingFunc),e}}),r=cc.Class({extends:i,ctor:function(){this._toConfig=[]},init:function(e,t,o){this._super(e,t,o),this._toConfig=t},startWithTarget:function(e){this._super(e);var t=this._startPosition,o=this._toConfig,n=this._config;n[0]=o[0].sub(t),n[1]=o[1].sub(t),n[2]=o[2].sub(t)},cloneSelf:function(){var e=new r;return e.init(this.getDuration(),this._toConfig,this.getlets()),e}});t.exports={bezierBy:i,bezierTo:r},cc._RF.pop()},{HActionInterval:"HActionInterval"}],HActionComponent:[function(e,t,o){"use strict";cc._RF.push(t,"21d84/8/i1PnqKsbph+foZA","HActionComponent"),t.exports=cc.Class({extends:cc.Component,getTargetNode:function(){return this._targetNode},getActionEngine:function(){return this.actionEngine||(this.actionEngine=e("HActionEngine")()),this.actionEngine},__$init:function(e){this._targetNode=e},onLoad:function(){this._targetNode=this.node},addActionToTickQueue:function(e){e.getComponent()?cc.warn("HActionComponent -> addActionToTickQueue warn: \u91cd\u590d\u6dfb\u52a0HAction\u53ef\u80fd\u4f1a\u5e26\u6765\u4e0d\u53ef\u77e5\u7684\u95ee\u9898\uff01 "):(this.getActionEngine().pushActionToQueue(e),e.startWithTarget(this))},removeAction:function(e){return this.getActionEngine().removeAction(e)},removeActions:function(e){for(var t=this.getActionEngine(),o=0;o<e.length;o++)t.destroyAction(e[o])},removeAllActions:function(){return this.getActionEngine().removeAllActions(this)},getRunningActions:function(){return this.getActionEngine().getRunningActions(this)},getActionByTag:function(e){return this.getActionEngine().getActionByTag(this,e)},playComplete:function(e){return this.getActionEngine().actionPlayComplete(e)},addActionToInvalidList:function(e){return this.getActionEngine().addActionToInvalidList(e)},destroyAction:function(e){return this.getActionEngine().__invalidActionAndNext(e)},onDestroy:function(){this.actionEngine&&this.actionEngine.removeAllActions(this),this.actionEngine=null,this._targetNode=null}}),cc._RF.pop()},{HActionEngine:"HActionEngine"}],HActionEngine:[function(e,t,o){"use strict";cc._RF.push(t,"4d02dkgDWdP6awiZbScQBq0","HActionEngine");var n=e("HAction"),i=e("HActionComponent"),r=cc.Class({ctor:function(){this.uuid="HActionEngine",this._id=this.uuid,this._actions=[],this._tempInvalidIds={},cc.director.getScheduler().scheduleUpdate(this,0,!1)},pushActionToQueue:function(e){e instanceof n||cc.error("HActionEngine -> pushActionToQueue error: params must be a subclass of HAction!"),this._actions.push(e)},getActionByTag:function(e,t){e instanceof i||cc.error("HActionEngine -> getActionByTag error: params must be a instance of HActionComponent!");for(var o=this._actions.length,n=0;n<o;n++){var r=this._actions[n];if(r.getComponent().uuid===e.uuid){if(r.getTag()===t)return r;for(var a=r.$getNextAction();a;){if(a.getTag()===t)return a;a,a=a.$getNextAction()}}}return null},getRunningActions:function(e){e instanceof i||cc.error("HActionEngine -> getRunningActions error: params must be a instance of HActionComponent!");for(var t=[],o=this._actions.length,n=0;n<o;n++){var r=this._actions[n];r.getComponent().uuid===e.uuid&&r.getState()===ezaction.State.RUNNING&&t.push(r)}return t},removeAction:function(e){if(e instanceof n||cc.error("HActionEngine -> removeAction error: params must be a subclass of HAction!"),e.getState()!==ezaction.State.DEAD){for(var t=e.$uuid,o=this._actions.length,i=0;i<o;i++){var r=this._actions[i];if(r.$uuid===t)return this.__invalidActionAndNext(r),!0;for(var a=r,c=r.$getNextAction();c;){if(c.$uuid===t)return a.$removeNextAction(),!0;a=c,c=c.$getNextAction()}}return!1}},removeAllActions:function(e){e instanceof i||cc.error("HActionEngine -> removeAllActions error: params must be a instance of HActionComponent!");for(var t=this._actions.length,o=0;o<t;o++){var n=this._actions[o];n.getComponent().uuid===e.uuid&&this.__invalidActionAndNext(n)}},actionPlayComplete:function(e){for(var t=this._actions.length,o=0;o<t;o++){if(this._actions[o].$uuid===e.$uuid){var n=e.$getNextAction();n&&(n.startWithTarget(e.getComponent()),this._actions[o]=n),e.$invalid();break}}},__invalidActionAndNext:function(e){for(var t=e.$getNextAction();t;){var o=t;t=o.$getNextAction(),o.$invalid()}e.$invalid()},addActionToInvalidList:function(e){e instanceof n||cc.error("HActionEngine -> addActionToInvalidList error: params must be a subclass of HAction!"),this._tempInvalidIds[e.$uuid]=e},update:function(e){var t=this._actions;if(Object.keys(this._tempInvalidIds).length>0){for(var o in this._tempInvalidIds)this._tempInvalidIds[o].$destroy();for(var n=0,i=!0,r=t.length;n<r;i?n++:n)t[n]&&this._tempInvalidIds[t[n].$uuid]?(t.splice(n,1),i=!1):i=!0;this._tempInvalidIds={}}t.forEach(function(t){var o=t.getComponent();o&&o.enabled&&o.isValid&&t._$update(e)})}}),a=null;t.exports=function(){return a||(a=new r)},cc._RF.pop()},{HAction:"HAction",HActionComponent:"HActionComponent"}],HActionInstant:[function(e,t,o){"use strict";cc._RF.push(t,"effacCyjKhJp5Ke6Gq+fA5A","HActionInstant");var n=cc.Class({extends:e("HAction"),ctor:function(){},update:function(e){this.$actionComplete()},cloneSelf:function(){var e=new n;return e.init(this.getVars()),e}});n.create=function(e){var t=new n;return t.init(e),t},t.exports=n,cc._RF.pop()},{HAction:"HAction"}],HActionInterval:[function(e,t,o){"use strict";cc._RF.push(t,"4fa5feWWbtHAo2qz0sOpWAs","HActionInterval");var n=cc.Class({extends:e("HAction"),ctor:function(){this._duration=.001,this._currentTime=0,this._progress=0,this._lastprogress=0},getCurrentTime:function(){return this._currentTime},getDuration:function(){return this._duration},getProgress:function(){return this._progress},init:function(e,t){e>0&&(this._duration=e),this._super(t)},playAction:function(){this._super(),this._currentTime=0,this._progress=0,this._lastprogress=0},$update:function(e){this._currentTime+=e,this._currentTime>=this._duration?(this._progress=1,this.update(this._progress),this.$actionComplete()):(this._progress=this._currentTime/this._duration,this.update(this._progress))},update:function(e){if("function"==typeof this._vars.easing){var t=this._lastprogress;this._progress=this._vars.easing(this._progress),this._lastprogress=this._progress,t<1&&this._progress>1&&"function"==typeof this._vars.onArrived&&this._vars.onArrived(this)}this._super(this._progress)},onArrived:function(e){return"function"==typeof e&&(this._vars.onArrived=e),this},easing:function(e){return"function"==typeof e&&(this._vars.easing=e),this},cloneSelf:function(){var e=new n;return e.init(this.getDuration(),this.getVars()),e},$destroy:function(){this._super()}});n.create=function(e,t){var o=new n;return o.init(e,t),o},t.exports=n,cc._RF.pop()},{HAction:"HAction"}],HActionJump:[function(e,t,o){"use strict";cc._RF.push(t,"892511CiRVM0bhG67sIWfw9","HActionJump");var n=cc.Class({extends:e("HActionInterval"),ctor:function(){this._delta={x:0,y:0},this._height=0,this._jumps=1,this._startPos={}},init:function(e,t,o,n,i){this._super(e,i),this._delta.x=t.x,this._delta.x=t.y,this._height=o,this._jumps=n},startWithTarget:function(e){this._super(e),this._startPos.x=this.getNode().x,this._startPos.y=this.getNode().y},update:function(e){this._super(e);this._vars;var t=this.getNode(),o=this.getProgress(),n=e*this._jumps%1,i=4*this._height*n*(1-n);i+=this._delta.y*e,t.y=this._startPos.y+i,t.x=this._startPos.x+this._delta.x*o},cloneSelf:function(){var e=new n;return e.init(this.getDuration(),this._delta,this._height,this._jumps,this.getVars()),e.easing(this.easingFunc),e}}),i=cc.Class({extends:n,ctor:function(){this._endPos={x:0,y:0}},init:function(e,t,o,n,i){this._super(e,t,o,n,i),this._endPos.x=t.x,this._endPos.y=t.y},startWithTarget:function(e){this._super(e),this._delta.x=this._endPos.x-this._startPos.x,this._delta.y=this._endPos.y-this._startPos.y},cloneSelf:function(){var e=new i;return e.init(this.getDuration(),this._endPos,this._height,this._jumps,this.getVars()),e}});t.exports={jumpBy:n,jumpTo:i},cc._RF.pop()},{HActionInterval:"HActionInterval"}],HActionSequence:[function(e,t,o){"use strict";cc._RF.push(t,"5fbe0k5kF5EJph7uVYvYltd","HActionSequence");var n=cc.Class({extends:e("HAction"),ctor:function(){this._actions=[]},setSpeed:function(e){return e=Math.abs(e),this._actions.forEach(function(t){t.setSpeed(e)}),this._super(e)},pushAction:function(e,t){for(var o=0;o<e.length;o++){var n=e[o];t&&n.setSpeed(this.getSpeed()),this._actions.push(n)}},playAction:function(){this._super();for(var e=this._actions.length,t=0;t<e;t++)for(var o=this._actions[t];o;)o.playAction(),o=o.$getNextAction()},$update:function(e){if(this._super(e),this._actions){for(var t=!0,o=this._actions.length,n=0;n<o;n++){for(var i=this._actions[n];i;){if(i.getNode()||i.startWithTarget(this._actionComponent),i.isRunning()){i._$update(e),t=!1;break}i=i.$getNextAction()}if(!t)break}t&&this.$actionComplete()}else this.$actionComplete()},cloneSelf:function(){var e=new n;if(e.init(this.getVars()),this._actions){var t=[];this._actions.forEach(function(e){t.push(e.clone())}),e.pushAction(t,!1),t=null}return e},$invalid:function(){this._actions?(this._actions.forEach(function(e){e.destroy()}),this._actions=null,this._super()):this._super()},$destroy:function(){this._actions=null,this._super()}});n.create=function(e,t){var o=new n;return o.init(t),o.pushAction(e),o},t.exports=n,cc._RF.pop()},{HAction:"HAction"}],HActionSpawn:[function(e,t,o){"use strict";cc._RF.push(t,"47986EceGFKW5mHD0qOPvqi","HActionSpawn");var n=cc.Class({extends:e("HAction"),ctor:function(){this._actions=[]},setSpeed:function(e){e=Math.abs(e);for(var t=0;t<this._actions.length;t++)this._actions[t].setSpeed(e);return this._super(e)},pushAction:function(e,t){for(var o=0;o<e.length;o++){var n=e[o];t&&n.setSpeed(this.getSpeed()),this._actions.push(n)}},playAction:function(){this._super();for(var e=this._actions.length,t=0;t<e;t++)for(var o=this._actions[t];o;)o.playAction(),o=o.$getNextAction()},$update:function(e){if(this._super(e),this._actions){for(var t=!0,o=this._actions.length,n=0;n<o;n++)for(var i=this._actions[n];i;){if(i.getNode()||i.startWithTarget(this._actionComponent),i.isRunning()){i._$update(e),t=!1;break}i=i.$getNextAction()}t&&this.$actionComplete()}else this.$actionComplete()},cloneSelf:function(){var e=new n;if(e.init(this.getVars()),this._actions){var t=[];this._actions.forEach(function(e){t.push(e)}),e.pushAction(t,!1),t=null}return e},$invalid:function(){this._actions?(this._actions.forEach(function(e){e.destroy()}),this._actions=null,this._super()):this._super()},$destroy:function(){this._actions=null,this._super()}});n.create=function(e,t){var o=new n;return o.init(t),o.pushAction(e),o},t.exports=n,cc._RF.pop()},{HAction:"HAction"}],HActionTweenBase:[function(e,t,o){"use strict";function n(e){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}cc._RF.push(t,"57e3cnJRFhBpIE+NAvX2bnI","HActionTweenBase");var i=cc.Class({extends:e("HActionInterval"),ctor:function(){this._intialAttrList=null,this._target=null},setTarget:function(e){this._target=e},getTarget:function(){return this._target||this.getNode()},playAction:function(){if(this._super(),this._intialAttrList){var e=this.getTarget(),t=this._intialAttrList;for(var o in t)e[o]=t[o]}},startWithTarget:function(e){this._super(e),this._intialAttrList={};var t=this.getTarget();for(var o in this._vars){if("tag"!=o)if("number"==typeof t[o])"number"===n(t[o])&&(this._intialAttrList[o]=t[o])}},$destroy:function(){this._intialAttrList=null,this._super()}});t.exports=i,cc._RF.pop()},{HActionInterval:"HActionInterval"}],HActionTweenBy:[function(e,t,o){"use strict";cc._RF.push(t,"ef90fS569xNaaUSBD1WCsyZ","HActionTweenBy");var n=cc.Class({extends:e("HActionTweenBase"),ctor:function(){},update:function(e){this._super(e);var t=this._vars,o=this.getTarget(),n=this.getProgress(),i=this._intialAttrList;for(var r in i){var a=i[r];o[r]=a+t[r]*n}},cloneSelf:function(){var e=new n;return e.init(this.getDuration(),this.getVars()),e.easing(this.easingFunc),e}});n.create=function(e,t){var o=new n;return o.init(e,t),o},t.exports=n,cc._RF.pop()},{HActionTweenBase:"HActionTweenBase"}],HActionTween:[function(e,t,o){"use strict";cc._RF.push(t,"ba9faH+nUVHaKlC5DGEOlEd","HActionTween");var n=cc.Class({extends:e("HActionTweenBase"),ctor:function(){},update:function(e){this._super(e);var t=this._vars,o=this.getTarget(),n=this.getProgress(),i=this._intialAttrList;for(var r in i){var a=i[r];o[r]=a+(t[r]-a)*n}},cloneSelf:function(){var e=new n;return e.init(this.getDuration(),this.getVars()),e.easing(this.easingFunc),e}});n.create=function(e,t){var o=new n;return o.init(e,t),o},t.exports=n,cc._RF.pop()},{HActionTweenBase:"HActionTweenBase"}],HAction:[function(e,t,o){"use strict";cc._RF.push(t,"66aeabOJwpJtZjmFKy0qVqp","HAction"),e("HNodeEx");var n=e("HVars"),i=function(){var e=0;return function(){return"__HAction_uuid_"+e++}}(),r=cc.Class({ctor:function(){this.$uuid=i(),this._delay=0,this._state=ezaction.State.INITIAL,this._finishCallback=null,this._actionComponent=null,this.__nextAction=null,this._vars=new n,this._isStart=!1,Object.defineProperty(this,"vars",{get:function(){return this._vars}}),Object.defineProperty(this,"target",{get:function(){return this.getNode()}})},setTag:function(e){this._vars.tag=e},getTag:function(){return this._vars.tag},getState:function(){return this._state},isRunning:function(){return this._state===ezaction.State.RUNNING},getSpeed:function(){return this._vars.speed},setSpeed:function(e){if("number"==typeof e){if(!(e<=0))return this._vars.speed=e,this;cc.warn("HAction -> setSpeed: speed must be positive number")}else cc.warn("HAction -> setSpeed: speed must be positive number")},getVars:function(){return this._vars},getNode:function(){return this._actionComponent?this._actionComponent.getTargetNode():null},getComponent:function(){return this._actionComponent},pause:function(){return this._state===ezaction.State.RUNNING&&(this._state=ezaction.State.PAUSED),this},resume:function(){return this._state===ezaction.State.PAUSED&&(this._state=ezaction.State.RUNNING),this},init:function(e){this._vars.patchParams(e)},startWithTarget:function(e){if(this._actionComponent)throw new Error("Error, HAction Had been added! ");this._actionComponent=e,this.playAction()},playAction:function(){this._state=ezaction.State.RUNNING,this._delay=this._vars.delay,this._isStart=!1},_$update:function(e){var t=this._vars;e*=t.speed,this._state===ezaction.State.RUNNING&&(this._delay-=e,this._delay<=0&&(this._isStart||(this._isStart=!0,"function"==typeof t.onStart&&t.onStart(this)),this.$update(e),this.isRunning()&&"function"==typeof t.onUpdate&&t.onUpdate(this,e)))},$update:function(e){this.update(0)},update:function(e){},$actionComplete:function(){var e=this._vars;"function"==typeof e.onComplete&&e.onComplete(this);var t=e.repeat;t>0?(this.playAction(),this.repeat(t-1)):(this._state=ezaction.State.STOPPED,"function"==typeof e.onStoped&&e.onStoped(this),this._finishCallback&&this._finishCallback(this,this.$getNextAction()),this._actionComponent&&this._actionComponent.playComplete(this))},$setFinishCallback:function(e){this._finishCallback=e},$getNextAction:function(){return this.__nextAction},$setNextAction:function(e,t){var o=9999999;"number"==typeof t&&t>-1&&(o=t);for(var n=0,i=this,r=this.__nextAction;r&&n!==o&&(i=r,r=r.__nextAction);)++n;return r&&r.destroy(),i.__nextAction=e,e},$removeNextAction:function(){this.__nextAction&&this.__nextAction.destroy(),this.__nextAction=null},then:function(e){return this.__nextAction&&this.__nextAction.$destroy(),this.__nextAction=e,e},clone:function(){for(var e=this.cloneSelf(),t=this.$getNextAction();t;)e.$setNextAction(t.cloneSelf()),t=t.$getNextAction();return e},cloneSelf:function(){return null},repeatForever:function(){return this._vars.repeat=Number.MAX_VALUE,this},repeat:function(e){return this._vars.repeat=e,this},onStart:function(e){return"function"==typeof e&&(this._vars.onStart=e),this},onUpdate:function(e){return"function"==typeof e&&(this._vars.onUpdate=e),this},onComplete:function(e){return"function"==typeof e&&(this._vars.onComplete=e),this},onStoped:function(e){return"function"==typeof e&&(this._vars.onStoped=e),this},destroy:function(){this._state!=ezaction.State.DEAD&&(this._actionComponent?(this._state=ezaction.State.DEAD,this._actionComponent.destroyAction(this)):this.$destroy())},$invalid:function(){this._state!=ezaction.State.DEAD&&(this._actionComponent?(this._state=ezaction.State.DEAD,this._actionComponent.addActionToInvalidList(this)):this.$destroy())},$destroy:function(){this._state=ezaction.State.DEAD,this._vars=null,this.__nextAction=null,this._finishCallback=null,this._actionComponent=null}});t.exports=r,cc._RF.pop()},{HNodeEx:"HNodeEx",HVars:"HVars"}],HCustomEase:[function(e,t,o){"use strict";cc._RF.push(t,"cee2frmwEZJAZaWAdxHmXkc","HCustomEase");var n=function(){var e=/(?:(-|-=|\+=)?\d*\.?\d*(?:e[\-+]?\d+)?)[0-9]/gi,t=/[achlmqstvz]|(-?\d*\.?\d*(?:e[\-+]?\d+)?)[0-9]/gi,o=/[\+\-]?\d*\.?\d+e[\+\-]?\d+/gi,n=/[cLlsS]/g,i="CustomEase only accepts Cubic Bezier data.",r=function e(t,o,n,i,r,a,c,s,l,u,p){var d,h=(t+n)/2,f=(o+i)/2,g=(n+r)/2,m=(i+a)/2,v=(r+c)/2,_=(a+s)/2,y=(h+g)/2,b=(f+m)/2,C=(g+v)/2,T=(m+_)/2,S=(y+C)/2,E=(b+T)/2,L=c-t,w=s-o,k=Math.abs((n-c)*w-(i-s)*L),P=Math.abs((r-c)*w-(a-s)*L);return u||(u=[{x:t,y:o},{x:c,y:s}],p=1),u.splice(p||u.length-1,0,{x:S,y:E}),(k+P)*(k+P)>l*(L*L+w*w)&&(d=u.length,e(t,o,h,f,y,b,S,E,l,u,p),e(S,E,C,T,v,_,c,s,l,u,p+1+(u.length-d))),u},a=function(e){var n,r,a,c,s,l,u,p,d,h,f,g=(e+"").replace(o,function(e){var t=+e;return t<1e-4&&t>-1e-4?0:t}).match(t)||[],m=[],v=0,_=0,y=g.length,b=2;for(n=0;n<y;n++)if(d=c,isNaN(g[n])?s=(c=g[n].toUpperCase())!==g[n]:n--,r=+g[n+1],a=+g[n+2],s&&(r+=v,a+=_),n||(u=r,p=a),"M"===c)l&&l.length<8&&(m.length-=1,b=0),v=u=r,_=p=a,l=[r,a],b=2,m.push(l),n+=2,c="L";else if("C"===c)l||(l=[0,0]),l[b++]=r,l[b++]=a,s||(v=_=0),l[b++]=v+1*g[n+3],l[b++]=_+1*g[n+4],l[b++]=v+=1*g[n+5],l[b++]=_+=1*g[n+6],n+=6;else if("S"===c)"C"===d||"S"===d?(h=v-l[b-4],f=_-l[b-3],l[b++]=v+h,l[b++]=_+f):(l[b++]=v,l[b++]=_),l[b++]=r,l[b++]=a,s||(v=_=0),l[b++]=v+=1*g[n+3],l[b++]=_+=1*g[n+4],n+=4;else{if("L"!==c&&"Z"!==c)throw i;"Z"===c&&(r=u,a=p,l.closed=!0),("L"===c||Math.abs(v-r)>.5||Math.abs(_-a)>.5)&&(l[b++]=v+(r-v)/3,l[b++]=_+(a-_)/3,l[b++]=v+2*(r-v)/3,l[b++]=_+2*(a-_)/3,l[b++]=r,l[b++]=a,"L"===c&&(n+=2)),v=r,_=a}return m[0]},c=function(e){var t,o=e.length,n=999999999999;for(t=1;t<o;t+=6)+e[t]<n&&(n=+e[t]);return n},s=function(e,t,o){o||0===o||(o=Math.max(+e[e.length-1],+e[1]));var n,i=-1*+e[0],r=-o,a=e.length,s=1/(+e[a-2]+i),l=-t||(Math.abs(+e[a-1]-+e[1])<.01*(+e[a-2]-+e[0])?c(e)+r:+e[a-1]+r);for(l=l?1/l:-s,n=0;n<a;n+=2)e[n]=(+e[n]+i)*s,e[n+1]=(+e[n+1]+r)*l},l=function(e){var t=this.lookup[e*this.l|0]||this.lookup[this.l-1];return t.nx<e&&(t=t.n),t.y+(e-t.x)/t.cx*t.cy},u=function(e,t,o){this._calcEnd=!0,this.id=e,this.getRatio=l,this.setData(t,o)},p=u.prototype;return p.setData=function(t,o){var c,l,u,p,d,h,f,g,m,v,_=(t=t||"0,0,1,1").match(e),y=1,b=[];if(v=(o=o||{}).precision||1,this.data=t,this.lookup=[],this.points=b,this.fast=v<=1,(n.test(t)||-1!==t.indexOf("M")&&-1===t.indexOf("C"))&&(_=a(t)),4===(c=_.length))_.unshift(0,0),_.push(1,1),c=8;else if((c-2)%6)throw i;for(0==+_[0]&&1==+_[c-2]||s(_,o.height,o.originY),this.rawBezier=_,p=2;p<c;p+=6)l={x:+_[p-2],y:+_[p-1]},u={x:+_[p+4],y:+_[p+5]},b.push(l,u),r(l.x,l.y,+_[p],+_[p+1],+_[p+2],+_[p+3],u.x,u.y,1/(2e5*v),b,b.length-1);for(c=b.length,p=0;p<c;p++)f=b[p],g=b[p-1]||f,f.x>g.x||g.y!==f.y&&g.x===f.x||f===g?(g.cx=f.x-g.x,g.cy=f.y-g.y,g.n=f,g.nx=f.x,this.fast&&p>1&&Math.abs(g.cy/g.cx-b[p-2].cy/b[p-2].cx)>2&&(this.fast=!1),g.cx<y&&(g.cx?y=g.cx:(g.cx=.001,p===c-1&&(g.x-=.001,y=Math.min(y,.001),this.fast=!1)))):(b.splice(p--,1),c--);if(c=1/y+1|0,this.l=c,d=1/c,h=0,f=b[0],this.fast){for(p=0;p<c;p++)m=p*d,f.nx<m&&(f=b[++h]),l=f.y+(m-f.x)/f.cx*f.cy,this.lookup[p]={x:m,cx:d,y:l,cy:0,nx:9},p&&(this.lookup[p-1].cy=l-this.lookup[p-1].y);this.lookup[c-1].cy=b[b.length-1].y-l}else{for(p=0;p<c;p++)f.nx<p*d&&(f=b[++h]),this.lookup[p]=f;h<b.length-1&&(this.lookup[p-1]=b[b.length-2])}return this._calcEnd=1!==b[b.length-1].y||0!==b[0].y,this},p.getRatio=l,u}(),i={create:function(e,t,o){return new n(e,t,o)}};t.exports=i,cc._RF.pop()},{}],HEaseDefine:[function(e,t,o){"use strict";cc._RF.push(t,"97d510EtSlExoVPbkSkwD8U","HEaseDefine");var n={};t.exports=n;n.easeIn=function(e){var t=e;return function(e){return Math.pow(e,t)}},n.easeOut=function(e){var t=e;return function(e){return Math.pow(e,1/t)}},n.easeInOut=function(e){var t=e;return function(e){var o=2*e;return o<1?.5*Math.pow(o,t):1-.5*Math.pow(2-o,t)}},n.backEaseIn=function(e){return function(e){return e*e*(2.70158*e-1.70158)}},n.easeBackOut=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:1.70158)||1.70158;return function(t){return(t-=1)*t*((e+1)*t+e)+1}},n.EaseElasticIn=function(e){var t=e||.3;return function(e){var o=0;if(0==e||1==e)o=e;else{var n=t/4;e-=1,o=-Math.pow(2,10*e)*Math.sin(6.283185307*(e-n)/t)}return o}},n.EaseElasticOut=function(e){var t=e||.3;return function(e){var o=0;if(0==e||1==e)o=e;else{var n=t/4;o=Math.pow(2,-10*e)*Math.sin(6.283185307*(e-n)/t)+1}return o}},n.backEaseOut=function(){return function(e){return(e-=1)*e*(2.70158*e+1.70158)+1}},n.sineEaseOut=function(){return function(e){return Math.sin(6.283185307*e)}},n.sineEaseIn=function(){return function(e){return-1*Math.cos(6.283185307*e)+1}},n.cubicEaseOut=function(){return function(e){return(e-=1)*e*e+1}},n.customEase=function(e){var t=e;return function(e){return t.getRatio(e)}},cc._RF.pop()},{}],HNodeEx:[function(e,t,o){"use strict";cc._RF.push(t,"1afb9ftqTtF6Y4ovrJ6FCQ1","HNodeEx");var n=e("HActionComponent"),i=cc.Node.prototype;i.RunAction=function(e){if(this._components){var t=this.getComponent(n);return t||(this.addComponent(n),(t=this.getComponent(n)).__$init(this)),t.addActionToTickQueue(e),e}},i.RemoveAction=function(e){if(this._components){var t=this.getComponent(n);t&&t.removeAction(e)}},i.RemoveActionByTag=function(e){if(this._components){var t=this.GetActionByTag(e);t&&this.RemoveAction(t)}},i.RemoveAllActions=function(){if(this._components){var e=this.getComponent(n);e&&e.removeAllActions()}},i.StopAllActions=i.RemoveAllActions,i.GetRunningActions=function(){if(!this._components)return[];var e=this.getComponent(n);return e?e.getRunningActions():[]},i.GetActionByTag=function(e){if(!this._components)return null;var t=this.getComponent(n);return t?t.getActionByTag(e):null},i.RemoveEZActionComponent=function(){this.removeComponent(n)},cc._RF.pop()},{HActionComponent:"HActionComponent"}],HVars:[function(e,t,o){"use strict";function n(e){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}cc._RF.push(t,"07939pZNaRDz4+oB3gMMOen","HVars");var i=function(){this.tag=0,this.speed=1,this.repeat=0,this.delay=0};i.prototype.clone=function(e){for(var t=e||{},o=Object.keys(this),i=0;i<o.length;i++){var r=o[i];n(this[r]);if(this[r]instanceof Array){t[r]=[];for(var a=0;a<this[r].length;a++)t[r][a]=this[r][a]}else t[r]=this[r]}return t},i.prototype.patchParams=function(e){if(e)if(e instanceof i)e.clone(this);else for(var t in e)this[t]=e[t]},t.exports=i,cc._RF.pop()},{}],HallPrompt:[function(e,t,o){"use strict";cc._RF.push(t,"55db4L+a6BHMqqDFQGXCgNe","HallPrompt");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../core/gui/GUI"),a=e("../../core/language/LanguageLabel"),c=e("../../core/ui/ViewLayout"),s=e("../../core/ui/ViewUtils"),l=cc._decorator,u=l.ccclass,p=l.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.titleLab=null,t.contentLab=null,t.closeBtn=null,t.okBtn=null,t.okLab=null,t.cancelBtn=null,t.cancelLab=null,t.config={},t}return n(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this);var t=s.ViewUtils.nodeTreeInfoLite(this.node);t.get("lab_ok").getComponent(a.LanguageLabel).dataID="determine",t.get("lab_cancel").getComponent(a.LanguageLabel).dataID="cancel",t.clear(),this.okBtn.on(cc.Node.EventType.TOUCH_END,this.onOk,this),this.closeBtn.on(cc.Node.EventType.TOUCH_END,this.onClose,this),this.cancelBtn.on(cc.Node.EventType.TOUCH_END,this.onCancel,this),this.node.active=!1},t.prototype.onAdded=function(e){void 0===e&&(e={}),this.config=e||{},this.setTitle(),this.setContent(),this.setCancelBtn(),this.node.active=!0},t.prototype.onDestroy=function(){"function"==typeof this.config.cleanFunc&&this.config.cleanFunc(),this.config=null,e.prototype.onDestroy.call(this)},t.prototype.setTitle=function(){this.titleLab.getComponent(cc.Label).string=this.config.title},t.prototype.setContent=function(){this.contentLab.getComponent(cc.Label).string=this.config.content},t.prototype.setOkWord=function(){},t.prototype.setClose=function(){},t.prototype.setCancelBtn=function(){this.cancelBtn.active=this.config.needCancel||!1},t.prototype.onOk=function(){"function"==typeof this.config.okFunc&&this.config.okFunc(),this.close()},t.prototype.onClose=function(){"function"==typeof this.config.closeFunc&&this.config.closeFunc(),this.close()},t.prototype.onCancel=function(){"function"==typeof this.config.cancelFunc&&this.config.cancelFunc(),this.close()},t.prototype.close=function(){r.gui.delete(this.node)},i([p(cc.Node)],t.prototype,"titleLab",void 0),i([p(cc.Node)],t.prototype,"contentLab",void 0),i([p(cc.Node)],t.prototype,"closeBtn",void 0),i([p(cc.Node)],t.prototype,"okBtn",void 0),i([p(cc.Node)],t.prototype,"okLab",void 0),i([p(cc.Node)],t.prototype,"cancelBtn",void 0),i([p(cc.Node)],t.prototype,"cancelLab",void 0),t=i([u],t)}(c.ViewLayout);o.default=d,cc._RF.pop()},{"../../core/gui/GUI":"GUI","../../core/language/LanguageLabel":"LanguageLabel","../../core/ui/ViewLayout":"ViewLayout","../../core/ui/ViewUtils":"ViewUtils"}],HallProtocolCode:[function(e,t,o){"use strict";cc._RF.push(t,"4bcaavCU3JAxJbgZ/H47RSD","HallProtocolCode"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(){}return e.SUCCESS=0,e.LOGIC_ERROR=1,e.PARAM_ERROR=2,e.INVALID=3,e.NO_USER=4,e.NOT_IN_GAME=5,e.SERVER_ERROR=6,e.SERVER_CLOSE=7,e.LACK_CREDIT=8,e.UNKNOWN_REQUEST=9,e.ENTRY_CLOSE=10,e.NETWORK_ERROR=11,e.ACC_ACCOUNT_LOGINED=20,e.AUTO_COMPLETE_LOCK=31,e.NEED_ENTRY_BEFORE=50,e.GAME_NOT_EXIST=101,e.GAME_NOT_OPEN=102,e.LEVEL_NOT_MATCH=103,e.ROOM_NOT_MATCH=104,e.TIME_NOT_ENOUGH=105,e.GET_REWARD_FAILED=106,e.ITEM_NOT_FOUND=110,e.ORDER_NOT_FOUND=111,e.UID_NOT_MATCH=112,e.VERIFY_FAILED=113,e.REPEAT_PAY=114,e.MAIL_CREATE_FAILED=120,e.MAIL_NOT_FOUND=121,e.MAIL_HAS_EXPIRED=122,e.MAIL_HAS_RECEIVED=123,e.MAIL_NO_RECEIVED=124,e.MAIL_IS_UNREAD=125,e.USER_IS_RECEVING=126,e.ACC_NOT_GUEST=130,e.PLATFORM_NOT_FOUND=131,e.BIND_ACC_EXISTS=132,e.ERROR=400,e.REJECT=406,e.HTTPS_ERROR=1e3,e.WALLET_ERROR=1001,e}();o.HallProtocolCode=n,cc._RF.pop()},{}],HashMap:[function(e,t,o){"use strict";cc._RF.push(t,"a50b7oiVbtBYoi5kh76qfMO","HashMap"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(){this._keys=[],this._values=[]}return Object.defineProperty(e.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._keys.indexOf(e)>=0},e.prototype.set=function(e,t){var o=this._keys.indexOf(e);return o<0?(this._keys.push(e),this._values.push(t)):this._values[o]=t,this},e.prototype.get=function(e){var t=this._keys.indexOf(e);return t>=0?this._values[t]:null},e.prototype.delete=function(e){var t=this._keys.indexOf(e);return t>=0&&(this._keys.splice(t,1),this._values.splice(t,1),!0)},e.prototype.keys=function(){return this._keys.slice()},e.prototype.values=function(){return this._values.slice()},e.prototype.getOriginValues=function(){return this._values.slice()},e.prototype.clear=function(){this._keys=[],this._values=[]},e.prototype.forEach=function(e){var t=this;this.keys().forEach(function(o,n){e(t._values[n],o,t)})},Object.defineProperty(e.prototype,"objects",{get:function(){for(var e={},t=0;t<this._keys.length;++t)e[this._keys[t]]=this._values[t];return e},enumerable:!0,configurable:!0}),e}();o.HashMap=n,cc._RF.pop()},{}],HeadSelect:[function(e,t,o){"use strict";cc._RF.push(t,"de68fAmfmxKHbeletfRG/5V","HeadSelect");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../../core/ui/button/ButtonSimple"),a=e("../../../core/ui/ComponentExtends"),c=e("../../../Main"),s=cc._decorator,l=s.ccclass,u=s.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.selectNode=null,t.arrayNode=null,t.targetNode=null,t.headId=1,t}return n(t,e),t.prototype.onLoad=function(){this.arrayNode.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this)},t.prototype.onAdded=function(e){this.targetNode=e.targetNode,this.selectHead(e.headId)},t.prototype.onTouchEnd=function(e){var t=this;if(e.target.getComponent(r.default)){var o=e.target.name.split("_")[1];if(parseInt(o)==this.headId)return;c.default.module.gameProtocol.sendHead(parseInt(o),function(){t.headId=parseInt(o),t.selectHead(parseInt(o));var e=cc.loader.getRes("main/head/head_"+parseInt(o),cc.SpriteFrame);t.targetNode.getComponent(cc.Sprite).spriteFrame=e})}},t.prototype.selectHead=function(e){var t=this;this.headId=e,this.arrayNode.children.forEach(function(o){o.name=="head_"+e&&(t.selectNode.parent=o,t.selectNode.x=30,t.selectNode.y=-30)})},t.prototype.onDestroy=function(){this.targetNode=null,this.node.destroy(),e.prototype.onDestroy.call(this)},i([u(cc.Node)],t.prototype,"selectNode",void 0),i([u(cc.Node)],t.prototype,"arrayNode",void 0),t=i([l],t)}(a.ComponentExtends);o.default=p,cc._RF.pop()},{"../../../Main":"Main","../../../core/ui/ComponentExtends":"ComponentExtends","../../../core/ui/button/ButtonSimple":"ButtonSimple"}],Http:[function(e,t,o){"use strict";cc._RF.push(t,"88c2eBFPlVPaaLPOmu1T+GC","Http"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./RequestEntity"),i=e("./RequestConfig"),r=function(){function e(){this.baseURL="",this._requestHashMap={}}return e.prototype.abort=function(e){var t=null;"string"==typeof e?t=this._requestHashMap[e]:e instanceof n.RequestEntity&&(t=e),t&&(t.$abort(),this.destroy(t))},e.prototype.get=function(e,t){var o=this,r=t||{};r.url=e,!r.baseURL&&this.baseURL&&(r.baseURL=this.baseURL),r.method="GET";var a=new n.RequestEntity(new i.RequestConfig(r));return this._requestHashMap[a.UUID]=a,a.$complete=function(){o.destroy(a)},a},e.prototype.post=function(e,t,o){var r=this,a=o||{};a.url=e,!a.baseURL&&this.baseURL&&(a.baseURL=this.baseURL),a.method="POST",a.data=JSON.stringify(t);var c=new n.RequestEntity(new i.RequestConfig(a));return this._requestHashMap[c.UUID]=c,c.$complete=function(){r.destroy(c)},c},e.prototype.destroy=function(e){delete this._requestHashMap[e.UUID],e.$dispose()},e}();o.Http=r,o.http=new r,cc._RF.pop()},{"./RequestConfig":"RequestConfig","./RequestEntity":"RequestEntity"}],IRoadSeeker:[function(e,t,o){"use strict";cc._RF.push(t,"e4f3f6Ez/xAyqwa4NhT8jTY","IRoadSeeker"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],IncomeCoponent:[function(e,t,o){"use strict";cc._RF.push(t,"50711sQvuBJYKhwm11iZprx","IncomeCoponent");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../core/ui/ComponentExtends"),a=e("../../core/ui/label/LabelChangeSymbol"),c=e("../../core/ui/ViewUtils"),s=e("../../Main"),l=cc._decorator,u=l.ccclass,p=(l.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.onLoad=function(){this.node.hasEventListener(cc.Node.EventType.TOUCH_END)||this.node.on(cc.Node.EventType.TOUCH_END,this.onBtnHandler,this)},t.prototype.onBtnHandler=function(e){switch(e.target.name){case"btn_close":this.node.destroy()}},t.prototype.onAdded=function(e){},t.prototype.update=function(){this.refreshPersonalInfo()},t.prototype.refreshPersonalInfo=function(){var e=c.ViewUtils.nodeTreeInfoLite(this.node),t=s.default.module.calcTool.formatNum(s.default.module.gamedata.rewardTotalAvg);e.get("total_speed_num").getComponent(cc.Label).string=""+t.base+t.gear+"/s",e.get("can_use_num").getComponent(a.LabelChangeSymbol).num=s.default.module.vm.credit,e.get("this_income_num").getComponent(a.LabelChangeSymbol).num=s.default.module.vm.win,e.get("total_income_num").getComponent(a.LabelChangeSymbol).num=s.default.module.vm.winTotal},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t=i([u],t)}(r.ComponentExtends));o.default=p,cc._RF.pop()},{"../../Main":"Main","../../core/ui/ComponentExtends":"ComponentExtends","../../core/ui/ViewUtils":"ViewUtils","../../core/ui/label/LabelChangeSymbol":"LabelChangeSymbol"}],LabLayout:[function(e,t,o){"use strict";cc._RF.push(t,"ee37fHStW1C3ZKI8NaviIMn","LabLayout");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../../core/ui/ComponentExtends"),a=cc._decorator,c=a.ccclass,s=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.onLoad=function(){},t.prototype.update=function(){this.node.width=this.node.getChildByName("lab").width+20},t=i([c],t)}(r.ComponentExtends));o.default=s,cc._RF.pop()},{"../../../core/ui/ComponentExtends":"ComponentExtends"}],LabStepText:[function(e,t,o){"use strict";cc._RF.push(t,"e04e0CglxNJ4ZH0g7EsDKOm","LabStepText");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../../core/Engine"),a=e("../../../core/ui/ComponentExtends"),c=cc._decorator,s=c.ccclass,l=(c.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._dataId="",t.callback=null,t.speed=0,t.isBegin=!1,t.duration=0,t.endStr="",t.currentIndex=-1,t.countTime=0,t}return n(t,e),Object.defineProperty(t.prototype,"dataId",{set:function(e){this.labString="";var t=r.default.i18n.getLangByID(e);this.endStr=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"labString",{get:function(){return this.node.getComponent(cc.Label).string},set:function(e){this.node.getComponent(cc.Label).string=e},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){this.labString=""},t.prototype.changeTo=function(e,t){0!=e?this.playAnim(e,t):t&&t()},t.prototype.playAnim=function(e,t){this.duration=e,this.callback=t,this.speed=this.endStr.split("").length/e,this.isBegin=!0},t.prototype.isEnd=function(e){return e==this.endStr},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.fomat=function(e){for(var t="",o=0;o<e;o++)this.endStr.split("")[o]&&(t+=this.endStr.split("")[o]);return t},t.prototype.update=function(e){if(this.isBegin){if(this.labString==this.endStr)return this.isBegin=!1,this.countTime=0,void(this.callback&&this.callback());this.countTime+=e;var t=this.currentIndex+Math.ceil(this.countTime*this.speed),o=this.fomat(t);this.isEnd(o)&&(o=this.endStr,this.isBegin=!1,this.countTime=0,this.callback&&this.callback()),o&&(this.labString=o)}},t=i([s],t)}(a.ComponentExtends));o.default=l,cc._RF.pop()},{"../../../core/Engine":"Engine","../../../core/ui/ComponentExtends":"ComponentExtends"}],LabTouchFont:[function(e,t,o){"use strict";cc._RF.push(t,"8d03fLKiHxEUqXzb4omv6rK","LabTouchFont");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../../core/ui/ComponentExtends"),a=cc._decorator,c=a.ccclass,s=(a.property,new cc.Color(64,140,8)),l=new cc.Color(192,255,6),u=new cc.Color(72,72,72),p=new cc.Color(169,169,169),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._canTouch=!0,t}return n(t,e),Object.defineProperty(t.prototype,"canTouch",{get:function(){return this._canTouch},set:function(e){this.node.getComponent(cc.LabelShadow)&&(this._canTouch=e,this.node.color=e?s:u,this.node.getComponent(cc.LabelShadow).color=e?l:p)},enumerable:!0,configurable:!0}),t.prototype.start=function(){},t.prototype.onLoad=function(){this.node.addComponent(cc.LabelShadow),this.node.getComponent(cc.Label).enableBold=!0,this.node.getComponent(cc.LabelShadow).blur=2,this.node.getComponent(cc.LabelShadow).offset=new cc.Vec2(2,-2),this.canTouch=this._canTouch},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t=i([c],t)}(r.ComponentExtends);o.default=d,cc._RF.pop()},{"../../../core/ui/ComponentExtends":"ComponentExtends"}],LabelChangeSymbol:[function(e,t,o){"use strict";cc._RF.push(t,"8e684/IydpCpJlvzIxKdP0Q","LabelChangeSymbol");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../../Main"),a=e("../../Engine"),c=cc._decorator,s=c.ccclass,l=c.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._num={num:0,numE:0},t.labNum=0,t.showdecimal=!0,t.topAdd="",t.useFix=!0,t.isInteger=!1,t.callback=null,t.isBegin=!1,t.speed=null,t.end=null,t._endAdd="",t.direction=!0,t}return n(t,e),Object.defineProperty(t.prototype,"num",{get:function(){return this._num},set:function(e){this._num=e,this.endAdd=r.default.module.calcTool.formatNum(e).gear,this.isInteger&&e.numE<0?this.labNum=Math.floor(this._num.num*Math.pow(10,this._num.numE)):this.labNum=r.default.module.calcTool.formatNum(e).base,this.updateLabel()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"endAdd",{get:function(){return this._endAdd},set:function(e){this._endAdd=e},enumerable:!0,configurable:!0}),t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this),this.callback=null},t.prototype.changeTo=function(e,t,o){0!=e?this.playAnim(e,this.num,t,o):o&&o()},t.prototype.playAnim=function(e,t,o,n){if(this.end=o,this.callback=n,r.default.module.calcTool.compare(o,t)){var i=r.default.module.calcTool.calcMinusNum(o,t);this.speed={num:i.num/e,numE:i.numE},this.direction=!0}else{i=r.default.module.calcTool.calcMinusNum(t,o);this.speed={num:i.num/e,numE:i.numE},this.direction=!1}this.num=t,this.isBegin=!0},t.prototype.isEnd=function(e){return this.direction?r.default.module.calcTool.compare(e,this.end):r.default.module.calcTool.compareLess(e,this.end)},t.prototype.update=function(e){if(this.isBegin){if(this.num.num==this.end.num&&this.num.numE==this.end.numE)return this.isBegin=!1,void(this.callback&&this.callback());this.isInteger=""==this.endAdd;var t={num:this.speed.num*e,numE:this.speed.numE},o={num:0,numE:0};o=this.direction?r.default.module.calcTool.calcAddNum(this.num,t,!1):r.default.module.calcTool.calcMinusNum(this.num,t,!1),this.isEnd(o)&&(o=this.end,this.isBegin=!1,this.callback&&this.callback()),this.num=o}},t.prototype.updateLabel=function(){"number"==typeof this._num.num&&"number"==typeof this._num.numE||cc.error("[LabelNumber] num\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u6570\u5b57"),this.useFix&&(this.showdecimal?this.endAdd.split("").length>2?this.string=this.topAdd+this.toCurrencyFormat(this.labNum,!0,2)+this.endAdd:""==this.endAdd?this.string=this.topAdd+this.toCurrencyFormat(this.labNum,!0,0)+this.endAdd:this.string=this.topAdd+this.toCurrencyFormat(this.labNum,!0,3)+this.endAdd:this.string=this.topAdd+a.default.value.toIntFormat(this._num.num)+this.endAdd,"lab_credit"==this.node.name&&(this.spacingX=this.string.split("").length>7||this.endAdd.split("").length>1?-12:-18))},t.prototype.toCurrencyFormat=function(e,t,o){void 0===t&&(t=!0);var n="";e<0&&(n="-",e=Math.abs(e));var i=e.toString().split("."),r=i[0]||"0",a=i[1]||"",c="";0!=o&&i[1]&&(a=d(a,o),c=".");return 0==o?n+e:t?n+p(r)+c+a:n+r+c+a},i([l({tooltip:"\u662f\u5426\u663e\u793a\u5c0f\u6570\u4f4d"})],t.prototype,"showdecimal",void 0),i([l({tooltip:"\u6700\u524d\u9762\u6dfb\u52a0\u5185\u5bb9"})],t.prototype,"topAdd",void 0),i([l],t.prototype,"isInteger",void 0),t=i([s],t)}(cc.Label);o.LabelChangeSymbol=u;var p=function(e){for(var t=[],o=e;o.length>=3;)t.unshift(o.substr(-3)),o=o.substr(0,o.length-3);return o.length>0&&t.unshift(o),t.join(",")},d=function(e,t){if(e.length<t){for(var o=t-e.length;o>0;)e+="0",--o;return e}return e.substr(0,t)};cc._RF.pop()},{"../../../Main":"Main","../../Engine":"Engine"}],LabelChange:[function(e,t,o){"use strict";cc._RF.push(t,"f9cdfg8Ga5MY6+A35DXDpYg","LabelChange");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("./LabelNumber"),a=cc._decorator,c=a.ccclass,s=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isInteger=!1,t.duration=0,t.callback=null,t.isBegin=!1,t.speed=0,t.end=0,t}return n(t,e),t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this),this.callback=null},t.prototype.changeTo=function(e,t,o){0!=e?this.playAnim(e,this.num,t,o):o&&o()},t.prototype.changeBy=function(e,t,o){0!=e?this.playAnim(e,this.num,this.num+t,o):o&&o()},t.prototype.stop=function(e){void 0===e&&(e=!0),this.num=this.end,this.isBegin=!1,e&&this.callback&&this.callback()},t.prototype.checkAndChange=function(e,t){this.isBegin?this.end=t:(this.duration=e,this.changeTo(this.duration,t))},t.prototype.playAnim=function(e,t,o,n){this.duration=e,this.end=o,this.callback=n,this.speed=(o-t)/e,this.num=t,this.isBegin=!0},t.prototype.isEnd=function(e){return this.speed>0?e>=this.end:e<=this.end},t.prototype.update=function(e){if(this.isBegin){if(this.num==this.end)return this.isBegin=!1,void(this.callback&&this.callback());var t=this.num+e*this.speed;this.isInteger&&(t=Math.ceil(t)),this.isEnd(t)&&(t=this.end,this.isBegin=!1,this.callback&&this.callback()),this.num=t}},i([s],t.prototype,"isInteger",void 0),t=i([c],t)}(r.default);o.LabelChange=l,cc._RF.pop()},{"./LabelNumber":"LabelNumber"}],LabelNumber:[function(e,t,o){"use strict";cc._RF.push(t,"31853JNDlVPXqVvdsPVZ+F5","LabelNumber");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../Engine"),a=cc._decorator,c=a.ccclass,s=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._num=0,t._showSym="",t.showdecimal=!0,t.topAdd="",t.useFix=!0,t.numChange=null,t}return n(t,e),Object.defineProperty(t.prototype,"num",{get:function(){return this._num},set:function(e){this._num=e,this.updateLabel(),this.numChange&&this.numChange(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showSym",{get:function(){return this._showSym},set:function(e){e&&(this._showSym=e,this.updateLabel())},enumerable:!0,configurable:!0}),t.prototype.onDestroy=function(){this.numChange=null},t.prototype.updateLabel=function(){"number"!=typeof this._num&&cc.error("[LabelNumber] num\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u6570\u5b57"),this.useFix?this.showdecimal?this.string=this.topAdd+r.default.value.toCurrencyFormat(this._num):this.string=this.topAdd+r.default.value.toIntFormat(this._num):this.string=this.topAdd+this.num.toString()},i([s(cc.Float)],t.prototype,"_num",void 0),i([s({tooltip:"\u662f\u5426\u663e\u793a\u8d27\u5e01\u7b26\u53f7"})],t.prototype,"_showSym",void 0),i([s],t.prototype,"num",null),i([s({tooltip:"\u662f\u5426\u663e\u793a\u5c0f\u6570\u4f4d"})],t.prototype,"showdecimal",void 0),i([s({tooltip:"\u6700\u524d\u9762\u6dfb\u52a0\u5185\u5bb9"})],t.prototype,"topAdd",void 0),i([s],t.prototype,"showSym",null),i([s],t.prototype,"useFix",void 0),t=i([c],t)}(cc.Label);o.default=l,cc._RF.pop()},{"../../Engine":"Engine"}],LabelSelect:[function(e,t,o){"use strict";cc._RF.push(t,"b9c04Az241HcoJ46MTj78JC","LabelSelect");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("./SelectBase"),a=cc._decorator,c=a.ccclass,s=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.offColor=null,t.onColor=null,t}return n(t,e),t.prototype.refresh=function(){this.node.color=this.state?this.onColor:this.offColor},i([s(cc.Color)],t.prototype,"offColor",void 0),i([s(cc.Color)],t.prototype,"onColor",void 0),t=i([c],t)}(r.default);o.LabelSelect=l,cc._RF.pop()},{"./SelectBase":"SelectBase"}],LabelSpineAnim:[function(e,t,o){"use strict";cc._RF.push(t,"cbb76O9SG5ATLVZ6OSEb3+c","LabelSpineAnim");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../Engine"),a=e("../ComponentExtends"),c=cc._decorator,s=c.ccclass,l=c.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.skeletonNode=null,t.cy=null,t.cySkeletonNode1=null,t.cySkeletonNode2=null,t.skeletonDistance=75,t.duration=0,t.callback=null,t.isBegin=!1,t.speed=0,t.endNum=0,t.currentNum=0,t.skeletonObjectArray=[],t.currentSkeletonArray=[],t.cyWidth=0,t.nodeScale=1,t.suf=0,t}return n(t,e),Object.defineProperty(t.prototype,"num",{get:function(){return this.currentNum},set:function(e){this.currentNum=e},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){this.currentNum=0,this.currentSkeletonArray=[],this.skeletonObjectArray=[],this.skeletonNode.active=!1,this.cySkeletonNode1.active=!1,this.cySkeletonNode2.active=!1},t.prototype.changeTo=function(e,t,o){if(0==e)return this.endNum=t,this.currentNum=t,this.playAnim(e,o),void(o&&o());this.currentNum=0,this.endNum=t,this.playAnim(e,o)},t.prototype.changBy=function(e,t){this.endNum=e,this.currentNum=e,this.playAnim(0,t),t&&t()},t.prototype.playAnim=function(e,t){this.duration=e,this.callback=t,this.speed=this.endNum/e,this.isBegin=!0},t.prototype.isEnd=function(e){return this.speed>0?e>=this.endNum:e<=this.endNum},t.prototype.getPosByLength=function(e){var t=-50;this.cy.string.split("").length>1?t=-20:0==this.cy.string.split("").length&&(t=this.skeletonDistance/2+5);var o=Math.floor(e/2)*-this.skeletonDistance+this.cyWidth+t,n=[];n.push(o);for(var i=1;i<e;i++)n.push(o+this.skeletonDistance*i);return n},t.prototype.update=function(e){var t=this;if(this.isBegin){this.currentNum==this.endNum&&(this.isBegin=!1);this.currentNum=this.currentNum+e*this.speed,this.isEnd(this.currentNum)&&(this.currentNum=this.endNum,this.callback&&this.callback());var o=r.default.value.toCurrencyFormat(this.currentNum).split("");this.getScaleByLength(o.length),this.cy.string=r.default.value.currencySymbol;var n=-50;this.cy.string.split("").length>1&&(n=-20),this.cy.string.split("").length>1?(this.cySkeletonNode1.active=!0,this.cySkeletonNode2.active=!0,this.cySkeletonNode1.x=-40,this.cySkeletonNode2.x=30):0==this.cy.string.split("").length?(this.cySkeletonNode1.active=!1,this.cySkeletonNode2.active=!1,n=this.skeletonDistance/2+5):(this.cySkeletonNode1.active=!0,this.cySkeletonNode2.active=!1,this.cySkeletonNode1.x=0),this.cyWidth=82*this.cy.string.split("").length;var i=this.getPosByLength(o.length);this.cy.node.x=i[0]-this.cyWidth-n,t.skeletonObjectArray.forEach(function(e){e.skeletonNode.active&&(e.isUse=!1)}),o.forEach(function(e,o){var n=t.checkSkeletonObject(e,i[o]);n?(n.skeletonNode.active=!0,n.isUse=!0):t.getStrAnim(e,i[o]).skeletonNode.active=!0}),this.saveSkeletonObjectByActive()}},t.prototype.getScaleByLength=function(e){e<5?(this.node.scale=1,this.node.x=-20):e<6?(this.node.scale=1,this.node.x=-40):e<8?(this.node.scale=1,this.node.x=-10):e<9?(this.node.scale=.85,this.node.x=-10):e<10?(this.node.scale=.7,this.node.x=-20):e<11?(this.node.scale=.7,this.node.x=-10):e<13?(this.node.scale=.6,this.node.x=-12):e<14?(this.node.scale=.55,this.node.x=-18):e<15?(this.node.scale=.55,this.node.x=-10):e<18&&(this.node.scale=.45,this.node.x=-10)},t.prototype.saveSkeletonObjectByActive=function(){var e=this;this.currentSkeletonArray=[],this.skeletonObjectArray.forEach(function(t){t.isUse?e.currentSkeletonArray.push(t):t.skeletonNode.active=!1})},t.prototype.checkSkeletonObject=function(e,t){var o=null;return this.currentSkeletonArray.forEach(function(n){e==n.name.split("")[0]&&t==n.skeletonNode.x&&(o=n)}),o},t.prototype.getStrAnim=function(e,t){var o=this,n=function(e){return o.skeletonObjectArray.forEach(function(o){if(o.name.split("")[0]==e&&!o.isUse)return o.skeletonNode.x=t,o}),null}(e);if(n)return n.isUse=!0,n;var i=cc.instantiate(this.skeletonNode),r=new p;r.skeletonNode=i,r.name=e+this.suf++,r.skeletonNode.parent=this.node,r.skeletonNode.active=!0,r.skeletonNode.x=t;var a="";return a=","==e?"word11":"."==e?"word10":"word"+e,r.skeletonNode.getComponent(sp.Skeleton).setAnimation(0,a,!0),this.skeletonObjectArray.push(r),r},i([l(cc.Node)],t.prototype,"skeletonNode",void 0),i([l({type:cc.Label,tooltip:"\u8d27\u5e01\u7b26\u53f7label"})],t.prototype,"cy",void 0),i([l(cc.Node)],t.prototype,"cySkeletonNode1",void 0),i([l(cc.Node)],t.prototype,"cySkeletonNode2",void 0),i([l({tooltip:"\u6bcf\u4e2aspine\u7684\u8ddd\u79bb"})],t.prototype,"skeletonDistance",void 0),t=i([s],t)}(a.ComponentExtends);o.LabelSpineAnim=u;var p=function(){return function(){this.isUse=!0}}();o.wordObject=p,cc._RF.pop()},{"../../Engine":"Engine","../ComponentExtends":"ComponentExtends"}],LabelTime:[function(e,t,o){"use strict";cc._RF.push(t,"c8654aC0vpNaI1veeZyTsaY","LabelTime");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../Engine"),a=cc._decorator,c=a.ccclass,s=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.countDown=1e3,t.dayFormat="{0} day",t.timeFormat="{0}:{1}:{2}",t.zeroize=!0,t}return n(t,e),t.prototype.replace=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];return e.replace(/\{(\d+)\}/g,function(e,o){return t[o]})},t.prototype.format=function(){var e=this.countDown,t=Math.floor(e/86400);e-=86400*t;var o=Math.floor(e/3600);e-=3600*o;var n=Math.floor(e/60),i=e-=60*n;if(this.dateDisable=this.dateDisable||!1,0==t&&0==o&&0==n&&0==i)this.zeroize?this.result=this.replace(this.timeFormat,"00","00","00"):this.result=this.replace(this.timeFormat,"0","0","0");else if(t>0&&!this.dateDisable){var r=this.dayFormat,a=r.indexOf("{1}");0==o&&a>-1&&(r=r.substring(0,a-1));var c=r;t>1&&r.indexOf("days")<0&&(c=c.replace("day","days")),t<2&&(c=c.replace("days","day")),this.result=this.replace(c,t,o)}else o+=24*t,this.zeroize?this.result=this.replace(this.timeFormat,this.coverString(o),this.coverString(n),this.coverString(i)):this.result=this.replace(this.timeFormat,o,n,i);this.string=this.result},t.prototype.coverString=function(e){return e<10?"0"+e:e.toString()},t.prototype.setDateDisable=function(e){this.dateDisable=e},t.prototype.setCdTime=function(e){this.countDown=e,this.format()},t.prototype.onLoad=function(){this.format(),this.timeId=r.default.timer.registerObject(this,"countDown",this.onSecond,this.onComplete)},t.prototype.onDestroy=function(){r.default.timer.unRegisterObject(this.timeId)},t.prototype.onSecond=function(){this.format(),this.second&&this.second(this.node)},t.prototype.onComplete=function(){this.complete&&this.complete(this.node)},i([s({tooltip:"\u5230\u8ba1\u65f6\u95f4\u603b\u65f6\u95f4\uff08\u5355\u4f4d\u79d2\uff09",type:cc.Integer})],t.prototype,"countDown",void 0),i([s({tooltip:"\u5929\u6570\u6570\u636e\u683c\u5f0f\u5316"})],t.prototype,"dayFormat",void 0),i([s({tooltip:"\u65f6\u95f4\u683c\u5f0f\u5316"})],t.prototype,"timeFormat",void 0),i([s({tooltip:"\u662f\u5426\u670900"})],t.prototype,"zeroize",void 0),t=i([c],t)}(cc.Label);o.default=l,cc._RF.pop()},{"../../Engine":"Engine"}],LandmarkComonent:[function(e,t,o){"use strict";cc._RF.push(t,"5ab2e6YC49P5pDtQiX/1uEg","LandmarkComonent");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});e("../../../core/event/MessageManager"),e("../../../core/gui/GUI");var r=e("../../../core/ui/ComponentExtends"),a=(e("../../../Main"),e("../../AudioMessage"),e("../effect/MapControl"),cc._decorator),c=a.ccclass,s=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.onLoad=function(){cc.director.getCollisionManager().enabled=!0,cc.director.getCollisionManager().enabled=!0,this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd.bind(this),this)},t.prototype.onTouchEnd=function(e,t){},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t=i([c],t)}(r.ComponentExtends));o.default=s,cc._RF.pop()},{"../../../Main":"Main","../../../core/event/MessageManager":"MessageManager","../../../core/gui/GUI":"GUI","../../../core/ui/ComponentExtends":"ComponentExtends","../../AudioMessage":"AudioMessage","../effect/MapControl":"MapControl"}],LandmarkProgress:[function(e,t,o){"use strict";cc._RF.push(t,"c20fbHaHRJJQblfkttx32Q0","LandmarkProgress");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../../core/event/MessageManager"),a=e("../../../core/language/LanguageLabel"),c=e("../../../core/ui/button/ButtonEffect"),s=e("../../../core/ui/ComponentExtends"),l=e("../../../core/ui/label/LabelChangeSymbol"),u=e("../../../core/ui/ViewUtils"),p=e("../../../Main"),d=cc._decorator,h=d.ccclass,f=(d.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.nextCanClickTime=0,t.canGetDiamond=!0,t}return n(t,e),t.prototype.onLoad=function(){this.node.hasEventListener(cc.Node.EventType.TOUCH_END)||this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchHandler,this)},t.prototype.onAdded=function(e){cc.log("LandmarkProgress\u754c\u9762\u5f39\u7a97");var t=u.ViewUtils.nodeTreeInfoLite(this.node),o=p.default.module.calcUiShow.getTimeStageReward(300);0==o.num&&(o={num:1,numE:3}),t.get("layout").active=!1,this.scheduleOnce(function(){t.get("layout").active=!0}),t.get("coin_num").getComponent(l.LabelChangeSymbol).num=o,t.get("diamond_skeleton").active=!1,t.get("diamond_skeleton").getComponent(sp.Skeleton).setAnimation(0,"reward_loop",!0),this.nextCanClickTime=p.default.module.calcUiShow.getSeverCurrentTime()},t.prototype.onTouchHandler=function(e){var t=p.default.module.calcUiShow.getTimeStageReward(300);0==t.num&&(t={num:1,numE:3})},t.prototype.update=function(){this.setProgress(p.default.module.vm.advCount);var e=p.default.module.calcUiShow.getSeverCurrentTime();this.showButtonEffect(this.node.getChildByName("btn_poster"),e>=this.nextCanClickTime);var t=p.default.module.vm.advCount;this.node.getChildByName("diamond_skeleton").active=t>=5,this.node.getChildByName("btn_diamond").active=t>=5,this.node.getChildByName("progress").active=t<5,this.node.getChildByName("layout").active=t<5,this.showButtonEffect(this.node.getChildByName("btn_diamond"),t>=5&&this.canGetDiamond)},t.prototype.setProgress=function(e){var t=u.ViewUtils.nodeTreeInfoLite(this.node),o=0;switch(t.get("poster_lab").getComponent(a.LanguageLabel).dataID="ui_ad_4",t.get("poster_lab").x=35,t.get("adv").active=!0,e){case 0:o=0;break;case 1:o=.09;break;case 2:o=.295;break;case 3:o=.51;break;case 4:o=.75;break;case 5:o=0,t.get("adv").active=!1,t.get("poster_lab").getComponent(a.LanguageLabel).dataID="ui_ad_6",t.get("poster_lab").x=0}t.get("progress_spr").getComponent(cc.Sprite).fillRange=o},t.prototype.showButtonEffect=function(e,t){var o=t?cc.Color.WHITE:cc.Color.GRAY,n=e.getComponent(c.default);e.color=o,n&&(n.canTouch=t);var i=function(e){if(0!=e.children.length)for(var t=0,n=e.children;t<n.length;t++){var r=n[t];r.color=o,i(r)}};i(e)},t.prototype.onDestroy=function(){r.Message.removeEventTarget(this),e.prototype.onDestroy.call(this)},t=i([h],t)}(s.ComponentExtends));o.default=f,cc._RF.pop()},{"../../../Main":"Main","../../../core/event/MessageManager":"MessageManager","../../../core/language/LanguageLabel":"LanguageLabel","../../../core/ui/ComponentExtends":"ComponentExtends","../../../core/ui/ViewUtils":"ViewUtils","../../../core/ui/button/ButtonEffect":"ButtonEffect","../../../core/ui/label/LabelChangeSymbol":"LabelChangeSymbol"}],LanguageComponent:[function(e,t,o){"use strict";cc._RF.push(t,"785b8JnCNJMu6RePrP0bGF6","LanguageComponent");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i=e("./Language"),r=e("./LanguageI18nEnum"),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),Object.defineProperty(t.prototype,"i18n",{get:function(){return i.LanguageManager.getInstance(r.LanguageI18nEnum.DEFAULT)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"language",{set:function(e){},enumerable:!0,configurable:!0}),t}(cc.Component);o.LanguageComponent=a,cc._RF.pop()},{"./Language":"Language","./LanguageI18nEnum":"LanguageI18nEnum"}],LanguageI18nEnum:[function(e,t,o){"use strict";cc._RF.push(t,"e49a1UIIkBO8bfpeYURYcsl","LanguageI18nEnum"),Object.defineProperty(o,"__esModule",{value:!0}),function(e){e.DEFAULT="LanguageManager_default",e.EX_GAME="LanguageManager_exgame"}(o.LanguageI18nEnum||(o.LanguageI18nEnum={})),cc._RF.pop()},{}],LanguageLabel:[function(e,t,o){"use strict";cc._RF.push(t,"110c8vEd5NEPL/N9meGQnaX","LanguageLabel");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("./LanguageComponent"),a=cc._decorator,c=a.ccclass,s=a.property,l=function(){function e(){this.key="",this.value=""}return i([s(cc.String)],e.prototype,"key",void 0),i([s(cc.String)],e.prototype,"value",void 0),e=i([c("LangLabelParamsItem")],e)}();o.LangLabelParamsItem=l;var u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._params=[],t._dataID="",t.initFontSize=0,t._needUpdate=!1,t}return n(t,e),Object.defineProperty(t.prototype,"params",{get:function(){return this._params||[]},set:function(e){this._params=e,this._needUpdate=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dataID",{get:function(){return this._dataID||""},set:function(e){this._dataID=e,this._needUpdate=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"string",{get:function(){if(this.i18n){var e=this.i18n.getLangByID(this._dataID);if(this.i18n.beforeChangeLabel&&this.i18n.beforeChangeLabel(this,e,this._dataID),e)return e&&this._params.length>0&&this._params.forEach(function(t){e=e.replace("%{"+t.key+"}",t.value)}),e||(e=this._dataID),e}},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){this._needUpdate=!0,this.initFontSize=this.node.getComponent(cc.Label).fontSize},t.prototype.onDestroy=function(){this._params=null},t.prototype.getLabelFont=function(e){switch(e){case"zh":case"tr":return"SimHei"}return"Arial"},t.prototype.setVars=function(e,t){for(var o=!1,n=0;n<this._params.length;n++){var i=this._params[n];i.key===e&&(i.value=t,o=!0)}if(!o){var r=new l;r.key=e,r.value=t,this._params.push(r)}this._needUpdate=!0},t.prototype.update=function(e){this._needUpdate&&(this.updateLabel(),this._needUpdate=!1)},Object.defineProperty(t.prototype,"language",{set:function(e){this._needUpdate=!0},enumerable:!0,configurable:!0}),t.prototype.updateLabel=function(){do{if(!this._dataID||!this.i18n)break;var e=this.node.getComponent(cc.Label);if(!e){cc.warn("[LanguageLabel], \u8be5\u8282\u70b9\u6ca1\u6709cc.Label\u7ec4\u4ef6");break}e.fontFamily=this.getLabelFont(this.i18n.currentLanguage),this.string&&(e.string=this.string)}while(0)},i([s({type:l,displayName:"params"})],t.prototype,"_params",void 0),i([s({type:l,displayName:"params"})],t.prototype,"params",null),i([s(cc.String)],t.prototype,"_dataID",void 0),i([s({type:cc.String,displayName:"dataID"})],t.prototype,"dataID",null),t=i([c],t)}(r.LanguageComponent);o.LanguageLabel=u,cc._RF.pop()},{"./LanguageComponent":"LanguageComponent"}],LanguagePack:[function(e,t,o){"use strict";cc._RF.push(t,"2ffebyj59xIc4v4BZty8SDm","LanguagePack"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(){this._languageLabels={},this._exLanguageLabels={},this._langjsonPath="langjson",this._langTexturePath="language"}return e.prototype.destroy=function(){this._languageLabels=null,this._exLanguageLabels=null},e.prototype.setAssetsPath=function(e,t){e&&(this._langjsonPath=e),t&&(this._langTexturePath=t)},e.prototype.setExLabels=function(e){this._exLanguageLabels=e},e.prototype.updateLanguage=function(e,t){var o=this;e=e.toLowerCase(),this._loadLanguageAssets(e,function(n){if(n)t(n);else{var i=cc.loader.getRes(o._langjsonPath+"/"+e);i?o._languageLabels=i.json:cc.warn("\u6ca1\u6709\u627e\u5230\u6307\u5b9a\u8bed\u8a00\u5185\u5bb9\u914d\u7f6e",e),t(null)}})},e.prototype.getLangByID=function(e){var t=this._languageLabels[e];return!t&&this._exLanguageLabels&&(t=this._exLanguageLabels[e]),t||""},e.prototype.parseUuidToUrl=function(e){var t=null;for(var o in cc.loader._resources&&(t=cc.loader._resources._pathToUuid),t||(t=cc.loader._assetTables.assets._pathToUuid),t){var n=t[o];if(n instanceof Array)for(var i=0,r=n;i<r.length;i++){if(r[i].uuid===e)return o}else if(n.uuid===e)return o}return""},e.prototype._loadLanguageAssets=function(e,t){var o=this._langTexturePath+"/"+e,n=this._langjsonPath+"/"+e;cc.log("\u4e0b\u8f7d\u8bed\u8a00\u5305 textures \u8d44\u6e90",o),cc.log("\u4e0b\u8f7d\u8bed\u8a00\u5305 json \u8d44\u6e90",n),cc.loader.loadResDir(o,function(i){cc.log("loadcomplete,"+o,i),i&&cc.warn(i),cc.loader.loadRes(n,cc.JsonAsset,function(o){cc.log("loadcomplete,"+n,o),o&&cc.warn(o),t(null,e)})})},e.prototype.releaseLanguageAssets=function(e){var t=this._langTexturePath+"/"+e;cc.loader.releaseResDir(t),cc.log("\u91ca\u653e\u8bed\u8a00\u5305\u8d44\u6e90",t);var o=this._langjsonPath+"/"+e;cc.loader.releaseRes(o),cc.log("\u91ca\u653e\u8bed\u8a00\u7cfb\u7edf\u6587\u5b57\u8d44\u6e90",o)},e}();o.default=n,cc._RF.pop()},{}],LanguagePointLabel:[function(e,t,o){"use strict";cc._RF.push(t,"5b801Pw++JOZ4b1wI4zDajy","LanguagePointLabel");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("./LanguageLabel"),a=cc._decorator,c=a.ccclass,s=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.fontSize=25,t.lineHeight=30,t.pointSpace=10,t.isUpdate=!1,t}return n(t,e),t.prototype.onLoad=function(){this.initFontSize=this.fontSize},t.prototype.update=function(){this.isUpdate||(this.isUpdate=!0,this.updateLab())},t.prototype.updateLab=function(){var e=this;this.node.getComponent(cc.Widget).updateAlignment(),this.string.split("\n").forEach(function(t){""!=t&&e.createLab(t)})},t.prototype.createLab=function(e){var t=new cc.Node;t.width=this.node.width;var o=t.addComponent(cc.Label);o.string=e,o.horizontalAlign=cc.Label.HorizontalAlign.LEFT,o.verticalAlign=cc.Label.VerticalAlign.CENTER,o.fontSize=this.fontSize,o.lineHeight=this.lineHeight,o.overflow=cc.Label.Overflow.RESIZE_HEIGHT,o.fontFamily=this.getLabelFont(this.i18n.currentLanguage),o.string=e,t.parent=this.node;var n=new cc.Node;n.parent=t,n.x=-(t.width/2+this.pointSpace),n.y=t.height/2-this.lineHeight/2-(this.lineHeight-this.fontSize)/2;var i=n.addComponent(cc.Label);i.fontSize=this.fontSize,i.lineHeight=this.lineHeight,i.fontFamily=this.getLabelFont(this.i18n.currentLanguage),i.string="\u2022",this.layout()},t.prototype.layout=function(){var e=this.node.addComponent(cc.Layout);e.type=cc.Layout.Type.VERTICAL,e.spacingY=this.lineHeight/3,e.resizeMode=cc.Layout.ResizeMode.CONTAINER},i([s({tooltip:"\u5b57\u5927\u5c0f"})],t.prototype,"fontSize",void 0),i([s({tooltip:"\u884c\u9ad8"})],t.prototype,"lineHeight",void 0),i([s({tooltip:"\u70b9\u5230\u5185\u5bb9\u7684\u8ddd\u79bb"})],t.prototype,"pointSpace",void 0),t=i([c],t)}(r.LanguageLabel);o.LanguagePointLabel=l,cc._RF.pop()},{"./LanguageLabel":"LanguageLabel"}],LanguageScale:[function(e,t,o){"use strict";cc._RF.push(t,"83d07uQ8L9P14GLzwGqNHOH","LanguageScale");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../core/ui/ComponentExtends"),a=e("../../Main"),c=cc._decorator,s=c.ccclass,l=c.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.en_scale=1,t}return n(t,e),t.prototype.onLoad=function(){this.node.scale=1,"en"==a.default.module.vm.lang&&(this.node.scale=this.en_scale)},t.prototype.onDestroy=function(){},i([l],t.prototype,"en_scale",void 0),t=i([s],t)}(r.ComponentExtends);o.default=u,cc._RF.pop()},{"../../Main":"Main","../../core/ui/ComponentExtends":"ComponentExtends"}],LanguageSprite:[function(e,t,o){"use strict";cc._RF.push(t,"11b96k/RIZF57Loehxyl6Hs","LanguageSprite");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("./LanguageComponent"),a=cc._decorator,c=a.ccclass,s=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.spriteFramePath="",t}return n(t,e),t.prototype.start=function(){this.updateSprite(this.i18n.currentLanguage)},Object.defineProperty(t.prototype,"language",{set:function(e){this.updateSprite(e)},enumerable:!0,configurable:!0}),t.prototype.updateSprite=function(e){do{var t=this.node.getComponent(cc.Sprite);if(!t){cc.warn("[LanguageSprite], state = 1");break}var o=this.spriteFramePath;if(t.spriteFrame){var n=t.spriteFrame._uuid;if(!(o=this.i18n.parseUuidToUrl(n))){cc.warn("[LanguageSprite], state = 2");break}}if(!o){cc.log("\u7eb9\u7406\u5bf9\u8c61\u4e3a\u7a7a\uff0c\u65e0\u6cd5\u5207\u6362\u591a\u8bed\u79cd\u56fe\u7247",this.node.name);break}for(var i=o.split("/").reverse(),r=!1,a=0;a<i.length;a++)if(this.i18n.isExist(i[a])){if(i[a]===e)return void(this.spriteFramePath=o);r=!0,i[a]=e;break}r||cc.warn("\u5f53\u524d\u8282\u70b9\u4e0d\u652f\u6301\u8bed\u8a00\u66f4\u6362\uff0c\u8bf7\u68c0\u67e5\u6587\u4ef6\u8def\u5f84\u662f\u5426\u6709\u6548\uff0c"+o);var c=i.reverse().join("/"),s=cc.loader.getRes(c,cc.SpriteFrame);if(!s){cc.warn("[LanguageSprite] newspf is null "+c);break}this.spriteFramePath=c,t.spriteFrame=s}while(0)},i([s(cc.String)],t.prototype,"spriteFramePath",void 0),t=i([c],t)}(r.LanguageComponent);o.LanguageSprite=l,cc._RF.pop()},{"./LanguageComponent":"LanguageComponent"}],Language:[function(e,t,o){"use strict";cc._RF.push(t,"3757cxZqLZObIdvP/gQ6Yuj","Language");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i,r=e("../event/EventObjectEmitter"),a=e("../util/HashMap"),c=e("./LanguageComponent"),s=e("./LanguageI18nEnum"),l=e("./LanguagePack");(function(e){e.CHANGE="LanguageEvent.CHANGE",e.CHANGE_COMPLETE="LanguageEvent.CHANGE_COMPLETE",e.RELEASE_RES="LanguageEvent.RELEASE_RES"})(i=o.LanguageEvent||(o.LanguageEvent={}));var u=function(e){function t(o){var n=e.call(this)||this;return n._currentLang="",n._languagePack=null,n._supportLanguages=["zh","en","tr"],n.beforeChangeLabel=null,n._name=s.LanguageI18nEnum.DEFAULT,o&&(n._name=o),t.instances.has(n._name)&&cc.error("LanguageManager instances has same name!!",n._name),t.instances.set(n._name,n),n}return n(t,e),t.getInstance=function(e){return t.instances.get(e)},Object.defineProperty(t.prototype,"supportLanguages",{set:function(e){this._supportLanguages=e},enumerable:!0,configurable:!0}),t.prototype.setAssetsPath=function(e,t){this.languagePack.setAssetsPath(e,t)},t.prototype.destroy=function(){e.prototype.destroy.call(this),t.instances.delete(this._name),this._languagePack&&(this._languagePack.destroy(),this._languagePack=null)},Object.defineProperty(t.prototype,"languagePack",{get:function(){return this._languagePack||(this._languagePack=new l.default),this._languagePack},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentLanguage",{get:function(){return this._currentLang},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"languages",{get:function(){return this._supportLanguages},enumerable:!0,configurable:!0}),t.prototype.isExist=function(e){return this.languages.indexOf(e)>-1},t.prototype.setLanguage=function(e,t){var o=this;e||(e="en"),e=e.toLowerCase(),this.languages.indexOf(e)<0&&(cc.warn("\u5f53\u524d\u4e0d\u652f\u6301\u8be5\u8bed\u79cd"+e+" \u5c06\u81ea\u52a8\u5207\u6362\u5230 en \u82f1\u6587\u8bed\u79cd\uff01"),e="en"),e!==this._currentLang?this.languagePack.updateLanguage(e,function(n){n&&cc.warn("language res package download failed!",n),cc.log("[i18n] current language is "+e),o._currentLang=e,o.emit(i.CHANGE,e),o._updateComponents(cc.director.getScene()),o.emit(i.CHANGE_COMPLETE,e),t(!0)}):t(!1)},t.prototype._updateComponents=function(e){if(e)for(var t=e.children,o=0;o<t.length;++o)for(var n=0,i=t[o].getComponentsInChildren(c.LanguageComponent);n<i.length;n++){var r=i[n];r.i18n==this&&(r.language=this.currentLanguage)}},t.prototype.parseUuidToUrl=function(e){return this.languagePack.parseUuidToUrl(e)},t.prototype.getLangByID=function(e){return this.languagePack.getLangByID(e)},t.prototype.getNextLang=function(){var e=this.languages;return e[(e.indexOf(this._currentLang)+1)%e.length]},t.prototype.releaseLanguageAssets=function(e){e=e.toLowerCase(),this.languagePack.releaseLanguageAssets(e),this.emit(i.RELEASE_RES,e)},t.instances=new a.HashMap,t}(r.default);o.LanguageManager=u,cc._RF.pop()},{"../event/EventObjectEmitter":"EventObjectEmitter","../util/HashMap":"HashMap","./LanguageComponent":"LanguageComponent","./LanguageI18nEnum":"LanguageI18nEnum","./LanguagePack":"LanguagePack"}],LayerCustomPopUp:[function(e,t,o){"use strict";cc._RF.push(t,"9ad788hPSFLIZNVYpJXoqY+","LayerCustomPopUp");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i=e("./DelegateComponent"),r=function(e){function t(t,o){var n=e.call(this,t,o)||this;return n.modalBackLayer=null,n}return n(t,e),t.prototype.setLayer=function(e){this._layer=e,this._initModalBackLayer()},t.prototype.layout=function(t,o){e.prototype.layout.call(this,t,o),this.modalBackLayer&&(this.modalBackLayer.width=2*cc.winSize.width,this.modalBackLayer.height=2*cc.winSize.height)},t.prototype._initModalBackLayer=function(){this.modalBackLayer=new cc.Node("ModalBackgroundLayer"),this.modalBackLayer.zIndex=0,this._layer.addChild(this.modalBackLayer),this.modalBackLayer.width=2*cc.winSize.width,this.modalBackLayer.height=2*cc.winSize.height,this.modalBackLayer.addComponent(cc.BlockInputEvents),this.modalBackLayer.active=!1,this.modalBackLayer.on(cc.Node.EventType.TOUCH_END,this.clickBgHandler,this)},t.prototype.touchControll=function(e){this.modalBackLayer.active=e},t.prototype.clickBgHandler=function(){for(var e=null,t=this.__nodes(),o=0;o<t.length;o++)e?e&&e.node.zIndex<t[o].node.zIndex&&(e=t[o]):e=t[o];if(e){if(e.node.zIndex<this.modalBackLayer.zIndex)return;var n=e.viewParams.callbacks;(n.touchClose||"boolean"!=typeof n.touchClose)&&this.delete(e.viewParams.UUID)}},t.prototype.refreshModalBG=function(){for(var e=null,t=this.__nodes(),o=0;o<t.length;o++){var n=t[o];e?e&&e.node.zIndex<n.node.zIndex&&(e=n):e=n}if(e){this.modalBackLayer.width=2*cc.winSize.width,this.modalBackLayer.height=2*cc.winSize.height,this.modalBackLayer.active=!0,this.modalBackLayer.zIndex=e.node.zIndex-1;var i=e.viewParams.callbacks;if(i.modal){var r=cc.winSize,a=void 0,c=210;"number"==typeof i.opacity&&(c=i.opacity),this.modalBackLayer.getComponent(cc.Graphics)||((a=this.modalBackLayer.addComponent(cc.Graphics)).clear(),a.rect(-r.width,-r.height,3*r.width,3*r.height),a.fillColor=cc.color(0,0,0,c),a.fill())}else this.modalBackLayer.width=0,this.modalBackLayer.height=0,this.modalBackLayer.removeComponent(cc.Graphics)}else this.modalBackLayer.active=!1},t.prototype.add=function(t,o,n){return void 0===n&&(n=null),e.prototype.add.call(this,t,o,n)},t.prototype._createNode=function(e,t){var o=this,n=t.callbacks,r=t.callbacks.onRemoved;t.callbacks.onRemoved=function(e,t){r&&r(e,t),o.refreshModalBG()};var a=cc.instantiate(e),c=a.addComponent(i.default);if(c.viewParams=t,n.parent&&n.parent instanceof cc.Node){var s=n.parent,l=s.parent.convertToWorldSpaceAR(s.getPosition()),u=this._layer.convertToNodeSpaceAR(l);a.setPosition(u.x,u.y)}this._layer.addChild(a);for(var p=null,d=this.__nodes(),h=0;h<d.length;h++){var f=d[h];p?p&&p.node.zIndex<f.node.zIndex&&(p=f):p=f}var g=2;return p&&(g=p.node.zIndex+2),a.zIndex=g,c.addView(),this.refreshModalBG(),a},t.prototype.clear=function(){this.layer.children&&(this.modalBackLayer.off(cc.Node.EventType.TOUCH_END,this.clickBgHandler,this),e.prototype.clear.call(this),this._initModalBackLayer()),this._asyncQueue.runningParams&&(this._asyncQueue.runningParams.valid=!1),this._asyncQueue.clear()},t}(e("./LayerUI").LayerUI);o.LayerCustomPopUp=r,cc._RF.pop()},{"./DelegateComponent":"DelegateComponent","./LayerUI":"LayerUI"}],LayerDialog:[function(e,t,o){"use strict";cc._RF.push(t,"dcad5w8wHlEDJpIKJ4gUxEP","LayerDialog");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i=function(e){function t(t,o){var n=e.call(this,t,o)||this;return n.stopCom=null,n.stopCom=n.layer.addComponent(cc.BlockInputEvents),n.layer.active=!1,n._asyncQueue.complete=function(){n.layer.active=n.size()>0},n}return n(t,e),t.prototype._handlerTask=function(t,o){var n=this,i=o.callbacks,r=i.onRemoved;i.onRemoved=function(e,o){r&&r(e,o),t()},e.prototype._handlerTask.call(this,function(){n.layer.childrenCount<1&&(cc.warn("\u4e0a\u6b21\u5f39\u7a97\u754c\u9762\u672a\u6210\u529f\u663e\u793a\uff0c\u76f4\u63a5\u8fdb\u5165\u4e0b\u4e00\u6b65"),i.onRemoved&&i.onRemoved(null,o.params))},o)},t.prototype._createNode=function(t,o){return this.layer.active=!0,e.prototype._createNode.call(this,t,o)},t.prototype.add=function(t,o,n){return void 0===n&&(n=null),this.stopCom.enabled=!o.clickStop,e.prototype.add.call(this,t,o,n)},t.prototype.clear=function(){e.prototype.clear.call(this),this.layer.active=!1},t}(e("./LayerUI").LayerUI);o.LayerDialog=i,cc._RF.pop()},{"./LayerUI":"LayerUI"}],LayerFloat:[function(e,t,o){"use strict";cc._RF.push(t,"4231eHcbFlEjqpqhZZ4LfUf","LayerFloat");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i=function(e){function t(t,o){return e.call(this,t,o)||this}return n(t,e),t.prototype._createNode=function(t,o){return e.prototype._createNode.call(this,t,o)},t.prototype.clear=function(){},t}(e("./LayerUI").LayerUI);o.LayerFloat=i,cc._RF.pop()},{"./LayerUI":"LayerUI"}],LayerLoading:[function(e,t,o){"use strict";cc._RF.push(t,"3f952r+wGtItZB9nGQ9GuEF","LayerLoading");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i=function(e){function t(t,o){var n=e.call(this,t,o)||this;return n.layer.addComponent(cc.BlockInputEvents),n.layer.active=!1,n}return n(t,e),t.prototype.add=function(t,o,n){return void 0===n&&(n=null),this.__nodes.length>0?(cc.warn("["+this.name+" \u5df2\u7ecf\u5b58\u5728loading]"),""):this._asyncQueue.isProcessing?(cc.warn("["+this.name+" loading\u754c\u9762\u6b63\u5728\u4e0b\u8f7d\u4e2d]"),""):e.prototype.add.call(this,t,o,n)},t.prototype._handlerTask=function(t,o){var n=this,i=o.callbacks,r=i.onRemoved;i.onRemoved=function(e,t){r&&r(e,t),n.layer.active=n.size()>0},e.prototype._handlerTask.call(this,t,o)},t.prototype._createNode=function(t,o){return this.layer.active=!0,e.prototype._createNode.call(this,t,o)},t}(e("./LayerUI").LayerUI);o.LayerLoading=i,cc._RF.pop()},{"./LayerUI":"LayerUI"}],LayerNotify:[function(e,t,o){"use strict";cc._RF.push(t,"da14ax+B2xNsL2taQFOh7we","LayerNotify");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.show=function(o,n){void 0===n&&(n=!0),e.prototype.add.call(this,t.toastPrefabPath,{content:o,useI18n:n},null)},t.prototype.add=function(e,t,o){return void 0===o&&(o=null),cc.error("[LayerNotify]\uff0c\u4e0d\u5141\u8bb8\u8c03\u7528\uff0c\u8bf7\u4f7f\u7528show\u65b9\u6cd5"),""},t.prototype._createNode=function(t,o){var n=e.prototype._createNode.call(this,t,o),i=n.getComponent("Toast");return n.active=!0,i.showToast(o.params.content,o.params.useI18n,function(){n.destroy()}),n},t.toastPrefabPath="common/persist/prefab/toast",t}(e("./LayerUI").LayerUI);o.LayerNotify=i,cc._RF.pop()},{"./LayerUI":"LayerUI"}],LayerPopup:[function(e,t,o){"use strict";cc._RF.push(t,"25d07BQBCFADaSsh/I3GrTX","LayerPopup");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i=e("./DelegateComponent"),r=function(e){function t(t,o){var n=e.call(this,t,o)||this;return n.modalBackLayer=null,n.openSingle=!1,n._initModalBackLayer(),n}return n(t,e),t.prototype.layout=function(t,o){e.prototype.layout.call(this,t,o),this.modalBackLayer&&(this.modalBackLayer.width=2*cc.winSize.width,this.modalBackLayer.height=2*cc.winSize.height)},t.prototype._initModalBackLayer=function(){this.modalBackLayer=new cc.Node("ModalBackgroundLayer"),this.modalBackLayer.zIndex=0,this.layer.addChild(this.modalBackLayer),this.modalBackLayer.width=2*cc.winSize.width,this.modalBackLayer.height=2*cc.winSize.height,this.modalBackLayer.addComponent(cc.BlockInputEvents),this.modalBackLayer.active=!1,this.modalBackLayer.on(cc.Node.EventType.TOUCH_END,this.clickBgHandler,this)},t.prototype.touchControll=function(e){this.modalBackLayer.active=e},t.prototype.clickBgHandler=function(){for(var e=null,t=this.__nodes(),o=0;o<t.length;o++)e?e&&e.node.zIndex<t[o].node.zIndex&&(e=t[o]):e=t[o];if(e){if(e.node.zIndex<this.modalBackLayer.zIndex)return;var n=e.viewParams.callbacks;(n.touchClose||"boolean"!=typeof n.touchClose)&&this.delete(e.viewParams.UUID)}},t.prototype.refreshModalBG=function(){for(var e=null,t=this.__nodes(),o=0;o<t.length;o++){var n=t[o];e?e&&e.node.zIndex<n.node.zIndex&&(e=n):e=n}if(e){this.modalBackLayer.active=!0,this.modalBackLayer.zIndex=e.node.zIndex-1;var i=e.viewParams.callbacks;if(i.modal){var r=cc.winSize,a=this.modalBackLayer.getComponent(cc.Graphics),c=210;"number"==typeof i.opacity&&(c=i.opacity),a||(a=this.modalBackLayer.addComponent(cc.Graphics)),a.clear(),a.rect(-r.width,-r.height,3*r.width,3*r.height),a.fillColor=cc.color(0,0,0,c),a.fill()}else this.modalBackLayer.removeComponent(cc.Graphics)}else this.modalBackLayer.active=!1},t.prototype.add=function(t,o,n){if(void 0===n&&(n=null),n&&n.isPop&&this.openSingle)cc.log("\u7981\u6b62\u540c\u65f6\u6253\u5f00\u591a\u4e2a");else{if(!(n&&n.isPop&&this.size()>0))return n&&n.isPop&&(this.openSingle=!0),e.prototype.add.call(this,t,o,n);cc.log("\u7981\u6b62\u540c\u65f6\u6253\u5f00\u591a\u4e2a")}},t.prototype._createNode=function(e,t){var o=this,n=t.callbacks,r=t.callbacks.onRemoved;t.callbacks.onRemoved=function(e,t){n&&n.isPop&&(o.openSingle=!1),r&&r(e,t),o.refreshModalBG()};var a=cc.instantiate(e),c=a.addComponent(i.default);if(c.viewParams=t,n.parent&&n.parent instanceof cc.Node){var s=n.parent,l=s.parent.convertToWorldSpaceAR(s.getPosition()),u=this.layer.convertToNodeSpaceAR(l);a.setPosition(u.x,u.y)}var p=t.params.zIndex;this.layer.addChild(a,p||0);for(var d=null,h=this.__nodes(),f=0;f<h.length;f++){var g=h[f];d?d&&d.node.zIndex<g.node.zIndex&&(d=g):d=g}var m=2;return d&&(m=d.node.zIndex+2),a.zIndex=m,c.addView(),this.refreshModalBG(),a},t.prototype.clear=function(){this.modalBackLayer.off(cc.Node.EventType.TOUCH_END,this.clickBgHandler,this),e.prototype.clear.call(this),this._initModalBackLayer()},t}(e("./LayerUI").LayerUI);o.LayerPopUp=r,cc._RF.pop()},{"./DelegateComponent":"DelegateComponent","./LayerUI":"LayerUI"}],LayerUI:[function(e,t,o){"use strict";cc._RF.push(t,"bc8b86Br9dGeKxeLijkyJKE","LayerUI"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../util/AsyncQueue"),i=e("./AssetsLoader"),r=e("./DelegateComponent"),a=function(){function e(e,t){this._asyncQueue=new n.AsyncQueue,this._layer=null,this.name="LayerUI",this._uuidCount=1,this.name=e,this._layer=t,t&&(t.name=e)}return e.getLoader=function(){return e._loader||(e._loader=new i.AssetsLoader(cc.Prefab)),e._loader},Object.defineProperty(e.prototype,"layer",{get:function(){return this._layer},enumerable:!0,configurable:!0}),e.prototype.layout=function(e,t){this._layer&&this._layer.setContentSize(e,t)},e.prototype.enableMask=function(e){this._layer?e?this._layer.addComponent(cc.Mask):this._layer.removeComponent(cc.Mask):cc.error("LayerUI layer is null")},e.prototype.UUID=function(e){return(this.name+"_"+e+"_"+this._uuidCount++).toLowerCase()},e.prototype.add=function(t,o,n){if(void 0===n&&(n=null),this._layer){if(t){var i={UUID:this.UUID(t),prefabPath:t,params:o||{},callbacks:n||{},valid:!0};return e.getLoader().add(t),this._asyncQueue.push(this._handlerTask.bind(this),i),this._asyncQueue.yieldTime(1),this._asyncQueue.play(),i.UUID}}else cc.error("LayerUI layer is null")},e.prototype._handlerTask=function(t,o){var n=this;o.valid?e.getLoader().getRes(o.prefabPath,function(e){e&&o.valid&&n._createNode(e,o),t()}):(o.callbacks=null,o.params=null,t())},e.prototype._createNode=function(e,t){if(!this._layer)return cc.error("LayerUI layer is null"),null;var o=cc.instantiate(e),n=o.addComponent(r.default);return n.viewParams=t,this.layer.addChild(o),n.addView(),o},e.prototype.delete=function(e){for(var t=this.__nodes(),o=0;o<t.length;o++){var n=t[o].viewParams;if(n.UUID===e)return t[o].removeView(),void(n.valid=!1)}var i=this._asyncQueue.runningParams;if(i&&i.UUID===e)i.valid=!1;else{var r=this._asyncQueue.queues;for(o=0;o<r.length;o++)if(r[o].params&&r[o].params.UUID===e)return r[o].params.valid=!1,void r.splice(o,1)}},e.prototype.$delete=function(e){for(var t=this.__nodes(),o=0;o<t.length;o++){var n=t[o].viewParams;n.prefabPath===e&&(t[o].removeView(),n.valid=!1)}var i=this._asyncQueue.runningParams;i&&i.prefabPath===e&&(i.valid=!1);for(var r=this._asyncQueue.queues,a=(o=0,!0),c=r.length;o<c;a?o++:o){var s=r[o];s&&s.params.prefabPath===e?(s.params.valid=!1,r.splice(o,1),a=!1):a=!0}},e.prototype.get=function(e){for(var t=0,o=this.__nodes();t<o.length;t++){var n=o[t];if(n.viewParams&&n.viewParams.UUID===e)return n.node}return null},e.prototype.$get=function(e){for(var t=[],o=0,n=this.__nodes();o<n.length;o++){var i=n[o];i.viewParams.prefabPath===e&&t.push(i.node)}return t},e.prototype.has=function(e){for(var t=0,o=this.__nodes();t<o.length;t++){var n=o[t];if(n.viewParams.UUID===e||n.viewParams.prefabPath===e)return!0}return!1},e.prototype.find=function(e){for(var t=[],o=0,n=this.__nodes();o<n.length;o++){var i=n[o];e.test(i.viewParams.prefabPath)&&t.push(i.node)}return t},e.prototype.__nodes=function(){if(!this._layer)return cc.error("LayerUI layer is null"),[];for(var e=[],t=this.layer.children,o=0;o<t.length;o++){var n=t[o].getComponent(r.default);n&&n.viewParams&&n.viewParams.valid&&cc.isValid(n)&&e.push(n)}return e},e.prototype.size=function(){return this.__nodes().length},e.prototype.clear=function(){this._layer?(this._layer.destroyAllChildren(),this._layer.removeAllChildren(!0),this._asyncQueue.runningParams&&(this._asyncQueue.runningParams.valid=!1),this._asyncQueue.clear(),cc.log("[ "+this.name+" ] clear! childrenCount : "+this._layer.childrenCount)):cc.error("LayerUI layer is null")},e._loader=null,e}();o.LayerUI=a,cc._RF.pop()},{"../util/AsyncQueue":"AsyncQueue","./AssetsLoader":"AssetsLoader","./DelegateComponent":"DelegateComponent"}],LevelUp:[function(e,t,o){"use strict";cc._RF.push(t,"01c5f3kqPhCALKJ1sGKaa1v","LevelUp");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../core/gui/GUI"),a=e("../../core/ui/label/LabelChange"),c=e("../../core/ui/ViewUtils"),s=cc._decorator,l=s.ccclass,u=s.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.btn_ok=null,t.back_spine=null,t}return n(t,e),t.prototype.onLoad=function(){this.btn_ok.on(cc.Node.EventType.TOUCH_END,this.onTouchHandler,this);var e=this.back_spine.getComponent(sp.Skeleton);e.setAnimation(0,"reward_fadein",!1),e.setCompleteListener(function(t){"reward_fadein"===t.animation.name&&e.setAnimation(0,"reward_loop",!0)})},t.prototype.onDestroy=function(){this.back_spine.setCompleteListener(null),this.btn_ok.off(cc.Node.EventType.TOUCH_END,this.onTouchHandler,this)},t.prototype.onAdded=function(e){var t=c.ViewUtils.nodeTreeInfoLite(this.node);t.get("lab_level").getComponent(cc.Label).string=e.level||99,t.get("lab_levelReward").getComponent(a.LabelChange).changeTo(1,e.reward||16e3);t.get("lab_levelReward").getComponent(a.LabelChange).numChange=function(){var e=t.get("lab_levelReward").scale,o=t.get("lab_levelReward").width;o*e>450&&(e=450/o,t.get("lab_levelReward").scale=e),t.get("icon_gold").x=t.get("lab_levelReward").x-o*e/2-5}},t.prototype.onTouchHandler=function(){r.gui.delete(this.node)},i([u(cc.Node)],t.prototype,"btn_ok",void 0),i([u(sp.Skeleton)],t.prototype,"back_spine",void 0),t=i([l],t)}(cc.Component);o.default=p,cc._RF.pop()},{"../../core/gui/GUI":"GUI","../../core/ui/ViewUtils":"ViewUtils","../../core/ui/label/LabelChange":"LabelChange"}],ListItemFrame:[function(e,t,o){"use strict";cc._RF.push(t,"d497eWAzi1DXZoruiaqsKFG","ListItemFrame");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../core/ui/ComponentExtends"),a=cc._decorator,c=a.ccclass,s=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.frameArray=[],t}return n(t,e),t.prototype.onLoad=function(){},t.prototype.setFrame=function(e){this.frameArray[e]?this.node.getComponent(cc.Sprite).spriteFrame=this.frameArray[e]:this.node.getComponent(cc.Sprite).spriteFrame=null},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},i([s(cc.SpriteFrame)],t.prototype,"frameArray",void 0),t=i([c],t)}(r.ComponentExtends);o.default=l,cc._RF.pop()},{"../../core/ui/ComponentExtends":"ComponentExtends"}],ListItem:[function(e,t,o){"use strict";cc._RF.push(t,"e74e0IWJVNFz5UcHABgWLGD","ListItem");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r,a=cc._decorator,c=a.ccclass,s=a.property,l=a.disallowMultiple,u=a.menu,p=a.executionOrder;(function(e){e[e.NONE=0]="NONE",e[e.TOGGLE=1]="TOGGLE",e[e.SWITCH=2]="SWITCH"})(r||(r={}));var d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.icon=null,t.title=null,t.selectedMode=r.NONE,t.selectedFlag=null,t.selectedSpriteFrame=null,t._unselectedSpriteFrame=null,t._selected=!1,t._eventReg=!1,t}return n(t,e),Object.defineProperty(t.prototype,"selected",{get:function(){return this._selected},set:function(e){if(this._selected=e,this.selectedFlag)switch(this.selectedMode){case r.TOGGLE:this.selectedFlag.active=e;break;case r.SWITCH:var t=this.selectedFlag.getComponent(cc.Sprite);t&&(t.spriteFrame=e?this.selectedSpriteFrame:this._unselectedSpriteFrame)}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"btnCom",{get:function(){return this._btnCom||(this._btnCom=this.node.getComponent(cc.Button)),this._btnCom},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){if(this.btnCom||(this.selectedMode,r.NONE),this.selectedMode==r.SWITCH){var e=this.selectedFlag.getComponent(cc.Sprite);this._unselectedSpriteFrame=e.spriteFrame}},t.prototype._registerEvent=function(){if(this._btnCom&&this.list.selectedMode>0&&!this._eventReg){var e=new cc.Component.EventHandler;e.target=this.node,e.component="ListItem",e.handler="onClickThis",this._btnCom.clickEvents.unshift(e),this._eventReg=!0}},t.prototype.showAni=function(e,t,o){var n,i=this;switch(e){case 0:n=[cc.scaleTo(.2,.7),cc.moveBy(.3,0,2*this.node.height)];break;case 1:n=[cc.scaleTo(.2,.7),cc.moveBy(.3,2*this.node.width,0)];break;case 2:n=[cc.scaleTo(.2,.7),cc.moveBy(.3,0,-2*this.node.height)];break;case 3:n=[cc.scaleTo(.2,.7),cc.moveBy(.3,-2*this.node.width,0)];break;default:n=[cc.scaleTo(.3,.1)]}(t||o)&&n.push(cc.callFunc(function(){if(o){i.list._delSingleItem(i.node);for(var e=i.list.displayData.length-1;e>=0;e--)if(i.list.displayData[e].id==i.listId){i.list.displayData.splice(e,1);break}}t()})),this.node.runAction(cc.sequence(n))},t.prototype.onClickThis=function(){this.list.selectedId=this.listId},i([s({type:cc.Sprite,tooltip:!1})],t.prototype,"icon",void 0),i([s({type:cc.Node,tooltip:!1})],t.prototype,"title",void 0),i([s({type:cc.Enum(r),tooltip:!1})],t.prototype,"selectedMode",void 0),i([s({type:cc.Node,tooltip:!1,visible:function(){return this.selectedMode>r.NONE}})],t.prototype,"selectedFlag",void 0),i([s({type:cc.SpriteFrame,tooltip:!1,visible:function(){return this.selectedMode==r.SWITCH}})],t.prototype,"selectedSpriteFrame",void 0),t=i([c,l(),u("\u81ea\u5b9a\u4e49\u7ec4\u4ef6/List Item"),p(-5001)],t)}(cc.Component);o.default=d,cc._RF.pop()},{}],List:[function(e,t,o){"use strict";cc._RF.push(t,"5ea8e2TrJNJwZCxSxUmMcJe","List");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r,a,c,s=cc._decorator,l=s.ccclass,u=s.property,p=s.disallowMultiple,d=s.menu,h=s.executionOrder,f=s.requireComponent,g=e("./ListItem");(function(e){e[e.NODE=1]="NODE",e[e.PREFAB=2]="PREFAB"})(r||(r={})),function(e){e[e.NORMAL=1]="NORMAL",e[e.ADHERING=2]="ADHERING",e[e.PAGE=3]="PAGE"}(a||(a={})),function(e){e[e.NONE=0]="NONE",e[e.SINGLE=1]="SINGLE",e[e.MULT=2]="MULT"}(c||(c={}));var m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.templateType=r.NODE,t.tmpNode=null,t.tmpPrefab=null,t._slideMode=a.NORMAL,t.pageDistance=.3,t.pageChangeEvent=new cc.Component.EventHandler,t._virtual=!0,t.lackCenter=!1,t._updateRate=2,t.frameByFrameRenderNum=0,t.renderEvent=new cc.Component.EventHandler,t.selectedMode=c.NONE,t.repeatEventSingle=!1,t.selectedEvent=null,t._selectedId=-1,t._forceUpdate=!1,t._updateDone=!0,t._numItems=0,t._inited=!1,t._aniDelRuning=!1,t._doneAfterUpdate=!1,t.adhering=!1,t._adheringBarrier=!1,t.curPageNum=0,t}return n(t,e),Object.defineProperty(t.prototype,"slideModel",{get:function(){return this._slideMode},set:function(e){this._slideMode=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"virtual",{get:function(){return this._virtual},set:function(e){null!=e&&(this._virtual=e),0!=this._numItems&&this._onScrolling(null)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updateRate",{get:function(){return this._updateRate},set:function(e){e>=0&&e<=6&&(this._updateRate=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selectedId",{get:function(){return this._selectedId},set:function(e){var t,o=this;switch(o.selectedMode){case c.SINGLE:if(!o.repeatEventSingle&&e==o._selectedId)return;t=o.getItemByListId(e);var n=void 0;if(o._selectedId>=0?o._lastSelectedId=o._selectedId:o._lastSelectedId=null,o._selectedId=e,t&&((n=t.getComponent(g.default)).selected=!0),o._lastSelectedId>=0&&o._lastSelectedId!=o._selectedId){var i=o.getItemByListId(o._lastSelectedId);i&&(i.getComponent(g.default).selected=!1)}o.selectedEvent&&cc.Component.EventHandler.emitEvents([o.selectedEvent],t,e,o._lastSelectedId);break;case c.MULT:if(!(t=o.getItemByListId(e)))return;n=t.getComponent(g.default);o._selectedId>=0&&(o._lastSelectedId=o._selectedId),o._selectedId=e;var r=!n.selected;n.selected=r;var a=o.multSelected.indexOf(e);r&&a<0?o.multSelected.push(e):!r&&a>=0&&o.multSelected.splice(a,1),o.selectedEvent&&cc.Component.EventHandler.emitEvents([o.selectedEvent],t,e,o._lastSelectedId,r)}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"numItems",{get:function(){return this._numItems},set:function(e){var t=this;if(t.checkInited(!1))if(null==e||e<0)cc.error("numItems set the wrong::",e);else if(t._numItems=e,t._forceUpdate=!0,t._virtual)t._resizeContent(),t._onScrolling(null);else{var o=t.content.getComponent(cc.Layout);if(o&&(o.enabled=!0),t._delRedundantItem(),t.firstListId=0,t.frameByFrameRenderNum>0){for(var n=t.frameByFrameRenderNum>t._numItems?t._numItems:t.frameByFrameRenderNum,i=0;i<n;i++)t._createOrUpdateItem2(i);t.frameByFrameRenderNum<t._numItems&&(t._updateCounter=t.frameByFrameRenderNum,t._updateDone=!1)}else{for(i=0;i<e;i++)t._createOrUpdateItem2(i);t.actualNumItems=e}}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scrollView",{get:function(){return this._scrollView},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){this._init()},t.prototype.start=function(){this._init()},t.prototype.onEnable=function(){this._registerEvent(),this._init()},t.prototype.onDisable=function(){this._unregisterEvent()},t.prototype._registerEvent=function(){var e=this;e.node.on(cc.Node.EventType.TOUCH_START,this._onTouchStart,this,!0),e.node.on("touch-up",e._onTouchUp,e),e.node.on(cc.Node.EventType.TOUCH_CANCEL,e._onTouchCancelled,e,!0),e.node.on("scroll-began",e._onScrollBegan,e,!0),e.node.on("scroll-ended",e._onScrollEnded,e,!0),e.node.on("scrolling",e._onScrolling,e,!0)},t.prototype._unregisterEvent=function(){var e=this;e.node.off(cc.Node.EventType.TOUCH_START,this._onTouchStart,this,!0),e.node.off("touch-up",e._onTouchUp,e),e.node.off(cc.Node.EventType.TOUCH_CANCEL,e._onTouchCancelled,e,!0),e.node.off("scroll-began",e._onScrollBegan,e,!0),e.node.off("scroll-ended",e._onScrollEnded,e,!0),e.node.off("scrolling",e._onScrolling,e,!0)},t.prototype._init=function(){var e=this;if(!e._inited)if(e._scrollView=e.node.getComponent(cc.ScrollView),e._scrollView)if(e.content=e._scrollView.content,e.content){switch(e._layout=e.content.getComponent(cc.Layout),e._align=e._layout.type,e._resizeMode=e._layout.resizeMode,e._startAxis=e._layout.startAxis,e._topGap=e._layout.paddingTop,e._rightGap=e._layout.paddingRight,e._bottomGap=e._layout.paddingBottom,e._leftGap=e._layout.paddingLeft,e._columnGap=e._layout.spacingX,e._lineGap=e._layout.spacingY,e._colLineNum,e._verticalDir=e._layout.verticalDirection,e._horizontalDir=e._layout.horizontalDirection,e.setTemplateItem(e.templateType==r.PREFAB?e.tmpPrefab.data:e.tmpNode),e._slideMode!=a.ADHERING&&e._slideMode!=a.PAGE||(e._scrollView.inertia=!1),e.virtual||(e.lackCenter=!1),e._lastDisplayData=[],e.displayData=[],e._pool=new cc.NodePool,e._forceUpdate=!1,e._updateCounter=0,e._updateDone=!0,e._align){case cc.Layout.Type.HORIZONTAL:switch(e._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:e._alignCalcType=1;break;case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:e._alignCalcType=2}break;case cc.Layout.Type.VERTICAL:switch(e._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:e._alignCalcType=3;break;case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:e._alignCalcType=4}break;case cc.Layout.Type.GRID:switch(e._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:switch(e._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:e._alignCalcType=3;break;case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:e._alignCalcType=4}break;case cc.Layout.AxisDirection.VERTICAL:switch(e._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:e._alignCalcType=1;break;case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:e._alignCalcType=2}}}e.content.removeAllChildren(),e._inited=!0}else cc.error(e.node.name+"'s cc.ScrollView unset content!");else cc.error(e.node.name+" no assembly cc.ScrollView!")},t.prototype.setTemplateItem=function(e){if(e){var t=this;t._itemTmp=e,t._resizeMode==cc.Layout.ResizeMode.CHILDREN?t._itemSize=t._layout.cellSize:t._itemSize=cc.size(t._itemTmp.width,t._itemTmp.height);var o=t._itemTmp.getComponent(g.default),n=!1;switch(o||(n=!0),o&&(o._btnCom||t._itemTmp.getComponent(cc.Button)||(n=!0)),n&&(t.selectedMode=c.NONE),t.selectedMode==c.MULT&&(t.multSelected=[]),t._align){case cc.Layout.Type.HORIZONTAL:t._colLineNum=1,t._sizeType=!1;break;case cc.Layout.Type.VERTICAL:t._colLineNum=1,t._sizeType=!0;break;case cc.Layout.Type.GRID:switch(t._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:var i=t.content.width-t._leftGap-t._rightGap;t._colLineNum=Math.floor((i+t._columnGap)/(t._itemSize.width+t._columnGap)),t._sizeType=!0;break;case cc.Layout.AxisDirection.VERTICAL:var r=t.content.height-t._topGap-t._bottomGap;t._colLineNum=Math.floor((r+t._lineGap)/(t._itemSize.height+t._lineGap)),t._sizeType=!1}}}},t.prototype.checkInited=function(e){var t=e||!0;return!!this._inited||(t&&cc.error("List initialization not completed!"),!1)},t.prototype._resizeContent=function(){var e,t=this;switch(t._align){case cc.Layout.Type.HORIZONTAL:if(t.customSize){var o=t._getFixedSize(null);e=t._leftGap+o.val+t._itemSize.width*(t._numItems-o.count)+t._columnGap*(t._numItems-1)+t._rightGap}else e=t._leftGap+t._itemSize.width*t._numItems+t._columnGap*(t._numItems-1)+t._rightGap;break;case cc.Layout.Type.VERTICAL:if(t.customSize){o=t._getFixedSize(null);e=t._topGap+o.val+t._itemSize.height*(t._numItems-o.count)+t._lineGap*(t._numItems-1)+t._bottomGap}else e=t._topGap+t._itemSize.height*t._numItems+t._lineGap*(t._numItems-1)+t._bottomGap;break;case cc.Layout.Type.GRID:switch(t.lackCenter&&(t.lackCenter=!1),t._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:var n=Math.ceil(t._numItems/t._colLineNum);e=t._topGap+t._itemSize.height*n+t._lineGap*(n-1)+t._bottomGap;break;case cc.Layout.AxisDirection.VERTICAL:var i=Math.ceil(t._numItems/t._colLineNum);e=t._leftGap+t._itemSize.width*i+t._columnGap*(i-1)+t._rightGap}}var r,a=t.content.getComponent(cc.Layout);a&&(a.enabled=!1),t._allItemSize=e,t._sizeType?((r=e<t.node.height?t.node.height-.1:e)<0&&(r=0),t._lackSize=t.lackCenter?r:null,t._allItemSizeNoBorder=t._allItemSize-t._topGap-t._bottomGap,t.content.height=r):((r=e<t.node.width?t.node.width-.1:e)<0&&(r=0),t._lackSize=t.lackCenter?r:null,t._allItemSizeNoBorder=t._allItemSize-t._leftGap-t._rightGap,t.content.width=r)},t.prototype._onScrolling=function(e){var t,o,n,i;if(null==this.frameCount&&(this.frameCount=this._updateRate),!this._forceUpdate&&e&&"scroll-ended"!=e.type&&this.frameCount>0)this.frameCount--;else if(this.frameCount=this._updateRate,!this._aniDelRuning&&(this._calcViewPos(),this._sizeType?(t=this.viewTop,n=this.viewBottom):(o=this.viewRight,i=this.viewLeft),this._virtual)){this.displayData=[];var r=void 0,a=0,c=this._numItems-1;if(this.customSize)for(var s=!1;a<=c&&!s;a++)switch(r=this._calcItemPos(a),this._align){case cc.Layout.Type.HORIZONTAL:r.right>=i&&r.left<=o?this.displayData.push(r):0!=a&&this.displayData.length>0&&(s=!0);break;case cc.Layout.Type.VERTICAL:r.bottom<=t&&r.top>=n?this.displayData.push(r):0!=a&&this.displayData.length>0&&(s=!0);break;case cc.Layout.Type.GRID:switch(this._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:r.bottom<=t&&r.top>=n?this.displayData.push(r):0!=a&&this.displayData.length>0&&(s=!0);break;case cc.Layout.AxisDirection.VERTICAL:r.right>=i&&r.left<=o?this.displayData.push(r):0!=a&&this.displayData.length>0&&(s=!0)}}else{var l=this._itemSize.width+this._columnGap,u=this._itemSize.height+this._lineGap;switch(this._alignCalcType){case 1:a=(i+this._leftGap)/l,c=(o+this._rightGap)/l;break;case 2:a=(-o-this._rightGap)/l,c=(-i-this._leftGap)/l;break;case 3:a=(-t-this._topGap)/u,c=(-n-this._bottomGap)/u;break;case 4:a=(n+this._bottomGap)/u,c=(t+this._topGap)/u}for(a=Math.floor(a)*this._colLineNum,c=Math.ceil(c)*this._colLineNum,c--,a<0&&(a=0),c>=this._numItems&&(c=this._numItems-1);a<=c;a++)this.displayData.push(this._calcItemPos(a))}if(this.displayData.length<=0||!this._numItems)return void this._delRedundantItem();this.firstListId=this.displayData[0].id,this.actualNumItems=this.displayData.length;var p=this._lastDisplayData.length;if(this._forceUpdate||this.actualNumItems!=p||this.firstListId!=this._lastDisplayData[0]||this.displayData[this.actualNumItems-1].id!=this._lastDisplayData[p-1])if(this._lastDisplayData=[],this.frameByFrameRenderNum>0)this._numItems>0?(this._updateDone?this._updateCounter=0:this._doneAfterUpdate=!0,this._updateDone=!1):(this._delRedundantItem(),this._updateCounter=0,this._updateDone=!0);else{for(var d=0;d<this.actualNumItems;d++)this._createOrUpdateItem(this.displayData[d]);this._delRedundantItem(),this._forceUpdate=!1}this._calcNearestItem()}},t.prototype._calcViewPos=function(){var e=this.content.getPosition();switch(this._alignCalcType){case 1:this.elasticLeft=e.x>0?e.x:0,this.viewLeft=(e.x<0?-e.x:0)-this.elasticLeft,this.viewRight=this.viewLeft+this.node.width,this.elasticRight=this.viewRight>this.content.width?Math.abs(this.viewRight-this.content.width):0,this.viewRight+=this.elasticRight;break;case 2:this.elasticRight=e.x<0?-e.x:0,this.viewRight=(e.x>0?-e.x:0)+this.elasticRight,this.viewLeft=this.viewRight-this.node.width,this.elasticLeft=this.viewLeft<-this.content.width?Math.abs(this.viewLeft+this.content.width):0,this.viewLeft-=this.elasticLeft;break;case 3:this.elasticTop=e.y<0?Math.abs(e.y):0,this.viewTop=(e.y>0?-e.y:0)+this.elasticTop,this.viewBottom=this.viewTop-this.node.height,this.elasticBottom=this.viewBottom<-this.content.height?Math.abs(this.viewBottom+this.content.height):0,this.viewBottom+=this.elasticBottom;break;case 4:this.elasticBottom=e.y>0?Math.abs(e.y):0,this.viewBottom=(e.y<0?-e.y:0)-this.elasticBottom,this.viewTop=this.viewBottom+this.node.height,this.elasticTop=this.viewTop>this.content.height?Math.abs(this.viewTop-this.content.height):0,this.viewTop-=this.elasticTop}},t.prototype._calcItemPos=function(e){var t,o,n,i,r,a,c,s;switch(this._align){case cc.Layout.Type.HORIZONTAL:switch(this._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:if(this.customSize){var l=this._getFixedSize(e);r=this._leftGap+(this._itemSize.width+this._columnGap)*(e-l.count)+(l.val+this._columnGap*l.count),t=(u=this.customSize[e])>0?u:this._itemSize.width}else r=this._leftGap+(this._itemSize.width+this._columnGap)*e,t=this._itemSize.width;if(a=r+t,this.lackCenter&&this._lackSize>=0)r+=p=this.content.width/2-this._allItemSizeNoBorder/2,a+=p;return{id:e,left:r,right:a,x:r+this._itemTmp.anchorX*t,y:this._itemTmp.y};case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:if(this.customSize){l=this._getFixedSize(e);a=-this._rightGap-(this._itemSize.width+this._columnGap)*(e-l.count)-(l.val+this._columnGap*l.count),t=(u=this.customSize[e])>0?u:this._itemSize.width}else a=-this._rightGap-(this._itemSize.width+this._columnGap)*e,t=this._itemSize.width;if(r=a-t,this.lackCenter&&this._lackSize>=0)r-=p=this.content.width/2-this._allItemSizeNoBorder/2,a-=p;return{id:e,right:a,left:r,x:r+this._itemTmp.anchorX*t,y:this._itemTmp.y}}break;case cc.Layout.Type.VERTICAL:switch(this._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:if(this.customSize){l=this._getFixedSize(e);n=-this._topGap-(this._itemSize.height+this._lineGap)*(e-l.count)-(l.val+this._lineGap*l.count),o=(u=this.customSize[e])>0?u:this._itemSize.height}else n=-this._topGap-(this._itemSize.height+this._lineGap)*e,o=this._itemSize.height;if(i=n-o,this.lackCenter&&this._lackSize>=0)n-=p=this.content.height/2-this._allItemSizeNoBorder/2,i-=p;return{id:e,top:n,bottom:i,x:this._itemTmp.x,y:i+this._itemTmp.anchorY*o};case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:if(this.customSize){var u;l=this._getFixedSize(e);i=this._bottomGap+(this._itemSize.height+this._lineGap)*(e-l.count)+(l.val+this._lineGap*l.count),o=(u=this.customSize[e])>0?u:this._itemSize.height}else i=this._bottomGap+(this._itemSize.height+this._lineGap)*e,o=this._itemSize.height;var p;if(n=i+o,this.lackCenter&&this._lackSize>=0)n+=p=this.content.height/2-this._allItemSizeNoBorder/2,i+=p;return{id:e,top:n,bottom:i,x:this._itemTmp.x,y:i+this._itemTmp.anchorY*o}}case cc.Layout.Type.GRID:var d=Math.floor(e/this._colLineNum);switch(this._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:switch(this._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:s=(i=(n=-this._topGap-(this._itemSize.height+this._lineGap)*d)-this._itemSize.height)+this._itemTmp.anchorY*this._itemSize.height;break;case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:n=(i=this._bottomGap+(this._itemSize.height+this._lineGap)*d)+this._itemSize.height,s=i+this._itemTmp.anchorY*this._itemSize.height}switch(c=this._leftGap+e%this._colLineNum*(this._itemSize.width+this._columnGap),this._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:c+=this._itemTmp.anchorX*this._itemSize.width,c-=this.content.anchorX*this.content.width;break;case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:c+=(1-this._itemTmp.anchorX)*this._itemSize.width,c-=(1-this.content.anchorX)*this.content.width,c*=-1}return{id:e,top:n,bottom:i,x:c,y:s};case cc.Layout.AxisDirection.VERTICAL:switch(this._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:a=(r=this._leftGap+(this._itemSize.width+this._columnGap)*d)+this._itemSize.width,c=r+this._itemTmp.anchorX*this._itemSize.width,c-=this.content.anchorX*this.content.width;break;case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:c=(r=(a=-this._rightGap-(this._itemSize.width+this._columnGap)*d)-this._itemSize.width)+this._itemTmp.anchorX*this._itemSize.width,c+=(1-this.content.anchorX)*this.content.width}switch(s=-this._topGap-e%this._colLineNum*(this._itemSize.height+this._lineGap),this._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:s-=(1-this._itemTmp.anchorY)*this._itemSize.height,s+=(1-this.content.anchorY)*this.content.height;break;case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:s-=this._itemTmp.anchorY*this._itemSize.height,s+=this.content.anchorY*this.content.height,s*=-1}return{id:e,left:r,right:a,x:c,y:s}}}},t.prototype._getFixedSize=function(e){if(!this.customSize)return null;null==e&&(e=this._numItems);var t=0,o=0;for(var n in this.customSize)parseInt(n)<e&&(t+=this.customSize[n],o++);return{val:t,count:o}},t.prototype._onScrollBegan=function(){this._beganPos=this._sizeType?this.viewTop:this.viewLeft},t.prototype._onScrollEnded=function(){var e=this;if(null!=e.scrollToListId){var t=e.getItemByListId(e.scrollToListId);e.scrollToListId=null,t&&t.runAction(cc.sequence(cc.scaleTo(.1,1.06),cc.scaleTo(.1,1)))}e._onScrolling(null),e._slideMode!=a.ADHERING||e.adhering?e._slideMode==a.PAGE&&(null!=e._beganPos?this._pageAdhere():e.adhere()):e.adhere()},t.prototype._onTouchStart=function(e,t){if(!this._scrollView._hasNestedViewGroup(e,t)&&!(e.eventPhase===cc.Event.AT_TARGET&&e.target===this.node)){for(var o=e.target;null==o._listId||!o.parent;)o=o.parent;this._scrollItem=null!=o._listId?o:e.target}},t.prototype._onTouchUp=function(){var e=this;e._scrollPos=null,e._slideMode==a.ADHERING?(this.adhering&&(this._adheringBarrier=!0),e.adhere()):e._slideMode==a.PAGE&&(null!=e._beganPos?this._pageAdhere():e.adhere()),this._scrollItem=null},t.prototype._onTouchCancelled=function(e,t){var o=this;o._scrollView._hasNestedViewGroup(e,t)||e.simulate||(o._scrollPos=null,o._slideMode==a.ADHERING?(o.adhering&&(o._adheringBarrier=!0),o.adhere()):o._slideMode==a.PAGE&&(null!=o._beganPos?o._pageAdhere():o.adhere()),this._scrollItem=null)},t.prototype._pageAdhere=function(){var e=this;if(!(e.elasticTop>0||e.elasticRight>0||e.elasticBottom>0||e.elasticLeft>0)){var t=e._sizeType?e.viewTop:e.viewLeft,o=(e._sizeType?e.node.height:e.node.width)*e.pageDistance;if(Math.abs(e._beganPos-t)>o){switch(e._alignCalcType){case 1:case 4:e._beganPos>t?e.prePage(.5):e.nextPage(.5);break;case 2:case 3:e._beganPos<t?e.prePage(.5):e.nextPage(.5)}}else e.elasticTop<=0&&e.elasticRight<=0&&e.elasticBottom<=0&&e.elasticLeft<=0&&e.adhere();e._beganPos=null}},t.prototype.adhere=function(){var e=this;if(!(e.elasticTop>0||e.elasticRight>0||e.elasticBottom>0||e.elasticLeft>0)){e.adhering=!0,e._calcNearestItem();var t=(e._sizeType?e._topGap:e._leftGap)/(e._sizeType?e.node.height:e.node.width);e.scrollTo(e.nearestListId,.7,t)}},t.prototype.update=function(e){if(!(this.frameByFrameRenderNum<=0||this._updateDone))if(this._virtual){for(var t=this._updateCounter+this.frameByFrameRenderNum>this.actualNumItems?this.actualNumItems:this._updateCounter+this.frameByFrameRenderNum,o=this._updateCounter;o<t;o++){var n=this.displayData[o];n&&this._createOrUpdateItem(n)}this._updateCounter>=this.actualNumItems-1?this._doneAfterUpdate?(this._updateCounter=0,this._updateDone=!1,this._scrollView.isScrolling()||(this._doneAfterUpdate=!1)):(this._updateDone=!0,this._delRedundantItem(),this._forceUpdate=!1,this._calcNearestItem()):this._updateCounter+=this.frameByFrameRenderNum}else if(this._updateCounter<this._numItems){for(t=this._updateCounter+this.frameByFrameRenderNum>this._numItems?this._numItems:this._updateCounter+this.frameByFrameRenderNum,o=this._updateCounter;o<t;o++)this._createOrUpdateItem2(o);this._updateCounter+=this.frameByFrameRenderNum}else this._updateDone=!0,this._calcNearestItem()},t.prototype._createOrUpdateItem=function(e){var t=this.getItemByListId(e.id);if(t)this._forceUpdate&&this.renderEvent&&(t.setPosition(cc.v2(e.x,e.y)),this._resetItemSize(t),this.renderEvent&&cc.Component.EventHandler.emitEvents([this.renderEvent],t,e.id));else{(t=this._pool.size()?this._pool.get():cc.instantiate(this._itemTmp))._listId=e.id,t.setPosition(cc.v2(e.x,e.y)),this._resetItemSize(t),this.content.addChild(t),t.setSiblingIndex(this.content.childrenCount-1);var o=t.getComponent(g.default);t.listItem=o,o&&(o.listId=e.id,o.list=this,o._registerEvent()),this.renderEvent&&cc.Component.EventHandler.emitEvents([this.renderEvent],t,e.id)}this._resetItemSize(t),this._updateListItem(t.listItem),this._lastDisplayData.indexOf(e.id)<0&&this._lastDisplayData.push(e.id)},t.prototype._createOrUpdateItem2=function(e){var t,o=this.content.children[e];o?this._forceUpdate&&this.renderEvent&&(o._listId=e,t&&(t.listId=e),this.renderEvent&&cc.Component.EventHandler.emitEvents([this.renderEvent],o,e)):((o=cc.instantiate(this._itemTmp))._listId=e,this.content.addChild(o),t=o.getComponent(g.default),o.listItem=t,t&&(t.listId=e,t.list=this,t._registerEvent()),this.renderEvent&&cc.Component.EventHandler.emitEvents([this.renderEvent],o,e)),this._updateListItem(t),this._lastDisplayData.indexOf(e)<0&&this._lastDisplayData.push(e)},t.prototype._updateListItem=function(e){if(e&&this.selectedMode>c.NONE)switch(this.selectedMode){case c.SINGLE:e.selected=this.selectedId==e.node._listId;break;case c.MULT:e.selected=this.multSelected.indexOf(e.node._listId)>=0}},t.prototype._resetItemSize=function(e){var t=e.getComponent(g.default);if(this.customSize&&this.customSize[t.node._listId]){var o=this.customSize[t.node._listId];this._align==cc.Layout.Type.HORIZONTAL?e.width=o:this._align==cc.Layout.Type.VERTICAL&&(e.height=o)}else e.setContentSize(this._itemSize)},t.prototype.setMultSelected=function(e,t){var o=this;if(Array.isArray(e)||(e=[e]),null==t)o.multSelected=e;else{var n=void 0,i=void 0;if(t)for(var r=e.length-1;r>=0;r--)n=e[r],(i=o.multSelected.indexOf(n))<0&&o.multSelected.push(n);else for(r=e.length-1;r>=0;r--)n=e[r],(i=o.multSelected.indexOf(n))>=0&&o.multSelected.splice(i,1)}o._forceUpdate=!0,o._onScrolling(null)},t.prototype.updateItem=function(e){Array.isArray(e)||(e=[e]);for(var t=0,o=e.length;t<o;t++){var n=e[t],i=this.getItemByListId(n);i&&cc.Component.EventHandler.emitEvents([this.renderEvent],i,n)}},t.prototype.updateAll=function(){this.numItems=this.numItems},t.prototype.getItemByListId=function(e){for(var t=this.content.childrenCount-1;t>=0;t--)if(this.content.children[t]._listId==e)return this.content.children[t]},t.prototype._getOutsideItem=function(){for(var e,t,o=[],n=this.content.childrenCount-1;n>=0;n--){if(e=this.content.children[n],t=!0)for(var i=this.actualNumItems-1;i>=0;i--)if(this.displayData[i]){var r=this.displayData[i].id;if(e._listId==r){t=!1;break}}t&&o.push(e)}return o},t.prototype._delRedundantItem=function(){if(this._virtual)for(var e=this._getOutsideItem(),t=e.length-1;t>=0;t--){var o=e[t];this._scrollItem&&o._listId==this._scrollItem._listId||this._pool.put(o)}else for(;this.content.childrenCount>this._numItems;)this._delSingleItem(this.content.children[this.content.childrenCount-1])},t.prototype._delSingleItem=function(e){e.removeFromParent(),e.destroy&&e.destroy(),e=null},t.prototype.aniDelItem=function(e,t,o){var n,i=this,r=i.getItemByListId(e);if(!i._aniDelRuning&&i._virtual)if(r){n=r.getComponent(g.default),i._aniDelRuning=!0;var a=i.displayData[i.displayData.length-1].id,s=n.selected;n.showAni(o,function(){var o;if(a<i._numItems-2&&(o=a+1),null!=o){var n=i._calcItemPos(o);i.displayData.push(n),i._virtual?i._createOrUpdateItem(n):i._createOrUpdateItem2(o)}else i._numItems--;if(i.selectedMode==c.SINGLE)s?i._selectedId=-1:i._selectedId-1>=0&&i._selectedId--;else if(i.selectedMode==c.MULT&&i.multSelected.length){var l=i.multSelected.indexOf(e);l>=0&&i.multSelected.splice(l,1);for(var u=i.multSelected.length-1;u>=0;u--){(h=i.multSelected[u])>=e&&i.multSelected[u]--}}if(i.customSize){i.customSize[e]&&delete i.customSize[e];var p={},d=void 0;for(var h in i.customSize){d=i.customSize[h];var f=parseInt(h);p[f-(f>=e?1:0)]=d}i.customSize=p}var g,m;for(u=null!=o?o:a;u>=e+1;u--)if(r=i.getItemByListId(u)){var v=i._calcItemPos(u-1);g=[cc.moveTo(.2333,cc.v2(v.x,v.y))],u<=e+1&&(m=!0,g.push(cc.callFunc(function(){i._aniDelRuning=!1,t(e)}))),g.length>1?r.runAction(cc.sequence(g)):r.runAction(g[0])}m||(i._aniDelRuning=!1,t(e))},!0)}else t(e)},t.prototype.scrollTo=function(e,t,o,n){void 0===t&&(t=.5),void 0===o&&(o=null),void 0===n&&(n=!1);var i=this;if(i.checkInited(!1)){i._scrollView.stopAutoScroll(),null==t?t=.5:t<0&&(t=0),e<0?e=0:e>=i._numItems&&(e=i._numItems-1);var r,a,c=i._virtual?i._calcItemPos(e):i._calcExistItemPos(e);switch(i._alignCalcType){case 1:r=c.left,r-=null!=o?i.node.width*o:i._leftGap,c=cc.v2(r,0);break;case 2:r=c.right-i.node.width,r+=null!=o?i.node.width*o:i._rightGap,c=cc.v2(r+i.content.width,0);break;case 3:a=c.top,a+=null!=o?i.node.height*o:i._topGap,c=cc.v2(0,-a);break;case 4:a=c.bottom+i.node.height,a-=null!=o?i.node.height*o:i._bottomGap,c=cc.v2(0,-a+i.content.height)}var s=i.content.getPosition();s=Math.abs(i._sizeType?s.y:s.x);var l=i._sizeType?c.y:c.x,u=Math.abs((null!=i._scrollPos?i._scrollPos:s)-l)>.5;i._scrollView.stopAutoScroll(),u&&(i._scrollView.scrollToOffset(c,t),i.scheduleOnce(function(){if(i._adheringBarrier||(i.adhering=i._adheringBarrier=!1),n){var t=i.getItemByListId(e);t&&t.runAction(cc.sequence(cc.scaleTo(.1,1.05),cc.scaleTo(.1,1)))}},t+.1),t<=0&&i._onScrolling(null))}},t.prototype._calcNearestItem=function(){var e,t,o,n,i,r;this.nearestListId=null,this._virtual&&this._calcViewPos(),o=this.viewTop,n=this.viewRight,i=this.viewBottom,r=this.viewLeft;for(var a=!1,c=0;c<this.content.childrenCount&&!a;c+=this._colLineNum)switch(e=this._virtual?this.displayData[c]:this._calcExistItemPos(c),t=this._sizeType?(e.top+e.bottom)/2:t=(e.left+e.right)/2,this._alignCalcType){case 1:e.right>=r&&(this.nearestListId=e.id,r>t&&(this.nearestListId+=this._colLineNum),a=!0);break;case 2:e.left<=n&&(this.nearestListId=e.id,n<t&&(this.nearestListId+=this._colLineNum),a=!0);break;case 3:e.bottom<=o&&(this.nearestListId=e.id,o<t&&(this.nearestListId+=this._colLineNum),a=!0);break;case 4:e.top>=i&&(this.nearestListId=e.id,i>t&&(this.nearestListId+=this._colLineNum),a=!0)}if((e=this._virtual?this.displayData[this.actualNumItems-1]:this._calcExistItemPos(this._numItems-1))&&e.id==this._numItems-1)switch(t=this._sizeType?(e.top+e.bottom)/2:t=(e.left+e.right)/2,this._alignCalcType){case 1:n>t&&(this.nearestListId=e.id);break;case 2:r<t&&(this.nearestListId=e.id);break;case 3:i<t&&(this.nearestListId=e.id);break;case 4:o>t&&(this.nearestListId=e.id)}},t.prototype._calcExistItemPos=function(e){var t=this.getItemByListId(e);if(!t)return null;var o={id:e,x:t.x,y:t.y};return this._sizeType?(o.top=t.y+t.height*(1-t.anchorY),o.bottom=t.y-t.height*t.anchorY):(o.left=t.x-t.width*t.anchorX,o.right=t.x+t.width*(1-t.anchorX)),o},t.prototype.prePage=function(e){void 0===e&&(e=.5),this.skipPage(this.curPageNum-1,e)},t.prototype.nextPage=function(e){void 0===e&&(e=.5),this.skipPage(this.curPageNum+1,e)},t.prototype.skipPage=function(e,t){var o=this;if(o._slideMode!=a.PAGE)return cc.error("This function is not allowed to be called, Must SlideMode = PAGE!");e<0||e>=o._numItems||o.curPageNum!=e&&(o.curPageNum=e,o.pageChangeEvent&&cc.Component.EventHandler.emitEvents([o.pageChangeEvent],e),o.scrollTo(e,t))},t.prototype.calcCustomSize=function(e){var t=this;if(!t._itemTmp)return cc.error("Unset template item!");if(!t.renderEvent)return cc.error("Unset Render-Event!");t.customSize={};var o=cc.instantiate(t._itemTmp);t.content.addChild(o);for(var n=0;n<e;n++)cc.Component.EventHandler.emitEvents([t.renderEvent],o,n),o.height==t._itemSize.height&&o.width==t._itemSize.width||(t.customSize[n]=t._sizeType?o.height:o.width);return Object.keys(t.customSize).length||(t.customSize=null),o.removeFromParent(),o.destroy&&o.destroy(),t.customSize},i([u({type:cc.Enum(r),tooltip:!1})],t.prototype,"templateType",void 0),i([u({type:cc.Node,tooltip:!1,visible:function(){return this.templateType==r.NODE}})],t.prototype,"tmpNode",void 0),i([u({type:cc.Prefab,tooltip:!1,visible:function(){return this.templateType==r.PREFAB}})],t.prototype,"tmpPrefab",void 0),i([u()],t.prototype,"_slideMode",void 0),i([u({type:cc.Enum(a),tooltip:!1})],t.prototype,"slideModel",null),i([u({type:cc.Float,range:[0,1,.1],tooltip:!1,slide:!0,visible:function(){return this._slideMode==a.PAGE}})],t.prototype,"pageDistance",void 0),i([u({type:cc.Component.EventHandler,tooltip:!1,visible:function(){return this._slideMode==a.PAGE}})],t.prototype,"pageChangeEvent",void 0),i([u()],t.prototype,"_virtual",void 0),i([u({type:cc.Boolean,tooltip:!1})],t.prototype,"virtual",null),i([u({tooltip:!1,visible:function(){return this.virtual}})],t.prototype,"lackCenter",void 0),i([u({type:cc.Integer})],t.prototype,"_updateRate",void 0),i([u({type:cc.Integer,range:[0,6,1],tooltip:!1,slide:!0})],t.prototype,"updateRate",null),i([u({type:cc.Integer,range:[0,12,1],tooltip:!1,slide:!0})],t.prototype,"frameByFrameRenderNum",void 0),i([u({type:cc.Component.EventHandler,tooltip:!1})],t.prototype,"renderEvent",void 0),i([u({type:cc.Enum(c),tooltip:!1})],t.prototype,"selectedMode",void 0),i([u({tooltip:!1,visible:function(){return this.selectedMode==c.SINGLE}})],t.prototype,"repeatEventSingle",void 0),i([u({type:cc.Component.EventHandler,tooltip:!1,visible:function(){return this.selectedMode>c.NONE}})],t.prototype,"selectedEvent",void 0),i([u({serializable:!1})],t.prototype,"_numItems",void 0),t=i([l,p(),d("\u81ea\u5b9a\u4e49\u7ec4\u4ef6/List"),f(cc.ScrollView),h(-5e3)],t)}(cc.Component);o.default=m,cc._RF.pop()},{"./ListItem":"ListItem"}],LoadingIndicator:[function(e,t,o){"use strict";cc._RF.push(t,"cef8fGghjRB9Yie0NW8CQ4X","LoadingIndicator");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("./ViewUtils"),a=cc._decorator,c=a.ccclass,s=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.sp_indicator=null,t.bg=null,t._rotate=0,t}return n(t,e),t.prototype.onLoad=function(){this.node.opacity=0,this.bg&&r.ViewUtils.fullscreen(this.bg)},t.prototype.update=function(e){var t=this.node.opacity;t<255&&(t+=35,this.node.opacity=Math.min(t,255)),this._rotate-=220*e,this.sp_indicator.angle=this._rotate%360,this._rotate<-360&&(this._rotate+=360)},i([s(cc.Node)],t.prototype,"sp_indicator",void 0),i([s(cc.Node)],t.prototype,"bg",void 0),t=i([c],t)}(cc.Component);o.default=l,cc._RF.pop()},{"./ViewUtils":"ViewUtils"}],LoadingSignQueue:[function(e,t,o){"use strict";cc._RF.push(t,"ee733JbS8VF87+Za+raz2oT","LoadingSignQueue"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../core/gui/GUI"),i=e("../../core/Engine");(function(){function e(){this.loadingRespath="common/persist/prefab/loading",this._loadingTag=0}e.prototype.removeLoading=function(){n.gui.loading.$delete(this.loadingRespath)},e.prototype.showLoading=function(){n.gui.loading.has(this.loadingRespath)||n.gui.loading.add(this.loadingRespath,null)},e.prototype.reduceLoadingTag=function(){this._loadingTag>0&&--this._loadingTag,0==this._loadingTag&&this.removeLoading()},e.prototype.addLoadingTag=function(){++this._loadingTag,this._loadingTag>0&&this.showLoading()},e.prototype.add=function(e){void 0===e&&(e=null),this.addLoadingTag();var t=this.reduceLoadingTag.bind(this);return e&&e(t),t},e.prototype.addWithContinue=function(e){var t=this;e=Math.max(e,0),this.add(function(o){i.default.timer.scheduleOnce(t.reduceLoadingTag.bind(t),e)})},e.prototype.addWithDelay=function(e,t){}})();cc._RF.pop()},{"../../core/Engine":"Engine","../../core/gui/GUI":"GUI"}],LoadingTip:[function(e,t,o){"use strict";cc._RF.push(t,"d09104NSpNBM6S5yTCbkup5","LoadingTip");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../../core/language/LanguageLabel"),a=e("../../../core/ui/ComponentExtends"),c=cc._decorator,s=c.ccclass,l=(c.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.getRandomNum=function(e,t){return Math.round(Math.random()*(t-e)+e)},t}return n(t,e),t.prototype.onLoad=function(){var e=this,t=this.node.getComponent(r.LanguageLabel);t.dataID="tips_"+this.getRandomNum(1,10),this.schedule(function(){t.dataID="tips_"+e.getRandomNum(1,10)},5)},t.prototype.onDestroy=function(){this.unscheduleAllCallbacks(),e.prototype.onDestroy.call(this)},t=i([s],t)}(a.ComponentExtends));o.default=l,cc._RF.pop()},{"../../../core/language/LanguageLabel":"LanguageLabel","../../../core/ui/ComponentExtends":"ComponentExtends"}],LoadingView:[function(e,t,o){"use strict";cc._RF.push(t,"1b944pcDlZIZbtqwxvBUrVA","LoadingView");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../core/Engine"),a=e("../../core/ezplugin/ezplugin"),c=e("../../core/ui/ViewLayout"),s=e("../../core/ui/ViewUtils"),l=e("../../core/util/AsyncQueue"),u=e("../login/LoginView"),p=cc._decorator,d=p.ccclass,h=(p.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.viewObj=null,t.loginState=0,t.isLock=!1,t}return n(t,e),t.prototype.onLoad=function(){this.viewObj=s.ViewUtils.nodeTreeInfoLite(this.node),this.viewObj.get("progressBar").active=!1,this.viewObj.get("btns").active=!1;var e=a.ezplugin.sysInfo.versionCode||a.ezplugin.sysInfo.buildVersion;e||(e=""),this.viewObj.get("lab_version").getComponent(cc.Label).string=r.default.appVersion+"("+e+")",s.ViewUtils.fullscreen(this.viewObj.get("bg")),cc.log("LoadingView onLoad")},t.prototype.onAdded=function(e){cc.log("LoadingView onAdded params",e),this.loadRes()},t.prototype.loadRes=function(){var e=this;this.viewObj.get("lab_loading_tip").getComponent(cc.Label).string="assets loading",this.viewObj.get("progressBar").active=!0,this.viewObj.get("lab_progress").active=!0,this.viewObj.get("lab_patch_progress").active=!1,this.viewObj.get("progressBar").getComponent(cc.ProgressBar).progress=0;var t=new l.AsyncQueue;t.push(function(e){cc.log("\u52a0\u8f7dlangjson"),cc.loader.loadResDir("langjson",function(t){t&&cc.log(JSON.stringify(t)),e()})}),t.push(function(e){cc.log("\u52a0\u8f7dlanguage"),cc.loader.loadResDir("language",function(t){t&&cc.log(JSON.stringify(t)),e()})}),t.push(function(t){cc.log("\u52a0\u8f7dmain"),cc.loader.loadResDir("main",function(t,o,n){var i=t/o;e.viewObj.get("lab_progress").getComponent(cc.Label).string=Math.ceil(100*i)+"%",e.viewObj.get("progressBar").getComponent(cc.ProgressBar).progress=i},function(e){e&&cc.log(JSON.stringify(e)),t()})}),t.complete=function(){e.showLogin()},t.play()},t.prototype.showLogin=function(){this.viewObj.get("progressBar").active=!1,this.node.getComponent(u.default).viewObj=this.viewObj,this.node.getComponent(u.default).showLogin(0==this.loginState)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this),this.viewObj=null,cc.loader.releaseResDir("loading")},t=i([d],t)}(c.ViewLayout));o.default=h,cc._RF.pop()},{"../../core/Engine":"Engine","../../core/ezplugin/ezplugin":"ezplugin","../../core/ui/ViewLayout":"ViewLayout","../../core/ui/ViewUtils":"ViewUtils","../../core/util/AsyncQueue":"AsyncQueue","../login/LoginView":"LoginView"}],LogAnalytics:[function(e,t,o){"use strict";cc._RF.push(t,"1d8feSsg/lGoawooOQtzU7V","LogAnalytics"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../core/ezplugin/ezplugin"),i=e("./Service"),r=function(){function e(){}return e.prototype.setUserProperty=function(){var e=n.ezplugin.get("PluginFirebase");if(e){var t=i.service.account.data;e.excute("setUserProperty",{uid:t.uid.toString(),accountID:t.accountId.toString(),accountPlatform:i.service.account.currentPlatform.toString(),level:t.level.toString()})}},e.prototype.logEvent=function(e,t,o){var i=n.ezplugin.get("PluginFirebase");i&&i.excute("log_event",{event:e||"unknow",key:t||"",value:o.toString()})},e}();o.LogAnalytics=r,cc._RF.pop()},{"../core/ezplugin/ezplugin":"ezplugin","./Service":"Service"}],LoginType:[function(e,t,o){"use strict";cc._RF.push(t,"387c23k/IdBeJdk06+LTD7Y","LoginType"),Object.defineProperty(o,"__esModule",{value:!0}),function(e){e.unlogin="unlogin",e.visitor="visitor",e.google="google",e.facebook="facebook",e.twitter="twitter",e.apple="apple"}(o.LoginType||(o.LoginType={})),cc._RF.pop()},{}],LoginView:[function(e,t,o){"use strict";cc._RF.push(t,"1092bcZPUxDgala7+BxoyvR","LoginView");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../core/Engine"),a=e("../../core/ui/ViewLayout"),c=e("../../Main"),s=e("../../service/account/Account"),l=e("../../service/account/LoginType"),u=e("../../service/account/RequestAccount"),p=e("../../service/Service"),d=cc._decorator,h=d.ccclass,f=(d.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.viewObj=null,t}return n(t,e),t.prototype.showLogin=function(e){void 0===e&&(e=!1),this.viewObj.get("lab_loading_tip").getComponent(cc.Label).string="login successfully",cc.log("\u767b\u5f55\u6210\u529f\uff0c\u8fdb\u5165\u4e3b\u754c\u9762"),r.default.log.info("\u767b\u5f55\u6210\u529f\uff0c\u8fdb\u5165\u4e3b\u754c\u9762"),c.default.module.enterGame()},t.prototype.onDestroy=function(){this.viewObj=null,this.node.off(cc.Node.EventType.TOUCH_END,this.onTouchHandler,this),e.prototype.onDestroy.call(this)},t.prototype.eventHandler=function(e,t){switch(e){case s.AccountEvent.LOGINED:this.viewObj.get("lab_loading_tip").getComponent(cc.Label).string="login successfully",cc.log("\u767b\u5f55\u6210\u529f\uff0c\u8fdb\u5165\u4e3b\u754c\u9762"),r.default.log.info("\u767b\u5f55\u6210\u529f\uff0c\u8fdb\u5165\u4e3b\u754c\u9762"),c.default.module.enterGame()}},t.prototype.doLogin=function(e){var t=this;this.viewObj.get("lab_loading_tip").getComponent(cc.Label).string="logging",this.viewObj.get("loading_indicator").active=!0,u.RequestAccountPool.get(e).sdkLogin(function(o){if(!o)return t.viewObj.get("loading_indicator").active=!1,void(t.viewObj.get("btns").active=!0);p.service.account.login(e)});var o={};o[l.LoginType.visitor]="login_ghost",o[l.LoginType.facebook]="login_fb",o[l.LoginType.google]="login_gp",p.service.analytics.logEvent(o[e]||e,"","")},t.prototype.onTouchHandler=function(e){switch(e.target.name){case"btn_guest":this.doLogin(l.LoginType.visitor);break;case"btn_facebook":this.doLogin(l.LoginType.facebook);break;case"btn_google":this.doLogin(l.LoginType.google);break;case"btn_twitter":this.doLogin(l.LoginType.twitter)}},t=i([h],t)}(a.ViewLayout));o.default=f,cc._RF.pop()},{"../../Main":"Main","../../core/Engine":"Engine","../../core/ui/ViewLayout":"ViewLayout","../../service/Service":"Service","../../service/account/Account":"Account","../../service/account/LoginType":"LoginType","../../service/account/RequestAccount":"RequestAccount"}],Log:[function(e,t,o){"use strict";cc._RF.push(t,"30bec/cURNHI4O+WIeevz2O","Log");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i=e("./ui/ViewUtils"),r=e("./Engine"),a=e("./ezplugin/ezplugin"),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.nodes=null,t.scollView=null,t}return n(t,e),t.prototype.onLoad=function(){this.nodes=i.ViewUtils.nodeTreeInfoLite(this.node),this.scollView=this.nodes.get("scrollview").getComponent(cc.ScrollView),this.nodes.get("btn_console").on(cc.Node.EventType.TOUCH_END,this.onTouchHandler,this),this.nodes.get("btns").on(cc.Node.EventType.TOUCH_END,this.onTouchHandler,this),this.onTouchHandler({target:this.nodes.get("btn_console")}),this.nodes.get("logitem").width=cc.winSize.width-50},t.prototype.onTouchHandler=function(e){switch(e.target.name){case"btn_console":var t=!this.nodes.get("scrollview").active;this.nodes.get("scrollview").active=t,this.nodes.get("consolestate").getComponent(cc.Label).string="log "+(t?"on":"off");break;case"btn_clearCache":this.push("cc.sys.localStorage.clear()"),cc.sys.localStorage.clear();break;case"btn_paste":var o=a.ezplugin.get("PluginOS");if(o){for(var n="",i=0,r=this.scollView.content.getComponentsInChildren(cc.Label);i<r.length;i++){n+="\n"+r[i].string}o.excuteInUIThread("clipboard",n)}}},t.prototype.onDestroy=function(){this.nodes.get("btns").off(cc.Node.EventType.TOUCH_END,this.onTouchHandler,this),this.nodes.get("btn_console").off(cc.Node.EventType.TOUCH_END,this.onTouchHandler,this),this.nodes.clear(),this.nodes=null,this.scollView=null},t.prototype.push=function(e){var t="["+r.default.timer.format("MM-dd hh:mm:ss",new Date)+"] "+e,o=cc.instantiate(this.nodes.get("logitem"));o.parent=this.scollView.content,o.active=!0,o.getComponent(cc.Label).string=t,this.scollView.scrollToBottom()},t}(cc.Component),s=function(){function e(){if(this.logPanel=null,cc.sys.isBrowser){var e=this;cc.director.once(cc.Director.EVENT_BEFORE_SCENE_LAUNCH,function(){cc.loader.loadRes("debug/LogPanel",cc.Prefab,function(t,o){e.initview(o),e=null})})}}return e.prototype.initview=function(e){var t=cc.director.getScene(),o=cc.instantiate(e);t.addChild(o,999),this.logPanel=o.addComponent(c)},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var o=Array.prototype.slice.apply(arguments).join(",");this.logPanel&&this.logPanel.push(o),cc.log(o)},e}();o.Log=s,cc._RF.pop()},{"./Engine":"Engine","./ezplugin/ezplugin":"ezplugin","./ui/ViewUtils":"ViewUtils"}],MVVM:[function(e,t,o){"use strict";cc._RF.push(t,"2f8343sFANDJp6EswsddEnQ","MVVM"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./Observer"),i=e("../util/HashMap"),r=function(){function e(){this.observer=null,this._data={},this._keyHash=new i.HashMap,this._handlerKeys={}}return Object.defineProperty(e.prototype,"data",{get:function(){return this._data},set:function(e){this._data=e,this.observer&&this.observer.release(),this.observer=new n.Observer(e,this._handler.bind(this))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lock",{set:function(e){this.observer&&(this.observer.lock=e)},enumerable:!0,configurable:!0}),e.prototype._handler=function(e,t,o,n){this._handlerKeys[t];var i=o===n,r=this._keyHash.get(t);if(r){this._handlerKeys[t]=!0;for(var a=0;a<r.length;a++){var c=r[a].target,s=r[a].handler;r[a].weekWatch&&i||(c?s.call(c,n,o):s(n,o))}delete this._handlerKeys[t]}},e.prototype.alwaysWatch=function(e,t,o){if(void 0===o&&(o=null),this._data.hasOwnProperty(e)){var n=this._keyHash.get(e);if(n)for(var i=0;i<n.length;i++){var r=n[i].target,a=n[i].handler;if(o===r&&t===a)return void cc.warn("MVVM \u5df2\u7ecf\u6ce8\u518c")}else n=[],this._keyHash.set(e,n);var c={target:o,handler:t,key:e,weekWatch:!1};this._keyHash.get(e).push(c),this._handlerKeys[e]=!0,o?t.call(o,this._data[e],null):t(this._data[e],null),delete this._handlerKeys[e]}},e.prototype.watch=function(e,t,o){if(void 0===o&&(o=null),this._data.hasOwnProperty(e)){var n=this._keyHash.get(e);if(n)for(var i=0;i<n.length;i++){var r=n[i].target,a=n[i].handler;if(o===r&&t===a)return void cc.warn("MVVM \u5df2\u7ecf\u6ce8\u518c")}else n=[],this._keyHash.set(e,n);var c={target:o,handler:t,key:e,weekWatch:!0};this._keyHash.get(e).push(c),this._handlerKeys[e]=!0,o?t.call(o,this._data[e],null):t(this._data[e],null),delete this._handlerKeys[e]}else cc.error("\u9519\u8bef\u8c03\u7528\uff0cViewModel\u6ca1\u6709\u8be5\u5c5e\u6027\uff01",e)},e.prototype.unwatch=function(e,t){void 0===t&&(t=null);var o=this._keyHash.get(e);if(o)for(var n=0;n<o.length;n++){o[n].target===t&&o.splice(n,1)}},e.prototype.unwatchTargetAll=function(e){void 0===e&&(e=null),this._keyHash.forEach(function(t){for(var o=0;o<t.length;o++){t[o].target===e&&t.splice(o,1)}})},e.prototype.release=function(){this._keyHash.clear(),this._keyHash=null,this.observer.release(),this.observer=null,this._data=null},e}();o.MVVM=r,cc._RF.pop()},{"../util/HashMap":"HashMap","./Observer":"Observer"}],MailResultComponent:[function(e,t,o){"use strict";cc._RF.push(t,"a04d7B4vjREEbOmD4nG16k0","MailResultComponent");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../core/Engine"),a=e("../../core/ui/ComponentExtends"),c=cc._decorator,s=c.ccclass,l=(c.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.onAdded=function(e){var t=this,o=this.node.getChildByName("skeleton").getComponent(sp.Skeleton),n="zh"==r.default.i18n.currentLanguage?"cn":"en";this.node.getChildByName("btn_ok").active=!1,o.setCompleteListener(function(e){"reward_fadein"==e.animation.name&&(o.setAnimation(0,"reward_loop",!0),t.node.getChildByName("btn_ok").active=!0,t.node.getChildByName("btn_ok").on(cc.Node.EventType.TOUCH_END,function(){t.node.destroy()}))}),o.setSkin(n),o.setAnimation(0,"reward_fadein",!1),this.node.getChildByName("result").children.forEach(function(e){e.scale=0,e.RunAction(ezaction.scaleTo(5/30,{scale:1.2})).onStoped(function(){e.RunAction(ezaction.scaleTo(10/30,{scale:1})).onStoped(function(){})})})},t=i([s],t)}(a.ComponentExtends));o.default=l,cc._RF.pop()},{"../../core/Engine":"Engine","../../core/ui/ComponentExtends":"ComponentExtends"}],MainCloudAnim:[function(e,t,o){"use strict";cc._RF.push(t,"f492ds+jslOb5L6j7SK0ZO+","MainCloudAnim");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,a=r.ccclass,c=r.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.maxY=0,t.minY=0,t.duration=30,t.getRandom=function(e,t){return Math.random()*(t-e)+e},t.getRandomNum=function(e,t){return Math.round(Math.random()*(t-e)+e)},t}return n(t,e),t.prototype.onLoad=function(){this.action()},t.prototype.action=function(){var e=this,t=this.getRandom(this.minY,this.maxY);this.node.y=t,this.node.x=4255+this.getRandom(50,200),this.node.getComponent(sp.Skeleton)&&this.node.getComponent(sp.Skeleton).setAnimation(0,"reward_"+this.getRandomNum(1,3),!0),this.node.RunAction(ezaction.moveTo(this.getRandom(this.duration,this.duration+10),{x:-300})).onStoped(function(){e.action()})},i([c],t.prototype,"maxY",void 0),i([c],t.prototype,"minY",void 0),i([c],t.prototype,"duration",void 0),t=i([a],t)}(cc.Component);o.default=s,cc._RF.pop()},{}],MainScene:[function(e,t,o){"use strict";cc._RF.push(t,"bfcf0Dkg29HOLlqqR7xQD0R","MainScene");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../core/Engine"),a=e("../../core/event/MessageManager"),c=e("../../core/ui/button/ButtonEffect"),s=e("../../core/ui/button/ButtonSimple"),l=e("../../core/ui/ComponentExtends"),u=e("../../core/ui/ViewUtils"),p=e("../../core/util/AsyncQueue"),d=e("../../core/util/HashMap"),h=e("../../Main"),f=e("../../service/account/Account"),g=e("../../service/config/Config"),m=e("../../service/Service"),v=e("../AudioMessage"),_=e("../MapNpcController"),y=e("./adv/LandmarkComonent"),b=e("./effect/MapControl"),C=e("./GameMainControl"),T=e("./novice/NoviceHandle"),S=e("./StoreComponent"),E=cc._decorator,L=E.ccclass,w=E.property,k=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.main_control=null,t.storesNode=null,t.gameMainControl=null,t.mapNpcController=null,t.mapControl=null,t.nodes=null,t.currentPop="",t.currentMapID="",t.rescache=[],t}var o;return n(t,e),o=t,t.prototype.onLoad=function(){h.default.module.vm.watch("lang",function(e,t){m.service.analytics.logEvent("set_click_language","language",e),null!==t&&(m.service.prompt.netInstableOpen(),r.default.i18n.setLanguage(e,function(o){m.service.prompt.netInstableClose(),o&&t!=e&&"zh"!=t&&r.default.i18n.releaseLanguageAssets(t)}))},this),this.mapNpcController=this.node.getComponent(_.MapNpcController),h.default.module.mapNpcController=this.mapNpcController,a.Message.on(f.AccountEvent.LOGINED,this.messageHandler,this),this.initMainControl(),this.loadStoreList(),a.Message.dispatchEvent(v.AudioMessage.BGM),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchHandler,this),h.default.module.mainScene=this,this.mapControl=this.node.getChildByName("content").getComponent(b.MapControl),r.default.log.info("mainScene\u7684onload")},t.prototype.onTouchHandler=function(e){e.target.getComponent(c.default)||e.target.getComponent(s.default)||this.gameMainControl.storeOperation&&(this.gameMainControl.storeOperation.currentViewStoreId=-1)},t.prototype.initMainControl=function(){var e=cc.instantiate(this.main_control);this.gameMainControl=e.getComponent(C.default),e.getChildByName("click_mask").active=!0,e.getChildByName("main").getComponent(cc.Widget).target=this.node,e.getChildByName("main").getComponent(cc.Widget).top=0,e.getChildByName("main").getComponent(cc.Widget).bottom=0,this.scheduleOnce(function(){e.getChildByName("main").getComponent(cc.Widget).updateAlignment()}),h.default.module.gameMainControl=this.gameMainControl;var t=u.ViewUtils.nodeTreeInfoLite(this.node);this.gameMainControl.landMarkCom=t.get("adv_colid").getComponent(y.default),e.parent=this.node,this.nodes=t},t.prototype.parseStoreJson=function(){var e=new d.HashMap,t=cc.loader.getRes("main/json/storepos",cc.JsonAsset).json;for(var o in t){var n=t[o],i=n.pos.split(","),r=n.gatepos.split(","),a={x:parseInt(i[0].replace(/[^\d]/,"")),y:parseInt(i[1].replace(/[^\d]/,"")),gateposX:parseInt(r[0].replace(/[^\d]/,"")),gateposY:parseInt(r[1].replace(/[^\d]/,""))};e.set(o,a)}return e},t.prototype.playCloudAnim=function(e,t){var o=this.gameMainControl.mainNodes.get("cloud").getComponent(sp.Skeleton);o.node.active=!0,e?o.setAnimation(0,"reward_loop",!0):(t&&t(),o.setCompleteListener(function(e){"reward_die"==e.animation.name&&(o.node.active=!1)}),o.setAnimation(0,"reward_die",!1))},t.prototype.refreshStores=function(e){var t=h.default.module,o=this.parseStoreJson(),n=h.default.module.themeConfig.getBuildingConfigById(e).count;for(var i in t.vm.storeList){var r=t.vm.storeList[i],a=t.vm.storeList[i].id,c=cc.loader.getRes("main/store");if(this.storesNode.getChildByName(i))a<=n&&(this.storesNode.getChildByName(i).active=!0);else{var s=cc.instantiate(c),l=o.get(a+"");s.name=i,s.parent=this.storesNode,s.position=cc.v3(l.x,l.y),s.zIndex=9999-s.y,s.getComponent(S.default).loadStore(i,r,!0),a>n&&(s.active=!1)}}},t.prototype.loadStoreList=function(){var e=this;r.default.log.info("loadStoreList");var t=h.default.module,o=this.gameMainControl.mainNodes.get("logo");o.active=!0,this.playCloudAnim(!0);var n=function(){r.default.log.info("\u6267\u884cnoviceCallback"),e.exchangeScene(t.vm.level,function(){r.default.log.info("\u52a0\u8f7d\u573a\u666f\u5b8c\u6210\u521d\u59cb\u5316initUserView"),e.gameMainControl.initUserView(),e.reloadStoresReward(function(){e.gameMainControl.node.getChildByName("click_mask").active=!1})})},i=p.AsyncQueue.excuteTimes(4,function(){e.refreshStores(t.vm.level),r.default.log.info("11\u6761\u534f\u8bae\u8bf7\u6c42\u6570\u636e\u5b8c\u6210"),0==t.vm.noviceProgress.novice_start?t.noviceHandle.handleStart(n):n&&n(),o.RunAction(ezaction.fadeTo(.2,0)).onStoped(function(){o.destroy()})});t.gameProtocol.requestStoreList(function(e){t.vm.storeList=e.storeList,i()}),t.gameProtocol.requestClerkList(function(e){t.vm.clerkList=e.clerkList,i()}),t.gameProtocol.requestFameList(function(e){t.vm.fameList=e.fameList,t.gameMainControl.preFameList=e.fameList,i()}),t.vm.goodsInfo={multiTotal:1,multiTotalE:0},h.default.module.vm.propList=null;var a=cc.sys.localStorage.getItem("novice");a?t.vm.noviceProgress=JSON.parse(a):(t.vm.noviceProgress=new T.NoviceProgress,cc.sys.localStorage.setItem("novice",JSON.stringify(t.vm.noviceProgress)));var c=cc.sys.localStorage.getItem("mainProgress");c?t.vm.mainProgress=JSON.parse(c):(t.vm.mainProgress=new T.MainProgress,cc.sys.localStorage.setItem("mainProgress",JSON.stringify(t.vm.mainProgress)));var s=cc.sys.localStorage.getItem("sellNum");s?t.vm.sellNum=s:(t.vm.sellNum=0,cc.sys.localStorage.setItem("sellNum",t.vm.sellNum));var l=cc.sys.localStorage.getItem("getFameTime");l?t.gamedata.getFameTime=JSON.parse(l):(t.gamedata.getFameTime=h.default.module.calcUiShow.getSeverCurrentTime()+108e5,cc.sys.localStorage.setItem("getFameTime",t.gamedata.getFameTime));var u=cc.sys.localStorage.getItem("fameNpcNum");u?t.gamedata.fameNpcNum=JSON.parse(u):(t.gamedata.fameNpcNum=0,cc.sys.localStorage.setItem("fameNpcNum",t.gamedata.fameNpcNum));var d=cc.sys.localStorage.getItem("isPass");d?t.vm.isPass=d:(t.vm.isPass=0,cc.sys.localStorage.setItem("isPass",t.vm.isPass)),i()},t.prototype.reloadStoresReward=function(e){var t=h.default.module,o={num:0,numE:0},n=h.default.module.calcUiShow.getSeverCurrentTime(),i=this.storesNode.getChildByName("store_1").getComponent(S.default),r=0;for(var a in i.currentClerkLv>0&&(r=n-t.vm.storeList.store_1.rewardTime),t.vm.storeList){var c=t.vm.storeList[a].rewardTime,s=n-c;s>6048e5&&(s=6048e5);var l=this.storesNode.getChildByName(a).getComponent(S.default);if(l.currentClerkLv>0){var u=l.currentTimeSpanTotal,p=Math.floor(s/u);u<100&&0!=u&&(p=Math.floor(s/u/1e3));var d=t.calcTool.calcMutiNum(l.returnReward,{num:p,numE:0});o=t.calcTool.calcAddNum(o,d),l.preReturnRewardTime=c+p*u}else l.preReturnRewardTime=c}o.num>0?r<6e4?h.default.module.calcUiShow.refreshCredit(o,function(){e&&e()},!0):t.loadOffLineReward(o,r,e):e&&e()},t.prototype.messageHandler=function(e,t){var o=this;switch(e){case f.AccountEvent.LOGINED:h.default.module.entry(function(){cc.log("\u91cd\u65b0entry\u6210\u529f"),o.reloadStoresReward()})}},t.prototype.showStoresName=function(e,t){void 0===e&&(e=!0),this.node.getComponent(o).storesNode.children.forEach(function(o){var n=o.getComponent(S.default);n&&n.showStoreInfo(e,t)})},t.prototype.exchangeScene=function(e,t){var o=this;this.playCloudAnim(!0);var n=9==(e=e>9?9:e)||6==e,i=this.nodes,a=new p.AsyncQueue;a.push(function(t){var n="main_bg"+e;if(o.currentMapID&&n!=o.currentMapID){var r=i.get("scene_bg").getComponent(cc.Sprite);cc.loader.release(r.spriteFrame.getTexture()),r.spriteFrame=null}for(var a=0,c=o.rescache;a<c.length;a++){var s=c[a];cc.log("\u91ca\u653e\u8d44\u6e90",s.url);try{cc.loader.release(s.getTexture()),cc.loader.release(s)}catch(e){cc.warn(e)}}o.rescache=[],o.currentMapID=n,cc.loader.loadRes("scene/bg_texture/"+o.currentMapID,cc.SpriteFrame,function(e,n){e?t(null):(o.rescache.push(n),t(n))})}),a.push(function(t,n,a){if(a)i.get("scene_bg").getComponent(cc.Sprite).spriteFrame=a,t();else{var c=g.default.game.data.qiniucdn;c||t();var s=function(e){var n=i.get("scene_bg").getComponent(cc.Sprite);cc.loader.load(e,function(e,i){if(i){var r=new cc.SpriteFrame(i);o.rescache.push(r),n.spriteFrame=r}t()})},l=c+"/map/main_bg"+e+".jpg";if(cc.log("\u56fe\u7247url "+l),cc.sys.isBrowser)s(l);else{var u=h.default.appRes.appresUrlHelper.local_games_assets_patch_path+"/main_bg"+e+".jpg";if(jsb.fileUtils.isFileExist(u))return void s(u);cc.log("engine.downloader \u4e0b\u8f7d "+l),r.default.downloader.download(l,u,3,1,function(e){s(u)})}}}),a.push(function(t){switch(e){case 4:case 5:case 6:e=4;break;case 7:case 8:case 9:case 10:e=7}cc.loader.loadRes("scene/scene_bottom_"+e,function(e,o){i.get("scene_bottom").children.forEach(function(e){e.destroy()});var r=cc.instantiate(o);r.parent=i.get("scene_bottom"),r.getChildByName("xue")&&(r.getChildByName("xue").active=n),t()})}),a.complete=function(){r.default.log.info("\u573a\u666f\u52a0\u8f7d\u5b8c\u6210\uff0c\u4e91\u6563\u5f00\uff0c\u6267\u884c\u521d\u59cb\u5316Callback"),o.playCloudAnim(!1,t),a.clear()},a.play()},t.prototype.update=function(){this.node.getChildByName("content").position},t.prototype.onDestroy=function(){for(var t=0,o=this.rescache;t<o.length;t++){var n=o[t];cc.log("\u91ca\u653e\u8d44\u6e90",n.url);try{cc.loader.release(n.getTexture()),cc.loader.release(n)}catch(e){cc.warn(e)}}this.rescache=null,this.nodes.clear(),e.prototype.onDestroy.call(this),h.default.module.vm.unwatchTargetAll(this),this.gameMainControl=null,this.mapNpcController=null,a.Message.removeEventTarget(this),this.currentPop=null},i([w({type:cc.Prefab,tooltip:"\u4e3b\u63a7\u5236"})],t.prototype,"main_control",void 0),i([w({type:cc.Node,tooltip:"\u6240\u6709\u5546\u5e97\u7684\u7236\u8282\u70b9"})],t.prototype,"storesNode",void 0),t=o=i([L],t)}(l.ComponentExtends);o.default=k,cc._RF.pop()},{"../../Main":"Main","../../core/Engine":"Engine","../../core/event/MessageManager":"MessageManager","../../core/ui/ComponentExtends":"ComponentExtends","../../core/ui/ViewUtils":"ViewUtils","../../core/ui/button/ButtonEffect":"ButtonEffect","../../core/ui/button/ButtonSimple":"ButtonSimple","../../core/util/AsyncQueue":"AsyncQueue","../../core/util/HashMap":"HashMap","../../service/Service":"Service","../../service/account/Account":"Account","../../service/config/Config":"Config","../AudioMessage":"AudioMessage","../MapNpcController":"MapNpcController","./GameMainControl":"GameMainControl","./StoreComponent":"StoreComponent","./adv/LandmarkComonent":"LandmarkComonent","./effect/MapControl":"MapControl","./novice/NoviceHandle":"NoviceHandle"}],MainTaskTip:[function(e,t,o){"use strict";cc._RF.push(t,"dacaaPe7qhHia8BI0F9/0uP","MainTaskTip");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../../core/event/MessageManager"),a=(e("../../../core/gui/GUI"),e("../../../core/language/LanguageLabel")),c=e("../../../core/ui/button/ButtonEffect"),s=e("../../../core/ui/ComponentExtends"),l=e("../../../core/ui/ViewUtils"),u=e("../../../Main"),p=(e("../../../service/Service"),e("../effect/MapControl")),d=e("../npc/NpcClickComponent"),h=(e("../StoreComponent"),cc._decorator),f=h.ccclass,g=(h.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.canClickNpc=!1,t.currentMainProgress=null,t.currentMianId=0,t.novice_3=-1,t.preMianId=-1,t.progressVal=-1,t.progressId=-1,t.isLockPop=!1,t.isProgress=!1,t.currentNpcId=null,t.isLock=!1,t}return n(t,e),t.prototype.onLoad=function(){var e=this;this.node.active=!1,this.node.getComponent(c.default).canTouch=!1,this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd.bind(this),this),r.Message.on(d.NPC_EVENT.ADD_CAN_CLICK,function(t,o){e.canClickNpc=!0},this),r.Message.on(d.NPC_EVENT.REMOVE_CAN_CLICK,function(t,o){e.canClickNpc=!1,e.currentNpcId=null},this)},t.prototype.changeMainCacheData=function(e){var t=this.currentMianId,o=u.default.module.vm.mainProgress,n={};for(var i in o)i=="progress_"+t&&0==o["progress_"+t]?n["progress_"+t]=1:n[i]=o[i];this.currentMainProgress=n,u.default.module.gameProtocol.writeCacheData("mainProgress",n,function(o){cc.log("progress_"+t+"\u4e3b\u7ebf\u4efb\u52a1\u7f13\u5b58\u5199\u5165\u6210\u529f"),e&&e(o)})},t.prototype.entryNoviceNoFinish=function(){var e=u.default.module.vm,t=u.default.module.vm.mainProgress,o=e.noviceProgress,n=u.default.module.gameMainControl.mainNodes;1==t.progress_1&&0==o.novice_4&&0==e.clerkList.clerk_1.level?u.default.module.noviceHandle.noviceShopClerk(n.get("btn_shop")):1==t.progress_2&&0==o.novice_5?u.default.module.noviceHandle.noviceCallengeTask(n.get("btn_task")):1==t.progress_3&&0==o.novice_11?u.default.module.noviceHandle.noviceBatchUp():1==t.progress_4&&0==o.novice_6?u.default.module.noviceHandle.noviceShopping(n.get("btn_shopping")):1==t.progress_6&&0==o.novice_7?u.default.module.noviceHandle.noviceSellStores(n.get("btn_world")):1==t.progress_7&&0==o.novice_9?u.default.module.noviceHandle.novicePackage(n.get("btn_package")):0==o.novice_13&&1==o.novice_9?u.default.module.noviceHandle.novicePublicFame():1==o.novice_13&&1==o.novice_9&&0==o.novice_10&&u.default.module.noviceHandle.noviceFameUp(n.get("btn_shop"))},t.prototype.refreshMainProgressInfo=function(){},t.prototype.setInfo=function(e,t){var o=l.ViewUtils.nodeTreeInfoLite(this.node),n=o.get("task_off").getComponent(sp.Skeleton),i=o.get("task_on").getComponent(sp.Skeleton),r=o.get("check").getComponent(sp.Skeleton),s=(e=e>t?t:e)/t;if(this.progressVal!=s||this.progressId!=this.currentMianId){this.setProgress(e,t),s>=1?(this.node.getComponent(c.default).canTouch=!0,r.node.active=!0,this.progressVal<1?(i.setCompleteListener(function(e){"reward"==e.animation.name&&(i.setAnimation(0,"reward_idle_2",!0),o.get("tip_lab").getComponent(a.LanguageLabel).dataID="ui_ad_6")}),r.setCompleteListener(function(e){"reward_fadein"==e.animation.name&&r.setAnimation(0,"reward_loop",!0)}),o.get("panel1").active=!1,o.get("panel2").active=!0,o.get("tip_lab").active=!1,i.setAnimation(0,"reward",!1),r.setAnimation(0,"reward_fadein",!1),o.get("task_skeleton").getComponent(sp.Skeleton).setAnimation(0,"reward",!1)):(o.get("panel1").active=!1,o.get("panel2").active=!0,i.setAnimation(0,"reward_idle_2",!0),o.get("tip_lab").active=!1,o.get("tip_lab").getComponent(a.LanguageLabel).dataID="ui_ad_6")):(o.get("panel1").active=!0,this.node.getComponent(c.default).canTouch=!1,o.get("tip_lab").active=!0,o.get("tip_lab").getComponent(a.LanguageLabel).dataID="thread_"+this.currentMianId,n.setAnimation(0,"reward_idle_1",!0),o.get("panel2").active=!1,r.node.active=!1);var u=cc.loader.getRes("main/no_pack/texture/main_task/main"+this.currentMianId,cc.SpriteFrame);o.get("main_spr1").getComponent(cc.Sprite).spriteFrame=u,o.get("main_spr2").getComponent(cc.Sprite).spriteFrame=u,this.progressVal=s,this.progressId=this.currentMianId}},t.prototype.onTouchEnd=function(){},t.prototype.syncMainProgress=function(e){var t=this;void 0===e&&(e=1),this.scheduleOnce(function(){u.default.module.vm.mainProgress=t.currentMainProgress},e)},t.prototype.setStorePosByMap=function(e){var t=u.default.module.mainScene.node.getChildByName("content").getComponent(p.MapControl),o=u.default.module.mainScene.storesNode.getChildByName("store_"+e),n=o.parent.convertToWorldSpaceAR(o.getPosition()),i=n.x-cc.winSize.width/2,r=n.y-cc.winSize.height/2,a=t.node.x-i,c=t.node.y-r,s=cc.winSize.width,l=cc.winSize.height;a>t.node.width/2*t.node.scaleX-s/2?a=t.node.width/2*t.node.scaleX-s/2:a<-t.node.width/2*t.node.scaleX+s/2?a=-t.node.width/2*t.node.scaleX+s/2:c>t.node.height/2*t.node.scaleY-l/2?c=t.node.height/2*t.node.scaleY-l/2:c<-t.node.height/2*t.node.scaleY+l/2&&(c=-t.node.height/2*t.node.scaleY+l/2),t.node.RunAction(ezaction.moveTo(.2,{x:a,y:c}))},t.prototype.setNpcByMap=function(e){if(e){var t=u.default.module.mainScene.node.getChildByName("content").getComponent(p.MapControl),o=u.default.module.mainScene.storesNode.getChildByName("npc_"+e);t.followTargetPos(o,.2),this.currentNpcId=e}},t.prototype.update=function(){},t.prototype.setProgress=function(e,t){var o=e/t,n=l.ViewUtils.nodeTreeInfoLite(this.node);n.get("tip_progress_bar").width=96*(o>1?1:o),n.get("tip_progress_lab").getComponent(cc.Label).string=e+"/"+t},t.prototype.lockMainTaskTip=function(e){void 0===e&&(e=!1),this.isLock=e,this.showButtonEffect(this.node,e)},t.prototype.checkLockClerkNum=function(){var e=u.default.module.vm.clerkList,t=0;for(var o in e)e[o].level>0&&(t+=e[o].level);return t},t.prototype.showButtonEffect=function(e,t){var o=t?cc.Color.GRAY:cc.Color.WHITE;e.color=o;var n=function(e){if(0!=e.children.length)for(var i=0,r=e.children;i<r.length;i++){var a=r[i];"tip_lab"==a.name&&(o=new cc.Color(0,0,0)),"handler"!=a.name?"bg"!=a.name?(a.color=o,n(a)):a.opacity=t?75:150:a.opacity=t?0:255}};n(e)},t.prototype.onDestroy=function(){r.Message.removeEventTarget(this),this.currentMianId=null,this.novice_3=null,this.isLock=null,this.canClickNpc=null,e.prototype.onDestroy.call(this)},t=i([f],t)}(s.ComponentExtends));o.default=g,cc._RF.pop()},{"../../../Main":"Main","../../../core/event/MessageManager":"MessageManager","../../../core/gui/GUI":"GUI","../../../core/language/LanguageLabel":"LanguageLabel","../../../core/ui/ComponentExtends":"ComponentExtends","../../../core/ui/ViewUtils":"ViewUtils","../../../core/ui/button/ButtonEffect":"ButtonEffect","../../../service/Service":"Service","../StoreComponent":"StoreComponent","../effect/MapControl":"MapControl","../npc/NpcClickComponent":"NpcClickComponent"}],Main:[function(e,t,o){"use strict";cc._RF.push(t,"75c62WyRNhOY6DHzgdUcf0V","Main");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("./core/Engine"),a=e("./core/ezplugin/ezplugin"),c=e("./core/gui/GUI"),s=e("./core/util/AsyncQueue"),l=e("./hall/ModuleManager"),u=e("./service/config/Config"),p=e("./service/Service"),d=e("./version/AppResManager"),h=e("./version/AppResUrl"),f=cc._decorator.ccclass,g=function(t){function o(){return null!==t&&t.apply(this,arguments)||this}var g;return n(o,t),g=o,o.prototype.gameFitHandler=function(){r.default.orientation=cc.macro.ORIENTATION_PORTRAIT;var e=r.default.canvas.getComponent(cc.Canvas),t=cc.winSize.width/cc.winSize.height;r.default.fit?t>9/16?(e.fitHeight=!0,e.fitWidth=!1):(e.fitHeight=!1,e.fitWidth=!0):t<16/9?(e.fitHeight=!1,e.fitWidth=!0):(e.fitHeight=!0,e.fitWidth=!1),r.default.designWidth=cc.winSize.width,r.default.designHeight=cc.winSize.height},o.prototype.onLoad=function(){"undefined"!=typeof document&&document.getElementById("splash")&&(document.getElementById("splash").style.display="block"),t.prototype.onLoad.call(this)},o.prototype.run=function(){cc.log("cc.sys.SafeAreaRect = ",cc.sys.getSafeAreaRect().toString());var t=new s.AsyncQueue;t.push(function(t){var o=e("sdkconfig");if(cc.sys.isNative)switch(cc.sys.os){case cc.sys.OS_ANDROID:return void a.ezplugin.initPlugins(o("android"),t);case cc.sys.OS_IOS:return void a.ezplugin.initPlugins(o("ios"),t)}cc.sys.isBrowser,t()}),t.push(function(e){p.service.init(e)}),t.push(function(e){var t=a.ezplugin.sysInfo.appVersion||a.ezplugin.sysInfo.version;t||(t=u.default.game.data.version),cc.log("\u5f53\u524dApp\u7248\u672c\u53f7",t),r.default.appVersion=t;var o=new h.AppResUrl(r.default.appVersion);g.appRes=new d.AppResManager(o),e()}),t.pushMulti({},function(e){var t=cc.sys.localStorage.getItem("language")||cc.sys.language;t.indexOf("zh")>=0&&(t="zh"),r.default.i18n.setLanguage(t,e)},function(e){cc.loader.loadResDir("common",e)}),t.complete=function(){g.module=new l.ModuleManager,r.default.log.info("\u52a0\u8f7dloading\u9884\u5236\u4ef6"),c.gui.ui.add("loading/loading",{state:0}),t.complete=null},t.play()},o.module=null,o.appRes=null,o=g=i([f],o)}(r.default);o.default=g,cc._RF.pop()},{"./core/Engine":"Engine","./core/ezplugin/ezplugin":"ezplugin","./core/gui/GUI":"GUI","./core/util/AsyncQueue":"AsyncQueue","./hall/ModuleManager":"ModuleManager","./service/Service":"Service","./service/config/Config":"Config","./version/AppResManager":"AppResManager","./version/AppResUrl":"AppResUrl",sdkconfig:"sdkconfig"}],MapCityPopUP:[function(e,t,o){"use strict";cc._RF.push(t,"ff31flfH0FFBq88yvYxmmLt","MapCityPopUP");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../core/Engine"),a=e("../../core/language/LanguageLabel"),c=e("../../core/ui/ComponentExtends"),s=e("../../core/ui/ViewUtils"),l=e("../../Main"),u=cc._decorator,p=u.ccclass,d=(u.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.currentId=1,t}return n(t,e),t.prototype.onLoad=function(){this.node.getChildByName("main").hasEventListener(cc.Node.EventType.TOUCH_END)||this.node.getChildByName("main").on(cc.Node.EventType.TOUCH_END,this.onBtnHandler,this)},t.prototype.onBtnHandler=function(e){switch(e.target.name){case"btn_close":this.node.destroy()}},t.prototype.onAdded=function(e){if(e){var t=l.default.module.vm.level,o=s.ViewUtils.nodeTreeInfoLite(this.node);o.get("main").width=1==e.cityId?250:400,o.get("btn_close").setPosition(1==e.cityId?cc.v2(100,20):cc.v2(170,15)),o.get("reach").active=e.cityId<t,o.get("country").getComponent(a.LanguageLabel).dataID="ui_map_"+e.cityId;var n=l.default.module.themeConfig.getBuildingConfigById(e.cityId),i=l.default.module.calcTool.formatNum({num:n.target,numE:n.targetE});o.get("condition").active=e.cityId>=t&&1!=e.cityId,o.get("condition").getComponent(a.LanguageLabel).setVars("ui_mission_2",""+i.base+i.gear);var c=r.default.i18n.getLangByID("ui_store_"+(e.cityId+3));switch(e.cityId){case 2:c=r.default.i18n.getLangByID("ui_store_5");break;case 3:c=r.default.i18n.getLangByID("ui_store_6")+","+r.default.i18n.getLangByID("ui_store_7");break;case 4:c=r.default.i18n.getLangByID("ui_store_8")+","+r.default.i18n.getLangByID("ui_store_9");break;case 5:c=""+r.default.i18n.getLangByID("ui_store_10")}o.get("unlock").active=1!=e.cityId&&e.cityId<6,o.get("unlock").getComponent(a.LanguageLabel).setVars("ui_personal_19",c),o.get("multi").active=1!=e.cityId,o.get("multi").getComponent(a.LanguageLabel).setVars("ui_mission_4","X"+n.multi),o.get("multi").color=e.cityId<=t?new cc.Color(40,170,70):new cc.Color(140,73,40),o.get("unlock").color=e.cityId<=t?new cc.Color(40,170,70):new cc.Color(140,73,40);var u=e.worldPos,p=this.node.parent.convertToNodeSpaceAR(u);o.get("main").x=p.x,o.get("main").y=p.y,o.get("main").RunAction(ezaction.moveTo(.2,{x:p.x,y:p.y+this.node.getChildByName("main").height/2+20}))}},t.prototype.onDestroy=function(){var t=this.node.getChildByName("main");t&&t.off(cc.Node.EventType.TOUCH_END,this.onBtnHandler,this),e.prototype.onDestroy.call(this),this.currentId=null},t=i([p],t)}(c.ComponentExtends));o.default=d,cc._RF.pop()},{"../../Main":"Main","../../core/Engine":"Engine","../../core/language/LanguageLabel":"LanguageLabel","../../core/ui/ComponentExtends":"ComponentExtends","../../core/ui/ViewUtils":"ViewUtils"}],MapControl:[function(e,t,o){"use strict";cc._RF.push(t,"783d7P8JTVAxbgJrhnHl8Yr","MapControl");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../../core/Engine"),a=e("../../../core/gui/GUI"),c=e("../../../core/ui/ComponentExtends"),s=e("../../../Main"),l=cc._decorator,u=l.ccclass,p=l.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.map=null,t.mapContainer=null,t.scaleTime=null,t.maxScale=3,t.minScale=1,t.initScale=1,t.moveOffset=2,t.increaseRate=1e4,t.limit=200,t.threshold=1.5,t.operLock=!1,t.mapTouchList=[],t.singleTouchCb=null,t._isMoving=!1,t.finalPos=new cc.Vec2(0,0),t.finalTime=0,t.actionDuration=0,t.mouseDown=!1,t}return n(t,e),Object.defineProperty(t.prototype,"isMoving",{get:function(){return this._isMoving},set:function(e){this._isMoving=e,s.default.module.vm.isMoving=e},enumerable:!0,configurable:!0}),t.prototype.start=function(){this.map||(this.map=this.node),this.mapContainer||(this.mapContainer=this.node.parent),this.addEvent(),this.initNode()},t.prototype.initNode=function(){this.initScale&&(this.node.scale=this.initScale),this.node.x=-815,this.node.y=15,this.cloudOpacity()},t.prototype.onDestroy=function(){this.map&&this.map.targetOff(this),this.operLock=null,this.isMoving=null,this.mapTouchList=null,this.singleTouchCb=null,e.prototype.onDestroy.call(this)},t.prototype.addEvent=function(){var e=this;this.map.on(cc.Node.EventType.TOUCH_MOVE,function(t){if(!(a.gui.customPopup.size()>0)&&(s.default.module.mainScene.showStoresName(!0,e.map.scale),!e.operLock))if(t.getTouches().filter(function(t){var o=cc.v2(t.getStartLocation().x,t.getStartLocation().y),n=e.mapContainer.convertToWorldSpaceAR(cc.Vec2.ZERO);return cc.rect(n.x-e.mapContainer.width/2,n.y-e.mapContainer.height/2,e.mapContainer.width,e.mapContainer.height).contains(o)}).forEach(function(t){0===e.mapTouchList.filter(function(e){return e.id===t.getID()}).length&&e.mapTouchList.push({id:t.getID(),touch:t})}),e.mouseDown=!0,e.mapTouchList.length>=2)e.isMoving=!0,e.dealTouchData(e.mapTouchList,e.map);else if(1===e.mapTouchList.length){var o=e.mapTouchList[0].touch,n=cc.v2(o.getStartLocation()),i=cc.v2(o.getLocation());if((Math.abs(i.x-n.x)<=e.moveOffset||Math.abs(i.y-n.y)<=e.moveOffset)&&!e.isMoving)return;var r=cc.v2(o.getDelta());e.isMoving=!0,e.dealMove(r,e.map,e.mapContainer)}},this),this.map.on(cc.Node.EventType.TOUCH_START,function(t){if(!(a.gui.customPopup.size()>0)){if(e.operLock)return cc.log("operate is lock");e.finalPos=t.touch.getLocation(),e.finalTime=t.touch._lastModified}},this),this.map.on(cc.Node.EventType.TOUCH_END,function(t){if(r.default.log.info(t.target.name+"MapControl,TOUCH_END"),!(a.gui.customPopup.size()>0)){if(s.default.module.mainScene.showStoresName(!1,e.map.scale),e.operLock)return cc.log("operate is lock");if(e.isMoving&&e.mapTouchList.length>=2&&(cc.log("TOUCH_END\u53cc\u6307\u56de\u5f39"),e.twoScaleAnim()),e.isMoving&&e.mapTouchList.length<2&&e.dealMoveAction(t),e.mapTouchList.length<2){if(!e.isMoving){var o=cc.v2(t.getLocation()),n=e.map.convertToNodeSpaceAR(o);e.dealSelect(n)}e.isMoving=!1}e.removeTouchFromContent(t,e.mapTouchList)}},this),this.map.on(cc.Node.EventType.MOUSE_DOWN,function(t){s.default.module.mainScene.showStoresName(!1,e.map.scale),e.operLock||(e.mouseDown=!0)},this),this.map.on(cc.Node.EventType.MOUSE_UP,function(t){s.default.module.mainScene.showStoresName(!1,e.map.scale),e.operLock||(e.mouseDown=!1)},this),this.map.on(cc.Node.EventType.TOUCH_CANCEL,function(t){e.operLock||(e.isMoving&&e.mapTouchList.length>=2&&(cc.log("TOUCH_CANCEL\u53cc\u6307\u56de\u5f39"),e.twoScaleAnim()),e.isMoving&&e.mapTouchList.length<2&&e.dealMoveAction(t),e.mapTouchList.length<2&&(e.isMoving=!1),s.default.module.mainScene.showStoresName(!1,e.map.scale),e.removeTouchFromContent(t,e.mapTouchList))},this),this.map.on(cc.Node.EventType.MOUSE_WHEEL,function(t){if(!(e.operLock||a.gui.customPopup.size()>0)){var o=t.getLocation(),n=cc.v2(o.x,o.y),i=t.getScrollY(),r=e.map.scale+i/e.increaseRate,c=e.map,s=c.convertToNodeSpaceAR(n);e.smoothOperate(c,s,r,!1)}},this)},t.prototype.removeTouchFromContent=function(e,t){for(var o=e.getTouches().map(function(e){return e.getID()}),n=t.length-1;n>=0;--n)o.indexOf(t[n].id)>-1&&t.splice(n,1)},t.prototype.twoScaleAnim=function(){var e=this;cc.log("twoScaleAnim\u53cc\u6307\u56de\u5f39"),this.map.scale<this.minScale&&(this.map.RunAction(ezaction.scaleTo(.2,{scale:this.minScale})).onStoped(function(){cc.log("\u4e4b\u540etwoScaleAnim\u53cc\u6307\u56de\u5f39scale"+e.map.scale)}),cc.log("\u4e4b\u524dtwoScaleAnim\u53cc\u6307\u56de\u5f39scale"+this.map.scale))},t.prototype.smoothOperate=function(e,t,o,n){void 0===n&&(n=!0);var i=o-e.scaleX,r=t.scale(cc.v2(i,i)),a=e.getPosition().sub(cc.v2(r.x,r.y));if(!this.isOutRangeScale(o,n)){if(o=(100*o|0)/100,e.scale=o,o<this.minScale)return;this.dealScalePos(a,e)}o=this.dealScaleRange(o),this.cloudOpacity()},t.prototype.cloudOpacity=function(){var e=this;this.node.getChildByName("cloud_anim").children.forEach(function(t){e.node.scale>=e.initScale?t.opacity=0:t.opacity=255*Math.abs(e.node.scale-1)*e.maxScale/e.minScale})},t.prototype.dealTouchData=function(e,t){var o=e[0].touch,n=e[1].touch,i=cc.v2(o.getDelta()),r=cc.v2(n.getDelta()),a=t.convertToNodeSpaceAR(cc.v2(o.getLocation())),c=t.convertToNodeSpaceAR(cc.v2(n.getLocation())),s=a.sub(c),l=i.sub(r),u=1;u=Math.abs(s.x)>Math.abs(s.y)?(s.x+l.x)/s.x*t.scaleX:(s.y+l.y)/s.y*t.scaleY;var p=c.add(cc.v2(s.x/2,s.y/2));this.smoothOperate(t,p,u)},t.prototype.isOutRangeScale=function(e,t){return e>this.maxScale||e<this.minScale-(t?.05:0)},t.prototype.dealScaleRange=function(e){return e>this.maxScale?this.maxScale:e<this.minScale?this.minScale:e},t.prototype.dealScalePos=function(e,t){var o=this.mapContainer,n=o.convertToWorldSpaceAR(e),i=o.convertToNodeSpaceAR(n),r=this.calculateEdge(t,o,i);r.lBorderDelta>0&&(e.x-=r.lBorderDelta),r.rBorderDelta>0&&(e.x+=r.rBorderDelta),r.uBorderDelta>0&&(e.y+=r.uBorderDelta),r.dBorderDelta>0&&(e.y-=r.dBorderDelta),1===t.scale&&(e=cc.Vec2.ZERO),t.x=e.x,t.y=e.y},t.prototype.dealMoveAction=function(e){var t=e.touch.getLocation();cc.log("StopAllActions");var o=this.map.convertToWorldSpaceAR(cc.Vec2.ZERO),n=this.mapContainer.convertToNodeSpaceAR(o);n.x+=(t.x-this.finalPos.x)*this.threshold,n.y+=(t.y-this.finalPos.y)*this.threshold;var i=this.calculateEdge(this.map,this.mapContainer,n),r={},a=((new Date).getTime()-this.finalTime)/1e3,c={};if(i.lBorderDelta<=0&&i.rBorderDelta<=0)r.x=this.map.x+(t.x-this.finalPos.x)*this.threshold;else{var s=(this.map.width*this.map.scaleX-cc.winSize.width)/2;this.map.x>=s?c.x=s:this.map.x<=-s&&(c.x=-s)}if(i.uBorderDelta<=0&&i.dBorderDelta<=0)r.y=this.map.y+(t.y-this.finalPos.y)*this.threshold;else{var l=(this.map.height*this.map.scaleY-cc.winSize.height)/2;this.map.y>=l?c.y=l:this.map.y<=-l&&(c.y=-l)}if(!(a>.25&&0==Object.getOwnPropertyNames(c).length)){var u=ezaction.HCustomEase.create("ce3","M0,0 C0.084,0.61 0.214,0.802 0.28,0.856 0.356,0.918 0.374,1 1,1 "),p=ezaction.ease.customEase(u);i.lBorderDelta<=0&&i.rBorderDelta<=0&&i.uBorderDelta<=0&&i.dBorderDelta<=0?this.map.RunAction(ezaction.moveTo(3*a,r).easing(p)):this.map.RunAction(ezaction.moveTo(.2,c).easing(p))}},t.prototype.dealMove=function(e,t,o){var n=t.convertToWorldSpaceAR(cc.Vec2.ZERO),i=o.convertToNodeSpaceAR(n),r=this.calculateEdge(t,o,cc.v2(i.x+e.x,i.y+e.y));if(r.lBorderDelta<=0&&r.rBorderDelta<=0)t.x+=e.x;else{var a=t.x+e.x,c=(this.map.width*this.map.scaleX-cc.winSize.width)/2;r.rBorderDelta>0?a<=-c-this.limit*this.map.scaleX?t.x=-c-this.limit*this.map.scaleX:t.x=a:r.lBorderDelta>0&&(a>=c+this.limit*this.map.scaleX?t.x=c+this.limit*this.map.scaleX:t.x=a)}if(r.uBorderDelta<=0&&r.dBorderDelta<=0)t.y+=e.y;else{var s=t.y+e.y,l=(this.map.height*this.map.scaleY-cc.winSize.height)/2;r.dBorderDelta>0?s>=l+this.limit*this.map.scaleY?t.y=l+this.limit*this.map.scaleY:t.y=s:r.uBorderDelta>0&&(s<=-l-this.limit*this.map.scaleY?t.y=-l-this.limit*this.map.scaleY:t.y=s)}},t.prototype.followTargetPos=function(e,t,o,n){void 0===n&&(n=!1);var i=ezaction.HCustomEase.create("ce2","M0,0 C0.018,0.592 0.092,0.79 0.154,0.9 0.172,0.932 0.209,1 0.268,1 0.394,1 0.572,1 1,1 "),r=ezaction.ease.customEase(i),a=e.parent.convertToWorldSpaceAR(e.getPosition()),c=a.x-cc.winSize.width/2,s=a.y-cc.winSize.height/2,l=this.node.x-c,u=this.node.y-s,p=cc.winSize.width,d=cc.winSize.height;l>this.node.width/2*this.node.scaleX-p/2?l=this.node.width/2*this.node.scaleX-p/2:l<-this.node.width/2*this.node.scaleX+p/2?l=-this.node.width/2*this.node.scaleX+p/2:u>this.node.height/2*this.node.scaleY-d/2?u=this.node.height/2*this.node.scaleY-d/2:u<-this.node.height/2*this.node.scaleY+d/2&&(u=-this.node.height/2*this.node.scaleY+d/2),n?this.node.RunAction(ezaction.moveTo(t,{x:l,y:u}).easing(r)).onStoped(function(){o&&o()}):this.node.RunAction(ezaction.moveTo(t,{x:l,y:u})).onStoped(function(){o&&o()})},t.prototype.setSinglTouchCb=function(e){this.singleTouchCb=e},t.prototype.dealSelect=function(e){cc.log("click map on cc.v2("+e.x+", "+e.y+")"),this.singleTouchCb&&this.singleTouchCb(e)},t.prototype.calculateEdge=function(e,t,o){var n=e.width*e.scaleX,i=e.height*e.scaleY;return{lBorderDelta:o.x-n/2+t.width/2,rBorderDelta:t.width/2-(n/2+o.x),uBorderDelta:t.height/2-(i/2+o.y),dBorderDelta:o.y-i/2+t.height/2}},i([p({type:cc.Node,tooltip:"\u76ee\u6807\u8282\u70b9\uff0c\u5f53mapContainer\u4e3anull\u65f6\uff0c\u9700\u8981\u5c06\u8be5\u7ec4\u4ef6\u6302\u5728\u76ee\u6807\u8282\u70b9\uff0c\u8be5\u8282\u70b9\u9ed8\u8ba4\u4e3a\u6302\u8f7d\u8282\u70b9"})],t.prototype,"map",void 0),i([p({type:cc.Node,tooltip:"\u5f53\u8be5\u8282\u70b9\u4e3a\u7a7a\u65f6\uff0c\u9700\u8981\u5c06\u6539\u7ec4\u4ef6\u6302\u5728map\u8282\u70b9\u4e0a\uff0c\u8be5\u8282\u70b9\u9ed8\u8ba4\u4e3a\u6302\u8f7d\u8282\u70b9\u7684\u7236\u8282\u70b9"})],t.prototype,"mapContainer",void 0),i([p(cc.Label)],t.prototype,"scaleTime",void 0),i([p({tooltip:"\u56fe\u7247\u7f29\u653e\u6700\u5927scale"})],t.prototype,"maxScale",void 0),i([p({tooltip:"\u56fe\u7247\u7f29\u653e\u6700\u5c0fscale"})],t.prototype,"minScale",void 0),i([p({tooltip:"\u521d\u59cbscale"})],t.prototype,"initScale",void 0),i([p({tooltip:"\u5355\u70b9\u89e6\u6478\u5bb9\u5fcd\u8bef\u5dee"})],t.prototype,"moveOffset",void 0),i([p({tooltip:"\u6eda\u8f6e\u7f29\u653e\u6bd4\u7387"})],t.prototype,"increaseRate",void 0),i([p({tooltip:"\u5141\u8bb8\u8d85\u51fa\u8fb9\u754c\u503c"})],t.prototype,"limit",void 0),i([p({tooltip:"\u60ef\u6027\u9600\u503c"})],t.prototype,"threshold",void 0),t=i([u],t)}(c.ComponentExtends);o.MapControl=d,cc._RF.pop()},{"../../../Main":"Main","../../../core/Engine":"Engine","../../../core/gui/GUI":"GUI","../../../core/ui/ComponentExtends":"ComponentExtends"}],MapData:[function(e,t,o){"use strict";cc._RF.push(t,"a0091ubw51FsLzsP1pcYli/","MapData"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./MapType"),i=function(){return function(){this.name="",this.bgName="",this.type=n.MapType.angle45,this.mapWidth=0,this.mapHeight=0,this.nodeWidth=0,this.nodeHeight=0,this.roadDataArr=[],this.mapItem=[]}}();o.default=i,cc._RF.pop()},{"./MapType":"MapType"}],MapLayer:[function(e,t,o){"use strict";cc._RF.push(t,"753fbcKY45E1Lc2+Glt9EhY","MapLayer");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,a=r.ccclass,c=r.property,s=function(e){function t(){var t=e.call(this)||this;return t._sliceWidth=200,t._sliceHeight=200,t._sliceImgDic={},t.bgImg=null,t}return n(t,e),t.prototype.init=function(e,t,o,n,i){void 0===i&&(i=null),this._viewWidth=e,this._viewHeight=t,this._sliceWidth=o,this._sliceHeight=n,i&&this.bgImg&&(this.bgImg.spriteFrame=new cc.SpriteFrame(i)),this.node.width=this.width,this.node.height=this.height},t.prototype.load=function(e){},t.prototype.onLoadComplete=function(){},t.prototype.loadSmallImage=function(e,t){if(this._bitmapDataArr)Math.floor(e/this._sliceWidth),Math.floor(t/this._sliceHeight),Math.floor((e+this._viewWidth)/this._sliceWidth),Math.floor((t+this._viewHeight)/this._sliceHeight)},t.prototype.clear=function(){this.bgImg&&(this.bgImg.spriteFrame=null)},Object.defineProperty(t.prototype,"bgImage",{get:function(){return this.bgImg},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.bgImg?this.bgImg.node.width:this._viewWidth},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.bgImg?this.bgImg.node.height:this._viewHeight},enumerable:!0,configurable:!0}),i([c(cc.Sprite)],t.prototype,"bgImg",void 0),t=i([a],t)}(cc.Component);o.default=s,cc._RF.pop()},{}],MapNpcController:[function(e,t,o){"use strict";cc._RF.push(t,"43428LFTFJML410wP3kI3iU","MapNpcController");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../core/util/HashMap"),a=e("../Main"),c=e("../map/charactor/Charactor"),s=e("../map/SceneMap"),l=e("./game/npc/NpcClickComponent"),u=[new cc.Vec2(3690,2115),new cc.Vec2(3630,2085),new cc.Vec2(2190,1365),new cc.Vec2(2250,1395),new cc.Vec2(2490,2265),new cc.Vec2(1980,2010),new cc.Vec2(1440,1740),new cc.Vec2(1980,2520),new cc.Vec2(1470,2265),new cc.Vec2(930,1995)],p=[64,48,64,80,80,48,64,80,96,48],d=cc._decorator,h=d.ccclass,f=d.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.sceneMap=null,t.npcPrefab=null,t.npcHash=new r.HashMap,t.storePos=new r.HashMap,t.npcAIDataHash=new r.HashMap,t.currentIds=[],t}return n(t,e),t.prototype.onLoad=function(){this.storePos=this.parseStoreJson(),this.schedule(this.AIHandler,.3)},t.prototype.parseStoreJson=function(){var e=new r.HashMap,t=cc.loader.getRes("main/json/storepos",cc.JsonAsset).json;for(var o in t){var n=t[o],i=n.pos.split(","),a=n.gatepos.split(","),c={x:parseInt(i[0].replace(/[^\d]/,"")),y:parseInt(i[1].replace(/[^\d]/,"")),gateposX:parseInt(a[0].replace(/[^\d]/,"")),gateposY:parseInt(a[1].replace(/[^\d]/,""))};e.set(o,c)}return e},t.prototype.onDestroy=function(){this.npcHash.clear(),this.npcAIDataHash.clear(),this.storePos=null,this.unscheduleAllCallbacks()},t.prototype.AIHandler=function(){for(var e=0,t=this.npcHash.values();e<t.length;e++){var o=t[e];if(o.state!==c.CharactorState.run&&o.state!==c.CharactorState.sitdown){if(!o.node)return;var n=this.npcAIDataHash.get(o.node.uuid);if(n.idleTime>0){if(n.idleTime<Date.now()&&Math.random()>.2){var i=a.default.module.gameMainControl.getUnlockStoreIds();if(i.length>0){var r=i[Math.floor(i.length*Math.random())],s=this.storePos.get(r),l=r;this.sceneMap.movePlayer(o,s.gateposX,s.gateposY,l),n.idleTime=0,n.targetStoreID=r}}}else n.idleTime=Date.now()+1e3+3e3*Math.random()}}},t.prototype.createNpcs=function(e){for(var t=0;t<10;t++){var o=e[t];if(-1!=e.indexOf(o)&&-1==this.currentIds.indexOf(o)){var n=cc.instantiate(this.npcPrefab),i=u[parseInt(o)-1];n.setPosition(i),n.getComponent(l.default).initClickEvent(parseInt(o)),this.sceneMap.node.addChild(n),n.name="npc_"+o;var r=n.getComponent(c.default);r.sceneMap=this.sceneMap,r.id=o,r.moveSpeed=p[parseInt(o)-1]||44,this.npcHash.set(n.uuid,r),this.npcAIDataHash.set(n.uuid,{state:r.state,idleTime:Date.now()+2e3*Math.random(),targetStoreID:0})}else if(0==e.length&&this.currentIds.length>0){var a=this.currentIds[t],s=this.sceneMap.node.getChildByName("npc_"+a);s&&(this.npcHash.delete(s.uuid),this.npcAIDataHash.delete(s.uuid),s.destroy())}}this.currentIds=e},i([f(s.default)],t.prototype,"sceneMap",void 0),i([f(cc.Prefab)],t.prototype,"npcPrefab",void 0),t=i([h],t)}(cc.Component);o.MapNpcController=g,cc._RF.pop()},{"../Main":"Main","../core/util/HashMap":"HashMap","../map/SceneMap":"SceneMap","../map/charactor/Charactor":"Charactor","./game/npc/NpcClickComponent":"NpcClickComponent"}],MapParams:[function(e,t,o){"use strict";cc._RF.push(t,"6b00e3/60pNy69HrXB4iMm4","MapParams"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./MapType"),i=function(){return function(){this.name="",this.mapType=n.MapType.angle45,this.mapWidth=750,this.mapHeight=1600,this.ceilWidth=75,this.ceilHeight=75,this.bgTex=null}}();o.default=i,cc._RF.pop()},{"./MapType":"MapType"}],MapRoadUtils:[function(e,t,o){"use strict";cc._RF.push(t,"38983rww8xCor2DSeawAfiI","MapRoadUtils"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./Point"),i=e("./RoadNode"),r=e("../base/MapType"),a=function(){function e(){}return e.prototype.updateMapInfo=function(e,t,o,n,i){switch(this._mapWidth=e,this._mapHeight=t,this._nodeWidth=o,this._nodeHeight=n,this._halfNodeWidth=Math.floor(this._nodeWidth/2),this._halfNodeHeight=Math.floor(this._nodeHeight/2),this._col=Math.ceil(e/this._nodeWidth),this._row=Math.ceil(t/this._nodeHeight),this._mapType=i,this._mapType){case r.MapType.angle45:this._mapRoad=new c(this._row,this._col,this._nodeWidth,this._nodeHeight,this._halfNodeWidth,this._halfNodeHeight);break;case r.MapType.angle90:this._mapRoad=new s(this._row,this._col,this._nodeWidth,this._nodeHeight,this._halfNodeWidth,this._halfNodeHeight);break;case r.MapType.honeycomb:this._col=2*Math.ceil((this._mapWidth-this._nodeWidth/4)/(this._nodeWidth/4*6)),this._row=Math.ceil((this._mapHeight-this._nodeHeight/2)/this._nodeHeight),this._mapRoad=new l(this._row,this._col,this._nodeWidth,this._nodeHeight,this._halfNodeWidth,this._halfNodeHeight)}},e.prototype.getNodeByPixel=function(e,t){return this._mapRoad?this._mapRoad.getNodeByPixel(e,t):new i.default},e.prototype.getNodeByDerect=function(e,t){return this._mapRoad?this._mapRoad.getNodeByDerect(e,t):new i.default},e.prototype.getNodeByWorldPoint=function(e,t){return this._mapRoad?this._mapRoad.getNodeByWorldPoint(e,t):new i.default},e.prototype.getWorldPointByPixel=function(e,t){return this._mapRoad?this._mapRoad.getWorldPointByPixel(e,t):new n.default},e.prototype.getPixelByWorldPoint=function(e,t){return this._mapRoad?this._mapRoad.getPixelByWorldPoint(e,t):new n.default},e.prototype.getDerectByPixel=function(e,t){return this._mapRoad?this._mapRoad.getDerectByPixel(e,t):new n.default},e.prototype.getDerectByWorldPoint=function(e,t){return this._mapRoad?this._mapRoad.getDerectByWorldPoint(e,t):new n.default},e.prototype.getPixelByDerect=function(e,t){return this._mapRoad?this._mapRoad.getPixelByDerect(e,t):new n.default},Object.defineProperty(e.prototype,"mapWidth",{get:function(){return this._mapWidth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mapHeight",{get:function(){return this._mapHeight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nodeWidth",{get:function(){return this._nodeWidth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nodeHeight",{get:function(){return this._nodeHeight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"row",{get:function(){return this._row},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"col",{get:function(){return this._col},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"halfNodeWidth",{get:function(){return this._halfNodeWidth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"halfNodeHeight",{get:function(){return this._halfNodeHeight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mapType",{get:function(){return this._mapType},enumerable:!0,configurable:!0}),e}();o.default=a;var c=function(){function e(e,t,o,n,i,r){this._row=e,this._col=t,this._nodeWidth=o,this._nodeHeight=n,this._halfNodeWidth=i,this._halfNodeHeight=r}return e.prototype.getNodeByPixel=function(e,t){var o=this.getWorldPointByPixel(e,t),n=this.getPixelByWorldPoint(o.x,o.y),r=this.getDerectByPixel(e,t),a=new i.default;return a.cx=o.x,a.cy=o.y,a.px=n.x,a.py=n.y,a.dx=r.x,a.dy=r.y,a},e.prototype.getNodeByDerect=function(e,t){var o=this.getPixelByDerect(e,t),n=this.getWorldPointByPixel(o.x,o.y),r=new i.default;return r.cx=n.x,r.cy=n.y,r.px=o.x,r.py=o.y,r.dx=e,r.dy=t,r},e.prototype.getNodeByWorldPoint=function(e,t){var o=this.getPixelByWorldPoint(e,t);return this.getNodeByPixel(o.x,o.y)},e.prototype.getWorldPointByPixel=function(e,t){var o=Math.ceil(e/this._nodeWidth-.5+t/this._nodeHeight)-1,i=this._col-1-Math.ceil(e/this._nodeWidth-.5-t/this._nodeHeight);return new n.default(o,i)},e.prototype.getPixelByWorldPoint=function(e,t){var o=Math.floor((e+1-(t-(this._col-1)))*this._halfNodeWidth),i=Math.floor((e+1+(t-(this._col-1)))*this._halfNodeHeight);return new n.default(o,i)},e.prototype.getDerectByPixel=function(e,t){var o=this.getWorldPointByPixel(e,t),i=this.getPixelByWorldPoint(o.x,o.y),r=Math.floor(i.x/this._nodeWidth)-(i.x%this._nodeWidth==0?1:0),a=Math.floor(i.y/this._halfNodeHeight)-1;return new n.default(r,a)},e.prototype.getDerectByWorldPoint=function(e,t){var o=Math.floor((e-(t-(this._col-1)))/2),i=e+(t-(this._col-1));return new n.default(o,i)},e.prototype.getPixelByDerect=function(e,t){var o=Math.floor((e+t%2)*this._nodeWidth+(1-t%2)*this._halfNodeWidth),i=Math.floor((t+1)*this._halfNodeHeight);return new n.default(o,i)},e}(),s=function(){function e(e,t,o,n,i,r){this._row=e,this._col=t,this._nodeWidth=o,this._nodeHeight=n,this._halfNodeWidth=i,this._halfNodeHeight=r}return e.prototype.getNodeByPixel=function(e,t){var o=this.getWorldPointByPixel(e,t),n=this.getPixelByWorldPoint(o.x,o.y),r=this.getDerectByPixel(e,t),a=new i.default;return a.cx=o.x,a.cy=o.y,a.px=n.x,a.py=n.y,a.dx=r.x,a.dy=r.y,a},e.prototype.getNodeByDerect=function(e,t){var o=this.getPixelByDerect(e,t),n=this.getWorldPointByPixel(o.x,o.y),r=new i.default;return r.cx=n.x,r.cy=n.y,r.px=o.x,r.py=o.y,r.dx=e,r.dy=t,r},e.prototype.getNodeByWorldPoint=function(e,t){var o=this.getPixelByWorldPoint(e,t);return this.getNodeByPixel(o.x,o.y)},e.prototype.getWorldPointByPixel=function(e,t){var o=Math.floor(e/this._nodeWidth),i=Math.floor(t/this._nodeHeight);return new n.default(o,i)},e.prototype.getPixelByWorldPoint=function(e,t){var o=Math.floor((e+1)*this._nodeWidth-this._halfNodeWidth),i=Math.floor((t+1)*this._nodeHeight-this._halfNodeHeight);return new n.default(o,i)},e.prototype.getDerectByPixel=function(e,t){var o=Math.floor(e/this._nodeWidth),i=Math.floor(t/this._nodeHeight);return new n.default(o,i)},e.prototype.getDerectByWorldPoint=function(e,t){return new n.default(e,t)},e.prototype.getPixelByDerect=function(e,t){var o=Math.floor((e+1)*this._nodeWidth-this._halfNodeWidth),i=Math.floor((t+1)*this._nodeHeight-this._halfNodeHeight);return new n.default(o,i)},e}(),l=function(){function e(e,t,o,n,i,r){this._proportion=1.732,this._row=e,this._col=t,this._nodeWidth=o,this._nodeHeight=n,this._halfNodeWidth=i,this._halfNodeHeight=r,this._nwDiv4=this._nodeWidth/4,this._radius=4*this._nwDiv4,this._proportion=2*this._nodeHeight/this._nodeWidth}return e.prototype.getNodeByPixel=function(e,t){var o=this.getWorldPointByPixel(e,t),n=this.getPixelByWorldPoint(o.x,o.y),r=new i.default;return r.cx=o.x,r.cy=o.y,r.px=n.x,r.py=n.y,r.dx=o.x,r.dy=o.y,r},e.prototype.getNodeByDerect=function(e,t){var o=this.getPixelByDerect(e,t),n=new i.default;return n.cx=e,n.cy=t,n.px=o.x,n.py=o.y,n.dx=e,n.dy=t,n},e.prototype.getNodeByWorldPoint=function(e,t){var o=this.getPixelByWorldPoint(e,t);return this.getNodeByPixel(o.x,o.y)},e.prototype.getWorldPointByPixel=function(e,t){var o,i,r,a=Math.floor(e/this._nwDiv4),c=Math.floor(a/3);return(a-1)%6==0||(a-2)%6==0?(i=c,r=o=Math.floor(t/this._nodeHeight)):(a-4)%6==0||(a-5)%6==0?(i=c,r=o=t<this._nodeHeight/2?-1:Math.floor((t-this._nodeHeight/2)/this._nodeHeight)):c%2==0?(o=Math.floor(t/this._nodeHeight),this.testPointInHoneycomb(c,o,e,t)?(i=c,r=o):this.testPointInHoneycomb(c-1,o-1,e,t)?(i=c-1,r=o-1):(i=c-1,r=o)):(o=t<this._nodeHeight/2?-1:Math.floor((t-this._nodeHeight/2)/this._nodeHeight),this.testPointInHoneycomb(c,o,e,t)?(i=c,r=o):this.testPointInHoneycomb(c-1,o,e,t)?(i=c-1,r=o):(i=c-1,r=o+1)),new n.default(i,r)},e.prototype.testPointInHoneycomb=function(e,t,o,n){var i=2*this._nwDiv4,r=this.getPixelByWorldPoint(e,t);return i-Math.abs(o-r.x)>=Math.abs(n-r.y)/this._proportion},e.prototype.getPixelByWorldPoint=function(e,t){var o=Math.floor((2+3*e)/4*this._nodeWidth),i=Math.floor((t+.5*(1+e%2))*this._nodeHeight);return new n.default(o,i)},e.prototype.getDerectByPixel=function(e,t){return this.getWorldPointByPixel(e,t)},e.prototype.getDerectByWorldPoint=function(e,t){return new n.default(e,t)},e.prototype.getPixelByDerect=function(e,t){var o=(2+3*e)/4*this._nodeWidth,i=(t+.5*(1+e%2))*this._nodeHeight;return new n.default(o,i)},e}();cc._RF.pop()},{"../base/MapType":"MapType","./Point":"Point","./RoadNode":"RoadNode"}],MapType:[function(e,t,o){"use strict";cc._RF.push(t,"967a1oZod1CQYHXqS8EHBnp","MapType"),Object.defineProperty(o,"__esModule",{value:!0}),function(e){e[e.angle45=0]="angle45",e[e.angle90=1]="angle90",e[e.honeycomb=2]="honeycomb"}(o.MapType||(o.MapType={})),cc._RF.pop()},{}],MessageManager:[function(e,t,o){"use strict";cc._RF.push(t,"6ace4f1UCxCjqeyvfvEJgyN","MessageManager"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){return function(){}}(),i=function(){function e(){this.eventMap={}}return e.prototype.on=function(e,t,i){var r=this.eventMap[e];null==r&&(r=[],this.eventMap[e]=r);var a=new n;a.event=e,a.listener=t,a.thisObj=i,r.push(a),o.Message.on(e,t,i)},e.prototype.off=function(e){var t=this.eventMap[e];if(t){for(var n=0,i=t;n<i.length;n++){var r=i[n];o.Message.off(e,r.listener,r.thisObj)}delete this.eventMap[e]}},e.prototype.dispatchEvent=function(e,t){void 0===t&&(t=null),o.Message.dispatchEvent(e,t)},e.prototype.removes=function(){for(var e in this.eventMap)this.off(e)},e}();o.MessageEventData=i;var r=function(){function e(){this.eventMap={}}return e.prototype.on=function(e,t,o){if(e&&t){var i=this.eventMap[e];null==i&&(i=[],this.eventMap[e]=i);for(var r=i.length,a=0;a<r;a++){var c=i[a];c.listener==t&&c.thisObj==o&&cc.warn("\u540d\u4e3a\u3010"+e+"\u3011\u7684\u4e8b\u4ef6\u91cd\u590d\u6ce8\u518c\u4fa6\u542c\u5668")}var s=new n;s.event=e,s.listener=t,s.thisObj=o,i.push(s)}else cc.warn("\u6ce8\u518c\u3010"+e+"\u3011\u4e8b\u4ef6\u7684\u4fa6\u542c\u5668\u51fd\u6570\u4e3a\u7a7a")},e.prototype.once=function(e,t,o){var n=this,i=function(r,a){n.off(e,i,o),i=null,t.call(o,r,a)};this.on(e,i,o)},e.prototype.off=function(e,t,o){var n=this.eventMap[e];if(n){for(var i=n.length,r=0;r<i;r++){var a=n[r];if(a.listener==t&&a.thisObj==o){n.splice(r,1);break}}0==n.length&&delete this.eventMap[e]}else cc.log("\u540d\u4e3a\u3010"+e+"\u3011\u7684\u4e8b\u4ef6\u4e0d\u5b58\u5728")},e.prototype.dispatchEvent=function(e,t){void 0===t&&(t=null);var o=this.eventMap[e];if(null!=o)for(var n=o.concat(),i=n.length,r=0;r<i;r++){var a=n[r];a.listener.call(a.thisObj,e,t)}},e.prototype.removeEventTarget=function(e){for(var t in this.eventMap)for(var o=this.eventMap[t],n=0,i=!0,r=o.length;n<r;i?n++:n){var a=o[n];a&&a.thisObj===e?(o.splice(n,1),i=!1):i=!0}},e.Instance=new e,e}();o.Message=r.Instance,cc._RF.pop()},{}],ModuleManager:[function(e,t,o){"use strict";cc._RF.push(t,"02c91kvZQRC7J1yVyOGdEMN","ModuleManager"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../core/Engine"),i=e("../core/event/MessageManager"),r=e("../core/ezplugin/ezplugin"),a=e("../core/gui/GUI"),c=e("../core/ui/button/ButtonEffect"),s=e("../core/util/AsyncQueue"),l=e("../service/account/Account"),u=e("../service/Service"),p=e("./AudioMessage"),d=e("./CalcTool"),h=e("./CalcUiShow"),f=e("./game/adv/AdvControl"),g=e("./game/novice/NoviceHandle"),m=e("./GameAudio"),v=e("./GameData"),_=e("./GameProtocol"),y=e("./GameViewModel"),b=e("./Pay"),C=e("./ThemeConfig"),T=function(){function e(){this.gameProtocol=null,this.gamedata=new v.GameData,this.mainScene=null,this.gameMainControl=null,this.mapNpcController=null,this.themeConfig=null,this.calcTool=null,this.calcUiShow=null,this.noviceHandle=null,this.audio=null,this.pay=new b.Pay,this.vm=null,this.needShowLevelUp=!1,this.preOffReward={num:0,numE:0},this.currentOffLineNode=null,this.isEnterGame=!1,this.vm=new y.default({cityId:1,level:1,levelReward:1,diamond:0,refreshCreditUi:null,storeList:null,clerkList:null,fameList:null,goodsList:null,rankingList:null,goodsInfo:null,taskList:null,propList:null,propStorageList:null,noviceProgress:null,mainProgress:null,credit:null,win:null,winTotal:null,fame:null,lang:n.default.i18n.currentLanguage,gear:null,message:!0,advCount:0,sellNum:0,npcNum:0,isMoving:!1,isPass:0}),c.default.default.touchStartCallback=function(e){var t=e.node.name;"btn_unlock"!=t&&"btn_uplv"!=t&&i.Message.dispatchEvent(p.AudioMessage.EFFECT,"ui_2")};var e=r.ezplugin.get("PluginTopon");e&&e.addEventListener(function(e,t){var o=JSON.parse(t);switch(cc.log("[ModuleManager] admob ",e,t),e){case"open":cc.log("[ModuleManager] Admob open");break;case"earned":cc.log("[ModuleManager] Admob earned");break;case"error":a.gui.notify.show("ad_error",!0),i.Message.dispatchEvent(f.AdvMessage.ADV_ERROR,o);break;case"close":i.Message.dispatchEvent(f.AdvMessage.ADV_SUCCESS,o)}}),i.Message.on(l.AccountEvent.LOGINED,this.messageHandler,this)}return e.prototype.exitHall=function(){a.gui.ui.has("loading/loading")||(this.currentOffLineNode=null,this.exitGame(),a.gui.customPopup.clear(),a.gui.popup.clear(),a.gui.ui.clear(),u.service.account.logout(),a.gui.ui.add("loading/loading",{state:1}),cc.log("[ModuleManager] exitHall"))},e.prototype.exitGame=function(e){void 0===e&&(e=null),this.gameMainControl&&this.gameMainControl.unwatchTargetAll()},e.prototype.messageHandler=function(e,t){switch(e){case l.AccountEvent.LOGINED:this.vm.key=u.service.account.data.uid.toString(),this.vm.save();var o=r.ezplugin.get("PluginBugly");o?o.excute("userid",u.service.account.data.uid):(o=r.ezplugin.get("PluginBugly"))&&o.excute("userid",u.service.account.data.uid)}},e.prototype.loadOffLineReward=function(e,t,o){var i=this;if(e.num>0){this.currentOffLineNode&&(this.preOffReward=this.calcTool.calcAddNum(e,this.preOffReward),this.currentOffLineNode.destroy());var r={modal:!0,opacity:180,onAdded:function(e){n.default.timer.scheduleOnce(function(){i.currentOffLineNode=e},.01)},onRemoved:function(){o&&o()}};a.gui.popup.add("popup/offline_reward",{reward:e,spanTime:t},r)}else o&&o()},e.prototype.entry=function(e){var t=u.service.account.data,o=cc.sys.localStorage.getItem("entryData");o?o=JSON.parse(o):(o={loginTime:(new Date).getTime()+"",nowDate:(new Date).getTime()+"",diamond:0,level:1,levelReward:1,fame:0,fameE:0,credit:0,creditE:0,win:0,winE:0,winTotal:0,winTotalE:0},cc.sys.localStorage.setItem("entryData",JSON.stringify(o))),t.loginTime=o.loginTime||"",t.nowDate=o.nowDate||"",t.diamond=o.diamond,this.vm.diamond=t.diamond,this.vm.level=0==o.level?1:o.level,this.vm.levelReward=0==o.levelReward?1:o.levelReward,t.level=this.vm.level,t.fame={num:o.fame||0,numE:o.fameE||0},t.fame.num<0&&(t.fame.num=0),this.vm.fame=t.fame,t.credit={num:o.credit||0,numE:o.creditE||0},t.credit.num<0&&(t.credit.num=0),this.vm.credit=t.credit,t.win={num:o.win||0,numE:o.winE||0},t.win.num<0&&(t.win.num=0),this.vm.win=t.win,t.winTotal={num:o.winTotal||0,numE:o.winTotalE||0},t.winTotal.num<0&&(t.winTotal.num=0),this.vm.winTotal=t.winTotal,e()},e.prototype.enterGame=function(){var e=this;n.default.log.info("enterGame");var t=new s.AsyncQueue;this.themeConfig||(this.themeConfig=new C.ThemeConfig),this.audio||(this.audio=new m.GameAudio),this.gameProtocol||(this.gameProtocol=new _.GameProtocol(u.service.server)),this.calcTool||(this.calcTool=new d.CalcTool(this.themeConfig)),this.calcUiShow||(this.calcUiShow=new h.CalcUiShow(this.themeConfig,this.calcTool)),this.noviceHandle||(this.noviceHandle=new g.default),t.push(function(t){e.entry(t)}),t.complete=function(){a.gui.ui.add("main/main_scene",null,{onAdded:function(e){a.gui.ui.$delete("loading/loading")},onRemoved:function(){}})},t.play()},e}();o.ModuleManager=T,cc._RF.pop()},{"../core/Engine":"Engine","../core/event/MessageManager":"MessageManager","../core/ezplugin/ezplugin":"ezplugin","../core/gui/GUI":"GUI","../core/ui/button/ButtonEffect":"ButtonEffect","../core/util/AsyncQueue":"AsyncQueue","../service/Service":"Service","../service/account/Account":"Account","./AudioMessage":"AudioMessage","./CalcTool":"CalcTool","./CalcUiShow":"CalcUiShow","./GameAudio":"GameAudio","./GameData":"GameData","./GameProtocol":"GameProtocol","./GameViewModel":"GameViewModel","./Pay":"Pay","./ThemeConfig":"ThemeConfig","./game/adv/AdvControl":"AdvControl","./game/novice/NoviceHandle":"NoviceHandle"}],MovieClip:[function(e,t,o){"use strict";cc._RF.push(t,"cb924t7AD1JlaIj9BYSsdh8","MovieClip");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,a=r.ccclass,c=r.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_sprite=null,t.timer=.1,t.interval=.1,t.texture=null,t.playTimes=0,t.row=4,t.col=4,t.rowIndex=0,t.isAll=!1,t.autoPlayOnLoad=!0,t.autoDestroy=!1,t.begin=0,t.end=0,t.totalFrame=8,t.currentFrame=0,t.currentTimes=0,t.running=!0,t._playIndex=0,t._pieceWidth=0,t._pieceHeight=0,t._bitmapArr=[],t}return n(t,e),t.prototype.onLoad=function(){0==this.end&&(this.end=this.col),this.rowIndex=this.clamp(this.rowIndex,0,this.row-1),this._pieceWidth=this.texture.width/this.col,this._pieceHeight=this.texture.height/this.row,this.m_sprite=this.getComponent(cc.Sprite),this.m_sprite||(this.m_sprite=this.addComponent(cc.Sprite));for(var e=0;e<this.row;e++){this._bitmapArr[e]=[];for(var t=0;t<this.col;t++)this._bitmapArr[e][t]=new cc.SpriteFrame(this.texture,new cc.Rect(t*this._pieceWidth,e*this._pieceHeight,this._pieceWidth,this._pieceHeight),!1,cc.v2(0,0),new cc.Size(this._pieceWidth,this._pieceHeight))}this.m_sprite.spriteFrame=this._bitmapArr[this.rowIndex][0],this.node.width=this._pieceWidth,this.node.height=this._pieceHeight,this.timer=0,this.running=this.autoPlayOnLoad},t.prototype.update=function(e){this.running&&(0==this.playTimes||this.currentTimes!=this.playTimes?(this.timer-=e,this.timer<=0&&(this.timer=this.interval,this.currentFrame=this.currentFrame%this.col,this.playAction(),this.currentFrame++,this.currentFrame==this.col&&(this.isAll?(this.rowIndex++,this.rowIndex==this.row&&(this.currentTimes++,this.node.emit("completeTimes"),0!=this.playTimes&&this.currentTimes==this.playTimes&&(this.node.emit("complete"),this.autoDestroy&&this.node.destroy())),this.rowIndex%=this.row):(this.currentTimes++,this.node.emit("completeTimes"),0!=this.playTimes&&this.currentTimes==this.playTimes&&(this.node.emit("complete"),this.autoDestroy&&this.node.destroy()))))):this.running=!1)},t.prototype.playAction=function(){this.rowIndex=this.clamp(this.rowIndex,0,this.row-1),this._playIndex=this._playIndex%(this.end-this.begin)+this.begin,this.m_sprite.spriteFrame=this._bitmapArr[this.rowIndex][this._playIndex],this._playIndex++},t.prototype.play=function(){this.running=!0},t.prototype.stop=function(){this.running=!1},t.prototype.gotoAndPlay=function(e){this.running=!0,this._playIndex=e,this._playIndex=this.clamp(this._playIndex,0,this.col-1)},t.prototype.gotoAndStop=function(e){this.running=!1,this._playIndex=e,this._playIndex=this.clamp(this._playIndex,0,this.col-1),this.m_sprite.spriteFrame=this._bitmapArr[this.rowIndex][this._playIndex]},t.prototype.clamp=function(e,t,o){return e<t?t:e>o?o:e},i([c(cc.Float)],t.prototype,"interval",void 0),i([c({type:cc.Texture2D})],t.prototype,"texture",void 0),i([c({type:cc.Integer})],t.prototype,"playTimes",void 0),i([c(cc.Integer)],t.prototype,"row",void 0),i([c(cc.Integer)],t.prototype,"col",void 0),i([c(cc.Integer)],t.prototype,"rowIndex",void 0),i([c(cc.Boolean)],t.prototype,"isAll",void 0),i([c(cc.Boolean)],t.prototype,"autoPlayOnLoad",void 0),i([c(cc.Boolean)],t.prototype,"autoDestroy",void 0),i([c()],t.prototype,"begin",void 0),i([c()],t.prototype,"end",void 0),t=i([a],t)}(cc.Component);o.default=s,cc._RF.pop()},{}],NetProtocol:[function(e,t,o){"use strict";cc._RF.push(t,"b88fdCnEz5Fc7KK277PWmgX","NetProtocol");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i,r=e("../event/EventObjectEmitter");(function(e){e.INITED="NetProtocolEvent.INITED",e.CLOSE="NetProtocolEvent.CLOSE",e.PARSE_ERROR="NetProtocolEvent.PARSE_ERROR",e.HEARTBEAT_TIMEOUT="NetProtocolEvent.HEARTBEAT_TIMEOUT"})(i=o.NetProtocolEvent||(o.NetProtocolEvent={}));var a=function(t){function o(){var e=null!==t&&t.apply(this,arguments)||this;return e.tag="NetProtocol",e.errorCodeHandler=null,e._tcp=null,e}return n(o,t),o.prototype.initTcp=function(){var t=this,o=e("pomelo-client")("proto_"+this.tag);o.on(o.Events.CLOSE,function(){t.emit(i.CLOSE)}),o.on(o.Events.PARSE_ERROR,function(e){cc.warn(e.stack),cc.error(t.tag,JSON.stringify(e)),t.emit(i.PARSE_ERROR)}),o.on(o.Events.HEARTBEAT_TIMEOUT,function(e){e&&(e.stack?cc.log(t.tag,JSON.stringify(e.stack,null,2)):cc.log(t.tag,JSON.stringify(e,null,2))),t.emit(i.HEARTBEAT_TIMEOUT)}),this._tcp=o,this.emit(i.INITED)},o.prototype.destroy=function(){this._tcp&&(this._tcp.destroy(),this._tcp=null),t.prototype.destroy.call(this)},o.prototype.setErrorCodeListener=function(e){this.errorCodeHandler=e},o.prototype.connect=function(e,t,o){this._tcp||this.initTcp(),cc.log("["+this.tag+"] connect",e),this._tcp.init({url:e},t,o)},o.prototype.disconnect=function(){this._tcp&&this._tcp.disconnect()},o.prototype.addProtocolListener=function(e,t){this._tcp||this.initTcp(),this._tcp.on(e,t)},o.prototype.removeProtocolListener=function(e,t){this._tcp&&this._tcp.removeListener(e,t)},o.prototype.removeProtocolListeners=function(e){this._tcp&&this._tcp.removeAllListeners(e)},o.prototype.request=function(e,t,o,n){var i=this;void 0===n&&(n=null),"function"==typeof t&&(n=o,o=t,t=null),this._tcp||this.initTcp(),this._tcp.request(e,t,function(t){0===t.code?o&&o(t.data):(cc.log("["+i.tag+"] \u8bf7\u6c42\u9519\u8bef "+e+" error = "+t.code),null==t.code&&(t.code=9),i.errorCodeFunction(e,t.code),n&&n(t.code,t.data))})},o.prototype.errorCodeFunction=function(e,t){return cc.log("["+this.tag+"] errorCodeFunction "+e+" code="+t+" "),this.errorCodeHandler?this.errorCodeHandler(e,t):(cc.warn("["+this.tag+"] this.errorCodeHandler = null\uff0c\u8bf7\u6ce8\u518c\u4e00\u4e2aerrorCode\u7684\u56de\u8c03\u51fd\u6570! "),!0)},o}(r.default);o.NetProtocol=a,cc._RF.pop()},{"../event/EventObjectEmitter":"EventObjectEmitter","pomelo-client":"pomelo-client"}],Network:[function(e,t,o){"use strict";cc._RF.push(t,"77dc6pRuo1P4pVnkXzcx96o","Network");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i,r,a=e("../event/EventDispatcher"),c=e("../ezplugin/ezplugin");function s(e){return/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/.test(e)}(function(e){e.CHANGE="NetworkEvent.CHANGE"})(i=o.NetworkEvent||(o.NetworkEvent={})),function(e){e.UNKNOWN="unknown",e.ONLINE="online",e.OFFLINE="offline"}(r=o.NetworkState||(o.NetworkState={}));var l=function(e){function t(){var t=e.call(this)||this;return t._state=r.UNKNOWN,cc.sys.isBrowser?t._webInit():(t._state=r.ONLINE,c.ezplugin.registerInitedCallback(t.nativeEzpluginInited.bind(t))),t}return n(t,e),t.prototype.isValidIP=function(e){return s(e)},t.prototype.nativeEzpluginInited=function(e){var t=this,o=e.get("PluginOS");if(o){var n=function(e,o){if("network_change"===e)switch(cc.log("\u5f53\u524d\u7f51\u7edc\u51fa\u73b0\u53d8\u5316\uff0c",o),o){case"-1":t.changeState(r.OFFLINE);break;case"0":default:t.changeState(r.ONLINE)}};o.excute("network","",function(e,t){e||n("network_change",t)}),o.addEventListener(n)}},Object.defineProperty(t.prototype,"state",{get:function(){return this._state},enumerable:!0,configurable:!0}),t.prototype.changeState=function(e){this._state!==e&&(this._state=e,cc.log("[Network] "+e),this.dispatchEvent(i.CHANGE,e))},t.prototype._webInit=function(){var e=this;this._callback(navigator.onLine);var t=window,o=document.body;o.addEventListener?(t.addEventListener("online",function(){e._callback(!0)},!0),t.addEventListener("offline",function(){e._callback(!1)},!0)):o.attachEvent?(t.attachEvent("ononline",function(){e._callback(!0)}),t.attachEvent("onoffline",function(){e._callback(!1)})):(t.ononline=function(){e._callback(!0)},t.onoffline=function(){e._callback(!1)}),cc.sys.isMobile||(window.onLineHandler=function(){e._callback(!0)},window.offLineHandler=function(){e._callback(!1)})},t.prototype._callback=function(e){e?this.changeState(r.ONLINE):this.changeState(r.OFFLINE)},t}(a.EventDispatcher);o.Network=l,o.network=new l,cc._RF.pop()},{"../event/EventDispatcher":"EventDispatcher","../ezplugin/ezplugin":"ezplugin"}],NoviceBatchUp:[function(e,t,o){"use strict";cc._RF.push(t,"e4ebeXxyHhCB6doB+6Pqgob","NoviceBatchUp");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../../core/gui/GUI"),a=e("../../../core/ui/ComponentExtends"),c=e("../../../core/ui/ViewUtils"),s=e("../../../Main"),l=e("../effect/LabStepText"),u=cc._decorator,p=u.ccclass,d=(u.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.onLoad=function(){},t.prototype.panelAnim=function(e,t,o,n){var i=t?-720:720;o&&(e.x=i),e.RunAction(ezaction.scaleTo(.3,{x:o?0:i})).onStoped(function(){n()})},t.prototype.onAdded=function(e){var t=this,o=e.callback,n=c.ViewUtils.nodeTreeInfoLite(this.node),i=s.default.module.gameMainControl.storeOperation.mainNodes.get("btn_buy");n.get("skeleton").active=!1,n.get("tip").active=!1,r.gui.popup.get(s.default.module.gameMainControl.pop_storeunlock_id)&&r.gui.popup.delete(s.default.module.gameMainControl.pop_storeunlock_id),this.panelAnim(n.get("panel"),!0,!0,function(){n.get("tip").active=!0,n.get("tip").getComponent(l.default).dataId="beginner_21",n.get("tip").getComponent(l.default).changeTo(1,function(){t.node.getChildByName("skeleton").active=!0;var e=i.parent.convertToWorldSpaceAR(i.getPosition()),r=t.node.convertToNodeSpaceAR(e);t.node.getChildByName("skeleton").setPosition(r);var a=cc.instantiate(i);a.active=!0,a.parent=t.node,a.setPosition(r),t.node.getChildByName("skeleton").zIndex=100,a.once(cc.Node.EventType.TOUCH_END,function(){a.destroy(),o&&o(),n.get("skeleton").active=!1,t.node.destroy()})})})},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t=i([p],t)}(a.ComponentExtends));o.default=d,cc._RF.pop()},{"../../../Main":"Main","../../../core/gui/GUI":"GUI","../../../core/ui/ComponentExtends":"ComponentExtends","../../../core/ui/ViewUtils":"ViewUtils","../effect/LabStepText":"LabStepText"}],NoviceCallengeTask:[function(e,t,o){"use strict";cc._RF.push(t,"c5aba2bx3tMG4/bQ7l4ZH3O","NoviceCallengeTask");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../../core/ui/button/ButtonEffect"),a=e("../../../core/ui/ComponentExtends"),c=e("../../../core/ui/ViewUtils"),s=e("../../../Main"),l=e("../effect/LabStepText"),u=cc._decorator,p=u.ccclass,d=(u.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.onLoad=function(){},t.prototype.panelAnim=function(e,t,o,n){var i=t?-720:720;o&&(e.x=i),e.RunAction(ezaction.scaleTo(.3,{x:o?0:i})).onStoped(function(){n()})},t.prototype.onAdded=function(e){var t=this,o=e.callback,n=e.btnNode,i=c.ViewUtils.nodeTreeInfoLite(this.node);i.get("skeleton").active=!1,i.get("tip").active=!1,this.panelAnim(i.get("panel"),!0,!0,function(){i.get("tip").active=!0,i.get("tip").getComponent(l.default).dataId="beginner_5",i.get("tip").getComponent(l.default).changeTo(1,function(){t.node.getChildByName("skeleton").active=!0;var e=cc.instantiate(n);e.active=!0,e.parent=t.node,t.showButtonEffect(e,!0);var r=n.parent.convertToWorldSpaceAR(n.getPosition()),a=t.node.convertToNodeSpaceAR(r);t.node.getChildByName("skeleton").setPosition(a),e.setPosition(a),t.node.getChildByName("skeleton").zIndex=100,e.once(cc.Node.EventType.TOUCH_END,function(){e.destroy(),s.default.module.gameMainControl.openMainPop("btn_task",function(){t.node.getChildByName("skeleton").active=!1,i.get("tip").getComponent(l.default).dataId="beginner_6",i.get("tip").getComponent(l.default).changeTo(1,function(){t.node.once(cc.Node.EventType.TOUCH_END,function(){t.node.destroy(),o&&o()})})})})})})},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.showButtonEffect=function(e,t){var o=t?cc.Color.WHITE:cc.Color.GRAY,n=e.getComponent(r.default);e.color=o,n&&(n.canTouch=t);var i=function(e){if(0!=e.children.length)for(var t=0,n=e.children;t<n.length;t++){var r=n[t];r.color=o,i(r)}};i(e)},t=i([p],t)}(a.ComponentExtends));o.default=d,cc._RF.pop()},{"../../../Main":"Main","../../../core/ui/ComponentExtends":"ComponentExtends","../../../core/ui/ViewUtils":"ViewUtils","../../../core/ui/button/ButtonEffect":"ButtonEffect","../effect/LabStepText":"LabStepText"}],NoviceClerkUp:[function(e,t,o){"use strict";cc._RF.push(t,"1ae15K9ja9KybRpOEk8JBxw","NoviceClerkUp");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../../core/gui/GUI"),a=e("../../../core/ui/button/ButtonEffect"),c=e("../../../core/ui/ComponentExtends"),s=e("../../../core/ui/ViewUtils"),l=e("../../../core/util/HashMap"),u=e("../../../Main"),p=e("../effect/LabStepText"),d=e("../ShopComponent"),h=cc._decorator,f=h.ccclass,g=(h.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.onLoad=function(){},t.prototype.panelAnim=function(e,t,o,n){var i=t?-720:720;o&&(e.x=i),e.RunAction(ezaction.scaleTo(.3,{x:o?0:i})).onStoped(function(){n()})},t.prototype.onAdded=function(e){var t=this,o=e.btnNode,n=e.callback,i=e.noviceCallback,a=s.ViewUtils.nodeTreeInfoLite(this.node);a.get("skeleton").active=!1,a.get("tip").active=!1,this.panelAnim(a.get("panel"),!0,!0,function(){a.get("tip").active=!0,a.get("tip").getComponent(p.default).dataId="beginner_8",a.get("tip").getComponent(p.default).changeTo(1,function(){t.node.getChildByName("skeleton").active=!0;var e=cc.instantiate(o);e.active=!0,e.parent=t.node,t.showButtonEffect(e,!0);var c=o.parent.convertToWorldSpaceAR(o.getPosition()),h=t.node.convertToNodeSpaceAR(c);t.node.getChildByName("skeleton").setPosition(h),e.setPosition(h),t.node.getChildByName("skeleton").zIndex=100,e.once(cc.Node.EventType.TOUCH_END,function(){e.destroy(),a.get("skeleton").active=!1,u.default.module.gameMainControl.openShop(0,function(){a.get("tip").getComponent(p.default).dataId="beginner_9",a.get("tip").getComponent(p.default).changeTo(1,function(){var e=u.default.module.gameMainControl.popup_container.getChildByName("shop"),o=s.ViewUtils.nodeTreeInfoLite(e.getChildByName("salesman")).get("1").getChildByName("btn_up"),c=cc.instantiate(o);c.active=!0,c.parent=t.node;var p=o.parent.convertToWorldSpaceAR(o.getPosition()),h=t.node.convertToNodeSpaceAR(p);a.get("skeleton").active=!0,a.get("skeleton").zIndex=999,a.get("skeleton").setPosition(h),c.setPosition(h),c.once(cc.Node.EventType.TOUCH_END,function(){c.destroy(),a.get("skeleton").active=!1;var o=new l.HashMap;o.set(1,1);var p=u.default.module.themeConfig.getClerkConfigBytagLv("clerk_1",1);e.getComponent(d.default).clerkLvUp(o,{num:p.clerkPrice,numE:p.clerkPriceE}),i&&i(),a.get("panel").active=!1;var h=s.ViewUtils.nodeTreeInfoLite(e),f=h.get("btn_close").parent.convertToWorldSpaceAR(h.get("btn_close").getPosition()),g=t.node.convertToNodeSpaceAR(f),m=cc.instantiate(h.get("btn_close"));m.active=!0,m.parent=t.node,m.setPosition(g),a.get("skeleton").active=!0,a.get("skeleton").setPosition(g),m.once(cc.Node.EventType.TOUCH_END,function(){t.node.destroy(),u.default.module.gameMainControl.clerkChangeId=1,r.gui.delete(e),n&&n()})})})})})})})},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.showButtonEffect=function(e,t){var o=t?cc.Color.WHITE:cc.Color.GRAY,n=e.getComponent(a.default);e.color=o,n&&(n.canTouch=t);var i=function(e){if(0!=e.children.length)for(var t=0,n=e.children;t<n.length;t++){var r=n[t];r.color=o,i(r)}};i(e)},t=i([f],t)}(c.ComponentExtends));o.default=g,cc._RF.pop()},{"../../../Main":"Main","../../../core/gui/GUI":"GUI","../../../core/ui/ComponentExtends":"ComponentExtends","../../../core/ui/ViewUtils":"ViewUtils","../../../core/ui/button/ButtonEffect":"ButtonEffect","../../../core/util/HashMap":"HashMap","../ShopComponent":"ShopComponent","../effect/LabStepText":"LabStepText"}],NoviceCollectGold:[function(e,t,o){"use strict";cc._RF.push(t,"bc407CjVPVP26zWz8g6t1HU","NoviceCollectGold");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../../core/ui/button/ButtonEffect"),a=e("../../../core/ui/ComponentExtends"),c=e("../../../core/ui/ViewUtils"),s=e("../../../Main"),l=e("../effect/LabStepText"),u=cc._decorator,p=u.ccclass,d=(u.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.onLoad=function(){},t.prototype.panelAnim=function(e,t,o,n){var i=t?-720:720;o&&(e.x=i),e.RunAction(ezaction.scaleTo(.3,{x:o?0:i})).onStoped(function(){n()})},t.prototype.onAdded=function(e){var t=this,o=e.btnNode,n=e.callback,i=c.ViewUtils.nodeTreeInfoLite(this.node);i.get("skeleton").active=!1,i.get("tip").active=!1,s.default.module.mainScene.mapControl.followTargetPos(s.default.module.mainScene.storesNode.getChildByName("store_1"),.2),this.panelAnim(i.get("panel"),!0,!0,function(){i.get("tip").active=!0,i.get("tip").getComponent(l.default).dataId="beginner_3",i.get("tip").getComponent(l.default).changeTo(1,function(){t.node.getChildByName("skeleton").active=!0;var e=cc.instantiate(o);e.active=!0,e.parent=t.node;var r=o.parent.convertToWorldSpaceAR(o.getPosition()),a=t.node.convertToNodeSpaceAR(r);t.node.getChildByName("skeleton").setPosition(a),e.setPosition(a),t.node.getChildByName("skeleton").zIndex=100,e.once(cc.Node.EventType.TOUCH_END,function(){t.panelAnim(i.get("panel"),!0,!1,function(){t.node.destroy()}),n&&n()})})})},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.showButtonEffect=function(e,t){var o=t?cc.Color.WHITE:cc.Color.GRAY,n=e.getComponent(r.default);e.color=o,n&&(n.canTouch=t);var i=function(e){if(0!=e.children.length)for(var t=0,n=e.children;t<n.length;t++){var r=n[t];r.color=o,i(r)}};i(e)},t=i([p],t)}(a.ComponentExtends));o.default=d,cc._RF.pop()},{"../../../Main":"Main","../../../core/ui/ComponentExtends":"ComponentExtends","../../../core/ui/ViewUtils":"ViewUtils","../../../core/ui/button/ButtonEffect":"ButtonEffect","../effect/LabStepText":"LabStepText"}],NoviceFameUp:[function(e,t,o){"use strict";cc._RF.push(t,"2b21fLHVrxEmLga9UyUo4y/","NoviceFameUp");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../../core/ui/button/ButtonEffect"),a=e("../../../core/ui/ComponentExtends"),c=e("../../../core/ui/ViewUtils"),s=e("../../../core/util/HashMap"),l=e("../../../Main"),u=e("../effect/LabStepText"),p=e("../ShopComponent"),d=cc._decorator,h=d.ccclass,f=(d.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.onLoad=function(){},t.prototype.panelAnim=function(e,t,o,n){var i=t?-720:720;o&&(e.x=i),e.RunAction(ezaction.scaleTo(.3,{x:o?0:i})).onStoped(function(){n()})},t.prototype.popCallback=function(e){var t=this,o=c.ViewUtils.nodeTreeInfoLite(this.node);o.get("tip").getComponent(u.default).dataId="beginner_19",o.get("tip").getComponent(u.default).changeTo(1,function(){var n=l.default.module.gameMainControl.popup_container.getChildByName("shop"),i=c.ViewUtils.nodeTreeInfoLite(n.getChildByName("prestige")).get("1").getChildByName("btn_up"),r=cc.instantiate(i);r.active=!0,r.parent=t.node;var a=i.parent.convertToWorldSpaceAR(i.getPosition()),u=t.node.convertToNodeSpaceAR(a);o.get("skeleton").active=!0,o.get("skeleton").zIndex=999,o.get("skeleton").setPosition(u),r.setPosition(u),r.once(cc.Node.EventType.TOUCH_END,function(){r.destroy(),o.get("skeleton").active=!1;var i=new s.HashMap;i.set(1,1);var a=l.default.module.themeConfig.getFameConfigByTagLv("fame_1",1);n.getComponent(p.default).fameLvUp(i,{num:a.price,numE:a.priceE},function(){e&&e(),t.node.destroy()})})})},t.prototype.onAdded=function(e){var t=this,o=e.btnNode,n=e.callback,i=c.ViewUtils.nodeTreeInfoLite(this.node);i.get("skeleton").active=!1,i.get("tip").active=!1,this.panelAnim(i.get("panel"),!0,!0,function(){i.get("tip").active=!0,i.get("tip").getComponent(u.default).dataId="beginner_18",i.get("tip").getComponent(u.default).changeTo(1,function(){if(l.default.module.gameMainControl.popup_container.getChildByName("shop"))t.scheduleOnce(function(){t.popCallback(n)},2),t.node.once(cc.Node.EventType.TOUCH_END,function(){t.popCallback(n),t.unscheduleAllCallbacks()});else{t.node.getChildByName("skeleton").active=!0;var e=cc.instantiate(o);e.active=!0,e.parent=t.node,t.showButtonEffect(e,!0);var r=o.parent.convertToWorldSpaceAR(o.getPosition()),a=t.node.convertToNodeSpaceAR(r);t.node.getChildByName("skeleton").setPosition(a),e.setPosition(a),t.node.getChildByName("skeleton").zIndex=100,e.once(cc.Node.EventType.TOUCH_END,function(){e.destroy(),i.get("skeleton").active=!1,l.default.module.gameMainControl.popup_container.getChildByName("shop")?t.popCallback(n):l.default.module.gameMainControl.openShop(1,function(){t.popCallback(n)})})}})})},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.showButtonEffect=function(e,t){var o=t?cc.Color.WHITE:cc.Color.GRAY,n=e.getComponent(r.default);e.color=o,n&&(n.canTouch=t);var i=function(e){if(0!=e.children.length)for(var t=0,n=e.children;t<n.length;t++){var r=n[t];r.color=o,i(r)}};i(e)},t=i([h],t)}(a.ComponentExtends));o.default=f,cc._RF.pop()},{"../../../Main":"Main","../../../core/ui/ComponentExtends":"ComponentExtends","../../../core/ui/ViewUtils":"ViewUtils","../../../core/ui/button/ButtonEffect":"ButtonEffect","../../../core/util/HashMap":"HashMap","../ShopComponent":"ShopComponent","../effect/LabStepText":"LabStepText"}],NoviceHandle:[function(e,t,o){"use strict";cc._RF.push(t,"b91cdSO3e1I47aeIy4nuLhz","NoviceHandle"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../core/Engine"),i=e("../../../core/gui/GUI"),r=e("../../../core/ui/button/ButtonEffect"),a=e("../../../core/util/AsyncQueue"),c=e("../../../Main"),s=e("../../../service/Service"),l=e("../StoreComponent"),u=function(){return function(){this.novice_1=1,this.novice_2=1,this.novice_3=1,this.novice_4=1,this.novice_5=1,this.novice_6=1,this.novice_7=1,this.novice_8=1,this.novice_9=1,this.novice_10=1,this.novice_11=1,this.novice_12=1,this.novice_13=1,this.novice_0=1,this.novice_start=1}}();o.NoviceProgress=u;var p=function(){return function(){this.progress_1=1,this.progress_2=1,this.progress_3=1,this.progress_4=1,this.progress_5=1,this.progress_6=1,this.progress_7=1,this.progress_8=1}}();o.MainProgress=p;var d=function(){function e(){this.asyncQueue=new a.AsyncQueue,this.storeItemNode=null,this.popViewParams={modal:!0,opacity:100,touchClose:!1},this.noviceLock=!1}return e.prototype.changeNoviceCacheData=function(e){var t=c.default.module.vm.noviceProgress,o={};for(var n in t)n=="novice_"+e&&0==t["novice_"+e]?o["novice_"+e]=1:o[n]=t[n];s.service.analytics.logEvent("novice_adopt","",""),c.default.module.vm.noviceProgress=o,this.noviceLock=!1,c.default.module.gameProtocol.writeCacheData("novice",o,function(t){cc.log("novice_"+e+"\u5f15\u5bfc\u7f13\u5b58\u5199\u5165\u6210\u529f")})},e.prototype.handleStart=function(e){var t=this;if(!this.noviceLock)if(1!=c.default.module.vm.noviceProgress.novice_start){this.noviceLock=!0;i.gui.popup.add("novice/novicestart",{callback:function(){n.default.log.info("novicestart\u6267\u884c\u56de\u8c03"),e&&e(),t.changeNoviceCacheData("start")}},{modal:!0,opacity:150,touchClose:!1})}else this.noviceLock=!1},e.prototype.handle1=function(e,t){var o=this;if(1!=c.default.module.vm.noviceProgress.novice_1){this.noviceLock=!0;i.gui.popup.add("novice/novice1",{callback:function(){t&&t(),o.changeNoviceCacheData(1)},btnNode:e},{modal:!0,opacity:150,touchClose:!1})}else this.noviceLock=!1},e.prototype.handle2=function(e,t){var o=this;if(!this.noviceLock)if(1!=c.default.module.vm.noviceProgress.novice_2){this.noviceLock=!0;c.default.module.mainScene.storesNode.getChildByName("store_1").getComponent(l.default).mainNodes.get("handler").active=!0,i.gui.popup.add("novice/novice2",{callback:function(){t&&t(),o.changeNoviceCacheData(2)},btnNode:e},{modal:!0,opacity:150,touchClose:!1})}else this.noviceLock=!1},e.prototype.noviceUpStore=function(e){var t=this;if(!this.noviceLock)if(1!=c.default.module.vm.noviceProgress.novice_3){c.default.module.mainScene.storesNode.getChildByName("store_1").getComponent(l.default).mainNodes.get("handler").active=!1,this.noviceLock=!0,c.default.module.gameMainControl.openStoreOperation(1);i.gui.popup.add("novice/novice3",{callback:function(){t.changeNoviceCacheData(3),e&&e(),c.default.module.gameMainControl.storeOperation.currentViewStoreId=-1}},{modal:!0,opacity:150,touchClose:!1})}else this.noviceLock=!1},e.prototype.noviceShopClerk=function(e,t){var o=this;if(!this.noviceLock)if(1!=c.default.module.vm.noviceProgress.novice_4){this.noviceLock=!0;i.gui.popup.add("novice/novice4",{btnNode:e,callback:t,noviceCallback:function(){o.changeNoviceCacheData(4)}},{modal:!0,opacity:150,touchClose:!1})}else this.noviceLock=!1},e.prototype.noviceCallengeTask=function(e,t){var o=this;if(!this.noviceLock)if(1!=c.default.module.vm.noviceProgress.novice_5){this.noviceLock=!0;i.gui.popup.add("novice/novice5",{btnNode:e,callback:function(){o.changeNoviceCacheData(5),t&&t()}},{modal:!0,opacity:150,touchClose:!1})}else this.noviceLock=!1},e.prototype.noviceShopping=function(e,t){var o=this;if(!this.noviceLock)if(1!=c.default.module.vm.noviceProgress.novice_6){this.noviceLock=!0;i.gui.popup.add("novice/novice6",{btnNode:e,callback:function(){o.changeNoviceCacheData(6),t&&t()}},{modal:!0,opacity:150,touchClose:!1})}else this.noviceLock=!1},e.prototype.noviceSellStores=function(e,t){var o=this;if(!this.noviceLock)if(1!=c.default.module.vm.noviceProgress.novice_7){this.noviceLock=!0;i.gui.popup.add("novice/novice7",{btnNode:e,callback:function(){o.changeNoviceCacheData(7),t&&t()},nextNoviceCallback:function(){n.default.timer.scheduleOnce(function(){o.noviceMainTask(c.default.module.gameMainControl.mainNodes.get("btn_task"))})}},{modal:!0,opacity:150,touchClose:!1})}else this.noviceLock=!1},e.prototype.noviceMainTask=function(e){var t=this;if(!this.noviceLock)if(1!=c.default.module.vm.noviceProgress.novice_8){this.noviceLock=!0;i.gui.popup.add("novice/novice8",{btnNode:e,callback:function(){t.changeNoviceCacheData(8)}},{modal:!0,opacity:150,touchClose:!1})}else this.noviceLock=!1},e.prototype.novicePackage=function(e,t){var o=this;if(!this.noviceLock)if(1!=c.default.module.vm.noviceProgress.novice_9){this.noviceLock=!0;i.gui.popup.add("novice/novice9",{btnNode:e,callback:function(){o.changeNoviceCacheData(9),t&&t()},nextCallback:function(){o.novicePublicFame()}},{modal:!0,opacity:150,touchClose:!1})}else this.noviceLock=!1},e.prototype.noviceFameUp=function(e,t){var o=this;if(!this.noviceLock)if(1!=c.default.module.vm.noviceProgress.novice_10){this.noviceLock=!0;i.gui.popup.add("novice/novice10",{btnNode:e,callback:function(){o.changeNoviceCacheData(10),t&&t()}},{modal:!0,opacity:150,touchClose:!1})}else this.noviceLock=!1},e.prototype.noviceEnd=function(e){var t=this;if(!this.noviceLock){this.noviceLock=!0;i.gui.popup.add("novice/noviceend",{callback:function(){t.noviceLock=!1,e&&e()}},{modal:!0,opacity:150,touchClose:!1})}},e.prototype.noviceBatchUp=function(e){var t=this;if(!this.noviceLock)if(1!=c.default.module.vm.noviceProgress.novice_11){c.default.module.gameMainControl.openStoreOperation(2);this.noviceLock=!0;i.gui.popup.add("novice/novice11",{callback:function(){t.changeNoviceCacheData(11),e&&e(),c.default.module.gameMainControl.storeOperation.setLvGear(10)}},{modal:!0,opacity:150,touchClose:!1})}else this.noviceLock=!1},e.prototype.noviceNpcClick=function(e){var t=this;if(!this.noviceLock){this.noviceLock=!0;i.gui.popup.add("novice/novice12",{callback:function(){t.changeNoviceCacheData(12),e&&e()}},{modal:!1,touchClose:!1})}},e.prototype.noviceMainTaskOpen=function(e,t){var o=this;if(!this.noviceLock)if(1!=c.default.module.vm.noviceProgress.novice_0){this.noviceLock=!0;i.gui.popup.add("novice/novice0",{callback:function(){o.changeNoviceCacheData(0),t&&t()},btnNode:e},{modal:!0,opacity:150,touchClose:!1})}else this.noviceLock=!1},e.prototype.novicePublicFame=function(e){var t=this;if(!this.noviceLock)if(1!=c.default.module.vm.noviceProgress.novice_13){this.noviceLock=!0;i.gui.popup.add("novice/novice13",{callback:function(){t.changeNoviceCacheData(13),e&&e(),c.default.module.noviceHandle.noviceFameUp(c.default.module.gameMainControl.mainNodes.get("btn_shop"))},btnNode:c.default.module.gameMainControl.mainNodes.get("btn_shop")},{modal:!0,opacity:150,touchClose:!1})}else this.noviceLock=!1},e.prototype.showButtonEffect=function(e,t){var o=t?cc.Color.WHITE:cc.Color.GRAY,n=e.getComponent(r.default);e.color=o,n&&(n.canTouch=t);var i=function(e){if(0!=e.children.length)for(var t=0,n=e.children;t<n.length;t++){var r=n[t];r.color=o,i(r)}};i(e)},e.prototype.playShoppingNoviceEffect=function(e){var t=cc.loader.getRes("main/effect_prefab/shopping_effect",cc.Prefab),o=cc.instantiate(t),i=c.default.module.gameMainControl,r=i.mainNodes.get("diamond_panel").parent.convertToWorldSpaceAR(i.mainNodes.get("diamond_panel").getPosition()),a=i.mainNodes.get("effect").convertToNodeSpaceAR(r);o.parent=e,o.setPosition(a),o.active=!0,o.zIndex=100,n.default.timer.scheduleOnce(function(){o.destroy()},2)},e.prototype.panelAnim=function(e,t,o,n){var i=t?-720:720;o&&(e.x=i),e.RunAction(ezaction.scaleTo(.3,{x:o?0:i})).onStoped(function(){n()})},e}();o.default=d,cc._RF.pop()},{"../../../Main":"Main","../../../core/Engine":"Engine","../../../core/gui/GUI":"GUI","../../../core/ui/button/ButtonEffect":"ButtonEffect","../../../core/util/AsyncQueue":"AsyncQueue","../../../service/Service":"Service","../StoreComponent":"StoreComponent"}],NoviceLockStore:[function(e,t,o){"use strict";cc._RF.push(t,"a9f34BChBtKpqzopF2FxfAD","NoviceLockStore");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../../core/gui/GUI"),a=e("../../../core/ui/button/ButtonEffect"),c=e("../../../core/ui/ComponentExtends"),s=e("../../../core/ui/ViewUtils"),l=e("../../../Main"),u=e("../effect/LabStepText"),p=cc._decorator,d=p.ccclass,h=(p.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.onLoad=function(){},t.prototype.panelAnim=function(e,t,o,n){var i=t?-720:720;o&&(e.x=i),e.RunAction(ezaction.scaleTo(.3,{x:o?0:i})).onStoped(function(){n()})},t.prototype.onAdded=function(e){var t=this,o=e.btnNode,n=e.callback,i=s.ViewUtils.nodeTreeInfoLite(this.node);i.get("skeleton").active=!1,i.get("tip").active=!1,this.panelAnim(i.get("panel"),!0,!0,function(){i.get("tip").getComponent(u.default).dataId="beginner_2",i.get("tip").active=!0,i.get("tip").getComponent(u.default).changeTo(1,function(){t.node.getChildByName("skeleton").active=!0;var e=cc.instantiate(o);e.active=!0,e.parent=t.node;var a=o.parent.convertToWorldSpaceAR(o.getPosition()),c=t.node.convertToNodeSpaceAR(a);t.node.getChildByName("skeleton").setPosition(c),e.setPosition(c),t.node.getChildByName("skeleton").zIndex=100,e.once(cc.Node.EventType.TOUCH_END,function(){e.destroy(),t.panelAnim(i.get("panel"),!0,!1,function(){var e=l.default.module.calcUiShow.calcTargetPrice("store_1",0,1),o={modal:!0,opacity:126,touchClose:!1,onAdded:function(e){var o=e.getChildByName("btn_buy"),n=t.node.getChildByName("skeleton");n.parent=e,t.node.destroy(),n.setPosition(o.getPosition())}};r.gui.popup.add("main/store_unlock",{storeId:1,callback:function(){n&&n()},price:e,active:1},o)})})})})},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.showButtonEffect=function(e,t){var o=t?cc.Color.WHITE:cc.Color.GRAY,n=e.getComponent(a.default);e.color=o,n&&(n.canTouch=t);var i=function(e){if(0!=e.children.length)for(var t=0,n=e.children;t<n.length;t++){var r=n[t];r.color=o,i(r)}};i(e)},t=i([d],t)}(c.ComponentExtends));o.default=h,cc._RF.pop()},{"../../../Main":"Main","../../../core/gui/GUI":"GUI","../../../core/ui/ComponentExtends":"ComponentExtends","../../../core/ui/ViewUtils":"ViewUtils","../../../core/ui/button/ButtonEffect":"ButtonEffect","../effect/LabStepText":"LabStepText"}],NoviceMainTaskEnd:[function(e,t,o){"use strict";cc._RF.push(t,"5b85elOxq9B26DEYK6yNxoE","NoviceMainTaskEnd");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../../core/ui/ComponentExtends"),a=e("../../../core/ui/ViewUtils"),c=e("../effect/LabStepText"),s=cc._decorator,l=s.ccclass,u=(s.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.onLoad=function(){},t.prototype.panelAnim=function(e,t,o,n){var i=t?-720:720;o&&(e.x=i),e.RunAction(ezaction.scaleTo(.3,{x:o?0:i})).onStoped(function(){n()})},t.prototype.onAdded=function(e){var t=this,o=e.callback,n=a.ViewUtils.nodeTreeInfoLite(this.node);n.get("tip").active=!1,this.panelAnim(n.get("panel"),!0,!0,function(){n.get("tip").active=!0,n.get("tip").getComponent(c.default).dataId="beginner_16",n.get("tip").getComponent(c.default).changeTo(1,function(){t.scheduleOnce(function(){o&&o(),t.node.destroy()},2),t.node.once(cc.Node.EventType.TOUCH_END,function(){o&&o(),t.node.destroy(),t.unscheduleAllCallbacks()})})})},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t=i([l],t)}(r.ComponentExtends));o.default=u,cc._RF.pop()},{"../../../core/ui/ComponentExtends":"ComponentExtends","../../../core/ui/ViewUtils":"ViewUtils","../effect/LabStepText":"LabStepText"}],NoviceMainTaskOpen:[function(e,t,o){"use strict";cc._RF.push(t,"ee22be1auJBRoVbfU8DZD4E","NoviceMainTaskOpen");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../../core/ui/ComponentExtends"),a=e("../../../core/ui/ViewUtils"),c=e("../effect/LabStepText"),s=cc._decorator,l=s.ccclass,u=(s.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.onLoad=function(){},t.prototype.panelAnim=function(e,t,o,n){var i=t?-720:720;o&&(e.x=i),e.RunAction(ezaction.scaleTo(.3,{x:o?0:i})).onStoped(function(){n()})},t.prototype.onAdded=function(e){var t=this,o=e.callback,n=(e.btnNode,a.ViewUtils.nodeTreeInfoLite(this.node));n.get("tip").active=!1,this.panelAnim(n.get("panel"),!0,!0,function(){n.get("tip").active=!0,n.get("tip").getComponent(c.default).dataId="beginner_20",n.get("tip").getComponent(c.default).changeTo(1,function(){t.node.once(cc.Node.EventType.TOUCH_END,function(){o&&o(),t.node.destroy()})})})},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t=i([l],t)}(r.ComponentExtends));o.default=u,cc._RF.pop()},{"../../../core/ui/ComponentExtends":"ComponentExtends","../../../core/ui/ViewUtils":"ViewUtils","../effect/LabStepText":"LabStepText"}],NoviceMainTask:[function(e,t,o){"use strict";cc._RF.push(t,"512eenPTydOrJLS4+N6GUM5","NoviceMainTask");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../../core/ui/button/ButtonEffect"),a=e("../../../core/ui/ComponentExtends"),c=e("../../../core/ui/ExToggleGroup"),s=e("../../../core/ui/ViewUtils"),l=e("../../../Main"),u=e("../effect/LabStepText"),p=e("../TaskComponent"),d=cc._decorator,h=d.ccclass,f=(d.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.onLoad=function(){},t.prototype.panelAnim=function(e,t,o,n){var i=t?-720:720;o&&(e.x=i),e.RunAction(ezaction.scaleTo(.3,{x:o?0:i})).onStoped(function(){n()})},t.prototype.onAdded=function(e){var t=this,o=e.callback,n=e.btnNode,i=s.ViewUtils.nodeTreeInfoLite(this.node);i.get("skeleton").active=!1,i.get("tip").active=!1,this.panelAnim(i.get("panel"),!0,!0,function(){i.get("tip").active=!0,i.get("tip").getComponent(u.default).dataId="prompt_1",i.get("tip").getComponent(u.default).changeTo(1,function(){t.node.getChildByName("skeleton").active=!0;var e=cc.instantiate(n);e.active=!0,e.parent=t.node,t.showButtonEffect(e,!0);var i=n.parent.convertToWorldSpaceAR(n.getPosition()),r=t.node.convertToNodeSpaceAR(i);t.node.getChildByName("skeleton").setPosition(r),e.setPosition(r),t.node.getChildByName("skeleton").zIndex=100,e.once(cc.Node.EventType.TOUCH_END,function(){e.destroy(),l.default.module.gameMainControl.openMainPop("btn_task",function(){var e=l.default.module.gameMainControl.popup_container.getChildByName("task");e.getComponent(p.default).mainNodes.get("toggle_group").getComponent(c.default).setIndex(1),e.getComponent(p.default).switchTag("2"),t.node.destroy(),o&&o()})})})})},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.showButtonEffect=function(e,t){var o=t?cc.Color.WHITE:cc.Color.GRAY,n=e.getComponent(r.default);e.color=o,n&&(n.canTouch=t);var i=function(e){if(0!=e.children.length)for(var t=0,n=e.children;t<n.length;t++){var r=n[t];r.color=o,i(r)}};i(e)},t=i([h],t)}(a.ComponentExtends));o.default=f,cc._RF.pop()},{"../../../Main":"Main","../../../core/ui/ComponentExtends":"ComponentExtends","../../../core/ui/ExToggleGroup":"ExToggleGroup","../../../core/ui/ViewUtils":"ViewUtils","../../../core/ui/button/ButtonEffect":"ButtonEffect","../TaskComponent":"TaskComponent","../effect/LabStepText":"LabStepText"}],NoviceNpcClick:[function(e,t,o){"use strict";cc._RF.push(t,"71a5fo55opB1YjqKtV9dwix","NoviceNpcClick");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../../core/ui/ComponentExtends"),a=e("../../../core/ui/ViewUtils"),c=e("../../../Main"),s=e("../effect/LabStepText"),l=cc._decorator,u=l.ccclass,p=(l.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.onLoad=function(){},t.prototype.panelAnim=function(e,t,o,n){var i=t?-720:720;o&&(e.x=i),e.RunAction(ezaction.scaleTo(.3,{x:o?0:i})).onStoped(function(){n()})},t.prototype.onAdded=function(e){var t=this,o=e.callback,n=a.ViewUtils.nodeTreeInfoLite(this.node);n.get("tip").active=!1,this.panelAnim(n.get("panel"),!0,!0,function(){n.get("tip").active=!0;var e=1==c.default.module.vm.noviceProgress.novice_12?"beginner_22":"beginner_26";n.get("tip").getComponent(s.default).dataId=e,n.get("tip").getComponent(s.default).changeTo(1,function(){t.node.once(cc.Node.EventType.TOUCH_END,function(){o&&o(),t.node.destroy()})})})},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t=i([u],t)}(r.ComponentExtends));o.default=p,cc._RF.pop()},{"../../../Main":"Main","../../../core/ui/ComponentExtends":"ComponentExtends","../../../core/ui/ViewUtils":"ViewUtils","../effect/LabStepText":"LabStepText"}],NovicePackage:[function(e,t,o){"use strict";cc._RF.push(t,"28ff32+8VBPhLZECH/cdmyT","NovicePackage");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../../core/event/MessageManager"),a=e("../../../core/gui/GUI"),c=e("../../../core/ui/button/ButtonEffect"),s=e("../../../core/ui/ComponentExtends"),l=e("../../../core/ui/ViewUtils"),u=e("../../../Main"),p=e("../../AudioMessage"),d=e("../effect/LabStepText"),h=e("../PackageListItem"),f=cc._decorator,g=f.ccclass,m=(f.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.onLoad=function(){},t.prototype.panelAnim=function(e,t,o,n){var i=t?-720:720;o&&(e.x=i),e.RunAction(ezaction.scaleTo(.3,{x:o?0:i})).onStoped(function(){n()})},t.prototype.onAdded=function(e){var t=this,o=e.callback,n=e.nextCallback,i=e.btnNode,c=l.ViewUtils.nodeTreeInfoLite(this.node);c.get("skeleton").active=!1,c.get("tip").active=!1,this.node.zIndex=999,this.panelAnim(c.get("panel"),!0,!0,function(){c.get("tip").active=!0,c.get("tip").getComponent(d.default).dataId="beginner_17",c.get("tip").getComponent(d.default).changeTo(1,function(){t.node.getChildByName("skeleton").active=!0;var e=cc.instantiate(i);e.active=!0,e.parent=t.node,t.showButtonEffect(e,!0);var s=i.parent.convertToWorldSpaceAR(i.getPosition()),d=t.node.convertToNodeSpaceAR(s);t.node.getChildByName("skeleton").setPosition(d),e.setPosition(d),t.node.getChildByName("skeleton").zIndex=100,e.once(cc.Node.EventType.TOUCH_END,function(){e.destroy(),u.default.module.gameMainControl.openMainPop("btn_package",function(){t.scheduleOnce(function(){var e=u.default.module.gameMainControl.popup_container.getChildByName("package"),i=l.ViewUtils.nodeTreeInfoLite(e).get("content").children[0],s=i.getChildByName("btn_package"),d=cc.instantiate(s);d.active=!0,d.parent=t.node;var f=s.parent.convertToWorldSpaceAR(s.getPosition()),g=t.node.convertToNodeSpaceAR(f);c.get("skeleton").active=!0,c.get("skeleton").zIndex=99,c.get("skeleton").setPosition(g),d.setPosition(g),d.once(cc.Node.EventType.TOUCH_END,function(){d.destroy(),c.get("skeleton").active=!1,r.Message.dispatchEvent(p.AudioMessage.EFFECT,"alt"),c.get("panel").active=!1,a.gui.delete(e);var s={modal:!0,opacity:150,touchClose:!1,onAdded:function(e){var n=l.ViewUtils.nodeTreeInfoLite(e);c.get("skeleton").parent=n.get("btn_ok"),c.get("skeleton").active=!0,c.get("skeleton").setPosition(0,0),o&&o(),t.node.destroy()},onRemoved:function(){n&&n()}},f=i.getComponent(h.default);f.clickCallback(f.params,f.reward,f,!1),a.gui.popup.add("popup/prop_result",{params:f.params,reward:f.reward},s),u.default.module.calcUiShow.refreshCredit(f.reward,function(){},!0)})},.3)})})})})},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.showButtonEffect=function(e,t){var o=t?cc.Color.WHITE:cc.Color.GRAY,n=e.getComponent(c.default);e.color=o,n&&(n.canTouch=t);var i=function(e){if(0!=e.children.length)for(var t=0,n=e.children;t<n.length;t++){var r=n[t];r.color=o,i(r)}};i(e)},t=i([g],t)}(s.ComponentExtends));o.default=m,cc._RF.pop()},{"../../../Main":"Main","../../../core/event/MessageManager":"MessageManager","../../../core/gui/GUI":"GUI","../../../core/ui/ComponentExtends":"ComponentExtends","../../../core/ui/ViewUtils":"ViewUtils","../../../core/ui/button/ButtonEffect":"ButtonEffect","../../AudioMessage":"AudioMessage","../PackageListItem":"PackageListItem","../effect/LabStepText":"LabStepText"}],NovicePublicFame:[function(e,t,o){"use strict";cc._RF.push(t,"f8d29TlfftJyafahvnXCacM","NovicePublicFame");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../../core/ui/button/ButtonEffect"),a=e("../../../core/ui/ComponentExtends"),c=e("../../../core/ui/ViewUtils"),s=e("../../../Main"),l=e("../effect/LabStepText"),u=e("../FameGetComponent"),p=cc._decorator,d=p.ccclass,h=(p.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.onLoad=function(){},t.prototype.panelAnim=function(e,t,o,n){var i=t?-720:720;o&&(e.x=i),e.RunAction(ezaction.scaleTo(.3,{x:o?0:i})).onStoped(function(){n()})},t.prototype.onAdded=function(e){var t=this,o=e.callback,n=e.btnNode,i=c.ViewUtils.nodeTreeInfoLite(this.node);i.get("skeleton").active=!1,i.get("tip").active=!1,this.panelAnim(i.get("panel"),!0,!0,function(){i.get("tip").active=!0,i.get("tip").getComponent(l.default).dataId="beginner_25",i.get("tip").getComponent(l.default).changeTo(1,function(){t.node.getChildByName("skeleton").active=!0;var e=cc.instantiate(n);e.active=!0,e.parent=t.node,t.showButtonEffect(e,!0);var r=n.parent.convertToWorldSpaceAR(n.getPosition()),a=t.node.convertToNodeSpaceAR(r);t.node.getChildByName("skeleton").setPosition(a),e.setPosition(a),t.node.getChildByName("skeleton").zIndex=100,e.once(cc.Node.EventType.TOUCH_END,function(){e.destroy(),t.node.getChildByName("skeleton").active=!1,s.default.module.gameMainControl.openShop(1,function(){var e=s.default.module.gameMainControl.popup_container.getChildByName("shop");i.get("tip").getComponent(l.default).dataId="beginner_15",i.get("tip").getComponent(l.default).changeTo(1,function(){var n=c.ViewUtils.nodeTreeInfoLite(e),r=n.get("btn_get"),a=r.parent.convertToWorldSpaceAR(r.getPosition()),s=t.node.convertToNodeSpaceAR(a),l=cc.instantiate(r);l.active=!0,l.parent=t.node,i.get("skeleton").active=!0,i.get("skeleton").zIndex=100,i.get("skeleton").setPosition(s),l.setPosition(s),l.once(cc.Node.EventType.TOUCH_END,function(){i.get("skeleton").active=!1,l.destroy(),t.node.destroy(),n.get("public_get").getComponent(u.default).getFameCallback(o)})})})})})})},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.showButtonEffect=function(e,t){var o=t?cc.Color.WHITE:cc.Color.GRAY,n=e.getComponent(r.default);e.color=o,n&&(n.canTouch=t);var i=function(e){if(0!=e.children.length)for(var t=0,n=e.children;t<n.length;t++){var r=n[t];r.color=o,i(r)}};i(e)},t=i([d],t)}(a.ComponentExtends));o.default=h,cc._RF.pop()},{"../../../Main":"Main","../../../core/ui/ComponentExtends":"ComponentExtends","../../../core/ui/ViewUtils":"ViewUtils","../../../core/ui/button/ButtonEffect":"ButtonEffect","../FameGetComponent":"FameGetComponent","../effect/LabStepText":"LabStepText"}],NoviceSellStores:[function(e,t,o){"use strict";cc._RF.push(t,"47e726yuVJApZJw7o83Ur2x","NoviceSellStores");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../../core/ui/button/ButtonEffect"),a=e("../../../core/ui/ComponentExtends"),c=e("../../../core/ui/ViewUtils"),s=e("../../../Main"),l=e("../effect/LabStepText"),u=e("../WorldMapComponent"),p=cc._decorator,d=p.ccclass,h=(p.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.onLoad=function(){},t.prototype.panelAnim=function(e,t,o,n){var i=t?-720:720;o&&(e.x=i),e.RunAction(ezaction.scaleTo(.3,{x:o?0:i})).onStoped(function(){n()})},t.prototype.onAdded=function(e){var t=this,o=e.btnNode,n=e.callback,i=e.nextNoviceCallback,r=c.ViewUtils.nodeTreeInfoLite(this.node);r.get("skeleton").active=!1,r.get("tip_girl").active=!1,r.get("tip_girl").active=!1,this.panelAnim(r.get("panel_girl"),!0,!0,function(){r.get("tip_girl").active=!0,r.get("tip_girl").getComponent(l.default).dataId="beginner_13",r.get("tip_girl").getComponent(l.default).changeTo(1,function(){t.node.getChildByName("skeleton").active=!0;var e=cc.instantiate(o);e.active=!0,e.parent=t.node,t.showButtonEffect(e,!0);var a=o.parent.convertToWorldSpaceAR(o.getPosition()),p=t.node.convertToNodeSpaceAR(a);t.node.getChildByName("skeleton").setPosition(p),e.setPosition(p),t.node.getChildByName("skeleton").zIndex=100,e.once(cc.Node.EventType.TOUCH_END,function(){e.destroy(),t.panelAnim(r.get("panel_girl"),!0,!1,function(){t.panelAnim(r.get("panel_man"),!1,!0,function(){r.get("skeleton").active=!1,s.default.module.gameMainControl.openMainPop("btn_world",function(){r.get("tip_man").active=!0,r.get("tip_man").getComponent(l.default).dataId="beginner_14",r.get("tip_man").getComponent(l.default).changeTo(1,function(){var e=s.default.module.gameMainControl.popup_container.getChildByName("word_map"),o=c.ViewUtils.nodeTreeInfoLite(e).get("btn_pass"),a=cc.instantiate(o);a.active=!0,a.parent=t.node,t.showButtonEffect(a,!0);var l=o.parent.convertToWorldSpaceAR(o.getPosition()),p=t.node.convertToNodeSpaceAR(l);a.setPosition(p),r.get("skeleton").active=!0,r.get("skeleton").zIndex=999,r.get("skeleton").setPosition(p),a.once(cc.Node.EventType.TOUCH_END,function(){t.panelAnim(r.get("panel_man"),!1,!1,function(){t.node.destroy(),e.getComponent(u.default).btnPassHandler(n,i)})})})})})})})})})},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.showButtonEffect=function(e,t){var o=t?cc.Color.WHITE:cc.Color.GRAY,n=e.getComponent(r.default);e.color=o,n&&(n.canTouch=t);var i=function(e){if(0!=e.children.length)for(var t=0,n=e.children;t<n.length;t++){var r=n[t];r.color=o,i(r)}};i(e)},t=i([d],t)}(a.ComponentExtends));o.default=h,cc._RF.pop()},{"../../../Main":"Main","../../../core/ui/ComponentExtends":"ComponentExtends","../../../core/ui/ViewUtils":"ViewUtils","../../../core/ui/button/ButtonEffect":"ButtonEffect","../WorldMapComponent":"WorldMapComponent","../effect/LabStepText":"LabStepText"}],NoviceShopping:[function(e,t,o){"use strict";cc._RF.push(t,"ccb5bRl/DBLIb8yfZlFeFQI","NoviceShopping");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../../core/gui/GUI"),a=e("../../../core/ui/button/ButtonEffect"),c=e("../../../core/ui/ComponentExtends"),s=e("../../../core/ui/ViewUtils"),l=e("../../../Main"),u=e("../effect/LabStepText"),p=cc._decorator,d=p.ccclass,h=(p.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.onLoad=function(){},t.prototype.panelAnim=function(e,t,o,n){var i=t?-720:720;o&&(e.x=i),e.RunAction(ezaction.scaleTo(.3,{x:o?0:i})).onStoped(function(){n()})},t.prototype.onAdded=function(e){var t=this,o=e.callback,n=e.btnNode,i=s.ViewUtils.nodeTreeInfoLite(this.node);i.get("skeleton").active=!1,i.get("tip").active=!1,this.panelAnim(i.get("panel"),!0,!0,function(){i.get("tip").active=!0,i.get("tip").getComponent(u.default).dataId="beginner_11",i.get("tip").getComponent(u.default).changeTo(1,function(){t.node.getChildByName("skeleton").active=!0;var e=cc.instantiate(n);e.active=!0,e.parent=t.node,t.showButtonEffect(e,!0);var a=n.parent.convertToWorldSpaceAR(n.getPosition()),c=t.node.convertToNodeSpaceAR(a);t.node.getChildByName("skeleton").setPosition(c),e.setPosition(c),t.node.getChildByName("skeleton").zIndex=100,e.once(cc.Node.EventType.TOUCH_END,function(){e.destroy(),t.node.getChildByName("skeleton").active=!1,l.default.module.gameMainControl.openMainPop("btn_shopping",function(){var e=l.default.module.gameMainControl.popup_container.getChildByName("shopping");if(l.default.module.vm.diamond<60)return r.gui.delete(e),t.node.destroy(),void(o&&o());i.get("tip").getComponent(u.default).dataId="beginner_12",i.get("tip").getComponent(u.default).changeTo(1,function(){var n=s.ViewUtils.nodeTreeInfoLite(e).get("8").getChildByName("btn_buy"),a=n.parent.convertToWorldSpaceAR(n.getPosition()),c=t.node.convertToNodeSpaceAR(a),u=cc.instantiate(n);u.active=!0,u.parent=t.node,i.get("skeleton").active=!0,i.get("skeleton").zIndex=100,i.get("skeleton").setPosition(c),u.setPosition(c),u.once(cc.Node.EventType.TOUCH_END,function(){l.default.module.gameProtocol.requestDiamondInfo(8,function(n){var a={modal:!0,opacity:150,onAdded:function(e){var o=s.ViewUtils.nodeTreeInfoLite(e).get("btn_ok");i.get("skeleton").parent=o,i.get("skeleton").setPosition(0,0),t.node.destroy(),l.default.module.calcUiShow.refreshCredit(d,function(){},!0)},onRemoved:function(){o&&o()}},c=n.goodsInfo.value,u=n.goodsInfo.goodsType;r.gui.delete(e);var p=l.default.module.vm,d=l.default.module.calcUiShow.getTimeStageReward(43200);r.gui.popup.add("popup/shopping_result",{id:8,goodsType:u,reward:d,value:c},a),p.diamond=n.userAccount.credit,n.goodsData&&(p.goodsInfo=n.goodsData)})})})})})})})},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.showButtonEffect=function(e,t){var o=t?cc.Color.WHITE:cc.Color.GRAY,n=e.getComponent(a.default);e.color=o,n&&(n.canTouch=t);var i=function(e){if(0!=e.children.length)for(var t=0,n=e.children;t<n.length;t++){var r=n[t];r.color=o,i(r)}};i(e)},t=i([d],t)}(c.ComponentExtends));o.default=h,cc._RF.pop()},{"../../../Main":"Main","../../../core/gui/GUI":"GUI","../../../core/ui/ComponentExtends":"ComponentExtends","../../../core/ui/ViewUtils":"ViewUtils","../../../core/ui/button/ButtonEffect":"ButtonEffect","../effect/LabStepText":"LabStepText"}],NoviceStart:[function(e,t,o){"use strict";cc._RF.push(t,"b0d46Cf6AhF64iDcM/eYt3q","NoviceStart");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../../core/ui/ComponentExtends"),a=e("../../../core/ui/ViewUtils"),c=e("../effect/LabStepText"),s=cc._decorator,l=s.ccclass,u=(s.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.onLoad=function(){},t.prototype.panelAnim=function(e,t,o,n){var i=t?-720:720;o&&(e.x=i),e.RunAction(ezaction.scaleTo(.3,{x:o?0:i})).onStoped(function(){n()})},t.prototype.onAdded=function(e){var t=this,o=e.callback,n=a.ViewUtils.nodeTreeInfoLite(this.node);n.get("tip").active=!1,n.get("btn_start").active=!1,this.panelAnim(n.get("panel"),!0,!0,function(){n.get("tip").active=!0,n.get("tip").getComponent(c.default).dataId="beginner_1",n.get("tip").getComponent(c.default).changeTo(1,function(){n.get("btn_start").active=!0,n.get("btn_start").on(cc.Node.EventType.TOUCH_END,function(){o&&o(),t.node.destroy()})})})},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t=i([l],t)}(r.ComponentExtends));o.default=u,cc._RF.pop()},{"../../../core/ui/ComponentExtends":"ComponentExtends","../../../core/ui/ViewUtils":"ViewUtils","../effect/LabStepText":"LabStepText"}],NoviceStoreUpLv:[function(e,t,o){"use strict";cc._RF.push(t,"74d3388KF5IqLq+knw6yo1y","NoviceStoreUpLv");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../../core/ui/button/ButtonEffect"),a=e("../../../core/ui/button/ButtonEffectAnim"),c=e("../../../core/ui/ComponentExtends"),s=e("../../../core/ui/label/LabelChangeSymbol"),l=e("../../../core/ui/ViewUtils"),u=e("../../../Main"),p=e("../effect/LabStepText"),d=cc._decorator,h=d.ccclass,f=(d.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.onLoad=function(){},t.prototype.panelAnim=function(e,t,o,n){var i=t?-720:720;o&&(e.x=i),e.RunAction(ezaction.scaleTo(.3,{x:o?0:i})).onStoped(function(){n()})},t.prototype.onAdded=function(e){var t=this,o=e.callback,n=u.default.module.gameMainControl.storeOperation,i=l.ViewUtils.nodeTreeInfoLite(this.node);i.get("skeleton").active=!1,i.get("tip").active=!1,this.panelAnim(i.get("panel"),!0,!0,function(){i.get("tip").active=!0,i.get("tip").getComponent(p.default).dataId="beginner_4",i.get("tip").getComponent(p.default).changeTo(1,function(){t.node.getChildByName("skeleton").active=!0;var e=l.ViewUtils.nodeTreeInfoLite(n.node).get("btn_up"),i=cc.instantiate(e);i.active=!0,i.parent=t.node,i.removeComponent(a.default),i.addComponent(r.default),t.showButtonEffect(i,!0),i.getChildByName("price").getChildByName("price_lab").getComponent(s.LabelChangeSymbol).num={num:4,numE:0};var c=e.parent.convertToWorldSpaceAR(e.getPosition()),u=t.node.convertToNodeSpaceAR(c);t.node.getChildByName("skeleton").setPosition(u),i.setPosition(u),t.node.getChildByName("skeleton").zIndex=100,i.once(cc.Node.EventType.TOUCH_END,function(){t.node.destroy(),o&&o()})})})},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.showButtonEffect=function(e,t){var o=t?cc.Color.WHITE:cc.Color.GRAY,n=e.getComponent(r.default);e.color=o,n&&(n.canTouch=t);var i=function(e){if(0!=e.children.length)for(var t=0,n=e.children;t<n.length;t++){var r=n[t];r.color=o,i(r)}};i(e)},t=i([h],t)}(c.ComponentExtends));o.default=f,cc._RF.pop()},{"../../../Main":"Main","../../../core/ui/ComponentExtends":"ComponentExtends","../../../core/ui/ViewUtils":"ViewUtils","../../../core/ui/button/ButtonEffect":"ButtonEffect","../../../core/ui/button/ButtonEffectAnim":"ButtonEffectAnim","../../../core/ui/label/LabelChangeSymbol":"LabelChangeSymbol","../effect/LabStepText":"LabStepText"}],NpcClickComponent:[function(e,t,o){"use strict";cc._RF.push(t,"019fa9FMulLU4+7H8RZv3VI","NpcClickComponent");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r,a=e("../../../core/Engine"),c=e("../../../core/event/MessageManager"),s=e("../../../core/ui/ComponentExtends"),l=e("../../../core/ui/ViewUtils"),u=e("../../../core/util/AsyncQueue"),p=e("../../../Main"),d=e("../../../map/charactor/Charactor"),h=e("../../../service/Service"),f=e("../../AudioMessage"),g=e("../../CalcUiShow"),m=cc._decorator,v=m.ccclass,_=(m.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.initTime=0,t.rewardTimesSpan=0,t.dataIdsMove=[],t.dataIdsDoor=[],t.npcId=1,t.preRewardTime=0,t.canClick=!0,t}return n(t,e),t.prototype.onLoad=function(){this.initTime=p.default.module.calcUiShow.getSeverCurrentTime()},t.prototype.showSkeleton=function(e){var t=this,o=this.node.getChildByName("skeleton").getComponent(sp.Skeleton);o.node.active=!1,cc.loader.loadRes("animator/npc/npc_"+e+"/npc_"+e,sp.SkeletonData,function(n,i){n&&1!=e?t.showSkeleton(1):n?cc.error(n):("3"!=e&&"5"!=e||o.isValid&&(o.premultipliedAlpha=!0),o.skeletonData=i,o.node.active=!0)})},t.prototype.initDataIds=function(e){for(var t=1;t<10;t++){var o="npc_stand_"+e+"_"+t;a.default.i18n.getLangByID(o)&&this.dataIdsMove.push(o)}},t.prototype.initClickEvent=function(e){var t=this;this.npcId=e;var o=l.ViewUtils.nodeTreeInfoLite(this.node),n=this.node.getChildByName("qipao"),i=this.node.getChildByName("npc_colid");n.active=!1,this.node.getChildByName("click_effect").active=!1,this.node.getChildByName("click_skeleton").active=!1;var r=this.node.getChildByName("qipao").getChildByName("qipao_skeleton").getComponent(sp.Skeleton);if(3==e||5==e||7==e||9==e){if(3!=this.npcId&&5!=this.npcId||(3==this.npcId&&(this.node.getChildByName("click_skeleton").scale=1,this.node.getChildByName("click_effect").y=10,this.node.getChildByName("click_skeleton").y=-5,this.node.getChildByName("click_skeleton").x=-5,n.y=30,n.width=90,r.node.y=35,i.y=15,i.width=70),5==this.npcId&&(this.node.getChildByName("click_skeleton").scaleX=1.4,this.node.getChildByName("click_skeleton").scaleY=1,this.node.getChildByName("click_effect").y=20,this.node.getChildByName("click_skeleton").x=-5,n.y=45,n.width=95,r.node.y=35,i.y=15,i.width=80)),7==this.npcId&&(n.y=40,r.node.y=65,n.width=85,n.height=160,this.node.getChildByName("click_skeleton").scaleX=.8,this.node.getChildByName("click_skeleton").scaleY=1.6,this.node.getChildByName("click_effect").y=10,i.y=20,i.width=60,i.height=160),9==this.npcId&&(n.y=50,r.node.y=95,n.width=120,n.height=210,this.node.getChildByName("click_skeleton").scaleX=1.5,this.node.getChildByName("click_skeleton").scaleY=1.9,this.node.getChildByName("click_effect").y=100,this.node.getChildByName("click_skeleton").y=10,i.y=25,i.width=120,i.height=210),7==this.npcId){var a=cc.loader.getRes("main/skeleton/qipao_guanggao",sp.SkeletonData);r.skeletonData=a}else if(3==this.npcId||5==this.npcId){a=cc.loader.getRes("main/skeleton/qipao_hongxin",sp.SkeletonData);r.skeletonData=a}else if(9==this.npcId){a=cc.loader.getRes("main/skeleton/qipao_dianzan",sp.SkeletonData);r.skeletonData=a}r.setCompleteListener(function(e){"reward_fadein"==e.animation.name&&r.setAnimation(0,"reward_loop",!0)})}else o.get("handler").destroy(),this.node.getChildByName("click_skeleton").destroy(),this.node.getChildByName("click_effect").destroy();n.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd.bind(this),this),this.node.on(cc.Node.EventType.TOUCH_END,function(){var e="";switch(t.npcId){case 1:case 6:case 7:case 8:case 9:case 10:e="man_"+t.getRandomNum(1,4);break;case 2:case 4:e="woman_"+t.getRandomNum(1,4);break;case 5:h.service.analytics.logEvent("npc_click_cat","",""),e="dog_"+t.getRandomNum(1,2);break;case 3:h.service.analytics.logEvent("npc_click_dog","",""),e="cat_"+ +t.getRandomNum(1,2)}9==t.npcId&&h.service.analytics.logEvent("npc_click_takeaway","",""),7==t.npcId&&h.service.analytics.logEvent("npc_click_advocate","",""),c.Message.dispatchEvent(f.AudioMessage.EFFECT,e)},this),this.initRewardTimesSpan(e),this.showSkeleton(e),this.randomLabAnimStand()},t.prototype.randomLabAnimStand=function(){var e=this;3!=this.npcId&&5!=this.npcId&&7!=this.npcId&&9!=this.npcId&&(this.unscheduleAllCallbacks(),this.schedule(function(){var t=e.node.getChildByName("emoticon").getComponent(sp.Skeleton);t.setSkin("npc_"+e.npcId),t.setAnimation(0,"reward",!1)},20+8*this.npcId))},t.prototype.initRewardTimesSpan=function(e){3!=this.npcId&&5!=this.npcId&&7!=this.npcId&&9!=this.npcId||(this.rewardTimesSpan=10*this.npcId*1e3)},t.prototype.onTouchEnd=function(e,t){var o=this,n=e.getLocation();if(p.default.module.gameMainControl.checkCollidPoints(n))cc.log("onTouchEnd:\u70b9\u51fb\u78b0\u649e\u5728\u5730\u6807\u4e0a\uff0c\u4e0d\u89e6\u53d1npc\u70b9\u51fb\u56de\u8c03");else if(this.canClick){this.canClick=!1,cc.log("\u70b9\u51fbnpc_"+this.npcId+"\u7231\u5fc3");var i=p.default.module.calcUiShow.getTimeStageReward(6e3);if(0==i.num&&0==i.numE&&(i={num:1,numE:3}),this.node.getChildByName("qipao").active=!1,this.node.getChildByName("click_effect").active=!1,this.node.getChildByName("click_skeleton").active=!1,0==p.default.module.vm.mainProgress.progress_5)c.Message.dispatchEvent(r.REMOVE_CAN_CLICK,this.npcId),l.ViewUtils.nodeTreeInfoLite(this.node).get("handler").active=!1;switch(1==p.default.module.vm.mainProgress.progress_7&&(c.Message.dispatchEvent(r.NPC_FAME,this.npcId),p.default.module.gamedata.fameNpcNum+=1,cc.sys.localStorage.setItem("fameNpcNum",p.default.module.gamedata.fameNpcNum)),this.npcId){case 7:i=p.default.module.calcTool.calcMutiNum({num:5,numE:0},i);var a=p.default.module.calcTool.formatNum(i);cc.log("\u91d1\u5e01\u7ffb\u4e94\u500d\u7ed3\u679c:"+a.base+a.gear),this.onTouchEndCallback(i);break;case 3:case 5:var s=this.node.getChildByName("skeleton").getComponent(sp.Skeleton),h=s.animation,f=u.AsyncQueue.excuteTimes(2,function(){s.setAnimation(0,h,!0),o.node.getComponent(d.default).stopAndMove()});s.setCompleteListener(function(e){"reward_show_1"==e.animation.name&&(s.setCompleteListener(function(e){}),f())}),this.node.getComponent(d.default).down(),0==i.num&&0==i.numE&&(i={num:1,numE:3}),this.onTouchEndCallback(i),f();var m=p.default.module.calcUiShow.changeTaskListByTypeCount(g.TaskType.LUCKY_reward,1);p.default.module.gameProtocol.sendTaskList(m,function(e){p.default.module.vm.taskList=m});break;case 9:this.onTouchEndCallback(),p.default.module.gameMainControl.playPackageffect()}}else cc.log("onTouchEnd:\u70b9\u51fb\u7231\u5fc3\uff0c\u6b63\u5728\u751f\u6548\u4e0d\u53ef\u91cd\u590d\u70b9\u51fb")},t.prototype.taskCount=function(){},t.prototype.onTouchEndCallback=function(e){this.initTime=p.default.module.calcUiShow.getSeverCurrentTime(),this.canClick=!0,e&&p.default.module.gameMainControl.playCreditEffect(e,function(){p.default.module.calcUiShow.refreshCredit(e,function(){},!0)})},t.prototype.qipaoAnim=function(){this.unscheduleAllCallbacks();var e=l.ViewUtils.nodeTreeInfoLite(this.node);0==p.default.module.vm.mainProgress.progress_5?(c.Message.dispatchEvent(r.ADD_CAN_CLICK,this.npcId),e.get("handler").active=!0):e.get("handler")&&e.get("handler").destroy(),this.node.getChildByName("qipao").active=!0,this.node.getChildByName("qipao").getChildByName("qipao_skeleton").getComponent(sp.Skeleton).setAnimation(0,"reward_fadein",!1),this.node.getChildByName("click_effect").active=!0,this.node.getChildByName("click_skeleton").active=!0},t.prototype.update=function(e){var t=p.default.module.calcUiShow.getSeverCurrentTime();if(3==this.npcId||5==this.npcId||7==this.npcId||9==this.npcId){var o=this.node.getChildByName("qipao");t-this.initTime>=this.rewardTimesSpan&&!o.active&&this.canClick&&this.qipaoAnim()}},t.prototype.getRandomNum=function(e,t){return Math.round(Math.random()*(t-e)+e)},t.prototype.onDestroy=function(){this.unscheduleAllCallbacks();var t=this.node.getChildByName("qipao");t&&t.off(cc.Node.EventType.TOUCH_END,this.onTouchEnd.bind(this),this),c.Message.removeEventTarget(this),this.rewardTimesSpan=null,this.preRewardTime=null,this.initTime=null,this.dataIdsMove=null,this.dataIdsDoor=null,this.npcId=null,this.node.targetOff(this),e.prototype.onDestroy.call(this)},t=i([v],t)}(s.ComponentExtends));o.default=_,function(e){e.ADD_CAN_CLICK="add_can_click",e.REMOVE_CAN_CLICK="remove_can_click",e.NPC_FAME="npc_fame"}(r=o.NPC_EVENT||(o.NPC_EVENT={})),cc._RF.pop()},{"../../../Main":"Main","../../../core/Engine":"Engine","../../../core/event/MessageManager":"MessageManager","../../../core/ui/ComponentExtends":"ComponentExtends","../../../core/ui/ViewUtils":"ViewUtils","../../../core/util/AsyncQueue":"AsyncQueue","../../../map/charactor/Charactor":"Charactor","../../../service/Service":"Service","../../AudioMessage":"AudioMessage","../../CalcUiShow":"CalcUiShow"}],Observer:[function(e,t,o){"use strict";cc._RF.push(t,"8548bSwoR9MtY+xjREpip3A","Observer"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(e,t){this.data=null,this.lock=!1,this.data=e,this.propertyChangeCallback=t,this.walk(e)}return e.prototype.walk=function(e){var t=this;Object.keys(e).forEach(function(o){t.defineReactive(e,o,e[o])})},e.prototype.defineReactive=function(e,t,o){var n=this.propertyChangeCallback,i=o,r=this;Object.defineProperty(e,t,{enumerable:!0,configurable:!1,get:function(){return i},set:function(o){if(!r.lock){var a=i;i=o,n&&n(e,t,a,o)}}})},e.prototype.release=function(){this.data=null,this.propertyChangeCallback=null},e}();o.Observer=n,cc._RF.pop()},{}],OfffLineRewardPrompt:[function(e,t,o){"use strict";cc._RF.push(t,"80bceYKAitMoLOme+K4ijta","OfffLineRewardPrompt");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../core/event/MessageManager"),a=e("../../core/ui/button/ButtonEffect"),c=e("../../core/ui/button/ButtonEffectSprite"),s=e("../../core/ui/ComponentExtends"),l=e("../../core/ui/label/LabelChangeSymbol"),u=e("../../core/ui/ViewUtils"),p=e("../../Main"),d=e("../../service/Service"),h=e("../CalcUiShow"),f=e("./adv/AdvControl"),g=e("./effect/LabTouchFont"),m=cc._decorator,v=m.ccclass,_=(m.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.reward=null,t}return n(t,e),t.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchHandler,this)},t.prototype.onAdded=function(e){var t=this;this.btnState();var o=u.ViewUtils.nodeTreeInfoLite(this.node);o.get("reward_time").active=e.spanTime>0,o.get("reward_time").getComponent(cc.Label).string=Math.floor(e.spanTime/1e3)+"s",this.setLab(e.reward);var n=this.node.getChildByName("person").getComponent(sp.Skeleton);n.setCompleteListener(function(e){"reward_fadein"==e.animation.name?n.setAnimation(0,"reward_loop",!0):"reward_die"==e.animation.name&&(t.node.active=!1,p.default.module.gameMainControl.playCreditEffect(t.reward,function(e){p.default.module.calcUiShow.refreshCredit(e,function(){var e=p.default.module.calcUiShow.changeTaskListByTypeCount(h.TaskType.OFF_LINE,1);p.default.module.gameProtocol.sendTaskList(e,function(t){p.default.module.vm.taskList=e})},!0)}),t.node.destroy())}),n.setAnimation(0,"reward_fadein",!1)},t.prototype.setLab=function(e){var t=u.ViewUtils.nodeTreeInfoLite(this.node);t.get("reward_lab").active=e.num>0,t.get("reward_lab").getComponent(l.LabelChangeSymbol).changeTo(.3,e,function(){}),this.reward=e,0==this.reward.numE&&(this.reward={num:Math.floor(this.reward.num),numE:this.reward.numE}),cc.log(this.reward);var o=p.default.module.calcTool.calcMutiNum(this.reward,{num:3,numE:0});t.get("btn_reward_lab").getComponent(l.LabelChangeSymbol).changeTo(.3,o,function(){})},t.prototype.btnState=function(){var e=this.node.getChildByName("btn_diamond").getComponent(c.default);e.canTouch=p.default.module.vm.diamond>=10,this.node.getChildByName("btn_poster").getComponent(c.default).canTouch=!cc.sys.isBrowser,e.node.getChildByName("btn_reward_lab").getComponent(g.default).canTouch=e.canTouch},t.prototype.onTouchHandler=function(e){var t=this;if(!e.target.getComponent(a.default)||e.target.getComponent(a.default).canTouch)switch(e.target.name){case"btn_close":d.service.analytics.logEvent("offline_click_close","",""),this.node.getChildByName("person").getComponent(sp.Skeleton).setAnimation(0,"reward_die",!1);break;case"btn_poster":d.service.analytics.logEvent("offline_click_ad","",""),r.Message.dispatchEvent(f.AdvMessage.PLAY,{callback:function(e,o){o==f.AdvRewardType.OFFLINE_REWARD&&(e?(cc.log("\u79bb\u7ebf\u5956\u52b1\u89c2\u770b\u89c6\u9891\u7ffb7\u500d\u6210\u529f"),t.reward=p.default.module.calcTool.calcMutiNum(t.reward,{num:7,numE:0}),t.node.getChildByName("person").getComponent(sp.Skeleton).setAnimation(0,"reward_die",!1)):(cc.log("\u79bb\u7ebf\u5956\u52b1\u89c2\u770b\u89c6\u9891\u7ffb7\u500d\u5931\u8d25"),t.node.getChildByName("person").getComponent(sp.Skeleton).setAnimation(0,"reward_die",!1)))},type:f.AdvRewardType.OFFLINE_REWARD});break;case"btn_diamond":d.service.analytics.logEvent("offline_click_gem","",""),this.node.getChildByName("person").getComponent(sp.Skeleton).setAnimation(0,"reward_die",!1),this.reward=p.default.module.calcTool.calcMutiNum(this.reward,{num:3,numE:0}),p.default.module.gameProtocol.requestDiamondChange(10,function(e){p.default.module.vm.diamond=e.userAccount.credit})}},t.prototype.onDestroy=function(){this.node.off(cc.Node.EventType.TOUCH_END,this.onTouchHandler,this),r.Message.removeEventTarget(this),this.reward=null,e.prototype.onDestroy.call(this)},t=i([v],t)}(s.ComponentExtends));o.default=_,cc._RF.pop()},{"../../Main":"Main","../../core/event/MessageManager":"MessageManager","../../core/ui/ComponentExtends":"ComponentExtends","../../core/ui/ViewUtils":"ViewUtils","../../core/ui/button/ButtonEffect":"ButtonEffect","../../core/ui/button/ButtonEffectSprite":"ButtonEffectSprite","../../core/ui/label/LabelChangeSymbol":"LabelChangeSymbol","../../service/Service":"Service","../CalcUiShow":"CalcUiShow","./adv/AdvControl":"AdvControl","./effect/LabTouchFont":"LabTouchFont"}],OrientationPrompt:[function(e,t,o){"use strict";cc._RF.push(t,"f69deqYuopKKYlZSU/HuiOu","OrientationPrompt");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i=e("../event/EventDispatcher"),r=e("../EngineMessage"),a=function(e){function t(t){void 0===t&&(t=cc.macro.ORIENTATION_LANDSCAPE);var o=e.call(this)||this;if(o._orientation=cc.macro.ORIENTATION_AUTO,t===cc.macro.ORIENTATION_AUTO)return o;if(cc.sys.isMobile||cc.sys.browserType==cc.sys.BROWSER_TYPE_MIUI){if(cc.sys.browserType.toLowerCase().indexOf("baidu")>=0)return cc.log("[OrientationPrompt] \u4e0d\u652f\u6301\u767e\u5ea6\u6d4f\u89c8\u5668\uff01"),o;o._orientation=t,o.on(r.EngineMessage.GAME_RESIZE,o._screenChange,o),o._screenChange()}return o}return n(t,e),t.prototype._screenChange=function(){var e=cc.view.getCanvasSize(),t=e.width<e.height;switch(cc.sys.isBrowser&&cc.sys.browserType===cc.sys.BROWSER_TYPE_SAFARI&&(t=window.innerWidth<window.innerHeight),this._orientation){case cc.macro.ORIENTATION_LANDSCAPE:t?this.showGuide():this.hideGuide();break;case cc.macro.ORIENTATION_PORTRAIT:t?this.hideGuide():this.showGuide()}},t.prototype.showGuide=function(){var e=document.getElementById("screen-prompt");e?e.style.display="block":this.init()},t.prototype.hideGuide=function(){var e=document.getElementById("screen-prompt");e&&(e.style.display="none")},t.prototype._createStyle=function(){var e="";this._orientation==cc.macro.ORIENTATION_LANDSCAPE?e="\n            .screen-prompt {\n                width: 100%;\n                height: 100%;\n                position: fixed;\n                top: 0;\n                right: 0;\n                bottom: 0;\n                left: 0;\n                z-index: 50;\n                background: #212121 url( ./orientation_landscape.gif) center center no-repeat;\n                background-size: 30%;\n            }":this._orientation==cc.macro.ORIENTATION_PORTRAIT&&(e="\n            .screen-prompt {\n                width: 100%;\n                height: 100%;\n                position: fixed;\n                top: 0;\n                right: 0;\n                bottom: 0;\n                left: 0;\n                z-index: 50;\n                background: #212121 url(./orientation_portrait.gif) center center no-repeat;\n                background-size: 30%;\n            }");var t=document.createElement("style");t.type="text/css";try{t.appendChild(document.createTextNode(e))}catch(o){t.styleSheet&&(t.styleSheet.cssText=e)}document.getElementsByTagName("head")[0].appendChild(t)},t.prototype.init=function(){this._createStyle();var e=document.querySelector("script"),t=document.createElement("div");t.id="screen-prompt",t.className="screen-prompt",e.parentNode.insertBefore(t,e)},t}(i.EventDispatcher);o.OrientationPrompt=a,cc._RF.pop()},{"../EngineMessage":"EngineMessage","../event/EventDispatcher":"EventDispatcher"}],PackageComponent:[function(e,t,o){"use strict";cc._RF.push(t,"d91d3mdmCBKTaE9F4+bHmGM","PackageComponent");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../core/event/MessageManager"),a=e("../../core/gui/GUI"),c=e("../../core/ui/ComponentExtends"),s=e("../../core/ui/ViewUtils"),l=e("../../Main"),u=e("../../service/Service"),p=e("../AudioMessage"),d=e("../CalcUiShow"),h=e("./PackageListItem"),f=e("./StoreComponent"),g=cc._decorator,m=g.ccclass,v=g.property,_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.itemNode=null,t.mainNodes=null,t.canClick=!0,t}return n(t,e),t.prototype.onLoad=function(){u.service.analytics.logEvent("backpack_click_open","",""),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchHandler,this),this.node.active=!1,this.refreshPackageList()},t.prototype.refreshPackageList=function(){var e=this;this.itemNode.active=!1;var t=l.default.module.vm;l.default.module.gameMainControl.mainNodes.get("red_point_package").active=!1,u.service.prompt.netInstableOpen(),l.default.module.gameProtocol.requestPropStorageList(function(o){u.service.prompt.netInstableClose();var n=o.propStorageList;t.propStorageList=n;var i=s.ViewUtils.nodeTreeInfoLite(e.node),r=i.get("content"),a=0;for(var c in n){var p=null,d=n[c],f=l.default.module.themeConfig.getPropConfigByTag("add_"+d.pid);if(d.totalCount-d.usedCount>0){if(0==a)e.itemNode.active=!0,e.itemNode.getComponent(h.default).setData(c,d),p=e.itemNode.getComponent(h.default),e.itemNode.zIndex=20*f.addType+f.addValue[0]||0;else{var g=cc.instantiate(e.itemNode);g.parent=r,g.getComponent(h.default).setData(c,d),p=g.getComponent(h.default),g.zIndex=20*f.addType+f.addValue[0]||0}p.clickCallback=e.itemClickHandler.bind(e),a++}}0==a?(e.itemNode.active=!1,i.get("no_package").active=!0):i.get("no_package").active=!1,e.node.active=!0})},t.prototype.changeList=function(e,t){var o=l.default.module.themeConfig.getStoreMaxLvById(e),n=l.default.module.vm.storeList,i={};for(var r in n)n[r].id==e?i[r]={id:n[r].id,level:n[r].level+t>=o?o:n[r].level+t,rewardTime:l.default.module.calcUiShow.getSeverCurrentTime()}:i[r]={id:n[r].id,level:n[r].level,rewardTime:n[r].rewardTime};return i},t.prototype.itemClickHandler=function(e,t,o,n){var i=this;if(void 0===n&&(n=!0),this.canClick){this.canClick=!1;var c=l.default.module.vm;cc.log("\u9053\u5177ID"+e.pid);var h=e.pid;if(n){r.Message.dispatchEvent(p.AudioMessage.EFFECT,"alt");var g={modal:!0,opacity:150,touchClose:!1,onRemoved:function(){i.canClick=!0}};a.gui.popup.add("popup/prop_result",{params:e,reward:t},g),l.default.module.calcUiShow.refreshCredit(t,function(){},!0)}switch(e.addType){case 1:u.service.analytics.logEvent("backpack_click_use1","","");break;case 2:u.service.analytics.logEvent("backpack_click_use2","","");break;case 3:u.service.analytics.logEvent("backpack_click_use3","","");break;case 4:u.service.analytics.logEvent("backpack_click_use4","","")}var m=function(){l.default.module.vm.propStorageList=i.changePropStorageList(e.pid),l.default.module.vm.propStorageList["prop_"+h].totalCount-l.default.module.vm.propStorageList["prop_"+h].usedCount<=0?o.node.destroy():o.setData("prop_"+h,l.default.module.vm.propStorageList["prop_"+h]);var t=s.ViewUtils.nodeTreeInfoLite(i.node),n=t.get("content");t.get("no_package").active=1==n.children.length&&!i.itemNode.active},v=l.default.module.themeConfig.getPropConfigByTag("add_"+h);if(4==v.addType){var _=l.default.module.calcUiShow.changeTaskListByTypeCount(d.TaskType.STORE_UP,v.addValue[1]),y=l.default.module.calcUiShow.calcPostNum(v.addValue[0],v.addValue[1]);l.default.module.gameProtocol.sendTaskList(_,function(e){if(c.taskList=_,y>0){var t=l.default.module.calcUiShow.changeTaskListByTypeCount(d.TaskType.STORE_CHALLENGE,y);cc.log("\u9053\u5177\u5347\u7ea7\u5e97\u94fa\u8fbe\u6210\u6311\u6218\u6539\u53d8\u4efb\u52a1\u5217\u8868"+JSON.stringify(t)),l.default.module.gameProtocol.sendTaskList(t,function(e){c.taskList=t})}}),l.default.module.mainScene.storesNode.getChildByName("store_"+v.addValue[0]).getComponent(f.default).upLvHandler(v.addValue[1],{num:0,numE:0},!0,function(){m&&m(),i.refreshBtnMaxLvState()})}l.default.module.gameProtocol.requestUseProp(h,function(e){}),4!=v.addType&&m&&m();var b=l.default.module.calcUiShow.changeTaskListByTypeCount(d.TaskType.USE_PROP,1);l.default.module.gameProtocol.sendTaskList(b,function(e){l.default.module.vm.taskList=b})}},t.prototype.changePropStorageList=function(e){var t=l.default.module.vm.propStorageList,o={};for(var n in t)t[n].pid==e?o[n]={pid:t[n].pid,totalCount:t[n].totalCount,usedCount:t[n].usedCount+1>=t[n].totalCount?t[n].totalCount:t[n].usedCount+1}:o[n]={pid:t[n].pid,totalCount:t[n].totalCount,usedCount:t[n].usedCount};return o},t.prototype.refreshBtnMaxLvState=function(){s.ViewUtils.nodeTreeInfoLite(this.node).get("content").children.forEach(function(e){e.getComponent(h.default).refreshBtnState()})},t.prototype.onDestroy=function(){this.mainNodes=null,this.node.off(cc.Node.EventType.TOUCH_END,this.onTouchHandler,this),l.default.module.gamedata.newPropId=[],e.prototype.onDestroy.call(this)},t.prototype.onTouchHandler=function(e){switch(e.target.name){case"btn_close":a.gui.delete(this.node)}},i([v(cc.Node)],t.prototype,"itemNode",void 0),t=i([m],t)}(c.ComponentExtends);o.default=_,cc._RF.pop()},{"../../Main":"Main","../../core/event/MessageManager":"MessageManager","../../core/gui/GUI":"GUI","../../core/ui/ComponentExtends":"ComponentExtends","../../core/ui/ViewUtils":"ViewUtils","../../service/Service":"Service","../AudioMessage":"AudioMessage","../CalcUiShow":"CalcUiShow","./PackageListItem":"PackageListItem","./StoreComponent":"StoreComponent"}],PackageListItem:[function(e,t,o){"use strict";cc._RF.push(t,"eecce81uT5HZpzz2zqxS7w6","PackageListItem");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../core/Engine"),a=e("../../core/language/LanguageLabel"),c=e("../../core/ui/button/ButtonEffect"),s=e("../../core/ui/ComponentExtends"),l=e("../../core/ui/ViewUtils"),u=e("../../Main"),p=cc._decorator,d=p.ccclass,h=(p.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.clickCallback=null,t.reward=null,t.index=0,t.params=null,t}return n(t,e),t.prototype.onLoad=function(){this.node.hasEventListener(cc.Node.EventType.TOUCH_END)||this.node.on(cc.Node.EventType.TOUCH_END,this.onBtnHandler,this)},t.prototype.onBtnHandler=function(e){if("btn_package"==e.target.name&&this.node.getChildByName("btn_package").getComponent(c.default).canTouch&&this.clickCallback){0==this.reward.num&&0==this.reward.numE&&(this.reward={num:1,numE:3}),this.clickCallback(this.params,this.reward,this);var t=l.ViewUtils.nodeTreeInfoLite(this.node);t.get("new1").active=!1,t.get("new2").active=!1}},t.prototype.refreshBtnState=function(){var e=u.default.module.themeConfig.getPropConfigByTag("add_"+this.params.pid);if(4==e.addType){var t=l.ViewUtils.nodeTreeInfoLite(this.node),o=u.default.module.vm.storeList,n=u.default.module.themeConfig.getStoreMaxLvById(e.addValue[0]),i=o["store_"+e.addValue[0]].level;this.showButtonEffect(t.get("btn_package"),i<n)}},t.prototype.setData=function(e,t){t.pid=parseInt(e.split("_")[1]),this.params=t;var o=l.ViewUtils.nodeTreeInfoLite(this.node),n=o.get("spr");n.active=!1;var i=u.default.module.themeConfig.getPropConfigByTag("add_"+t.pid);cc.loader.loadRes("popup/package/prop"+i.addType,cc.SpriteFrame,function(e,t){n.getComponent(cc.Sprite).spriteFrame=t,n.active=!0}),o.get("count").getComponent(cc.Label).string="x"+(t.totalCount-t.usedCount),o.get("effect").getComponent(a.LanguageLabel).dataID="ui_prop_value"+i.addType,n.scale=1,this.showButtonEffect(o.get("btn_package"),!0),o.get("new1").active=-1!=u.default.module.gamedata.newPropId.indexOf(t.pid),o.get("new2").active=-1!=u.default.module.gamedata.newPropId.indexOf(t.pid),1==i.addType?o.get("effect").getComponent(a.LanguageLabel).setVars("value"+i.addType,""+i.addValue[0]):2==i.addType?(o.get("effect").getComponent(a.LanguageLabel).setVars("value"+i.addType+"_1",""+i.addValue[0]),o.get("effect").getComponent(a.LanguageLabel).setVars("value"+i.addType+"_2",""+i.addValue[1])):3==i.addType?(n.scale=1.4,o.get("effect").getComponent(a.LanguageLabel).setVars("value"+i.addType+"_1",Math.floor(100*Number((1-i.addValue[0]).toFixed(1)))+"%"),o.get("effect").getComponent(a.LanguageLabel).setVars("value"+i.addType+"_2",""+i.addValue[1])):4==i.addType&&(o.get("effect").getComponent(a.LanguageLabel).setVars("value"+i.addType+"_1",""+r.default.i18n.getLangByID("ui_store_"+i.addValue[0])),o.get("effect").getComponent(a.LanguageLabel).setVars("value"+i.addType+"_2",""+i.addValue[1])),this.refreshBtnState();var c=0;switch(t.pid){case 1:c=3600;break;case 2:c=7200;break;case 3:c=10800;break;case 4:c=43200}this.reward=u.default.module.calcUiShow.getTimeStageReward(c)},t.prototype.onDestroy=function(){this.node.off(cc.Node.EventType.TOUCH_END,this.onBtnHandler,this),this.index=null,this.params=null,this.reward=null,this.clickCallback=null,e.prototype.onDestroy.call(this)},t.prototype.showButtonEffect=function(e,t){var o=t?cc.Color.WHITE:cc.Color.GRAY,n=e.getComponent(c.default);e.color=o,n&&(n.canTouch=t);var i=function(e){if(0!=e.children.length)for(var t=0,n=e.children;t<n.length;t++){var r=n[t];r.color=o,i(r)}};i(e)},t=i([d],t)}(s.ComponentExtends));o.default=h,cc._RF.pop()},{"../../Main":"Main","../../core/Engine":"Engine","../../core/language/LanguageLabel":"LanguageLabel","../../core/ui/ComponentExtends":"ComponentExtends","../../core/ui/ViewUtils":"ViewUtils","../../core/ui/button/ButtonEffect":"ButtonEffect"}],PackageResult:[function(e,t,o){"use strict";cc._RF.push(t,"b8e467f9qlMRYd+cgHZq8VM","PackageResult");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../core/Engine"),a=e("../../core/language/LanguageLabel"),c=e("../../core/ui/ComponentExtends"),s=e("../../core/ui/label/LabelChangeSymbol"),l=e("../../core/ui/ViewUtils"),u=e("../../Main"),p=cc._decorator,d=p.ccclass,h=(p.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.onLoad=function(){this.node.hasEventListener(cc.Node.EventType.TOUCH_END)||this.node.on(cc.Node.EventType.TOUCH_END,this.onBtnHandler,this)},t.prototype.onBtnHandler=function(e){switch(e.target.name){case"btn_close":case"btn_ok":this.node.destroy()}},t.prototype.onAdded=function(e){var t=this,o=e.params,n=this.node.getChildByName("skeleton").getComponent(sp.Skeleton),i="zh"==r.default.i18n.currentLanguage?"cn":"en";this.node.getChildByName("btn_ok").active=!1,this.node.getChildByName("btn_close").active=!1,n.setCompleteListener(function(e){"reward_fadein"==e.animation.name&&(n.setAnimation(0,"reward_loop",!0),t.node.getChildByName("btn_ok").active=!0,t.node.getChildByName("btn_close").active=!0)}),n.setSkin(i),n.setAnimation(0,"reward_fadein",!1),this.node.getChildByName("result").scale=0,this.node.getChildByName("result").RunAction(ezaction.scaleTo(5/30,{scale:1.1})).onStoped(function(){t.node.getChildByName("result").RunAction(ezaction.scaleTo(10/30,{scale:1})).onStoped(function(){})}),this.node.getChildByName("clock").scale=0,this.node.getChildByName("clock").RunAction(ezaction.scaleTo(5/30,{scale:1.1*1.3})).onStoped(function(){t.node.getChildByName("clock").RunAction(ezaction.scaleTo(10/30,{scale:1.3})).onStoped(function(){})}),this.node.getChildByName("title_spr").scale=0;var c="en"==i?.65:1;this.node.getChildByName("title_spr").RunAction(ezaction.scaleTo(5/30,{scale:1.1*c})).onStoped(function(){t.node.getChildByName("title_spr").RunAction(ezaction.scaleTo(10/30,{scale:1*c})).onStoped(function(){})});var p=l.ViewUtils.nodeTreeInfoLite(this.node),d=p.get("clock");d.active=!1;var h=u.default.module.themeConfig.getPropConfigByTag("add_"+o.pid);cc.loader.loadRes("popup/package/prop"+h.addType,cc.SpriteFrame,function(e,t){d.getComponent(cc.Sprite).spriteFrame=t,d.active=!0}),p.get("result_lab").getComponent(a.LanguageLabel).dataID="ui_prop_value"+h.addType,p.get("result_lab").getComponent(a.LanguageLabel).setVars("value"+h.addType,h.addValue+"h"),1==h.addType?p.get("result_lab").getComponent(a.LanguageLabel).setVars("value"+h.addType,""+h.addValue[0]):2==h.addType?(p.get("result_lab").getComponent(a.LanguageLabel).setVars("value"+h.addType+"_1",""+h.addValue[0]),p.get("result_lab").getComponent(a.LanguageLabel).setVars("value"+h.addType+"_2",""+h.addValue[1])):3==h.addType?(p.get("result_lab").getComponent(a.LanguageLabel).setVars("value"+h.addType+"_1",Math.floor(100*Number((1-h.addValue[0]).toFixed(1)))+"%"),p.get("result_lab").getComponent(a.LanguageLabel).setVars("value"+h.addType+"_2",""+h.addValue[1])):4==h.addType&&(p.get("result_lab").getComponent(a.LanguageLabel).setVars("value"+h.addType+"_1",""+r.default.i18n.getLangByID("ui_store_"+h.addValue[0])),p.get("result_lab").getComponent(a.LanguageLabel).setVars("value"+h.addType+"_2",""+h.addValue[1])),1==h.addType?(p.get("result_num").active=!0,0==e.reward.num?p.get("result_num").getComponent(s.LabelChangeSymbol).num={num:1,numE:3}:p.get("result_num").getComponent(s.LabelChangeSymbol).num=e.reward):p.get("result_num").active=!1},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t=i([d],t)}(c.ComponentExtends));o.default=h,cc._RF.pop()},{"../../Main":"Main","../../core/Engine":"Engine","../../core/language/LanguageLabel":"LanguageLabel","../../core/ui/ComponentExtends":"ComponentExtends","../../core/ui/ViewUtils":"ViewUtils","../../core/ui/label/LabelChangeSymbol":"LabelChangeSymbol"}],Pay:[function(e,t,o){"use strict";cc._RF.push(t,"84ef26uKv9A+rivnvn+yzP3","Pay"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../core/ezplugin/ezplugin"),i=e("../Main"),r=e("../service/Service"),a=function(){function e(){var e=n.ezplugin.get("PluginIAP");e&&e.addEventListener(this.iosPayEvent.bind(this));var t=n.ezplugin.get("PluginGooglePay");t&&t.addEventListener(this.gPayEvent.bind(this))}return e.prototype.doPay=function(e,t){if(cc.log(" \u8c03\u7528SDK\u652f\u4ed8 ",e,t),r.service.prompt.netInstableOpen(2),cc.sys.isNative)switch(cc.sys.os){case cc.sys.OS_ANDROID:(o=n.ezplugin.get("PluginGooglePay"))&&o.excute("pay",t+"|"+e);break;case cc.sys.OS_IOS:var o;(o=n.ezplugin.get("PluginIAP"))&&o.excute("pay",t+"|"+e)}else cc.log("\u76ee\u524d\u53ea\u652f\u6301iOS\u548cAndroid\u5e94\u7528\u652f\u4ed8\u6a21\u5f0f\uff01")},e.prototype.iosPayEvent=function(e,t){switch(e){case"pay_error":var o={orderId:t,receipt:"",billNo:t};(s=i.default.module.gameProtocol).finishApplePay(3,o,function(e){cc.log("[Pay] \u9a8c\u8bc1\u7ed3\u679c",JSON.stringify(e))});break;case"pay_success":var n=JSON.parse(t),a=n.receipt,c=n.billNO;cc.log("receipt\u957f\u5ea6",a.length);var s=i.default.module.gameProtocol;if(n.receipt){o={orderId:c,receipt:n.receipt,billNo:c};s.finishApplePay(2,o,function(e){if(cc.log("[Pay] \u9a8c\u8bc1\u7ed3\u679c",JSON.stringify(e)),e.userAccount&&e.userAccount.credit){var t=r.service.account.data;t.diamond=e.userAccount.credit,i.default.module.vm.diamond=t.diamond}})}}},e.prototype.gPayEvent=function(e,t){switch(e){case"pay_error":var o=JSON.parse(t),n=i.default.module.gameProtocol,a={orderId:"",packageName:"",productId:"",purchaseToken:"",billNo:o.billNO};n.finishGooglePay(3,a,function(e){cc.log("[Pay] \u9a8c\u8bc1\u7ed3\u679c",JSON.stringify(e))});break;case"pay_success":o=JSON.parse(t);cc.log("googlepay \u652f\u4ed8\u9a8c\u8bc1\u4fe1\u606f",t);n=i.default.module.gameProtocol;var c=o.packageName,s=o.orderId,l=o.productId,u=o.billNO;a={orderId:s,packageName:c,productId:l,purchaseToken:o.purchaseToken,billNo:u};n.finishGooglePay(2,a,function(e){if(cc.log("[Pay] \u9a8c\u8bc1\u7ed3\u679c",JSON.stringify(e)),e.userAccount&&e.userAccount.credit){var t=r.service.account.data;t.diamond=e.userAccount.credit,i.default.module.vm.diamond=t.diamond}})}},e}();o.Pay=a,cc._RF.pop()},{"../Main":"Main","../core/ezplugin/ezplugin":"ezplugin","../service/Service":"Service"}],PluginBridgeCore:[function(e,t,o){"use strict";cc._RF.push(t,"b0342UFa8NMd79s6RDJda1s","PluginBridgeCore"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];cc.log.apply(cc,["PluginBridgeCore"].concat(e))},i=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];cc.error.apply(cc,["PluginBridgeCore"].concat(e))},r=function(){function t(e){this._uuidcount=Math.floor(Date.now()/1e3),this.nativeToJsCallbackHash={},this.nativeToJsEventHash={},this.NativePluginCorePATH="",this.NativePluginCorePATH=e}return t.prototype.generatorUUID=function(){return this._uuidcount++},t.prototype.exchangeCallbackID=function(e){if("function"==typeof e){var t=this.generatorUUID();return this.nativeToJsCallbackHash[t]=e,t}return 0},t.prototype.sysInfo=function(){if(cc.sys.isNative)switch(cc.sys.os){case cc.sys.OS_ANDROID:return jsb.reflection.callStaticMethod(this.NativePluginCorePATH,"sysInfo","()Ljava/lang/String;");case cc.sys.OS_IOS:return jsb.reflection.callStaticMethod(this.NativePluginCorePATH,"sysInfo")}if(cc.sys.isBrowser)return e(this.NativePluginCorePATH).sysInfo()},t.prototype.initAllPlugins=function(t,o){n("initAllPlugins");try{var r=this.exchangeCallbackID(o);if(cc.sys.isNative){var a=JSON.stringify(t);switch(cc.sys.os){case cc.sys.OS_ANDROID:return jsb.reflection.callStaticMethod(this.NativePluginCorePATH,"initAllPlugins","(Ljava/lang/String;I)V",a,r),!0;case cc.sys.OS_IOS:return jsb.reflection.callStaticMethod(this.NativePluginCorePATH,"initAllPlugins:andCallback:",a,r),!0}}if(cc.sys.isBrowser){var c=e(this.NativePluginCorePATH);if(c)return c.initAllPlugins(t,r),!0}this.nativeCallbackErrorHandler(r,"not supported"),n("[\u6ce8\u610f] \u5f53\u524d\u7cfb\u7edf\u65e0\u6cd5\u8fdb\u884c\u63d2\u4ef6\u521d\u59cb\u5316\uff01")}catch(e){i(" \u9519\u8bef",e)}return!1},t.prototype.initPlugin=function(t,o){try{var r=this.exchangeCallbackID(o),a=t.pluginName;if(cc.sys.isNative){var c=JSON.stringify(t.params||{});switch(cc.sys.os){case cc.sys.OS_ANDROID:return jsb.reflection.callStaticMethod(this.NativePluginCorePATH,"initPlugin","(Ljava/lang/String;Ljava/lang/String;I)V",a,c,r),!0;case cc.sys.OS_IOS:return jsb.reflection.callStaticMethod(this.NativePluginCorePATH,"initPlugin:andPluginData:andCallback:",a,c,r),!0}}if(cc.sys.isBrowser){var s=e(this.NativePluginCorePATH);if(s)return s.initPluigin(a,t.params||{},r),!0}this.nativeCallbackErrorHandler(r,a+"not supported"),n("PluginCore","[\u6ce8\u610f] \u5f53\u524d\u7cfb\u7edf\u65e0\u6cd5\u8fdb\u884c "+a+"\u63d2\u4ef6\u521d\u59cb\u5316\uff01")}catch(e){i("[PluginCore]->initPlugin \u9519\u8bef",e),o&&o(new Error("not supported"),e)}return!1},t.prototype.excute=function(t,o,r,a,c){try{var s="";switch(typeof r){case"string":case"number":s=r.toString();break;case"object":try{s=JSON.stringify(r)}catch(e){i(e),s=""}}var l=this.exchangeCallbackID(c);if(cc.sys.isNative)switch(cc.sys.os){case cc.sys.OS_ANDROID:var u="excute";return a&&(u="excuteInUIThread"),jsb.reflection.callStaticMethod(this.NativePluginCorePATH,u,"(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;I)V",t,o,s,l),l;case cc.sys.OS_IOS:return jsb.reflection.callStaticMethod(this.NativePluginCorePATH,"excute:andAction:andParams:andCallBack:",t,o,s,l),l}if(cc.sys.isBrowser){var p=e(this.NativePluginCorePATH);if(p)return p.excute(t,o,s,l),l}this.nativeCallbackErrorHandler(l,t+"not supported")}catch(e){i("excute \u9519\u8bef",e),n(arguments)}return-1},t.prototype.addEventListener=function(e,t){if("function"==typeof t){var o=this.generatorUUID();return this.nativeToJsEventHash[o]={pluginName:e,callback:t},o}},t.prototype.removeEventListener=function(e){var t=this.nativeToJsEventHash;if("number"==typeof e&&delete t[e],"string"==typeof e)for(var o in t){var n=t[o];n&&n.pluginName===e&&delete t[o]}},t.prototype.dispose=function(){this.nativeToJsEventHash={},this.nativeToJsCallbackHash={},n("dispose")},t.prototype._paramsToString=function(e){for(var t=e.split("|"),o=new Uint16Array(t.length),n=0;n<t.length;n++)o[n]=parseInt(t[n]);return String.fromCharCode.apply(null,o)},t.prototype.nativeEventHandler=function(e,t,o){try{var r=this.nativeToJsEventHash;o=this._paramsToString(o);var a=!1;for(var c in r){var s=r[c];if(s&&s.pluginName===e)(0,s.callback)(t,o),a=!0}a||n(e+" has nothing function to call! "+t)}catch(o){i(e+" nativeEventHandler exception, "+t+" "+o.toString())}},t.prototype.nativeCallbackHandler=function(e,t){try{var o=this.nativeToJsCallbackHash,i=e+"",r=o[i];"function"==typeof r?(r(null,t=this._paramsToString(t)),delete o[i]):n("nativeCallbackHandler, "+i+" not found!")}catch(e){n("nativeCallbackHandler \u5f02\u5e38 "+t+" "+e.toString())}},t.prototype.nativeCallbackErrorHandler=function(e,t){try{t=this._paramsToString(t),n(" nativeCallbackErrorHandler \u9519\u8bef\u4fe1\u606f:",t);var o=this.nativeToJsCallbackHash,r=e+"",a=o[r];"function"==typeof a?(a(new Error(t)),delete o[r]):n("nativeCallbackHandler, "+r+" not found!")}catch(e){i("nativeCallbackErrorHandler \u5f02\u5e38 "+t+" "+e.toString())}},t}();o.PluginBridgeCore=r,cc._RF.pop()},{}],PluginEntity:[function(e,t,o){"use strict";cc._RF.push(t,"087cclZlShLypOmpfRuayqz","PluginEntity"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(e,t){this._pluginCore=null,this._data=null,this._data=e,this._pluginCore=t}return Object.defineProperty(e.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),e.prototype.excute=function(e,t,o){return this._pluginCore.excute(this._data.pluginName,e,t,!1,o)},e.prototype.excuteInUIThread=function(e,t,o){return this._pluginCore.excute(this._data.pluginName,e,t,!0,o)},e.prototype.addEventListener=function(e){return this._pluginCore.addEventListener(this.data.pluginName,e)},e.prototype.removeEventListener=function(e){e&&"string"!=typeof e?"number"==typeof e&&this._pluginCore.removeEventListener(e):this._pluginCore.removeEventListener(this.data.pluginName)},e}();o.PluginEntity=n,cc._RF.pop()},{}],Point:[function(e,t,o){"use strict";cc._RF.push(t,"520e4cLiBBPLYREzSRGlltJ","Point"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){return function(e,t){void 0===e&&(e=0),void 0===t&&(t=0),this.x=0,this.y=0,this.x=e,this.y=t}}();o.default=n,cc._RF.pop()},{}],PosterTip:[function(e,t,o){"use strict";cc._RF.push(t,"3dc7d3qhnlGH6pq7ydJ7/RO","PosterTip");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../../core/language/LanguageLabel"),a=e("../../../core/ui/ComponentExtends"),c=cc._decorator,s=c.ccclass,l=(c.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.onLoad=function(){},t.prototype.setData=function(e){var t=this,o=1==e.type?"store_profits_value"+e.id:"store_speed_value"+e.id;this.node.getChildByName("poster_lab").getComponent(r.LanguageLabel).dataID=o,this.node.getChildByName("poster_lab").getComponent(r.LanguageLabel).setVars("value"+e.id,e.value),this.scheduleOnce(function(){t.node.RunAction(ezaction.moveTo(1,{x:-800})).onStoped(function(){t.node.destroy()})},2)},t=i([s],t)}(a.ComponentExtends));o.default=l,cc._RF.pop()},{"../../../core/language/LanguageLabel":"LanguageLabel","../../../core/ui/ComponentExtends":"ComponentExtends"}],ProgressAnim:[function(e,t,o){"use strict";cc._RF.push(t,"40e9eIk9V1OG4lx0VzG5PuF","ProgressAnim");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../../core/ui/ComponentExtends"),a=cc._decorator,c=a.ccclass,s=(a.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.initY=0,t}return n(t,e),t.prototype.onLoad=function(){this.initY=this.node.y},t.prototype.action=function(){var e=this;this.node.RunAction(ezaction.moveTo(.1,{y:this.initY+2})).onStoped(function(){e.node.RunAction(ezaction.moveTo(.1,{y:e.initY-2})).onStoped(function(){})}),this.node.RunAction(ezaction.moveTo(.1,{scale:1.1})).onStoped(function(){e.node.RunAction(ezaction.moveTo(.1,{scale:1})).onStoped(function(){})})},t.prototype.onDestroy=function(){this.initY=null,e.prototype.onDestroy.call(this)},t=i([c],t)}(r.ComponentExtends));o.default=s,cc._RF.pop()},{"../../../core/ui/ComponentExtends":"ComponentExtends"}],Prompt:[function(e,t,o){"use strict";cc._RF.push(t,"1fa1aipfYVNeYAKcoEqIn8I","Prompt"),Object.defineProperty(o,"__esModule",{value:!0});var n,i,r=e("../../core/Engine"),a=e("../../core/gui/GUI"),c=e("../../core/net/Network"),s=e("../Service");(function(e){e[e.POP=1]="POP",e[e.POPSTATIC=2]="POPSTATIC",e[e.POPSYS=3]="POPSYS"})(n=o.Prompt_Type||(o.Prompt_Type={})),function(e){e[e.FIRST=1]="FIRST",e[e.SECOND=2]="SECOND",e[e.THIRD=3]="THIRD"}(i=o.Prompt_Size||(o.Prompt_Size={}));var l=function(){function e(){this._timeId="",this._roomLoadTimeId=""}return e.prototype.netInstableOpen=function(e){void 0===e&&(e=0);var t="common/persist/prefab/loading";a.gui.loading.has(t)||a.gui.loading.add(t,null),e>0&&(this._timeId&&r.default.timer.unschedule(this._timeId),this._timeId=r.default.timer.scheduleOnce(this.netInstableClose,e))},e.prototype.netInstableOpenByTask=function(e){void 0===e&&(e=0);var t="common/persist/prefab/loading_task";a.gui.loading.has(t)||a.gui.loading.add(t,null),e>0&&(this._timeId&&r.default.timer.unschedule(this._timeId),this._timeId=r.default.timer.scheduleOnce(this.netInstableClose,e))},e.prototype.netInstableClose=function(){a.gui.loading.$delete("common/persist/prefab/loading"),a.gui.loading.$delete("common/persist/prefab/loading_task")},e.prototype.roomLoadOpen=function(e){void 0===e&&(e=0);a.gui.loading.has("hall/room_load")||a.gui.loading.add("hall/room_load",null)},e.prototype.roomLoadClose=function(){a.gui.loading.$delete("hall/room_load")},e.prototype.networkRecovery=function(){this._timeId&&(r.default.timer.unschedule(this._timeId),this._timeId="");a.gui.loading.$delete("common/persist/prefab/loading")},e.prototype.networkLatency=function(e){this._timeId&&r.default.timer.unschedule(this._timeId),this._timeId=r.default.timer.scheduleOnce(this.netInstableOpen,e)},e.prototype.serverConnectFail=function(e){var t={params:{popType:n.POPSYS,sizeType:i.THIRD,title:"system_prompt",content:"server_connect_fail_content",okFunc:e,okWord:"determine",needClose:!1}};this.addCommonPrompt(t)},e.prototype.hallServerDisconnected=function(e,t){var o={params:{popType:n.POPSYS,sizeType:i.THIRD,title:"system_prompt",content:"server_off",okFunc:e,okWord:"Try Now",cancelWord:"OK",cancelFunc:t,needCancel:!0,showOk:!0,needClose:!1}};this.addCommonPrompt(o)},e.prototype.restart=function(e){var t={params:{popType:n.POPSYS,sizeType:i.THIRD,title:"system_prompt",content:"restart game!",okFunc:e,okWord:"determine",needClose:!1}};this.addCommonPrompt(t)},e.prototype.serverDisconnected=function(e){void 0===e&&(e=null);var t="server_connect_fail_content";r.default.network.state!=c.NetworkState.ONLINE&&(t="net_unavailable");var o={params:{popType:n.POPSYS,sizeType:i.THIRD,title:"system_prompt",content:t,okFunc:e,okWord:"determine",needClose:!1,uuid:"promptServerDisconnected"}};this.addCommonPrompt(o)},e.prototype.unknowError=function(){var e={params:{popType:n.POPSYS,sizeType:i.THIRD,title:"system_prompt",content:"refresh_page",okFunc:function(){s.service.exitGame()},okWord:"determine",needClose:!1}};this.addCommonPrompt(e)},e.prototype.resNotFound=function(e){void 0===e&&(e=null),e||(e=function(){cc.sys.isNative?cc.game.restart():location.reload(!0)});var t={params:{popType:n.POPSYS,sizeType:i.THIRD,title:"system_prompt",content:"res_notfound",okFunc:e,okWord:"determine",needClose:!1}};this.addCommonPrompt(t)},e.prototype.errorCurrency=function(){var e={params:{popType:n.POPSYS,sizeType:i.THIRD,title:"system_prompt",content:"error_currency",showOk:!0,okFunc:function(){s.service.exitGame()},okWord:"determine",needClose:!1}};this.addCommonPrompt(e)},e.prototype.errorCodePrompt=function(e,t){void 0===t&&(t=null);var o=t;o||(o=function(){s.service.exitGame()});var r={params:{popType:n.POPSYS,sizeType:i.THIRD,title:"system_prompt",content:"errorcode_"+e,okFunc:o,showOk:!0,okWord:"determine",needClose:!1}};this.addCommonPrompt(r)},e.prototype.addCommonPrompt=function(e){e.params.popType=e.params.popType||n.POP,e.params.sizeType=e.params.sizeType||i.FIRST;var t={onAdded:function(e,t){e.scale=.1,e.runAction(cc.scaleTo(.2,1))},onBeforeRemove:function(e,t){e.RunAction(ezaction.scaleTo(.2,{scale:.1})).onStoped(t)}};switch(e.params.popType){case n.POP:a.gui.dialog.add("common/persist/prefab/common_prompt",e.params,t);break;case n.POPSTATIC:case n.POPSYS:a.gui.alert.add("common/persist/prefab/common_prompt",e.params,t)}},e.prototype.hasPopView=function(){var e="common/persist/prefab/common_prompt";return a.gui.dialog.has(e)||a.gui.alert.has(e)},e.prototype.clearAll=function(){var e="common/persist/prefab/common_prompt";a.gui.dialog.$delete(e),a.gui.alert.$delete(e)},e}();o.Prompt=l,cc._RF.pop()},{"../../core/Engine":"Engine","../../core/gui/GUI":"GUI","../../core/net/Network":"Network","../Service":"Service"}],PublicSuccess:[function(e,t,o){"use strict";cc._RF.push(t,"308a3hoCr1IPo1d4NxHSQVi","PublicSuccess");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../core/Engine"),a=e("../../core/language/LanguageLabel"),c=e("../../core/ui/ComponentExtends"),s=e("../../core/ui/ViewUtils"),l=e("../../Main"),u=cc._decorator,p=u.ccclass,d=(u.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.onLoad=function(){},t.prototype.onAdded=function(e){var t=this,o=s.ViewUtils.nodeTreeInfoLite(this.node);o.get("btn_ok").on(cc.Node.EventType.TOUCH_END,function(){t.node.destroy()},this),o.get("unlock1").active=!1,o.get("unlock2").active=!1,o.get("unlock3").active=!1,o.get("info").active=!1;var n=l.default.module.calcTool.formatNum(l.default.module.vm.fame),i=""+n.base+n.gear;o.get("current").getComponent(a.LanguageLabel).setVars("ui_personal_16",""),o.get("current_lab").getComponent(cc.Label).string=i,o.get("layout").getComponent(cc.Layout).updateLayout();var c=l.default.module.calcTool.formatNum(l.default.module.calcTool.calcAddNum(l.default.module.calcUiShow.rewardAdd(),{num:1,numE:0},!1)),u=""+c.base+c.gear;o.get("total").getComponent(a.LanguageLabel).setVars("ui_personal_17",u);var p=this.node.getChildByName("public").getComponent(sp.Skeleton),d="zh"==r.default.i18n.currentLanguage?"cn":"en";p.setSkin(d),p.setEventListener(function(e,n){"1"==n.data.name?(t.node.getChildByName("unlock1").active=!0,t.node.getChildByName("unlock3").active=!0):"2"==n.data.name&&(o.get("info").active=!0)}),p.setCompleteListener(function(e){"reward_1"==e.animation.name&&(p.setAnimation(0,"reward_loop",!0),o.get("unlock2").active=!0)}),p.setAnimation(0,"reward_1",!1)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t=i([p],t)}(c.ComponentExtends));o.default=d,cc._RF.pop()},{"../../Main":"Main","../../core/Engine":"Engine","../../core/language/LanguageLabel":"LanguageLabel","../../core/ui/ComponentExtends":"ComponentExtends","../../core/ui/ViewUtils":"ViewUtils"}],QueryConfig:[function(e,t,o){"use strict";cc._RF.push(t,"1f865GkCHBEda6F1+i5PFO0","QueryConfig"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../core/url/UrlParse"),i="WH",r=function(){function e(){this._data=null;var e=new n.UrlParse(i).query;e?(e.username||(e.username=a()),this._data=Object.freeze(e)):this._data={}}return Object.defineProperty(e.prototype,"hideCurrency",{get:function(){return this._data.hideCurrency||"0"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hideRTP",{get:function(){return this._data.hideRTP||"0"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ips",{get:function(){return this._data.ips},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ipdomains",{get:function(){return this._data.ipdomains},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"username",{get:function(){return this._data.username},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"token",{get:function(){return this._data.token},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gameid",{get:function(){return this._data.gameid},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"userFlag",{get:function(){return this._data.userFlag},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this._data.name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lang",{get:function(){return this._data.lang},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gift",{get:function(){var e=this._data.gift||"0";return cc.sys.isBrowser&&1==e?"1":"0"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"closeUrl",{get:function(){return this._data.closeUrl},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"disableHomeBtn",{get:function(){return this._data.disableHomeBtn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"port",{get:function(){return this._data.port},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"debug",{get:function(){return this._data.debug},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"wintype",{get:function(){return this._data.wintype},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ip",{get:function(){return this._data.ip||""},enumerable:!0,configurable:!0}),e.prototype.getConfigServerInfo=function(){var e={ips:[],ssl:!1,port:0};return this.ips&&(e.ips=this.ips.split("_"),e.ssl=!1),this.ipdomains&&(e.ips=this.ipdomains.split("_"),e.ssl=!0),this.port&&(e.port=parseInt(this.port)),e.ips.length<1&&cc.warn("[QueryConfig]\u8bf7\u5728\u5730\u5740\u680f\u8f93\u5165\u6e38\u620f\u670d\u52a1\u5668ip"),e.port<1&&cc.warn("[QueryConfig]\u8bf7\u5728\u5730\u5740\u680f\u8f93\u5165\u7aef\u53e3\u53f7"),e},Object.defineProperty(e.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),e}();o.default=r;var a=function(){var e=cc.sys.localStorage.getItem("__uuid_");return e||(e=(e=cc.sys.os+cc.sys.platform+"_"+function(e,t){var o,n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),i=[];if(t=t||n.length,e)for(o=0;o<e;o++)i[o]=n[0|Math.random()*t];else{var r=void 0;for(i[8]=i[13]=i[18]=i[23]="-",i[14]="4",o=0;o<36;o++)i[o]||(r=0|16*Math.random(),i[o]=n[19==o?3&r|8:r])}return i.join("")}(13,16)).replace(/[\s]+/,""),cc.sys.localStorage.setItem("__uuid_",e)),e};cc._RF.pop()},{"../../core/url/UrlParse":"UrlParse"}],RankingListComponent:[function(e,t,o){"use strict";cc._RF.push(t,"b0602E4crpDn4ILI8uIvZkE","RankingListComponent");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../core/gui/GUI"),a=e("../../core/language/LanguageLabel"),c=e("../../core/ui/ComponentExtends"),s=e("../../core/ui/label/LabelChangeSymbol"),l=e("../../core/ui/ViewUtils"),u=e("../../core/util/AsyncQueue"),p=e("../../Main"),d=e("../../service/Service"),h=e("./RankingListItem"),f=cc._decorator,g=f.ccclass,m=f.property,v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.itemNode=null,t.mainNodes=null,t.personalIndex=-1,t}return n(t,e),t.prototype.onLoad=function(){d.service.analytics.logEvent("rank_click_open","",""),this.mainNodes=l.ViewUtils.nodeTreeInfoLite(this.node),this.node.active=!1,this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchHandler,this),this.setLikeInfo(),this.node.getChildByName("scrollview").on("scroll-ended",function(){d.service.analytics.logEvent("rank_click_slide","","")}),p.default.module.gameMainControl.mainNodes.get("red_point_ranking").active=!1},t.prototype.setLikeInfo=function(){var e=this;p.default.module.gameProtocol.requestLikeInfo(function(t){cc.log(t),e.refreshRankingList(t.likeData)})},t.prototype.refreshRankingList=function(e){var t=this,o=this.mainNodes.get("content");this.itemNode.active=!1;var n=u.AsyncQueue.excuteTimes(2,function(){t.node.active=!0}),i=null;p.default.module.gameProtocol.requestRankingList(function(r){p.default.module.vm.rankingList=r.rankingList.rankData,p.default.module.vm.rankingList.forEach(function(n,r){var a={index:r,id:n.id,nickname:n.name||n.id,icon:n.icon||1,score:{num:n.rankValue,numE:n.rankValueE}};r<3&&(a.like=e[r]),n.id==d.service.account.data.uid&&(i=a);var c=null;if(0==r)t.itemNode.active=!0,(c=t.itemNode.getComponent(h.default)).setData(a);else{var s=cc.instantiate(t.itemNode);s.parent=o,(c=s.getComponent(h.default)).setData(a)}r<3&&(c.clickCallback=t.itemClickHandler.bind(t))}),t.refreshPersonalInfo(i,n),n()})},t.prototype.itemClickHandler=function(e,t){d.service.analytics.logEvent("rank_click_like","","");var o=p.default.module.calcUiShow.getTimeStageReward(180);0==o.num&&0==o.numE&&(o={num:1,numE:3}),p.default.module.gameMainControl.playCreditEffect(o,function(){p.default.module.calcUiShow.refreshCredit(o,function(){},!0)}),t&&t(),p.default.module.gameProtocol.requestClickLike(d.service.account.data.uid,e,function(e){})},t.prototype.refreshPersonalInfo=function(e,t){var o=this;if(this.mainNodes.get("personal_head").active=!1,e){this.mainNodes.get("onlist_lab").getComponent(cc.Label).fontSize=55,this.mainNodes.get("onlist_lab").getComponent(cc.Label).string=e.index+1+"";var n=cc.loader.getRes("main/head/head_"+(e.icon||1),cc.SpriteFrame);this.mainNodes.get("personal_head").active=!0,this.mainNodes.get("personal_head").getComponent(cc.Sprite).spriteFrame=n,this.mainNodes.get("personal_nickname").getComponent(cc.Label).string=""+e.nickname||d.service.account.data.uid+"",this.mainNodes.get("ranking_num").getComponent(s.LabelChangeSymbol).num=e.score,t&&t()}else this.mainNodes.get("onlist_lab").getComponent(a.LanguageLabel).dataID="list_4",this.mainNodes.get("onlist_lab").getComponent(cc.Label).fontSize=30,p.default.module.gameProtocol.requestHead(d.service.account.data.uid,function(e){var n=cc.loader.getRes("main/head/head_"+(e.icon.icon||1),cc.SpriteFrame);o.mainNodes.get("personal_head").active=!0,o.mainNodes.get("personal_head").getComponent(cc.Sprite).spriteFrame=n,o.mainNodes.get("personal_nickname").getComponent(cc.Label).string=""+e.icon.nickName||d.service.account.data.uid+"",t&&t()}),this.mainNodes.get("ranking_num").getComponent(s.LabelChangeSymbol).num=p.default.module.vm.credit},t.prototype.onDestroy=function(){this.mainNodes=null,this.personalIndex=null,this.node.off(cc.Node.EventType.TOUCH_END,this.onTouchHandler,this),e.prototype.onDestroy.call(this)},t.prototype.onTouchHandler=function(e){switch(e.target.name){case"btn_close":r.gui.delete(this.node)}},i([m(cc.Node)],t.prototype,"itemNode",void 0),t=i([g],t)}(c.ComponentExtends);o.default=v,cc._RF.pop()},{"../../Main":"Main","../../core/gui/GUI":"GUI","../../core/language/LanguageLabel":"LanguageLabel","../../core/ui/ComponentExtends":"ComponentExtends","../../core/ui/ViewUtils":"ViewUtils","../../core/ui/label/LabelChangeSymbol":"LabelChangeSymbol","../../core/util/AsyncQueue":"AsyncQueue","../../service/Service":"Service","./RankingListItem":"RankingListItem"}],RankingListItem:[function(e,t,o){"use strict";cc._RF.push(t,"b9fa3pIlXlF2rjYeIW/TVRN","RankingListItem");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../core/ui/button/ButtonEffectSprite"),a=e("../../core/ui/ComponentExtends"),c=e("../../core/ui/label/LabelChangeSymbol"),s=e("../../core/ui/ViewUtils"),l=e("./ListItemFrame"),u=cc._decorator,p=u.ccclass,d=(u.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.clickCallback=null,t.params=null,t}return n(t,e),t.prototype.onLoad=function(){this.node.hasEventListener(cc.Node.EventType.TOUCH_END)||this.node.once(cc.Node.EventType.TOUCH_END,this.onBtnHandler,this)},t.prototype.onBtnHandler=function(e){var t=this;"liked"==e.target.name&&this.node.getChildByName("liked").getComponent(r.default).canTouch&&this.clickCallback&&this.clickCallback(this.params.index,function(){var e=s.ViewUtils.nodeTreeInfoLite(t.node).get("liked");t.showButtonEffect(e,!1)})},t.prototype.setData=function(e){var t=s.ViewUtils.nodeTreeInfoLite(this.node);this.params=e;var o=e.index,n=t.get("ranking_spr");n.active=o<=2,n.getComponent(l.default).setFrame(o),this.node.getComponent(l.default).setFrame(o<=2?0:1);var i=t.get("liked");i.active=o<=2,this.showButtonEffect(i,0==e.like);var r=t.get("head_spr"),a=cc.loader.getRes("main/head/head_"+e.icon,cc.SpriteFrame);r.getComponent(cc.Sprite).spriteFrame=a;var u=t.get("ranking_lab");u.active=o>2,u.getComponent(cc.Label).string=""+(o+1),t.get("nickname").getComponent(cc.Label).string=e.nickname,t.get("score").getComponent(c.LabelChangeSymbol).num=e.score},t.prototype.showButtonEffect=function(e,t){var o=e.getComponent(r.default);o&&(o.canTouch=t)},t.prototype.onDestroy=function(){this.node.off(cc.Node.EventType.TOUCH_END,this.onBtnHandler,this),this.clickCallback=null,this.params=null,e.prototype.onDestroy.call(this)},t=i([p],t)}(a.ComponentExtends));o.default=d,cc._RF.pop()},{"../../core/ui/ComponentExtends":"ComponentExtends","../../core/ui/ViewUtils":"ViewUtils","../../core/ui/button/ButtonEffectSprite":"ButtonEffectSprite","../../core/ui/label/LabelChangeSymbol":"LabelChangeSymbol","./ListItemFrame":"ListItemFrame"}],RequestAccount:[function(e,t,o){"use strict";cc._RF.push(t,"5ed84legkFCoIpMtMmGdnAH","RequestAccount");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../core/event/EventDispatcher"),r=e("../Service"),a=e("../../core/Engine"),c=function(){function e(){}return e.register=function(t,o){e.requestFactroyHash[t]=o},e.get=function(t){if(!t)return null;var o=e.requestFactroyHash[t];if(!o)return cc.error("\u6ca1\u6709\u6ce8\u518c\u8be5\u7c7b\u578b\u7684\u751f\u6210\u5668\u51fd\u6570",t),null;var n=typeof o;if(o instanceof s)return o;if("function"===n){var i=o();return e.requestFactroyHash[t]=i,i}return null},e.requestFactroyHash={},e}();o.RequestAccountPool=c;var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.normalLogin=function(e,t,o){a.default.log.info("\u767b\u5f55\u53c2\u6570 = ",JSON.stringify(e)),r.service.server.request("connector.entryHandler.login",e,t,o)},t}(i.EventDispatcher);o.RequestAccount=s,cc._RF.pop()},{"../../core/Engine":"Engine","../../core/event/EventDispatcher":"EventDispatcher","../Service":"Service"}],RequestConfig:[function(e,t,o){"use strict";cc._RF.push(t,"0870cTNxU1Nl6Yz3T6+K0FJ","RequestConfig"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){return function(e){if(this.url="",this.method="get",this.baseURL="",this.headers={"Content-type":"application/x-www-form-urlencoded"},this.timeout=5e3,this.withCredentials=!1,this.responseType="json",this.validateStatus=function(e){return e>=200&&e<300},this.auth=null,this.callback=null,e&&"object"==typeof e)for(var t in e)this[t]=e[t]}}();o.RequestConfig=n,cc._RF.pop()},{}],RequestEntity:[function(e,t,o){"use strict";cc._RF.push(t,"bf1013nG+pG87+5SUVxleJz","RequestEntity"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(e,t,o,n,i){return e.config=t,o&&(e.code=o),e.request=n,e.response=i,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e},i=function(e,t,o,i,r){var a=new Error(e);return n(a,t,o,i,r)},r=function(e,t,o){var n=o.config.validateStatus;!n||n(o.status)?e(o):t(i("Request failed with status code "+o.status,o.config,null,o.request,o))},a=function(){var e=1;return function(t){return t+e++}}(),c=function(){function e(e){this.UUID="",this.$complete=null,this._config=null,this._xhr=null,this._config=e;var t=e.method.toUpperCase();if("GET"==t||"POST"==t){var o=e.url;if(this.UUID=a(o),e.baseURL&&!/^https?:\/\//.test(o)){var n=e.baseURL;"/"===o[0]&&(o=o.substring(1)),"/"===n[0]&&(n=n.substring(1)),o=n+"/"+o}var i=e.headers,r=new XMLHttpRequest;if(e.params&&"object"==typeof e.params){var c=[];for(var s in e.params)c.push(s+"="+e.params[s]);o=o+"?"+c.join("&")}if(o=encodeURI(o),r.open(t.toUpperCase(),o),r.timeout=e.timeout,cc.sys.isBrowser&&(r.withCredentials=e.withCredentials),e.auth){var l=e.auth.username||"",u=e.auth.password||"";l.toString();var p=window.Base64;i.Authorization="Basic "+p.encode(l+":"+u)}if("setRequestHeader"in r&&e.headers&&"object"==typeof e.headers)for(var d in e.headers)r.setRequestHeader(d,e.headers[d]);if(e.responseType)try{r.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}this.handlerXHRCallback(r,e),void 0===e.data&&(e.data=null),r.send(e.data)}else cc.error("[RequestEntity] \u4e0d\u652f\u6301\u5176\u4ed6\u65b9\u6cd5",e)}return Object.defineProperty(e.prototype,"config",{get:function(){return this._config},enumerable:!0,configurable:!0}),e.prototype.$abort=function(){try{this._xhr&&this._xhr.abort()}catch(e){}},e.prototype.$dispose=function(){this.$complete=null,this._xhr=null},e.prototype.handlerXHRCallback=function(e,t){var o=this,n=function(n){o.$complete&&e&&o.$complete(),t.callback&&t.callback(null,n)},a=function(n){o.$complete&&e&&o.$complete(),t.callback&&t.callback(n)};e.onreadystatechange=function(){if(e&&4===e.readyState&&(0!==e.status||e.responseURL&&0===e.responseURL.indexOf("file:"))){var o="getAllResponseHeaders"in e?e.getAllResponseHeaders():null,i={data:t.responseType&&"text"!==t.responseType?e.response:e.responseText,status:e.status,statusText:e.statusText,headers:o,config:t,request:e};r(n,a,i),e=null}},e.onabort=function(){e&&(a(i("Request aborted",t,"ECONNABORTED",e)),e=null)},e.ontimeout=function(){a(i("timeout of "+t.timeout+"ms exceeded",t,"ECONNABORTED",e)),e=null},e.onerror=function(){a(i("Network Error",t,null,e)),e=null}},e}();o.RequestEntity=c,cc._RF.pop()},{}],RequestFacebook:[function(e,t,o){"use strict";cc._RF.push(t,"9399f+NjtdCpb2A2KIUNjSB","RequestFacebook");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../core/ezplugin/ezplugin"),r=e("../../core/gui/GUI"),a=e("../Service"),c=e("./LoginType"),s=e("./RequestAccount"),l="RequestFacebook",u=function(e){function t(){var t=e.call(this)||this;return t.platform=3,t.userInfo=null,t.sdkLoginComplete=null,t.plugin&&t.plugin.addEventListener(t.pluginEventHandler.bind(t)),t}return n(t,e),Object.defineProperty(t.prototype,"plugin",{get:function(){return i.ezplugin.get("PluginFacebook")},enumerable:!0,configurable:!0}),t.prototype.pluginEventHandler=function(e,t){switch(cc.log("["+l+"] "+e+" "+t),e){case"logined":this.userInfo=JSON.parse(t),this.sdkLoginComplete&&this.sdkLoginComplete(this.userInfo),this.sdkLoginComplete=null;break;case"login_cancel":cc.log("\u5f53\u524d\u767b\u5f55\u53d6\u6d88"),this.sdkLoginComplete&&this.sdkLoginComplete(null),this.sdkLoginComplete=null,r.gui.notify.show("Login cancelled.",!1);break;case"login_error":cc.log("\u767b\u5f55\u5931\u8d25"),this.sdkLoginComplete&&this.sdkLoginComplete(null),this.sdkLoginComplete=null,r.gui.notify.show("Login error.",!1);break;case"logout":cc.log("\u73a9\u5bb6\u9000\u51fa\u767b\u5f55"),this.sdkLoginComplete&&this.sdkLoginComplete(null),this.sdkLoginComplete=null;break;case"update_error":cc.log("\u8d26\u53f7\u5347\u7ea7\u5931\u8d25")}},t.prototype.sdkLogin=function(e){this.userInfo=null,this.sdkLoginComplete=null,this.plugin?(cc.log("\u3010"+l+"\u3011 sdkLogin "),this.sdkLoginComplete=e,this.plugin.excute("login","")):(r.gui.notify.show("errorcode_10007",!0),e(null))},t.prototype.login=function(e){var t=this;if(this.userInfo){cc.log("\u3010"+l+"\u3011 login ");var o=this.userInfo,n=o.id,i=o.name,r="";o.picture&&o.picture.data.url&&(r=o.picture.data.url),this.normalLogin({platform:this.platform,accountId:n,nickname:i,avatar:r,os:cc.sys.os.toLowerCase()},e,function(){e(null)})}else this.sdkLogin(function(o){o?t.login(e):e(null)})},t.prototype.bindAccount=function(e){var t=this;cc.log("\u3010"+l+"\u3011 bindAccount "),a.service.prompt.netInstableOpen();var o=function(t){a.service.prompt.netInstableClose(),e(t)};this.sdkLogin(function(e){if(e){var n=e.id,i=e.name,r="";e.picture&&e.picture.data.url&&(r=e.picture.data.url),a.service.server.safetyRequest("connector.hallServerHandler.bindAccount",{platform:t.platform,accountId:n,nickname:i,avatar:r},function(e){e.accountId=n,e.nickname=i,o(e)},function(){o(null)})}else o(null)})},t.prototype.logout=function(){this.plugin&&this.plugin.excute("logout","")},t.prototype.exit=function(){},t}(s.RequestAccount);s.RequestAccountPool.register(c.LoginType.facebook,function(){return new u}),cc._RF.pop()},{"../../core/ezplugin/ezplugin":"ezplugin","../../core/gui/GUI":"GUI","../Service":"Service","./LoginType":"LoginType","./RequestAccount":"RequestAccount"}],RequestGoogle:[function(e,t,o){"use strict";cc._RF.push(t,"c34d8zrysBEd48B39oD3rdg","RequestGoogle");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../core/ezplugin/ezplugin"),r=e("../../core/gui/GUI"),a=e("../Service"),c=e("./LoginType"),s=e("./RequestAccount"),l="RequestGoogle",u=function(e){function t(){var t=e.call(this)||this;return t.platform=1,t.userInfo=null,t.sdkLoginComplete=null,t.plugin&&t.plugin.addEventListener(t.pluginEventHandler.bind(t)),t}return n(t,e),Object.defineProperty(t.prototype,"plugin",{get:function(){return i.ezplugin.get("PluginGoogle")},enumerable:!0,configurable:!0}),t.prototype.pluginEventHandler=function(e,t){switch(cc.log("["+l+"] "+e+" "+t),e){case"logined":this.userInfo=JSON.parse(t),this.sdkLoginComplete&&this.sdkLoginComplete(this.userInfo),this.sdkLoginComplete=null;break;case"login_cancel":cc.log("\u5f53\u524d\u767b\u5f55\u53d6\u6d88"),this.sdkLoginComplete&&this.sdkLoginComplete(null),this.sdkLoginComplete=null,r.gui.notify.show("Login cancelled.",!1);break;case"login_error":cc.log("\u767b\u5f55\u5931\u8d25"),this.sdkLoginComplete&&this.sdkLoginComplete(null),this.sdkLoginComplete=null,r.gui.notify.show("Login error.",!1);break;case"logout":cc.log("\u73a9\u5bb6\u9000\u51fa\u767b\u5f55"),this.sdkLoginComplete&&this.sdkLoginComplete(null),this.sdkLoginComplete=null;break;case"update_error":cc.log("\u8d26\u53f7\u5347\u7ea7\u5931\u8d25")}},t.prototype.sdkLogin=function(e){this.userInfo=null,this.sdkLoginComplete=null,this.plugin?(cc.log("\u3010"+l+"\u3011 sdkLogin "),this.sdkLoginComplete=e,this.plugin.excute("login","")):(r.gui.notify.show("errorcode_10008",!0),e(null))},t.prototype.login=function(e){var t=this;if(this.userInfo){cc.log("\u3010"+l+"\u3011 login ");var o=this.userInfo,n=o.id,i=o.name,r=o.avatar;this.normalLogin({platform:this.platform,accountId:n,nickname:i,avatar:r,os:cc.sys.os.toLowerCase()},e,function(){e(null)})}else this.sdkLogin(function(o){o?t.login(e):e(null)})},t.prototype.bindAccount=function(e){var t=this;cc.log("\u3010"+l+"\u3011 bindAccount "),a.service.prompt.netInstableOpen();var o=function(t){a.service.prompt.netInstableClose(),e(t)};this.sdkLogin(function(e){if(e){var n=e.id,i=e.name,r=e.avatar;a.service.server.safetyRequest("connector.hallServerHandler.bindAccount",{platform:t.platform,accountId:n,nickname:i,avatar:r},function(e){e.accountId=n,e.nickname=i,o(e)},function(){o(null)})}else o(null)})},t.prototype.logout=function(){this.plugin&&this.plugin.excute("logout","")},t.prototype.exit=function(){},t}(s.RequestAccount);s.RequestAccountPool.register(c.LoginType.google,function(){return new u}),cc._RF.pop()},{"../../core/ezplugin/ezplugin":"ezplugin","../../core/gui/GUI":"GUI","../Service":"Service","./LoginType":"LoginType","./RequestAccount":"RequestAccount"}],RequestSignInApple:[function(e,t,o){"use strict";cc._RF.push(t,"2266aH7EaZDB6Int0BMY2XI","RequestSignInApple");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../core/ezplugin/ezplugin"),r=e("../Service"),a=e("./RequestAccount"),c=e("../../core/gui/GUI"),s=e("./LoginType"),l="RequestSignInApple",u=function(e){function t(){var t=e.call(this)||this;return t.platform=4,t.userInfo=null,t.sdkLoginComplete=null,t.plugin&&t.plugin.addEventListener(t.pluginEventHandler.bind(t)),t}return n(t,e),Object.defineProperty(t.prototype,"plugin",{get:function(){return i.ezplugin.get("PluginSignInApple")},enumerable:!0,configurable:!0}),t.prototype.pluginEventHandler=function(e,t){switch(cc.log("["+l+"] "+e+" "+t),e){case"logined":this.userInfo=JSON.parse(t),this.sdkLoginComplete&&this.sdkLoginComplete(this.userInfo),this.sdkLoginComplete=null;break;case"login_cancel":cc.log("\u5f53\u524d\u767b\u5f55\u53d6\u6d88"),this.sdkLoginComplete&&this.sdkLoginComplete(null),this.sdkLoginComplete=null,c.gui.notify.show("login_cancel");break;case"login_error":cc.log("\u767b\u5f55\u5931\u8d25"),this.sdkLoginComplete&&this.sdkLoginComplete(null),this.sdkLoginComplete=null,c.gui.notify.show("login_error");break;case"logout":cc.log("\u73a9\u5bb6\u9000\u51fa\u767b\u5f55"),this.sdkLoginComplete&&this.sdkLoginComplete(null),this.sdkLoginComplete=null;break;case"update_error":cc.log("\u8d26\u53f7\u5347\u7ea7\u5931\u8d25")}},t.prototype.sdkBindAccount=function(e){this.userInfo=null,this.sdkLoginComplete=null,this.plugin?(cc.log("\u3010"+l+"\u3011 sdkBindAccount "),this.sdkLoginComplete=e,this.plugin.excute("bindAccount","")):(c.gui.notify.show("bind_apple_not_support"),e(null))},t.prototype.sdkLogin=function(e){this.userInfo=null,this.sdkLoginComplete=null,this.plugin?(cc.log("\u3010"+l+"\u3011 sdkLogin "),this.sdkLoginComplete=e,this.plugin.excute("login","")):(c.gui.notify.show("login_google_not_support"),e(null))},t.prototype.login=function(e){var t=this;if(this.userInfo){cc.log("\u3010"+l+"\u3011 login ");var o=this.userInfo,n=o.id||"";n&&n.length>40&&(n=n.substr(0,40));var r=o.name||i.ezplugin.sysInfo.username,a=o.avatar||"";this.normalLogin({platform:this.platform,accountId:n,nickname:r,avatar:a,os:cc.sys.os.toLowerCase()},e,function(){e(null)})}else this.sdkLogin(function(o){o?t.login(e):e(null)})},t.prototype.bindAccount=function(e){var t=this;cc.log("\u3010"+l+"\u3011 bindAccount "),r.service.prompt.netInstableOpen();var o=function(t){r.service.prompt.netInstableClose(),e(t)};this.sdkBindAccount(function(e){if(e){var n=e.id,a=e.name||i.ezplugin.sysInfo.username,c=e.avatar;r.service.server.safetyRequest("connector.hallHandler.bindAccount",{platform:t.platform,accountId:n,nickname:a,avatar:c},function(e){e.accountId=n,e.nickname=a,o(e)},function(){o(null)})}else o(null)})},t.prototype.logout=function(){this.plugin&&this.plugin.excute("logout","")},t.prototype.exit=function(){},t}(a.RequestAccount);a.RequestAccountPool.register(s.LoginType.apple,function(){return new u}),cc._RF.pop()},{"../../core/ezplugin/ezplugin":"ezplugin","../../core/gui/GUI":"GUI","../Service":"Service","./LoginType":"LoginType","./RequestAccount":"RequestAccount"}],RequestTwitter:[function(e,t,o){"use strict";cc._RF.push(t,"a5fc2WdPp5NEqTQp5vBs8q0","RequestTwitter");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i=e("./RequestAccount"),r=e("./LoginType"),a=e("../../core/ezplugin/ezplugin"),c=function(e){function t(){var t=e.call(this)||this;return t.platform=2,t}return n(t,e),Object.defineProperty(t.prototype,"plugin",{get:function(){return a.ezplugin.get("PluginTwitter")},enumerable:!0,configurable:!0}),t.prototype.sdkLogin=function(e){},t.prototype.login=function(e){},t.prototype.logout=function(){this.plugin&&this.plugin.excute("logout","")},t.prototype.bindAccount=function(e){},t.prototype.exit=function(){},t}(i.RequestAccount);i.RequestAccountPool.register(r.LoginType.twitter,function(){return new c}),cc._RF.pop()},{"../../core/ezplugin/ezplugin":"ezplugin","./LoginType":"LoginType","./RequestAccount":"RequestAccount"}],RequestVisitor:[function(e,t,o){"use strict";cc._RF.push(t,"dd8adTOThJM27bypLujSWiA","RequestVisitor");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i=e("../../core/ezplugin/ezplugin"),r=e("../config/Config"),a=e("./LoginType"),c=e("./RequestAccount"),s="RequestVisitor",l=function(e){function t(){var t=e.call(this)||this;return t.platform=0,t.uuid="",t.username="",t.plugin&&t.plugin.addEventListener(t.pluginEventHandler.bind(t)),t}return n(t,e),Object.defineProperty(t.prototype,"plugin",{get:function(){return i.ezplugin.get("PluginVisitor")},enumerable:!0,configurable:!0}),t.prototype.pluginEventHandler=function(e,t){switch(cc.log(e,t),e){case"logined":break;case"login_cancel":cc.log("\u5f53\u524d\u767b\u5f55\u53d6\u6d88");break;case"login_error":cc.log("\u767b\u5f55\u5931\u8d25");break;case"logout":cc.log("\u73a9\u5bb6\u9000\u51fa\u767b\u5f55")}},t.prototype.sdkLogin=function(e){cc.log("\u3010"+s+"\u3011 sdkLogin ");var t="";t=cc.sys.isBrowser?u():i.ezplugin.sysInfo.uuid||u(),this.uuid=t;var o=cc.sys.localStorage.getItem("visitor_username");o||(o=t.substr(0,8),cc.sys.localStorage.setItem("visitor_username",o)),this.username=o,e(this.uuid)},t.prototype.login=function(e){cc.log("\u3010"+s+"\u3011 login ");var t=r.default.query;this.normalLogin({accountId:cc.sys.isBrowser&&t.name||this.uuid,nickname:this.username,os:cc.sys.os.toLowerCase(),platform:this.platform,avatar:""},e,function(t){e(null)})},t.prototype.logout=function(){this.plugin&&this.plugin.excute("logout","")},t.prototype.bindAccount=function(e){},t.prototype.exit=function(){},t}(c.RequestAccount);c.RequestAccountPool.register(a.LoginType.visitor,function(){return new l});var u=function(){var e=cc.sys.localStorage.getItem("__uuid_");return e||(e=(e=cc.sys.os+cc.sys.platform+"_"+function(e,t){var o,n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),i=[];if(t=t||n.length,e)for(o=0;o<e;o++)i[o]=n[0|Math.random()*t];else{var r=void 0;for(i[8]=i[13]=i[18]=i[23]="-",i[14]="4",o=0;o<36;o++)i[o]||(r=0|16*Math.random(),i[o]=n[19==o?3&r|8:r])}return i.join("")}(13,16)).replace(/[\s]+/,""),cc.sys.localStorage.setItem("__uuid_",e)),e};cc._RF.pop()},{"../../core/ezplugin/ezplugin":"ezplugin","../config/Config":"Config","./LoginType":"LoginType","./RequestAccount":"RequestAccount"}],RoadNode:[function(e,t,o){"use strict";cc._RF.push(t,"a5569a7KTRDiKGvGCqxNAHv","RoadNode"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(){this._value=0,this._f=0,this._g=0,this._h=0,this._parent=null}return e.prototype.toString=function(){return"\u8def\u70b9\u50cf\u7d20\u5750\u6807\uff1a\uff08"+this._px+","+this._py+"),  \u8def\u70b9\u4e16\u754c\u5750\u6807\uff1a\uff08"+this._cx+","+this._cy+"),  \u8def\u70b9\u5e73\u9762\u76f4\u89d2\u5750\u6807\uff1a\uff08"+this._dx+","+this._dy+")"},Object.defineProperty(e.prototype,"px",{get:function(){return this._px},set:function(e){this._px=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"py",{get:function(){return this._py},set:function(e){this._py=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cx",{get:function(){return this._cx},set:function(e){this._cx=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cy",{get:function(){return this._cy},set:function(e){this._cy=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dx",{get:function(){return this._dx},set:function(e){this._dx=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dy",{get:function(){return this._dy},set:function(e){this._dy=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(e){this._value=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"f",{get:function(){return this._f},set:function(e){this._f=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"g",{get:function(){return this._g},set:function(e){this._g=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"h",{get:function(){return this._h},set:function(e){this._h=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this._parent},set:function(e){this._parent=e},enumerable:!0,configurable:!0}),e}();o.default=n,cc._RF.pop()},{}],SceneMap:[function(e,t,o){"use strict";cc._RF.push(t,"c916dGrd7xBI68ISKS34W/m","SceneMap");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("./base/MapType"),a=e("./layer/EntityLayer"),c=e("./layer/MapLayer"),s=e("./road/AstarHoneycombRoadSeeker"),l=e("./road/AStarRoadSeeker"),u=e("./road/MapRoadUtils"),p=cc._decorator,d=p.ccclass,h=p.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.layer=null,t.mapLayer=null,t.entityLayer=null,t.camera=null,t.isFollowPlayer=!1,t._roadDic={},t.targetPos=cc.Vec3.ZERO,t._mapData=null,t._mapRoadUtils=null,t}return n(t,e),Object.defineProperty(t.prototype,"mapRoadUtils",{get:function(){return this._mapRoadUtils||(this._mapRoadUtils=new u.default),this._mapRoadUtils},enumerable:!0,configurable:!0}),t.prototype.start=function(){this.node.x=-cc.winSize.width/2,this.node.y=-cc.winSize.height/2},t.prototype.onLoad=function(){},t.prototype.initMapData=function(e){var t=this;cc.loader.loadRes("map/citymap"+e,cc.JsonAsset,function(e,o){var n=o.json;t.init(n,null)})},t.prototype.init=function(e,t){this._mapData=e,this.mapRoadUtils.updateMapInfo(e.mapWidth,e.mapHeight,e.nodeWidth,e.nodeHeight,e.type),this.mapLayer.init(e.mapWidth,e.mapHeight,e.nodeWidth,e.nodeHeight,t);for(var o=e.roadDataArr.length,n=e.roadDataArr[0].length,i=0,a=0,c=0,u=0;u<o;u++)for(var p=0;p<n;p++){i=e.roadDataArr[u][p],a=p,c=u;var d=this.mapRoadUtils.getNodeByDerect(a,c);d.value=i,this._roadDic[d.cx+"_"+d.cy]=d}e.type==r.MapType.honeycomb?this._roadSeeker=new s.default(this._roadDic):this._roadSeeker=new l.default(this._roadDic),this.node.width=this.mapLayer.width,this.node.height=this.mapLayer.height},t.prototype.getMapNodeByPixel=function(e,t){var o=this.mapRoadUtils.getWorldPointByPixel(e,t);return this._roadDic[o.x+"_"+o.y]},t.prototype.addPlayer=function(e){e.sceneMap=this},t.prototype.onMapMouseDown=function(e){this.node.convertToNodeSpace(e.getLocation())},t.prototype.followPlayer=function(e){this.targetPos.x>this._mapData.mapWidth-cc.winSize.width?this.targetPos.x=this._mapData.mapWidth-cc.winSize.width:this.targetPos.x<0&&(this.targetPos.x=0),this.targetPos.y>this._mapData.mapHeight-cc.winSize.height?this.targetPos.y=this._mapData.mapHeight-cc.winSize.height:this.targetPos.y<0&&(this.targetPos.y=0)},t.prototype.movePlayer=function(e,t,o,n){if(this._roadSeeker){var i=this._mapRoadUtils.getWorldPointByPixel(e.node.x,e.node.y),r=this._mapRoadUtils.getWorldPointByPixel(t,o),a=this._roadDic[i.x+"_"+i.y],c=this._roadDic[r.x+"_"+r.y],s=this._roadSeeker.seekPath2(a,c);s.length>0&&e.walkByRoad(s,n)}},t.prototype.setViewToPoint=function(e,t){this.targetPos=cc.v3(e,t).sub(cc.v3(cc.winSize.width/2,cc.winSize.height/2)),this.targetPos.x>this._mapData.mapWidth-cc.winSize.width?this.targetPos.x=this._mapData.mapWidth-cc.winSize.width:this.targetPos.x<0&&(this.targetPos.x=0),this.targetPos.y>this._mapData.mapHeight-cc.winSize.height?this.targetPos.y=this._mapData.mapHeight-cc.winSize.height:this.targetPos.y<0&&(this.targetPos.y=0)},t.prototype.setViewToPlayer=function(e){this.setViewToPoint(e.node.x,e.node.y)},t.prototype.update=function(e){this._mapData&&this.isFollowPlayer&&this.followPlayer(e)},i([h(cc.Node)],t.prototype,"layer",void 0),i([h(c.default)],t.prototype,"mapLayer",void 0),i([h(a.default)],t.prototype,"entityLayer",void 0),i([h(cc.Camera)],t.prototype,"camera",void 0),i([h()],t.prototype,"isFollowPlayer",void 0),t=i([d],t)}(cc.Component);o.default=f,cc._RF.pop()},{"./base/MapType":"MapType","./layer/EntityLayer":"EntityLayer","./layer/MapLayer":"MapLayer","./road/AStarRoadSeeker":"AStarRoadSeeker","./road/AstarHoneycombRoadSeeker":"AstarHoneycombRoadSeeker","./road/MapRoadUtils":"MapRoadUtils"}],ScreenShakeRepeat:[function(e,t,o){"use strict";cc._RF.push(t,"3ac56+oK5NLVqQ4/z+t3G6L","ScreenShakeRepeat"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(e,t,o,n){this.isBegin=!1,this.shakeNode=e,this.nodeInitialPos=e.getposition,this.shakeStrengthX=o,this.shakeStrengthY=n,this.duration=t,this.isBegin=!1}return e.prototype.shakeForever=function(){if(!(window.ActiveXObject||"ActiveXObject"in window||this.isBegin)){this.isBegin=!0;var e=cc.repeatForever(cc.sequence(cc.moveTo(this.duration,cc.v2(-this.shakeStrengthX,-this.shakeStrengthY)),cc.moveTo(this.duration,cc.v2(2*-this.shakeStrengthX,2*-this.shakeStrengthY)),cc.moveTo(this.duration,cc.v2(-this.shakeStrengthX,2*-this.shakeStrengthY)),cc.moveTo(this.duration,cc.v2(0,2*-this.shakeStrengthY)),cc.moveTo(this.duration,cc.v2(this.shakeStrengthX,-this.shakeStrengthY)),cc.moveTo(this.duration,cc.v2(2*this.shakeStrengthX,2*-this.shakeStrengthY)),cc.moveTo(this.duration,cc.v2(2*this.shakeStrengthX,-this.shakeStrengthY)),cc.moveTo(this.duration,cc.v2(2*this.shakeStrengthX,0)),cc.moveTo(this.duration,cc.v2(this.shakeStrengthX,this.shakeStrengthY)),cc.moveTo(this.duration,cc.v2(2*this.shakeStrengthX,2*this.shakeStrengthY)),cc.moveTo(this.duration,cc.v2(this.shakeStrengthX,2*this.shakeStrengthY)),cc.moveTo(this.duration,cc.v2(0,2*this.shakeStrengthY)),cc.moveTo(this.duration,cc.v2(-this.shakeStrengthX,2*this.shakeStrengthY)),cc.moveTo(this.duration,cc.v2(2*-this.shakeStrengthX,2*this.shakeStrengthY)),cc.moveTo(this.duration,cc.v2(-this.shakeStrengthX,this.shakeStrengthY)),cc.moveTo(this.duration,cc.v2(0,0))));this.nodeInitialPos=this.shakeNode.position,this.shakeNode.runAction(e)}},e.prototype.stopShake=function(){this.isBegin=!1,this.nodeInitialPos&&(this.shakeNode.position=this.nodeInitialPos),this.shakeNode.stopAllActions()},e}();o.ScreenShakeRepeat=n,cc._RF.pop()},{}],ScreenShake:[function(e,t,o){"use strict";cc._RF.push(t,"96b51euLoRARYeYiYE8yLm8","ScreenShake"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../util/AsyncQueue"),i=function(){function e(e,t,o,n,i){this.shakeStrengthX=0,this.shakeStrengthY=0,this.nodeInitialPos=null,this.isBegin=!1,this.shakeNode=e,this.nodeInitialPos=e.getPosition(),this.shakeStrengthX=o,this.shakeStrengthY=n,this.duration=t,this.times=i,this.isBegin=!1}return e.prototype.shake=function(){var e=this;if(!(window.ActiveXObject||"ActiveXObject"in window)){var t=cc.repeat(cc.sequence(cc.moveTo(this.duration,cc.v2(this.nodeInitialPos.x-this.shakeStrengthX,this.nodeInitialPos.y-this.shakeStrengthY)),cc.moveTo(this.duration,cc.v2(this.nodeInitialPos.x-2*this.shakeStrengthX,this.nodeInitialPos.y-2*this.shakeStrengthY)),cc.moveTo(this.duration,cc.v2(this.nodeInitialPos.x-this.shakeStrengthX,this.nodeInitialPos.y-2*this.shakeStrengthY)),cc.moveTo(this.duration,cc.v2(this.nodeInitialPos.x,this.nodeInitialPos.y-2*this.shakeStrengthY)),cc.moveTo(this.duration,cc.v2(this.nodeInitialPos.x+this.shakeStrengthX,this.nodeInitialPos.y-this.shakeStrengthY)),cc.moveTo(this.duration,cc.v2(this.nodeInitialPos.x+2*this.shakeStrengthX,this.nodeInitialPos.y-2*this.shakeStrengthY)),cc.moveTo(this.duration,cc.v2(this.nodeInitialPos.x+2*this.shakeStrengthX,this.nodeInitialPos.y-this.shakeStrengthY)),cc.moveTo(this.duration,cc.v2(this.nodeInitialPos.x+2*this.shakeStrengthX,this.nodeInitialPos.y)),cc.moveTo(this.duration,cc.v2(this.nodeInitialPos.x+this.shakeStrengthX,this.nodeInitialPos.y+this.shakeStrengthY)),cc.moveTo(this.duration,cc.v2(this.nodeInitialPos.x+2*this.shakeStrengthX,this.nodeInitialPos.y+2*this.shakeStrengthY)),cc.moveTo(this.duration,cc.v2(this.nodeInitialPos.x+this.shakeStrengthX,this.nodeInitialPos.y+2*this.shakeStrengthY)),cc.moveTo(this.duration,cc.v2(this.nodeInitialPos.x,this.nodeInitialPos.y+2*this.shakeStrengthY)),cc.moveTo(this.duration,cc.v2(this.nodeInitialPos.x-this.shakeStrengthX,this.nodeInitialPos.y+2*this.shakeStrengthY)),cc.moveTo(this.duration,cc.v2(this.nodeInitialPos.x-2*this.shakeStrengthX,this.nodeInitialPos.y+2*this.shakeStrengthY)),cc.moveTo(this.duration,cc.v2(this.nodeInitialPos.x-this.shakeStrengthX,this.nodeInitialPos.y+this.shakeStrengthY)),cc.moveTo(this.duration,cc.v2(this.nodeInitialPos.x,this.nodeInitialPos.y))),this.times),o=cc.callFunc(function(){e.stopShake()}),n=cc.sequence(t,o);this.shakeNode.runAction(n)}},e.prototype.shakeForever=function(){if(!(window.ActiveXObject||"ActiveXObject"in window||this.isBegin)){this.isBegin=!0;var e=cc.repeatForever(cc.sequence(cc.moveTo(this.duration,cc.v2(this.nodeInitialPos.x-this.shakeStrengthX,this.nodeInitialPos.y-this.shakeStrengthY)),cc.moveTo(this.duration,cc.v2(this.nodeInitialPos.x-2*this.shakeStrengthX,this.nodeInitialPos.y-2*this.shakeStrengthY)),cc.moveTo(this.duration,cc.v2(this.nodeInitialPos.x-this.shakeStrengthX,this.nodeInitialPos.y-2*this.shakeStrengthY)),cc.moveTo(this.duration,cc.v2(this.nodeInitialPos.x,this.nodeInitialPos.y-2*this.shakeStrengthY)),cc.moveTo(this.duration,cc.v2(this.nodeInitialPos.x+this.shakeStrengthX,this.nodeInitialPos.y-this.shakeStrengthY)),cc.moveTo(this.duration,cc.v2(this.nodeInitialPos.x+2*this.shakeStrengthX,this.nodeInitialPos.y-2*this.shakeStrengthY)),cc.moveTo(this.duration,cc.v2(this.nodeInitialPos.x+2*this.shakeStrengthX,this.nodeInitialPos.y-this.shakeStrengthY)),cc.moveTo(this.duration,cc.v2(this.nodeInitialPos.x+2*this.shakeStrengthX,this.nodeInitialPos.y)),cc.moveTo(this.duration,cc.v2(this.nodeInitialPos.x+this.shakeStrengthX,this.nodeInitialPos.y+this.shakeStrengthY)),cc.moveTo(this.duration,cc.v2(this.nodeInitialPos.x+2*this.shakeStrengthX,this.nodeInitialPos.y+2*this.shakeStrengthY)),cc.moveTo(this.duration,cc.v2(this.nodeInitialPos.x+this.shakeStrengthX,this.nodeInitialPos.y+2*this.shakeStrengthY)),cc.moveTo(this.duration,cc.v2(this.nodeInitialPos.x,this.nodeInitialPos.y+2*this.shakeStrengthY)),cc.moveTo(this.duration,cc.v2(this.nodeInitialPos.x-this.shakeStrengthX,this.nodeInitialPos.y+2*this.shakeStrengthY)),cc.moveTo(this.duration,cc.v2(this.nodeInitialPos.x-2*this.shakeStrengthX,this.nodeInitialPos.y+2*this.shakeStrengthY)),cc.moveTo(this.duration,cc.v2(this.nodeInitialPos.x-this.shakeStrengthX,this.nodeInitialPos.y+this.shakeStrengthY)),cc.moveTo(this.duration,cc.v2(this.nodeInitialPos.x,this.nodeInitialPos.y))));this.shakeNode.runAction(e)}},e.prototype.shakeBigwin=function(){var e=this;if(!(window.ActiveXObject||"ActiveXObject"in window)){var t=cc.repeat(cc.sequence(cc.moveTo(this.duration,cc.v2(this.nodeInitialPos.x,this.nodeInitialPos.y-this.shakeStrengthY)),cc.moveTo(this.duration,cc.v2(this.nodeInitialPos.x,this.nodeInitialPos.y-2*this.shakeStrengthY)),cc.moveTo(this.duration,cc.v2(this.nodeInitialPos.x,this.nodeInitialPos.y-this.shakeStrengthY)),cc.moveTo(this.duration,cc.v2(this.nodeInitialPos.x,this.nodeInitialPos.y))),this.times),o=cc.repeat(cc.sequence(cc.scaleTo(this.duration,1.05,1.05),cc.scaleTo(this.duration,1.1,1.1),cc.scaleTo(this.duration,1.05,1.05),cc.scaleTo(this.duration,1,1)),this.times),i=n.AsyncQueue.excuteTimes(2,function(){e.stopShake()}),r=cc.callFunc(function(){i()}),a=cc.sequence(t,r);this.shakeNode.runAction(a);var c=cc.sequence(o,r);this.shakeNode.runAction(c)}},e.prototype.stopShake=function(){this.isBegin=!1,this.nodeInitialPos&&(this.shakeNode.position=this.nodeInitialPos),this.shakeNode.stopAllActions()},e}();o.ScreenShake=i,cc._RF.pop()},{"../util/AsyncQueue":"AsyncQueue"}],SelectBase:[function(e,t,o){"use strict";cc._RF.push(t,"c8ee3zXjfJKx7KhTci/4ubt","SelectBase");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._selectState=!1,t}return n(t,e),Object.defineProperty(t.prototype,"state",{get:function(){return this._selectState},set:function(e){this._selectState!==e&&(this._selectState=e,this.refresh())},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){this.refresh()},t.prototype.refresh=function(){},t}(cc.Component);o.default=i,cc._RF.pop()},{}],SellConfirm:[function(e,t,o){"use strict";cc._RF.push(t,"d7b99cdVThFEY67ZA0d/g6/","SellConfirm");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../core/Engine"),a=e("../../core/event/MessageManager"),c=e("../../core/language/LanguageLabel"),s=e("../../core/ui/ComponentExtends"),l=e("../../core/ui/label/LabelChangeSymbol"),u=e("../../core/ui/ViewUtils"),p=e("../../Main"),d=e("../../service/Service"),h=e("../CalcUiShow"),f=e("./adv/AdvControl"),g=cc._decorator,m=g.ccclass,v=(g.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.callback=null,t.closeFunc=null,t}return n(t,e),t.prototype.onLoad=function(){var e=u.ViewUtils.nodeTreeInfoLite(this.node),t=p.default.module.calcUiShow,o=p.default.module.calcTool.calcAddNum(t.calcCurrentCanGetFame(),p.default.module.vm.fame);if(e.get("right_lab").getComponent(l.LabelChangeSymbol).num=p.default.module.calcTool.calcDivideNum(o,p.default.module.vm.fame),e.get("right_lab").getComponent(l.LabelChangeSymbol).string="X"+e.get("right_lab").getComponent(l.LabelChangeSymbol).string,e.get("fame_lab").getComponent(l.LabelChangeSymbol).num=t.calcCurrentCanGetFame(),this.node.hasEventListener(cc.Node.EventType.TOUCH_END)||this.node.on(cc.Node.EventType.TOUCH_END,this.onBtnHandler,this),p.default.module.vm.level<10){var n=p.default.module.themeConfig.getBuildingConfigById(p.default.module.vm.level+1);p.default.module.calcTool.compare(p.default.module.vm.winTotal,{num:n.target,numE:n.targetE})?(e.get("unlock_lab").getComponent(c.LanguageLabel).dataID="ui_sale_5",e.get("unlock_lab").getComponent(c.LanguageLabel).setVars("ui_sale_5",""+r.default.i18n.getLangByID("ui_map_"+(p.default.module.vm.level+1)))):e.get("unlock_lab").getComponent(c.LanguageLabel).dataID="ui_sale_4"}},t.prototype.onAdded=function(e){this.callback=e.callback,this.closeFunc=e.closeFunc},t.prototype.onBtnHandler=function(e){var t=this;switch(e.target.name){case"btn_close":this.node.destroy(),this.closeFunc&&this.closeFunc();break;case"btn_sell":this.callback&&this.callback(1),this.node.destroy();break;case"btn_poster":if(cc.sys.isBrowser){cc.log("\u6d4f\u89c8\u5668\u76f4\u63a5\u53d1\u653e\u5356\u697c\u5956\u52b1"),this.node.destroy(),this.callback&&this.callback(1.2);var o=p.default.module.calcUiShow.changeTaskListByTypeCount(h.TaskType.WATCH_AD,1);return void p.default.module.gameProtocol.sendTaskList(o,function(e){p.default.module.vm.taskList=o})}a.Message.dispatchEvent(f.AdvMessage.PLAY,{callback:function(e,o){o==f.AdvRewardType.FAME_MUTI&&(e?(cc.log("\u5356\u697c\u89c2\u770b\u5e7f\u544a\u6210\u529f"),d.service.analytics.logEvent("ad_complete_sell","",""),t.callback&&t.callback(1.2),t.node.destroy()):(cc.log("\u5356\u697c\u89c2\u770b\u5e7f\u544a\u5931\u8d25"),t.callback&&t.callback(1)))},type:f.AdvRewardType.FAME_MUTI})}},t.prototype.onDestroy=function(){this.callback=null,a.Message.removeEventTarget(this),e.prototype.onDestroy.call(this)},t=i([m],t)}(s.ComponentExtends));o.default=v,cc._RF.pop()},{"../../Main":"Main","../../core/Engine":"Engine","../../core/event/MessageManager":"MessageManager","../../core/language/LanguageLabel":"LanguageLabel","../../core/ui/ComponentExtends":"ComponentExtends","../../core/ui/ViewUtils":"ViewUtils","../../core/ui/label/LabelChangeSymbol":"LabelChangeSymbol","../../service/Service":"Service","../CalcUiShow":"CalcUiShow","./adv/AdvControl":"AdvControl"}],SerllStoresAnim:[function(e,t,o){"use strict";cc._RF.push(t,"53959uEAldPwbKqXr+un6/M","SerllStoresAnim");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../core/Engine"),a=e("../../core/ui/ComponentExtends"),c=cc._decorator,s=c.ccclass,l=(c.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.onLoad=function(){this.node.hasEventListener(cc.Node.EventType.TOUCH_END)},t.prototype.onAdded=function(e){var t=this;this.node.getChildByName("particle").active=!1,this.node.getChildByName("unlock1").active=!1,this.node.getChildByName("unlock2").active=!1,this.node.getChildByName("unlock3").active=!1;var o=this.node.getChildByName("hetong").getComponent(sp.Skeleton),n="zh"==r.default.i18n.currentLanguage?"cn":"en";o.setSkin(n),o.setEventListener(function(e,o){"1"==o.data.name&&(t.node.getChildByName("particle").active=!0,t.node.getChildByName("unlock1").active=!0,t.scheduleOnce(function(){t.node.getChildByName("unlock3").active=!0},.2),t.scheduleOnce(function(){t.node.getChildByName("unlock2").active=!0},.4))}),o.setCompleteListener(function(n){"reward"==n.animation.name&&(o.setAnimation(0,"reward_idle",!0),t.scheduleOnce(function(){t.node.getChildByName("bg").RunAction(ezaction.fadeTo(1/3,0)).onStoped(function(){e.callback&&e.callback(),t.node.destroy()}),t.node.getChildByName("hetong").RunAction(ezaction.fadeTo(1/3,0)),t.node.getChildByName("unlock1").RunAction(ezaction.fadeTo(1/3,0)),t.node.getChildByName("unlock2").RunAction(ezaction.fadeTo(1/3,0)),t.node.getChildByName("unlock3").RunAction(ezaction.fadeTo(1/3,0))},3))}),this.node.once(cc.Node.EventType.TOUCH_END,function(){o.setAnimation(0,"reward",!1),t.node.getChildByName("skeleton").active=!1},this)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t=i([s],t)}(a.ComponentExtends));o.default=l,cc._RF.pop()},{"../../core/Engine":"Engine","../../core/ui/ComponentExtends":"ComponentExtends"}],ServerTest:[function(e,t,o){"use strict";cc._RF.push(t,"e06a5sRGwRO+6yTcucXdO2d","ServerTest");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("./core/Engine"),a=e("./core/ezplugin/ezplugin"),c=e("./core/gui/GUI"),s=e("./core/ui/ViewUtils"),l=e("./service/config/Config"),u=cc._decorator.ccclass,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.viewObj=null,t.config=null,t.config_test=null,t.next=null,t.selected=null,t}return n(t,e),t.prototype.onLoad=function(){this.viewObj=s.ViewUtils.nodeTreeInfoLite(this.node),this.node.on(cc.Node.EventType.TOUCH_END,this.clickHandler,this)},t.prototype.initLogPrint=function(){if("undefined"!=typeof jsb&&jsb){cc.log;var e=a.ezplugin.get("PluginOS"),t=function(){for(var t=r.default.timer.format("MM-dd hh:mm:ss",new Date)+" ",o=0;o<arguments.length;o++)t+=arguments[o]+" , ";e&&e.excute("nslog",t)};cc.log=t,cc.warn=t,cc.error=t}},t.prototype.onAdded=function(e){this.next=e.next;var t=e.data;t?(this.config_test=t.debug,this.config=t.release):(this.config=l.default.game.data,this.config_test=l.default.game.data),this.setInputShow(this.config_test)},t.prototype.onDestroy=function(){this.next=null,this.config=null,this.config_test=null,this.selected=null,this.viewObj=null,cc.loader.releaseRes("debug/LogPanel",cc.Prefab)},t.prototype.setInputShow=function(e){e&&(this.selected=e,this.viewObj.get("input_server").getComponent(cc.EditBox).string=e.server,this.viewObj.get("input_res_server").getComponent(cc.EditBox).string=""+e.res_server,this.viewObj.get("lab_desc").getComponent(cc.Label).string=JSON.stringify(e,null,2))},t.prototype.clickHandler=function(e){switch(e.target.name){case"btn_enter":if(!this.selected)return;var t=this.viewObj.get("input_server").getComponent(cc.EditBox).string;this.selected.server=t,this.selected.res_server=this.viewObj.get("input_res_server").getComponent(cc.EditBox).string,this.next(this.selected),c.gui.delete(this.node);break;case"btn_aws":this.setInputShow(this.config);break;case"btn_145":this.setInputShow(this.config_test)}},t=i([u],t)}(cc.Component);o.default=p,cc._RF.pop()},{"./core/Engine":"Engine","./core/ezplugin/ezplugin":"ezplugin","./core/gui/GUI":"GUI","./core/ui/ViewUtils":"ViewUtils","./service/config/Config":"Config"}],Server:[function(e,t,o){"use strict";cc._RF.push(t,"af280Cp7+VHbIhEJvl9jYUE","Server");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i,r,a=e("../../core/event/EventObjectEmitter"),c=e("../../core/event/MessageManager"),s=e("../../core/net/NetProtocol"),l=e("../../core/net/Network"),u=e("../Service");(function(e){e.CHANGE="ServerEvent.CHANGE",e.DISCONNECTED_TICK="ServerEvent.DISCONNECTED_TICK",e.DISCONNECTED="ServerEvent.DISCONNECTED"})(i=o.ServerEvent||(o.ServerEvent={})),function(e){e[e.DISCONNECTED=0]="DISCONNECTED",e[e.INLANUCH_SERVER=1]="INLANUCH_SERVER",e[e.CONNECTTED=2]="CONNECTTED"}(r=o.ServerState||(o.ServerState={}));var p=function(e){function t(t){void 0===t&&(t="Server");var o=e.call(this)||this;return o.tag="Server",o._uuid=Math.ceil(Date.now()/1e3),o._netProtocol=null,o._state=r.DISCONNECTED,o.serverInfo=null,o._disconnectAlertTimer=null,o._isInitEvents=!1,o._tryConnectTime=0,o._canConnect=!0,o._tempSaveRequestsCache=[],o.msgTarget=new c.MessageEventData,o.tag=t,o}return n(t,e),t.prototype.generateUUID=function(e){return e+(this._uuid++).toString()},Object.defineProperty(t.prototype,"netProtocol",{get:function(){return this._netProtocol||(this._netProtocol=new s.NetProtocol),this._netProtocol},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return this._state},enumerable:!0,configurable:!0}),t.prototype.setState=function(e){this._state=e,cc.warn("\u3010"+this.tag+"\u3011 state = "+e),this.emit(i.CHANGE)},Object.defineProperty(t.prototype,"canConnect",{set:function(e){this._canConnect=e},enumerable:!0,configurable:!0}),t.prototype.closeDisconnectAlertTimer=function(){this._disconnectAlertTimer&&(clearInterval(this._disconnectAlertTimer),this._disconnectAlertTimer=null)},t.prototype.stepTryConnectTime=function(){return this._tryConnectTime--},t.prototype.initEvents=function(){var e=this;if(!this._isInitEvents){this._isInitEvents=!0,this.msgTarget.on(l.NetworkEvent.CHANGE,function(t,o){o==l.NetworkState.OFFLINE&&(cc.warn("\u3010"+e.tag+"\u3011\u76d1\u542c\u5230\u7f51\u7edc\u65ad\u5f00\u4e8b\u4ef6\uff0c\u4e3b\u52a8\u65ad\u5f00tcp\u8fde\u63a5\uff01"),e._tryConnectTime=0,e.disconnect(!0),u.service.prompt.netInstableOpen())},this);var t=this.netProtocol;t.addEventListener(s.NetProtocolEvent.CLOSE,function(){cc.warn("\u3010"+e.tag+"\u3011Socket close\uff01"),e._state==r.CONNECTTED&&(e._tryConnectTime=10),e.networkCloseHandler(),u.service.analytics.logEvent("disconnect","close","")}),t.addEventListener(s.NetProtocolEvent.HEARTBEAT_TIMEOUT,function(){cc.warn("\u3010"+e.tag+"\u3011Socket HEARTBEAT_TIMEOUT!"),e._state==r.CONNECTTED&&(e._tryConnectTime=10),e.networkCloseHandler(),u.service.analytics.logEvent("disconnect","heartTimeout","")}),t.addEventListener(s.NetProtocolEvent.PARSE_ERROR,function(t){cc.warn("\u3010"+e.tag+"\u3011Socket protocol parse error!")})}},t.prototype.destroy=function(){this.msgTarget.removes(),this.msgTarget=null,this._netProtocol&&(this.disconnect(),this._netProtocol.destroy(),this._netProtocol=null),this._tempSaveRequestsCache=null,this.serverInfo=null,e.prototype.destroy.call(this)},t.prototype.setErrorCodeHandler=function(e){this.netProtocol.setErrorCodeListener(e)},t.prototype.connect=function(e,t){var o=this;this._canConnect=!0,this.initEvents(),this.serverInfo=e,cc.log("this.serverInfo",this.serverInfo);var n=function(){o.setState(r.CONNECTTED),t(!0)};this._state===r.DISCONNECTED?(cc.log("\u3010"+this.tag+"\u3011\u5c1d\u8bd5\u767b\u5f55\u670d\u52a1\u5668\uff01"),this.setState(r.INLANUCH_SERVER),this.$connectNetProtocol(this.serverInfo.shift(),n,function(){o.setState(r.DISCONNECTED),t(!1)})):(cc.log("\u3010"+this.tag+"\u3011\u670d\u52a1\u5668\u5df2\u7ecf\u662f\u8fde\u63a5\u72b6\u6001\uff01"),n())},t.prototype.$connectNetProtocol=function(e,t,o){var n=this;this.netProtocol.connect(e,t,function(e){cc.warn("\u3010"+n.tag+"\u3011$connectNetProtocol connect error",e);var i=n.serverInfo.shift();i?n.$connectNetProtocol(i,t,o):o()})},t.prototype.disconnect=function(e){if(void 0===e&&(e=!1),cc.log(this.tag+" \u670d\u52a1\u5668\u4e3b\u52a8disconnect",e),this.clearSafeRequestCache(),this._canConnect=!1,this._disconnectAlertTimer&&(clearInterval(this._disconnectAlertTimer),this._disconnectAlertTimer=null),this.setState(r.DISCONNECTED),this._netProtocol&&this._netProtocol.disconnect(),e)return this._canConnect=!0,void this.networkCloseHandler()},t.prototype.addProtocolListener=function(e,t){return this.netProtocol.addProtocolListener(e,t)},t.prototype.removeProtocolListener=function(e,t){if(this._netProtocol)return this._netProtocol.removeProtocolListener(e,t)},t.prototype.removeProtocolListeners=function(e){if(this._netProtocol)return this.netProtocol.removeProtocolListeners(e)},t.prototype.request=function(e,t,o,n){return void 0===n&&(n=null),this._state===r.CONNECTTED&&l.network.state==l.NetworkState.ONLINE?(cc.log("\u3010"+this.tag+"\u3011,\u8bf7\u6c42\u534f\u8bae "+e),this.netProtocol.request(e,t,o,n),!0):(cc.warn("\u3010"+this.tag+"\u3011\u5f53\u524d\u670d\u52a1\u5668\u72b6\u6001 "+this._state+"\uff0c\u65e0\u6cd5\u53d1\u9001\u534f\u8bae"),n(-1),!1)},t.prototype._$safeRequestHandler=function(e){for(var t=this._tempSaveRequestsCache,o=0,n=!0,i=t.length;o<i;n?o++:o)t[o]&&t[o].uuid===e?(t.splice(o,1),n=!1):n=!0},t.prototype.safetyRequest=function(e,t,o,n){var i=this;void 0===n&&(n=null),"function"==typeof t&&(n=o,o=t,t=null);for(var r=0,a=this._tempSaveRequestsCache;r<a.length;r++){if(a[r].uuid.indexOf(e)>=0)return void cc.warn("\u3010"+this.tag+"\u3011safetyRequest \u8b66\u544a\uff0c\u8c03\u7528safetyRequest\u5fc5\u987b\u7b49\u4e0a\u4e2a\u540c\u6837\u7684\u534f\u8bae\u8fd4\u56de\u540e\u624d\u53ef\u4ee5\u8c03\u7528\u4e0b\u4e00\u4e2a\u540c\u7b49\u534f\u8bae\uff01 "+e)}var c=this.generateUUID(e);this._tempSaveRequestsCache.push({uuid:c,protocol:e,params:t,sucess:o,failed:n});this.request(e,t,function(e){i._$safeRequestHandler(c),o&&o(e)},function(e){-1!=e&&(i._$safeRequestHandler(c),n&&n(e))})},t.prototype.clearSafeRequestCache=function(){this._tempSaveRequestsCache=[]},t.prototype.resendSafetyCacheRequest=function(){var e=this;if(cc.log("resendSafetyCacheRequest"),!(this._tempSaveRequestsCache.length<1)){var t=this._tempSaveRequestsCache.shift();cc.log("resendSafetyCacheRequest \u91cd\u65b0\u8865\u53d1\u9001\u534f\u8bae",t.protocol);var o=null;t.sucess&&(o=function(o){t.sucess(o),e.resendSafetyCacheRequest()});var n=null;t.failed&&(n=function(o){t.failed(o),e.resendSafetyCacheRequest()}),this.request(t.protocol,t.params,o,n)}},t.prototype.networkCloseHandler=function(){var e=this;this.emit(i.DISCONNECTED),this._state!=r.DISCONNECTED&&this._netProtocol&&this._netProtocol.disconnect(),this.setState(r.DISCONNECTED),!this._disconnectAlertTimer&&this._canConnect&&(u.service.prompt.netInstableOpen(),this._disconnectAlertTimer=setInterval(function(){e._state==r.DISCONNECTED&&e.emit(i.DISCONNECTED_TICK)},1e3))},t}(a.default);o.Server=p,cc._RF.pop()},{"../../core/event/EventObjectEmitter":"EventObjectEmitter","../../core/event/MessageManager":"MessageManager","../../core/net/NetProtocol":"NetProtocol","../../core/net/Network":"Network","../Service":"Service"}],Service:[function(e,t,o){"use strict";cc._RF.push(t,"444caKXHwRDiandpdSbMjmo","Service"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./server/Server"),i=e("./prompt/Prompt"),r=e("./account/Account"),a=e("./SettingManager"),c=e("./LogAnalytics"),s=e("./config/Config"),l=e("../core/Engine"),u=e("./ShareLink"),p=function(){function e(){}return e.init=function(t){e.analytics=new c.LogAnalytics,e.shareLink=new u.ShareLink("globaltycoon://"),e.setting=new a.SettingManager,e.prompt=new i.Prompt,cc.log("[service] \u8bfb\u53d6\u5ba2\u6237\u7aef\u914d\u7f6e config ");cc.loader.loadRes("config",function(o,i){o&&cc.error("\u52a0\u8f7dconfig.json\u5931\u8d25"),s.default.init(i.json||i),cc.log("[Service] config =",JSON.stringify(i.json)),l.default.i18n.supportLanguages=s.default.game.language,e.server=new n.Server("Server"),e.account=new r.Account(e.server),window.account=e.account,t(s.default.game.data)})},e.exitGame=function(){cc.log("\u3010service\u3011-> exitGame")},e.server=null,e.prompt=null,e.account=null,e.setting=null,e.analytics=null,e.shareLink=null,e}();o.service=p,cc._RF.pop()},{"../core/Engine":"Engine","./LogAnalytics":"LogAnalytics","./SettingManager":"SettingManager","./ShareLink":"ShareLink","./account/Account":"Account","./config/Config":"Config","./prompt/Prompt":"Prompt","./server/Server":"Server"}],SettingMailComponent:[function(e,t,o){"use strict";cc._RF.push(t,"2f1f8S4E21ESqD4pTz0Hqjt","SettingMailComponent");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../core/event/MessageManager"),a=e("../../core/gui/GUI"),c=e("../../core/ui/ComponentExtends"),s=e("../../core/ui/ExToggleGroup"),l=e("../../core/ui/ViewUtils"),u=e("../../Main"),p=e("../../service/account/LoginType"),d=e("../../service/account/RequestAccount"),h=e("../../service/Service"),f=e("../AudioMessage"),g=e("./effect/EditBoxControl"),m=e("./effect/HeadSelect"),v=(e("./SettingMailListItem"),cc._decorator),_=v.ccclass,y=v.property,b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.mailItemNode=null,t.selectNode=null,t.mainNodes=null,t.headId=1,t.mailItemPoool=[],t}return n(t,e),t.prototype.onLoad=function(){var e=this;h.service.analytics.logEvent("set_click_open","",""),this.mainNodes=l.ViewUtils.nodeTreeInfoLite(this.node),this.mainNodes.get("toggle_group").getComponent(s.default).toggleCallback=function(t){r.Message.dispatchEvent(f.AudioMessage.EFFECT,"ui_2"),e.mainNodes.get("personal_info").active="toggle1"==t.node.name,e.mainNodes.get("mails").active="toggle1"!=t.node.name,"toggle2"==t.node.name||e.refreshPersonalInfo(),e.mainNodes.get("toggle_group").getComponent(s.default).getItems().forEach(function(e){e.getChildByName("checkmark").active=t.node.name==e.name})},this.mainNodes.get("personal_info").active=!0,this.mainNodes.get("mails").active=!1,this.mainNodes.get("toggle_group").getComponent(s.default).setIndex(0),this.mainNodes.get("btns").children.forEach(function(t){t.getComponent(cc.Toggle)&&(t.on("toggle",function(o){t.getChildByName("Background").active=!o.isChecked,t.getChildByName("checkmark").active=o.isChecked,"btn_language"==t.name&&(o.isChecked?e.refreshLanguageList(u.default.module.vm.lang):e.refreshLanguageList(),e.mainNodes.get("language").getComponent(cc.Sprite).enabled=!o.isChecked),"btn_music"==t.name&&(u.default.audio.musicSwitch=o.isChecked),"btn_sound"==t.name&&(u.default.audio.effectSwitch=o.isChecked),"btn_notice"==t.name&&(u.default.module.vm.message=o.isChecked),r.Message.dispatchEvent(f.AudioMessage.EFFECT,"ui_2")},e),t.getChildByName("Background").active=!1,t.getChildByName("checkmark").active=!0)}),this.mainNodes.get("btns").getChildByName("btn_music").getComponent(cc.Toggle).isChecked=u.default.audio.musicSwitch,this.mainNodes.get("btns").getChildByName("btn_sound").getComponent(cc.Toggle).isChecked=u.default.audio.effectSwitch,this.refreshLanguageList(u.default.module.vm.lang),this.mainNodes.get("btns").getChildByName("btn_notice").getComponent(cc.Toggle).isChecked=u.default.module.vm.message,this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchHandler,this),this.refreshPersonalInfo(),this.mainNodes.get("language").children.forEach(function(t){t.on(cc.Node.EventType.TOUCH_END,function(t){u.default.module.vm.lang=t.target.name,e.mainNodes.get("btn_language").getComponent(cc.Toggle).isChecked=!0})}),this.refreshHeadNickName();var t=function(){h.service.analytics.logEvent("set_click_head","","");var t={touchClose:!0,onAdded:function(e,t){e.getChildByName("main").y=-200},onRemoved:function(t){var o=u.default.module.gamedata;e.headId=t.getComponent(m.default).headId,o.headId=e.headId,t.getComponent(m.default).headId=null}};a.gui.popup.add("popup/head_array",{targetNode:e.mainNodes.get("head"),headId:e.headId},t)};this.mainNodes.get("click_head").on(cc.Node.EventType.TOUCH_END,t,this),this.mainNodes.get("head").on(cc.Node.EventType.TOUCH_END,t,this)},t.prototype.refreshHeadNickName=function(){var e=this;this.mainNodes.get("head").active=!1,this.mainNodes.get("nickname").getComponent(cc.EditBox).string="";var t=u.default.module.gamedata;if(t.headId=5,t.headId){var o=cc.loader.getRes("main/head/head_"+t.headId,cc.SpriteFrame);this.headId=t.headId,this.mainNodes.get("head").active=!0,this.mainNodes.get("head").getComponent(cc.Sprite).spriteFrame=o,this.mainNodes.get("nickname").getComponent(cc.EditBox).string=""+t.nickName||h.service.account.data.uid+"",this.mainNodes.get("nickname").getComponent(g.default).initStr=""+t.nickName||h.service.account.data.uid+""}else u.default.module.gameProtocol.requestHead(h.service.account.data.uid,function(o){var n=cc.loader.getRes("main/head/head_"+(o.icon.icon||1),cc.SpriteFrame);e.headId=o.icon.icon||1,t.headId=e.headId,e.mainNodes.get("head").active=!0,e.mainNodes.get("head").getComponent(cc.Sprite).spriteFrame=n,e.mainNodes.get("nickname").getComponent(cc.EditBox).string=""+o.icon.nickName||h.service.account.data.uid+"",t.nickName=o.icon.nickName||h.service.account.data.uid+"",e.mainNodes.get("nickname").getComponent(g.default).initStr=""+o.icon.nickName||h.service.account.data.uid+""})},t.prototype.refreshLanguageList=function(e){e?this.mainNodes.get("language").children.forEach(function(t){t.active=t.name==e}):this.mainNodes.get("language").children.forEach(function(e){e.active=!0})},t.prototype.update=function(){this.refreshPersonalInfo()},t.prototype.refreshPersonalInfo=function(){},t.prototype.refreshMailList=function(){},t.prototype.removeItems=function(){this.mainNodes.get("main").getComponent(cc.ScrollView).scrollToTop(.2),this.mailItemPoool.forEach(function(e){e.removeFromParent(!0)}),this.mailItemPoool=[]},t.prototype.onDestroy=function(){this.mainNodes=null,this.headId=null,this.mailItemPoool=null,this.node.off(cc.Node.EventType.TOUCH_END,this.onTouchHandler,this),e.prototype.onDestroy.call(this)},t.prototype.onTouchHandler=function(e){switch(e.target.name){case"btn_close":a.gui.delete(this.node);break;case"sign_facebook":this.doLogin(p.LoginType.facebook);break;case"sign_google":this.doLogin(p.LoginType.google)}},t.prototype.doLogin=function(e){d.RequestAccountPool.get(e).sdkLogin(function(t){t&&h.service.account.login(e)});var t={};t[p.LoginType.visitor]="login_ghost",t[p.LoginType.facebook]="login_fb",t[p.LoginType.google]="login_gp",h.service.analytics.logEvent(t[e]||e,"","")},i([y(cc.Node)],t.prototype,"mailItemNode",void 0),i([y(cc.Node)],t.prototype,"selectNode",void 0),t=i([_],t)}(c.ComponentExtends);o.default=b,cc._RF.pop()},{"../../Main":"Main","../../core/event/MessageManager":"MessageManager","../../core/gui/GUI":"GUI","../../core/ui/ComponentExtends":"ComponentExtends","../../core/ui/ExToggleGroup":"ExToggleGroup","../../core/ui/ViewUtils":"ViewUtils","../../service/Service":"Service","../../service/account/LoginType":"LoginType","../../service/account/RequestAccount":"RequestAccount","../AudioMessage":"AudioMessage","./SettingMailListItem":"SettingMailListItem","./effect/EditBoxControl":"EditBoxControl","./effect/HeadSelect":"HeadSelect"}],SettingMailListItem:[function(e,t,o){"use strict";cc._RF.push(t,"1517bF+68hAcYsQXSxzuOO5","SettingMailListItem");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../core/ui/ComponentExtends"),a=e("../../core/ui/ViewUtils"),c=e("../../Main"),s=cc._decorator,l=s.ccclass,u=(s.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.onLoad=function(){},t.prototype.setData=function(e){var t=a.ViewUtils.nodeTreeInfoLite(this.node);t.get("title").getComponent(cc.Label).string=e.title,t.get("text").getComponent(cc.Label).string=e.content,t.get("date").getComponent(cc.Label).string=this.getTimeStr(e.date)},t.prototype.getTimeStr=function(e){if(e>c.default.module.calcUiShow.getSeverCurrentTime())return cc.warn("\u4e0d\u53ef\u4ee5\u5c0f\u4e8e\u5f53\u524d\u65f6\u95f4"),"\u4e0d\u53ef\u4ee5\u5c0f\u4e8e\u5f53\u524d\u65f6\u95f4";var t=c.default.module.calcUiShow.getSeverCurrentTime()-e,o=t/2592e6,n=-1,i="";if(o>=1)n=o,i="month";else{var r=t/864e5;if(r>=1)n=r,i="day";else{var a=t/36e5;if(a>=1)n=a,i="hour";else{var s=t/6e4;if(!(s>=1))return s<0?(cc.warn("\u4e0d\u53ef\u4ee5\u5c0f\u4e8e\u5f53\u524d\u65f6\u95f4"+s),"\u4e0d\u53ef\u4ee5\u5c0f\u4e8e\u5f53\u524d\u65f6\u95f4"+s):"just";n=s,i="minute"}}}return n<0?(cc.warn(n+"\u4e0d\u53ef\u5c0f\u4e8e\u5f53\u524d\u65f6\u95f4"),"error"):""+parseInt(n+"")+i+"ago"},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t=i([l],t)}(r.ComponentExtends));o.default=u,cc._RF.pop()},{"../../Main":"Main","../../core/ui/ComponentExtends":"ComponentExtends","../../core/ui/ViewUtils":"ViewUtils"}],SettingManager:[function(e,t,o){"use strict";cc._RF.push(t,"9ea07n5dztGqKrar4cY6j94","SettingManager"),Object.defineProperty(o,"__esModule",{value:!0});var n={SETTING:"setting"},i=function(){function e(){this._settingObj=null;var e=JSON.parse(cc.sys.localStorage.getItem(n.SETTING))||{};this._settingObj=e}return e.prototype.setSettingValue=function(e,t,o){void 0===o&&(o=!0),this._settingObj[e]=t,o&&this.save()},e.prototype.getSettingValue=function(e){return this._settingObj[e]},e.prototype.save=function(){var e=this._settingObj;cc.sys.localStorage.setItem(n.SETTING,JSON.stringify(e))},e}();o.SettingManager=i,cc._RF.pop()},{}],ShareLink:[function(e,t,o){"use strict";cc._RF.push(t,"18ca5bw3fJJ2oIIaPWTTT68","ShareLink"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../core/ezplugin/ezplugin"),i=e("./config/Config"),r=e("./Service"),a=function(){function e(e){void 0===e&&(e="epicslots://");var t=this;this.launchScheme="",this.pluginFirebaseEventId=0,this.launchLink="",this.launchScheme=e;var o=n.ezplugin.get("PluginFirebase");o&&(o.excute("getDynamicLink","",function(e,o){e?cc.error(e.message):t.launchLink=o}),this.pluginFirebaseEventId=o.addEventListener(function(e,o){switch(e){case"DynamicLinkChanged":t.launchLink=o}}))}return e.prototype.parseURL=function(e){var t=e.split("?"),o=t[0];if(t.length>0&&(o=t[1]),!o)return{};for(var n={},i=0,r=o.split("&");i<r.length;i++){var a=r[i];if(a){var c=a.split("=");if(c.length>0&&c[0]){var s=c[0],l=c[1]||"";n[s]=l}}}return n},e.prototype.parseLink=function(e){var t={};if(!e)return t;try{if(e.indexOf(this.launchScheme)<0){var o=decodeURIComponent(e);return this.parseURL(o)}var n="",i=this.parseURL(e);if(i.al_applink_data){var r=decodeURIComponent(i.al_applink_data),a=JSON.parse(r);a.target_url&&(n=a.target_url)}else i.target_url&&(n=decodeURIComponent(i.target_url));if(n){var c=this.parseURL(n).referrer;if(c)return c=decodeURIComponent(c),this.parseURL(c)}}catch(e){cc.log(e)}return t},e.prototype.getParams=function(){return this.parseLink(this.launchLink)},e.prototype.createShareLink=function(){var e=r.service.account.data.uid,t=r.service.account.data.accountId,o=i.default.game.data.fbshareLink||"",n="uid="+e+"&accid="+t+"&ctime="+Date.now();return o+"?referrer="+(n=encodeURIComponent(n))},e}();o.ShareLink=a,cc._RF.pop()},{"../core/ezplugin/ezplugin":"ezplugin","./Service":"Service","./config/Config":"Config"}],ShopClerkListItem:[function(e,t,o){"use strict";cc._RF.push(t,"bf24dXpkEpLer4/i0CYtUZs","ShopClerkListItem");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../core/event/MessageManager"),a=e("../../core/language/LanguageLabel"),c=e("../../core/ui/button/ButtonEffect"),s=e("../../core/ui/button/ButtonEffectSprite"),l=e("../../core/ui/ComponentExtends"),u=e("../../core/ui/label/LabelChangeSymbol"),p=e("../../core/ui/ViewUtils"),d=e("../../Main"),h=e("../AudioMessage"),f=e("./effect/LabTouchFont"),g=cc._decorator,m=g.ccclass,v=(g.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.clickCallback=null,t.params=null,t}return n(t,e),t.prototype.onLoad=function(){this.node.hasEventListener(cc.Node.EventType.TOUCH_END)||this.node.on(cc.Node.EventType.TOUCH_END,this.onBtnHandler,this);var e=p.ViewUtils.nodeTreeInfoLite(this.node);e.get("clerk_effect").getComponent(cc.Label).string="",e.get("clerk_spr").active=!1,e.get("clerk_func").getComponent(cc.Label).string=""},t.prototype.onBtnHandler=function(e){"btn_up"==e.target.name&&this.node.getChildByName("btn_up").getComponent(c.default).canTouch&&this.clickCallback&&(this.clickCallback(this.params),6==this.params.clerkId||9==this.params.clerkId||10==this.params.clerkId||12==this.params.clerkId?r.Message.dispatchEvent(h.AudioMessage.EFFECT,"buy_woman"):r.Message.dispatchEvent(h.AudioMessage.EFFECT,"buy_man"))},t.prototype.refreshBtnState=function(e,t){if(this.params.clerkLevel>d.default.module.themeConfig.getClerkMaxLvById(this.params.clerkId))return this.node.getChildByName("btn_unlock").active=!1,void(this.node.getChildByName("btn_up").active=!1);this.node.getChildByName("btn_unlock").active=t,this.node.getChildByName("btn_unlock").getComponent(c.default).canTouch=!1,this.node.getChildByName("btn_unlock").getChildByName("spr").active=!0,this.node.getChildByName("btn_unlock").getChildByName("lab").active=!1;var o=this.node.getChildByName("btn_up").getComponent(s.default);o&&(o.canTouch=e),this.node.getChildByName("btn_up").getChildByName("btn_lab").getComponent(f.default).canTouch=e},t.prototype.setData=function(e,t){var o=p.ViewUtils.nodeTreeInfoLite(this.node);this.params=e;var n=o.get("clerk_spr");n.active=!1,o.get("clerk_head").active=!1,cc.loader.loadRes("popup/shop/clerk/"+e.clerkTag,cc.SpriteFrame,function(e,t){n.getComponent(cc.Sprite).spriteFrame=t,n.active=!0}),o.get("clerk_name").getComponent(a.LanguageLabel).dataID="ui_npc_"+e.clerkId;var i=o.get("clerk_func");if(i.getComponent(cc.Label).string="",e.clerkId<=10?i.getComponent(a.LanguageLabel).dataID="ui_store_"+e.clerkId:i.getComponent(a.LanguageLabel).dataID="ui_clerk_5",o.get("clerk_effect").active=!0,e.clerkLevel>d.default.module.themeConfig.getClerkMaxLvById(e.clerkId))o.get("clerk_lv").getComponent(cc.Label).string="MAX",o.get("clerk_effect").active=!1,o.get("btn_lab").getComponent(cc.Label).string="...";else{o.get("clerk_lv").getComponent(cc.Label).string="lv"+e.clerkLevel;var r=e;if(o.get("clerk_effect").getComponent(a.LanguageLabel).dataID="ui_clerk_"+r.clerkRewardType,3!=r.clerkRewardType){var c="";if(1==r.clerkRewardType){d.default.module.calcTool.formatNum({num:r.clerkMultiTotal,numE:r.clerkMultiTotalE});c=""+r.clerkValue}else 2==r.clerkRewardType?c=r.clerkValue+"%":4==r.clerkRewardType&&(c=100*r.clerkValue+"%");o.get("clerk_effect").getComponent(a.LanguageLabel).setVars("ui_clerk_"+r.clerkRewardType,c)}d.default.module.calcTool;o.get("btn_lab").getComponent(u.LabelChangeSymbol).num={num:e.clerkPrice,numE:e.clerkPriceE}}},t.prototype.onDestroy=function(){this.params=null,this.clickCallback=null,e.prototype.onDestroy.call(this)},t=i([m],t)}(l.ComponentExtends));o.default=v,cc._RF.pop()},{"../../Main":"Main","../../core/event/MessageManager":"MessageManager","../../core/language/LanguageLabel":"LanguageLabel","../../core/ui/ComponentExtends":"ComponentExtends","../../core/ui/ViewUtils":"ViewUtils","../../core/ui/button/ButtonEffect":"ButtonEffect","../../core/ui/button/ButtonEffectSprite":"ButtonEffectSprite","../../core/ui/label/LabelChangeSymbol":"LabelChangeSymbol","../AudioMessage":"AudioMessage","./effect/LabTouchFont":"LabTouchFont"}],ShopComponent:[function(e,t,o){"use strict";cc._RF.push(t,"e2a7dH7O5hDBIA/MPj1TPR0","ShopComponent");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../core/event/MessageManager"),a=e("../../core/gui/GUI"),c=e("../../core/ui/button/ButtonEffect"),s=e("../../core/ui/ComponentExtends"),l=e("../../core/ui/ExToggleGroup"),u=e("../../core/ui/label/LabelChangeSymbol"),p=e("../../core/ui/ViewUtils"),d=e("../../core/util/AsyncQueue"),h=e("../../core/util/HashMap"),f=e("../../Main"),g=e("../../service/Service"),m=e("../AudioMessage"),v=e("../CalcUiShow"),_=e("./effect/LabTouchFont"),y=e("./FameConfirm"),b=e("./ShopClerkListItem"),C=e("./ShopPrestigeListItem"),T=cc._decorator,S=T.ccclass,E=T.property,L=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.mainNodes=null,t.shopItemNode=null,t.prestigeItemNode=null,t.clerkQuickParams=new h.HashMap,t.fameQuickParams=new h.HashMap,t.entryClerkList=null,t.initClerkActive=!1,t.initFameActive=!1,t.clerkItemPool=[],t.fameItemPool=[],t.canClickClerkBtn=!0,t.canClickFameBtn=!0,t.currentClerkQuickNum=null,t.currentFameQuickNum=null,t}return n(t,e),t.prototype.onLoad=function(){var e=this;g.service.analytics.logEvent("upgrade_click_open","",""),this.mainNodes=p.ViewUtils.nodeTreeInfoLite(this.node),this.refreshBtnState(),this.mainNodes.get("toggle_group").getComponent(l.default).toggleCallback=function(t){r.Message.dispatchEvent(m.AudioMessage.EFFECT,"ui_2"),e.mainNodes.get("toggle_group").getComponent(l.default).getItems().forEach(function(e){e.getChildByName("checkmark").active=t.node.name==e.name});var o=t.node.name.replace(/[^\d]+/,"");"1"==o?(e.refreshClerkList(),e.isShowQuickPanel()):"2"==o&&(g.service.analytics.logEvent("upgrade_click_prestige","",""),e.refreshFameList(),e.isShowQuickPanel())},this.mainNodes.get("toggle_group").getComponent(l.default).setIndex(0),this.entryClerkList=f.default.module.vm.clerkList,this.loadShopClerkList(),this.loadPrestigeList(),this.initActive(),this.isShowQuickPanel(),this.scollviewSwitch(!0),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchHandler,this)},t.prototype.initActive=function(){this.clerkQuickParams.size>1||1==this.clerkQuickParams.size&&this.clerkQuickParams.values()[0]>1?(this.initClerkActive=!0,this.mainNodes.get("salesman").height=780,this.mainNodes.get("salesman").y=-90):(this.initClerkActive=!1,this.mainNodes.get("salesman").height=930,this.mainNodes.get("salesman").y=-15),this.fameQuickParams.size>1||1==this.fameQuickParams.size&&this.fameQuickParams.values()[0]>1?(this.initFameActive=!0,this.mainNodes.get("prestige").height=440,this.mainNodes.get("prestige").y=-260):(this.initFameActive=!1,this.mainNodes.get("prestige").height=600,this.mainNodes.get("prestige").y=-180)},t.prototype.isShowQuickPanel=function(){var e=this.mainNodes.get("toggle_group").getComponent(l.default).getIndex();this.mainNodes.get("explain_clerk").active=this.initClerkActive&&0==e,this.mainNodes.get("explain_fame").active=this.initFameActive&&1==e,this.mainNodes.get("public_get").active=1==e},t.prototype.loadShopClerkList=function(){var e=f.default.module.vm,t=p.ViewUtils.nodeTreeInfoLite(this.node.getChildByName("salesman")).get("content");this.shopItemNode.active=!0;var o=d.AsyncQueue.excuteTimes(12,function(){});for(var n in e.clerkList){var i=parseInt(e.clerkList[n].id),r=e.clerkList[n],a=this.getUpClerkLv(n,i,r.level);if(a||(a={clerkTag:n,clerkId:i,clerkLevel:r.level+1}),i-1==0){(c=this.shopItemNode.getComponent(b.default)).setData(a,o),c.clickCallback||(c.clickCallback=this.clerkItemClickHandler.bind(this)),this.shopItemNode.name=i+"",this.clerkItemPool.push(this.shopItemNode)}else{var c,s=cc.instantiate(this.shopItemNode);s.parent=t,(c=s.getComponent(b.default)).setData(a,o),c.clickCallback||(c.clickCallback=this.clerkItemClickHandler.bind(this)),s.name=i+"",this.clerkItemPool.push(s)}}this.refreshBtnState(),this.calcCountClerkPrice()},t.prototype.refreshClerkList=function(){var e=this;this.scollviewSwitch(!0);var t=f.default.module.vm;p.ViewUtils.nodeTreeInfoLite(this.node.getChildByName("salesman")).get("content").children.forEach(function(o){var n=o.getComponent(b.default),i=n.params.clerkTag,r=n.params.clerkId,a=t.clerkList[i],c=e.getUpClerkLv(i,r,a.level);c||(c={clerkTag:i,clerkId:r,clerkLevel:a.level+1}),n.setData(c)})},t.prototype.changeClerkList=function(e){var t=e.keys(),o=f.default.module.vm.clerkList,n={};for(var i in o)-1!=t.indexOf(o[i].id)?n[i]={id:o[i].id,level:o[i].level+e.get(o[i].id)}:n[i]={id:o[i].id,level:o[i].level};return n},t.prototype.clerkItemClickHandler=function(e){var t=f.default.module.vm;if(!f.default.module.calcTool.compare(t.credit,{num:e.clerkPrice,numE:e.clerkPriceE}))return cc.warn("\u5347\u7ea7\u5e97\u5458\u4f59\u989d\u4e0d\u8db3"),void a.gui.notify.show("lack_credit");var o=new h.HashMap;o.set(e.clerkId,1),this.clerkLvUp(o,{num:e.clerkPrice,numE:e.clerkPriceE})},t.prototype.clerkClickQuickBtnHandler=function(e){e.target.getComponent(c.default).canTouch&&(g.service.analytics.logEvent("upgrade_click_quickemp","",""),this.clerkQuickParams.size>0&&(r.Message.dispatchEvent(m.AudioMessage.EFFECT,"shop_batch"),this.clerkLvUp(this.clerkQuickParams,this.currentClerkQuickNum)))},t.prototype.clerkLvUp=function(e,t){var o=this;cc.log("canClickClerkBtn"+this.canClickClerkBtn);var n=f.default.module.vm,i=this.changeClerkList(e);n.clerkList=i,f.default.module.gameProtocol.sendClerkList(i,function(e){}),f.default.module.calcUiShow.refreshCredit({num:-t.num,numE:t.numE},function(){o.refreshClerkList(),o.refreshBtnState(),o.calcCountClerkPrice()},!0);var r=this.changTaskListOnUpLvClerk(e);f.default.module.gameProtocol.sendTaskList(r,function(e){n.taskList=r})},t.prototype.changTaskListOnUpLvClerk=function(e){var t=0;return e.values().forEach(function(e){t+=e}),f.default.module.calcUiShow.changeTaskListByTypeCount(v.TaskType.CLERK_UP,t)},t.prototype.changTaskListOnUpLvFame=function(e){var t=0;return e.values().forEach(function(e){t+=e}),f.default.module.calcUiShow.changeTaskListByTypeCount(v.TaskType.FAME_UP,t)},t.prototype.getUpClerkLv=function(e,t,o,n){void 0===n&&(n=1);var i=f.default.module.themeConfig.getClerkConfigBytagLv(e,o+n);if(i)return i;cc.warn(e+"\u6807\u7b7e\u6216\u8005"+(o+n)+"}\u3010\u627e\u4e0d\u5230\u5bf9\u5e94\u914d\u7f6e\u3011\u6216\u5df2\u5230\u6700\u5927\u7b49\u7ea7")},t.prototype.calcCountClerkPrice=function(e,t){void 0===e&&(e=!0),void 0===t&&(t=!0);var o=function(e){e.sort(function(e,t){return f.default.module.calcTool.compare(e.price,t.price)?f.default.module.calcTool.compare(e.price,t.price)?1:0:-1})},n=[];f.default.module.gamedata.clerksIdLv.keys().forEach(function(e){0!=f.default.module.gamedata.storesIdLv.get(e)&&n.push(e)}),n.push(11,12);var i=new h.HashMap,r=0,a={num:0,numE:0},c=function(e){if(0!=n.length){r++;var t=[];n.forEach(function(e){var o=f.default.module.gamedata.clerksIdLv.get(e)+r,i=f.default.module.themeConfig.getClerkConfigBytagLv("clerk_"+e,o);if(i){var a={price:{num:i.clerkPrice,numE:i.clerkPriceE},id:e,canUpLv:r};t.push(a)}else n.splice(n.indexOf(e),1)}),o(t);var s={num:0,numE:0};t.forEach(function(t){var o=f.default.module.calcTool.calcAddNum(s,t.price);f.default.module.calcTool.compare(e,o)?(s=f.default.module.calcTool.calcAddNum(s,t.price),i.set(t.id,t.canUpLv)):n.splice(n.indexOf(t.id),1)}),a=f.default.module.calcTool.calcAddNum(a,s);var l=f.default.module.calcTool.calcMinusNum(e,s);c(l)}};if(c(f.default.module.vm.credit),this.currentClerkQuickNum=a,this.mainNodes.get("clerk_lab").getComponent(u.LabelChangeSymbol).num=a,this.showButtonEffect(this.mainNodes.get("btn_quick_clerk"),i.size>0),this.clerkQuickParams=i,t){var s=p.ViewUtils.nodeTreeInfoLite(this.node.getChildByName("salesman")).get("content"),l=[];s.children.forEach(function(e){var t=e.getComponent(b.default).params,o={price:{num:t.clerkPrice,numE:t.clerkPriceE},id:t.clerkId};l.push(o)}),o(l);var d=[];l.forEach(function(e){d.push(e.id)});var g=s.children;g.forEach(function(e){var t=e.getComponent(b.default).params;t.clerkLevel>f.default.module.themeConfig.getClerkMaxLvById(t.clerkId)?e.zIndex=50+t.clerkId:1==t.clerkLevel&&0==f.default.module.gamedata.storesIdLv.get(t.clerkId)?e.zIndex=100+t.clerkId:e.zIndex=d.indexOf(e.getComponent(b.default).params.clerkId)+t.clerkId/100}),g.sort(function(e,t){return e.zIndex-t.zIndex});var m=g[0].height,v=15+g.length*(10+m);s.height=v;for(var _=0;_<g.length;_++){var y=g[_],C=y.y,T=-15-_*(m+10)-m/2,S=Math.abs(C-T);e||S<5?y.y=T:y.RunAction(ezaction.moveTo(S/1666,{y:T}))}}},t.prototype.refreshBtnState=function(){this.node.getChildByName("salesman").active&&p.ViewUtils.nodeTreeInfoLite(this.node.getChildByName("salesman")).get("content").children.forEach(function(e){var t=e.getComponent(b.default);if(e.active&&t.params){var o,n=t.params;o=0==f.default.module.gamedata.storesIdLv.get(n.clerkId)&&n.clerkId<=10,t.refreshBtnState(f.default.module.calcTool.compare(f.default.module.vm.credit,{num:n.clerkPrice,numE:n.clerkPriceE}),o)}});this.node.getChildByName("prestige").active&&p.ViewUtils.nodeTreeInfoLite(this.node.getChildByName("prestige")).get("content").children.forEach(function(e){var t=e.getComponent(C.default);if(e.active&&t.params){var o,n=t.params;o=0==f.default.module.gamedata.storesIdLv.get(n.id)&&n.id<=10,t.refreshBtnState(f.default.module.calcTool.compare(f.default.module.vm.fame,{num:n.price,numE:n.priceE}),o)}})},t.prototype.loadPrestigeList=function(){var e=p.ViewUtils.nodeTreeInfoLite(this.node.getChildByName("prestige")).get("content");this.prestigeItemNode.active=!0;var t=f.default.module.vm;for(var o in t.fameList){var n=t.fameList[o],i=parseInt(n.id),r=n.level;if(i<=11){var a=this.getUpFamekLv(o,i,r);if(a||(a={tag:o,id:i,level:r+1}),i-1==0){(c=this.prestigeItemNode.getComponent(C.default)).setData(a),c.clickCallback||(c.clickCallback=this.fameItemClickHandler.bind(this)),this.prestigeItemNode.name=i+"",this.fameItemPool.push(this.prestigeItemNode)}else{var c,s=cc.instantiate(this.prestigeItemNode);s.parent=e,(c=s.getComponent(C.default)).setData(a),c.clickCallback||(c.clickCallback=this.fameItemClickHandler.bind(this)),s.name=i+"",this.fameItemPool.push(s)}f.default.module.gamedata.fameIdLv.set(i,r)}}this.refreshBtnState(),this.calcCountFamePrice()},t.prototype.refreshFameList=function(){var e=this;this.scollviewSwitch(!1);var t=f.default.module.vm;p.ViewUtils.nodeTreeInfoLite(this.node.getChildByName("prestige")).get("content").children.forEach(function(o){var n=o.getComponent(C.default),i=n.params.tag,r=n.params.id,a=t.fameList[i],c=e.getUpFamekLv(i,r,a.level);c||(c={tag:i,id:r,level:a.level+1}),n.setData(c)})},t.prototype.calcCountFamePrice=function(e){void 0===e&&(e=!0);var t=function(e){e.sort(function(e,t){return f.default.module.calcTool.compare(e.price,t.price)?f.default.module.calcTool.compare(e.price,t.price)?1:0:-1})},o=f.default.module.gamedata.fameIdLv.keys();o.forEach(function(e){f.default.module.gamedata.storesIdLv.get(e)<=f.default.module.calcUiShow.checkLockStoreIdByLevel()&&o.push(e)});var n=new h.HashMap,i=0,r={num:0,numE:0},a=function(e){if(0!=o.length){i++;var c=[];o.forEach(function(e){var t=f.default.module.gamedata.fameIdLv.get(e)+i,n=f.default.module.themeConfig.getFameConfigByTagLv("fame_"+e,t);if(n){var r={price:{num:n.price,numE:n.priceE},id:e,canUpLv:i};c.push(r)}else o.splice(o.indexOf(e),1)}),t(c);var s={num:0,numE:0};c.forEach(function(t){var i=f.default.module.calcTool.calcAddNum(s,t.price);f.default.module.calcTool.compare(e,i)?(s=f.default.module.calcTool.calcAddNum(s,t.price),n.set(t.id,t.canUpLv)):o.splice(o.indexOf(t.id),1)}),r=f.default.module.calcTool.calcAddNum(r,s);var l=f.default.module.calcTool.calcMinusNum(e,s);a(l)}};a(f.default.module.calcTool.calcDivideNum(f.default.module.vm.fame,{num:1,numE:2})),this.currentFameQuickNum=r,this.mainNodes.get("fame_lab").getComponent(u.LabelChangeSymbol).num=r,this.showButtonEffect(this.mainNodes.get("btn_quick_fame"),n.size>0),this.fameQuickParams=n;var c=p.ViewUtils.nodeTreeInfoLite(this.node.getChildByName("prestige")).get("content"),s=[];c.children.forEach(function(e){var t=e.getComponent(C.default).params,o={price:{num:t.price,numE:t.priceE},id:t.id};s.push(o)}),t(s);var l=[];s.forEach(function(e){l.push(e.id)}),c.children.forEach(function(e){var t=e.getComponent(C.default).params;t.id>f.default.module.themeConfig.getBuildingConfigById(f.default.module.vm.level).count&&11!=t.id?e.zIndex=30+t.id:e.zIndex=l.indexOf(e.getComponent(C.default).params.id)+t.id/100});var d=c.children;d.sort(function(e,t){return e.zIndex-t.zIndex});var g=d[0].height,m=15+d.length*(10+g);c.height=m;for(var v=0;v<d.length;v++){var _=d[v],y=_.y,b=-15-v*(g+10)-g/2,T=Math.abs(y-b);e||T<5?_.y=b:_.RunAction(ezaction.moveTo(T/1666,{y:b}))}},t.prototype.fameClickQuickBtnHandler=function(e){if(e.target.getComponent(c.default).canTouch){cc.log("canClickFameBtn"+this.canClickFameBtn);var t=f.default.module.vm;if(g.service.analytics.logEvent("upgrade_click_quickpre","",""),!f.default.module.calcTool.compare(t.fame,this.currentFameQuickNum))return cc.warn("\u5347\u7ea7\u58f0\u671b\u4f59\u989d\u4e0d\u8db3"),void a.gui.notify.show("lack_credit");this.fameQuickParams.size>0&&(r.Message.dispatchEvent(m.AudioMessage.EFFECT,"shop_batch"),this.fameLvUp(this.fameQuickParams,this.currentFameQuickNum))}},t.prototype.fameItemClickHandler=function(e,t){var o=this,n=f.default.module.vm;if(cc.log("canClickFameBtn"+this.canClickFameBtn),!f.default.module.calcTool.compare(n.fame,{num:e.price,numE:e.priceE}))return cc.warn("\u5347\u7ea7\u58f0\u671b\u4f59\u989d\u4e0d\u8db3"),void a.gui.notify.show("lack_credit");if(!f.default.module.calcTool.compare(n.fame,{num:e.price,numE:e.priceE}))return cc.warn("\u5347\u7ea7\u58f0\u671b\u4f59\u989d\u4e0d\u8db3"),void a.gui.notify.show("lack_credit");var i=f.default.module.calcTool.calcDivideNum({num:e.price,numE:e.priceE},n.fame),r=Math.floor(i.num*Math.pow(10,i.numE)*100);if(r>=1){var c={modal:!0,opacity:180,onAdded:function(t){t.getComponent(y.default).clickCallback=function(){var n=new h.HashMap;n.set(e.id,1),o.fameLvUp(n,{num:e.price,numE:e.priceE},function(){t.destroy()})}}};a.gui.popup.add("popup/fame_confirm",{per:r,id:e.id},c)}else{var s=new h.HashMap;s.set(e.id,1),this.fameLvUp(s,{num:e.price,numE:e.priceE})}},t.prototype.changeFameList=function(e){var t=e.keys(),o=f.default.module.vm.fameList,n={};for(var i in o)-1!=t.indexOf(o[i].id)?n[i]={id:o[i].id,level:o[i].level+e.get(o[i].id)}:n[i]={id:o[i].id,level:o[i].level};return n},t.prototype.fameLvUp=function(e,t,o){var n=this,i=f.default.module.vm,r=this.changeFameList(e);f.default.module.gameProtocol.sendFameList(r,function(e){});var a=this.changeStoreList(e);f.default.module.calcUiShow.refreshFame({num:-t.num,numE:t.numE},function(){i.fameList=r,n.refreshFameList(),n.refreshBtnState(),n.calcCountFamePrice(),o&&o()}),i.storeList=a,f.default.module.gameProtocol.sendStoreList(a,function(e){});var c=this.changTaskListOnUpLvFame(e);f.default.module.gameProtocol.sendTaskList(c,function(e){i.taskList=c})},t.prototype.changeStoreList=function(e){var t=e.keys(),o=new h.HashMap;t.forEach(function(t){for(var n=e.get(t),i=0,r="fame_"+t,a=f.default.module.vm.fameList[r].level,c=1;c<=n;c++){var s=f.default.module.themeConfig.getFameConfigByTagLv(r,a+c);3==s.type&&(i+=s.levelUp)}o.set(t,i)});var n=f.default.module.vm.storeList,i={};for(var r in n){var a=f.default.module.themeConfig.getStoreMaxLvById(n[r].id),c=n[r].level+o.get(n[r].id);-1!=t.indexOf(n[r].id)?i[r]={id:n[r].id,level:c>=a?a:c,rewardTime:n[r].rewardTime}:i[r]={id:n[r].id,level:n[r].level,rewardTime:n[r].rewardTime}}return i},t.prototype.getUpFamekLv=function(e,t,o,n){void 0===n&&(n=1);var i=f.default.module.themeConfig.getFameConfigByTagLv(e,o+n);if(i)return i;cc.warn(e+"\u6807\u7b7e\u6216\u8005"+(o+n)+"}\u3010\u627e\u4e0d\u5230\u5bf9\u5e94\u914d\u7f6e\u3011")},t.prototype.scollviewSwitch=function(e){var t=this;f.default.module.gameMainControl.shopFameIsShow()?this.mainNodes.get("toggle_group").children.forEach(function(e){e.active=!0}):this.mainNodes.get("toggle_group").children.forEach(function(e){e.active="toggle1"==e.name||"bg"==e.name||"Background1"==e.name}),e?(this.scheduleOnce(function(){t.mainNodes.get("salesman").getComponent(cc.ScrollView).scrollToTop(.2)}),this.mainNodes.get("salesman").active=!0,this.mainNodes.get("prestige").active=!1):(this.scheduleOnce(function(){t.mainNodes.get("prestige").getComponent(cc.ScrollView).scrollToTop(.2)}),this.mainNodes.get("prestige").active=!0,this.mainNodes.get("salesman").active=!1)},t.prototype.update=function(){this.refreshBtnState(),this.calcCountClerkPrice(!0,!1),this.mainNodes.get("red_point_clerk_off").active=f.default.module.gameMainControl.isShopClerkPoint,this.mainNodes.get("red_point_fame_off").active=f.default.module.gameMainControl.isShopFamePoint,this.mainNodes.get("red_point_clerk").active=f.default.module.gameMainControl.isShopClerkPoint,this.mainNodes.get("red_point_fame").active=f.default.module.gameMainControl.isShopFamePoint||f.default.module.gameMainControl.isPublicGetFame},t.prototype.onDestroy=function(){this.currentClerkQuickNum=null,this.clerkQuickParams=null,this.fameQuickParams=null,this.clerkItemPool=null,this.fameItemPool=null,this.initFameActive=null,this.initClerkActive=null,this.currentFameQuickNum=null,this.mainNodes=null,this.clerkItemPool=null,f.default.module.gameMainControl.isShopFamePoint&&!f.default.module.gameMainControl.isShopClerkPoint&&(f.default.module.gameMainControl.mainNodes.get("red_point_clerk").active=!1),f.default.module.gameMainControl.isShopFamePoint&&(f.default.module.gameMainControl.isShopFamePoint=!1),this.node.off(cc.Node.EventType.TOUCH_END,this.onTouchHandler,this),e.prototype.onDestroy.call(this)},t.prototype.onTouchHandler=function(e){switch(e.target.name){case"btn_close":f.default.module.gameMainControl.clerkChangeId=this.checkClerkListChange(),a.gui.delete(this.node);break;case"btn_quick_clerk":this.clerkClickQuickBtnHandler(e);break;case"btn_quick_fame":this.fameClickQuickBtnHandler(e)}},t.prototype.checkClerkListChange=function(){var e=[];for(var t in this.entryClerkList)this.entryClerkList[t].level!=f.default.module.vm.clerkList[t].level&&-1==[11,12].indexOf(this.entryClerkList[t].id)&&e.push(this.entryClerkList[t].id);return e.length>0?e[e.length-1]:null},t.prototype.showButtonEffect=function(e,t){var o=e.getComponent(c.default);o&&(o.canTouch=t),"btn_quick_fame"==e.name?e.getChildByName("fame_lab").getComponent(_.default).canTouch=t:"btn_quick_clerk"==e.name&&(e.getChildByName("clerk_lab").getComponent(_.default).canTouch=t)},i([E(cc.Node)],t.prototype,"shopItemNode",void 0),i([E(cc.Node)],t.prototype,"prestigeItemNode",void 0),t=i([S],t)}(s.ComponentExtends);o.default=L,cc._RF.pop()},{"../../Main":"Main","../../core/event/MessageManager":"MessageManager","../../core/gui/GUI":"GUI","../../core/ui/ComponentExtends":"ComponentExtends","../../core/ui/ExToggleGroup":"ExToggleGroup","../../core/ui/ViewUtils":"ViewUtils","../../core/ui/button/ButtonEffect":"ButtonEffect","../../core/ui/label/LabelChangeSymbol":"LabelChangeSymbol","../../core/util/AsyncQueue":"AsyncQueue","../../core/util/HashMap":"HashMap","../../service/Service":"Service","../AudioMessage":"AudioMessage","../CalcUiShow":"CalcUiShow","./FameConfirm":"FameConfirm","./ShopClerkListItem":"ShopClerkListItem","./ShopPrestigeListItem":"ShopPrestigeListItem","./effect/LabTouchFont":"LabTouchFont"}],ShopPrestigeListItem:[function(e,t,o){"use strict";cc._RF.push(t,"75635cCoLhHcbZ6eIrAwpkg","ShopPrestigeListItem");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../core/language/LanguageLabel"),a=e("../../core/ui/button/ButtonEffect"),c=e("../../core/ui/button/ButtonEffectSprite"),s=e("../../core/ui/ComponentExtends"),l=e("../../core/ui/label/LabelChangeSymbol"),u=e("../../core/ui/ViewUtils"),p=e("../../Main"),d=e("./effect/LabTouchFont"),h=cc._decorator,f=h.ccclass,g=(h.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.clickCallback=null,t.params=null,t}return n(t,e),t.prototype.onLoad=function(){this.node.hasEventListener(cc.Node.EventType.TOUCH_END)||this.node.on(cc.Node.EventType.TOUCH_END,this.onBtnHandler,this)},t.prototype.onBtnHandler=function(e){"btn_up"==e.target.name&&this.node.getChildByName("btn_up").getComponent(a.default).canTouch&&this.clickCallback&&this.clickCallback(this.params,this)},t.prototype.refreshBtnState=function(e,t){if(this.params.level>p.default.module.themeConfig.getFameMaxLvById(this.params.id))return this.node.getChildByName("btn_unlock").active=!1,void(this.node.getChildByName("btn_up").active=!1);if(this.params.id>p.default.module.themeConfig.getBuildingConfigById(p.default.module.vm.level).count&&11!=this.params.id)return this.node.getChildByName("btn_unlock").active=!0,void(this.node.getChildByName("btn_up").active=!1);this.node.getChildByName("btn_unlock").active=!1;var o=this.node.getChildByName("btn_up").getComponent(c.default);o&&(o.canTouch=e),this.node.getChildByName("btn_up").getChildByName("btn_lab").getComponent(d.default).canTouch=e},t.prototype.setData=function(e){var t=u.ViewUtils.nodeTreeInfoLite(this.node);this.params=e;var o=t.get("prestige_name"),n=e.value,i=t.get("prestige_func");e.id<=10?i.getComponent(r.LanguageLabel).dataID="ui_store_"+e.id:i.getComponent(r.LanguageLabel).dataID="ui_clerk_5";var a=cc.loader.getRes("main/icon/icon"+e.id,cc.SpriteFrame);if(t.get("prestige_spr").getComponent(cc.Sprite).spriteFrame=a,o.active=!0,e.level>p.default.module.themeConfig.getFameMaxLvById(e.id))i.y=0,o.active=!1,t.get("prestige_lv").y=0,o.getComponent(cc.Label).string="",t.get("prestige_lv").getComponent(cc.Label).string="MAX",t.get("prestige_func").getComponent(cc.Label).string="",t.get("btn_lab").getComponent(cc.Label).string="";else{i.y=-20,t.get("prestige_lv").y=-20,o.getComponent(r.LanguageLabel).setVars("prestige_"+e.type,""+n),2==e.type?o.getComponent(r.LanguageLabel).setVars("prestige_"+e.type,100*(1-n)+"%"):4==e.type&&o.getComponent(r.LanguageLabel).setVars("prestige_"+e.type,100*n+"%"),o.getComponent(r.LanguageLabel).dataID="prestige_"+e.type,t.get("prestige_lv").getComponent(cc.Label).string="lv"+e.level;p.default.module.calcTool.formatNum({num:e.price,numE:e.priceE});t.get("btn_lab").getComponent(l.LabelChangeSymbol).num={num:e.price,numE:e.priceE}}},t.prototype.onDestroy=function(){this.params=null,this.clickCallback=null,e.prototype.onDestroy.call(this)},t=i([f],t)}(s.ComponentExtends));o.default=g,cc._RF.pop()},{"../../Main":"Main","../../core/language/LanguageLabel":"LanguageLabel","../../core/ui/ComponentExtends":"ComponentExtends","../../core/ui/ViewUtils":"ViewUtils","../../core/ui/button/ButtonEffect":"ButtonEffect","../../core/ui/button/ButtonEffectSprite":"ButtonEffectSprite","../../core/ui/label/LabelChangeSymbol":"LabelChangeSymbol","./effect/LabTouchFont":"LabTouchFont"}],ShoppingComponent:[function(e,t,o){"use strict";cc._RF.push(t,"de7a8CXLaxMTZcnUCWbOVZW","ShoppingComponent");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../core/event/MessageManager"),a=e("../../core/gui/GUI"),c=e("../../core/ui/button/ButtonEffect"),s=e("../../core/ui/ComponentExtends"),l=e("../../core/ui/ViewUtils"),u=e("../../Main"),p=e("../../service/Service"),d=e("../AudioMessage"),h=e("./effect/LabTouchFont"),f=e("./ShoppingListItem"),g=cc._decorator,m=g.ccclass,v=g.property,_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.item_node=null,t.getRandomNum=function(e,t){return Math.round(Math.random()*(t-e)+e)},t}return n(t,e),t.prototype.onLoad=function(){p.service.analytics.logEvent("mall_click_open","",""),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchHandler,this),this.node.active=!1,this.refreshList()},t.prototype.refreshList=function(){var e=this;this.item_node.active=!1;var t=l.ViewUtils.nodeTreeInfoLite(this.node).get("content");t.children.forEach(function(t){t.uuid!=e.item_node.uuid&&t.destroy()});var o=0;p.service.prompt.netInstableOpen(),p.service.prompt.netInstableClose();for(var n=0;n<8;n++){var i={id:n+1,goods_type:1,price:100*n,priceType:1,value:300},r=null;if(0==o)this.item_node.active=!0,this.item_node.name=""+i.id,(r=this.item_node.getComponent(f.default)).setData(i);else{var a=cc.instantiate(this.item_node);a.name=""+i.id,a.parent=t,(r=a.getComponent(f.default)).setData(i)}r.clickCallback=this.itemClickHandler.bind(this),o++}this.node.active=!0,this.refreshMutiLab()},t.prototype.itemClickHandler=function(e,t){var o=this,n=u.default.module.vm;if(cc.log(e.id),e.price>u.default.module.vm.diamond)cc.warn("\u3010\u94bb\u77f3\u4f59\u989d\u4e0d\u8db3\u3011");else{r.Message.dispatchEvent(d.AudioMessage.EFFECT,"shop_"+this.getRandomNum(1,3));var i=e.id;switch(i){case 8:p.service.analytics.logEvent("mall_buy_12","","");break;case 9:p.service.analytics.logEvent("mall_buy_24","","");break;case 10:p.service.analytics.logEvent("mall_buy_W","","");break;case 11:p.service.analytics.logEvent("mall_buy_2W","","");break;case 12:p.service.analytics.logEvent("mall_buy_3X","","");break;case 13:p.service.analytics.logEvent("mall_buy_6X","","");break;case 14:p.service.analytics.logEvent("mall_buy_12X","","");break;case 15:p.service.analytics.logEvent("mall_buy_27X","","")}u.default.module.gameProtocol.requestDiamondInfo(i,function(i){var r=i.goodsInfo.value,c=i.goodsInfo.goodsType;a.gui.delete(o.node),a.gui.popup.add("popup/shopping_result",{id:e.id,goodsType:c,reward:t,value:r},{modal:!0,opacity:150}),n.diamond=i.userAccount.credit,i.goodsData&&(n.goodsInfo=i.goodsData,o.refreshMutiLab()),u.default.module.calcUiShow.refreshCredit(t,function(){u.default.module.gameMainControl.refreshStoresCollectSpeed()},!0)})}},t.prototype.refreshMutiLab=function(){var e=u.default.module.vm,t=e.goodsInfo.multiTotal,o=e.goodsInfo.multiTotalE,n=l.ViewUtils.nodeTreeInfoLite(this.node),i=t*Math.pow(10,o);0==i?(n.get("muti_title").active=!1,n.get("muti_lab").active=!1):(n.get("muti_title").active=!0,n.get("muti_lab").active=!0,n.get("muti_lab").getComponent(cc.Label).string=i+"X")},t.prototype.refreshBtnState=function(){var e=this;l.ViewUtils.nodeTreeInfoLite(this.node).get("content").children.forEach(function(t){if(t.getComponent(f.default).params){var o=t.getComponent(f.default).reward;3==t.getComponent(f.default).params.goods_type?e.showButtonEffect(t.getChildByName("btn_buy"),u.default.module.vm.diamond>=t.getComponent(f.default).params.price):e.showButtonEffect(t.getChildByName("btn_buy"),u.default.module.vm.diamond>=t.getComponent(f.default).params.price&&0!=o.num)}})},t.prototype.showButtonEffect=function(e,t){t?cc.Color.WHITE:cc.Color.GRAY;var o=e.getComponent(c.default);o&&(o.canTouch=t),"btn_buy"==e.name&&(e.getChildByName("btn_lab").getComponent(h.default).canTouch=t)},t.prototype.update=function(){l.ViewUtils.nodeTreeInfoLite(this.node).get("diamond_lab").getComponent(cc.Label).string=u.default.module.vm.diamond+"",this.refreshBtnState()},t.prototype.onDestroy=function(){this.node.off(cc.Node.EventType.TOUCH_END,this.onTouchHandler,this),e.prototype.onDestroy.call(this)},t.prototype.onTouchHandler=function(e){switch(e.target.name){case"btn_close":a.gui.delete(this.node)}},i([v(cc.Node)],t.prototype,"item_node",void 0),t=i([m],t)}(s.ComponentExtends);o.default=_,cc._RF.pop()},{"../../Main":"Main","../../core/event/MessageManager":"MessageManager","../../core/gui/GUI":"GUI","../../core/ui/ComponentExtends":"ComponentExtends","../../core/ui/ViewUtils":"ViewUtils","../../core/ui/button/ButtonEffect":"ButtonEffect","../../service/Service":"Service","../AudioMessage":"AudioMessage","./ShoppingListItem":"ShoppingListItem","./effect/LabTouchFont":"LabTouchFont"}],ShoppingListItem:[function(e,t,o){"use strict";cc._RF.push(t,"b15daoswA9NFKxiIw6rnJni","ShoppingListItem");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../core/language/LanguageLabel"),a=e("../../core/ui/button/ButtonEffect"),c=e("../../core/ui/ComponentExtends"),s=e("../../core/ui/label/LabelChangeSymbol"),l=e("../../core/ui/ViewUtils"),u=e("../../Main"),p=cc._decorator,d=p.ccclass,h=(p.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.clickCallback=null,t.reward=null,t.params=null,t}return n(t,e),t.prototype.onLoad=function(){this.node.hasEventListener(cc.Node.EventType.TOUCH_END)||this.node.on(cc.Node.EventType.TOUCH_END,this.onBtnHandler,this)},t.prototype.onBtnHandler=function(e){"btn_buy"==e.target.name&&this.node.getChildByName("btn_buy").getComponent(a.default).canTouch&&this.clickCallback&&this.clickCallback(this.params,this.reward)},t.prototype.setData=function(e){this.params=e;var t=l.ViewUtils.nodeTreeInfoLite(this.node);t.get("lab").getComponent(r.LanguageLabel).dataID="shop_"+(e.id-7),t.get("clock").active=!0,t.get("fanbei").active=!1,e.id>11&&(t.get("clock").active=!1,t.get("fanbei").active=!0,t.get("lab").getComponent(r.LanguageLabel).dataID="shop_5",t.get("lab").getComponent(r.LanguageLabel).setVars("shop_5",e.value.value3+""));var o=0;switch(e.id){case 8:o=43200;break;case 9:o=86400;break;case 10:o=604800;break;case 11:o=1209600}this.reward=u.default.module.calcUiShow.getTimeStageReward(o);var n=t.get("lab_num").y;t.get("lab_num").active=o>0,t.get("lab_num").y=0==o?n-20:n,t.get("lab_num").getComponent(s.LabelChangeSymbol).num=this.reward,t.get("btn_lab").getComponent(s.LabelChangeSymbol).string=e.price+""},t.prototype.showButtonEffect=function(e,t){var o=t?cc.Color.WHITE:cc.Color.GRAY,n=e.getComponent(a.default);e.color=o,n&&(n.canTouch=t);var i=function(e){if(0!=e.children.length)for(var t=0,n=e.children;t<n.length;t++){var r=n[t];r.color=o,i(r)}};i(e)},t.prototype.onDestroy=function(){this.clickCallback=null,this.reward=null,this.params=null,e.prototype.onDestroy.call(this)},t=i([d],t)}(c.ComponentExtends));o.default=h,cc._RF.pop()},{"../../Main":"Main","../../core/language/LanguageLabel":"LanguageLabel","../../core/ui/ComponentExtends":"ComponentExtends","../../core/ui/ViewUtils":"ViewUtils","../../core/ui/button/ButtonEffect":"ButtonEffect","../../core/ui/label/LabelChangeSymbol":"LabelChangeSymbol"}],ShoppingResult:[function(e,t,o){"use strict";cc._RF.push(t,"8d4bfqtWQ9MqLRLfBvxPwXB","ShoppingResult");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../core/Engine"),a=e("../../core/language/LanguageLabel"),c=e("../../core/ui/ComponentExtends"),s=e("../../core/ui/label/LabelChangeSymbol"),l=e("../../core/ui/ViewUtils"),u=cc._decorator,p=u.ccclass,d=(u.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.onLoad=function(){this.node.hasEventListener(cc.Node.EventType.TOUCH_END)||this.node.on(cc.Node.EventType.TOUCH_END,this.onBtnHandler,this)},t.prototype.onBtnHandler=function(e){switch(e.target.name){case"btn_close":case"btn_ok":this.node.destroy()}},t.prototype.onAdded=function(e){var t=this,o=this.node.getChildByName("skeleton").getComponent(sp.Skeleton),n="zh"==r.default.i18n.currentLanguage?"cn":"en";this.node.getChildByName("btn_ok").active=!1,this.node.getChildByName("btn_close").active=!1,o.setCompleteListener(function(e){"reward_fadein"==e.animation.name&&(o.setAnimation(0,"reward_loop",!0),t.node.getChildByName("btn_ok").active=!0,t.node.getChildByName("btn_close").active=!0)}),o.setSkin(n),o.setAnimation(0,"reward_fadein",!1),this.node.getChildByName("result").scale=0,this.node.getChildByName("result").RunAction(ezaction.scaleTo(5/30,{scale:1.1})).onStoped(function(){t.node.getChildByName("result").RunAction(ezaction.scaleTo(10/30,{scale:1})).onStoped(function(){})}),this.node.getChildByName("clock").active=2==e.goodsType,this.node.getChildByName("clock").scale=0,this.node.getChildByName("clock").RunAction(ezaction.scaleTo(5/30,{scale:1.1*1.3})).onStoped(function(){t.node.getChildByName("clock").RunAction(ezaction.scaleTo(10/30,{scale:1.3})).onStoped(function(){})}),this.node.getChildByName("muti").active=3==e.goodsType,this.node.getChildByName("muti").scale=0,this.node.getChildByName("muti").RunAction(ezaction.scaleTo(5/30,{scale:1.1*1.3})).onStoped(function(){t.node.getChildByName("muti").RunAction(ezaction.scaleTo(10/30,{scale:1.3})).onStoped(function(){})}),this.node.getChildByName("title_spr").scale=0;var i="en"==n?.65:1;this.node.getChildByName("title_spr").RunAction(ezaction.scaleTo(5/30,{scale:1.1*i})).onStoped(function(){t.node.getChildByName("title_spr").RunAction(ezaction.scaleTo(10/30,{scale:1*i})).onStoped(function(){})});var c=l.ViewUtils.nodeTreeInfoLite(this.node);c.get("result_lab").getComponent(a.LanguageLabel).dataID="shop_"+(e.id-7),3==e.goodsType&&(c.get("result_num").active=!1,c.get("result_lab").y-=30,c.get("result_lab").getComponent(a.LanguageLabel).dataID="shop_5",c.get("result_lab").getComponent(a.LanguageLabel).setVars("shop_5",e.value.value3+"")),c.get("result_num").getComponent(s.LabelChangeSymbol).num=e.reward},t=i([p],t)}(c.ComponentExtends));o.default=d,cc._RF.pop()},{"../../core/Engine":"Engine","../../core/language/LanguageLabel":"LanguageLabel","../../core/ui/ComponentExtends":"ComponentExtends","../../core/ui/ViewUtils":"ViewUtils","../../core/ui/label/LabelChangeSymbol":"LabelChangeSymbol"}],SpineAnimName:[function(e,t,o){"use strict";cc._RF.push(t,"316e1tpDoFL9LUq3RNQjcEm","SpineAnimName");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../../core/Engine"),a=cc._decorator,c=a.ccclass,s=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.animName="",t}return n(t,e),t.prototype.onLoad=function(){var e=this.getComponent(sp.Skeleton);e.skeletonData.skeletonJson.animations[this.animName]?e.setAnimation(0,this.animName,!0):r.default.log.info(this.animName+"\u4e0d\u5b58\u5728")},i([s],t.prototype,"animName",void 0),t=i([c],t)}(cc.Component);o.default=l,cc._RF.pop()},{"../../../core/Engine":"Engine"}],SpineAnimationQueue:[function(e,t,o){"use strict";cc._RF.push(t,"259afH4ydZL2bJb+nCcOEPP","SpineAnimationQueue");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator.ccclass,a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.completeCallback=null,t.progressBeginCallback=null,t.progressEndCallback=null,t._spine=null,t._animations=null,t._loop=!1,t._isCompleted=!1,t}return n(t,e),Object.defineProperty(t.prototype,"spine",{get:function(){return this._spine},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"loop",{get:function(){return this._loop},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isCompleted",{get:function(){return this._isCompleted},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){this._spine=this.node.getComponent(sp.Skeleton),this._spine.setCompleteListener(this.completeHandler.bind(this))},t.prototype.clearAnimation=function(){this._spine.clearTracks()},t.prototype.setAnimations=function(e){this._animations=e,this._isCompleted?this.play():(this._loop=!1,1==this._spine.timeScale&&(this._spine.timeScale=5))},t.prototype.setAnimation=function(e,t){void 0===t&&(t=!1),this._isCompleted=!1,this._loop=t,this._spine.timeScale=1,this._spine.setAnimation(0,e,t),this.progressBeginCallback&&this.progressBeginCallback(this._spine.animation)},t.prototype.play=function(){if(!this._animations||this._animations.length<1)return this._isCompleted=!0,void(this.completeCallback&&(this.completeCallback(this),this.completeCallback=null));this.setAnimation(this._animations.shift())},t.prototype.completeHandler=function(){if(this.progressEndCallback&&this.progressEndCallback(this._spine.animation),this._loop){var e=this._spine.animation;this.setAnimation(e,!0)}else this.play()},t=i([r],t)}(cc.Component);o.SpineAnimationQueue=a,cc._RF.pop()},{}],SpineParticleWithColor:[function(e,t,o){"use strict";cc._RF.push(t,"97ba4BgBN5LDq0jHXHnMGzD","SpineParticleWithColor");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,a=r.ccclass,c=r.property,s=cc.Enum({GRAVITY:0,RADIUS:1}),l=cc.Enum({FREE:0,RELATIVE:1,GROUPED:2}),u=function(){return function(e,t,o){this.dir=null,this.radialAccel=0,this.tangentialAccel=0,this.dir=e||cc.v2(0,0),this.radialAccel=t||0,this.tangentialAccel=o||0}}(),p=function(){return function(e,t,o,n){this.radius=0,this.deltaRadius=0,this.angle=0,this.degreesPerSecond=0,this.angle=e||0,this.degreesPerSecond=t||0,this.radius=o||0,this.deltaRadius=n||0}}(),d=function(){function e(e,t,o,n,i,r,a,c,s,l,d){this.pos=null,this.startPos=null,this.color=null,this.deltaColor=null,this.size=null,this.deltaSize=null,this.rotation=null,this.deltaRotation=null,this._timeToLive=0,this.animations=null,this.modeA=null,this.modeB=null,this.isChangeColor=!1,this.drawPos=null,this._node=null,this.pos=e||cc.v2(0,0),this.startPos=t||cc.v2(0,0),this.color=o||cc.color(0,0,0,255),this.deltaColor=n||{r:0,g:0,b:0,a:255},this.size=i||0,this.deltaSize=r||0,this.rotation=a||0,this.deltaRotation=c||0,this.timeToLive=s||0,this.modeA=l||new u,this.modeB=d||new p,this.isChangeColor=!1,this.drawPos=cc.v2(0,0)}return Object.defineProperty(e.prototype,"timeToLive",{get:function(){return this._timeToLive},set:function(e){if(this._timeToLive=e,this.node)if(e<=0)this.node.active=!1;else if(!this.node.active){this.node.active=!0;var t=Math.floor(Math.random()*(this.animations.length-1));this.node.getComponent(sp.Skeleton).premultipliedAlpha=!1,this.node.getComponent(sp.Skeleton).setAnimation(0,this.animations[t],!0)}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"node",{get:function(){return this._node},set:function(e){this._node=e,this._node.width=40,this._node.height=40,e.active=!1},enumerable:!0,configurable:!0}),e.prototype.update=function(){this._node&&(this.node.x=this.pos.x,this.node.y=this.pos.y,this.node.angle=-this.rotation,this.node.scale=2)},e.prototype.release=function(){this._node&&(this._node.removeFromParent(!1),this._node=null),this.modeA=null,this.modeB=null},e}(),h=[cc.v2(),cc.v2(),cc.v2(),cc.v2()],f=function(e){return e.angle(cc.v2(1,0))},g=function(e){e.x=0,e.y=0},m=function(e,t){e.x=e.x+t.x,e.y=e.y+t.y},v=function(e,t){e.x=e.x-t.x,e.y=e.y-t.y},_=function(e,t){e.x=t.x,e.y=t.y},y=function(e,t,o,n){var i,r,a;void 0===n?(a=t,i=e.x,r=e.y,n=o):(i=e,r=t,a=o),n.x=a.a*i+a.c*r+a.tx,n.y=a.b*i+a.d*r+a.ty},b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.spinData=null,t.particleData=null,t.autoplay=!1,t._elapsed=0,t._dontTint=!1,t.modeA=null,t.modeB=null,t._pointZeroForParticle=cc.v2(0,0),t._particles=[],t._emitCounter=0,t._particleIdx=0,t._allocatedParticles=0,t._isActive=!1,t.particleCount=0,t.duration=0,t._sourcePosition=null,t._posVar=null,t.life=0,t.lifeVar=0,t.angle=0,t.angleVar=0,t.startSize=0,t.startSizeVar=0,t.endSize=0,t.endSizeVar=0,t._startColor=null,t._startColorVar=null,t._endColor=null,t._endColorVar=null,t.startSpin=0,t.startSpinVar=0,t.endSpin=0,t.endSpinVar=0,t.emissionRate=0,t._totalParticles=0,t._blendFunc=null,t._opacityModifyRGB=!1,t.positionType=null,t.autoRemoveOnFinish=!1,t.emitterMode=0,t._position=cc.v2(0,0),t._particleActive=!1,t.animations=null,t.dictionary=null,t}return n(t,e),t.prototype.onLoad=function(){if(this.emitterMode=s.GRAVITY,this.modeA=new C,this.modeB=new T,this._blendFunc={src:cc.macro.BlendFactor.SRC_COLOR,dst:cc.macro.BlendFactor.DST_COLOR},this._particles=[],this._sourcePosition=cc.v2(0,0),this._posVar=cc.v2(0,0),this._startColor=cc.color(255,255,255,255),this._startColorVar=cc.color(255,255,255,255),this._endColor=cc.color(255,255,255,255),this._endColorVar=cc.color(255,255,255,255),this._elapsed=0,this._dontTint=!1,this._pointZeroForParticle=cc.v2(0,0),this._emitCounter=0,this._particleIdx=0,this._allocatedParticles=0,this._isActive=!1,this.particleCount=0,this.duration=0,this.life=0,this.lifeVar=0,this.angle=0,this.angleVar=0,this.startSize=0,this.startSizeVar=0,this.endSize=0,this.endSizeVar=0,this.startSpin=0,this.startSpinVar=0,this.endSpin=0,this.endSpinVar=0,this.emissionRate=0,this._totalParticles=0,this._opacityModifyRGB=!1,this.positionType=l.FREE,this.autoRemoveOnFinish=!1,this.animations=[],this.spinData)for(var e in this.spinData.skeletonJson.animations)this.animations.push(e);this.initWithFile(this.particleData),this._particleActive=this.autoplay},t.prototype.onDestroy=function(){this._particles.forEach(function(e){e&&e.release()}),this._particles=null,this.modeA=null,this.modeB=null,this.spinData=null},t.prototype.play=function(){this._particleActive=!0},t.prototype.resume=function(){this._particleActive=!0},t.prototype.pause=function(){this._particleActive=!1},t.prototype.stopSystem=function(){this._isActive=!1,this._elapsed=this.duration,this._emitCounter=0},t.prototype.resetSystem=function(){this._isActive=!0,this._elapsed=0;var e=this._particles;for(this._particleIdx=0;this._particleIdx<this.particleCount;++this._particleIdx){var t=e[this._particleIdx];t&&(t.timeToLive=0)}},t.prototype.isFull=function(){return this.particleCount>=this._totalParticles},t.prototype.createParticle=function(){var e=new d;e.animations=this.animations;var t=[cc.color(252,255,35),cc.color(35,255,26),cc.color(255,74,74)],o=Math.floor(Math.random()*t.length),n=new cc.Node;n.color=t[o];var i=n.addComponent(sp.Skeleton);return i.skeletonData=this.spinData,i.premultipliedAlpha=!1,this.node.addChild(n),e.node=n,e},t.prototype.addEmissionRate=function(e,t,o,n,i){void 0===t&&(t=0),void 0===o&&(o=0),void 0===n&&(n=0),void 0===i&&(i=0),this.dictionary&&(this.dictionary.emissionRate=e,this.initWithDictionary(this.dictionary,""))},t.prototype.initWithFile=function(e){var t=this,o=this.particleData;cc.loader.load({url:o,type:"plist"},function(o,n){return o&&cc.error(e+"\u4e0b\u8f7d\u5931\u8d25\uff01",o),t.initWithDictionary(n,"")})},t.prototype.initWithTotalParticles=function(e){return this._totalParticles=e,this._particles.length=e,this._allocatedParticles=e,this._isActive=!0,this.positionType=l.GROUPED,this.emitterMode=s.GRAVITY,this.autoRemoveOnFinish=!1,!0},t.prototype._valueForKey=function(e,t){if(t){var o=t[e];return null!=o?o:""}return""},t.prototype.initWithDictionary=function(e,t){this.dictionary=e;var o=this._valueForKey,n=parseInt(o("maxParticles",e));if(cc.log("maxParticles",n),this.initWithTotalParticles(n)){this.angle=parseFloat(o("angle",e)),this.angleVar=parseFloat(o("angleVariance",e)),this.duration=parseFloat(o("duration",e)),this._blendFunc.src=parseInt(o("blendFuncSource",e)),this._blendFunc.dst=parseInt(o("blendFuncDestination",e));var i=this._startColor;i.r=255*parseFloat(o("startColorRed",e)),i.g=255*parseFloat(o("startColorGreen",e)),i.b=255*parseFloat(o("startColorBlue",e)),i.a=255*parseFloat(o("startColorAlpha",e));var r=this._startColorVar;r.r=255*parseFloat(o("startColorVarianceRed",e)),r.g=255*parseFloat(o("startColorVarianceGreen",e)),r.b=255*parseFloat(o("startColorVarianceBlue",e)),r.a=255*parseFloat(o("startColorVarianceAlpha",e));var a=this._endColor;a.r=255*parseFloat(o("finishColorRed",e)),a.g=255*parseFloat(o("finishColorGreen",e)),a.b=255*parseFloat(o("finishColorBlue",e)),a.a=255*parseFloat(o("finishColorAlpha",e));var c=this._endColorVar;if(c.r=255*parseFloat(o("finishColorVarianceRed",e)),c.g=255*parseFloat(o("finishColorVarianceGreen",e)),c.b=255*parseFloat(o("finishColorVarianceBlue",e)),c.a=255*parseFloat(o("finishColorVarianceAlpha",e)),this.startSize=parseFloat(o("startParticleSize",e)),this.startSizeVar=parseFloat(o("startParticleSizeVariance",e)),this.endSize=parseFloat(o("finishParticleSize",e)),this.endSizeVar=parseFloat(o("finishParticleSizeVariance",e)),this._position.x=parseFloat(o("sourcePositionx",e)),this._position.y=parseFloat(o("sourcePositiony",e)),this._posVar.x=parseFloat(o("sourcePositionVariancex",e)),this._posVar.y=parseFloat(o("sourcePositionVariancey",e)),this.startSpin=parseFloat(o("rotationStart",e)),this.startSpinVar=parseFloat(o("rotationStartVariance",e)),this.endSpin=parseFloat(o("rotationEnd",e)),this.endSpinVar=parseFloat(o("rotationEndVariance",e)),this.emitterMode=parseInt(o("emitterType",e)),this.emitterMode===s.GRAVITY){var l=this.modeA;l.gravity.x=parseFloat(o("gravityx",e)),l.gravity.y=parseFloat(o("gravityy",e)),l.speed=parseFloat(o("speed",e)),l.speedVar=parseFloat(o("speedVariance",e));var u=o("radialAcceleration",e);l.radialAccel=u?parseFloat(u):0,u=o("radialAccelVariance",e),l.radialAccelVar=u?parseFloat(u):0,u=o("tangentialAcceleration",e),l.tangentialAccel=u?parseFloat(u):0,u=o("tangentialAccelVariance",e),l.tangentialAccelVar=u?parseFloat(u):0;var p=o("rotationIsDir",e);null!==p?(p=p.toString().toLowerCase(),l.rotationIsDir="true"===p||"1"===p):l.rotationIsDir=!1}else{if(this.emitterMode!==s.RADIUS)return!1;var d=this.modeB;d.startRadius=parseFloat(o("maxRadius",e)),d.startRadiusVar=parseFloat(o("maxRadiusVariance",e)),d.endRadius=parseFloat(o("minRadius",e)),d.endRadiusVar=0,d.rotatePerSecond=parseFloat(o("rotatePerSecond",e)),d.rotatePerSecondVar=parseFloat(o("rotatePerSecondVariance",e))}return this.life=parseFloat(o("particleLifespan",e)),this.lifeVar=parseFloat(o("particleLifespanVariance",e)),e.emissionRate?this.emissionRate=parseFloat(o("emissionRate",e)):(cc.log("[GameParticle] plist\u6587\u4ef6\u6ca1\u6709 emissionRate \u914d\u7f6e\u6570\u636e\uff0c\u53ef\u80fd\u5bfc\u81f4\u7c92\u5b50\u6570\u504f\u591a "+this.particleData),this.emissionRate=this._totalParticles/this.life),this._opacityModifyRGB=!1,!0}return!1},t.prototype.addParticle=function(){if(this.isFull())return!1;var e=this._particles[this.particleCount];return e||(e=this.createParticle(),this._particles[this.particleCount]=e),this.initParticle(e),e.node.active=!0,e.update(),++this.particleCount,!0},t.prototype.initParticle=function(e){var t=function(){return 2*Math.random()-1};e.timeToLive=this.life+this.lifeVar*t(),e.timeToLive=Math.max(0,e.timeToLive),e.pos.x=this._sourcePosition.x+this._posVar.x*t(),e.pos.y=this._sourcePosition.y+this._posVar.y*t();var o=e.timeToLive,n=this.startSize+this.startSizeVar*t();if(n=Math.max(0,n),e.size=n,-1===this.endSize)e.deltaSize=0;else{var i=this.endSize+this.endSizeVar*t();i=Math.max(0,i),e.deltaSize=(i-n)/o}var r=this.startSpin+this.startSpinVar*t(),a=this.endSpin+this.endSpinVar*t();e.rotation=r,e.deltaRotation=(a-r)/o,this.positionType===l.FREE?e.startPos=this.node.convertToWorldSpaceAR(this._pointZeroForParticle):this.positionType===l.RELATIVE&&(e.startPos.x=this._position.x,e.startPos.y=this._position.y);var c=cc.misc.degreesToRadians(this.angle+this.angleVar*t());if(this.emitterMode===s.GRAVITY){var u=this.modeA,p=e.modeA,d=u.speed+u.speedVar*t();p.dir.x=Math.cos(c),p.dir.y=Math.sin(c),p.dir.mulSelf(d),p.radialAccel=u.radialAccel+u.radialAccelVar*t(),p.tangentialAccel=u.tangentialAccel+u.tangentialAccelVar*t(),u.rotationIsDir&&(e.rotation=-cc.misc.radiansToDegrees(f(p.dir)))}else{var h=this.modeB,g=e.modeB,m=h.startRadius+h.startRadiusVar*t(),v=h.endRadius+h.endRadiusVar*t();g.radius=m,g.deltaRadius=-1===h.endRadius?0:(v-m)/o,g.angle=c,g.degreesPerSecond=cc.misc.degreesToRadians(h.rotatePerSecond+h.rotatePerSecondVar*t())}},t.prototype.update=function(e){if(this._particleActive){if(this._isActive&&this.emissionRate){var t=1/this.emissionRate;for(this.particleCount<this._totalParticles&&(this._emitCounter+=e);this.particleCount<this._totalParticles&&this._emitCounter>t;)this.addParticle(),this._emitCounter-=t;this._elapsed+=e,-1!==this.duration&&this.duration<this._elapsed&&this.stopSystem()}this._particleIdx=0;var o=new cc.Mat4;this.node.getWorldMatrix(o);var n=h[0];if(this.positionType===l.FREE?_(n,this.node.convertToWorldSpaceAR(this._pointZeroForParticle)):this.positionType===l.RELATIVE&&(n.x=this._position.x,n.y=this._position.y),this.node.active)for(var i=h[1],r=h[2],a=h[3],c=this._particles;this._particleIdx<this.particleCount;){g(i),g(r),g(a);var u=c[this._particleIdx];if(u||(u=this.createParticle(),c[this._particleIdx]=u),u.timeToLive-=e,u.timeToLive>0){if(this.emitterMode===s.GRAVITY){var p=a,d=i,f=r;u.pos.x||u.pos.y?(_(d,u.pos),d.normalizeSelf()):g(d),_(f,d),d.mulSelf(u.modeA.radialAccel);var b=f.x;f.x=-f.y,f.y=b,f.mulSelf(u.modeA.tangentialAccel),_(p,d),m(p,f),m(p,this.modeA.gravity),p.mulSelf(e),m(u.modeA.dir,p),_(p,u.modeA.dir),p.mulSelf(e),m(u.pos,p)}else{var C=u.modeB;C.angle+=C.degreesPerSecond*e,C.radius+=C.deltaRadius*e,u.pos.x=-Math.cos(C.angle)*C.radius,u.pos.y=-Math.sin(C.angle)*C.radius}u.size+=u.deltaSize*e,u.size=Math.max(0,u.size),u.rotation+=u.deltaRotation*e;var T=i;if(this.positionType===l.FREE||this.positionType===l.RELATIVE){var S=r,E=a;y(n,o,S),y(u.startPos,o,E),v(S,E),_(T,u.pos),v(T,S)}else _(T,u.pos);u.pos.x=T.x,u.pos.y=T.y,u.update(),++this._particleIdx}else{if(this._particleIdx!==this.particleCount-1){var L=c[this._particleIdx],w=c[this.particleCount-1];w||(w=this.createParticle(),c[this.particleCount-1]=w),c[this._particleIdx]=w,c[this.particleCount-1]=L}if(--this.particleCount,0===this.particleCount&&this.autoRemoveOnFinish)return void(this.enabled=!1)}}}},i([c(sp.SkeletonData)],t.prototype,"spinData",void 0),i([c({type:cc.ParticleAsset})],t.prototype,"particleData",void 0),i([c(cc.Boolean)],t.prototype,"autoplay",void 0),t=i([a],t)}(cc.Component);o.SpineParticleWithColor=b;var C=function(){return function(e,t,o,n,i,r,a,c){this.gravity=cc.v2(0,0),this.speed=0,this.speedVar=0,this.tangentialAccel=0,this.tangentialAccelVar=0,this.radialAccel=0,this.radialAccelVar=0,this.rotationIsDir=!1,this.gravity=e||cc.v2(0,0),this.speed=t||0,this.speedVar=o||0,this.tangentialAccel=n||0,this.tangentialAccelVar=i||0,this.radialAccel=r||0,this.radialAccelVar=a||0,this.rotationIsDir=c||!1}}(),T=function(){return function(e,t,o,n,i,r){this.startRadius=0,this.startRadiusVar=0,this.endRadius=0,this.endRadiusVar=0,this.rotatePerSecond=0,this.rotatePerSecondVar=0,this.startRadius=e||0,this.startRadiusVar=t||0,this.endRadius=o||0,this.endRadiusVar=n||0,this.rotatePerSecond=i||0,this.rotatePerSecondVar=r||0}}();cc._RF.pop()},{}],SpineParticle:[function(e,t,o){"use strict";cc._RF.push(t,"b91b2Cxk4lPz4SslKc0GnfU","SpineParticle");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,a=r.ccclass,c=r.property,s=cc.Enum({GRAVITY:0,RADIUS:1}),l=cc.Enum({FREE:0,RELATIVE:1,GROUPED:2}),u=function(){return function(e,t,o){this.dir=null,this.radialAccel=0,this.tangentialAccel=0,this.dir=e||cc.v2(0,0),this.radialAccel=t||0,this.tangentialAccel=o||0}}(),p=function(){return function(e,t,o,n){this.radius=0,this.deltaRadius=0,this.angle=0,this.degreesPerSecond=0,this.angle=e||0,this.degreesPerSecond=t||0,this.radius=o||0,this.deltaRadius=n||0}}(),d=function(){function e(e,t,o,n,i,r,a,c,s,l,d){this.pos=null,this.startPos=null,this.color=null,this.deltaColor=null,this.size=null,this.deltaSize=null,this.rotation=null,this.deltaRotation=null,this._timeToLive=0,this.animations=null,this.modeA=null,this.modeB=null,this.isChangeColor=!1,this.drawPos=null,this._node=null,this.pos=e||cc.v2(0,0),this.startPos=t||cc.v2(0,0),this.color=o||cc.color(0,0,0,255),this.deltaColor=n||{r:0,g:0,b:0,a:255},this.size=i||0,this.deltaSize=r||0,this.rotation=a||0,this.deltaRotation=c||0,this.timeToLive=s||0,this.modeA=l||new u,this.modeB=d||new p,this.isChangeColor=!1,this.drawPos=cc.v2(0,0)}return Object.defineProperty(e.prototype,"timeToLive",{get:function(){return this._timeToLive},set:function(e){if(this._timeToLive=e,this.node)if(e<=0)this.node.active=!1;else if(!this.node.active){this.node.active=!0;var t=Math.floor(Math.random()*(this.animations.length-1));this.node.getComponent(sp.Skeleton).premultipliedAlpha=!1,this.node.getComponent(sp.Skeleton).setAnimation(0,this.animations[t],!0)}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"node",{get:function(){return this._node},set:function(e){this._node=e,this._node.width=40,this._node.height=40,e.active=!1},enumerable:!0,configurable:!0}),e.prototype.update=function(){this._node&&(this.node.x=this.pos.x,this.node.y=this.pos.y,this.node.angle=-this.rotation,this.node.scale=1)},e.prototype.release=function(){this._node&&(this._node.removeFromParent(!1),this._node=null),this.modeA=null,this.modeB=null},e}(),h=[cc.v2(),cc.v2(),cc.v2(),cc.v2()],f=function(e){return e.angle(cc.v2(1,0))},g=function(e){e.x=0,e.y=0},m=function(e,t){e.x=e.x+t.x,e.y=e.y+t.y},v=function(e,t){e.x=e.x-t.x,e.y=e.y-t.y},_=function(e,t){e.x=t.x,e.y=t.y},y=function(e,t,o,n){var i,r,a;void 0===n?(a=t,i=e.x,r=e.y,n=o):(i=e,r=t,a=o),n.x=a.a*i+a.c*r+a.tx,n.y=a.b*i+a.d*r+a.ty},b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.spinData=null,t.particleData=null,t.autoplay=!1,t._elapsed=0,t._dontTint=!1,t.modeA=null,t.modeB=null,t._pointZeroForParticle=cc.v2(0,0),t._particles=[],t._emitCounter=0,t._particleIdx=0,t._allocatedParticles=0,t._isActive=!1,t.particleCount=0,t.duration=0,t._sourcePosition=null,t._posVar=null,t.life=0,t.lifeVar=0,t.angle=0,t.angleVar=0,t.startSize=0,t.startSizeVar=0,t.endSize=0,t.endSizeVar=0,t._startColor=null,t._startColorVar=null,t._endColor=null,t._endColorVar=null,t.startSpin=0,t.startSpinVar=0,t.endSpin=0,t.endSpinVar=0,t.emissionRate=0,t._totalParticles=0,t._blendFunc=null,t._opacityModifyRGB=!1,t.positionType=null,t.autoRemoveOnFinish=!1,t.emitterMode=0,t._position=cc.v2(0,0),t._particleActive=!1,t.animations=null,t.dictionary=null,t}return n(t,e),t.prototype.onLoad=function(){if(this.emitterMode=s.GRAVITY,this.modeA=new C,this.modeB=new T,this._blendFunc={src:cc.macro.BlendFactor.SRC_COLOR,dst:cc.macro.BlendFactor.DST_COLOR},this._particles=[],this._sourcePosition=cc.v2(0,0),this._posVar=cc.v2(0,0),this._startColor=cc.color(255,255,255,255),this._startColorVar=cc.color(255,255,255,255),this._endColor=cc.color(255,255,255,255),this._endColorVar=cc.color(255,255,255,255),this._elapsed=0,this._dontTint=!1,this._pointZeroForParticle=cc.v2(0,0),this._emitCounter=0,this._particleIdx=0,this._allocatedParticles=0,this._isActive=!1,this.particleCount=0,this.duration=0,this.life=0,this.lifeVar=0,this.angle=0,this.angleVar=0,this.startSize=0,this.startSizeVar=0,this.endSize=0,this.endSizeVar=0,this.startSpin=0,this.startSpinVar=0,this.endSpin=0,this.endSpinVar=0,this.emissionRate=0,this._totalParticles=0,this._opacityModifyRGB=!1,this.positionType=l.FREE,this.autoRemoveOnFinish=!1,this.animations=[],this.spinData)for(var e in this.spinData.skeletonJson.animations)this.animations.push(e);this.initWithFile(this.particleData),this._particleActive=this.autoplay},t.prototype.onDestroy=function(){this._particles.forEach(function(e){e&&e.release()}),this._particles=null,this.modeA=null,this.modeB=null,this.spinData=null},t.prototype.play=function(){this._particleActive=!0},t.prototype.resume=function(){this._particleActive=!0},t.prototype.pause=function(){this._particleActive=!1},t.prototype.stopSystem=function(){this._isActive=!1,this._elapsed=this.duration,this._emitCounter=0},t.prototype.resetSystem=function(){this._isActive=!0,this._elapsed=0;var e=this._particles;for(this._particleIdx=0;this._particleIdx<this.particleCount;++this._particleIdx){var t=e[this._particleIdx];t&&(t.timeToLive=0)}},t.prototype.isFull=function(){return this.particleCount>=this._totalParticles},t.prototype.createParticle=function(){var e=new d;e.animations=this.animations;var t=new cc.Node,o=t.addComponent(sp.Skeleton);return o.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),o.enableBatch=!0,o.skeletonData=this.spinData,this.node.addChild(t),e.node=t,e},t.prototype.addEmissionRate=function(e,t,o,n,i){void 0===t&&(t=0),void 0===o&&(o=0),void 0===n&&(n=0),void 0===i&&(i=0),this.dictionary&&(this.dictionary.emissionRate=e,this.initWithDictionary(this.dictionary,""))},t.prototype.initWithFile=function(e){var t=this,o=this.particleData;cc.loader.load({url:o,type:"plist"},function(o,n){return o&&cc.error(e+"\u4e0b\u8f7d\u5931\u8d25\uff01",o),t.initWithDictionary(n,"")})},t.prototype.initWithTotalParticles=function(e){return this._totalParticles=e,this._particles.length=e,this._allocatedParticles=e,this._isActive=!0,this.positionType=l.GROUPED,this.emitterMode=s.GRAVITY,this.autoRemoveOnFinish=!1,!0},t.prototype._valueForKey=function(e,t){if(t){var o=t[e];return null!=o?o:""}return""},t.prototype.initWithDictionary=function(e,t){this.dictionary=e;var o=this._valueForKey,n=parseInt(o("maxParticles",e));if(cc.log("maxParticles",n),this.initWithTotalParticles(n)){this.angle=parseFloat(o("angle",e)),this.angleVar=parseFloat(o("angleVariance",e)),this.duration=parseFloat(o("duration",e)),this._blendFunc.src=parseInt(o("blendFuncSource",e)),this._blendFunc.dst=parseInt(o("blendFuncDestination",e));var i=this._startColor;i.r=255*parseFloat(o("startColorRed",e)),i.g=255*parseFloat(o("startColorGreen",e)),i.b=255*parseFloat(o("startColorBlue",e)),i.a=255*parseFloat(o("startColorAlpha",e));var r=this._startColorVar;r.r=255*parseFloat(o("startColorVarianceRed",e)),r.g=255*parseFloat(o("startColorVarianceGreen",e)),r.b=255*parseFloat(o("startColorVarianceBlue",e)),r.a=255*parseFloat(o("startColorVarianceAlpha",e));var a=this._endColor;a.r=255*parseFloat(o("finishColorRed",e)),a.g=255*parseFloat(o("finishColorGreen",e)),a.b=255*parseFloat(o("finishColorBlue",e)),a.a=255*parseFloat(o("finishColorAlpha",e));var c=this._endColorVar;if(c.r=255*parseFloat(o("finishColorVarianceRed",e)),c.g=255*parseFloat(o("finishColorVarianceGreen",e)),c.b=255*parseFloat(o("finishColorVarianceBlue",e)),c.a=255*parseFloat(o("finishColorVarianceAlpha",e)),this.startSize=parseFloat(o("startParticleSize",e)),this.startSizeVar=parseFloat(o("startParticleSizeVariance",e)),this.endSize=parseFloat(o("finishParticleSize",e)),this.endSizeVar=parseFloat(o("finishParticleSizeVariance",e)),this._position.x=parseFloat(o("sourcePositionx",e)),this._position.y=parseFloat(o("sourcePositiony",e)),this._posVar.x=parseFloat(o("sourcePositionVariancex",e)),this._posVar.y=parseFloat(o("sourcePositionVariancey",e)),this.startSpin=parseFloat(o("rotationStart",e)),this.startSpinVar=parseFloat(o("rotationStartVariance",e)),this.endSpin=parseFloat(o("rotationEnd",e)),this.endSpinVar=parseFloat(o("rotationEndVariance",e)),this.emitterMode=parseInt(o("emitterType",e)),this.emitterMode===s.GRAVITY){var l=this.modeA;l.gravity.x=parseFloat(o("gravityx",e)),l.gravity.y=parseFloat(o("gravityy",e)),l.speed=parseFloat(o("speed",e)),l.speedVar=parseFloat(o("speedVariance",e));var u=o("radialAcceleration",e);l.radialAccel=u?parseFloat(u):0,u=o("radialAccelVariance",e),l.radialAccelVar=u?parseFloat(u):0,u=o("tangentialAcceleration",e),l.tangentialAccel=u?parseFloat(u):0,u=o("tangentialAccelVariance",e),l.tangentialAccelVar=u?parseFloat(u):0;var p=o("rotationIsDir",e);null!==p?(p=p.toString().toLowerCase(),l.rotationIsDir="true"===p||"1"===p):l.rotationIsDir=!1}else{if(this.emitterMode!==s.RADIUS)return!1;var d=this.modeB;d.startRadius=parseFloat(o("maxRadius",e)),d.startRadiusVar=parseFloat(o("maxRadiusVariance",e)),d.endRadius=parseFloat(o("minRadius",e)),d.endRadiusVar=0,d.rotatePerSecond=parseFloat(o("rotatePerSecond",e)),d.rotatePerSecondVar=parseFloat(o("rotatePerSecondVariance",e))}return this.life=parseFloat(o("particleLifespan",e)),this.lifeVar=parseFloat(o("particleLifespanVariance",e)),e.emissionRate?this.emissionRate=parseFloat(o("emissionRate",e)):(cc.log("[GameParticle] plist\u6587\u4ef6\u6ca1\u6709 emissionRate \u914d\u7f6e\u6570\u636e\uff0c\u53ef\u80fd\u5bfc\u81f4\u7c92\u5b50\u6570\u504f\u591a "+this.particleData),this.emissionRate=this._totalParticles/this.life),this._opacityModifyRGB=!1,!0}return!1},t.prototype.addParticle=function(){if(this.isFull())return!1;var e=this._particles[this.particleCount];return e||(e=this.createParticle(),this._particles[this.particleCount]=e),this.initParticle(e),e.node.active=!0,e.update(),++this.particleCount,!0},t.prototype.initParticle=function(e){var t=function(){return 2*Math.random()-1};e.timeToLive=this.life+this.lifeVar*t(),e.timeToLive=Math.max(0,e.timeToLive),e.pos.x=this._sourcePosition.x+this._posVar.x*t(),e.pos.y=this._sourcePosition.y+this._posVar.y*t();var o=e.timeToLive,n=this.startSize+this.startSizeVar*t();if(n=Math.max(0,n),e.size=n,-1===this.endSize)e.deltaSize=0;else{var i=this.endSize+this.endSizeVar*t();i=Math.max(0,i),e.deltaSize=(i-n)/o}var r=this.startSpin+this.startSpinVar*t(),a=this.endSpin+this.endSpinVar*t();e.rotation=r,e.deltaRotation=(a-r)/o,this.positionType===l.FREE?e.startPos=this.node.convertToWorldSpaceAR(this._pointZeroForParticle):this.positionType===l.RELATIVE&&(e.startPos.x=this._position.x,e.startPos.y=this._position.y);var c=cc.misc.degreesToRadians(this.angle+this.angleVar*t());if(this.emitterMode===s.GRAVITY){var u=this.modeA,p=e.modeA,d=u.speed+u.speedVar*t();p.dir.x=Math.cos(c),p.dir.y=Math.sin(c),p.dir.mulSelf(d),p.radialAccel=u.radialAccel+u.radialAccelVar*t(),p.tangentialAccel=u.tangentialAccel+u.tangentialAccelVar*t(),u.rotationIsDir&&(e.rotation=-cc.misc.radiansToDegrees(f(p.dir)))}else{var h=this.modeB,g=e.modeB,m=h.startRadius+h.startRadiusVar*t(),v=h.endRadius+h.endRadiusVar*t();g.radius=m,g.deltaRadius=-1===h.endRadius?0:(v-m)/o,g.angle=c,g.degreesPerSecond=cc.misc.degreesToRadians(h.rotatePerSecond+h.rotatePerSecondVar*t())}},t.prototype.update=function(e){if(this._particleActive){if(this._isActive&&this.emissionRate){var t=1/this.emissionRate;for(this.particleCount<this._totalParticles&&(this._emitCounter+=e);this.particleCount<this._totalParticles&&this._emitCounter>t;)this.addParticle(),this._emitCounter-=t;this._elapsed+=e,-1!==this.duration&&this.duration<this._elapsed&&this.stopSystem()}this._particleIdx=0;var o=new cc.Mat4;this.node.getWorldMatrix(o);var n=h[0];if(this.positionType===l.FREE?_(n,this.node.convertToWorldSpaceAR(this._pointZeroForParticle)):this.positionType===l.RELATIVE&&(n.x=this._position.x,n.y=this._position.y),this.node.active)for(var i=h[1],r=h[2],a=h[3],c=this._particles;this._particleIdx<this.particleCount;){g(i),g(r),g(a);var u=c[this._particleIdx];if(u||(u=this.createParticle(),c[this._particleIdx]=u),u.timeToLive-=e,u.timeToLive>0){if(this.emitterMode===s.GRAVITY){var p=a,d=i,f=r;u.pos.x||u.pos.y?(_(d,u.pos),d.normalizeSelf()):g(d),_(f,d),d.mulSelf(u.modeA.radialAccel);var b=f.x;f.x=-f.y,f.y=b,f.mulSelf(u.modeA.tangentialAccel),_(p,d),m(p,f),m(p,this.modeA.gravity),p.mulSelf(e),m(u.modeA.dir,p),_(p,u.modeA.dir),p.mulSelf(e),m(u.pos,p)}else{var C=u.modeB;C.angle+=C.degreesPerSecond*e,C.radius+=C.deltaRadius*e,u.pos.x=-Math.cos(C.angle)*C.radius,u.pos.y=-Math.sin(C.angle)*C.radius}u.size+=u.deltaSize*e,u.size=Math.max(0,u.size),u.rotation+=u.deltaRotation*e;var T=i;if(this.positionType===l.FREE||this.positionType===l.RELATIVE){var S=r,E=a;y(n,o,S),y(u.startPos,o,E),v(S,E),_(T,u.pos),v(T,S)}else _(T,u.pos);u.pos.x=T.x,u.pos.y=T.y,u.update(),++this._particleIdx}else{if(this._particleIdx!==this.particleCount-1){var L=c[this._particleIdx],w=c[this.particleCount-1];w||(w=this.createParticle(),c[this.particleCount-1]=w),c[this._particleIdx]=w,c[this.particleCount-1]=L}if(--this.particleCount,0===this.particleCount&&this.autoRemoveOnFinish)return void(this.enabled=!1)}}}},i([c(sp.SkeletonData)],t.prototype,"spinData",void 0),i([c({type:cc.ParticleAsset})],t.prototype,"particleData",void 0),i([c(cc.Boolean)],t.prototype,"autoplay",void 0),t=i([a],t)}(cc.Component);o.SpineParticle=b;var C=function(){return function(e,t,o,n,i,r,a,c){this.gravity=cc.v2(0,0),this.speed=0,this.speedVar=0,this.tangentialAccel=0,this.tangentialAccelVar=0,this.radialAccel=0,this.radialAccelVar=0,this.rotationIsDir=!1,this.gravity=e||cc.v2(0,0),this.speed=t||0,this.speedVar=o||0,this.tangentialAccel=n||0,this.tangentialAccelVar=i||0,this.radialAccel=r||0,this.radialAccelVar=a||0,this.rotationIsDir=c||!1}}(),T=function(){return function(e,t,o,n,i,r){this.startRadius=0,this.startRadiusVar=0,this.endRadius=0,this.endRadiusVar=0,this.rotatePerSecond=0,this.rotatePerSecondVar=0,this.startRadius=e||0,this.startRadiusVar=t||0,this.endRadius=o||0,this.endRadiusVar=n||0,this.rotatePerSecond=i||0,this.rotatePerSecondVar=r||0}}();cc._RF.pop()},{}],SpriteSelect:[function(e,t,o){"use strict";cc._RF.push(t,"43039nK4gtKcqvSZ8WzYRsl","SpriteSelect");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("./SelectBase"),a=cc._decorator,c=a.ccclass,s=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.offSprite=null,t.onSprite=null,t}return n(t,e),t.prototype.refresh=function(){this.node.getComponent(cc.Sprite).spriteFrame=this.state?this.onSprite:this.offSprite},i([s(cc.SpriteFrame)],t.prototype,"offSprite",void 0),i([s(cc.SpriteFrame)],t.prototype,"onSprite",void 0),t=i([c],t)}(r.default);o.SpriteSelect=l,cc._RF.pop()},{"./SelectBase":"SelectBase"}],StoreComponent:[function(e,t,o){"use strict";cc._RF.push(t,"854dfLZRylK3qDeiVvCL/nF","StoreComponent");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../core/Engine"),a=e("../../core/event/MessageManager"),c=e("../../core/gui/GUI"),s=e("../../core/language/LanguageLabel"),l=e("../../core/ui/button/ButtonEffect"),u=e("../../core/ui/ComponentExtends"),p=e("../../core/ui/label/LabelChangeSymbol"),d=e("../../core/ui/ViewUtils"),h=e("../../Main"),f=e("../../service/Service"),g=e("../AudioMessage"),m=e("../CalcUiShow"),v=[-75,-115,-130,-130,-110,-75,-75,-75,-75,-75],_=[cc.v2(3,-37),cc.v2(3,-49),cc.v2(3,-50)],y=[cc.v2(-8,89),cc.v2(-7,105),cc.v2(-5,107)],b=[cc.v2(95,5),cc.v2(132,-12),cc.v2(137,-10)],C=cc._decorator,T=C.ccclass,S=C.property,E=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.storeSkeleton=null,t.mainNodes=null,t.progressInitY=0,t.storeTag="",t.currentStoreInfo=null,t.priceMuti=1,t.clerkNode=null,t.storeId=0,t._currentClerkLv=-1,t.currentAddMuti={num:1,numE:0},t.currentStoreLv=0,t.currentPropMutiAdd=1,t.currentMainAdMuti=1,t.currentTimeSpanTotal=0,t.returnReward=null,t.mutiSche="",t.isAction=!1,t.animSche="",t.isAnim=!0,t.progresVal=0,t.isStopProgress=!1,t.preReturnRewardTime=0,t.isFullAnim=!1,t}return n(t,e),t.prototype.onLoad=function(){var e=this;this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchHandler,this),this.mainNodes=d.ViewUtils.nodeTreeInfoLite(this.node),this.storeSkeleton.node.active=!1,this.node.getChildByName("clerk").active=!1,this.mainNodes.get("buff_skeleton_top").active=!1,this.mainNodes.get("buff_skeleton_bottom").active=!1,this.mainNodes.get("up_skeleton_top").active=!1,this.mainNodes.get("up_skeleton_bottom").active=!1,this.unscheduleAllCallbacks(),this.schedule(function(){0!=e.preReturnRewardTime&&e.collectQuick()},1),this.mainNodes.get("store_info").opacity=0,this.mainNodes.get("lock").active=!1,this.mainNodes.get("btn_lock").active=!1,this.mainNodes.get("lock").getComponent(sp.Skeleton).setAnimation(0,"reward_loop",!0),this.mainNodes.get("progress_full").active=!1,this.mainNodes.get("progress_full").getComponent(sp.Skeleton).setAnimation(0,"reward_loop",!0),this.mainNodes.get("btn_progress").active=!1,this.mainNodes.get("border_back").active=!1,this.mainNodes.get("border_front").active=!1,this.mainNodes.get("up_tip").active=!1},t.prototype.loadStore=function(e,t,o){void 0===o&&(o=!1),this.storeTag=e,this.priceMuti=h.default.module.themeConfig.getStoreBaseConfigByTag(e).priceMulti,this.storeId=t.id,this.mainNodes.get("store_name").getComponent(s.LanguageLabel).dataID="ui_store_"+this.storeId,this.refreshUi(t,o);var n=cc.loader.getRes("main/store_skeleton/"+this.storeTag+"/"+this.storeTag,sp.SkeletonData);switch(this.storeSkeleton.skeletonData=n,this.storeSkeleton.premultipliedAlpha=6==this.storeId||7==this.storeId,this.storeSkeleton.node.active=!0,this.mainNodes.get("btn_progress").active=!0,this.progressInitY=v[this.storeId-1],this.mainNodes.get("btn_progress").y=this.progressInitY,this.mainNodes.get("border_back").getComponent(cc.Sprite).spriteFrame=cc.loader.getRes("main/no_pack/weilan/weilan_"+this.getAimStr()+"_2",cc.SpriteFrame),this.mainNodes.get("border_front").getComponent(cc.Sprite).spriteFrame=cc.loader.getRes("main/no_pack/weilan/weilan_"+this.getAimStr()+"_1",cc.SpriteFrame),this.mainNodes.get("border_front").setPosition(_[parseInt(this.getAimStr())-1]),this.mainNodes.get("border_back").setPosition(y[parseInt(this.getAimStr())-1]),this.mainNodes.get("novice_num").active=!0,1!=this.storeId&&(this.mainNodes.get("handler").destroy(),this.mainNodes.get("novice_num").active=!1),3==this.storeId&&(this.mainNodes.get("buff_skeleton_top").y=-13,this.mainNodes.get("buff_skeleton_bottom").y=-13),this.getAimStr()){case"1":this.mainNodes.get("up_tip").setPosition(cc.v2(-216,30-(3==this.storeId?13:0))),this.mainNodes.get("btn_lock").setPosition(b[0]);break;case"2":this.mainNodes.get("up_tip").setPosition(cc.v2(-265,28)),this.mainNodes.get("btn_lock").setPosition(b[1]);break;case"3":this.mainNodes.get("up_tip").setPosition(cc.v2(-300,12)),this.mainNodes.get("btn_lock").setPosition(b[2])}0==t.level?(this.storeSkeleton.setAnimation(0,"idle_0",!0),this.mainNodes.get("border_back").active=!0,this.mainNodes.get("border_front").active=!0):(this.mainNodes.get("border_back").active=!1,this.mainNodes.get("border_front").active=!1,0==t.level?this.storeSkeleton.setAnimation(0,"idle_0",!0):t.level>0&&t.level<100?this.storeSkeleton.setAnimation(0,"idle_1",!0):t.level>=100&&t.level<1e3?this.storeSkeleton.setAnimation(0,"idle_2",!0):t.level>=1e3&&this.storeSkeleton.setAnimation(0,"idle_3",!0)),this.node.getChildByName("clerk").name="clerk_"+this.storeId,this.clerkNode=this.node.getChildByName("clerk_"+this.storeId),this.node.getChildByName("clerk_"+this.storeId).parent=this.node.parent,this.clerkNode.zIndex=9999-this.clerkNode.y},t.prototype.noviceStart=function(e){var t=this;1==this.storeId&&0==e&&1==h.default.module.vm.level&&0==h.default.module.vm.noviceProgress.novice_1&&h.default.module.noviceHandle.handle1(this.mainNodes.get("btn_lock"),function(){var e=h.default.module.calcUiShow.calcTargetPrice(t.storeTag,t.currentStoreLv,1);t.upLvHandler(1,e,!0,function(){})})},Object.defineProperty(t.prototype,"currentClerkLv",{get:function(){return this._currentClerkLv},set:function(e){var t=this;if(0==this._currentClerkLv&&1==e){this.isAction=!1,this.mainNodes.get("btn_progress").y=this.progressInitY,this.mainNodes.get("btn_progress").StopAllActions();var o=h.default.module.calcUiShow.getSeverCurrentTime(),n=o-this.preReturnRewardTime;Math.floor(n/this.currentTimeSpanTotal)>0&&this.refreshCreditRewardTime(this.returnReward,o,function(){t.progresVal=0,t.isStopProgress=!1,t.preReturnRewardTime=o,t.refreshUpTip()},!0)}this._currentClerkLv=e,h.default.module.gamedata.clerksIdLv.set(this.storeId,e),this.clerkNode.active=e>0},enumerable:!0,configurable:!0}),t.prototype.refreshUi=function(e,t){void 0===t&&(t=!1),this.currentStoreInfo=e;var o=e.level||0;this.setLvLab(o,t),this.refreshUpTip()},t.prototype.playCaidai=function(){var e=cc.loader.getRes("main/effect_prefab/unlock1",cc.Prefab),t=h.default.module.gameMainControl.mainNodes.get("effect"),o=cc.instantiate(e);o.parent=t;var n=cc.loader.getRes("main/effect_prefab/unlock2",cc.Prefab),i=cc.instantiate(n),r=cc.v2(0,100+cc.winSize.height/2),a=t.convertToNodeSpaceAR(r);i.parent=t,i.setPosition(a),i.parent=h.default.module.gameMainControl.mainNodes.get("effect");var c=cc.loader.getRes("main/effect_prefab/unlock3",cc.Prefab),s=cc.instantiate(c),l=cc.v2(cc.winSize.width,100+cc.winSize.height/2),u=t.convertToNodeSpaceAR(l);s.parent=t,s.setPosition(u),this.scheduleOnce(function(){o.destroy(),i.destroy(),s.destroy()},6)},t.prototype.setLvLab=function(e,t){var o=this;e==this.currentStoreLv&&e>0||(0==this.currentStoreLv||0!=e||t||(this.storeSkeleton.setAnimation(0,"idle_0",!0),this.mainNodes.get("border_back").active=!0,this.mainNodes.get("border_front").active=!0),0==this.currentStoreLv&&e>0&&!t&&(this.mainNodes.get("border_back").active=!1,this.mainNodes.get("border_front").active=!1,this.scheduleOnce(function(){o.playCaidai()},.5)),e>0&&e<100&&0==this.currentStoreLv?this.storeSkeleton.setAnimation(0,"idle_1",!0):e>=100&&e<1e3&&this.currentStoreLv<100?this.storeSkeleton.setAnimation(0,"idle_2",!0):e>=1e3&&this.currentStoreLv<1e3&&this.storeSkeleton.setAnimation(0,"idle_3",!0),t||this.isOpenTip(e),this.currentStoreLv=e,this.mainNodes.get("lock").active=0==e,this.mainNodes.get("btn_lock").active=0==e,this.mainNodes.get("btn_progress").active=e>0,this.mainNodes.get("store_lv").getComponent(cc.Label).string="lv."+e,this.mainNodes.get("store_info").getComponent(cc.Layout).updateLayout(),h.default.module.gamedata.storesIdLv.set(this.storeId,e))},t.prototype.isOpenTip=function(e){var t=h.default.module.gamedata.storesIdLv.values();h.default.module.calcTool.sort(t);var o=t[0];h.default.module.gamedata.storesIdLv.set(this.storeId,e);var n=h.default.module.gamedata.storesIdLv.values();h.default.module.calcTool.sort(n);for(var i=n[0],r=h.default.module.themeConfig.getStoreSpeedLvConfigByTag("store_11").values(),a=-1,c=0;c<r.length;c++)if(o<r[c].level){a=c;break}var s=-1;if(-1!=a)for(c=a;c<r.length&&i>=r[c].level;c++)s=c;if(-1!=s){var l=r[s];h.default.module.gameMainControl.openPosterTip(l)}else{var u=h.default.module.themeConfig.getStoreSpeedLvConfigByTag(this.storeTag).values(),p=0;for(c=0;c<u.length;c++)if(this.currentStoreLv<u[c].level){p=c;break}var d=-1;for(c=p;c<u.length&&e>=u[c].level;c++)d=c;if(-1!=d){l=u[d];h.default.module.gameMainControl.openPosterTip(l)}}},t.prototype.setSpeedLab=function(e){var t=this;if(this.mainNodes.get("progress_full").active=!1,e&&this.currentStoreLv>0)if(this.currentTimeSpanTotal=e.get("timeStamp"),this.currentTimeSpanTotal<100&&0!=this.currentTimeSpanTotal){this.returnReward=e.get("rewardAvg");var o=h.default.module.calcTool.formatNum(this.returnReward);this.mainNodes.get("progress_lab").getComponent(p.LabelChangeSymbol).num=this.returnReward,this.mainNodes.get("progress_lab").getComponent(cc.Label).string=""+o.base+o.gear+"/s"}else{this.returnReward=e.get("reward");o=h.default.module.calcTool.formatNum(this.returnReward);this.mainNodes.get("progress_lab").getComponent(p.LabelChangeSymbol).num=this.returnReward,this.mainNodes.get("progress_lab").getComponent(cc.Label).string=""+o.base+o.gear}else this.returnReward={num:0,numE:0},this.mainNodes.get("progress_lab").getComponent(cc.Label).string="";if((this.currentPropMutiAdd!=h.default.module.gameMainControl.propMutiAdd&&1!=h.default.module.gameMainControl.propMutiAdd||this.currentMainAdMuti!=h.default.module.gameMainControl.mainAdMuti&&1!=h.default.module.gameMainControl.mainAdMuti)&&this.currentStoreLv>0){var n=this.getAimStr(),i=this.mainNodes.get("buff_skeleton_top").getComponent(sp.Skeleton),a=this.mainNodes.get("buff_skeleton_bottom").getComponent(sp.Skeleton),c="reward_idle_"+n+"_2",s="reward_idle_"+n+"_1";i.setAnimation(0,c,!0),a.setAnimation(0,s,!0),this.mainNodes.get("buff_skeleton_top").active=!0,this.mainNodes.get("buff_skeleton_bottom").active=!0,r.default.timer.unschedule(this.mutiSche),this.mutiSche=r.default.timer.scheduleOnce(function(){t.mainNodes.get("buff_skeleton_top").active=!1,t.mainNodes.get("buff_skeleton_bottom").active=!1},5)}else this.mainNodes.get("buff_skeleton_top").active=!1,this.mainNodes.get("buff_skeleton_bottom").active=!1;this.currentPropMutiAdd=h.default.module.gameMainControl.propMutiAdd,this.currentMainAdMuti=h.default.module.gameMainControl.mainAdMuti},t.prototype.playProgressAnim=function(){var e=this;this.mainNodes.get("btn_progress").RunAction(ezaction.scaleTo(.5,{y:this.progressInitY+10})).onStoped(function(){e.mainNodes.get("btn_progress").RunAction(ezaction.scaleTo(.5,{y:e.progressInitY-10})).onStoped(function(){e.playProgressAnim()})})},t.prototype.setProgress=function(e){e>1&&(e=1),this.mainNodes.get("progress_full").active=1==e&&this.currentTimeSpanTotal<100,this.mainNodes.get("progress_spr").getComponent(cc.Sprite).fillRange=e},t.prototype.upTipSkeletonAnim=function(){var e=this.mainNodes.get("up_tip").getComponent(sp.Skeleton);e.node.active=!0,"reward_loop"!=e.animation&&e.setAnimation(0,"reward_loop",!0)},t.prototype.btnUpSkeletonAnim=function(){var e=this;this.mainNodes.get("buff_skeleton_top").active=!1,this.mainNodes.get("buff_skeleton_bottom").active=!1,this.mainNodes.get("up_skeleton_top").active=!0,this.mainNodes.get("up_skeleton_bottom").active=!0;var t=this.mainNodes.get("up_skeleton_top").getComponent(sp.Skeleton),o=this.mainNodes.get("up_skeleton_bottom").getComponent(sp.Skeleton),n=this.getAimStr(),i="reward_up_"+n+"_2",r="reward_up_"+n+"_1";this.isAnim&&(this.isAnim=!1,t.setAnimation(0,i,!1),o.setAnimation(0,r,!1),t.setCompleteListener(function(){e.isAnim=!0,e.mainNodes.get("up_skeleton_top").active=!1,e.mainNodes.get("up_skeleton_bottom").active=!1}))},t.prototype.refreshUpTip=function(){var e=h.default.module.calcUiShow.calcTargetPrice(this.storeTag,this.currentStoreLv,1),t=h.default.module.themeConfig.getStoreMaxLvById(this.storeId);if(this.mainNodes.get("lock_tip").active=h.default.module.calcTool.compare(h.default.module.vm.credit,e)&&0==this.currentStoreLv,h.default.module.calcTool.compare(h.default.module.vm.credit,e)&&this.currentStoreLv<t&&this.currentStoreLv>0)this.upTipSkeletonAnim();else{var o=this.mainNodes.get("up_tip").getComponent(sp.Skeleton);this.currentStoreLv,o.node.active=!1}this.showButtonEffect(this.mainNodes.get("btn_lock"),h.default.module.calcTool.compare(h.default.module.vm.credit,e)),0==h.default.module.vm.noviceProgress.novice_3&&4-h.default.module.vm.winTotal.num>0&&1==this.storeId?(this.mainNodes.get("novice_num").active=!0,this.mainNodes.get("novice_num").getComponent(cc.Label).string=""+(4-h.default.module.vm.winTotal.num)):this.mainNodes.get("novice_num").active=!1},t.prototype.onTouchHandler=function(e){var t=this,o=h.default.module.vm;if(!(0==this.preReturnRewardTime&&this.currentStoreLv>0)&&!h.default.module.mainScene.mapControl.isMoving){var n=h.default.module.calcUiShow.calcTargetPrice(this.storeTag,this.currentStoreLv,1),i={modal:!0,opacity:126,touchClose:!0};if(0!=o.noviceProgress.novice_2)switch(e.target.name){case"btn_progress":if(a.Message.dispatchEvent(g.AudioMessage.BUILD_EFFECT,this.storeId),this.currentClerkLv>0||0==this.currentStoreLv)return void(this.currentClerkLv>0&&(this.playCollectEffect(),this.currentTimeSpanTotal<100&&0!=this.currentTimeSpanTotal?this.preReturnRewardTime=this.preReturnRewardTime-this.currentTimeSpanTotal:this.preReturnRewardTime=this.preReturnRewardTime-1e3));if(1!=this.progresVal)return;this.playCollectEffect(),f.service.analytics.logEvent("click_details","",""),a.Message.dispatchEvent(g.AudioMessage.EFFECT,"ui_2"),this.isAction=!1,this.mainNodes.get("btn_progress").y=this.progressInitY,this.mainNodes.get("btn_progress").StopAllActions(),this.isStopProgress=!0,this.mainNodes.get("progress_click").getComponent(sp.Skeleton).setAnimation(0,"reward",!1);var r=h.default.module.calcUiShow.getSeverCurrentTime();this.refreshCreditRewardTime(this.returnReward,r,function(){h.default.module.calcTool.compare(o.credit,{num:4,numE:0})&&1==o.storeList.store_1.level&&0==h.default.module.vm.noviceProgress.novice_3&&1==o.level?h.default.module.noviceHandle.noviceUpStore(function(){var e=h.default.module.calcUiShow.calcTargetPrice(t.storeTag,t.currentStoreLv,1);t.upLvHandler(1,e,!1,function(){h.default.module.gameMainControl.storeOperation.node.active&&h.default.module.gameMainControl.storeOperation.loadStoreBaseInfo()})}):(t.progresVal=0,t.isStopProgress=!1,t.preReturnRewardTime=r,t.refreshUpTip())},!0);break;case"btn_operation":if(h.default.module.gameMainControl.storeOperation)return;if(0==this.currentStoreLv&&!h.default.module.gameMainControl.storeOperation)return h.default.module.gameMainControl.mainTaskTip.setStorePosByMap(this.storeId),void(h.default.module.gameMainControl.pop_storeunlock_id=c.gui.popup.add("main/store_unlock",{storeId:this.storeId,callback:function(){t.upLvHandler(1,n,!0,function(){})},price:n,active:0},i));if(h.default.module.gameMainControl.storeOperation)return;f.service.analytics.logEvent("click_details","",""),h.default.module.gameMainControl.openStoreOperation(this.storeId);break;case"btn_lock":if(!e.target.getComponent(l.default))return;if(h.default.module.gameMainControl.storeOperation)return;f.service.analytics.logEvent("store_"+this.storeId+"_unlock","",""),h.default.module.gameMainControl.mainTaskTip.setStorePosByMap(this.storeId),h.default.module.gameMainControl.pop_storeunlock_id=c.gui.popup.add("main/store_unlock",{storeId:this.storeId,callback:function(){t.upLvHandler(1,n,!0,function(){})},price:n,active:0},i)}}},t.prototype.upLvHandler=function(e,t,o,n){var i=this;void 0===o&&(o=!1),a.Message.dispatchEvent(g.AudioMessage.EFFECT,"shop_ui"),a.Message.dispatchEvent(g.AudioMessage.EFFECT,"coin"),this.btnUpSkeletonAnim(),this.isAction=!1,this.mainNodes.get("btn_progress").y=this.progressInitY,this.mainNodes.get("btn_progress").StopAllActions(),this.isStopProgress=!0,o||this.playUpLvEffect();var r=h.default.module.vm,s=t;if(h.default.module.calcTool.compare(r.credit,s)){var l=h.default.module.calcUiShow.changeTaskListByTypeCount(m.TaskType.STORE_UP,e),u=h.default.module.calcUiShow.calcPostNum(this.storeId,e);h.default.module.gameProtocol.sendTaskList(l,function(e){if(r.taskList=l,u>0){var t=h.default.module.calcUiShow.changeTaskListByTypeCount(m.TaskType.STORE_CHALLENGE,u);cc.log("\u5e97\u94fa\u5347\u7ea7\u8fbe\u6210\u6311\u6218\u6539\u53d8\u4efb\u52a1\u5217\u8868"+JSON.stringify(t)),h.default.module.gameProtocol.sendTaskList(t,function(e){r.taskList=t})}});var p=this.changeList(e),d=this.currentTimeSpanTotal*this.progresVal;h.default.module.gameProtocol.sendStoreList(p,function(e){}),r.storeList=p,h.default.module.calcUiShow.refreshCredit({num:-s.num,numE:s.numE},function(){if(o){i.progresVal=0,i.preReturnRewardTime=h.default.module.calcUiShow.getSeverCurrentTime();var e=i.changStoreListUpdateTime(i.preReturnRewardTime);r.storeList=e,h.default.module.gameProtocol.sendStoreList(e,function(e){}),n&&n(),i.refreshUpTip()}else i.progresVal=d/i.currentTimeSpanTotal,i.progresVal>=1&&(i.currentClerkLv>0?h.default.module.calcUiShow.refreshCredit(i.returnReward,function(){i.preReturnRewardTime=h.default.module.calcUiShow.getSeverCurrentTime(),i.progresVal=0},!0):i.progresVal=1),n&&n(),i.refreshUpTip();i.isStopProgress=!1},!0)}else c.gui.notify.show("lack_credit")},t.prototype.changeList=function(e){var t=h.default.module.themeConfig.getStoreMaxLvById(this.storeId),o=h.default.module.vm.storeList,n={};for(var i in o)o[i].id==this.storeId?n[i]={id:o[i].id,level:this.currentStoreLv+e>=t?t:this.currentStoreLv+e,rewardTime:o[i].rewardTime}:n[i]={id:o[i].id,level:o[i].level,rewardTime:o[i].rewardTime};return n},t.prototype.refreshCreditRewardTime=function(e,t,o,n){void 0===n&&(n=!1);h.default.module.vm;h.default.module.calcUiShow.refreshCredit(e,o,n);var i=this.changStoreListUpdateTime(t);h.default.module.calcUiShow.refreshReturnRewardTime(i,n)},t.prototype.playUpLvEffect=function(){var e=cc.loader.getRes("main/effect_prefab/uplv_effect",cc.Prefab);cc.instantiate(e).parent=this.node},t.prototype.playCollectEffect=function(){var e=cc.loader.getRes("main/effect_prefab/collect_effect",cc.Prefab),t=cc.instantiate(e);t.parent=this.mainNodes.get("progress_gold"),this.scheduleOnce(function(){t.destroy()},6)},t.prototype.collect=function(){var e=this,t=h.default.module.calcUiShow.getSeverCurrentTime(),o=t-this.preReturnRewardTime,n=Math.floor(o/this.currentTimeSpanTotal),i=h.default.module.vm;this.currentStoreLv>0&&this.returnReward?this.currentTimeSpanTotal>=100&&(this.currentClerkLv>=1?o>=this.currentTimeSpanTotal?(this.refreshCreditRewardTime(h.default.module.calcTool.calcMutiNum(this.returnReward,{num:n,numE:0}),this.preReturnRewardTime+n*this.currentTimeSpanTotal),this.preReturnRewardTime=this.preReturnRewardTime+n*this.currentTimeSpanTotal,this.progresVal=(t-this.preReturnRewardTime)/this.currentTimeSpanTotal):this.progresVal=o/this.currentTimeSpanTotal:n>0&&!this.isStopProgress?(1==this.currentStoreLv&&1==this.storeId&&1==h.default.module.vm.level&&0==i.credit.num&&0==i.credit.numE&&0==h.default.module.vm.noviceProgress.novice_2?this.isStopProgress||(this.isStopProgress=!0,h.default.module.noviceHandle.handle2(this.mainNodes.get("btn_progress"),function(){var t=h.default.module.calcUiShow.getSeverCurrentTime();e.isAction=!1,e.mainNodes.get("btn_progress").y=e.progressInitY,e.mainNodes.get("btn_progress").StopAllActions(),e.refreshCreditRewardTime(e.returnReward,t,function(){e.progresVal=0,e.isStopProgress=!1,e.preReturnRewardTime=t,e.progresVal=0,e.refreshUpTip()},!0)})):this.isStopProgress=!0,this.progresVal=1,this.isAction||this.playProgressAnim()):this.isStopProgress||(this.progresVal=o/this.currentTimeSpanTotal)):this.progresVal=0,this.setProgress(this.progresVal)},t.prototype.collectQuick=function(){var e=h.default.module.calcUiShow.getSeverCurrentTime()-this.preReturnRewardTime;if(this.currentStoreLv>0&&this.returnReward){if(this.currentTimeSpanTotal<100&&(this.progresVal=1,this.currentClerkLv>=1)){var t=Math.floor(e/1e3);this.currentClerkLv>=1&&e>=1e3&&!this.isStopProgress&&(this.refreshCreditRewardTime(h.default.module.calcTool.calcMutiNum(this.returnReward,{num:t,numE:0}),this.preReturnRewardTime+1e3*t),this.preReturnRewardTime=this.preReturnRewardTime+1e3*t)}}else this.progresVal=0;this.setProgress(this.progresVal)},t.prototype.changStoreListUpdateTime=function(e){var t=h.default.module.vm.storeList,o={};for(var n in t)t[n].id==this.storeId?o[n]={id:t[n].id,level:this.currentStoreLv,rewardTime:e}:o[n]={id:t[n].id,level:t[n].level,rewardTime:t[n].rewardTime};return o},t.prototype.showStoreInfo=function(e,t){void 0===e&&(e=!0);var o=this.mainNodes;o.get("store_info").scale=1/t,o.get("store_info").StopAllActions(),o.get("store_info").RunAction(ezaction.fadeTo(e?.1:0,e?255:0))},t.prototype.update=function(e){0!=this.preReturnRewardTime&&this.collect()},t.prototype.getAimStr=function(){var e="";switch(this.storeId){case 1:case 2:case 3:case 4:e="1";break;case 6:case 9:e="2";break;case 5:case 7:case 8:case 10:e="3"}return e},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this),this.storeTag=null,this.priceMuti=null,this.clerkNode=null,this.currentTimeSpanTotal=null,this.currentAddMuti=null,this.returnReward=null,this._currentClerkLv=null,this.currentStoreLv=null,this.progresVal=null,this.preReturnRewardTime=null,this.isStopProgress=!1,this.mainNodes=null,this.storeId=null,this.currentStoreInfo=null,this.node.off(cc.Node.EventType.TOUCH_END,this.onTouchHandler,this)},t.prototype.showButtonEffect=function(e,t){var o=t?cc.Color.WHITE:cc.Color.GRAY,n=e.getComponent(l.default);e.color=o,n&&(n.canTouch=t);var i=function(e){if(0!=e.children.length)for(var t=0,n=e.children;t<n.length;t++){var r=n[t];r.color=o,i(r)}};i(e)},i([S(sp.Skeleton)],t.prototype,"storeSkeleton",void 0),t=i([T],t)}(u.ComponentExtends);o.default=E,cc._RF.pop()},{"../../Main":"Main","../../core/Engine":"Engine","../../core/event/MessageManager":"MessageManager","../../core/gui/GUI":"GUI","../../core/language/LanguageLabel":"LanguageLabel","../../core/ui/ComponentExtends":"ComponentExtends","../../core/ui/ViewUtils":"ViewUtils","../../core/ui/button/ButtonEffect":"ButtonEffect","../../core/ui/label/LabelChangeSymbol":"LabelChangeSymbol","../../service/Service":"Service","../AudioMessage":"AudioMessage","../CalcUiShow":"CalcUiShow"}],StoreOperation:[function(e,t,o){"use strict";cc._RF.push(t,"ff52e++6AdD07G5lcntXoKR","StoreOperation");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../core/event/MessageManager"),a=e("../../core/gui/GUI"),c=e("../../core/language/LanguageLabel"),s=e("../../core/ui/button/ButtonEffect"),l=e("../../core/ui/button/ButtonGear"),u=e("../../core/ui/ComponentExtends"),p=e("../../core/ui/label/LabelChangeSymbol"),d=e("../../core/ui/ViewUtils"),h=e("../../core/util/HashMap"),f=e("../../Main"),g=e("../../service/Service"),m=e("../AudioMessage"),v=e("./effect/MapControl"),_=e("./effect/ProgressAnim"),y=e("./StoreComponent"),b=ezaction.HCustomEase.create("ce2","M0,0 C0.018,0.592 0.092,0.79 0.154,0.9 0.172,0.932 0.209,1 0.268,1 0.394,1 0.572,1 1,1 "),C=ezaction.ease.customEase(b),T=[cc.v2(-945,-220),cc.v2(-685,-387),cc.v2(-135,215),cc.v2(170,90),cc.v2(-235,-515),cc.v2(155,-320),cc.v2(510,-140),cc.v2(88,-680),cc.v2(500,-480),cc.v2(850,-270)],S=cc._decorator,E=S.ccclass,L=(S.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.mainNodes=new h.HashMap,t.mutiConst_1=new h.HashMap,t.mutiConst_9=new h.HashMap,t.mutiConst_10=new h.HashMap,t.mutiConst_99=new h.HashMap,t.mutiConst_100=new h.HashMap,t.mutiConst_999=new h.HashMap,t.mutiConst_1000=new h.HashMap,t.contentNode=null,t.storesNode=null,t.currentStoreLv=0,t.currentStoreCom=null,t.priceMuti=1,t.entryScale=1,t.prePos=null,t.preViewId=-1,t._currentViewStoreId=-1,t.canClick=!0,t.returnReward=null,t.currentLvGear=1,t.currentAddMuti={num:1,numE:0},t.maxUpLv=0,t.maxAddMuti=null,t.resultAddMuti={num:0,numE:0},t.currentUpLv=1,t.currentCostPrice=null,t.storesIndex=-1,t.basePrice=null,t.nextPostIndex=0,t}return n(t,e),t.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchHandler,this),this.mainNodes=d.ViewUtils.nodeTreeInfoLite(this.node);for(var e=1;e<11;e++){var t=f.default.module.themeConfig.getStoreBaseConfigByTag("store_"+e).priceMulti;this.mutiConst_1.set(e,w(t,1)),this.mutiConst_9.set(e,w(t,9)),this.mutiConst_10.set(e,w(t,10)),this.mutiConst_99.set(e,w(t,99)),this.mutiConst_100.set(e,w(t,100)),this.mutiConst_999.set(e,w(t,999)),this.mutiConst_1000.set(e,w(t,1e3))}},t.prototype.onAdded=function(e){this.contentNode=e.contentNode,this.storesNode=e.storesNode,this.currentViewStoreId=e.storeId,this.setPrePosScale(),this.mainNodes.get("btn_buy").active=1==f.default.module.vm.mainProgress.progress_3||f.default.module.vm.level>1},t.prototype.refreshStoresIndex=function(){var e=f.default.module.gameMainControl.getUnlockStoreIds();this.storesIndex=e.indexOf(""+this.currentViewStoreId),1==e.length?(this.mainNodes.get("btn_next").active=!1,this.mainNodes.get("btn_pre").active=!1):(this.mainNodes.get("btn_next").active=this.storesIndex!=e.length-1,this.mainNodes.get("btn_pre").active=0!=this.storesIndex)},t.prototype.loadStoreBaseInfo=function(){if(-1!=this.currentViewStoreId){this.refreshStoresIndex(),r.Message.dispatchEvent(m.AudioMessage.BUILD_EFFECT,this.currentViewStoreId),this.currentStoreCom=this.storesNode.getChildByName("store_"+this.currentViewStoreId).getComponent(y.default);var e=f.default.module.vm.storeList["store_"+this.currentViewStoreId];this.mainNodes.get("store_title").getComponent(c.LanguageLabel).dataID="ui_store_"+this.currentViewStoreId;var t=this.mainNodes.get("store_icon");t.getComponent(cc.Sprite).spriteFrame=cc.loader.getRes("main/icon/icon"+this.currentViewStoreId,cc.SpriteFrame),6==this.currentViewStoreId&&(t.scale=.7);var o=this.mainNodes.get("store_lv");this.currentStoreLv=e.level,this.priceMuti=f.default.module.themeConfig.getStoreBaseConfigByTag("store_"+this.currentViewStoreId).priceMulti,o.getComponent(cc.Label).string="lv. "+e.level,0==this.currentStoreLv||1==this.currentStoreLv?this.currentAddMuti={num:1,numE:0}:1==this.currentViewStoreId?2==this.currentStoreLv?this.currentAddMuti={num:1,numE:0}:this.currentAddMuti=this.power(this.currentStoreLv-2):this.currentAddMuti=this.power(this.currentStoreLv-1),this.setBasePrice(),this.setSpeedLab()}},t.prototype.setPrePosScale=function(){this.entryScale=this.contentNode.scale},t.prototype.moveAnim=function(){if(-1!=this.currentViewStoreId){var e=T[this.currentViewStoreId-1];this.prePos=e,this.preViewId=this.currentViewStoreId,this.contentNode.width=4794,this.contentNode.height=4309,this.contentNode.RunAction(ezaction.moveTo(.5,{x:e.x,y:e.y}).easing(C)).onStoped(function(){}),this.contentNode.RunAction(ezaction.scaleTo(.3,{scale:f.default.module.mainScene.mapControl.initScale})).onStoped(function(){}),f.default.module.mainScene.showStoresName(!1,this.contentNode.scale),f.default.module.gameMainControl.openStoreOperationBtnState(!0)}else this.closeNode()},t.prototype.closeNode=function(){this.contentNode.scale=this.entryScale,this.contentNode.width=3727,this.contentNode.height=3240,f.default.module.gameMainControl.openStoreOperationBtnState(!1);var e=this.contentNode.getComponent(v.MapControl);if(e.smoothOperate(this.contentNode,this.prePos,this.entryScale,!1),-1!=this.preViewId){var t=f.default.module.mainScene.storesNode.getChildByName("store_"+this.preViewId);e.followTargetPos(t,.2),this.contentNode.scale=e.initScale,this.contentNode.RunAction(ezaction.scaleTo(.2,{scale:this.entryScale}))}a.gui.customPopup.clear()},Object.defineProperty(t.prototype,"currentViewStoreId",{get:function(){return this._currentViewStoreId},set:function(e){e!=this._currentViewStoreId&&this.canClick&&(this._currentViewStoreId=e,this.moveAnim(),this.loadStoreBaseInfo(),f.default.module.gameMainControl.refreshStoreProgress(e))},enumerable:!0,configurable:!0}),t.prototype.setProgress=function(){var e=this.calcNextPostProgress();0==e[0]?this.mainNodes.get("progress").getChildByName("progress_bar").width=392*this.currentStoreLv/e[1]:this.mainNodes.get("progress").getChildByName("progress_bar").width=392*(this.currentStoreLv-e[0])/(e[1]-e[0]);var t=f.default.module.themeConfig.getStoreMaxLvById(this.currentViewStoreId);this.currentStoreLv>=t?(this.mainNodes.get("progress").getChildByName("progress_lab").getComponent(cc.Label).string="max",this.mainNodes.get("progress").getChildByName("progress_bar").width=392):(this.mainNodes.get("progress").getChildByName("progress_lab").getComponent(cc.Label).string="+"+this.currentUpLv,f.default.module.calcTool.compare(f.default.module.vm.credit,this.currentCostPrice)||-1!=this.currentLvGear||(this.mainNodes.get("progress").getChildByName("progress_lab").getComponent(cc.Label).string="")),this.setSupProgress()},t.prototype.setSupProgress=function(){var e=this.calcNextPostProgress(),t=this.currentStoreLv+this.currentUpLv,o=f.default.module.themeConfig.getStoreMaxLvById(this.currentViewStoreId);if(t>=o||!this.currentCostPrice)this.mainNodes.get("progress").getChildByName("progress_sup").width=0;else{if(f.default.module.calcTool.compare(f.default.module.vm.credit,this.currentCostPrice)||-1!=this.currentLvGear||(t=this.currentStoreLv),this.currentStoreLv>=o&&(this.mainNodes.get("progress").getChildByName("progress_sup").width=392),0==e[0]){var n=t/e[1]>1?1:t/e[1];this.mainNodes.get("progress").getChildByName("progress_sup").width=392*n}else{n=(t-e[0])/(e[1]-e[0])>1?1:(t-e[0])/(e[1]-e[0]);this.mainNodes.get("progress").getChildByName("progress_sup").width=392*n}this.setSpeedLab()}},t.prototype.setSpeedLab=function(){var e=f.default.module.gamedata.storeBaseRewardList,t=f.default.module.vm.storeList["store_"+this.currentViewStoreId],o=e.get("store_"+this.currentViewStoreId);if(this.mainNodes.get("layout2").active=!0,this.mainNodes.get("speed").x=50,e&&t.level>0){var n=o.get("timeStamp");if(n<100&&0!=n){var i=o.get("rewardAvg"),r=f.default.module.calcTool.formatNum(i);this.mainNodes.get("speed_lab").getComponent(cc.Label).string=""+r.base+r.gear+"/s",this.mainNodes.get("speed_time").getComponent(cc.Label).string="1s",this.mainNodes.get("layout2").active=!1,this.mainNodes.get("speed").x=0,this.returnReward=i}else{i=o.get("reward");this.mainNodes.get("speed_lab").getComponent(p.LabelChangeSymbol).num=i;r=f.default.module.calcTool.formatNum(i);this.mainNodes.get("speed_lab").getComponent(cc.Label).string=""+r.base+r.gear,this.mainNodes.get("speed_time").getComponent(cc.Label).string=o.get("timeStamp")/1e3+"s",this.returnReward=i}}else this.mainNodes.get("speed_lab").getComponent(cc.Label).string="0",this.mainNodes.get("speed_time").getComponent(cc.Label).string="",this.returnReward={num:0,numE:0};this.setSupSpeed()},t.prototype.setSupSpeed=function(){if(!this.returnReward)return this.mainNodes.get("speed_sup_title").active=!1,void(this.mainNodes.get("speed_sup_lab").active=!1);var e=0,t=f.default.module.themeConfig.getStoreMaxLvById(this.currentViewStoreId);this.currentStoreLv>=t?e=0:(e=this.currentUpLv,f.default.module.calcTool.compare(f.default.module.vm.credit,this.currentCostPrice)||-1!=this.currentLvGear||(e=0));var o=this.storeListSupport(e);if(o){var n=f.default.module.calcUiShow.calcCollectSpeedSupport(o,this.currentViewStoreId);this.mainNodes.get("speed_sup_title").active=!0,this.mainNodes.get("speed_sup_lab").active=!0;var i=n.get("reward"),r="";n.get("timeStamp")<100&&(r="/s");var a=f.default.module.calcTool.formatNum(i),c=""+a.base+a.gear;this.mainNodes.get("speed_sup_lab").getComponent(cc.Label).string=""+c+r}else this.mainNodes.get("speed_sup_title").active=!1,this.mainNodes.get("speed_sup_lab").active=!1},t.prototype.storeListSupport=function(e){if(e<=0)return null;var t=f.default.module.vm.storeList,o={};for(var n in t)t[n].id==this.currentViewStoreId?o[n]={id:t[n].id,level:t[n].level+e}:o[n]={id:t[n].id,level:t[n].level};return o},t.prototype.setLvGear=function(e){if(-1!=this.currentViewStoreId){0==f.default.module.vm.noviceProgress.novice_11&&(e=1),e||(e=f.default.module.vm.gear);var t=this.mainNodes.get("btn_buy"),o=0;t.children.forEach(function(t,n){t.name==e+""?(t.active=!0,o=n):t.active=!1,"batch"==t.name&&(t.active=!0)}),t.getComponent(l.default).currentFrameIndex=o,this.currentLvGear=e,f.default.module.vm.gear=e,this.maxUpLv=0,this.setPriceLab()}},t.prototype.setPriceLab=function(){var e=this;if(this.basePrice){var t=f.default.module.calcUiShow,o=f.default.module.calcTool,n=f.default.module.themeConfig.getStoreMaxLvById(this.currentViewStoreId);if(this.currentStoreLv>=n)return this.mainNodes.get("btn_buy").children.forEach(function(e){"-1"==e.name?e.active=!0:e.active=!1}),this.setProgress(),this.mainNodes.get("max_num").getComponent(cc.Label).string="max",this.mainNodes.get("price_lab").getComponent(p.LabelChangeSymbol).string="max",void this.showButtonEffect(this.mainNodes.get("btn_up"),!1);if(this.currentLvGear<0&&this.currentStoreLv>0){var i=o.calcMutiNum(this.currentAddMuti,this.mutiConst_1.get(this.currentViewStoreId));1==this.currentStoreLv&&1==this.currentViewStoreId&&(i=this.currentAddMuti);var r=o.calcMutiNum(this.basePrice,i);if(this.currentCostPrice=r,o.compare(f.default.module.vm.credit,r)){this.maxAddMuti=this.currentAddMuti;var a=t.calcTargetPrice("store_"+this.currentViewStoreId,this.currentStoreLv,this.maxUpLv+1),c=this.currentAddMuti;if(o.compare(f.default.module.vm.credit,a)){var s=0,l=0;this.resultAddMuti={num:0,numE:0};for(var u=function(t){var i=o.calcAddNum(e.resultAddMuti,t,!1);return o.compare(f.default.module.vm.credit,o.calcMutiNum(e.basePrice,i))&&e.currentStoreLv+s<=n&&(e.resultAddMuti=i),i};o.compare(f.default.module.vm.credit,o.calcMutiNum(this.basePrice,u(o.calcMutiNum(c,this.calcMutiFunc(100,0==l)))))&&this.currentStoreLv+s<=n;)s+=100,c=this.power(this.currentStoreLv+s-1),1==this.currentViewStoreId&&(c=this.power(this.currentStoreLv+s-2)),l++;for(var d=0;o.compare(f.default.module.vm.credit,o.calcMutiNum(this.basePrice,u(o.calcMutiNum(c,this.calcMutiFunc(10,0==l&&0==d)))))&&this.currentStoreLv+s<=n;)s+=10,c=this.power(this.currentStoreLv+s-1),1==this.currentViewStoreId&&(c=this.power(this.currentStoreLv+s-2)),d++;for(var h=0,g=c;o.compare(f.default.module.vm.credit,o.calcMutiNum(this.basePrice,o.calcAddNum(this.resultAddMuti,o.calcMutiNum(c,this.calcMutiFunc(h+1,0==l&&0==d)),!1)))&&this.currentStoreLv+s<=n;){o.calcAddNum(this.resultAddMuti,o.calcMutiNum(c,this.calcMutiFunc(h+1,0==l&&0==d)),!1);s+=1,h++}this.currentUpLv=s,this.maxUpLv=s,this.currentStoreLv+s>=n&&(this.currentUpLv=n-this.currentStoreLv,this.maxUpLv=n-this.currentStoreLv),h>0&&(c=o.calcMutiNum(g,this.calcMutiFunc(h,0==l&&0==d)),this.resultAddMuti=o.calcAddNum(this.resultAddMuti,c,!1));var m=o.calcMutiNum(this.basePrice,this.resultAddMuti);this.maxAddMuti=c,1==this.currentStoreLv&&1==this.maxUpLv&&(1==this.currentViewStoreId?(m=this.basePrice,this.maxAddMuti={num:1,numE:0}):(m=o.calcMutiNum(this.basePrice,this.mutiConst_1.get(this.currentViewStoreId)),this.maxAddMuti=this.mutiConst_1.get(this.currentViewStoreId))),this.currentCostPrice=m,this.mainNodes.get("price_lab").getComponent(p.LabelChangeSymbol).num=m}else{this.currentUpLv=this.maxUpLv;m=t.calcTargetPrice("store_"+this.currentViewStoreId,this.currentStoreLv,this.maxUpLv);this.currentCostPrice=m,this.mainNodes.get("price_lab").getComponent(p.LabelChangeSymbol).num=m}}else this.mainNodes.get("price_lab").getComponent(p.LabelChangeSymbol).num=r,this.currentUpLv=1,this.maxUpLv=0}else if(this.currentStoreLv+this.currentLvGear>n){i=o.calcMutiNum(this.currentAddMuti,w(this.priceMuti,n-this.currentStoreLv));var v=o.calcMutiNum(this.basePrice,i);this.currentCostPrice=v,this.mainNodes.get("price_lab").getComponent(p.LabelChangeSymbol).num=v,this.currentUpLv=n-this.currentStoreLv,this.maxUpLv=0}else{var _=this.mutiConst_1.get(this.currentViewStoreId);this.currentUpLv=1,10==this.currentLvGear?(_=this.mutiConst_10.get(this.currentViewStoreId),this.currentUpLv=10):100==this.currentLvGear&&(_=this.mutiConst_100.get(this.currentViewStoreId),this.currentUpLv=100);i=o.calcMutiNum(this.currentAddMuti,_),v=o.calcMutiNum(this.basePrice,i);1==this.currentViewStoreId&&1==this.currentStoreLv&&1!=this.currentLvGear?v=o.calcDivideNum(v,{num:this.priceMuti,numE:0}):1==this.currentViewStoreId&&1==this.currentStoreLv&&1==this.currentLvGear?v=this.basePrice:1==this.currentViewStoreId&&0==this.currentStoreLv?v={num:0,numE:0}:0==this.currentStoreLv&&(v=this.basePrice);var y=f.default.module.themeConfig.getStoreLvConfigByTag("store_"+this.currentViewStoreId,this.currentStoreLv+1),b=o.formatNum({num:y.price,numE:y.priceE}),C=(r=o.formatNum(v),f.default.module.calcUiShow.calcTargetPrice("store_"+this.currentViewStoreId,this.currentStoreLv,this.currentUpLv));b=o.formatNum(C),this.currentLvGear,b.base==r.base&&b.gear==r.gear||0!=this.currentStoreLv&&cc.warn("\u914d\u7f6e"+b.base+b.gear+",\u8ba1\u7b97"+r.base+r.gear+"\u5f53\u524d\u7b49\u7ea7"+this.currentStoreLv+"\u4e0b\u4e00\u7ea7\u9700\u8981\u91d1\u5e01\u8ba1\u7b97\u9519\u8bef"),this.currentCostPrice=v,this.mainNodes.get("price_lab").getComponent(p.LabelChangeSymbol).num=v,this.currentUpLv=this.currentLvGear,this.maxUpLv=0}if(0==this.currentCostPrice.num&&0==this.currentCostPrice.numE&&1!=this.currentViewStoreId&&(this.currentCostPrice={num:1,numE:0}),0==this.currentStoreLv){var T=f.default.module.calcUiShow.calcTargetPrice("store_"+this.currentViewStoreId,0,1);this.currentCostPrice=T,0==this.currentCostPrice.num&&0==this.currentCostPrice.numE&&1!=this.currentViewStoreId&&(this.currentCostPrice={num:1,numE:0}),this.mainNodes.get("price_lab").getComponent(p.LabelChangeSymbol).num=T,this.currentUpLv=1}this.setProgress();var S=f.default.module.themeConfig.getStoreSpeedLvConfigByTag("store_"+this.currentViewStoreId).values();this.mainNodes.get("max_num").getComponent(cc.Label).string="x"+S[this.nextPostIndex].value,this.refreshBtnUpState()}},t.prototype.refreshBtnUpState=function(){var e=f.default.module.themeConfig.getStoreMaxLvById(this.currentViewStoreId);this.currentStoreLv>=e?this.showButtonEffect(this.mainNodes.get("btn_up"),!1):this.currentCostPrice&&this.showButtonEffect(this.mainNodes.get("btn_up"),f.default.module.calcTool.compare(f.default.module.vm.credit,this.currentCostPrice))},t.prototype.onTouchHandler=function(e){var t=this;if(this.canClick){var o=f.default.module.gameMainControl.getUnlockStoreIds();o.length;switch(e.target.name){case"btn_buy":var n=this.mainNodes.get("btn_buy").getComponent(l.default).currentFrameIndex,i=1;0==n?i=1:1==n?i=10:2==n?i=100:3==n&&(i=-1),this.setLvGear(i);break;case"btn_pre":if(g.service.analytics.logEvent("click_side","",""),0==this.storesIndex)return;this.storesIndex--,this.currentViewStoreId=parseInt(o[this.storesIndex]);break;case"btn_next":if(g.service.analytics.logEvent("click_side","",""),this.storesIndex==o.length-1)return;this.storesIndex++,this.currentViewStoreId=parseInt(o[this.storesIndex]);break;case"btn_close":this.currentViewStoreId=-1;break;case"btn_up":if(!e.target.getComponent(s.default).canTouch)return;this.playUpEffect(),this.currentStoreCom.upLvHandler(this.currentUpLv,this.currentCostPrice,0==this.currentStoreLv,function(){t.loadStoreBaseInfo()})}}},t.prototype.setBasePrice=function(){var e=1;if(this.node.active&&-1!=this.currentViewStoreId){if(f.default.module.vm.clerkList){var t="clerk_"+this.currentViewStoreId,o=f.default.module.vm.clerkList[t].level,n=f.default.module.themeConfig.getClerkConfigBytagLv(t,o),i=1;n&&(i=n.clerkLevelUpCostDiv),e*=i}if(f.default.module.vm.fameList){var r="fame_"+this.currentViewStoreId,a=f.default.module.vm.fameList[r].level,c=f.default.module.themeConfig.getFameConfigByTagLv(r,a),s=1;c&&(s=c.levelUpCostDiv),e*=s}var l=f.default.module.gameMainControl.propCostAdd,u=f.default.module.themeConfig.getStoreBaseConfigByTag("store_"+this.currentViewStoreId);this.basePrice=f.default.module.calcTool.calcConvertNum(u.price*e*l,0),this.setLvGear(f.default.module.vm.gear)}},t.prototype.calcNextPostProgress=function(){for(var e=f.default.module.themeConfig.getStoreSpeedLvConfigByTag("store_"+this.currentViewStoreId).values(),t=0,o=0;o<e.length;o++)if(this.currentStoreLv<e[o].level){t=o;break}return 0==t?(this.nextPostIndex=0,[0,e[t].level]):(this.nextPostIndex=t,[e[t-1].level,e[t].level])},t.prototype.playUpEffect=function(){var e=cc.loader.getRes("main/effect_prefab/progress_effect",cc.Prefab),t=cc.instantiate(e);this.mainNodes.get("_progress").getComponent(sp.Skeleton).setAnimation(0,"reward",!1),t.parent=this.mainNodes.get("_progress"),this.mainNodes.get("progress").getComponent(_.default).action(),this.scheduleOnce(function(){t.destroy()},2.5)},t.prototype.onDestroy=function(){this.contentNode=null,this.storesNode=null,this.currentStoreLv=null,this.currentStoreCom=null,this.priceMuti=null,this.entryScale=null,this.prePos=null,this.resultAddMuti=null,this.currentCostPrice=null,this.storesIndex=null,this.currentUpLv=null,this.basePrice=null,this.contentNode=null,this.currentLvGear=null,this.currentStoreLv=null,this._currentViewStoreId=null,this.mainNodes=null,this.currentAddMuti=null,this.maxAddMuti=null,this.maxUpLv=null,e.prototype.onDestroy.call(this)},t.prototype.power=function(e){if(0==e)return{num:1,numE:0};if(1==e)return{num:this.priceMuti,numE:0};for(var t={num:this.priceMuti,numE:0},o=0;o<e-1;o++)t=f.default.module.calcTool.calcConvertNum(t.num*this.priceMuti,t.numE);return t},t.prototype.calcMutiFunc=function(e,t){return 1==this.currentStoreLv&&1==this.currentViewStoreId&&t?1==e?{num:1,numE:0}:10==e?f.default.module.calcTool.calcAddNum({num:1,numE:0},this.mutiConst_9.get(this.currentViewStoreId),!1):100==e?f.default.module.calcTool.calcAddNum({num:1,numE:0},this.mutiConst_99.get(this.currentViewStoreId),!1):1e3==e?f.default.module.calcTool.calcAddNum({num:1,numE:0},this.mutiConst_999.get(this.currentViewStoreId),!1):f.default.module.calcTool.calcAddNum({num:1,numE:0},w(this.priceMuti,e-1),!1):10==e?this.mutiConst_10.get(this.currentViewStoreId):100==e?this.mutiConst_100.get(this.currentViewStoreId):1e3==e?this.mutiConst_1000.get(this.currentViewStoreId):w(this.priceMuti,e)},t.prototype.showButtonEffect=function(e,t){var o=t?cc.Color.WHITE:cc.Color.GRAY,n=e.getComponent(s.default);e.color=o,n&&(n.canTouch=t);var i=function(e){if(0!=e.children.length)for(var t=0,n=e.children;t<n.length;t++){var r=n[t];"price_lab"==r.name&&(o=new cc.Color(0,0,0)),r.color=o,i(r)}};i(e)},t=i([E],t)}(u.ComponentExtends));o.default=L;var w=function(e,t){if(1==t)return{num:e,numE:0};for(var o={num:0,numE:0},n={num:1,numE:0},i=0;i<t;i++)0==i?(o={num:e,numE:0},n=f.default.module.calcTool.calcMutiNum(n,{num:e,numE:0})):(n=f.default.module.calcTool.calcMutiNum(n,{num:e,numE:0}),o=f.default.module.calcTool.calcAddNum(o,n,!1));return o};cc._RF.pop()},{"../../Main":"Main","../../core/event/MessageManager":"MessageManager","../../core/gui/GUI":"GUI","../../core/language/LanguageLabel":"LanguageLabel","../../core/ui/ComponentExtends":"ComponentExtends","../../core/ui/ViewUtils":"ViewUtils","../../core/ui/button/ButtonEffect":"ButtonEffect","../../core/ui/button/ButtonGear":"ButtonGear","../../core/ui/label/LabelChangeSymbol":"LabelChangeSymbol","../../core/util/HashMap":"HashMap","../../service/Service":"Service","../AudioMessage":"AudioMessage","./StoreComponent":"StoreComponent","./effect/MapControl":"MapControl","./effect/ProgressAnim":"ProgressAnim"}],StoreUnLock:[function(e,t,o){"use strict";cc._RF.push(t,"b062fDvkMxFOLx+ipdNp/Ii","StoreUnLock");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../core/language/LanguageLabel"),a=e("../../core/ui/button/ButtonEffect"),c=e("../../core/ui/ComponentExtends"),s=e("../../core/ui/label/LabelChangeSymbol"),l=e("../../core/ui/ViewUtils"),u=e("../../Main"),p=cc._decorator,d=p.ccclass,h=(p.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.callback=null,t.storeId=1,t}return n(t,e),t.prototype.onLoad=function(){this.node.hasEventListener(cc.Node.EventType.TOUCH_END)||this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchHandler,this)},t.prototype.onAdded=function(e){this.node.scale=0,this.node.RunAction(ezaction.scaleTo(.3,{scale:1}));var t=l.ViewUtils.nodeTreeInfoLite(this.node);this.storeId=e.storeId,t.get("store_icon").scale=4==this.storeId||7==this.storeId?1.4:1.6,t.get("btn_close").active=0==e.active,t.get("store_icon").getComponent(cc.Sprite).spriteFrame=cc.loader.getRes("main/store_icon/store_icon"+this.storeId,cc.SpriteFrame),t.get("title").getComponent(r.LanguageLabel).dataID="ui_unlock_"+e.storeId,this.refreshLab(),this.callback=e.callback},t.prototype.refreshLab=function(){var e=l.ViewUtils.nodeTreeInfoLite(this.node),t=u.default.module.calcUiShow.calcTargetPrice("store_"+this.storeId,0,1);e.get("lab_num").getComponent(s.LabelChangeSymbol).num=t,this.showButtonEffect(e.get("btn_buy"),u.default.module.calcTool.compare(u.default.module.vm.credit,t)),e.get("price").getComponent(cc.Layout).updateLayout()},t.prototype.showButtonEffect=function(e,t){var o=t?cc.Color.WHITE:cc.Color.GRAY,n=e.getComponent(a.default);e.color=o,n&&(n.canTouch=t);var i=function(e){if(0!=e.children.length)for(var t=0,n=e.children;t<n.length;t++){var r=n[t];"lab_num"==r.name&&(o=cc.Color.BLACK),r.color=o,i(r)}};i(e)},t.prototype.onTouchHandler=function(e){if(!e.target.getComponent(a.default)||e.target.getComponent(a.default).canTouch)switch(e.target.name){case"btn_close":this.node.destroy();break;case"btn_buy":this.node.destroy(),this.callback&&this.callback()}},t.prototype.onDestroy=function(){this.callback=null,this.storeId=null,e.prototype.onDestroy.call(this)},t=i([d],t)}(c.ComponentExtends));o.default=h,cc._RF.pop()},{"../../Main":"Main","../../core/language/LanguageLabel":"LanguageLabel","../../core/ui/ComponentExtends":"ComponentExtends","../../core/ui/ViewUtils":"ViewUtils","../../core/ui/button/ButtonEffect":"ButtonEffect","../../core/ui/label/LabelChangeSymbol":"LabelChangeSymbol"}],TaskComponent:[function(e,t,o){"use strict";cc._RF.push(t,"e7699wRFOZL/47X1DPOVDuX","TaskComponent");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../core/event/MessageManager"),a=e("../../core/gui/GUI"),c=e("../../core/ui/ComponentExtends"),s=e("../../core/ui/ExToggleGroup"),l=e("../../core/ui/ViewUtils"),u=e("../../core/util/AsyncQueue"),p=e("../../Main"),d=e("../../service/Service"),h=e("../AudioMessage"),f=e("./TaskListChallengeItem"),g=e("./TaskListDayItem"),m=e("./TaskListMainItem"),v=cc._decorator,_=v.ccclass,y=v.property,b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.mainNodes=null,t.item_node1=null,t.item_node2=null,t.item_node3=null,t.cutdownNode=null,t.isUpdate=!1,t}return n(t,e),t.prototype.onLoad=function(){var e=this;d.service.analytics.logEvent("task_click_open","",""),this.mainNodes=l.ViewUtils.nodeTreeInfoLite(this.node),this.mainNodes.get("toggle_group").getComponent(s.default).toggleCallback=function(t){r.Message.dispatchEvent(h.AudioMessage.EFFECT,"ui_2");var o=t.node.name.replace(/[^\d]+/,"");e.mainNodes.get("toggle_group").getComponent(s.default).getItems().forEach(function(e){e.getChildByName("checkmark").active=t.node.name==e.name}),e.switchTag(o)},this.mainNodes.get("toggle_group").getComponent(s.default).setIndex(0),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchHandler,this),this.node.active=!1,p.default.module.gameMainControl.mainNodes.get("red_point_task").active=!1,this.switchTag("1")},t.prototype.switchTag=function(e){switch(e){case"1":this.mainNodes.get("toggle_group").children.forEach(function(e){e.active=!0}),this.mainNodes.get("day").active=!0,this.mainNodes.get("main").active=!1,this.mainNodes.get("challenge").active=!1,this.loadTaskDayList();break;case"2":d.service.analytics.logEvent("task_click_maintask","",""),this.mainNodes.get("toggle_group").children.forEach(function(e){e.active=!0}),this.mainNodes.get("day").active=!1,this.mainNodes.get("main").active=!0,this.mainNodes.get("challenge").active=!1,this.loadTaskMainList();break;case"3":d.service.analytics.logEvent("task_click_challenges","",""),this.mainNodes.get("day").active=!1,this.mainNodes.get("main").active=!1,this.mainNodes.get("challenge").active=!0,this.loadTaskChallengeList()}},t.prototype.loadTaskDayList=function(){if(this.item_node1&&!(this.item_node1.parent.children.length>1)){var e=p.default.module.vm.taskList,t=0;for(var o in e){var n=e[o];if("dateKey"!=o&&"endTime"!=o){var i=null;if(t<4&&3!=n.status){if(0==t)this.item_node1.active=!0,(i=this.item_node1.getComponent(g.default)).setData(n);else{var r=cc.instantiate(this.item_node1);r.parent=this.item_node1.parent,r.active=!0,(i=r.getComponent(g.default)).setData(n)}i.node.zIndex=n.id,i.clickCallback=this.itemClickDayHandler.bind(this),t++}}}var a=l.ViewUtils.nodeTreeInfoLite(this.node.getChildByName("day"));0==t?(this.item_node1.active=!1,a.get("no_task").active=!0):a.get("no_task").active=!1,this.node.active=!0}},t.prototype.loadTaskMainList=function(){var e=this,t=p.default.module.vm.level;10==t&&(this.mainNodes.get("main").active=!1);var o=p.default.module.vm.levelReward,n=this.item_node2.getComponent(m.default),i=p.default.module.themeConfig.getTaskConfigByTag("task_"+(20+o)),r=t>o;n.setData(i,r),n.clickCallback=function(t){if(r){var o=function(){p.default.module.gameProtocol.requestMainTaskReward(function(t){p.default.module.vm.diamond+=20,p.default.module.vm.levelReward+=1,e.loadTaskMainList()})};1==t.rewardType?p.default.module.gameMainControl.playDiamondffect(function(){o&&o()}):2==t.rewardType&&p.default.module.gameMainControl.playPackageffect(function(){o&&o()})}else e.node.destroy()},this.node.active=!0},t.prototype.loadTaskChallengeList=function(){var e=this;if(!(this.item_node3.parent.children.length>1)){var t=p.default.module.gamedata.storesIdLv,o=t.keys(),n=0;this.item_node3.active=!1,o.forEach(function(o){var i=p.default.module.themeConfig.getStoreSpeedLvConfigByTag("store_"+o).values(),r=t.get(o),a=0;if(r<p.default.module.themeConfig.getStoreMaxLvById(o)){for(var c=0;c<i.length;c++)if(i[c].level>r){a=i[c].level,i[c].value;break}var s=null,l={currentStoreLv:r,targetLv:a,id:o};if(0==n)e.item_node3.active=!0,s=e.item_node3.getComponent(f.default),e.item_node3.name="item_"+o,s.setData(l);else{var u=cc.instantiate(e.item_node3);u.parent=e.item_node3.parent,u.active=!0,u.name="item_"+o,(s=u.getComponent(f.default)).setData(l)}n++}});var i=t.values();p.default.module.calcTool.sort(i);for(var r=p.default.module.themeConfig.getStoreSpeedLvConfigByTag("store_11").keys(),a=0,c=0;c<r.length;c++)if(i[0]<r[c]){a=r[c];break}if(i[0]<=r[r.length-1]){var s={currentStoreLv:i[0],targetLv:a,id:11},l=cc.instantiate(this.item_node3);l.parent=this.item_node3.parent,l.name="item_11",l.active=!0,l.getComponent(f.default).setData(s)}this.node.active=!0}},t.prototype.changTaskGetDayState=function(e){var t=p.default.module.vm.taskList,o={};for(var n in t)"dateKey"!=n?t[n].id==e?(o[n]=t[n],o[n].status=3):o[n]=t[n]:o.dateKey=t[n];return o},t.prototype.getNextDayTask=function(){var e=p.default.module.vm.taskList,t=0;for(var o in e){var n=e[o];if("dateKey"!=o&&"endTime"!=o&&t<4&&3!=n.status){if(3==t)return n;t++}}return null},t.prototype.itemClickDayHandler=function(e,t){var o=this;p.default.module.vm;cc.log(JSON.stringify(t)),d.service.prompt.netInstableOpenByTask();var n=function(){if(2==t.status&&o.item_node1){e.target.parent.uuid==o.item_node1.uuid?o.item_node1.active=!1:e.target.parent.destroy();var n=o.getNextDayTask();if(n){var i=cc.instantiate(o.item_node1);i.parent=o.item_node1.parent,i.active=!0,i.zIndex=n.id;var r=i.getComponent(g.default);r.setData(n),r.clickCallback=o.itemClickDayHandler.bind(o)}var a=l.ViewUtils.nodeTreeInfoLite(o.node.getChildByName("day"));o.scheduleOnce(function(){o.item_node1.active||1!=a.get("content").children.length?a.get("no_task").active=!1:a.get("no_task").active=!0})}},i=p.default.module.themeConfig.getTaskConfigByTag("task_"+t.id).rewardType;if(2!=t.status);else{var r=this.changTaskGetDayState(t.id);d.service.analytics.logEvent("task_click_get","","");var a=u.AsyncQueue.excuteTimes(2,function(){n&&n(),d.service.prompt.netInstableClose()});1==i?p.default.module.gameMainControl.playDiamondffect(function(){p.default.module.gameProtocol.requestDayTaskReward(t.id,function(e){a&&a()}),p.default.module.gameProtocol.sendTaskList(r,function(e){p.default.module.vm.taskList=r,a&&a()})}):2==i&&p.default.module.gameMainControl.playPackageffect(function(){p.default.module.gameProtocol.requestDayTaskReward(t.id,function(e){a&&a()}),p.default.module.gameProtocol.sendTaskList(r,function(e){p.default.module.vm.taskList=r,a&&a()})})}},t.prototype.onDestroy=function(){this.mainNodes=null,this.isUpdate=null,p.default.module.gameMainControl.clearContainer(),this.node.off(cc.Node.EventType.TOUCH_END,this.onTouchHandler,this),e.prototype.onDestroy.call(this)},t.prototype.update=function(){},t.prototype.onTouchHandler=function(e){switch(e.target.name){case"btn_close":a.gui.delete(this.node)}},i([y(cc.Node)],t.prototype,"item_node1",void 0),i([y(cc.Node)],t.prototype,"item_node2",void 0),i([y(cc.Node)],t.prototype,"item_node3",void 0),i([y(cc.Node)],t.prototype,"cutdownNode",void 0),t=i([_],t)}(c.ComponentExtends);o.default=b,cc._RF.pop()},{"../../Main":"Main","../../core/event/MessageManager":"MessageManager","../../core/gui/GUI":"GUI","../../core/ui/ComponentExtends":"ComponentExtends","../../core/ui/ExToggleGroup":"ExToggleGroup","../../core/ui/ViewUtils":"ViewUtils","../../core/util/AsyncQueue":"AsyncQueue","../../service/Service":"Service","../AudioMessage":"AudioMessage","./TaskListChallengeItem":"TaskListChallengeItem","./TaskListDayItem":"TaskListDayItem","./TaskListMainItem":"TaskListMainItem"}],TaskListChallengeItem:[function(e,t,o){"use strict";cc._RF.push(t,"bc661W5QtpEt5fFjE0dPeZh","TaskListChallengeItem");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../core/language/LanguageLabel"),a=e("../../core/ui/ComponentExtends"),c=e("../../Main"),s=cc._decorator,l=s.ccclass,u=(s.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.clickCallback=null,t}return n(t,e),t.prototype.onLoad=function(){this.node.hasEventListener(cc.Node.EventType.TOUCH_END)||this.node.on(cc.Node.EventType.TOUCH_END,this.onBtnHandler,this)},t.prototype.onBtnHandler=function(e){},t.prototype.setData=function(e){var t=e.id;this.setDataId(t,e.targetLv);var o=cc.loader.getRes("main/icon/icon"+t,cc.SpriteFrame);this.node.getChildByName("task_progress_lab").getComponent(cc.Label).string=e.currentStoreLv+"/"+e.targetLv,this.node.getChildByName("task_spr").getComponent(cc.Sprite).spriteFrame=o,this.setProgress(e.currentStoreLv/e.targetLv);var n=c.default.module.themeConfig.getStoreSpeedLvConfigByTag("store_"+t).get(e.targetLv),i=n.type;this.node.getChildByName("clock").active=2==i,this.node.getChildByName("muti").active=1==i,this.node.getChildByName("clock").getChildByName("clock_lab").getComponent(cc.Label).string="x"+n.value,this.node.getChildByName("muti").getChildByName("muti_lab").getComponent(cc.Label).string="x"+n.value},t.prototype.setProgress=function(e){this.node.getChildByName("task_progress_spr").getComponent(cc.Sprite).fillRange=e,this.node.getChildByName("task_progress_light").active=e>=.04&&e<1,this.node.getChildByName("task_progress_light").x=(e-.04)*this.node.getChildByName("task_progress_spr").width-125},t.prototype.setDataId=function(e,t){var o="ui_challenge_value"+e,n=this.node.getChildByName("task_title").getComponent(r.LanguageLabel);n.dataID=o,n.setVars("value"+e,t+"")},t.prototype.onDestroy=function(){this.clickCallback=null,e.prototype.onDestroy.call(this)},t=i([l],t)}(a.ComponentExtends));o.default=u,cc._RF.pop()},{"../../Main":"Main","../../core/language/LanguageLabel":"LanguageLabel","../../core/ui/ComponentExtends":"ComponentExtends"}],TaskListDayItem:[function(e,t,o){"use strict";cc._RF.push(t,"d1708DKfCdMmbwe3Pxdm2LB","TaskListDayItem");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../core/event/MessageManager"),a=e("../../core/language/LanguageLabel"),c=e("../../core/ui/button/ButtonEffect"),s=e("../../core/ui/ComponentExtends"),l=e("../../Main"),u=e("./adv/AdvControl"),p=cc._decorator,d=p.ccclass,h=(p.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.clickCallback=null,t.data=null,t.status=0,t}return n(t,e),t.prototype.onLoad=function(){this.node.hasEventListener(cc.Node.EventType.TOUCH_END)||this.node.on(cc.Node.EventType.TOUCH_END,this.onBtnHandler,this)},t.prototype.onBtnHandler=function(e){var t=this;if("btn_get"==e.target.name&&e.target.getComponent(c.default)&&e.target.getComponent(c.default).canTouch){var o=this.node.getChildByName("task_skeleton").getComponent(sp.Skeleton);e.target.getComponent(c.default).canTouch=!1,"btn_get"==e.target.name&&o.setAnimation(0,"reward",!1),this.clickCallback&&this.clickCallback(e,this.data)}if("btn_poster"==e.target.name&&e.target.getComponent(c.default)&&e.target.getComponent(c.default).canTouch){if(e.target.getComponent(c.default).canTouch=!1,cc.sys.isBrowser){cc.log("\u6d4f\u89c8\u5668\u76f4\u63a5\u4fee\u6539\u6bcf\u65e5\u4efb\u52a1\u5b8c\u6210\u72b6\u6001");var n=this.changTaskFinishState(this.data.id);return l.default.module.vm.taskList=n,void l.default.module.gameProtocol.sendTaskList(n,function(e){t.data=t.copy(l.default.module.vm.taskList["task_"+t.data.id]),t.setData(t.data)})}r.Message.dispatchEvent(u.AdvMessage.PLAY,{callback:function(o,n){if(n==u.AdvRewardType.DAY_TASK)if(o){var i=t.changTaskFinishState(t.data.id);l.default.module.vm.taskList=i,l.default.module.gameProtocol.sendTaskList(i,function(e){t.data=t.copy(l.default.module.vm.taskList["task_"+t.data.id]),t.setData(t.data)})}else cc.log("\u6bcf\u65e5\u4efb\u52a1\u89c2\u770b\u5e7f\u544a\u5931\u8d25"),e.target.getComponent(c.default).canTouch=!0},type:u.AdvRewardType.DAY_TASK})}},t.prototype.copy=function(e){var t={};for(var o in e)t[o]=e[o];return t},t.prototype.setData=function(e){this.data=this.copy(e);var t=e.id,o=l.default.module.themeConfig.getTaskConfigByTag("task_"+t);this.node.getChildByName("btn_poster").getComponent(c.default).canTouch=!0,this.node.getChildByName("btn_get").getComponent(c.default).canTouch=!0,this.setProgress(e.taskValue/o.taskTag),this.node.getChildByName("task_progress_lab").getComponent(cc.Label).string=e.taskValue+"/"+o.taskTag,this.status=e.status,this.btnState(this.status),this.setDataId(t,o.taskTag),this.node.getChildByName("task_package").active=2==o.rewardType,this.node.getChildByName("task_diamond").active=1==o.rewardType,this.node.getChildByName("task_diamond").getChildByName("task_diamond_num").getComponent(cc.Label).string="X"+o.rewardValue},t.prototype.btnState=function(e){this.node.getChildByName("btn_poster").active=e<2,this.node.getChildByName("btn_get").active=2==e},t.prototype.setProgress=function(e){this.node.getChildByName("task_progress_spr").getComponent(cc.Sprite).fillRange=e,this.node.getChildByName("task_progress_light").active=e>=.04&&e<1,this.node.getChildByName("task_progress_light").x=(e-.04)*this.node.getChildByName("task_progress_spr").width-123},t.prototype.setDataId=function(e,t){var o="";switch(e){case 1:case 2:case 3:o="ui_info_value1";break;case 4:case 5:o="ui_info_value2";break;case 6:case 7:o="ui_info_value3";break;case 8:case 9:o="ui_info_value4";break;case 10:o="ui_info_value5";break;case 11:case 12:case 13:o="ui_info_value6";break;case 14:case 15:o="ui_info_value7";break;case 16:case 17:case 18:o="ui_info_value8";break;case 19:case 20:o="ui_info_value9"}var n=this.node.getChildByName("task_title").getComponent(a.LanguageLabel);n.dataID=o,n.setVars(o.split("_")[2],t+"")},t.prototype.changTaskFinishState=function(e){var t=l.default.module.vm.taskList,o={};for(var n in t)"dateKey"!=n?t[n].id==e?(o[n]=t[n],o[n].status=2,o[n].taskValue=o[n].taskTag):o[n]=t[n]:o.dateKey=t[n];return o},t.prototype.onDestroy=function(){this.clickCallback=null,this.data=null,this.status=null,e.prototype.onDestroy.call(this)},t=i([d],t)}(s.ComponentExtends));o.default=h,cc._RF.pop()},{"../../Main":"Main","../../core/event/MessageManager":"MessageManager","../../core/language/LanguageLabel":"LanguageLabel","../../core/ui/ComponentExtends":"ComponentExtends","../../core/ui/button/ButtonEffect":"ButtonEffect","./adv/AdvControl":"AdvControl"}],TaskListMainItem:[function(e,t,o){"use strict";cc._RF.push(t,"33794lD961IYY/T4cUN12mx","TaskListMainItem");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../core/language/LanguageLabel"),a=e("../../core/ui/button/ButtonEffect"),c=e("../../core/ui/ComponentExtends"),s=cc._decorator,l=s.ccclass,u=(s.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.clickCallback=null,t.taskId=0,t.data=null,t}return n(t,e),t.prototype.onLoad=function(){this.node.hasEventListener(cc.Node.EventType.TOUCH_END)||this.node.on(cc.Node.EventType.TOUCH_END,this.onBtnHandler,this)},t.prototype.onBtnHandler=function(e){if("btn_get"==e.target.name&&e.target.getComponent(a.default)&&e.target.getComponent(a.default).canTouch){var t=this.node.getChildByName("task_skeleton").getComponent(sp.Skeleton);e.target.getComponent(a.default).canTouch=!1,"btn_get"==e.target.name&&t.setAnimation(0,"reward",!1),this.clickCallback&&this.clickCallback(this.data)}},t.prototype.setData=function(e,t){var o=e.id;this.taskId=o,this.data=e,this.node.getChildByName("btn_get").getComponent(a.default).canTouch=!0,this.node.getChildByName("task_reward_lab_prop").active=2==e.rewardType,this.node.getChildByName("task_reward_lab").active=1==e.rewardType,this.setDataId(o,e.rewardValue);var n=cc.loader.getRes("main/country/country_"+(o-20+1),cc.SpriteFrame);this.node.getChildByName("task_spr").getComponent(cc.Sprite).spriteFrame=n,this.btnState(t)},t.prototype.btnState=function(e){this.node.getChildByName("btn_get").active=e},t.prototype.setDataId=function(e,t){var o="ui_info_"+(e-20);this.node.getChildByName("task_title").getComponent(r.LanguageLabel).dataID=o,this.node.getChildByName("task_reward_lab").getComponent(r.LanguageLabel).setVars("reward1",t+"")},t.prototype.onDestroy=function(){this.taskId=null,this.clickCallback=null,this.data=null,e.prototype.onDestroy.call(this)},t=i([l],t)}(c.ComponentExtends));o.default=u,cc._RF.pop()},{"../../core/language/LanguageLabel":"LanguageLabel","../../core/ui/ComponentExtends":"ComponentExtends","../../core/ui/button/ButtonEffect":"ButtonEffect"}],ThemeConfig:[function(e,t,o){"use strict";cc._RF.push(t,"9b631TDkZFJ3YABujRJX3J7","ThemeConfig"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../core/util/HashMap"),i=function(){return function(e,t){this.id=0,this.tag="",this.name="",this.maxLevel=0,this.reward=0,this.timeStamp=0,this.price=0,this.priceMulti=0,this.id=parseInt(t.id),this.tag=e,this.name=t.name,this.maxLevel=t.maxLevel,this.reward=t.reward,this.timeStamp=t.timeStamp,this.price=t.price,this.priceMulti=t.priceMulti}}();o.StoreConfigItem=i;var r=function(){function e(){this.storeMaxLvList=new n.HashMap,this.clerkMaxLvList=new n.HashMap,this.fameMaxLvList=new n.HashMap,this.storeList=new n.HashMap,this.storeLvConfig=new n.HashMap,this.clerkLevelList=new n.HashMap,this.fameLvList=new n.HashMap,this.buildingList=new n.HashMap,this.storeSpeedLvConfig=new n.HashMap,this.taskConfig=new n.HashMap,this.additionConfig=new n.HashMap;var e=cc.loader.getRes("main/json/storeConfig",cc.JsonAsset),t=cc.loader.getRes("main/json/clerkLevel",cc.JsonAsset),o=cc.loader.getRes("main/json/fameLevel",cc.JsonAsset),r=cc.loader.getRes("main/json/building",cc.JsonAsset),a=cc.loader.getRes("main/json/storeLevel",cc.JsonAsset),c=cc.loader.getRes("main/json/task",cc.JsonAsset),s=cc.loader.getRes("main/json/addition",cc.JsonAsset);for(var l in e.json&&(e=e.json,t=t.json,o=o.json,r=r.json,a=a.json,c=c.json,s=s.json),this.fameMaxLvList.clear(),this.clerkMaxLvList.clear(),this.storeMaxLvList.clear(),this.storeList.clear(),this.storeLvConfig.clear(),this.clerkLevelList.clear(),this.fameLvList.clear(),this.buildingList.clear(),this.storeSpeedLvConfig.clear(),this.additionConfig.clear(),r.building){var u={id:r.building[l].id,name:r.building[l].name,count:r.building[l].count,target:r.building[l].target,targetE:r.building[l].targetE,multi:r.building[l].multi,fameCount:r.building[l].fameCount};this.buildingList.set(r.building[l].id,u)}for(var l in e.store)this.storeList.set(l,new i(l,e.store[l])),this.storeLvConfig.set(l,this.conventStoreData(e.store[l])),this.storeMaxLvList.set(e.store[l].id,e.store[l].maxLevel);for(var l in t.clerk_level){var p=t.clerk_level[l],d=new n.HashMap;for(var h in p){var f={clerkTag:l,clerkId:p[h].id,clerkLevel:p[h].level,clerkPrice:p[h].price,clerkPriceE:p[h].priceE,clerkRewardType:p[h].type,clerkValue:p[h].value,clerkLevelUpCostDiv:p[h].levelUpCostDiv,clerkFameMultiTotal:p[h].fameMultiTotal,clerkMultiTotalReal:p[h].multiTotalReal,clerkMultiTotal:p[h].multiTotal,clerkMultiTotalE:p[h].multiTotalE};d.set(parseInt(h),f)}this.clerkLevelList.set(l,d),this.clerkMaxLvList.set(parseInt(l.split("_")[1]),p.maxLevel)}for(var l in o.fame_level){p=o.fame_level[l];var g=new n.HashMap;for(var h in p){var m={tag:l,id:p[h].id,level:p[h].level,price:p[h].price,priceE:p[h].priceE,type:p[h].type,value:p[h].value,levelUp:p[h].levelUp,levelUpCostDiv:p[h].levelUpCostDiv,fameMultiTotal:p[h].fameMultiTotal,multiTotalReal:p[h].multiTotalReal,multiTotal:p[h].multiTotal,multiTotalE:p[h].multiTotalE};g.set(parseInt(h),m)}this.fameLvList.set(l,g),this.fameMaxLvList.set(parseInt(l.split("_")[1]),p.maxLevel)}var v=function(e){var t=a.store_level[e].data,o=new n.HashMap;t.forEach(function(e){var t={id:e.id,level:e.level,type:e.type,value:e.value,timeDivTotal:e.timeDivTotal,multiTotal:e.multiTotal,multiTotalE:e.multiTotalE,multiTotalReal:e.multiTotalReal};o.set(t.level,t)}),_.storeSpeedLvConfig.set(e,o)},_=this;for(var l in a.store_level)v(l);for(var l in c.task){var y={id:(p=c.task[l]).id,taskType:p.type,rewardType:p.rewardType,rewardValue:p.rewardValue,taskTag:p.tag};this.taskConfig.set(l,y)}for(var l in s.addition){var b={id:s.addition[l].id,addType:s.addition[l].type,addValue:1==s.addition[l].type?[s.addition[l].value]:[s.addition[l].value1,s.addition[l].value2]};this.additionConfig.set(l,b)}cc.log("\u3010themeConfig\u3011\u89e3\u6790\u5b8c\u6210",this.storeSpeedLvConfig,this.storeList,this.storeLvConfig,this.storeMaxLvList,this.clerkMaxLvList,this.fameLvList,this.buildingList,this.clerkLevelList,this.fameLvList,this.taskConfig,this.additionConfig)}return e.prototype.getBuildingConfigById=function(e){return this.buildingList.get(e)?this.buildingList.get(e):null},e.prototype.getFameMaxLvById=function(e){return this.fameMaxLvList.get(e)},e.prototype.getClerkMaxLvById=function(e){return this.clerkMaxLvList.get(e)},e.prototype.getStoreMaxLvById=function(e){return this.storeMaxLvList.get(e)},e.prototype.getClerkConfigBytagLv=function(e,t){return this.clerkLevelList.get(e).get(t)?this.clerkLevelList.get(e).get(t):null},e.prototype.conventStoreData=function(e){for(var t=new n.HashMap,o=0,i=0,r=e.maxLevel+1,a=1;a<r;a++)1===a?o=1===e.id?0:e.price:0===(o*=e.priceMulti)&&(o=e.price),o>1e3&&(o/=1e3,i+=3),o=Number(o.toFixed(14)),t.set(a,{level:a,price:o,priceE:i});return t},e.prototype.getStoreBaseConfigByTag=function(e){return this.storeList.get(e)?this.storeList.get(e):null},e.prototype.getStoreLvConfigByTag=function(e,t){return this.storeLvConfig.get(e).get(t)?this.storeLvConfig.get(e).get(t):null},e.prototype.getStoreSpeedLvConfigByTag=function(e){return this.storeSpeedLvConfig.get(e)?this.storeSpeedLvConfig.get(e):null},e.prototype.getFameConfigByTagLv=function(e,t){return this.fameLvList.get(e).get(t)?this.fameLvList.get(e).get(t):null},e.prototype.getTaskConfigByTag=function(e){return this.taskConfig.get(e)?this.taskConfig.get(e):null},e.prototype.getPropConfigByTag=function(e){return this.additionConfig.get(e)?this.additionConfig.get(e):null},e}();o.ThemeConfig=r,cc._RF.pop()},{"../core/util/HashMap":"HashMap"}],ThemeMessage:[function(e,t,o){"use strict";cc._RF.push(t,"1c575xktRRMRqroPpe+Z+Pa","ThemeMessage"),Object.defineProperty(o,"__esModule",{value:!0}),function(e){e.REFRESH_ENTRY="REFRESH_ENTRY",e.REFRESH_GAME="REFRESH_GAME",e.REFRESH_PAGE="REFRESH_PAGE",e.STATE_CAHNGE="state_change",e.WIN_PLAY_ONCE="WIN_PLAY_ONCE",e.EMILINATED_FLY="EMILINATED_FLY",e.RESET_FREESPIN_ELEMENTS="RESET_FREESPIN_ELEMENTS",e.ELEM_REWARD_EFFECT="elements_reward_effect",e.AUTO_POPUP_CHANGE="auto_popup_change",e.AUTO_TIMES_CHANGE="AUTO_TIMES_CHANGE",e.OPEN_AUTO_COMPLETE="OPEN_AUTO_COMPLETE",e.PROP_CHANGE="PROP_CHANGE",e.FREESPIN_RESULT="FREESPIN_RESULT",e.PROMOTION_DATA_CHANGE="promotion_data_change",e.BG_START="bg_start",e.BG_END="bg_end",e.BG_DAIJI="bg_daiji",e.SHOW_BIGWIN="show_bigwin",e.CHANG_LANG="chang_lang",e.FLOOR_FAST="floor_fast",e.FLOOR_SLOW="floor_slow",e.FLOOR_LIGHT="floor_light",e.FLOOR_LIGHT2="floor_light2",e.FLOOR_LIGHT3="floor_light3",e.FLOOR_LIGHT4="floor_light4",e.BG_GUANG_ACTIVE="bg_guang_active",e.CREDIT="credit"}(o.ThemeMessage||(o.ThemeMessage={})),cc._RF.pop()},{}],Toast:[function(e,t,o){"use strict";cc._RF.push(t,"fe738JZorlJaJhFwxGgURQH","Toast");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../Engine"),a=e("../../EngineMessage"),c=e("../ComponentExtends"),s=cc._decorator,l=s.ccclass,u=s.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.lab=null,t.fadeTime=.5,t.stayTime=1.5,t}return n(t,e),t.prototype.onLoad=function(){var e=this;this.on(a.EngineMessage.GAME_RESIZE,function(t,o){t==a.EngineMessage.GAME_RESIZE&&e.layout()},this)},t.prototype.layout=function(){this.node.scale=r.default.fit?.6:1},t.prototype.showToast=function(e,t,o){var n=this;this.layout();var i=this.lab.node.getComponent("LanguageLabel");t?i.dataID=e:(i&&(i.dataID=""),this.lab.string=e),this.node.opacity=255,this.node.setPosition(0,0);var r=cc.fadeOut(this.fadeTime),a=cc.callFunc(function(){o&&o(n.node)});cc.isValid(this.node)&&(this.node.stopAllActions(),this.node.runAction(cc.sequence(cc.delayTime(this.stayTime),r,a)))},i([u(cc.Label)],t.prototype,"lab",void 0),t=i([l],t)}(c.ComponentExtends);o.default=p,cc._RF.pop()},{"../../Engine":"Engine","../../EngineMessage":"EngineMessage","../ComponentExtends":"ComponentExtends"}],UINumberPicker:[function(e,t,o){"use strict";cc._RF.push(t,"3b28b37NrNK04y70cnje267","UINumberPicker");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,a=r.ccclass,c=r.property,s=function(){function e(e){this._container=null,this._child=null,this.lab=null,this._value=0,this._container=e,this._child=new cc.Node,e.addChild(this._child);var t=new cc.Node;this.lab=t.addComponent(cc.Label),this._child.addChild(t)}return Object.defineProperty(e.prototype,"direction",{set:function(e){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"x",{get:function(){return this._child.x},set:function(e){this._child.x=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._child.y},set:function(e){this._child.y=e},enumerable:!0,configurable:!0}),e.prototype.setContentSize=function(e,t){this._child.setContentSize(e,t),this.lab.node.y=-t/2},e.prototype.moveByDx=function(e){this._child.x=this._child.x+e},e.prototype.moveByDy=function(e){this._child.y=this._child.y+e},Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(e){this._value=e,this.lab.string=""+e},enumerable:!0,configurable:!0}),e}();o.PickerCell=s;var l,u=function(e,t){return cc.v2((e.x+t.x)/2,(e.y+t.y)/2)},p=function(e,t){var o=t.x-e.x,n=t.y-e.y;return Math.sqrt(o*o+n*n)};(function(e){e[e.HORIZONTAL=0]="HORIZONTAL",e[e.VERTICAL=1]="VERTICAL"})(l=o.PickerDirection||(o.PickerDirection={}));var d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.content=null,t._virtualItemCount=5,t._pickerDirection=l.VERTICAL,t.isInvaildDisplay=!1,t.m_bIsScrolling=!1,t.m_bTouchMoved=!1,t.m_fTouchLength=0,t.scrollUniformSpeed=2.5,t.m_tScrollDistance=cc.v2(0,0),t.clickMoveDis=0,t.item_height=0,t.item_width=0,t._selectedItem=null,t.m_maxValue=100,t.m_minValue=0,t.show_value=0,t.displayRect=cc.rect(0,0,0,0),t.sortChildrenArray=[],t.m_pTouches=[],t.m_middleCellIndex=0,t.m_tTouchPoint=null,t.m_bDragging=!1,t.rollMode=0,t}return n(t,e),Object.defineProperty(t.prototype,"virtualItemCount",{get:function(){return this._virtualItemCount},set:function(e){e<3&&cc.error("virtualItemCount \u5fc5\u987b\u5927\u4e8e2"),e%2==0&&(e-=1),this._virtualItemCount=e,this.invalidateDisplayList()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"direction",{get:function(){return this._pickerDirection},set:function(e){this._pickerDirection=e,this.invalidateDisplayList()},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){this.content.anchorX=0,this.content.anchorY=0,this.displayRect.width=this.content.width,this.displayRect.height=this.content.height,this.displayRect.x=0,this.displayRect.y=0,this.content.on(cc.Node.EventType.TOUCH_START,this.onTouchBegan,this),this.content.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMoved,this),this.content.on(cc.Node.EventType.TOUCH_END,this.onTouchEnded,this),this.content.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnded,this),this.invalidateDisplayList()},t.prototype.setDataprovider=function(e,t,o){this.m_minValue=e,this.m_maxValue=t,this.show_value=o,this.invalidateDisplayList()},t.prototype.updateDisplayList=function(){this.rollMode=0,this._selectedItem=null,this.sortChildrenArray=[],this.content.removeAllChildren(),this.direction===l.HORIZONTAL?(this.item_height=this.content.height,this.item_width=this.content.width/this._virtualItemCount):(this.item_height=this.content.height/this._virtualItemCount,this.item_width=this.content.width);var e=this.virtualItemCount+2;this.m_middleCellIndex=Math.floor(e/2),(this.show_value<this.m_minValue||this.show_value>this.m_maxValue)&&(this.show_value=this.m_minValue);for(var t=this.show_value-1,o=this.show_value,n=this.m_middleCellIndex,i=this.item_height,r=this.item_width,a=0;a<e;a++){var c=new s(this.content);switch(c.setContentSize(this.item_width,this.item_height),c.direction=this.direction,this.direction){case l.VERTICAL:c.x=this.content.width/2,a<=n?(c.y=(n-a)*i,c.value=o,(o+=1)>this.m_maxValue&&(o=this.m_minValue)):(c.y=a*i,t<this.m_minValue&&(t=this.m_maxValue),c.value=t,t-=1);break;case l.HORIZONTAL:c.y=0,a<=n?(c.x=(n-a)*r,c.value=o,(o+=1)>this.m_maxValue&&(o=this.m_minValue)):(c.x=a*r,t<this.m_minValue&&(t=this.m_maxValue),c.value=t,t-=1)}0==a&&this.setCell(c),this.sortChildrenArray.push(c)}},t.prototype.containsTouchObject=function(e){for(var t=0,o=this.m_pTouches;t<o.length;t++){var n=o[t];if(n.getID()==n.getID())return!0}return!1},t.prototype.convertTouchToNodeSpace=function(e){return this.content.convertToNodeSpace(e.getLocation())},t.prototype.onTouchBegan=function(e){do{if(this.m_pTouches.length>2||this.m_bTouchMoved)break;var t=this.convertTouchToNodeSpace(e.touch);if(!this.displayRect.contains(t))break;if(this.rollMode=0,this.containsTouchObject(e.touch)||this.m_pTouches.push(e.touch),1==this.m_pTouches.length)this.m_tTouchPoint=t,this.m_bTouchMoved=!1,this.m_bDragging=!0,this.m_tScrollDistance.x=0,this.m_tScrollDistance.y=0,this.m_fTouchLength=0;else{var o=null;o=this.m_pTouches[0].getID()==e.touch.getID()?t:this.convertTouchToNodeSpace(this.m_pTouches[0]);var n=null;n=this.m_pTouches[1].getID()==e.touch.getID()?t:this.convertTouchToNodeSpace(this.m_pTouches[1]),this.m_tTouchPoint=u(o,n),this.m_fTouchLength=p(o,n),this.m_bDragging=!1}}while(0)},t.prototype.onTouchMoved=function(e){if(this.containsTouchObject(e.touch)&&this.m_bDragging&&1===this.m_pTouches.length){this.m_bTouchMoved=!0;var t=this.convertTouchToNodeSpace(this.m_pTouches[0]);this.m_tScrollDistance.x=t.x-this.m_tTouchPoint.x,this.m_tScrollDistance.y=t.y-this.m_tTouchPoint.y,this.m_tTouchPoint.set(t),this.displayRect.contains(t)&&this.moveAllCell(this.m_tScrollDistance)}},t.prototype.onTouchEnded=function(e){if(this.containsTouchObject(e.touch)){1===this.m_pTouches.length&&(this.m_bTouchMoved?this.rollMode=2|this.rollMode:this.setSelectedItem(this.itemForPoint(this.m_tTouchPoint)));for(var t=0;t<this.m_pTouches.length;t++)if(this.m_pTouches[t].getID()===e.touch.getID()){this.m_pTouches.splice(t,1);break}}0===this.m_pTouches.length&&(this.m_bDragging=!1,this.m_bTouchMoved=!1)},t.prototype.refreshValue=function(e){(e>this.m_maxValue||e<this.m_minValue)&&(e=this.m_minValue);for(var t=!1,o=0;o<this.sortChildrenArray.length;o++){var n=this.sortChildrenArray[o];if(n.value==e){this.setSelectedItem(n),t=!0;break}}t||(this.show_value=e,this.invalidateDisplayList())},t.prototype.setValue=function(e){(e>this.m_maxValue||e<this.m_minValue)&&(e=this.m_minValue);for(var t=!1,o=0;o<this.sortChildrenArray.length;o++){var n=this.sortChildrenArray[o];if(n.value==e){this.setSelectedItem(n),t=!0;break}}t||this.refreshValue(e)},t.prototype.setSelectedItem=function(e){if(e){switch(this.direction){case l.VERTICAL:this.clickMoveDis=-e.y+(1+Math.floor(this.virtualItemCount/2))*this.item_height;break;case l.HORIZONTAL:this.clickMoveDis=-e.x+(1+Math.floor(this.virtualItemCount/2))*this.item_width}this.clickMoveDis>0?this.scrollUniformSpeed=2:this.scrollUniformSpeed=-2,Math.abs(this.clickMoveDis)>1?this.rollMode=4|this.rollMode:this.setCell(e)}},t.prototype.setCell=function(e){this._selectedItem=e,this.m_bIsScrolling=!1},t.prototype.clickDeaccelerateScrolling=function(e){switch(this.direction){case l.VERTICAL:this.moveAllCell(cc.v2(0,this.scrollUniformSpeed));break;case l.HORIZONTAL:this.moveAllCell(cc.v2(this.scrollUniformSpeed,0))}var t=this.clickMoveDis;this.clickMoveDis=this.clickMoveDis-this.scrollUniformSpeed,t*this.clickMoveDis<=0&&(this.rollMode=-5&this.rollMode,this.relocateContainer(!0))},t.prototype.itemForPoint=function(e){for(var t=this.direction,o=0,n=this.sortChildrenArray;o<n.length;o++){var i=n[o];switch(t){case l.VERTICAL:if(i.y-this.item_height<=e.y&&i.y>=e.y)return i;break;case l.HORIZONTAL:if(i.x-this.item_width<=e.x&&i.x>=e.x)return i}}return null},t.prototype.deaccelerateScrolling=function(e){this.m_bDragging?this.rollMode=-3&this.rollMode:(this.m_tScrollDistance.x=.966*this.m_tScrollDistance.x,this.m_tScrollDistance.y=.966*this.m_tScrollDistance.y,this.moveAllCell(this.m_tScrollDistance),this.m_tScrollDistance.mag()<=1&&(this.m_tScrollDistance.x=0,this.m_tScrollDistance.y=0,this.rollMode=-3&this.rollMode,this.relocateContainer(!0)))},t.prototype.relocateContainer=function(e){switch(this.direction){case l.VERTICAL:var t=this.itemForPoint(cc.v2(0,this.content.height/2));this.setSelectedItem(t);break;case l.HORIZONTAL:t=this.itemForPoint(cc.v2(this.content.width/2,0));this.setSelectedItem(t)}},t.prototype.moveAllCell=function(e){var t=this.item_height,o=this.item_width,n=this.m_middleCellIndex,i=this.sortChildrenArray;switch(this.direction){case l.VERTICAL:for(var r=0,a=i;r<a.length;r++){if((p=a[r]).moveByDy(e.y),p.y<-t&&(p.y=(this.virtualItemCount+2)*t+p.y),p.y>(this.virtualItemCount+1)*t){var c=p.y-(this.virtualItemCount+1)*t;p.y=-t+c}}i.sort(function(e,t){return e.y>t.y?-1:1});break;case l.HORIZONTAL:for(var s=0,u=i;s<u.length;s++){var p;if((p=u[s]).moveByDx(e.x),p.x<-o&&(p.x=(this.virtualItemCount+2)*o+p.x),p.x>(this.virtualItemCount+1)*o){var d=p.x-(this.virtualItemCount+1)*this.item_width;p.x=-o+d}}i.sort(function(e,t){return e.x>t.x?1:-1})}for(var h=this.m_maxValue,f=this.m_minValue,g=1;g<=n;g++)i[n+g-1].value==h?i[n+g].value=f:i[n+g].value=i[n+g-1].value+1,i[n-g+1].value==f?i[n-g].value=h:i[n-g].value=i[n-g+1].value-1},t.prototype.invalidateDisplayList=function(){this.isInvaildDisplay=!0},t.prototype.update=function(e){if(this.isInvaildDisplay)this.updateDisplayList(),this.isInvaildDisplay=!1;else{if(2&this.rollMode)return void this.deaccelerateScrolling(e);if(4&this.rollMode)return void this.clickDeaccelerateScrolling(e)}},i([c(cc.Node)],t.prototype,"content",void 0),i([c(cc.Integer)],t.prototype,"_virtualItemCount",void 0),i([c],t.prototype,"virtualItemCount",null),t=i([a],t)}(cc.Component);o.UINumberPicker=d,cc._RF.pop()},{}],UiClickAudio:[function(e,t,o){"use strict";cc._RF.push(t,"5940f/kpSlDiKTSMZn9MwUT","UiClickAudio");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../../core/Engine"),a=e("../../../core/event/MessageManager"),c=e("../../../core/ui/ComponentExtends"),s=e("../../AudioMessage"),l=cc._decorator,u=l.ccclass,p=l.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.string="",t}return n(t,e),t.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_END,this.click.bind(this),this)},t.prototype.click=function(){this.string&&a.Message.dispatchEvent(s.AudioMessage.EFFECT,this.string),r.default.log.info("\u97f3\u6548\u70b9\u51fb\u7a7f\u900f"),this.node._touchListener&&this.node._touchListener.setSwallowTouches(!1)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},i([p],t.prototype,"string",void 0),t=i([u],t)}(c.ComponentExtends);o.default=d,cc._RF.pop()},{"../../../core/Engine":"Engine","../../../core/event/MessageManager":"MessageManager","../../../core/ui/ComponentExtends":"ComponentExtends","../../AudioMessage":"AudioMessage"}],UrlParse:[function(e,t,o){"use strict";cc._RF.push(t,"9f0d1f+86JOL5k6VzMxXNqd","UrlParse"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(e){if(void 0===e&&(e="WH"),this._data=null,!cc.sys.isBrowser)return cc.warn("UrlParse unsupported!"),void(this._data={});var t=null;t=location&&"undefined"!=typeof VVJJQ3J5cHRv&&VVJJQ3J5cHRv?VVJJQ3J5cHRv.d(location.search,e)||{}:this.parseUrl().params,this._data=t}return Object.defineProperty(e.prototype,"query",{get:function(){return this._data},enumerable:!0,configurable:!0}),e.prototype.parseUrl=function(){var t={scheme:"",params:{}};if("object"!=typeof window)return t;if(!window.document)return t;var o=window.document.location.href.toString();return e.parseURL(o)},e.parseURL=function(e){var t={scheme:"",params:{}},o=(e=decodeURI(e)).split(/[:/\?]+/);if(t.scheme=o[0].split(":")[0],"string"==typeof o[1]){for(var n={},i=0,r=(o=o[1].split("&")).length;i<r;++i){var a=o[i].split("=");n[a[0]]=a[1]}t.params=n}return t},e}();o.UrlParse=n,cc._RF.pop()},{}],ValueExtends:[function(e,t,o){"use strict";cc._RF.push(t,"b0029NN5XpF15o3KhMm2/Lh","ValueExtends"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(e){for(var t=[],o=e;o.length>=3;)t.unshift(o.substr(-3)),o=o.substr(0,o.length-3);return o.length>0&&t.unshift(o),t.join(",")},i=function(e,t){if(e.length<t){for(var o=t-e.length;o>0;)e+="0",--o;return e}return e.substr(0,t)},r=function(){function e(){this.currencySymbol="",this._currency="CNY"}return Object.defineProperty(e.prototype,"currency",{set:function(e){this._currency=e},enumerable:!0,configurable:!0}),e.prototype.numberToBoolen=function(e){return 0!=e},e.prototype.convertIntegerToString=function(e){return n(e+"")},e.prototype.toCurrencyNumber=function(e){var t="";e<0&&(t="-",e=Math.abs(e));var o=e.toFixed(4).split("."),n=o[0]||"0",r=o[1]||"0";switch(this._currency||"CNY"){case"AUD":case"BRL":case"GBP":case"BTC":case"SGD":case"USD":case"EUR":case"MYR":r=i(r,3);break;case"ESB":return Number(t+e);default:r=i(r,2)}return Number(t+n+"."+r)},e.prototype.toCurrencyFormat=function(e,t,o){void 0===t&&(t=!0);var r="";e<0&&(r="-",e=Math.abs(e));var a=e.toFixed(4).split("."),c=a[0]||"0",s=a[1]||"0";switch(this._currency||"CNY"){case"AUD":case"BRL":case"GBP":case"BTC":case"SGD":case"USD":case"EUR":case"MYR":s=i(s,o||3);break;case"ESB":return r+this.currencySymbol+n(c);default:s=i(s,o||3)}for(var l=s.split(""),u=l.length-1;u>=0&&"0"==l[u];u--)l.splice(u,1);s=l.join("");return 0==o?r+this.currencySymbol+e:t?r+this.currencySymbol+n(c)+"."+s:r+this.currencySymbol+c+"."+s},e.prototype.toIntFormat=function(e,t){void 0===t&&(t=!0);e<0&&("-",e=Math.abs(e));var o=e.toFixed(4).split(".")[0]||"0";return t?n(o):o},e}();o.ValueExtends=r,cc._RF.pop()},{}],ViewAssetsLoader:[function(e,t,o){"use strict";cc._RF.push(t,"434c3jiFg9IwKaM1hdy+XtH","ViewAssetsLoader");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../Engine"),a=e("../ComponentExtends"),c=e("../../net/Network"),s=cc._decorator,l=s.ccclass,u=s.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.url="",t._loadCount=3,t._state=0,t._loadCallback=null,t}return n(t,e),t.prototype.start=function(){this.on(c.NetworkEvent.CHANGE,this.netchangeHandler,this)},t.prototype.onEnable=function(){this.url&&this.setUrl(this.url,this._loadCallback)},t.prototype.setCompleteListener=function(e){2==this._state?e(null,this):this._loadCallback=e},t.prototype.loadCompleted=function(e,t){var o=this.url,n=this._loadCallback;if(e)return cc.warn("ViewAssetsLoader \u4e0b\u8f7d\u9519\u8bef",o,e),this._state=0,void(this._loadCount<=0?n&&n(e,this):r.default.network.state===c.NetworkState.ONLINE&&(this.setUrl(o,n),this._loadCount--));if(this._state=2,this.node){var i=this.node.getComponent(cc.Sprite);if(i)i.spriteFrame=t;else{var a=this.node.getComponent(sp.Skeleton);a&&(a.skeletonData=t)}n&&n(null,this),this._loadCallback=null}},t.prototype.setUrl=function(e,t){if(void 0===t&&(t=null),e){if(1!==this._state)if(this.url=e,this._loadCallback=t,this._state=0,r.default.network.state!==c.NetworkState.OFFLINE){var o=cc.SpriteFrame;if(!this.node.getComponent(cc.Sprite))this.node.getComponent(sp.Skeleton)?o=sp.SkeletonData:cc.warn("ViewAssetsLoader \u65e0\u6cd5\u7ed9\u5f53\u524d\u7ec4\u4ef6\u4e0b\u8f7d\u8d44\u6e90");var n=cc.loader.getRes(e,o);if(n)this.loadCompleted(null,n);else{this._state=1;var i=cc.loader.getRes(e,o);i?this.loadCompleted(null,i):(cc.log("[ViewAssetsLoader] \u5f00\u59cb\u4e0b\u8f7d\u8d44\u6e90 "+e),cc.loader.loadRes(e,o,this.loadCompleted.bind(this)))}}else cc.log("[ViewAssetsLoader] \u65ad\u7f51\u73af\u5883\uff0c\u4e0d\u4e0b\u8f7d")}else t&&t(new Error("url \u4e0d\u80fd\u4e3a\u7a7a"),this)},t.prototype.netchangeHandler=function(){0==this._state&&r.default.network.state===c.NetworkState.ONLINE&&this.url&&this.setUrl(this.url,this._loadCallback)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this),this._loadCallback=null},i([u(cc.String)],t.prototype,"url",void 0),t=i([l],t)}(a.ComponentExtends);o.ViewAssetsLoader=p,cc._RF.pop()},{"../../Engine":"Engine","../../net/Network":"Network","../ComponentExtends":"ComponentExtends"}],ViewLayout:[function(e,t,o){"use strict";cc._RF.push(t,"b64adV9iWZMRKfWoci0/ZXu","ViewLayout");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("./ComponentExtends"),a=e("../EngineMessage"),c=e("../Engine"),s=cc._decorator.ccclass,l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.onLoad=function(){this.on(a.EngineMessage.GAME_RESIZE,this.evtHandler,this),this._layout()},t.prototype.evtHandler=function(e){switch(e){case a.EngineMessage.GAME_RESIZE:this._layout()}},t.prototype._layout=function(){this.node.setContentSize(c.default.designWidth,c.default.designHeight)},t=i([s],t)}(r.ComponentExtends);o.ViewLayout=l,cc._RF.pop()},{"../Engine":"Engine","../EngineMessage":"EngineMessage","./ComponentExtends":"ComponentExtends"}],ViewMenu:[function(e,t,o){"use strict";cc._RF.push(t,"2fc0ct3mP1HIrNpyZJgruXO","ViewMenu");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../core/gui/GUI"),a=e("../../core/ui/ComponentExtends"),c=e("../../core/ui/ViewUtils"),s=e("../../service/Service"),l=cc._decorator,u=l.ccclass,p=(l.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.mainControl=null,t}return n(t,e),t.prototype.onLoad=function(){s.service.analytics.logEvent("menu_click_open","",""),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchHandler,this)},t.prototype.onAdded=function(e){this.mainControl=e.mainControl;c.ViewUtils.nodeTreeInfoLite(this.node)},t.prototype.onTouchHandler=function(e){switch(e.target.name){case"btn_ranking":case"btn_gift":case"btn_setting":this.mainControl.openMainPop(e.target.name),this.node.destroy();break;default:r.gui.delete(this.node)}},t.prototype.onDestroy=function(){this.mainControl=null,e.prototype.onDestroy.call(this)},t=i([u],t)}(a.ComponentExtends));o.default=p,cc._RF.pop()},{"../../core/gui/GUI":"GUI","../../core/ui/ComponentExtends":"ComponentExtends","../../core/ui/ViewUtils":"ViewUtils","../../service/Service":"Service"}],ViewSpineLoader:[function(e,t,o){"use strict";cc._RF.push(t,"95140wvETtA/7qmu4WJKCep","ViewSpineLoader");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("./ViewAssetsLoader"),a=cc._decorator,c=a.ccclass,s=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.loop=!1,t.animation="",t}return n(t,e),t.prototype.onLoad=function(){var e=this;this.url&&this.setUrl(this.url,function(t,o){if(!t){var n=e.node.getComponent(sp.Skeleton);n&&e.animation&&n.setAnimation(0,e.animation,e.loop)}})},i([s(cc.Boolean)],t.prototype,"loop",void 0),i([s(cc.String)],t.prototype,"animation",void 0),t=i([c],t)}(r.ViewAssetsLoader);o.ViewSpineLoader=l,cc._RF.pop()},{"./ViewAssetsLoader":"ViewAssetsLoader"}],ViewTerms:[function(e,t,o){"use strict";cc._RF.push(t,"af933oqHsdG/oHlfcs12tKh","ViewTerms");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../core/ui/ComponentExtends"),a=e("../../core/gui/GUI"),c=cc._decorator,s=c.ccclass,l=(c.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchHandler,this)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchHandler,this)},t.prototype.onTouchHandler=function(e){switch(e.target.name){case"btn_close":this.close()}},t.prototype.close=function(){a.gui.delete(this.node)},t=i([s],t)}(r.ComponentExtends));o.default=l,cc._RF.pop()},{"../../core/gui/GUI":"GUI","../../core/ui/ComponentExtends":"ComponentExtends"}],ViewUtils:[function(e,t,o){"use strict";cc._RF.push(t,"74b364GUzZIi5cn9Kk6k00O","ViewUtils"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../util/HashMap"),i=function(){function e(){}return e.nodeTreeInfoLite=function(t,o,i){var r=i;if(isNaN(r)&&(r=99),!(r<1)){--r;for(var a=o||new n.HashMap,c=t.children,s=0;s<c.length;s++){var l=c[s];l.name.indexOf(" ")<0&&a.set(l.name,l),e.nodeTreeInfoLite(c[s],a,r)}return a}},e.fullscreen=function(e){var t=cc.winSize.width/cc.winSize.height,o=e.width/e.height;if(t<o){var n=cc.winSize.height/e.height;e.scale=n}else if(t>o){n=cc.winSize.width/e.width;e.scale=n}},e.fullYScreen=function(e){var t=cc.view.getDesignResolutionSize(),o=cc.winSize.height/t.height;e.scaleY=Math.ceil(o)},e.setNodeAllColor=function(e,t,o){var n=this;if(void 0===t&&(t=cc.color(255,255,255)),void 0===o&&(o=255),cc.isValid(e)){e.color=t,e.opacity=o;var i=e.children;0!==i.length&&i.forEach(function(e){n.setNodeAllColor(e,t,o)})}},e.setFormatTime=function(e,t,o){var n=[];return[e,t,o].forEach(function(e){var t="";t+=e>=10?e:e>=1?"0"+e:"00",n.push(t)}),n.join(":")},e.updateUserAvatar=function(e,t,o,n){if(void 0===n&&(n=cc.size(59,59)),e){t||cc.warn("\u5f53\u524d\u767b\u5f55\u5e73\u53f0\u4e3a\u7a7a\uff0c\u5c06\u9ed8\u8ba4\u52a0\u8f7d\u5934\u50cf\u4e3ajpg\u683c\u5f0f");var i="";switch(t){case"visitor":case"facebook":case"google":i="jpg";break;default:i="jpg"}cc.loader.load({url:e,type:i},function(e,t){if(cc.log("data = ",t),e)cc.warn("\u5934\u50cf\u52a0\u8f7d\u5931\u8d25");else{var i=new cc.SpriteFrame(t);o.getComponent(cc.Sprite).spriteFrame=i,o.setContentSize(n)}})}else cc.warn("\u5934\u50cf\u5730\u5740\u4e0d\u80fd\u4e3a\u7a7a")},e.convertIntegerToString=function(e){for(var t=[],o=e;o.length>3;)t.unshift(o.substr(-3)),o=o.substr(0,o.length-3);return o.length>0&&t.unshift(o),t.join(",")},e.convertToRelativePosition=function(e,t){if(!e||!t||!e.parent)throw new Error("viewUtils.convertToRelativePosition  param error");var o=e.parent.convertToWorldSpaceAR(e.getPosition());return o=t.convertToNodeSpaceAR(o),cc.v2(o)},e.findNodes=function(t,o,n){for(var i=n||[],r=o.children,a=0;a<r.length;a++){var c=r[a].name;t.test(c)&&i.push(r[a]),e.findNodes(t,r[a],i)}return i},e}();o.ViewUtils=i,cc._RF.pop()},{"../util/HashMap":"HashMap"}],WorldMapComponent:[function(e,t,o){"use strict";cc._RF.push(t,"d3751XPBZVC/JHwRTZd4Ozn","WorldMapComponent");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../core/gui/GUI"),a=e("../../core/ui/button/ButtonEffect"),c=e("../../core/ui/button/ButtonSimple"),s=e("../../core/ui/ComponentExtends"),l=e("../../core/ui/label/LabelChangeSymbol"),u=e("../../core/ui/ViewUtils"),p=e("../../Main"),d=e("../../service/Service"),h=e("../CalcUiShow"),f=e("./effect/ActionYSet"),g=e("./ListItemFrame"),m=cc._decorator,v=m.ccclass,_=m.property,y=[2160,1600],b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.map=null,t.currentMapId=1,t.nodes=null,t.currentMapLevel=1,t}return n(t,e),t.prototype.onLoad=function(){this.nodes=u.ViewUtils.nodeTreeInfoLite(this.node),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchHandler,this);var e=cc.sys.getSafeAreaRect();e.width=e.width||cc.winSize.width,e.height=e.height||cc.winSize.height,this.node.getChildByName("scollview").width=cc.winSize.width,this.node.getChildByName("scollview").height=cc.winSize.height;var t=this.node.getChildByName("btn_close").getComponent(cc.Widget);t&&(t.top=cc.winSize.height-e.height+15-cc.winSize.height/2,t.right=-cc.winSize.width/2+10,t.updateAlignment()),this.setInfo()},t.prototype.setInfo=function(){var e=p.default.module.calcUiShow.oneFameAdd();this.nodes.get("bonus_lab").getComponent(l.LabelChangeSymbol).string=Math.floor(100*e)+"%";var t=p.default.module.calcUiShow.rewardAdd();if(p.default.module.calcTool.compare({num:1,numE:3},t)){var o=t.num*Math.pow(10,t.numE),n=Math.floor(100*o);this.nodes.get("total_lab").getComponent(l.LabelChangeSymbol).string=n+"%"}else this.nodes.get("total_lab").getComponent(l.LabelChangeSymbol).num=p.default.module.calcUiShow.rewardAdd();this.nodes.get("current_lab").getComponent(l.LabelChangeSymbol).num=p.default.module.vm.fame;var i=p.default.module.calcUiShow.calcCurrentCanGetFame();this.nodes.get("will_lab").getComponent(l.LabelChangeSymbol).num=i},t.prototype.countryCenter=function(){this.nodes.get("content").setPosition(this.calcPos(1))},t.prototype.calcPos=function(e){e||(e=this.currentMapLevel);var t=this.nodes.get("country_"+e),o=t.parent.convertToWorldSpaceAR(t.getPosition()),n=cc.winSize.width/2,i=cc.winSize.height/2,r=o.x-n,a=o.y-i,c=this.nodes.get("content").x-r,s=this.nodes.get("content").y-a,l=cc.winSize.width,u=cc.winSize.height,p=-(this.nodes.get("content").width-l)/2,d=-(this.nodes.get("content").height-u)/2,h=(this.nodes.get("content").width-l)/2,f=(this.nodes.get("content").height-u)/2;return c<p&&(c=p),c>h&&(c=h),s<d&&(s=d),s>f&&(s=f),cc.v2(c,s)},t.prototype.countryCenterAnim=function(e){var t=this,o=ezaction.HCustomEase.create("ce3","M0,0 C0.084,0.61 0.214,0.802 0.28,0.856 0.356,0.918 0.374,1 1,1 "),n=ezaction.ease.customEase(o);r.gui.popup.clear(),this.nodes.get("scollview").getComponent(cc.ScrollView).enabled=!1,this.nodes.get("content").RunAction(ezaction.moveTo(2,{x:this.calcPos().x,y:this.calcPos().y}).easing(n)).onStoped(function(){var o=t.nodes.get("country_"+p.default.module.vm.level),n=o.parent.convertToWorldSpaceAR(o.getPosition()),i=t.nodes.get("content").convertToNodeSpaceAR(n);t.nodes.get("tip").StopAllActions(),t.nodes.get("tip").getComponent(f.default).initY=i.y+o.height/2+35,t.nodes.get("tip").x=i.x,t.nodes.get("content").RunAction(ezaction.scaleTo(2,{scale:1.5})).onUpdate(function(){t.nodes.get("content").width=y[0]*t.nodes.get("content").scale,t.nodes.get("content").height=y[1]*t.nodes.get("content").scale,t.nodes.get("content").setPosition(t.calcPos().x,t.calcPos().y)}).onStoped(function(){t.nodes.get("content").RunAction(ezaction.fadeTo(.5,0)).onStoped(function(){e&&e(),r.gui.delete(t.node),r.gui.popup.clear()})})})},t.prototype.onAdded=function(e){this.countryCenter();var t=p.default.module.vm.level;this.currentMapLevel=t,this.refreshCityByMaxId();var o=this.nodes.get("country_"+t);this.nodes.get("btn_pass").setPosition(o.x,o.y-o.height/2-35);var n=o.parent.convertToWorldSpaceAR(o.getPosition()),i=this.nodes.get("content").convertToNodeSpaceAR(n);this.nodes.get("pass_skeleton").setPosition(i.x,i.y),this.nodes.get("pass_particle").setPosition(i.x,i.y),this.nodes.get("tip").getComponent(f.default).initY=i.y+o.height/2+35,this.nodes.get("tip").x=i.x,this.loadPopMapInfo(),this.initProgressRoadBtnPass()},t.prototype.initProgressRoadBtnPass=function(){var e=this.currentMapLevel;this.nodes.get("road").children.forEach(function(t){t.active=t.name=="road"+(e-1)});var t=this.nodes.get("country_"+e);this.nodes.get("btn_pass").setPosition(t.x,t.y-t.height/2-35)},t.prototype.moveMap=function(e){void 0===e&&(e=1);var t=this.nodes.get("content");switch(e){case 0:t.x=720;break;case 1:t.x=0;break;case 2:t.x=-720}},t.prototype.refreshCityByMaxId=function(){for(var e=this.nodes,t=1;t<11;t++)e.get("country_"+t).addComponent(c.default),t<=this.currentMapLevel?this.refreshCountryState(e.get("country_"+t),!0):this.refreshCountryState(e.get("country_"+t),!1)},t.prototype.refreshCountryState=function(e,t){e.getChildByName("country_name").active=t;var o=t?cc.Color.WHITE:cc.Color.GRAY,n=e.getComponent(a.default);n&&(n.canTouch=t),e.color=o;var i=parseInt(e.name.split("_")[1]),r=0;i==p.default.module.vm.level?r=1:i>p.default.module.vm.level&&(r=2),e.getChildByName("point_"+i).getComponent(g.default).setFrame(r)},t.prototype.loadPopMapInfo=function(e){var t=this;if(e||(e=p.default.module.vm.level),1!=e){r.gui.popup.clear();var o=this.nodes.get("country_"+e),n=o.parent.convertToWorldSpaceAR(o.getPosition());r.gui.popup.add("world/city_explain",{cityId:e,worldPos:n,callback:function(){t.node.destroy()}},{modal:!1,opacity:126,touchClose:!0,onAdded:function(e,t){},onRemoved:function(){}})}},t.prototype.onTouchHandler=function(e){var t=e.target.name.split("_")[0],o=e.target,n=(o.parent.convertToWorldSpaceAR(o.getPosition()),parseInt(e.target.name.split("_")[1]));if("country"!=t||"name"==e.target.name.split("_")[1])if("point"==t&&e.target.getComponent(a.default)&&e.target.getComponent(a.default).canTouch)this.loadPopMapInfo(n);else switch(e.target.name){case"btn_close":r.gui.delete(this.node);break;case"btn_pass":if(!e.target.getComponent(a.default).canTouch)return;this.btnPassHandler(function(){cc.log("\u5356\u697c\u6210\u529f")},null),d.service.analytics.logEvent("fame_click_restart","","")}else this.loadPopMapInfo(n)},t.prototype.btnPassHandler=function(e,t){var o=this,n=function(){p.default.module.vm.sellNum+=1,cc.sys.localStorage.setItem("sellNum",p.default.module.vm.sellNum);var n=o.getSellList(0);p.default.module.vm.storeList=o.getSellList(0),p.default.module.gameProtocol.sendStoreList(n,function(){cc.log("\u6e05\u7a7a\u5e97\u94fa\u7b49\u7ea7\u6210\u529f")});var i=o.getSellList(1);p.default.module.vm.clerkList=i,p.default.module.gameProtocol.sendClerkList(i,function(){cc.log("\u6e05\u7a7a\u5e97\u5458\u7b49\u7ea7\u6210\u529f")});var r=o.getSellList(2);p.default.module.vm.fameList=r,p.default.module.gameProtocol.sendFameList(r,function(){cc.log("\u6e05\u7a7a\u58f0\u671b\u7b49\u7ea7\u6210\u529f")}),p.default.module.calcUiShow.sellStores(function(){p.default.module.vm.isPass=0,cc.sys.localStorage.setItem("isPass",0),e&&e();var n=p.default.module.calcUiShow.changeTaskListByTypeCount(h.TaskType.SELL_STORES,1);p.default.module.gameProtocol.sendTaskList(n,function(e){p.default.module.vm.taskList=n});o.currentMapLevel=p.default.module.vm.level+1,o.initProgressRoadBtnPass(),o.refreshCityByMaxId(),o.countryCenterAnim(function(){p.default.module.vm.level+=1,t&&t()})})};p.default.module.mainScene.mapControl.initNode(),r.gui.popup.add("popup/sellstores_result",{callback:function(){n&&n()}},{touchClose:!1})},t.prototype.getSellList=function(e){var t=null;switch(e){case 0:t=p.default.module.vm.storeList;break;case 1:t=p.default.module.vm.clerkList;break;case 2:t=p.default.module.vm.fameList}var o={};for(var n in t)o[n]={id:t[n].id,level:0};return o},t.prototype.update=function(e){this.refreshBtnState(this.nodes.get("btn_pass"),1==p.default.module.vm.isPass),this.nodes.get("pass_skeleton").active=1==p.default.module.vm.isPass,this.nodes.get("pass_particle").active=1==p.default.module.vm.isPass},t.prototype.refreshBtnState=function(e,t){var o=t?cc.Color.WHITE:cc.Color.GRAY,n=e.getComponent(a.default);n&&(n.canTouch=t),e.color=o;for(var i=0,r=e.children;i<r.length;i++){r[i].color=o}},t.prototype.onDestroy=function(){this.map=null,this.currentMapId=null,this.node.off(cc.Node.EventType.TOUCH_END,this.onTouchHandler,this),this.nodes.clear(),this.nodes=null,e.prototype.onDestroy.call(this)},i([_(cc.Sprite)],t.prototype,"map",void 0),t=i([v],t)}(s.ComponentExtends);o.default=b,cc._RF.pop()},{"../../Main":"Main","../../core/gui/GUI":"GUI","../../core/ui/ComponentExtends":"ComponentExtends","../../core/ui/ViewUtils":"ViewUtils","../../core/ui/button/ButtonEffect":"ButtonEffect","../../core/ui/button/ButtonSimple":"ButtonSimple","../../core/ui/label/LabelChangeSymbol":"LabelChangeSymbol","../../service/Service":"Service","../CalcUiShow":"CalcUiShow","./ListItemFrame":"ListItemFrame","./effect/ActionYSet":"ActionYSet"}],ezaction:[function(e,t,o){"use strict";function n(e){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}cc._RF.push(t,"e6c0d+72OJLFbE8u9uuuyvs","ezaction");var i=i||{};t.exports=i,window&&"object"===("undefined"==typeof window?"undefined":n(window))&&(window.ezaction=i),i.State={INITIAL:0,RUNNING:1,PAUSED:2,STOPPED:3,DEAD:4},i.HVars=e("HVars"),i.ease=e("HEaseDefine"),i.HAction=e("HAction"),i.HActionInstant=e("HActionInstant"),i.HActionInterval=e("HActionInterval"),i.HActionTween=e("HActionTween"),i.HActionTweenBy=e("HActionTweenBy"),i.HActionSpawn=e("HActionSpawn"),i.HActionSequence=e("HActionSequence"),i.HActionJumpBy=e("HActionJump").jumpBy,i.HActionJumpTo=e("HActionJump").jumpTo,i.HCustomEase=e("HCustomEase"),i.HActionBezierBy=e("HActionBezier").bezierBy,i.HActionBezierTo=e("HActionBezier").bezierTo;var r=function(e){var t={};for(var o in e){var n=e[o];"number"==typeof n&&(t[o]=n)}return t};i.v2=function(e,t){return"number"==typeof e?{x:e,y:t}:{x:e.x,y:e.y}},i.callFuncWithParam=function(e){for(var t=arguments.length,o=new Array(t>1?t-1:0),n=1;n<t;n++)o[n-1]=arguments[n];var r={onComplete:function(){e.apply(void 0,o)}};return i.HActionInstant.create(r)},i.callFunc=function(e,t,o){return(o=o||{}).onComplete=function(){e(t)},i.HActionInstant.create(o)},i.delay=function(e,t){return i.HActionInterval.create(e,t)},i.delayTime=i.delay,i.sequence=function(e,t){return i.HActionSequence.create(e,t)},i.spawn=function(e,t){return i.HActionSpawn.create(e,t)},i.tween=function(e,t,o){t=r(t);var n=o;if(n)for(var a in t)n[a]=t[a];else n=t||{};return i.HActionTween.create(e,n)},i.tweenBy=function(e,t,o){t=r(t);var n=o;if(n)for(var a in t)n[a]=t[a];else n=t||{};return i.HActionTweenBy.create(e,n)},i.moveTo=i.tween,i.moveBy=i.tweenBy,i.scaleTo=i.tween,i.scaleBy=i.tweenBy,i.skewTo=i.tween,i.skewBy=i.tweenBy,i.rotateBy=function(e,t,o){var n=null;return"number"==typeof t?((n={}).rotationX=t,n.rotationY=t):n=t,i.tweenBy(e,n,o)},i.rotateTo=function(e,t,o){var n=null;return"number"==typeof t?((n={}).rotationX=t,n.rotationY=t):n=t,i.tween(e,n,o)},i.fadeTo=function(e,t,o){var n={};return n.opacity=t,i.tween(e,n,o)},i.fadeIn=function(e,t){return i.fadeTo(e,255,t)},i.fadeOut=function(e,t){return i.fadeTo(e,0,t)},i.show=function(e){e=e||{};var t=new i.HActionInstant;return e.onComplete=function(e){e.getNode()._sgNode.setVisible(!0)},t.init(e),t},i.hide=function(e){e=e||{};var t=new i.HActionInstant;return e.onComplete=function(e){e.getNode()._sgNode.setVisible(!1)},t.init(e),t},i.jumpBy=function(e,t,o,n,r){var a=new i.HActionJumpBy;return a.init(e,t,o,n,r),a},i.jumpTo=function(e,t,o,n,r){var a=new i.HActionJumpTo;return a.init(e,t,o,n,r),a},i.bezierTo=function(e,t,o){var n=new i.HActionBezierTo;return n.init(e,t,o),n},i.bezierBy=function(e,t,o){var n=new i.HActionBezierBy;return n.init(e,t,o),n},cc._RF.pop()},{HAction:"HAction",HActionBezier:"HActionBezier",HActionInstant:"HActionInstant",HActionInterval:"HActionInterval",HActionJump:"HActionJump",HActionSequence:"HActionSequence",HActionSpawn:"HActionSpawn",HActionTween:"HActionTween",HActionTweenBy:"HActionTweenBy",HCustomEase:"HCustomEase",HEaseDefine:"HEaseDefine",HVars:"HVars"}],ezdefine:[function(e,t,o){"use strict";cc._RF.push(t,"7da8b4IpRhMa7Q0rd0WbZGo","ezdefine"),Object.defineProperty(o,"__esModule",{value:!0}),o.PluginCoreJAVAPATH="com/ezplugin/core/PluginCore",o.PluginCoreIOSPATH="PluginCore",o.PluginCoreWebPATH="WebPluginCore",cc._RF.pop()},{}],ezplugin:[function(e,t,o){"use strict";cc._RF.push(t,"8816fO4bl1AionPQueKOMj9","ezplugin"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./ezdefine"),i=e("./PluginBridgeCore"),r=e("./PluginEntity"),a=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];cc.log.apply(cc,["PluginBridgeCore"].concat(e))},c=function(){var e=cc.sys.localStorage.getItem("__uuid_");return e||(e=(e=cc.sys.os+cc.sys.platform+"_"+function(e,t){var o,n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),i=[];if(t=t||n.length,e)for(o=0;o<e;o++)i[o]=n[0|Math.random()*t];else{var r=void 0;for(i[8]=i[13]=i[18]=i[23]="-",i[14]="4",o=0;o<36;o++)i[o]||(r=0|16*Math.random(),i[o]=n[19==o?3&r|8:r])}return i.join("")}(13,16)).replace(/[\s]+/,""),cc.sys.localStorage.setItem("__uuid_",e)),e};function s(e,t){var o,n,i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),r=[];if(t=t||i.length,e)for(o=0;o<e;o++)r[o]=i[0|Math.random()*t];else for(r[8]=r[13]=r[18]=r[23]="-",r[14]="4",o=0;o<36;o++)r[o]||(n=0|16*Math.random(),r[o]=i[19==o?3&n|8:n]);return r.join("")}var l=function(){function e(){this.core=null,this._sysInfo=null,this._plugins={},this._initCallbacks=[];try{if(cc.sys.isNative?cc.sys.OS_ANDROID===cc.sys.os?this.core=new i.PluginBridgeCore(n.PluginCoreJAVAPATH):cc.sys.OS_IOS===cc.sys.os&&(this.core=new i.PluginBridgeCore(n.PluginCoreIOSPATH)):cc.sys.isBrowser,this.core){var e=this.core.sysInfo();e&&(this._sysInfo=JSON.parse(e)),a("Ezplugin_sysInfo",e)}}catch(e){a(e)}if(!this._sysInfo){var t=c();this._sysInfo={uuid:t},cc.sys.isBrowser&&(this._sysInfo.browser=cc.sys.browserType+cc.sys.browserVersion)}if(!this._sysInfo.username){var o=cc.sys.localStorage.getItem("visitor_username");o||(o=s(8,16),cc.sys.localStorage.setItem("visitor_username",o)),this._sysInfo.username=o}}return Object.defineProperty(e.prototype,"sysInfo",{get:function(){return this._sysInfo},enumerable:!0,configurable:!0}),e.prototype.registerInitedCallback=function(e){this._initCallbacks?this._initCallbacks.push(e):e(this)},e.prototype.initPlugins=function(e,t){var o=this;e.forEach(function(e){e.params||(e.params={})}),this.core.initAllPlugins(e,function(n,i){if(n)a("initAllPlugins \u521d\u59cb\u5316\u63d2\u4ef6\u9519\u8bef",n.toString());else{for(var r=0,c=i.split("&");r<c.length;r++){var s=c[r];if(s){for(var l=null,u=0,p=e;u<p.length;u++){var d=p[u];if(d.pluginName===s){l=d;break}}l||(l={pluginName:s,params:{}}),o._createPlugin(l)}}t(o);for(var h=0,f=o._initCallbacks;h<f.length;h++){(0,f[h])(o)}o._initCallbacks=null}})},e.prototype.initPlugin=function(e,t){var o=this;e.params||(e.params={}),this.core.initPlugin(e,function(n,i){n?a("\u521d\u59cb\u5316\u53d1\u751f\u9519\u8bef",n.toString()):t(o._createPlugin(e))})},e.prototype.get=function(e){return this._plugins[e]||null},e.prototype._createPlugin=function(e){var t=new r.PluginEntity(e,this.core);return this._plugins[e.pluginName]=t,t},e.prototype.nativeEventHandler=function(e,t,o){this.core.nativeEventHandler(e,t,o)},e.prototype.nativeCallbackHandler=function(e,t){this.core.nativeCallbackHandler(e,t)},e.prototype.nativeCallbackErrorHandler=function(e,t){this.core.nativeCallbackErrorHandler(e,t)},e}();o.Ezplugin=l,o.ezplugin=new l,window&&"object"==typeof window&&(window.ezplugin=o.ezplugin),cc._RF.pop()},{"./PluginBridgeCore":"PluginBridgeCore","./PluginEntity":"PluginEntity","./ezdefine":"ezdefine"}],mathEx:[function(e,t,o){"use strict";cc._RF.push(t,"eef25Dq5btGGIEwqsJZu9E2","mathEx"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(){}return e.getVec2Angle=function(e){if(0===e.x&&0===e.y)return 0;if(0==e.x)return e.y>0?Math.PI/2:3*Math.PI/2;if(0===e.y)return e.x>0?0:Math.PI;var t=e.mag(),o=Math.acos(Math.abs(e.x)/t);return e.x>0?e.y>0?o:2*Math.PI-o:e.x<0?e.y>0?Math.PI-o:Math.PI+o:void 0},e}();o.default=n,cc._RF.pop()},{}],"pomelo-client":[function(e,t,o){"use strict";cc._RF.push(t,"8e17bJnCVxBJb5wf/dIuTOQ","pomelo-client");var n=function(e){this.url=e,this.readyState=0,jsb.reflection.callStaticMethod("sockets/WebSocketClient","createWS","(Ljava/lang/String;)V",e),window.wshandler.websockets[e]=this};n.prototype.send=function(e){jsb.reflection.callStaticMethod("sockets/WebSocketClient","sendPacket","(Ljava/lang/String;Ljava/lang/String;)V",this.url,e.join("|"))},n.prototype.close=function(){this.readyState=2;var e=jsb.reflection.callStaticMethod("sockets/WebSocketClient","disconnect","(Ljava/lang/String;)V",this.url);e&&cc.log(e);var t=window.wshandler.websockets;t[this.url]=null,delete t[this.url]},window.wshandler={websockets:{},event:function(e,t,o){switch(cc.log("[pomelo-client] receive event: ",e,t),e){case"onopen":var n=this.websockets[t];n?(n.readyState=1,n.onopen({target:n,data:o})):cc.error(" websocket is null! url = ",t);break;case"onmessage":var i=this.websockets[t];if(i){for(var r=o.split("|"),a=new Uint8Array(r.length),c=0;c<r.length;c++)a[c]=parseInt(r[c]);i.onmessage({target:i,data:a})}else cc.error(" websocket is null! url = ",t);break;case"onclose":var s=this.websockets[t];s?(s.readyState=3,s.onclose({target:s,data:o})):cc.error(" websocket is null! url = ",t);break;case"onerror":var l=this.websockets[t];l?l.onerror({target:l,data:o}):cc.error(" websocket is null! url = ",t);break;case"heartBeatTimeout":var u=this.websockets[t];u?u.heartBeatTimeout({target:u,data:o}):cc.error(" websocket is null! url = ",t)}}};var i={ERROR:"error",IOERROR:"ioError",HEARTBEAT_TIMEOUT:"heartbeatTimeout",CLOSE:"close",PARSE_ERROR:"parseError",ONKICK:"onKick"},r=e("EventEmitter");t.exports=function(t){var o=t||"pomelokey",a=null,c=e("protobuf"),s=e("protocol"),l=s.Package,u=s.Message,p=null;void 0!==p?p=window.localStorage:"undefined"!=typeof cc&&(p=cc.sys.localStorage),"function"!=typeof Object.create&&(Object.create=function(e){function t(){}return t.prototype=e,new t});var d=Object.create(r.prototype);d.Events=i;var h=null,f=0,g={},m={},v={},_={},y={},b={},C={},T=0,S=0,E=0,L=0,w=null,k=null,P=0,N=0,A=null,O=null,I=null,R={sys:{type:"js-websocket",version:"0.0.1"},user:{}},M=null,x=null,B=!1,D="",F=!1,j=0;d.init=function(e,t,o){I=e.encode||H,O=e.decode||U,cc.log("\u3010\u670d\u52a1\u5668\u534f\u8bae\u538b\u7f29\u662f\u5426\u5f00\u542f\u3011"+!!e.encode);var n=e.url;D=e.url,R.user=e.user,A=e.handshakeCallback,z(n,t,o)},d.destroy=function(){r.prototype.destroy.call(this),d.disconnect(),d.Events=null,v=null,M=null,x=null,R=null,A=null,g=null,m=null,_=null,y=null,b=null,C=null,O=null,I=null,cc.log("[pomelo] destroy ".concat(o))},d.reconnect=function(e,t,o){B=!0,d.disconnect(),d.init(e,t,o)},d.disconnect=function(){try{if(h){cc.log("\u3010pomelo\u3011disconnect close socket!");try{h.close&&h.close()}catch(e){cc.log(" close error = ",e.toString())}h=null}w&&(clearTimeout(w),w=null),k&&(clearTimeout(k),k=null)}catch(e){cc.error("\u3010pomelo\u3011disconnect"+e)}},d.request=function(e,t,o){2===arguments.length&&"function"==typeof t?(o=t,t={}):t=t||{},(e=e||t.route)&&(G(++f,e,t),g[f]=o,v[f]=e)},d.notify=function(e,t){G(0,e,t=t||{})},d.getPing=function(){return N},d.setHandshake=function(e){a=e};var U=d.decode=function(e){var t=u.decode(e);if(!(t.id>0)||(t.route=v[t.id],delete v[t.id],t.route))return t.body=X(t),t;cc.log("\u3010\u7f51\u7edc\u3011\u534f\u8bae\u8def\u7531\u4e0d\u5b58\u5728")},H=d.encode=function(e,t,o){var n=e?u.TYPE_REQUEST:u.TYPE_NOTIFY;o=C&&C[t]?c.encode(t,o):s.strencode(JSON.stringify(o));var i=0;return _&&_[t]&&(t=_[t],i=1),u.encode(e,n,i,t,o)},V=function(e){var t=function(){};e.onopen=t,e.onmessage=t,e.onerror=t,e.onclose=t,e.heartBeatTimeout=t},z=function(e,t,r){if(M=t,x=r,0===T){var u;try{a?u=a:p&&p.getItem(o)&&(u=JSON.parse(p.getItem(o)))}catch(e){u=null}u&&(T=u.version||0,b=u.server||{},C=u.client||{},c&&c.init({encoderProtos:C,decoderProtos:b}))}R.sys.protoVersion=T;var f=function(){d.disconnect();try{var t=cc.url.raw("resources/cacert.pem");cc.loader.md5Pipe&&(t=cc.loader.md5Pipe.transformURL(t)),cc.log("pemurl=",t),h=null,(h=cc.sys.isNative&&cc.sys.os===cc.sys.OS_ANDROID?new n(D,[],t):new WebSocket(e,[],t)).binaryType="arraybuffer",h.onopen=g,h.onmessage=m,h.onerror=v,h.onclose=_,h.heartBeatTimeout=function(){d.emit(i.HEARTBEAT_TIMEOUT),d.disconnect()}}catch(e){cc.log("createSocket error",e),d.emit(i.CLOSE)}},g=function(e){j=0,F=!0,cc.log("\u3010\u7f51\u7edc\u3011\u8fde\u63a5\u6210\u529f");var t=l.encode(l.TYPE_HANDSHAKE,s.strencode(JSON.stringify(R)));W(t)},m=function(e){try{var o=l.decode(e.data);Y(o,t)}catch(e){cc.log("pomelo\u6570\u636e\u5904\u7406\u9519\u8bef\uff0c",e)}E&&(L=Date.now()+E)},v=function(e){cc.log("\u3010\u7f51\u7edc\u3011\u8fde\u63a5\u6e38\u620f\u670d\u52a1\u5668\u51fa\u9519",e),d.emit(i.CLOSE)},_=function(e){h||cc.log("socket = null!"),0==B&&3==e.target.readyState&&x?x():0==F&&j<3?(j++,cc.log("\u3010\u7f51\u7edc\u3011WEBSOCKET \u91cd\u63e1\u624b"),f()):(cc.log("\u3010\u7f51\u7edc\u3011WEBSOCKET \u65ad\u5f00"),j=0,F=!1,d.emit(i.CLOSE))};h&&V(h),cc.log("\u3010\u7f51\u7edc\u3011\u6e38\u620f\u670d\u52a1\u5668\u8fde\u63a5\u5730\u5740\uff1a"+e),f()},G=function(e,t,o){I&&(o=I(e,t,o));var n=l.encode(l.TYPE_DATA,o);W(n)},W=function(e){null==h||1!=h.readyState?(cc.log("\u3010\u7f51\u7edc\u3011\u53d1\u9001\u6570\u636e\u7ed9\u670d\u52a1\u5668\u65f6\u68c0\u67e5\u4e0e\u670d\u52a1\u5668\u5df2\u65ad\u5f00 socket.readyState",h.readyState),d.emit(i.CLOSE)):h.send(e)},q=function e(){var t=L-Date.now();t>100?k=setTimeout(e,t):(d.emit(i.HEARTBEAT_TIMEOUT),d.disconnect())};m[l.TYPE_HANDSHAKE]=function(e){if(501!==(e=JSON.parse(s.strdecode(e))).code)if(200===e.code){Q(e);var t=l.encode(l.TYPE_HANDSHAKE_ACK);W(t),M&&(M(h),M=null,x=null)}else d.emit(i.ERROR,"handshake fail");else d.emit(i.ERROR,"client version not fullfill")},m[l.TYPE_HEARTBEAT]=function(e){if(h instanceof WebSocket&&(P&&(N=new Date-P),S)){var t=l.encode(l.TYPE_HEARTBEAT);k&&(clearTimeout(k),k=null),w||(w=setTimeout(function(){null!=h&&1==h.readyState&&(w=null,P=new Date,W(t),L=Date.now()+E,k=setTimeout(q,E))},S))}},m[l.TYPE_DATA]=function(e){var t=e;O&&(t=O(t)),J(d,t)},m[l.TYPE_KICK]=function(e){e=s.strdecode(e);try{e=JSON.parse(e)}catch(e){cc.log(e.message)}d.emit(i.ONKICK,e)};var Y=function(e){m[e.type](e.body)},J=function(e,t){if(t.id){var o=g[t.id];if(delete g[t.id],"function"==typeof o)try{o(t.body)}catch(t){e.emit(i.PARSE_ERROR,t)}}else e.emit(t.route,t.body)},X=function(e){var t=e.route;if(e.compressRoute){if(!y[t])return{};t=e.route=y[t]}return b&&b[t]?c.decode(t,e.body):JSON.parse(s.strdecode(e.body))},Q=function(e){e.sys&&e.sys.heartbeat?(S=1e3*e.sys.heartbeat,E=2*S):(S=0,E=0),K(e),"function"==typeof A&&A(e.user)},K=function(e){if(e&&e.sys){_=e.sys.dict;var t=e.sys.protos;if(_)for(var n in y={},_=_)y[_[n]]=n;t?(T=t.version||0,b=t.server||{},C=t.client||{},c&&c.init({encoderProtos:t.client,decoderProtos:t.server}),p.setItem(o,JSON.stringify(t))):p.setItem(o,JSON.stringify({}))}};return d},cc._RF.pop()},{EventEmitter:"EventEmitter",protobuf:"protobuf",protocol:"protocol"}],protobuf:[function(e,t,o){"use strict";cc._RF.push(t,"25980YLiMFPJL3BlnQvQeSc","protobuf");var n={};(function(e,o){var n=e;n.init=function(e){n.encoder.init(e.encoderProtos),n.decoder.init(e.decoderProtos)},n.encode=function(e,t){return n.encoder.encode(e,t)},n.decode=function(e,t){return n.decoder.decode(e,t)},t.exports=n,"undefined"!=typeof window&&(window.protobuf=n)})("undefined"==typeof window?t.exports:n.protobuf={}),(("undefined"!=typeof protobuf?protobuf:t.exports).constants={}).TYPES={uInt32:0,sInt32:0,int32:0,double:1,string:2,message:2,float:5},(("undefined"!=typeof protobuf?protobuf:t.exports).util={}).isSimpleType=function(e){return"uInt32"===e||"sInt32"===e||"int32"===e||"uInt64"===e||"sInt64"===e||"float"===e||"double"===e},function(e,o){var n=("undefined"!==typeof protobuf?protobuf:t.exports).codec={},i=new ArrayBuffer(8),r=new Float32Array(i),a=new Float64Array(i),c=new Uint8Array(i);function s(e){return e<=127?[e]:e<=2047?[192|e>>6,128|63&e]:[224|e>>12,128|(4032&e)>>6,128|63&e]}function l(e){return e<=127?1:e<=2047?2:3}n.encodeUInt32=function(e){e=parseInt(e);if(isNaN(e)||e<0)return null;var t=[];do{var o=e%128,n=Math.floor(e/128);0!==n&&(o+=128),t.push(o),e=n}while(0!==e);return t},n.encodeSInt32=function(e){e=parseInt(e);return isNaN(e)?null:(e=e<0?2*Math.abs(e)-1:2*e,n.encodeUInt32(e))},n.decodeUInt32=function(e){for(var t=0,o=0;o<e.length;o++){var n=parseInt(e[o]);if(t+=(127&n)*Math.pow(2,7*o),n<128)return t}return t},n.decodeSInt32=function(e){var t=this.decodeUInt32(e);return t=(t%2+t)/2*(t%2==1?-1:1)},n.encodeFloat=function(e){return r[0]=e,c},n.decodeFloat=function(e,t){if(!e||e.length<t+4)return null;for(var o=0;o<4;o++)c[o]=e[t+o];return r[0]},n.encodeDouble=function(e){return a[0]=e,c.subarray(0,8)},n.decodeDouble=function(e,t){if(!e||e.length<t+8)return null;for(var o=0;o<8;o++)c[o]=e[t+o];return a[0]},n.encodeStr=function(e,t,o){for(var n=0;n<o.length;n++)for(var i=s(o.charCodeAt(n)),r=0;r<i.length;r++)e[t]=i[r],t++;return t},n.decodeStr=function(e,t,o){for(var n=[],i=t+o;t<i;){var r=0;e[t]<128?(r=e[t],t+=1):e[t]<224?(r=((63&e[t])<<6)+(63&e[t+1]),t+=2):(r=((15&e[t])<<12)+((63&e[t+1])<<6)+(63&e[t+2]),t+=3),n.push(r)}for(var a="",c=0;c<n.length;)a+=String.fromCharCode.apply(null,n.slice(c,c+1e4)),c+=1e4;return a},n.byteLength=function(e){if("string"!=typeof e)return-1;for(var t=0,o=0;o<e.length;o++){t+=l(e.charCodeAt(o))}return t}}(),function(e,t){var o=e,n=e.encoder={},i=o.codec,r=o.constants,a=o.util;function c(e,t){if(!t)return!1;for(var o in t){var i=t[o];switch(i.option){case"required":if(void 0===e[o])return console.warn("no property exist for required! name: %j, proto: %j, msg: %j",o,i,e),!1;case"optional":if(void 0!==e[o])if((r=t.__messages[i.type]||n.protos["message "+i.type])&&!c(e[o],r))return console.warn("inner proto error! name: %j, proto: %j, msg: %j",o,i,e),!1;break;case"repeated":var r=t.__messages[i.type]||n.protos["message "+i.type];if(e[o]&&r)for(var a=0;a<e[o].length;a++)if(!c(e[o][a],r))return!1}}return!0}function s(e,t,o,n){for(var i in n)if(o[i]){var r=o[i];switch(r.option){case"required":case"optional":t=p(e,t,d(r.type,r.tag)),t=l(n[i],r.type,t,e,o);break;case"repeated":n[i].length>0&&(t=u(n[i],r,t,e,o))}}return t}function l(e,t,o,r,a){switch(t){case"uInt32":o=p(r,o,i.encodeUInt32(e));break;case"int32":case"sInt32":o=p(r,o,i.encodeSInt32(e));break;case"float":p(r,o,i.encodeFloat(e)),o+=4;break;case"double":p(r,o,i.encodeDouble(e)),o+=8;break;case"string":var c=i.byteLength(e);o=p(r,o,i.encodeUInt32(c)),i.encodeStr(r,o,e),o+=c;break;default:var l=a.__messages[t]||n.protos["message "+t];if(l){var u=new ArrayBuffer(2*i.byteLength(JSON.stringify(e)));c=s(u,c=0,l,e),o=p(r,o,i.encodeUInt32(c));for(var d=0;d<c;d++)r[o]=u[d],o++}}return o}function u(e,t,o,n,r){var c=0;if(a.isSimpleType(t.type))for(o=p(n,o=p(n,o,d(t.type,t.tag)),i.encodeUInt32(e.length)),c=0;c<e.length;c++)o=l(e[c],t.type,o,n);else for(c=0;c<e.length;c++)o=p(n,o,d(t.type,t.tag)),o=l(e[c],t.type,o,n,r);return o}function p(e,t,o){for(var n=0;n<o.length;n++,t++)e[t]=o[n];return t}function d(e,t){var o=r.TYPES[e]||2;return i.encodeUInt32(t<<3|o)}n.init=function(e){this.protos=e||{}},n.encode=function(e,t){var o=this.protos[e];if(!c(t,o))return null;var n=i.byteLength(JSON.stringify(t)),r=new ArrayBuffer(n),a=new Uint8Array(r),l=0;return o&&(l=s(a,l,o,t))>0?a.subarray(0,l):null}}("undefined"!=typeof protobuf?protobuf:t.exports),function(e,t){var o,n=e,i=e.decoder={},r=n.codec,a=n.util,c=0;function s(e,t,o){for(;c<o;){var n=l(),i=(n.type,n.tag),r=t.__tags[i];switch(t[r].option){case"optional":case"required":e[r]=u(t[r].type,t);break;case"repeated":e[r]||(e[r]=[]),p(e[r],t[r].type,t)}}return e}function l(){var e=r.decodeUInt32(d());return{type:7&e,tag:e>>3}}function u(e,t){switch(e){case"uInt32":return r.decodeUInt32(d());case"int32":case"sInt32":return r.decodeSInt32(d());case"float":var n=r.decodeFloat(o,c);return c+=4,n;case"double":var a=r.decodeDouble(o,c);return c+=8,a;case"string":var l=r.decodeUInt32(d()),u=r.decodeStr(o,c,l);return c+=l,u;default:var p=t&&(t.__messages[e]||i.protos["message "+e]);if(p){l=r.decodeUInt32(d());var h={};return s(h,p,c+l),h}}}function p(e,t,o){if(a.isSimpleType(t))for(var n=r.decodeUInt32(d()),i=0;i<n;i++)e.push(u(t));else e.push(u(t,o))}function d(e){var t,n=[],i=c;e=e||!1;do{t=o[i],n.push(t),i++}while(t>=128);return e||(c=i),n}i.init=function(e){this.protos=e||{}},i.setProtos=function(e){e&&(this.protos=e)},i.decode=function(e,t){var n=this.protos[e];return o=t,c=0,n?s({},n,o.length):null}}("undefined"!=typeof protobuf?protobuf:t.exports),cc._RF.pop()},{}],protocol:[function(e,t,o){"use strict";function n(e){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}cc._RF.push(t,"a7f245hwz9GUaCemWTV9+vs","protocol"),function(e,o,n){var i=e,r=i.Package={},a=i.Message={};r.TYPE_HANDSHAKE=1,r.TYPE_HANDSHAKE_ACK=2,r.TYPE_HEARTBEAT=3,r.TYPE_DATA=4,r.TYPE_KICK=5,a.TYPE_REQUEST=0,a.TYPE_NOTIFY=1,a.TYPE_RESPONSE=2,a.TYPE_PUSH=3,i.strencode=function(e){for(var t=new o(3*e.length),n=0,i=0;i<e.length;i++){var r=e.charCodeAt(i),a=null;a=r<=127?[r]:r<=2047?[192|r>>6,128|63&r]:[224|r>>12,128|(4032&r)>>6,128|63&r];for(var s=0;s<a.length;s++)t[n]=a[s],++n}var l=new o(n);return c(l,0,t,0,n),l},i.strdecode=function(e){for(var t=new o(e),n=[],i=0,r=0,a=t.length;i<a;)t[i]<128?(r=t[i],i+=1):t[i]<224?(r=((63&t[i])<<6)+(63&t[i+1]),i+=2):(r=((15&t[i])<<12)+((63&t[i+1])<<6)+(63&t[i+2]),i+=3),n.push(r);return String.fromCharCode.apply(null,n)},r.encode=function(e,t){var n=t?t.length:0,i=new o(4+n),r=0;return i[r++]=255&e,i[r++]=n>>16&255,i[r++]=n>>8&255,i[r++]=255&n,t&&c(i,r,t,0,n),i},r.decode=function(e){var t=new o(e),n=t[0],i=1,r=(t[i++]<<16|t[i++]<<8|t[i++])>>>0,a=r?new o(r):null;return c(a,0,t,4,r),{type:n,body:a}},a.encode=function(e,t,n,r,a){var c=1+(s(t)?u(e):0);if(l(t))if(n){if("number"!=typeof r)throw new Error("error flag for number route!");c+=2}else if(c+=1,r){if((r=i.strencode(r)).length>255)throw new Error("route maxlength is overflow");c+=r.length}a&&(c+=a.length);var g=new o(c),m=0;return m=p(t,n,g,m),s(t)&&(m=d(e,g,m)),l(t)&&(m=h(n,r,g,m)),a&&(m=f(a,g,m)),g},a.decode=function(e){var t=new o(e),n=t.length||t.byteLength,r=0,a=0,u=null,p=t[r++],d=1&p,h=p>>1&7;if(s(h)){var f=parseInt(t[r]),g=0;do{a+=(127&(f=parseInt(t[r])))*Math.pow(2,7*g),r++,g++}while(f>=128)}if(l(h))if(d)u=t[r++]<<8|t[r++];else{var m=t[r++];m?(u=new o(m),c(u,0,t,r,m),u=i.strdecode(u)):u="",r+=m}var v=n-r,_=new o(v);return c(_,0,t,r,v),{id:a,type:h,compressRoute:d,route:u,body:_}};var c=function(e,t,o,n,i){if("function"==typeof o.copy)e&&o.copy(e,t,n,n+i);else for(var r=0;r<i;r++)e[t++]=o[n++]},s=function(e){return e===a.TYPE_REQUEST||e===a.TYPE_RESPONSE},l=function(e){return e===a.TYPE_REQUEST||e===a.TYPE_NOTIFY||e===a.TYPE_PUSH},u=function(e){var t=0;do{t+=1,e>>=7}while(e>0);return t},p=function(e,t,o,n){if(e!==a.TYPE_REQUEST&&e!==a.TYPE_NOTIFY&&e!==a.TYPE_RESPONSE&&e!==a.TYPE_PUSH)throw new Error("unkonw message type: "+e);return o[n]=e<<1|(t?1:0),n+1},d=function(e,t,o){do{var n=e%128,i=Math.floor(e/128);0!==i&&(n+=128),t[o++]=n,e=i}while(0!==e);return o},h=function(e,t,o,n){if(e){if(t>65535)throw new Error("route number is overflow");o[n++]=t>>8&255,o[n++]=255&t}else t?(o[n++]=255&t.length,c(o,n,t,0,t.length),n+=t.length):o[n++]=0;return n},f=function(e,t,o){return c(t,o,e,0,e.length),o+e.length};t.exports=i}("object"===(void 0===t?"undefined":n(t))?t.exports:(void 0).Protocol={},Uint8Array),cc._RF.pop()},{}],sdkconfig:[function(e,t,o){"use strict";cc._RF.push(t,"663a8RWXaxP7aCFUMCZvJAg","sdkconfig");var n={web:[],ios:[{pluginName:"PluginIAP"},{pluginName:"PluginOS"},{pluginName:"PluginAssetsUpdate"},{pluginName:"PluginFacebook"},{pluginName:"PluginGoogle"},{pluginName:"PluginSignInApple"},{pluginName:"PluginVisitor"},{pluginName:"PluginWebView"},{pluginName:"PluginBugly"},{pluginName:"PluginAdMob",params:{adUnitID:"ca-app-pub-4155862935870750/6196838225",debugAdUnitID:"ca-app-pub-3940256099942544/1712485313"}},{pluginName:"PluginTopon",params:{appID:"a5f05955323a40",appKey:"6c1b47e47be2eb0de605daf6e406e67b",placementID:"b5f059563dc33f"}}],android:[{pluginName:"PluginOS"},{pluginName:"PluginLog"},{pluginName:"PluginPermission"},{pluginName:"PluginAssetsUpdate"},{pluginName:"PluginFacebook"},{pluginName:"PluginGoogle"},{pluginName:"PluginVisitor"},{pluginName:"PluginWebView"},{pluginName:"PluginGooglePay"},{pluginName:"PluginBugly"},{pluginName:"PluginTopon",params:{appID:"a5f02d110de468",appKey:"6c1b47e47be2eb0de605daf6e406e67b",placementID:"b5f02d12790fb1"}}]};t.exports=function(e){return n[e]},cc._RF.pop()},{}],"use_v2.1-2.2.1_cc.Toggle_event":[function(e,t,o){"use strict";cc._RF.push(t,"90b4b59ypFB1YZDHluO9JS1","use_v2.1-2.2.1_cc.Toggle_event"),cc.Toggle&&(cc.Toggle._triggerEventInScript_isChecked=!0),cc._RF.pop()},{}]},{},["Main","ServerTest","CreatorEx","Engine","EngineMessage","Log","Audio","AudioImp","BTAction","BTDatabase","BTNode","BTParallel","BTParallelFlexible","BTPrecondition","BTPrioritySelector","BTSequence","SpineParticle","SpineParticleWithColor","EventDispatcher","EventObjectEmitter","MessageManager","HActionBezier","HActionInstant","HActionInterval","HActionJump","HActionTween","HActionTweenBase","HActionTweenBy","HCustomEase","HEaseDefine","HAction","HActionComponent","HActionEngine","HActionSequence","HActionSpawn","HNodeEx","HVars","ezaction","PluginBridgeCore","PluginEntity","ezdefine","ezplugin","sdkconfig","AssetsLoader","Defines","DelegateComponent","GUI","LayerCustomPopUp","LayerDialog","LayerFloat","LayerLoading","LayerNotify","LayerPopup","LayerUI","Http","RequestConfig","RequestEntity","Language","LanguageComponent","LanguageI18nEnum","LanguageLabel","LanguagePack","LanguagePointLabel","LanguageSprite","MVVM","Observer","NetProtocol","Network","EventEmitter","pomelo-client","protobuf","protocol","ComponentExtends","DeviceMotionComponent","EdgeMaskComponent","ExToggleGroup","LoadingIndicator","OrientationPrompt","ScreenShake","ScreenShakeRepeat","SpineAnimationQueue","UINumberPicker","ViewLayout","ViewUtils","ButtonEffect","ButtonEffectAnim","ButtonEffectSprite","ButtonGear","ButtonMulti","ButtonSimple","ButtonSprite","ButtonSwitch","ButtonTouchLong","LabelChange","LabelChangeSymbol","LabelNumber","LabelSpineAnim","LabelTime","Toast","ViewAssetsLoader","ViewSpineLoader","ButtonSelect","LabelSelect","SelectBase","SpriteSelect","UrlParse","AssetsQueueLoader","AsyncQueue","Downloader","EngineTime","Ex","HashMap","ValueExtends","mathEx","AudioMessage","CalcTool","CalcUiShow","GameAudio","GameData","GameProtocol","GameViewModel","HallProtocolCode","MapNpcController","ModuleManager","Pay","ThemeConfig","ThemeMessage","BTConditions","BTreeEntity","BTActionGreet","BTActionIdle","BTActionReply","BTActionWalk","GameMessage","List","ListItem","ClerkComponent","FameConfirm","FameGetComponent","GameMainControl","GiftComponent","GiftListItem","IncomeCoponent","LanguageScale","ListItemFrame","MailResultComponent","MainScene","MapCityPopUP","OfffLineRewardPrompt","PackageComponent","PackageListItem","PackageResult","PublicSuccess","RankingListComponent","RankingListItem","SellConfirm","SerllStoresAnim","SettingMailComponent","SettingMailListItem","ShopClerkListItem","ShopComponent","ShopPrestigeListItem","ShoppingComponent","ShoppingListItem","ShoppingResult","StoreComponent","StoreOperation","StoreUnLock","TaskComponent","TaskListChallengeItem","TaskListDayItem","TaskListMainItem","ViewMenu","WorldMapComponent","AdvControl","AdvMainMuti","AdvRewardChoose","LandmarkComonent","LandmarkProgress","ActionX","ActionY","ActionYSet","AdvLoop","BalloonAnim","BirdAnimLeft","BirdAnimRight","EditBoxControl","GradenClick","HeadSelect","LabLayout","LabStepText","LabTouchFont","LoadingTip","MainCloudAnim","MapControl","PosterTip","ProgressAnim","SpineAnimName","UiClickAudio","MainTaskTip","NoviceBatchUp","NoviceCallengeTask","NoviceClerkUp","NoviceCollectGold","NoviceFameUp","NoviceHandle","NoviceLockStore","NoviceMainTask","NoviceMainTaskEnd","NoviceMainTaskOpen","NoviceNpcClick","NovicePackage","NovicePublicFame","NoviceSellStores","NoviceShopping","NoviceStart","NoviceStoreUpLv","NpcClickComponent","LoadingView","LoginView","LevelUp","ViewTerms","SceneMap","MapData","MapParams","MapType","Charactor","MovieClip","EntityLayer","MapLayer","AStarRoadSeeker","AstarHoneycombRoadSeeker","IRoadSeeker","MapRoadUtils","Point","RoadNode","use_v2.1-2.2.1_cc.Toggle_event","LogAnalytics","Service","SettingManager","ShareLink","Account","AccountData","LoginType","RequestAccount","RequestFacebook","RequestGoogle","RequestSignInApple","RequestTwitter","RequestVisitor","Config","GameConfig","QueryConfig","CommonPrompt","HallPrompt","LoadingSignQueue","Prompt","Server","AppResManager","AppResUrl","AssetsHotUpdate"]);