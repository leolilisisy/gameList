System.register("chunks:///_virtual/BasicBullet.ts",["cc","./GlobalConfig.ts","./GlobalEnum.ts","./EventManager.ts","./EventTypes.ts","./BasicCollider.ts","./CollisionManager.ts"],(function(t){"use strict";var i,s,e,o,n,h,l,c,a,r;return{setters:[function(t){i=t.cclegacy,s=t._decorator,e=t.v3},function(t){o=t.WeaponCfg},function(t){n=t.GlobalEnum},function(t){h=t.default},function(t){l=t.EventTypes},function(t){c=t.BasicCollider},function(t){a=t.ColliderGroup,r=t.CollisionManager}],execute:function(){var p;i._RF.push({},"1a23a9IqeRJvpGECZ94iCrn","BasicBullet",void 0);var d=s.ccclass;s.property,t("BasicBullet",d("BasicBullet")(p=function(){function t(t,i,s){this._index=0,this.weaponType=0,this.isFinish=!0,this.lineSpd=e(),this.rotSpd=e(),this.scaleSpd=0,this.opacitySpd=0,this.pos=e(),this.rot=e(),this.scale=0,this.opacity=0,this.activeNum=0,this.curt=0,this.animTime=0,this.initRot=e(),this.atkRate=1,this.tmpP=e(),this.tmpR=e(),this.collider=null,this._index=t,this.initRot.set(s),this.weaponType=i,this.rot.set(0,-this.initRot.y,0)}var i=t.prototype;return i.setActive=function(t,i,s,e,o,n,h,l){this.atkRate=e,this.isFinish=!1,this.activeNum=1,this.pos.set(t);var c=57.3*Math.atan2(-i.z,i.x)+this.initRot.y+180;this.rot.set(0,c,0),this.animTime=o,this.scale=h,this.opacity=1,this.lineSpd.set(i),this.rotSpd.set(s),this.setCollider(n,l)},i.init=function(){},i.reset=function(){this.isFinish=!0,this.activeNum=0,this.curt=0,this.resetCollider()},i.update=function(t){this.move(t),this.updateCollider(t)},i.lateUpdate=function(t){this.lateUpdateCollider(t)},i.move=function(t){this.tmpP.set(this.lineSpd).multiplyScalar(t),this.pos.add(this.tmpP),this.curt+=t,this.curt>=this.animTime&&(this.isFinish=!0,this.reset())},i.setCollider=function(t,i){this.collider=new c(a.PlayerBullet,this,!0),this.collider.setRectSize(t),this.collider.setRectPos(this.pos),this.collider.updateGridInfo(!0),this.collider.isCircleCollider=i},i.resetCollider=function(){this.collider&&(this.collider.clearGridInfo(),this.collider.removeFromManager(),this.collider=null)},i.updateCollider=function(t){this.checkEnemys()},i.lateUpdateCollider=function(t){this.collider&&this.collider.lateUpdate(t)},i.checkEnemys=function(){!this.isFinish&&this.collider.checkPosFast(this.pos,this.onCheckColliderCb.bind(this))},i.onCheckColliderCb=function(t,i){if(!this.isFinish){var s=r.allColliderRecs[i];if(s&&t==a.Enemy){var e=s.targetCmp,c=o[this.weaponType].atk*this.atkRate;switch(e.byHit(c),this.weaponType){case n.WeaponType.FireGun:h.emit(l.EffectEvents.show3DTo2DEffect,{t:n.Effect3dType.Effect_jz_fireball_boom,p:this.pos});for(var p=Math.floor(3*Math.random())+1,d=0;d<p;d++)this.tmpP.set(this.pos),this.tmpP.y+=.5,this.tmpP.x+=2*(2*Math.random()-1),this.tmpP.z+=2*(2*Math.random()-1)+2,h.emit(l.EffectEvents.showObjs,n.Effect3dType.fireEffect,{p:this.tmpP})}return this.isFinish=!0,void this.reset()}}},t}())||p);i._RF.pop()}}}));

System.register("chunks:///_virtual/BasicCollider.ts",["cc","./CollisionManager.ts"],(function(t){"use strict";var s,i,e,o,h,r,c;return{setters:[function(t){s=t.cclegacy,i=t.v3,e=t.v2,o=t.Rect},function(t){h=t.CollisionManager,r=t.CollisionTools,c=t.ColliderGroup}],execute:function(){s._RF.push({},"7ad91qaPxVPO5LgJ1DoaZgz","BasicCollider",void 0);i();var l=e();t("BasicCollider",function(){function t(t,s,e){void 0===e&&(e=!1),this.SelfId=0,this.GroupId=c.None,this.isTrigger=!1,this.prePosInfo=[],this.curRectPosArr=[],this.selfRect=new o(0,0,1,1),this.isDirty=!1,this.mapRange={maxX:0,minX:0,maxY:0,minY:0,maxZ:0,minZ:0,x:0,y:0,z:0},this.targetCmp=null,this.isCircleCollider=!1,this.tmpP2=i(),this.stepP=i(),this._tmpP0=i(),this._isColX=!1,this._isColZ=!1,this._isColl=!1,this._outRes=void 0,this.GroupId=t,this.targetCmp=s,this.isTrigger=e,this.init()}var s=t.prototype;return s.setRectPos=function(t){t.x==this.selfRect.center.x&&t.z==this.selfRect.center.y||(this.selfRect.center=l.set(t.x,t.z),this.updatePosRecFromRect(this.selfRect,this.curRectPosArr),this.isDirty=!0)},s.setSinglePoint=function(t){t.x==this.selfRect.center.x&&t.z==this.selfRect.center.y||(this.selfRect.center=l.set(t.x,t.z),this.updatePosRecFromPos(t),this.isDirty=!0)},s.setRectSize=function(t){t.width==this.selfRect.width&&t.height==this.selfRect.height||(this.selfRect.set(this.selfRect.x,this.selfRect.y,t.width,t.height),this.curRectPosArr=[],this.updatePosRecFromRect(this.selfRect,this.curRectPosArr),this.isDirty=!0)},s.clearGridInfo=function(){for(var t=0;t<this.prePosInfo.length;t++)h.clearInfo(this.prePosInfo[t].p,this.GroupId,this.SelfId,this.prePosInfo[t].index)},s.removeFromManager=function(){h.removeColliderByColId(this.SelfId)},s.init=function(){this.SelfId=t._COLLODERINDEX++,h.setColilderByColId(this.SelfId,this);var s=h.mapWpos,i=h.mapSize;this.mapRange={maxX:i.x+s.x,minX:s.x,maxY:i.y+s.y,minY:s.y,maxZ:i.z+s.z,minZ:s.z,x:s.x,y:s.y,z:s.z}},s.updateGridInfo=function(t){if(void 0===t&&(t=!1),this.isDirty||t){this.clearGridInfo();for(var s=0;s<this.curRectPosArr.length;s++)this.prePosInfo[s]||(this.prePosInfo[s]={p:i(),index:-1}),this.prePosInfo[s].index=h.setInfo(this.curRectPosArr[s],this.GroupId,this.SelfId,this.prePosInfo[s].p);this.isDirty=!1}},s.lateUpdate=function(t){this.updateGridInfo()},s.updatePosRecFromRect=function(t,s){for(var e=h.gridSize,o=Math.ceil(t.width/e.x),r=Math.ceil(t.height/e.z),c=0,l=0;l<=o;l++)for(var n=0;n<=r;n++)s[c]||(s[c]=i()),s[c].set(l*e.x,0,n*e.z),s[c].add3f(t.x,0,t.y),c++},s.updatePosRecFromPos=function(t){this.curRectPosArr[0]||(this.curRectPosArr[0]=i()),this.curRectPosArr[0].x=Math.ceil(t.x),this.curRectPosArr[0].y=0,this.curRectPosArr[0].z=Math.ceil(t.z)},s.checkMoveCollision=function(t,s,i){return this._isColl=!1,i.set(t),0!=s.x||0!=s.z?(0!=s.x&&(this._tmpP0.set(t.x+s.x,t.y,t.z),this._isColX=this.checkPosFast(this._tmpP0),i.x=this._isColX?t.x:this._tmpP0.x),0!=s.z&&(this._tmpP0.set(t.x,t.y,t.z+s.z),this._isColZ=this.checkPosFast(this._tmpP0),i.z=this._isColZ?t.z:this._tmpP0.z),this._isColl=this._isColX&&this._isColZ):(this._tmpP0.set(t),this._isColl=this.checkPosFast(this._tmpP0)),this._isColl},s.checkPosFast=function(t,s){for(var i in this._outRes)this._outRes[i]=null;if(this._outRes={},this.setRectPos(t),this.updateGridInfo(),r.impreciseCheckByRect(this.GroupId,this.SelfId,this.curRectPosArr,this._outRes,!0))for(var e in this._outRes)for(var o=this._outRes[e],h=0;h<o.length;h++){var c=o[h];if(r.checkRectByColId(this.selfRect,c,null,this.isCircleCollider,!0))return s&&s(+e,c),!0}return!1},s.checkPosCollistion=function(t,s){for(var i in this._outRes)this._outRes[i]=null;this._outRes={};var e=this._checkPosCollison(this._tmpP0.set(t),this._outRes);return e&&s&&s(this._outRes),e},s._checkPosCollison=function(t,s){this.setRectPos(t),this.updateGridInfo();var i=0;if(r.impreciseCheckByRect(this.GroupId,this.SelfId,this.curRectPosArr,s,!0))for(var e in s){for(var o=s[e],h=o.length-1;h>=0;h--){var c=o[h];r.checkRectByColId(this.selfRect,c,null,this.isCircleCollider,!0)||o.splice(h,1)}0==o.length?delete s[e]:i++}return i>0},s.checkPosByGroup=function(t,s,i){for(var e in this._outRes)this._outRes[e]=null;this._outRes={},this.setRectPos(t),this.updateGridInfo();var o=0;if(r.impreciseCheckByGroup(t,this._outRes,s))for(var h in this._outRes){for(var c=this._outRes[h],l=c.length-1;l>=0;l--){var n=c[l];r.checkRectByColId(this.selfRect,n,null,this.isCircleCollider,!0)||c.splice(l,1)}0==c.length?delete this._outRes[h]:o++}return this._isColl=o>0,this._isColl&&i&&i(this._outRes),this._isColl},t}())._COLLODERINDEX=1,s._RF.pop()}}}));

System.register("chunks:///_virtual/BasicEffect.ts",["cc","./Tools.ts"],(function(t){"use strict";var c,e,i;return{setters:[function(t){c=t.cclegacy,e=t._decorator},function(t){i=t.default}],execute:function(){var n;c._RF.push({},"06be1zze3ZHAawiRBswSJOj","BasicEffect",void 0);var s=e.ccclass;e.property,t("BasicEffect",s("BasicEffect")(n=function(){function t(t){this.node=null,this.isFinish=!1,this.node=t}var c=t.prototype;return c.init=function(){},c.update=function(t){},c.reset=function(){},c.clearObj=function(){i.clearObj(this)},t}())||n);c._RF.pop()}}}));

System.register("chunks:///_virtual/BasicLayer.ts",["cc","./EventManager.ts"],(function(t){"use strict";var n,e,s;return{setters:[function(t){n=t.cclegacy,e=t._decorator},function(t){s=t.default}],execute:function(){var i;n._RF.push({},"6851dlWug1DZIzKdVAQ4LgQ","BasicLayer",void 0);var o=e.ccclass;e.property,t("BasicLayer",o("BasicLayer")(i=function(){function t(t){this.node=null,this.events={},this.onceEvents={},this.node=t}var n=t.prototype;return n.initLayer=function(){this.init(),this.onEvents()},n.init=function(){},n.onEvents=function(){},n.setData=function(t){},n.reset=function(){},n.customUpdate=function(t){},n.customLateUpdate=function(t){},n.on=function(t,n,e){var i=s.on(t,n,e);i&&(this.events.hasOwnProperty(t)||(this.events[t]=[]),this.events[t].push(i))},n.once=function(t,n,e){var i=s.once(t,n,e);i&&(this.onceEvents.hasOwnProperty(t)||(this.onceEvents[t]=[]),this.onceEvents[t].push(i))},n.emit=function(t,n,e){void 0===n?s.emit(t):void 0===e?s.emit(t,n):s.emit(t,n,e),this.onceEvents.hasOwnProperty(t)&&delete this.onceEvents[t]},n.off=function(t,n,e){var i=this.events[t];if(i)for(var o=i.length-1;o>=0;--o)i[o].cb===n&&i[o].target===e&&(s.off(t,i[o]),i.splice(o,1));if(i=this.onceEvents[t])for(var c=i.length-1;c>=0;--c)i[c].cb===n&&i[c].target===e&&(s.off(t,i[c]),i.splice(c,1))},n.offEvents=function(){for(var t in this.events)s.offGroup(t,this.events[t]);for(var n in this.events={},this.onceEvents)s.offGroup(n,this.onceEvents[n]);this.onceEvents={}},t}())||i);n._RF.pop()}}}));

System.register("chunks:///_virtual/BasicModifyMesh.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var a,s,r,i,e,n,o,u;return{setters:[function(t){a=t.applyDecoratedDescriptor,s=t.inheritsLoose,r=t.initializerDefineProperty,i=t.assertThisInitialized},function(t){e=t.cclegacy,n=t._decorator,o=t.MeshRenderer,u=t.Component}],execute:function(){var h,c,l,m,f,D;e._RF.push({},"b1660mQ0TBNtpwGCHPSffJ4","BasicModifyMesh",void 0);var d=n.ccclass,p=n.property;t("BasicModifyMesh",(h=d("BasicModifyMesh"),c=p(o),h((f=a((m=function(t){function a(){for(var a,s=arguments.length,e=new Array(s),n=0;n<s;n++)e[n]=arguments[n];return a=t.call.apply(t,[this].concat(e))||this,r(a,"msr",f,i(a)),a.transData1=[0,0,0,0],a.transData2=[0,0,0,0],a.a_transData1="a_transData1",a.a_transData2="a_transData2",a._curColorNum=0,a._deathNum=1,r(a,"isUseColor",D,i(a)),a}s(a,t);var e=a.prototype;return e.onLoad=function(){delete this.msr.mesh.struct.maxPosition,delete this.msr.mesh.struct.minPosition,this.msr.shadowCastingMode=0},e.setData=function(){this._curColorNum=0,this._deathNum=1,this.transData2[0]=this._curColorNum,this.transData2[1]=this._deathNum},e.setTransData=function(t,a,s){this.transData1[0]=t.x,this.transData1[1]=s,this.transData1[2]=t.z,this.transData1[3]=a,this.msr.setInstancedAttribute(this.a_transData1,this.transData1)},e.byHit=function(){this._curColorNum=1},e.setDeath=function(){this._deathNum=.05},e.updateColor=function(t){this.isUseColor&&(this._curColorNum+=.2*(0-this._curColorNum)*t*60,this.transData2[0]=this._curColorNum,this.transData2[1]=this._deathNum,this.msr.setInstancedAttribute(this.a_transData2,this.transData2))},a}(u)).prototype,"msr",[c],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=a(m.prototype,"isUseColor",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),l=m))||l));e._RF.pop()}}}));

System.register("chunks:///_virtual/BasicModifyRotMesh.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var a,s,r,i,e,n,o,u;return{setters:[function(t){a=t.applyDecoratedDescriptor,s=t.inheritsLoose,r=t.initializerDefineProperty,i=t.assertThisInitialized},function(t){e=t.cclegacy,n=t._decorator,o=t.MeshRenderer,u=t.Component}],execute:function(){var c,h,l,m,d,D;e._RF.push({},"cab95XBnRRATLiBndUupULm","BasicModifyRotMesh",void 0);var f=n.ccclass,p=n.property;t("BasicModifyRotMesh",(c=f("BasicModifyRotMesh"),h=p(o),c((d=a((m=function(t){function a(){for(var a,s=arguments.length,e=new Array(s),n=0;n<s;n++)e[n]=arguments[n];return a=t.call.apply(t,[this].concat(e))||this,r(a,"msr",d,i(a)),a.transData1=[0,0,0,0],a.transData2=[0,0,0,0],a.a_transData1="a_transData1",a.a_transData2="a_transData2",a._curColorNum=0,a._deathNum=1,r(a,"isUseColor",D,i(a)),a}s(a,t);var e=a.prototype;return e.onLoad=function(){delete this.msr.mesh.struct.maxPosition,delete this.msr.mesh.struct.minPosition,this.msr.shadowCastingMode=0},e.setData=function(){this._curColorNum=0,this._deathNum=1,this.transData2[0]=this._curColorNum,this.transData2[1]=this._deathNum},e.setTransData=function(t,a,s){this.transData1[0]=t.x,this.transData1[1]=s,this.transData1[2]=t.z,this.transData1[3]=a,this.msr.setInstancedAttribute(this.a_transData1,this.transData1)},e.byHit=function(){this._curColorNum=1},e.setDeath=function(){this._deathNum=.05},e.updateColor=function(t){this.isUseColor&&(this._curColorNum+=.2*(0-this._curColorNum)*t*60,this.transData2[0]=this._curColorNum,this.transData2[1]=this._deathNum,this.msr.setInstancedAttribute(this.a_transData2,this.transData2))},a}(u)).prototype,"msr",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=a(m.prototype,"isUseColor",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),l=m))||l));e._RF.pop()}}}));

System.register("chunks:///_virtual/BasicMountLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts"],(function(t){"use strict";var n,e,o,s,i;return{setters:[function(t){n=t.inheritsLoose},function(t){e=t.cclegacy,o=t._decorator,s=t.Component},function(t){i=t.default}],execute:function(){var c;e._RF.push({},"2e32553YL5AybqPyrC8I2cj","BasicMountLayer",void 0);var r=o.ccclass;o.property,t("BasicMountLayer",r("BasicMountLayer")(c=function(t){function e(){for(var n,e=arguments.length,o=new Array(e),s=0;s<e;s++)o[s]=arguments[s];return(n=t.call.apply(t,[this].concat(o))||this).events={},n.onceEvents={},n}n(e,t);var o=e.prototype;return o.initLayer=function(){this.init(),this.onEvents()},o.init=function(){},o.onEvents=function(){},o.setData=function(t){},o.reset=function(){},o.customUpdate=function(t){},o.customLateUpdate=function(t){},o.on=function(t,n,e){var o=i.on(t,n,e);o&&(this.events.hasOwnProperty(t)||(this.events[t]=[]),this.events[t].push(o))},o.once=function(t,n,e){var o=i.once(t,n,e);o&&(this.onceEvents.hasOwnProperty(t)||(this.onceEvents[t]=[]),this.onceEvents[t].push(o))},o.emit=function(t,n,e){void 0===n?i.emit(t):void 0===e?i.emit(t,n):i.emit(t,n,e),this.onceEvents.hasOwnProperty(t)&&delete this.onceEvents[t]},o.off=function(t,n,e){var o=this.events[t];if(o)for(var s=o.length-1;s>=0;--s)o[s].cb===n&&o[s].target===e&&(i.off(t,o[s]),o.splice(s,1));if(o=this.onceEvents[t])for(var c=o.length-1;c>=0;--c)o[c].cb===n&&o[c].target===e&&(i.off(t,o[c]),o.splice(c,1))},o.offEvents=function(){for(var t in this.events)i.offGroup(t,this.events[t]);for(var n in this.events={},this.onceEvents)i.offGroup(n,this.onceEvents[n]);this.onceEvents={}},e}(s))||c);e._RF.pop()}}}));

System.register("chunks:///_virtual/BasicProp.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BasicComponet.ts","./BasicCollider.ts","./CollisionManager.ts"],(function(i){"use strict";var e,t,o,l,r,s,n,c,a,d,u;return{setters:[function(i){e=i.applyDecoratedDescriptor,t=i.inheritsLoose,o=i.initializerDefineProperty,l=i.assertThisInitialized},function(i){r=i.cclegacy,s=i._decorator,n=i.v3,c=i.size},function(i){a=i.BasicComponet},function(i){d=i.BasicCollider},function(i){u=i.ColliderGroup}],execute:function(){var h,p,C,f;r._RF.push({},"4927ak0T4lFlKiaunHCwm8Z","BasicProp",void 0);var b=s.ccclass,m=s.property;i("BasicProp",b("BasicProp")((C=e((p=function(i){function e(){for(var e,t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return e=i.call.apply(i,[this].concat(r))||this,o(e,"cldSize",C,l(e)),o(e,"isCircleCollider",f,l(e)),e.collider=null,e.cldGroup=u.Trap,e.pos=n(),e}t(e,i);var r=e.prototype;return r.setData=function(i){this.node.setPosition(i.p),this.node.setRotation(i.r),this.node.parent=i.parent,this.setCollider()},r.reset=function(){this.resetCollider()},r.show=function(){},r.hide=function(){},r.customUpdate=function(i){this.updateCollider(i)},r.customLateUpdate=function(i){this.lateUpdateCollider(i)},r.setCollider=function(){this.pos.set(this.node.worldPosition),this.collider=new d(this.cldGroup,this,!0),this.collider.setRectSize(this.cldSize),this.collider.setRectPos(this.pos),this.collider.updateGridInfo(!0),this.collider.isCircleCollider=this.isCircleCollider},r.resetCollider=function(){this.collider&&(this.collider.clearGridInfo(),this.collider.removeFromManager(),this.collider=null)},r.updateCollider=function(i){this.checkCollistion()},r.checkCollistion=function(){this.collider&&this.collider.checkPosCollistion(this.pos,this.onCheckColliderCb.bind(this))},r.onCheckColliderCb=function(i){},r.lateUpdateCollider=function(i){this.collider&&this.collider.lateUpdate(i)},e}(a)).prototype,"cldSize",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return c(1,1)}}),f=e(p.prototype,"isCircleCollider",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),h=p))||h);r._RF.pop()}}}));

System.register("chunks:///_virtual/BasicRec.ts",["cc"],(function(c){"use strict";var t,e;return{setters:[function(c){t=c.cclegacy,e=c._decorator}],execute:function(){var n,r;t._RF.push({},"54ef2OvcFhG5rHA/zW9ucMx","BasicRec",void 0);var i=e.ccclass;e.property,c("BasicRec",i("BasicRec")(((r=function(){function c(){this._curId=0,this.node=null,this._curId=c.RECID++}var t=c.prototype;return t.init=function(){},t.update=function(c){},t.reset=function(){},c}()).RECID=0,n=r))||n);t._RF.pop()}}}));

System.register("chunks:///_virtual/BasicRole.ts",["cc"],(function(t){"use strict";var c,e,o;return{setters:[function(t){c=t.cclegacy,e=t._decorator,o=t.v3}],execute:function(){var i;c._RF.push({},"4d55eOFne5O6ITTyjiFslcy","BasicRole",void 0);var n=e.ccclass;e.property,t("BasicRole",n("BasicRole")(i=function(){function t(){this.curPos=o(),this.hp=0}var c=t.prototype;return c.onAtk=function(){},c.byHit=function(t){},t}())||i);c._RF.pop()}}}));

System.register("chunks:///_virtual/BasicRole2.ts",["cc"],(function(){"use strict";var c;return{setters:[function(e){c=e.cclegacy}],execute:function(){c._RF.push({},"666edOVxyFA2a1ncKPkO/xd","BasicRole",void 0),c._RF.pop()}}}));

System.register("chunks:///_virtual/BasicSkeleAnim.ts",["cc","./GlobalTmpData.ts","./ColorLog.ts"],(function(i){"use strict";var t,n,s,e,a;return{setters:[function(i){t=i.cclegacy,n=i._decorator,s=i.SkeletalAnimation},function(i){e=i.GlobalTmpData},function(i){a=i.clog}],execute:function(){var l;t._RF.push({},"9f3314wJzdHr5FzC7tbfS1q","BasicSkeleAnim",void 0);var c=n.ccclass;n.property,i("BasicSkeleAnim",c("BasicSkeleAnim")(l=function(){function i(i){this.anim=null,this._curClip=null,this._allClips={},this._curAnimtimeScale=1,this._clipInitSpd=null,this._extralAnimSpd=1,this._crossTime=.2,this.anim=i.getComponent(s)}var t=i.prototype;return t.init=function(i){for(var t in this.anim.clips)this._allClips[this.anim.clips[t].name]=this.anim.clips[t];this.anim.stop(),this.setInitClipSpd(),this.onEvents()},t.onEvents=function(){},t.offEvents=function(){},t.reset=function(){this._curClip=null,this._curAnimtimeScale=1,this._extralAnimSpd=1,this.anim.stop(),this.resetClipSpd(),this.offEvents()},t.setInitClipSpd=function(){if(!this._clipInitSpd)for(var i in this.anim.clips){var t=this.anim.clips[i],n=this.anim.getState(t.name);n&&(this._clipInitSpd||(this._clipInitSpd={}),this._clipInitSpd[t.name]=n.speed||1)}},t.resetClipSpd=function(){if(this._clipInitSpd)for(var i in this.anim.clips){var t=this.anim.clips[i],n=this.anim.getState(t.name);t&&n&&this._clipInitSpd[t.name]&&(n.speed=this._clipInitSpd[t.name])}},t.playAnim=function(i,t,n,l,c){if(void 0===t&&(t=!1),void 0===n&&(n=!1),void 0===l&&(l=1),n||i!=this._curClip)if(this.setInitClipSpd(),this._clipInitSpd&&this._clipInitSpd[i]){this._curClip=i,this._extralAnimSpd=l,this._curAnimtimeScale=e.timeScale*l;var p=this.anim.getState(i);if(p.speed=this._clipInitSpd[i]*this._curAnimtimeScale,c&&this.anim.once(s.EventType.FINISHED,c),this.anim.crossFade(i,this._crossTime),t){var h=p.duration;p.setTime(h*Math.random()),p.sample()}}else a.warn("没有"+i+"动作：",this.anim.node.name)},i}())||l);t._RF.pop()}}}));

System.register("chunks:///_virtual/BasicState.ts",["cc","./Tools.ts"],(function(t){"use strict";var n,e;return{setters:[function(t){n=t.cclegacy},function(t){e=t.default}],execute:function(){n._RF.push({},"d48de5PM/VA/5mIDg46CmW+","BasicState",void 0);t("BasicState",function(){function t(t){this.cmp=null,this.cmp=t}var n=t.prototype;return n.reset=function(){e.clearObj(this)},n.enter=function(t){},n.onEvents=function(){},n.offEvents=function(){},n.update=function(t){},n.exit=function(){},t}());n._RF.pop()}}}));

System.register("chunks:///_virtual/CameraLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalData.ts","./GlobalEnum.ts","./EventManager.ts","./EventTypes.ts","./BasicMountLayer.ts"],(function(t){"use strict";var e,o,n,s,a,i,r,l,f,h;return{setters:[function(t){e=t.inheritsLoose},function(t){o=t.cclegacy,n=t._decorator,s=t.Camera,a=t.v3},function(t){i=t.default},function(t){r=t.GlobalEnum},function(t){l=t.default},function(t){f=t.EventTypes},function(t){h=t.BasicMountLayer}],execute:function(){var c;o._RF.push({},"4d6b6diR89KWq59OuECI/xS","CameraLayer",void 0);var m=n.ccclass;n.property,t("CameraLayer",m("CameraLayer")(c=function(t){function o(){for(var e,o=arguments.length,n=new Array(o),s=0;s<o;s++)n[s]=arguments[s];return(e=t.call.apply(t,[this].concat(n))||this)._initPos=a(),e._initRot=a(),e._initRothoHeight=3,e._followPos=null,e._cameraSelf=null,e._cameraCmp=null,e._tmpPos=a(),e}e(o,t);var n=o.prototype;return n.init=function(){this._initPos.set(this.node.position),this._initRot.set(this.node.eulerAngles),this._cameraSelf=this.node.children[0],this._cameraCmp=this._cameraSelf.getComponent(s),i.set(r.GlobalDataType.Camera3D,this._cameraCmp)},n.onEvents=function(){l.on(f.CameraEvents.SetCameraPos,this.onSetCameraPos,this),l.on(f.CameraEvents.SetFollowPos,this.onSetFollowPos,this),l.on(f.CameraEvents.SetCameraSelfRot,this.onSetCameraSelfRot,this),l.on(f.CameraEvents.SetCameraSelfPos,this.onSetCameraSelfPos,this),l.on(f.CameraEvents.SetCameraSelfOffset,this.onSetCameraSelfOffset,this),l.on(f.CameraEvents.SetCameraOrthoHeightOffset,this.onSetCameraOrthoHeightOffset,this)},n.setData=function(t){},n.reset=function(){this._followPos=null,this.node.setPosition(this._initPos)},n.customUpdate=function(t){this.followCamera(t)},n.customLateUpdate=function(t){},n.followCamera=function(t){this._followPos&&(this._tmpPos.set(this.node.position),this._tmpPos.lerp(this._followPos,.1),this.node.setPosition(this._tmpPos))},n.onSetCameraPos=function(t){t&&this.node.setPosition(t)},n.onSetFollowPos=function(t){this._followPos=t},n.onSetCameraSelfPos=function(t){this._cameraSelf.setPosition(t)},n.onSetCameraSelfOffset=function(t){this._cameraSelf.setPosition(t)},n.onSetCameraOrthoHeightOffset=function(t){this._cameraCmp.orthoHeight=this._initRothoHeight+t},n.onSetCameraSelfRot=function(t){this._cameraSelf.eulerAngles=t},o}(h))||c);o._RF.pop()}}}));

System.register("chunks:///_virtual/CollisionManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BasicLayer.ts"],(function(t){"use strict";var r,e,i,o,n,c,s,l,a,h;return{setters:[function(t){r=t.inheritsLoose},function(t){e=t.cclegacy,i=t._decorator,o=t.v3,n=t.rect,c=t.v2,s=t.size,l=t.Vec3,a=t.Intersection2D},function(t){h=t.BasicLayer}],execute:function(){var f,d;t("ColliderGroup",void 0),e._RF.push({},"06250PAm0xG4L55xYkJC58i","CollisionManager",void 0);var u,p=i.ccclass,g=o(),v={};!function(t){t[t.None=0]="None",t[t.Player=1]="Player",t[t.PlayerBullet=2]="PlayerBullet",t[t.Enemy=3]="Enemy",t[t.EnemyBullet=4]="EnemyBullet",t[t.Prop=5]="Prop",t[t.Trap=6]="Trap",t[t.Barrier=7]="Barrier",t[t.PlayerTrigger=8]="PlayerTrigger",t[t.EnemyTrigger=9]="EnemyTrigger"}(u||(u=t("ColliderGroup",{})));var m=t("GroupConfig",{0:[],1:[7],2:[3],3:[],4:[1],5:[1],6:[1],7:[],8:[1],9:[3]}),C=t("CollisionManager",p("CollisionManager")(((d=function(t){function e(){return t.apply(this,arguments)||this}r(e,t);var i=e.prototype;return i.onEvents=function(){},i.reset=function(){for(var t=0;t<e.gridInfo.length;t++){var r=e.gridInfo[t];if(r)for(var i=0;i<r.length;i++){var o=r[i];if(o)for(var n in o)o[n]=null}}e.gridInfo=[],e.allColliderRecs={}},i.setData=function(t){},i.createMapData=function(t){var r=s(2*t.x,2*t.z);e.mapSize.set(r.width,1,r.height);var i=o(.5*-r.width,0,.5*-r.height),n=o(i);l.round(n,n),e.mapWpos.set(n);var c=e.mapSize,a=e.gridSize,h=o();h.x=c.x/a.x,h.y=c.y/a.y,h.z=c.z/a.z,l.ceil(h,h);for(var f=o(),d=Date.now(),p=0;p<=h.x;p++){f.x=Math.ceil(p),e.gridInfo[f.x]=[];for(var g=0;g<=h.z;g++){f.z=Math.ceil(g);var v={};for(var m in u){isNaN(m)||(v[+m]=[])}e.gridInfo[f.x][f.z]=v}}var C=Date.now();console.log("# 碰撞管理创建: ",C-d,"ms")},i.update=function(t){},e.setColilderByColId=function(t,r){this.allColliderRecs[t]=r},e.getColilderByColId=function(t){return this.allColliderRecs[t]},e.removeColliderByColId=function(t){this.allColliderRecs[t]&&delete this.allColliderRecs[t]},e.getInfo=function(t){return l.subtract(g,t,this.mapWpos),g.divide(this.gridSize),l.ceil(g,g),this.gridInfo[g.x]&&this.gridInfo[g.x][g.z]?this.gridInfo[g.x][g.z]:v},e.getInfoByGroup=function(t,r,e){e=e||{};for(var i=0;i<t.length;i++)for(var o=t[i],n=this.getInfo(o),c=0;c<r.length;c++){var s=r[c];if(n[s]){e[s]||(e[s]=[]);for(var l=0;l<n[s].length;l++){var a=n[s][l];a>=0&&e[s].indexOf(a)<0&&e[s].push(a)}}}return e},e.setInfo=function(t,r,e,i){l.subtract(g,t,this.mapWpos),g.divide(this.gridSize),l.ceil(g,g),i.set(g),g.y=0,this.gridInfo[g.x]||(this.gridInfo[g.x]=[]),this.gridInfo[g.x][g.z]||(this.gridInfo[g.x][g.z]={}),this.gridInfo[g.x][g.z][r]||(this.gridInfo[g.x][g.z][r]=[]);var o=this.gridInfo[g.x][g.z][r],n=o.indexOf(e);if(n>=0)return n;for(var c=0;c<o.length;c++)if(o[c]<0){o[c]=e,n=c;break}return n<0&&(o.push(e),n=o.length-1),n},e.clearInfo=function(t,r,e,i){if(g.set(t),!this.gridInfo[g.x]||!this.gridInfo[g.x][g.z])return!1;var o=this.gridInfo[g.x][g.z][r];return o[i]>=0&&o[i]==e&&(o[i]=-1),!0},e}(h)).gridInfo=[],d.allColliderRecs={},d.mapSize=o(),d.gridSize=o(1,1,1),d.mapWpos=o(),f=d))||f),y=t("CollisionTools",function(){function t(){}return t.getRectByPos=function(t,r){return this._tmpRect.set(0,0,2*r,2*r),this._tmpRect.center=this._tmpV2.set(t.x,t.z),this._tmpRect},t.getCollInfoByPos=function(t,r,e,i){this._tmpArr=[],this._tmpRect.set(0,0,2*r,2*r),this._tmpRect.center=this._tmpV2.set(t.x,t.z),this.updatePosRecFromRect(this._tmpRect,this._tmpArr);var o=!1;for(var n in this._tmpArr){var c=this._tmpArr[n];this.impreciseCheckByGroup(c,e,i)&&(o=!0)}return o},t.getCollInfoByRect=function(t,r,e){this._tmpArr=[],this.updatePosRecFromRect(t,this._tmpArr);var i=!1;for(var o in this._tmpArr){var n=this._tmpArr[o];this.impreciseCheckByGroup(n,r,e)&&(i=!0)}return i},t.updatePosRecFromRect=function(t,r){for(var e=C.gridSize,i=Math.ceil(t.width/e.x),n=Math.ceil(t.height/e.z),c=0,s=0;s<=i;s++)for(var l=0;l<=n;l++)r[c]||(r[c]=o()),r[c].set(s*e.x,0,l*e.z),r[c].add3f(t.x,0,t.y),c++},t.impreciseCheckByRect=function(t,r,e,i,o){void 0===o&&(o=!0);var n=!1;for(var c in e){var s=e[c];this.impreciseCheckByPos(t,r,s,i,o)&&(n=!0)}return n},t.impreciseCheckByPos=function(t,r,e,i,o){void 0===o&&(o=!0);var n=!1,c=C.getInfo(e);if(!c)return console.warn("# 获取检测数据错误 pos:"+e),!1;for(var s in c){var l=c[s],a=+s;if(l.length>0&&(o&&m[t].indexOf(a)>=0||!o)){i[a]||(i[a]=[]);for(var h=0;h<l.length;h++){var f=l[h];f>=0&&f!=r&&i[a].indexOf(f)<0&&i[a].push(f)}n||(n=i[a].length>0)}}return n},t.impreciseCheckByGroup=function(t,r,e){var i=!1,o=C.getInfo(t);if(!o)return console.warn("# 获取检测数据错误 pos:"+t),!1;for(var n in o){var c=o[n],s=+n;if(c.length>0&&e&&e.indexOf(s)>=0){r[s]||(r[s]=[]);for(var l=0;l<c.length;l++){var a=c[l];a>=0&&r[s].indexOf(a)<0&&r[s].push(a)}i||(i=r[s].length>0)}}return i},t.checkPosByColIdArrCb=function(t,r,e,i,o,n){if(void 0===o&&(o=!1),void 0===n&&(n=!0),!e)return!1;var c={colId:-1,rect:this._tmpRect};this._tmpRect.set(0,0,2*r,2*r),this._tmpRect.center=this._tmpV2.set(t.x,t.z);for(var s=0;s<e.length;s++)this.checkRectByColId(this._tmpRect,e[s],c,o,n)&&i&&i(c);return!1},t.checkRectByColIdArrCb=function(t,r,e,i,o){if(void 0===i&&(i=!1),void 0===o&&(o=!0),!r)return!1;for(var n={colId:-1,rect:this._tmpRect},c=0;c<r.length;c++)this.checkRectByColId(t,r[c],n,i,o)&&e&&e(n);return!1},t.checkRectByColIdArr=function(t,r,e,i,o){if(void 0===i&&(i=!1),void 0===o&&(o=!0),!r)return!1;for(var n=0;n<r.length;n++)if(this.checkRectByColId(t,r[n],e,i,o))return!0;return!1},t.checkRectByColId=function(t,r,e,i,o){void 0===i&&(i=!1),void 0===o&&(o=!0);var n=!1,c=C.getColilderByColId(r);if(c&&(o||!o&&!c.isTrigger)){this._tmpRect.set(c.selfRect);var s=t.center,l=c.selfRect.center,h=.5*t.width,f=.5*c.selfRect.height;i&&c.isCircleCollider&&(n=a.circleCircle(s,h,l,f))&&e&&e.fixPos&&(this._tmpDirec.set(s).subtract(l),this._tmpDirec.normalize().multiplyScalar(h+f).add(l),e.fixPos.set(this._tmpDirec.x,0,this._tmpDirec.y)),i||c.isCircleCollider||(n=a.rectRect(t,this._tmpRect)),i&&!c.isCircleCollider&&(n=a.rectCircle(c.selfRect,s,h)),!i&&c.isCircleCollider&&(n=a.rectCircle(t,l,f)),n&&e&&(e.colId=r,e.rect.set(this._tmpRect))}return n},t}());y._tmpArr=[],y._tmpRect=n(),y._tmpV2=c(),y._tmpDirec=c(),e._RF.pop()}}}));

System.register("chunks:///_virtual/Decorate.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BasicComponet.ts","./GlobalPool.ts"],(function(t){"use strict";var e,r,i,n,o,c;return{setters:[function(t){e=t.inheritsLoose},function(t){r=t.cclegacy,i=t._decorator,n=t.MeshRenderer},function(t){o=t.BasicComponet},function(t){c=t.default}],execute:function(){var s;r._RF.push({},"03c2fqLmAJNO4i0knLkP03d","Decorate",void 0);var a=i.ccclass;i.property,t("Decorate",a("Decorate")(s=function(t){function r(){for(var e,r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return(e=t.call.apply(t,[this].concat(i))||this).building=null,e.arr=["Architecture_A","Architecture_B","Architecture_C","Architecture_D","Architecture_E"],e}return e(r,t),r.prototype.onEnable=function(){if(!this.building){var t=this.arr[Math.floor(Math.random()*this.arr.length)];this.building=c.get(t),this.building.parent=this.node,this.building.setPosition(0,0,0);var e=this.building.getComponent(n);e&&(e.mesh.struct.maxPosition.multiplyScalar(3),e.mesh.struct.minPosition.multiplyScalar(3))}},r}(o))||s);r._RF.pop()}}}));

System.register("chunks:///_virtual/Drone.ts",["cc","./GlobalConfig.ts","./GlobalEnum.ts","./GlobalTmpData.ts","./EventManager.ts","./EventTypes.ts","./AudioEnum.ts","./AudioSystem.ts","./Tools.ts","./ModifyPosRotMesh.ts"],(function(t){"use strict";var s,i,o,e,n,a,h,r,u,c,p,l,f;return{setters:[function(t){s=t.cclegacy,i=t._decorator,o=t.Vec3,e=t.v3},function(t){n=t.WeaponCfg},function(t){a=t.GlobalEnum},function(t){h=t.GlobalTmpData},function(t){r=t.default},function(t){u=t.EventTypes},function(t){c=t.AudioEnum},function(t){p=t.AudioSystem},function(t){l=t.default},function(t){f=t.ModifyPosRotMesh}],execute:function(){var m;s._RF.push({},"e6050KsqotNArJhYJE76X2/","Drone",void 0);var d=i.ccclass;i.property,t("Drone",d("Drone")(m=function(){function t(t){this.curPos=e(),this.curRot=e(),this.node=null,this.height=0,this.transMsr=null,this.tmpP=e(),this.tmpP1=e(),this.offsetX=0,this.atkCd=0,this.curt=0,this.atk=0,this.tmpV=e(),this.atkData={pos:e(),rot:e(),lineVec:e(),rotSpd:e(),atkRate:1},this.shotBulletRot=[-3,0,3],this.node=t,this.transMsr=t.getComponent(f)}var s=t.prototype;return s.init=function(){this.height=n[a.WeaponType.Drone].droneheight,this.curPos.set(h.Player.wpos).add(h.Player.offset),this.curRot.y=h.Player.wrotY-1.57,this.curPos.y=15,this.initAtk()},s.reset=function(){l.clearObj(this)},s.setOffset=function(){},s.customUpdate=function(t){this.move(t),this.updateAtk(t)},s.move=function(t){this.tmpP1.set(this.offsetX,0,0),o.rotateY(this.tmpP1,this.tmpP1,o.ZERO,h.Player.wrotY-1.57),this.tmpP.set(h.Player.wpos),this.tmpP.add(this.tmpP1),this.curPos.lerp(this.tmpP,.1*t*60),this.curPos.y+=.1*(this.height-this.curPos.y)*t*60,this.curRot.y+=.2*(h.Player.wrotY-1.57-this.curRot.y)*t*60,this.transMsr&&this.transMsr.setTransData(this.curPos,this.curRot,2)},s.initAtk=function(){var t=n[a.WeaponType.Drone];this.atk=t.atk,this.atkCd=1/t.atkSpd,this.curt=0},s.updateAtk=function(t){h.Game.isGameRun&&(this.curt+=t,this.curt>=this.atkCd&&(this.curt=0,this.onAtk()))},s.onAtk=function(){p.playEffect(c.Drone);for(var t=n[a.WeaponType.Drone],s=this.curRot.y-1.57,i=0;i<this.shotBulletRot.length;i++){var e=.01745*this.shotBulletRot[i];this.tmpV.set(1,0,0),o.rotateY(this.tmpV,this.tmpV,o.ZERO,e+s),this.tmpV.multiplyScalar(t.bulletSpd||10),this.tmpP.set(this.curPos).add3f(0,1,0),this.atkData.pos.set(this.tmpP),this.atkData.lineVec.set(this.tmpV),this.atkData.rotSpd.set(o.ZERO),this.atkData.atkRate=t.bulletSpd,r.emit(u.EffectEvents.showMergeEffect,t.bullet,this.atkData)}},t}())||m);s._RF.pop()}}}));

System.register("chunks:///_virtual/EffectLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventTypes.ts","./GlobalPool.ts","./BasicLayer.ts"],(function(t){"use strict";var e,s,n,c,f,o,i;return{setters:[function(t){e=t.inheritsLoose},function(t){s=t.cclegacy,n=t._decorator,c=t.Vec3},function(t){f=t.EventTypes},function(t){o=t.default},function(t){i=t.BasicLayer}],execute:function(){var r;s._RF.push({},"2d11aUgpKtG1KIktFztkLFA","EffectLayer",void 0);var a=n.ccclass;n.property,t("EffectLayer",a("EffectLayer")(r=function(t){function s(){for(var e,s=arguments.length,n=new Array(s),c=0;c<s;c++)n[c]=arguments[c];return(e=t.call.apply(t,[this].concat(n))||this)._effectRecs={},e}e(s,t);var n=s.prototype;return n.init=function(){},n.onEvents=function(){this.on(f.EffectEvents.showParticleEffect,this.onShowParticleEffect,this),this.on(f.EffectEvents.showFrameEffect,this.onShowFrameEffect,this),this.on(f.EffectEvents.showObjs,this.onShowObjs,this)},n.setData=function(t){},n.reset=function(){this.resetEffects()},n.customUpdate=function(t){this.updateEffects(t)},n.customLateUpdate=function(t){},n.resetEffects=function(){for(var t in this._effectRecs){var e=this._effectRecs[t];e&&e.reset()}this._effectRecs={}},n.updateEffects=function(t){for(var e in this._effectRecs){var s=this._effectRecs[e];s&&s.isFinish?(s.reset(),delete this._effectRecs[e]):s.update(t)}},n.onShowParticleEffect=function(t,e){var s=o.get(t,e.p);s.parent=this.node,e.p&&s.setPosition(e.p),e.r&&(s.eulerAngles=e.r),e.s&&s.setScale(e.s)},n.onShowFrameEffect=function(t,e){var s=o.get(t,e);s.parent=this.node,s.setPosition(c.ZERO),s.eulerAngles=c.ZERO},n.onShowObjs=function(t,e){o.get(t,e).parent=this.node},s}(i))||r);s._RF.pop()}}}));

System.register("chunks:///_virtual/ElectricSaw.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalConfig.ts","./GlobalEnum.ts","./CollisionManager.ts","./BasicProp.ts"],(function(t){"use strict";var e,i,o,s,n,r,a,l,c,u,h,p,f,v,g,y,_;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,o=t.initializerDefineProperty,s=t.assertThisInitialized},function(t){n=t.cclegacy,r=t._decorator,a=t.Enum,l=t.Node,c=t.v3,u=t.Tween,h=t.tween},function(t){p=t.TrapCfg,f=t.GlobalConfig},function(t){v=t.GlobalEnum},function(t){g=t.ColliderGroup,y=t.CollisionManager},function(t){_=t.BasicProp}],execute:function(){var m,d,T,b,C,w,M,P,R;n._RF.push({},"74fa4VlUjhFOKwq1HyrFLBF","ElectricSaw",void 0);var A=r.ccclass,E=r.property;t("ElectricSaw",(m=A("ElectricSaw"),d=E({type:a(v.TrapType)}),T=E(l),b=E(l),m((M=e((w=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return(e=t.call.apply(t,[this].concat(n))||this).cldGroup=g.PlayerTrigger,o(e,"trapType",M,s(e)),o(e,"moveTarget",P,s(e)),o(e,"line",R,s(e)),e._isMove=!1,e._isRuning=!1,e._offset=c(),e.tmpP=c(),e._rot=c(),e}i(e,t);var n=e.prototype;return n.setData=function(e){t.prototype.setData.call(this,e),this.setMove(e.d)},n.reset=function(){this.resetMove(),t.prototype.reset.call(this)},n.customUpdate=function(e){t.prototype.customUpdate.call(this,e),this.updateMove(e)},n.show=function(){t.prototype.show.call(this),!this._isRuning&&this._isMove&&this.moveAnim()},n.hide=function(){t.prototype.hide.call(this),this._isRuning&&this.resetMove()},n.setMove=function(t){this._isRuning=!1,this._isMove=null!=t&&0!=+t,this.line.active=this._isMove},n.resetMove=function(){this._isRuning=!1,this._offset.set(0,0,0),this.pos.set(0,0,0),this.moveTarget&&this.moveTarget.setPosition(this._offset),u.stopAllByTarget(this._offset)},n.updateMove=function(t){this._isMove&&this.moveTarget&&(this.moveTarget.setPosition(this._offset),this.pos.set(this.moveTarget.worldPosition)),this.rotateAnim(t)},n.moveAnim=function(){this._isRuning=!0,u.stopAllByTarget(this._offset);var t=.4*f.RoadWidth;this._offset.set(-t,0,0);h(this._offset).repeatForever(h(this._offset).to(3,{x:t},{easing:"sineInOut"}).to(3,{x:-t},{easing:"sineInOut"}).start()).start()},n.rotateAnim=function(t){this.moveTarget&&(this._rot.y+=180*t,this.moveTarget.eulerAngles=this._rot)},n.checkCollistion=function(){this.collider&&this.collider.checkPosCollistion(this.pos,this.onCheckColliderCb.bind(this))},n.onCheckColliderCb=function(t){var e=p[this.trapType];for(var i in t)for(var o=t[i],s=0;s<o.length;s++){var n=o[s],r=y.getColilderByColId(n).targetCmp;if(r)r.byHit(e.atk)}},e}(_)).prototype,"trapType",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return v.TrapType.ElectricSaw}}),P=e(w.prototype,"moveTarget",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=e(w.prototype,"line",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=w))||C));n._RF.pop()}}}));

System.register("chunks:///_virtual/EndMark.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalTmpData.ts","./EventManager.ts","./EventTypes.ts"],(function(t){"use strict";var n,o,e,i,s,a,r,u;return{setters:[function(t){n=t.inheritsLoose},function(t){o=t.cclegacy,e=t._decorator,i=t.v3,s=t.Component},function(t){a=t.GlobalTmpData},function(t){r=t.default},function(t){u=t.EventTypes}],execute:function(){var h;o._RF.push({},"2676exKyutAEpl/fVo7GGFs","EndMark",void 0);var c=e.ccclass;e.property,t("EndMark",c("EndMark")(h=function(t){function o(){for(var n,o=arguments.length,e=new Array(o),s=0;s<o;s++)e[s]=arguments[s];return(n=t.call.apply(t,[this].concat(e))||this).tmpP=i(),n}n(o,t);var e=o.prototype;return e.onLoad=function(){r.on(u.CurLevelEvents.GetEndPathInfo,this.onGetEndPathInfo,this)},e.onEnable=function(){this.init()},e.onDisable=function(){this.reset()},e.init=function(){var t=this;setTimeout((function(){a.Player.endMarkPos.set(t.node.worldPosition),a.endPassPath=[],t.getEndPaths(a.endPassPath)}),0)},e.reset=function(){},e.getEndPaths=function(t){t.push(this.node.getChildByName("p0").worldPosition),t.push(this.node.getChildByName("p1").worldPosition)},e.getFormation=function(t,n){var o=this.node.getChildByName("formation");this.tmpP.set(o.worldPosition),this.tmpP.x+=-4;for(var e=8/9,s=0,a=0,r=0;r<t;r++){var u=i(this.tmpP);u.x+=s*e,u.z+=a*e,n.push(u),++s>=10&&(s=0,a++)}},e.onGetEndPathInfo=function(t){this.getEndPaths(t.outPaths),this.getFormation(t.num,t.outFormation)},o}(s))||h);o._RF.pop()}}}));

System.register("chunks:///_virtual/Enemy.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalConfig.ts","./GlobalEnum.ts","./GlobalTmpData.ts","./EventManager.ts","./EventTypes.ts","./StorageSystem.ts","./Tools.ts","./BasicModifyMesh.ts","./BasicCollider.ts","./CollisionManager.ts","./BasicRole.ts","./EnemyAnim.ts","./EnemyStates.ts"],(function(t){"use strict";var i,e,s,a,h,n,o,c,r,l,u,d,p,f,_,m,S,y,R,P,E,v,M,g;return{setters:[function(t){i=t.inheritsLoose},function(t){e=t.cclegacy,s=t._decorator,a=t.size,h=t.v3},function(t){n=t.GlobalConfig},function(t){o=t.GlobalEnum},function(t){c=t.GlobalTmpData},function(t){r=t.default},function(t){l=t.EventTypes},function(t){u=t.StorageSystem},function(t){d=t.default},function(t){p=t.BasicModifyMesh},function(t){f=t.BasicCollider},function(t){_=t.ColliderGroup},function(t){m=t.BasicRole},function(t){S=t.EnemyAnim},function(t){y=t.EnemyStateType,R=t.EnemyMoveState,P=t.EnemyFollowState,E=t.EnemyEnterPassState,v=t.EnemyEndFollowState,M=t.EnemyDeathState,g=t.EnemyWinState}],execute:function(){var w;e._RF.push({},"2eeaa9muX9Bko67QJuZuRxy","Enemy",void 0);var C=s.ccclass;s.property,t("Enemy",C("Enemy")(w=function(t){function e(){for(var i,e=arguments.length,s=new Array(e),a=0;a<e;a++)s[a]=arguments[a];return(i=t.call.apply(t,[this].concat(s))||this).node=null,i.enemyType=void 0,i.anim=null,i.modfiyMsCmp=null,i.curScale=1,i.tmpP=h(),i.tmpR=h(),i.tmpV=h(),i.tmpC=h(),i._shadowData={pos:null,scale:1,isShow:!0},i.lineVec=h(),i.pathIndex=0,i.allPath=null,i.moveSpd=0,i.isPathEnd=!1,i.isEndMark=!1,i.curPos=h(),i._rotVec=h(),i._toRadianY=0,i._curRadianY=0,i._rotDirec=1,i._rotSpd=1*Math.PI,i._rotSpdRate=1,i._followTarget=null,i._checkCd=.2,i._checkTime=0,i.collider=null,i.hp=0,i.atk=0,i._stateRecs={},i._curState=null,i._preState=null,i}i(e,t);var s=e.prototype;return s.init=function(t,i,e){this.enemyType=i,this.node=t,this.modfiyMsCmp=this.node.getComponent(p),this.modfiyMsCmp.setData(),this.anim=new S(this.node),this.anim.init(this),this.initProp(),this.initMoveData(e),this.setStateData(),this.setCollider(),this.initShadow()},s.reset=function(){this.anim.reset(),this.resetState(),this.resetCollider(),this.resetShadow(),d.clearObj(this)},s.update=function(t){this.updateState(t),this.updateCollider(t),this.updateTransData(t)},s.lateUpdate=function(t){this.lateUpdateCollider(t)},s.initShadow=function(){this._shadowData.pos=this.curPos,this._shadowData.isShow=!0,this._shadowData.scale=this.curScale,r.emit(l.EffectEvents.showMergeEffect,o.MergeEffectType.MergeShadow,this._shadowData)},s.resetShadow=function(){this._shadowData.isShow=!1},s.initMoveData=function(t){this.allPath=t,this.pathIndex=0,this.curPos.set(this.allPath[0]),this.isPathEnd=!1,this.isEndMark=!1,this.moveSpd=n.Enemy[this.enemyType].spd*(.15*Math.random()+1),this.lineVec.set(this.allPath[1]).subtract(this.allPath[0]);var i=Math.atan2(-this.lineVec.z,this.lineVec.x)+1.57;this.calRotation(i),this._curRadianY=this._toRadianY,this.modfiyMsCmp.setTransData(this.curPos,this._curRadianY,this.curScale)},s.move=function(t){this.tmpP.set(this.lineVec).multiplyScalar(t),this.curPos.add(this.tmpP);var i=Math.atan2(-this.lineVec.z,this.lineVec.x)+1.57;this.calRotation(i),this.rotation(t)},s.updateTransData=function(t){this.modfiyMsCmp.setTransData(this.curPos,this._curRadianY,this.curScale),this.modfiyMsCmp.updateColor(t)},s.calPathDirec=function(){var t=this.allPath[this.pathIndex],i=this.pathIndex+1;if(i>=this.allPath.length-1)this.isPathEnd=!0;else{var e=this.allPath[i],s=this.tmpP.set(t).subtract(e).lengthSqr();if(this.tmpP.set(this.curPos).subtract(t),this.tmpP.lengthSqr()>=s){if(this.pathIndex++,(i=this.pathIndex+1)>this.allPath.length-1)return void(this.isPathEnd=!0);t=this.allPath[this.pathIndex],e=this.allPath[i]}this.lineVec.set(e).subtract(t).normalize().multiplyScalar(this.moveSpd)}},s.rotation=function(t){if(this._curRadianY!==this._toRadianY){var i=this._rotSpd*this._rotSpdRate*t;i>Math.abs(this._curRadianY-this._toRadianY)?this._curRadianY=this._toRadianY:(i*=this._rotDirec,this._curRadianY+=i),this._rotVec.set(0,57.3*this._curRadianY,0)}},s.calRotation=function(t){this._toRadianY=t%6.28;var i=Math.PI;this._toRadianY<0&&(this._toRadianY+=2*i),this._curRadianY=this._curRadianY%(2*i),this._curRadianY>2*i?this._toRadianY-=2*i:this._curRadianY<0&&(this._toRadianY+=2*i);var e=this._toRadianY-this._curRadianY;e>i?(this._curRadianY+=2*i,this._rotDirec=-1):e<-i?(this._toRadianY+=2*i,this._rotDirec=1):e>0?this._rotDirec=1:e<0&&(this._rotDirec=-1)},s.setFollowTarget=function(t){this._followTarget=t,this._followTarget&&this.changeState(y.Follow)},s.checkPlayerCenterPos=function(t){if(this._checkTime+=t,this._checkTime>=this._checkCd){this._checkTime=0;var i=c.Player.wpos,e=n.EnemyCfg.followDist;this.tmpP.set(i).subtract(this.curPos).lengthSqr()<=e*e&&this.changeState(y.Follow)}},s.checkEndMark=function(){var t=c.Player.endMarkPos;!this.isEndMark&&Math.abs(this.curPos.x-t.x)<5&&this.curPos.z>t.z-.5&&(this.isEndMark=!0,this.changeState(y.EnterPass))},s.setCollider=function(){var t=n.EnemyCfg.cldRadius;this.collider=new f(_.Enemy,this,!0),this.collider.setRectSize(a(t,t)),this.collider.setRectPos(this.curPos),this.collider.updateGridInfo(!0),this.collider.isCircleCollider=!0},s.resetCollider=function(){this.collider&&(this.collider.clearGridInfo(),this.collider.removeFromManager(),this.collider=null)},s.updateCollider=function(t){this.collider&&this.collider.setRectPos(this.curPos)},s.lateUpdateCollider=function(t){this.collider&&this.collider.lateUpdate(t)},s.initProp=function(){var t=u.getData().levelAssets.curLv*n.EnemyCfg.lvupStep+1,i=n.Enemy[this.enemyType];this.hp=i.hp*t,this.atk=i.atk*t,this.curScale=i.scale},s.onAtk=function(){},s.byHit=function(t){this.hp<=0||(this.hp-=t,r.emit(l.EffectEvents.showMergeEffect,o.MergeEffectType.MergeEnemyByHit,{p:this.tmpP.set(this.curPos.x,.5,this.curPos.z)}),this.modfiyMsCmp.byHit(),this.hp<=0&&(this.hp=0,this.resetCollider(),this.modfiyMsCmp.setDeath(),this.changeState(y.Death)))},s.setStateData=function(){this._stateRecs[y.Move]=new R(this),this._stateRecs[y.Follow]=new P(this),this._stateRecs[y.EnterPass]=new E(this),this._stateRecs[y.EndFollow]=new v(this),this._stateRecs[y.Death]=new M(this),this._stateRecs[y.Win]=new g(this),this.changeState(y.Move),setTimeout((function(){}),0)},s.resetState=function(){for(var t in this._stateRecs)this._stateRecs[t].offEvents(),this._stateRecs[t].reset();this._stateRecs={},this._curState=null,this._preState=null},s.changeState=function(t,i,e){void 0===e&&(e=!1),(this._curState!==t||e)&&(this._stateRecs[this._curState]&&this._stateRecs[this._curState].exit(),this._stateRecs[t]&&(this._preState=this._curState,this._curState=t,this._stateRecs[this._curState].enter(i)))},s.updateState=function(t){this._stateRecs[this._curState]&&this._stateRecs[this._curState].update(t)},e}(m))||w);e._RF.pop()}}}));

System.register("chunks:///_virtual/EnemyAnim.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Tools.ts","./BasicSkeleAnim.ts"],(function(n){"use strict";var t,e,i,c,o;return{setters:[function(n){t=n.inheritsLoose},function(n){e=n.cclegacy,i=n._decorator},function(n){c=n.default},function(n){o=n.BasicSkeleAnim}],execute:function(){var r;e._RF.push({},"0569fAx6cdNN7Xx1fp+AIWO","EnemyAnim",void 0);var s=i.ccclass;i.property,n("EnemyAnim",s("EnemyAnim")(r=function(n){function e(){for(var t,e=arguments.length,i=new Array(e),c=0;c<e;c++)i[c]=arguments[c];return(t=n.call.apply(n,[this].concat(i))||this).cmp=null,t}t(e,n);var i=e.prototype;return i.onEvents=function(){},i.offEvents=function(){},i.init=function(t){n.prototype.init.call(this),this.cmp=t},i.reset=function(){n.prototype.reset.call(this),c.clearObj(this)},i.onAtk=function(){},e}(o))||r);e._RF.pop()}}}));

System.register("chunks:///_virtual/EnemyBomb.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalConfig.ts","./GlobalEnum.ts","./EventManager.ts","./EventTypes.ts","./CollisionManager.ts","./Enemy.ts","./EnemyStates.ts"],(function(t){"use strict";var o,e,n,i,s,r,c,u,a,l,m,f;return{setters:[function(t){o=t.inheritsLoose},function(t){e=t.cclegacy,n=t._decorator},function(t){i=t.GlobalConfig},function(t){s=t.GlobalEnum},function(t){r=t.default},function(t){c=t.EventTypes},function(t){u=t.CollisionTools,a=t.ColliderGroup,l=t.CollisionManager},function(t){m=t.Enemy},function(t){f=t.EnemyStateType}],execute:function(){var y;e._RF.push({},"9b6e3BK6NBHDaAUEG7oEti6","EnemyBomb",void 0);var h=n.ccclass;n.property,t("EnemyBomb",h("EnemyBomb")(y=function(t){function e(){return t.apply(this,arguments)||this}o(e,t);var n=e.prototype;return n.byHit=function(t){this.hp<=0||(this.hp-=t,this.modfiyMsCmp.byHit(),this.hp<=0&&(this.hp=0,this.enemyBoom(),this.resetCollider(),this.modfiyMsCmp.setDeath(),this.changeState(f.Death)))},n.enemyBoom=function(){var t=this,o=i.Enemy[s.EnemyType.Bomb],e={};u.getCollInfoByPos(this.curPos,o.boomRadius,e,[a.Enemy,a.Player])&&function(){var n=o.boomAtk,i=o.boomRadius*o.boomRadius;for(var s in e)for(var r=e[s],c=0;c<r.length;c++){var u=r[c];u!=t.collider.SelfId&&function(){var o=l.getColilderByColId(u).targetCmp;o&&o!=t&&o.hp>0&&(t.tmpP.set(t.curPos).subtract(o.curPos).lengthSqr()<=i&&setTimeout((function(){o.byHit(n)}),0))}()}}(),r.emit(c.EffectEvents.show3DTo2DEffect,{t:s.Effect3dType.Effect_jz_bomb_boom,p:this.curPos})},e}(m))||y);e._RF.pop()}}}));

System.register("chunks:///_virtual/EnemyStates.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalEnum.ts","./GlobalTmpData.ts","./GlobalPool.ts","./BasicState.ts"],(function(t){"use strict";var e,i,n,c,a,s,r,o;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy,n=t._decorator,c=t.v3},function(t){a=t.GlobalEnum},function(t){s=t.GlobalTmpData},function(t){r=t.default},function(t){o=t.BasicState}],execute:function(){t("EnemyStateType",void 0),i._RF.push({},"5a018qq2QVMY6DskHmiAl3G","EnemyStates",void 0);var h;n.ccclass,n.property;!function(t){t[t.Move=0]="Move",t[t.Follow=1]="Follow",t[t.EnterPass=2]="EnterPass",t[t.EndFollow=3]="EndFollow",t[t.Death=4]="Death",t[t.Win=5]="Win"}(h||(h=t("EnemyStateType",{})));t("EnemyMoveState",function(t){function i(){return t.apply(this,arguments)||this}e(i,t);var n=i.prototype;return n.enter=function(t){var e=this.cmp.enemyType==a.EnemyType.Ninja?a.EnemyClip.rush:a.EnemyClip.run;this.cmp.anim.playAnim(e,!0)},n.update=function(t){this.cmp.calPathDirec(),this.cmp.move(t),this.cmp.checkEndMark(),this.cmp.checkPlayerCenterPos(t)},i}(o)),t("EnemyFollowState",function(t){function i(){for(var e,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return(e=t.call.apply(t,[this].concat(n))||this).checkCd=.1,e.curt=0,e.tmpP=c(),e}e(i,t);var n=i.prototype;return n.enter=function(t){},n.update=function(t){this.updateCheck(t),this.cmp.move(t),this.cmp.checkEndMark()},n.updateCheck=function(t){if(this.curt+=t,this.curt>=this.checkCd){this.curt=0,this.tmpP.set(s.Player.wpos).add(s.Player.offset).subtract(this.cmp.curPos);this.cmp._rotSpdRate=1.2,this.tmpP.normalize().multiplyScalar(1.2*this.cmp.moveSpd),this.cmp.lineVec.set(this.tmpP)}},i}(o)),t("EnemyEnterPassState",function(t){function i(){return t.apply(this,arguments)||this}e(i,t);var n=i.prototype;return n.enter=function(t){var e=this;this.cmp.allPath=[c(this.cmp.curPos)],s.endPassPath.forEach((function(t){e.cmp.allPath.push(c(t))})),this.cmp.pathIndex=0,this.cmp.lineVec.set(this.cmp.allPath[1]).subtract(this.cmp.allPath[0]),this.cmp.lineVec.normalize().multiplyScalar(this.cmp.moveSpd)},n.update=function(t){this.cmp.calPathDirec(),this.cmp.move(t),this.checkPass()},n.checkPass=function(){this.cmp.curPos.z>=this.cmp.allPath[this.cmp.allPath.length-1].z&&this.cmp.changeState(h.EndFollow)},i}(o)),t("EnemyEndFollowState",function(t){function i(){for(var e,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return(e=t.call.apply(t,[this].concat(n))||this).targetRec=null,e.maxDist=0,e.tmpP=c(),e}e(i,t);var n=i.prototype;return n.enter=function(t){this.getTargetPos()},n.update=function(t){this.getTargetPos(),this.moveToTarget(t)},n.reset=function(){t.prototype.reset.call(this),this.targetRec&&(this.targetRec.p=null,this.targetRec.role=null),this.targetRec=null},n.moveToTarget=function(t){this.targetRec&&(this.tmpP.set(this.cmp.curPos).subtract(this.targetRec.p).lengthSqr()>this.maxDist&&this.cmp.lineVec.set(0,0,this.cmp.moveSpd));this.tmpP.set(this.cmp.lineVec).multiplyScalar(t),this.cmp.curPos.add(this.tmpP)},n.getTargetPos=function(){if(!this.targetRec||this.targetRec&&this.targetRec.role.hp<0){var t=s.endFormationRec;for(var e in t){var i=t[e];if(i&&i.role.hp>0){this.targetRec=i,this.tmpP.set(this.targetRec.p).subtract(this.cmp.curPos),this.maxDist=this.tmpP.lengthSqr(),this.cmp.lineVec.set(this.tmpP).normalize().multiplyScalar(this.cmp.moveSpd);break}}this.targetRec||this.cmp.lineVec.set(0,0,this.cmp.moveSpd)}},n.exit=function(){},i}(o)),t("EnemyDeathState",function(t){function i(){for(var e,i=arguments.length,n=new Array(i),c=0;c<i;c++)n[c]=arguments[c];return(e=t.call.apply(t,[this].concat(n))||this)._delayId=null,e}e(i,t);var n=i.prototype;return n.enter=function(t){var e=this;this.cmp.anim.playAnim(a.EnemyClip.death),this._delayId=setTimeout((function(){e.cmp&&e.cmp.node&&r.put(e.cmp.node)}),2e3)},n.update=function(t){},n.reset=function(){clearTimeout(this._delayId),t.prototype.reset.call(this)},i}(o)),t("EnemyWinState",function(t){function i(){return t.apply(this,arguments)||this}e(i,t);var n=i.prototype;return n.enter=function(t){},n.update=function(t){},i}(o));i._RF.pop()}}}));

System.register("chunks:///_virtual/FortBarbette.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalConfig.ts","./GlobalEnum.ts","./EventTypes.ts","./BasicCollider.ts","./CollisionManager.ts","./BasicProp.ts"],(function(t){"use strict";var i,s,e,o,n,a,r,h,l,c,d,p,u,f,y,m,P,g;return{setters:[function(t){i=t.applyDecoratedDescriptor,s=t.inheritsLoose,e=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){n=t.cclegacy,a=t._decorator,r=t.Enum,h=t.Node,l=t.Tween,c=t.tween,d=t.v3,p=t.Vec3},function(t){u=t.TrapCfg},function(t){f=t.GlobalEnum},function(t){y=t.EventTypes},function(t){m=t.BasicCollider},function(t){P=t.ColliderGroup},function(t){g=t.BasicProp}],execute:function(){var b,A,k,T,v,B,w;n._RF.push({},"e2ac7268b5G0aMpWOnSd2bI","FortBarbette",void 0);var _=a.ccclass,C=a.property,E=(t("FortBarbette",(b=_("FortBarbette"),A=C({type:r(f.TrapType)}),k=C(h),b((B=i((v=function(t){function i(){for(var i,s=arguments.length,n=new Array(s),a=0;a<s;a++)n[a]=arguments[a];return(i=t.call.apply(t,[this].concat(n))||this).cldGroup=P.PlayerTrigger,e(i,"trapType",B,o(i)),e(i,"skeleNode",w,o(i)),i.anim=null,i._isPlaying=!1,i.isTriggerUsed=!1,i.tmpV=d(),i.tmpP=d(),i.atkData={pos:d(),rot:d(),lineVec:d(),rotSpd:d(),atkRate:1},i}s(i,t);var n=i.prototype;return n.initSub=function(){this.anim=new E(this.skeleNode),this.anim.init(this)},n.setData=function(i){this.anim.setData(),t.prototype.setData.call(this,i)},n.reset=function(){this.anim.reset(),this._isPlaying=!1,t.prototype.reset.call(this)},n.customUpdate=function(i){t.prototype.customUpdate.call(this,i),this.anim.update(i)},n.show=function(){this.isTriggerUsed&&!this._isPlaying&&(this._isPlaying=!0,this.anim.showAtkAnim())},n.hide=function(){this.isTriggerUsed&&this._isPlaying&&(this._isPlaying=!1,this.anim.stopAnim())},n.setCollider=function(){this.pos.set(this.node.worldPosition),this.collider=new m(this.cldGroup,this,!0),this.collider.setRectSize(this.cldSize),this.collider.setRectPos(this.pos),this.collider.updateGridInfo(!0),this.collider.isCircleCollider=this.isCircleCollider},n.resetCollider=function(){t.prototype.resetCollider.call(this),this.isTriggerUsed=!1},n.checkCollistion=function(){this.isTriggerUsed||this.collider&&this.collider.checkPosFast(this.pos,this.onTriggerEnter.bind(this))},n.onTriggerEnter=function(){var t=this;this.isTriggerUsed=!0,this.anim.showStartAnim((function(){t._isPlaying=!0,t.anim&&t.anim.showAtkAnim()}))},n.onAtk=function(){var t=u[this.trapType],i=this.node.eulerAngles.y+1.57;this.tmpV.set(1,0,0),p.rotateY(this.tmpV,this.tmpV,p.ZERO,i),this.tmpV.multiplyScalar(t.bulletSpd||10),this.tmpP.set(this.node.worldPosition).add3f(0,1,0),this.atkData.pos.set(this.tmpP),this.atkData.lineVec.set(this.tmpV),this.atkData.rotSpd.set(p.ZERO),this.atkData.atkRate=t.atkRate||1,this.emit(y.EffectEvents.showMergeEffect,t.bulletType,this.atkData)},i}(g)).prototype,"trapType",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return f.TrapType.FortBarbette}}),w=i(v.prototype,"skeleNode",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=v))||T)),t("FortBarbetteAnim",function(){function t(t){this.cmp=null,this.body=null,this.head=null,this.bodyPos=d(),this.headPos=d(),this.initBodyPos=d(0,-2,0),this.initHeadPos=d(0,.42,0),this._isAtk=!1,this.body=t,this.head=t.getChildByName("head")}var i=t.prototype;return i.onEvents=function(){},i.offEvents=function(){},i.init=function(t){this.cmp=t},i.setData=function(){this.setAnim()},i.reset=function(){this.stopAnim()},i.update=function(t){this.updateAnim(t)},i.setAnim=function(){this.head.setPosition(this.initHeadPos),this.body.setPosition(this.initBodyPos),this._isAtk=!1},i.showStartAnim=function(t){var i=this;l.stopAllByTarget(this.bodyPos),this.bodyPos.set(this.initBodyPos),this.body.setPosition(this.bodyPos),c(this.bodyPos).to(.1,{y:0},{onUpdate:function(){i.body&&i.body.setPosition(i.bodyPos)}}).call((function(){t&&t()})).start()},i.showAtkAnim=function(){var t=this;this._isAtk=!0,l.stopAllByTarget(this.headPos),this.headPos.set(this.initHeadPos),this.head.setPosition(this.headPos);c(this.headPos).repeatForever(c(this.headPos).to(.1,{z:-.13}).to(.1,{z:0}).call((function(){t.onAtk()}))).start()},i.updateAnim=function(t){this._isAtk&&this.head.setPosition(this.headPos)},i.resetAnim=function(){this.stopAnim()},i.stopAnim=function(){this._isAtk=!1,l.stopAllByTarget(this.bodyPos),l.stopAllByTarget(this.headPos)},i.onAtk=function(){this.cmp&&this.cmp.onAtk()},t}()));n._RF.pop()}}}));

System.register("chunks:///_virtual/FrameAnim.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BasicComponet.ts","./GlobalPool.ts"],(function(a){"use strict";var t,e,i,s,n,r,l,h,o,p,c;return{setters:[function(a){t=a.applyDecoratedDescriptor,e=a.inheritsLoose,i=a.initializerDefineProperty,s=a.assertThisInitialized},function(a){n=a.cclegacy,r=a._decorator,l=a.MeshRenderer,h=a.director,o=a.v4},function(a){p=a.BasicComponet},function(a){c=a.default}],execute:function(){var u,m,f,D,d;n._RF.push({},"5cfccpOCOdDJ6u08wD4hk00","FrameAnim",void 0);var y=r.ccclass,v=r.property;a("FrameAnim",(u=y("FrameAnim"),m=v(l),u((d=t((D=function(a){function t(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t=a.call.apply(a,[this].concat(n))||this,i(t,"mesh",d,s(t)),t.pass=null,t.handleFrameData=void 0,t.frameData=void 0,t.handlePlayData=void 0,t.playData=void 0,t}e(t,a);var n=t.prototype;return n.initSub=function(){this.initMat()},n.setData=function(a){if(this.node.setPosition(a.p),a.e&&(this.node.eulerAngles=a.e),a.s&&this.node.setScale(a.s),this.pass&&(this.playData.w=h.root.cumulativeTime,this.applyMat(),this.playData.x>0)){var t=this.playData.x*this.frameData.w/this.frameData.z;this.scheduleOnce(this.onPlayFinish,t+.1)}},n.onPlayFinish=function(){c.put(this.node)},n.initMat=function(){this.frameData=o(),this.playData=o();var a=this.mesh.getMaterial(0),t=a.passes[0],e=t.getHandle("playData");t.getUniform(e,this.playData),1!=this.playData.y&&(a=this.mesh.getMaterialInstance(0),this.pass=a.passes[0],this.handlePlayData=this.pass.getHandle("playData"),this.pass.getUniform(this.handlePlayData,this.playData),this.handleFrameData=this.pass.getHandle("frameData"),this.pass.getUniform(this.handleFrameData,this.frameData))},n.applyMat=function(){this.pass&&(this.pass.setUniform(this.handleFrameData,this.frameData),this.pass.setUniform(this.handlePlayData,this.playData))},t}(p)).prototype,"mesh",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),f=D))||f));n._RF.pop()}}}));

System.register("chunks:///_virtual/Game",["./BasicEffect.ts","./BasicLayer.ts","./BasicModifyMesh.ts","./BasicModifyRotMesh.ts","./BasicMountLayer.ts","./BasicRec.ts","./BasicRole2.ts","./BasicSkeleAnim.ts","./BasicState.ts","./CameraLayer.ts","./EffectLayer.ts","./FrameAnim.ts","./InstanceFrameAnim.ts","./LevelManager.ts","./HorizonTouch.ts","./BasicCollider.ts","./CollisionManager.ts","./BasicRole.ts","./Enemy.ts","./EnemyAnim.ts","./EnemyBomb.ts","./EnemyStates.ts","./GiantModifyMesh.ts","./Role.ts","./RoleAnim.ts","./RoleGiant.ts","./RoleHand.ts","./RoleLayer.ts","./RoleStates.ts","./BasicBullet.ts","./GrenadesBullet.ts","./MergeBullet.ts","./PistolBullet.ts","./MergeBasic.ts","./MergeEffect.ts","./MergeEffectLayer.ts","./MergeFrameAnim.ts","./MergeFrameGroup.ts","./MergeGroup.ts","./MergeMesh.ts","./MergeShadow.ts","./MergeUtils.ts","./BasicProp.ts","./Drone.ts","./ElectricSaw.ts","./FortBarbette.ts","./Grenades.ts","./Hammer.ts","./LandMine.ts","./ModifyPosRotMesh.ts","./Panels.ts","./PropsLayer.ts","./Rocket.ts","./Spininess.ts","./UpperAirNail.ts","./WeaponProp.ts","./Decorate.ts","./EndMark.ts","./PathBasic.ts","./RoadLayer.ts","./TrailLayer.ts","./TrailMesh.ts","./TrailRec.ts"],(function(){"use strict";return{setters:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/GiantModifyMesh.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BasicModifyMesh.ts"],(function(t){"use strict";var r,a,s,i,e,n,o,u;return{setters:[function(t){r=t.applyDecoratedDescriptor,a=t.inheritsLoose,s=t.initializerDefineProperty,i=t.assertThisInitialized},function(t){e=t.cclegacy,n=t._decorator,o=t.MeshRenderer},function(t){u=t.BasicModifyMesh}],execute:function(){var h,c,l,m,f,d,D,p,_;e._RF.push({},"7776b2d9YtMeJ+Pn9CIG0ya","GiantModifyMesh",void 0);var y=n.ccclass,M=n.property;t("GiantModifyMesh",(h=y("GiantModifyMesh"),c=M(o),l=M(o),m=M(o),h((D=r((d=function(t){function r(){for(var r,a=arguments.length,e=new Array(a),n=0;n<a;n++)e[n]=arguments[n];return r=t.call.apply(t,[this].concat(e))||this,s(r,"msrA",D,i(r)),s(r,"msrB",p,i(r)),s(r,"msrC",_,i(r)),r.transData1=[0,0,0,0],r.transData2=[0,0,0,0],r.a_transData1="a_transData1",r.a_transData2="a_transData2",r._curColorNum=0,r._deathNum=1,r.msrArr=[],r}a(r,t);var e=r.prototype;return e.onLoad=function(){this.msrArr.push(this.msr,this.msrA,this.msrB,this.msrC);for(var t=0;t<this.msrArr.length;t++){var r=this.msrArr[t];delete r.mesh.struct.maxPosition,delete r.mesh.struct.minPosition,r.shadowCastingMode=0}},e.setData=function(){this._curColorNum=0,this._deathNum=1,this.transData2[0]=this._curColorNum,this.transData2[1]=this._deathNum},e.setTransData=function(t,r,a){this.transData1[0]=t.x,this.transData1[1]=a,this.transData1[2]=t.z,this.transData1[3]=r;for(var s=0;s<this.msrArr.length;s++){var i=this.msrArr[s];i.node.active&&i.setInstancedAttribute(this.a_transData1,this.transData1)}},e.byHit=function(){this._curColorNum=1},e.setDeath=function(){this._deathNum=.05},e.updateColor=function(t){this._curColorNum+=.2*(0-this._curColorNum)*t*60,this.transData2[0]=this._curColorNum,this.transData2[1]=this._deathNum;for(var r=0;r<this.msrArr.length;r++){var a=this.msrArr[r];a.node.active&&a.setInstancedAttribute(this.a_transData2,this.transData2)}},r}(u)).prototype,"msrA",[c],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),p=r(d.prototype,"msrB",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=r(d.prototype,"msrC",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),f=d))||f));e._RF.pop()}}}));

System.register("chunks:///_virtual/Grenades.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){"use strict";var t,r,n,o;return{setters:[function(e){t=e.inheritsLoose},function(e){r=e.cclegacy,n=e._decorator,o=e.Component}],execute:function(){var s;r._RF.push({},"50056IFn3NFrryzWOfivHIX","Grenades",void 0);var c=n.ccclass;n.property,e("Grenades",c("Grenades")(s=function(e){function r(){return e.apply(this,arguments)||this}t(r,e);var n=r.prototype;return n.start=function(){},n.update=function(e){},r}(o))||s);r._RF.pop()}}}));

System.register("chunks:///_virtual/GrenadesBullet.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BasicComponet.ts","./GlobalConfig.ts","./GlobalEnum.ts","./GlobalTmpData.ts","./EventTypes.ts","./GlobalPool.ts","./CollisionManager.ts","./ModifyPosRotMesh.ts"],(function(t){"use strict";var s,i,o,e,n,a,l,r,u,c,h,p,f,m,d;return{setters:[function(t){s=t.inheritsLoose},function(t){i=t.cclegacy,o=t._decorator,e=t.Vec3,n=t.v3},function(t){a=t.BasicComponet},function(t){l=t.WeaponCfg},function(t){r=t.GlobalEnum},function(t){u=t.GlobalTmpData},function(t){c=t.EventTypes},function(t){h=t.default},function(t){p=t.CollisionTools,f=t.ColliderGroup,m=t.CollisionManager},function(t){d=t.ModifyPosRotMesh}],execute:function(){var y;i._RF.push({},"750bfka3LVF44YWlJ13lbL4","GrenadesBullet",void 0);var g=o.ccclass;o.property,t("GrenadesBullet",g("GrenadesBullet")(y=function(t){function i(){for(var s,i=arguments.length,o=new Array(i),e=0;e<i;e++)o[e]=arguments[e];return(s=t.call.apply(t,[this].concat(o))||this).pos=n(),s.rot=n(),s.lineVec=n(),s.atkRate=0,s.modfiyMsCmp=null,s.maxDist=5,s.curDist=0,s.isFinish=!1,s.tmpP=n(),s.maxH=5,s.rotSpd=n(5,5,5),s}s(i,t);var o=i.prototype;return o.setData=function(t){this.modfiyMsCmp=this.node.getComponent(d),this.node.setPosition(e.ZERO),this.node.eulerAngles=e.ZERO,this.lineVec.set(t.lineVec),this.pos.set(t.pos),this.atkRate=t.atkRate,this.rot.set(e.ZERO),this.curDist=0,this.isFinish=!1},o.update=function(t){u.Game.isPause||this.isFinish||(this.tmpP.set(this.lineVec).multiplyScalar(t),this.curDist+=this.tmpP.length(),this.pos.add(this.tmpP),this.pos.y=Math.sin(this.curDist/this.maxDist*3.14)*this.maxH,this.tmpP.set(this.rotSpd).multiplyScalar(t),this.rot.add(this.tmpP),this.modfiyMsCmp.setTransData(this.pos,this.rot,2+.08*this.pos.y),this.curDist>=this.maxDist&&(this.isFinish=!0,this.onBoom()))},o.onBoom=function(){var t=this,s=l[r.WeaponType.Grenades],i={};p.getCollInfoByPos(this.pos,s.boomRadius,i,[f.Enemy])&&function(){var o=s.atk,e=s.boomRadius*s.boomRadius;for(var n in i)for(var a=i[n],l=function(s){var i=a[s],n=m.getColilderByColId(i).targetCmp;n&&n.hp>0&&(t.tmpP.set(t.pos).subtract(n.curPos).lengthSqr()<=e&&setTimeout((function(){n.byHit(o)}),0))},r=0;r<a.length;r++)l(r)}(),this.emit(c.EffectEvents.show3DTo2DEffect,{t:r.Effect3dType.Effect_jz_rocketboom,p:this.pos}),setTimeout((function(){h.put(t.node)}),0)},i}(a))||y);i._RF.pop()}}}));

System.register("chunks:///_virtual/Hammer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalConfig.ts","./GlobalEnum.ts","./AudioEnum.ts","./AudioSystem.ts","./CollisionManager.ts","./BasicProp.ts"],(function(t){"use strict";var e,i,n,r,o,a,s,l,u,c,p,m,h,f,g,y,d,A;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,n=t.initializerDefineProperty,r=t.assertThisInitialized},function(t){o=t.cclegacy,a=t._decorator,s=t.Enum,l=t.Node,u=t.v3,c=t.Tween,p=t.tween},function(t){m=t.TrapCfg},function(t){h=t.GlobalEnum},function(t){f=t.AudioEnum},function(t){g=t.AudioSystem},function(t){y=t.ColliderGroup,d=t.CollisionManager},function(t){A=t.BasicProp}],execute:function(){var v,T,b,C,w,z,E,H,R;o._RF.push({},"a6716rgOTFIqLSTGZEo1sNd","Hammer",void 0);var B=a.ccclass,G=a.property;t("Hammer",(v=B("Hammer"),T=G({type:s(h.TrapType)}),b=G(l),C=G(l),v((E=e((z=function(t){function e(){for(var e,i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return(e=t.call.apply(t,[this].concat(o))||this).cldGroup=y.PlayerTrigger,n(e,"trapType",E,r(e)),n(e,"moveTarget",H,r(e)),n(e,"root",R,r(e)),e.rotAnim=u(),e.isRuning=!1,e}i(e,t);var o=e.prototype;return o.setData=function(e){t.prototype.setData.call(this,e);var i=+e.d||2,n=u(0,2==i?0:180,0);this.root.eulerAngles=n},o.reset=function(){this.resetAnim(),t.prototype.reset.call(this)},o.customUpdate=function(e){t.prototype.customUpdate.call(this,e),this.updateAnim(e)},o.show=function(){t.prototype.show.call(this),this.isRuning||this.runAnim()},o.hide=function(){t.prototype.hide.call(this),this.isRuning&&this.resetAnim()},o.runAnim=function(){var t=this;this.isRuning=!0,c.stopAllByTarget(this.rotAnim),this.rotAnim.set(0,0,0),this.moveTarget.eulerAngles=this.rotAnim,p(this.rotAnim).repeatForever(p(this.rotAnim).to(.4,{z:90},{easing:"backInOut"}).call((function(){t.checkCollistion(),g.playEffect(f.Hammer)})).to(.4,{z:0},{easing:"sineIn"})).start()},o.resetAnim=function(){this.isRuning=!1,c.stopAllByTarget(this.rotAnim)},o.updateAnim=function(t){this.moveTarget&&(this.moveTarget.eulerAngles=this.rotAnim)},o.updateCollider=function(t){},o.onCheckColliderCb=function(t){var e=m[this.trapType];for(var i in t)for(var n=t[i],r=0;r<n.length;r++){var o=n[r],a=d.getColilderByColId(o).targetCmp;if(a)a.byHit(e.atk)}},e}(A)).prototype,"trapType",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return h.TrapType.Spininess}}),H=e(z.prototype,"moveTarget",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=e(z.prototype,"root",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=z))||w));o._RF.pop()}}}));

System.register("chunks:///_virtual/HorizonTouch.ts",["cc","./EventManager.ts","./EventTypes.ts"],(function(t){"use strict";var s,i,h,o,c,n,e;return{setters:[function(t){s=t.cclegacy,i=t._decorator,h=t.clamp,o=t.v3,c=t.v2},function(t){n=t.default},function(t){e=t.EventTypes}],execute:function(){var u;s._RF.push({},"5f5baAgtD5P74dC775UHe9P","HorizonTouch",void 0);var r=i.ccclass;i.property,t("HorizonTouch",r("HorizonTouch")(u=function(){function t(t,s,i){this.ctrlPos=o(),this.touchDistX=0,this.curSpdX=0,this.minX=0,this.maxX=0,this.fitMinX=0,this.fitMaxX=0,this.spdX=70,this.isTouch=!1,this.isMoveFinished=!1,this.initPos=o(),this.tmpPos=o(),this.preDirec=c(0,0),this.preTouchPos=c(),this.prePos=o(),this.touchStartPos=c(),this.initPos.set(t),this.ctrlPos.set(t),this.minX=s,this.maxX=i,this.fitMaxX=i,this.fitMinX=s,this.onEvents()}var s=t.prototype;return s.onEvents=function(){n.on(e.TouchEvents.TouchStart,this.onTouchStart,this),n.on(e.TouchEvents.TouchMove,this.onTouchMove,this),n.on(e.TouchEvents.TouchEnd,this.onTouchEnd,this)},s.reset=function(){this.ctrlPos.set(this.initPos),this.touchDistX=0,this.curSpdX=0,this.isTouch=!1,this.isMoveFinished=!1},s.update=function(t){this.move(t),this.fixPos(t)},s.move=function(t){if(this.tmpPos.set(this.ctrlPos),this.tmpPos.x!=this.touchDistX&&!this.isMoveFinished){var s=this.touchDistX>this.tmpPos.x?1:-1,i=Math.abs(this.touchDistX-this.tmpPos.x)/3;i=h(i,.1,10),this.curSpdX=this.spdX*i;var o=this.curSpdX*s*t+this.tmpPos.x;(s>0&&o>this.touchDistX||s<0&&o<this.touchDistX)&&(o=this.touchDistX),this.tmpPos.x=h(o,this.minX,this.maxX)}this.ctrlPos.set(this.tmpPos),this.tmpPos.x==this.touchDistX&&(this.isMoveFinished=!0)},s.fixPos=function(t){if(!this.isTouch&&this.isMoveFinished){var s=h(this.ctrlPos.x,this.fitMinX,this.fitMaxX);this.ctrlPos.x+=.1*(s-this.ctrlPos.x)*60*t}},s.onTouchStart=function(t){this.isTouch=!0,this.prePos.set(this.ctrlPos),this.preTouchPos.set(t),this.preDirec.set(0),this.touchStartPos.set(t)},s.onTouchMove=function(t,s){this.isTouch=!0,this.isMoveFinished=!1;var i=s.x-this.touchStartPos.x;this.touchDistX=.02*i+this.prePos.x,this.touchDistX=h(this.touchDistX,this.minX,this.maxX),this.preTouchPos.set(s)},s.onTouchEnd=function(t,s){this.isTouch=!1},t}())||u);s._RF.pop()}}}));

System.register("chunks:///_virtual/InstanceFrameAnim.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BasicComponet.ts","./GlobalPool.ts"],(function(t){"use strict";var s,e,i,a,r,n,u,c,h,o,f,l;return{setters:[function(t){s=t.applyDecoratedDescriptor,e=t.inheritsLoose,i=t.initializerDefineProperty,a=t.assertThisInitialized},function(t){r=t.cclegacy,n=t._decorator,u=t.v3,c=t.v2,h=t.MeshRenderer,o=t.Vec3},function(t){f=t.BasicComponet},function(t){l=t.default}],execute:function(){var m,v,p,d,_,y,D;r._RF.push({},"0f04eeOiJxLrIc9KEeYXv9T","InstanceFrameAnim",void 0);var U=n.ccclass,x=n.property,b=n.executeInEditMode;t("InstanceFrameAnim",U("InstanceFrameAnim")(m=b((p=s((v=function(t){function s(){for(var s,e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(s=t.call.apply(t,[this].concat(r))||this).msr=null,i(s,"delayTime",p,a(s)),i(s,"uvRange",d,a(s)),i(s,"uvStepTime",_,a(s)),i(s,"isLoop",y,a(s)),i(s,"scale",D,a(s)),s.curPos=u(),s.scaleRate=1,s.curUvOffset=c(),s.curUvTime=0,s.curFrameIndex=1,s.curUvXCount=0,s.maxFrame=1,s.uvOffsetStep=c(),s.isFinish=!1,s.curt=0,s._transData1=[0,0,0,1],s._data1="transData1",s._transData2=[0,0,0,0],s._data2="transData2",s._transData3=[0,0,0,0],s._data3="transData3",s}e(s,t);var r=s.prototype;return r.onEnable=function(){},r.setData=function(t){this.curPos.set(t.p),this.scaleRate=t.s||1,this.msr=this.node.getComponent(h),this.node.setPosition(this.curPos),this.node.eulerAngles=o.ZERO,this.setUv(),this.setMat()},r.reset=function(){},r.update=function(t){this.updateUv(t),this.updateMat(t)},r.setUv=function(){this.curt=0,this.isFinish=!1,this.maxFrame=this.uvRange.x*this.uvRange.y,this.uvOffsetStep.set(1/this.uvRange.x,1/this.uvRange.y),this.curUvOffset.set(0,0),this.curUvXCount=0,this.curFrameIndex=1,this.curUvTime=0},r.updateUv=function(t){(this.curFrameIndex<this.maxFrame||this.curFrameIndex>=this.maxFrame&&this.isLoop)&&(this.curUvTime+=t,this.curUvTime>=this.uvStepTime&&(this.curUvTime=0,this.curFrameIndex++,this.curUvOffset.x+=this.uvOffsetStep.x,this.curUvOffset.x>=1&&(this.curUvOffset.x=0,this.curUvXCount++),this.curUvOffset.y=this.uvOffsetStep.y*this.curUvXCount,this.curUvOffset.y>=1&&(this.curUvOffset.y=0,this.curUvXCount=0))),this.curt+=t,this.curt>=this.delayTime&&(this.curt=0,this.isFinish=!0,l.put(this.node))},r.setMat=function(){this._transData1[0]=this.curPos.x,this._transData1[1]=this.curPos.y,this._transData1[2]=this.curPos.z,this._transData1[3]=this.scaleRate,this._transData2[0]=this.uvOffsetStep.x,this._transData2[1]=this.uvOffsetStep.y,this._transData2[2]=0,this._transData2[3]=0,this._transData3[0]=this.scale.x,this._transData3[1]=this.scale.y,this._transData3[2]=this.scale.z,this.msr&&this.msr.setInstancedAttribute(this._data1,this._transData1),this.msr&&this.msr.setInstancedAttribute(this._data3,this._transData3)},r.updateMat=function(t){this.msr&&(this._transData2[2]=this.curUvOffset.x,this._transData2[3]=this.curUvOffset.y,this.msr.setInstancedAttribute(this._data2,this._transData2))},s}(f)).prototype,"delayTime",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),d=s(v.prototype,"uvRange",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return c()}}),_=s(v.prototype,"uvStepTime",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.2}}),y=s(v.prototype,"isLoop",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),D=s(v.prototype,"scale",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return u(1,1,1)}}),m=v))||m)||m);r._RF.pop()}}}));

System.register("chunks:///_virtual/LandMine.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalConfig.ts","./GlobalEnum.ts","./EventManager.ts","./EventTypes.ts","./AudioEnum.ts","./AudioSystem.ts","./GlobalPool.ts","./CollisionManager.ts","./BasicProp.ts"],(function(t){"use strict";var e,i,o,n,r,s,l,c,a,u,p,f,d,h,g,y,C,b;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,o=t.initializerDefineProperty,n=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator,l=t.Enum,c=t.size},function(t){a=t.TrapCfg},function(t){u=t.GlobalEnum},function(t){p=t.default},function(t){f=t.EventTypes},function(t){d=t.AudioEnum},function(t){h=t.AudioSystem},function(t){g=t.default},function(t){y=t.ColliderGroup,C=t.CollisionManager},function(t){b=t.BasicProp}],execute:function(){var T,m,E,v,z,P;r._RF.push({},"24fberoPHNLoJWdQpNCwcqA","LandMine",void 0);var k=s.ccclass,L=s.property;t("LandMine",(T=k("LandMine"),m=L({type:l(u.TrapType)}),T((z=e((v=function(t){function e(){for(var e,i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,o(e,"trapType",z,n(e)),e.cldGroup=y.PlayerTrigger,o(e,"boomSize",P,n(e)),e.isTriggerUsed=!1,e}i(e,t);var r=e.prototype;return r.setData=function(e){t.prototype.setData.call(this,e)},r.reset=function(){this.resetCollider()},r.customUpdate=function(t){this.updateCollider(t)},r.customLateUpdate=function(t){this.lateUpdateCollider(t)},r.resetCollider=function(){this.isTriggerUsed=!1,t.prototype.resetCollider.call(this)},r.checkCollistion=function(){this.isTriggerUsed||this.collider&&this.collider.checkPosFast(this.pos,this.onTriggerEnter.bind(this))},r.updateCollider=function(t){this.checkCollistion(),this.isTriggerUsed&&g.put(this.node)},r.onTriggerEnter=function(){this.isTriggerUsed=!0,p.emit(f.EffectEvents.show3DTo2DEffect,{t:u.Effect3dType.Effect_jz_mine_boom,p:this.pos}),h.playEffect(d.boom),this.collider&&(this.collider.setRectSize(this.boomSize),this.collider.checkPosCollistion(this.pos,this.onCheckColliderCb.bind(this)))},r.onCheckColliderCb=function(t){var e=a[this.trapType];for(var i in t)for(var o=t[i],n=0;n<o.length;n++){var r=o[n],s=C.getColilderByColId(r).targetCmp;if(s)s.byHit(e.atk)}},e}(b)).prototype,"trapType",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return u.TrapType.Spininess}}),P=e(v.prototype,"boomSize",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return c()}}),E=v))||E));r._RF.pop()}}}));

System.register("chunks:///_virtual/LevelManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalTmpData.ts","./EventManager.ts","./EventTypes.ts","./StorageSystem.ts","./UIEnum.ts","./UISystem.ts","./EffectLayer.ts","./BasicMountLayer.ts","./MergeEffectLayer.ts","./RoleLayer.ts","./RoadLayer.ts","./CollisionManager.ts","./PropsLayer.ts","./GlobalPool.ts"],(function(e){"use strict";var t,s,a,n,i,r,o,u,c,h,m,y,f,l,L,p,v,d,G,g,R,_;return{setters:[function(e){t=e.applyDecoratedDescriptor,s=e.inheritsLoose,a=e.initializerDefineProperty,n=e.assertThisInitialized},function(e){i=e.cclegacy,r=e._decorator,o=e.Node,u=e.Component},function(e){c=e.GlobalTmpData},function(e){h=e.default},function(e){m=e.EventTypes},function(e){y=e.StorageSystem},function(e){f=e.UIEnum},function(e){l=e.UISystem},function(e){L=e.EffectLayer},function(e){p=e.BasicMountLayer},function(e){v=e.MergeEffectLayer},function(e){d=e.RoleLayer},function(e){G=e.RoadLayer},function(e){g=e.CollisionManager},function(e){R=e.PropsLayer},function(e){_=e.default}],execute:function(){var b,D,S,E,T,U,P;i._RF.push({},"a6023B5i2FORIquIsXBKntO","LevelManager",void 0);var C=r.ccclass,O=r.property;e("LevelManager",(b=C("LevelManager"),D=O(o),S=O(o),b((U=t((T=function(e){function t(){for(var t,s=arguments.length,i=new Array(s),r=0;r<s;r++)i[r]=arguments[r];return t=e.call.apply(e,[this].concat(i))||this,a(t,"layerNodeArr",U,n(t)),a(t,"perfabsLayer",P,n(t)),t._isPause=!1,t._isOver=!1,t._lvData=null,t._isRun=!1,t.mountLayers=[],t.customLayers=[],t}s(t,e);var i=t.prototype;return i.onLoad=function(){this.onEvents(),this.initLayers(),this.initCustomLayers()},i.onEvents=function(){h.on(m.GameEvents.GamePause,this.onGamePause,this),h.on(m.GameEvents.GameResume,this.onGameResume,this),h.on(m.GameEvents.GameRun,this.onGameRun,this),h.on(m.GameEvents.GameOver,this.onGameOver,this),h.on(m.GameEvents.SetGameTimeScale,this.onSetGameTimeScale,this),h.on(m.GameEvents.GameLoadFinish,this.onGameLoadFinish,this),h.on(m.TouchEvents.TouchStart,this.onTouchStart,this)},i.onEnable=function(){this.reset(),this.startRecord(),this.setData()},i.start=function(){},i.onDisable=function(){this.resetLayers(),this.resetCustomLayers()},i.reset=function(){this._isPause=!1,this._isOver=!1,this._isRun=!1,c.timeScale=1,c.reset(),this.resetLayers()},i.setData=function(){this._lvData=y.getLvData(),this.setLayersData(this._lvData),this.setCustomLayersData(this._lvData)},i.update=function(e){if(this.updateRunRecord(e),!this._isPause&&!this._isOver){this.updateGameRecord(e);var t=e*c.timeScale;this.updateLayers(t),this.updateCustomLayers(t)}},i.lateUpdate=function(e){if(!this._isPause&&!this._isOver){var t=e*c.timeScale;this.lateUpdateLayers(t),this.lateUpdateCustomLayers(t)}},i.startRecord=function(){c.Game.startTime=Date.now(),c.Game.totalTime=0,c.Game.endTime=0},i.updateRunRecord=function(e){c.Game.totalTime+=e},i.updateGameRecord=function(e){this._isOver||(c.Game.gameTime+=e)},i.stopRecord=function(){c.Game.endTime=Date.now()},i.initLayers=function(){for(var e=0;e<this.layerNodeArr.length;e++){var t=this.layerNodeArr[e].getComponent(p);this.mountLayers.push(t),t.initLayer()}},i.resetLayers=function(){for(var e=0;e<this.mountLayers.length;e++)this.mountLayers[e].reset()},i.setLayersData=function(e){for(var t=0;t<this.mountLayers.length;t++)this.mountLayers[t].setData(e)},i.updateLayers=function(e){for(var t=0;t<this.mountLayers.length;t++)this.mountLayers[t].customUpdate(e)},i.lateUpdateLayers=function(e){for(var t=0;t<this.mountLayers.length;t++)this.mountLayers[t].customLateUpdate(e)},i.initCustomLayers=function(){this.customLayers.push(new G(this.perfabsLayer)),this.customLayers.push(new R(this.perfabsLayer)),this.customLayers.push(new g(this.perfabsLayer)),this.customLayers.push(new L(this.perfabsLayer)),this.customLayers.push(new v(this.perfabsLayer)),this.customLayers.push(new d(this.perfabsLayer));for(var e=0;e<this.customLayers.length;e++)this.customLayers[e].initLayer()},i.resetCustomLayers=function(){for(var e=0;e<this.customLayers.length;e++)this.customLayers[e].reset();_.putAllChildren(this.perfabsLayer)},i.setCustomLayersData=function(e){for(var t=0;t<this.customLayers.length;t++)this.customLayers[t].setData(e)},i.updateCustomLayers=function(e){for(var t=0;t<this.customLayers.length;t++)this.customLayers[t].customUpdate(e)},i.lateUpdateCustomLayers=function(e){for(var t=0;t<this.customLayers.length;t++)this.customLayers[t].customLateUpdate(e)},i.runGame=function(){this._isRun||(this._isRun=!0)},i.onGameLoadFinish=function(){},i.onTouchStart=function(){},i.onGamePause=function(){this._isPause=!0,c.Game.isPause=!0},i.onGameResume=function(){this._isPause=!1,c.Game.isPause=!1},i.onSetGameTimeScale=function(e){void 0!==e&&(c.timeScale=e)},i.onGameOver=function(e){this._isOver||(c.Game.isGameOver=!0,this._isOver=!0,l.hideUI(f.FakeLevelAdUI),this.stopRecord())},i.onGameRun=function(){c.Game.isGameRun=!0,console.log("# Game Run #"),l.showUI(f.FakeLevelAdUI)},t}(u)).prototype,"layerNodeArr",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),P=t(T.prototype,"perfabsLayer",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=T))||E));i._RF.pop()}}}));

System.register("chunks:///_virtual/MergeBasic.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BasicComponet.ts"],(function(e){"use strict";var t,r,c,o;return{setters:[function(e){t=e.inheritsLoose},function(e){r=e.cclegacy,c=e._decorator},function(e){o=e.BasicComponet}],execute:function(){var n;r._RF.push({},"b5f549y/6xEpoUMJqvYU9w/","MergeBasic",void 0);var s=c.ccclass;c.property,e("MergeBasic",s("MergeBasic")(n=function(e){function r(){return e.apply(this,arguments)||this}return t(r,e),r.prototype.showEffect=function(e){return!0},r}(o))||n);r._RF.pop()}}}));

System.register("chunks:///_virtual/MergeBullet.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalEnum.ts","./MergeBasic.ts","./MergeMesh.ts","./BasicBullet.ts"],(function(e){"use strict";var t,i,s,n,r,a,l,c,o,h,f,u,p,m,d,g,y;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,s=e.initializerDefineProperty,n=e.assertThisInitialized},function(e){r=e.cclegacy,a=e._decorator,l=e.Enum,c=e.Mesh,o=e.MeshRenderer,h=e.utils,f=e.v4,u=e.v3,p=e.size},function(e){m=e.GlobalEnum},function(e){d=e.MergeBasic},function(e){g=e.MergeMesh},function(e){y=e.BasicBullet}],execute:function(){var b,_,M,v,A,R,w,E,T,z,F,B,x;r._RF.push({},"72632+6gCJE3JD050ETr+qn","MergeBullet",void 0);var H=a.ccclass,S=a.property;e("MergeBullet",(b=H("MergeBullet"),_=S({type:l(m.WeaponType)}),M=S({type:c,displayName:"合并模型"}),b(((x=function(e){function t(){for(var t,i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,s(t,"weaponType",R,n(t)),t.meshRenderer=null,t.max=110,s(t,"mergeMesh",w,n(t)),s(t,"animTime",E,n(t)),s(t,"initAngY",T,n(t)),s(t,"bulletSize",z,n(t)),s(t,"isCircleCollider",F,n(t)),s(t,"bulletScale",B,n(t)),t._pass=null,t._trans0Handle=0,t._trans0Arr=[],t._trans1Handle=0,t._trans1Arr=[],t.effectRecs=[],t.isAllFinish=!1,t}i(t,e);var r=t.prototype;return r.initSub=function(){this.meshRenderer=this.node.getComponent(o),t.meshRecs[this.weaponType]||(t.meshRecs[this.weaponType]=new g,t.meshRecs[this.weaponType].init(this.mergeMesh,this.max),console.log("init:",this.node.name)),this.meshRenderer.mesh=h.createMesh(t.meshRecs[this.weaponType].meshData),this.initMats(),this.initEffects()},r.onEvents=function(){},r.setData=function(e){this.setMat(),this.setEffects()},r.reset=function(){this.resetMat(),this.resetEffects()},r.customUpdate=function(e){this.updateEffects(e),this.updateMats(e)},r.customLateUpdate=function(e){this.lateUpdateEffects(e)},r.initMats=function(){this._pass=this.meshRenderer.getMaterialInstance(0).passes[0],this._trans0Handle=this._pass.getHandle("trans0"),this._trans1Handle=this._pass.getHandle("trans1");for(var e=0;e<this.max;e++)this._trans0Arr.push(f(0,0,0,0)),this._trans1Arr.push(f(0,0,0,0))},r.setMat=function(){this.reset()},r.resetMat=function(){for(var e=0;e<this.max;e++)this._trans0Arr[e].set(0,0,0,0),this._trans1Arr[e].set(0,0,0,0);this.applyTrans()},r.applyTrans=function(){this._pass&&(this._pass.setUniformArray(this._trans0Handle,this._trans0Arr),this._pass.setUniformArray(this._trans1Handle,this._trans1Arr))},r.updateMats=function(e){this.applyTrans()},r.initEffects=function(){for(var e=u(0,this.initAngY,0),t=0;t<this.max;t++){var i=new y(t,this.weaponType,e);i.init(),this.effectRecs.push(i)}},r.setEffects=function(){for(var e=0;e<this.effectRecs.length;e++){this.effectRecs[e].reset()}this.isAllFinish=!1},r.resetEffects=function(){for(var e=0;e<this.effectRecs.length;e++){this.effectRecs[e].reset()}this.isAllFinish=!1},r.updateEffects=function(e){if(this.isAllFinish)this.node.active=!1;else for(var t=0;t<this.effectRecs.length;t++){var i=this.effectRecs[t];!i.isFinish&&i.update(e),this._trans0Arr[i._index].set(i.pos.x,i.pos.y,i.pos.z,i.scale*i.activeNum),this._trans1Arr[i._index].set(i.rot.x,i.rot.y,i.rot.z,i.opacity),this.isAllFinish=this.isAllFinish&&i.isFinish}},r.lateUpdateEffects=function(e){if(!this.isAllFinish)for(var t=0;t<this.effectRecs.length;t++){this.effectRecs[t].lateUpdate(e)}},r.showEffect=function(e){for(var t=!1,i=0;i<this.effectRecs.length;i++){var s=this.effectRecs[i];if(s.isFinish){t=!0,s.setActive(e.pos,e.lineVec,e.rotSpd,e.atkRate,this.animTime,this.bulletSize,this.bulletScale,this.isCircleCollider),this.node.active=!0,this.isAllFinish=!1;break}}return t},t}(d)).meshRecs={},R=t((A=x).prototype,"weaponType",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),w=t(A.prototype,"mergeMesh",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=t(A.prototype,"animTime",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 3}}),T=t(A.prototype,"initAngY",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),z=t(A.prototype,"bulletSize",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return p()}}),F=t(A.prototype,"isCircleCollider",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),B=t(A.prototype,"bulletScale",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),v=A))||v));r._RF.pop()}}}));

System.register("chunks:///_virtual/MergeEffect.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalEnum.ts","./MergeBasic.ts","./MergeGroup.ts","./MergeMesh.ts"],(function(e){"use strict";var t,i,r,s,n,a,o,l,u,p,c,h,f,m,g,y,d,b,M;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,r=e.initializerDefineProperty,s=e.assertThisInitialized},function(e){n=e.cclegacy,a=e._decorator,o=e.Enum,l=e.Mesh,u=e.CCInteger,p=e.Vec2,c=e.MeshRenderer,h=e.utils,f=e.v4,m=e.v3},function(e){g=e.GlobalEnum},function(e){y=e.MergeBasic},function(e){d=e.PhyInitParam,b=e.MergeGroup},function(e){M=e.MergeMesh}],execute:function(){var v,_,R,A,F,S,w,z,E,N,P,T,D,x,H,I,G,U,B,C,k,q,L,V,j,J,Q,Y,K,O,W,X,Z,$,ee,te;n._RF.push({},"fe0edmsAa5PqYoyarJQ69q6","MergeEffect",void 0);var ie=a.ccclass,re=a.property;e("MergeEffect",(v=ie("MergeEffect"),_=re({type:o(g.MergeType)}),R=re({type:l,displayName:"合并模型",group:"合并参数"}),A=re({type:u,displayName:"单组数量",step:1,min:1,max:110,group:"合并参数"}),F=re({type:u,displayName:"动画时长",step:.1,group:"合并参数"}),S=re({type:p,displayName:"初始UV偏移"}),w=re({group:"物理参数"}),z=re({group:"物理参数"}),E=re({group:"物理参数"}),N=re({group:"物理参数",displayName:"角速度"}),P=re({group:"物理参数",displayName:"角度浮动"}),T=re({group:"物理参数",displayName:"角度衰减"}),D=re({group:"物理参数"}),x=re({group:"物理参数"}),H=re({group:"物理参数"}),I=re({group:"透明参数"}),G=re({group:"透明参数"}),v(((te=function(e){function t(){for(var t,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return t=e.call.apply(e,[this].concat(n))||this,r(t,"mergeType",C,s(t)),t.meshRenderer=null,t.max=110,r(t,"mergeMesh",k,s(t)),r(t,"groupNum",q,s(t)),r(t,"animTime",L,s(t)),r(t,"uvArr",V,s(t)),r(t,"lineSpd",j,s(t)),r(t,"lineFloat",J,s(t)),r(t,"lineDamping",Q,s(t)),r(t,"rotSpd",Y,s(t)),r(t,"rotFloat",K,s(t)),r(t,"rotDamping",O,s(t)),r(t,"initScale",W,s(t)),r(t,"scaleFloat",X,s(t)),r(t,"scaleSpd",Z,s(t)),r(t,"opacity",$,s(t)),r(t,"opacitySpd",ee,s(t)),t.curParam=null,t._pass=null,t._trans0Handle=0,t._trans0Arr=[],t._trans1Handle=0,t._trans1Arr=[],t.effectRecs=[],t.isAllFinish=!1,t}i(t,e);var n=t.prototype;return n.initSub=function(){this.meshRenderer=this.node.getComponent(c),t.meshRecs[this.mergeType]||(t.meshRecs[this.mergeType]=new M,t.meshRecs[this.mergeType].init(this.mergeMesh,this.max,this.uvArr),console.log("init:",this.node.name)),this.meshRenderer.mesh=h.createMesh(t.meshRecs[this.mergeType].meshData),this.initMats(),this.initPhyParams(),this.initEffects()},n.onEvents=function(){},n.setData=function(e){this.setMat(),this.setEffects()},n.reset=function(){this.resetMat(),this.resetEffects(),this.resetParams()},n.customUpdate=function(e){this.updateEffects(e),this.updateMats(e)},n.initPhyParams=function(){if(t.paramRecs[this.node.name])this.curParam=t.paramRecs[this.node.name];else{var e=new d;e.lineSpd.set(this.lineSpd),e.lineFloat.set(this.lineFloat),e.lineDamping.set(this.lineDamping),e.rotSpd.set(this.rotSpd),e.rotFloat.set(this.rotFloat),e.rotDamping.set(this.rotDamping),e.initScale=this.initScale,e.scaleFloat=this.scaleFloat,e.scaleSpd=this.scaleSpd,e.opacity=this.opacity,e.opacitySpd=this.opacitySpd,e.delayTime=this.animTime,t.paramRecs[this.node.name]=e,this.curParam=e}},n.resetParams=function(){},n.initMats=function(){this._pass=this.meshRenderer.getMaterialInstance(0).passes[0],this._trans0Handle=this._pass.getHandle("trans0"),this._trans1Handle=this._pass.getHandle("trans1");for(var e=0;e<this.max;e++)this._trans0Arr.push(f(0,0,0,0)),this._trans1Arr.push(f(0,0,0,0))},n.setMat=function(){this.resetMat()},n.resetMat=function(){for(var e=0;e<this.max;e++)this._trans0Arr[e].set(0,0,0,0),this._trans1Arr[e].set(0,0,0,0);this.applyTrans()},n.applyTrans=function(){this._pass&&(this._pass.setUniformArray(this._trans0Handle,this._trans0Arr),this._pass.setUniformArray(this._trans1Handle,this._trans1Arr))},n.updateMats=function(e){this.applyTrans()},n.initEffects=function(){this.groupNum=Math.floor(this.groupNum);for(var e=Math.floor(this.max/this.groupNum),t=0,i=0,r=0;r<e;r++){t=this.groupNum*r,i=this.groupNum*(r+1)-1;var s=new b(t,i,this.curParam);s.init(),this.effectRecs.push(s)}},n.setEffects=function(){for(var e=0;e<this.effectRecs.length;e++){this.effectRecs[e].reset()}this.isAllFinish=!1},n.resetEffects=function(){for(var e=0;e<this.effectRecs.length;e++){this.effectRecs[e].reset()}this.isAllFinish=!1},n.updateEffects=function(e){if(this.isAllFinish)this.node.active=!1;else for(var t=0;t<this.effectRecs.length;t++){var i=this.effectRecs[t];i.update(e);for(var r=i.startIndex,s=0;r<=i.endIndex;r++,s++){var n=i.items[s];this._trans0Arr[r].set(n.pos.x,n.pos.y,n.pos.z,n.scale*n.activeNum),this._trans1Arr[r].set(n.rot.x,n.rot.y,n.rot.z,n.opacity)}this.isAllFinish=this.isAllFinish&&i.isFinish}},n.showEffect=function(e){for(var t=!1,i=0;i<this.effectRecs.length;i++){var r=this.effectRecs[i];if(r.isFinish){t=!0,r.setActive(!0,e.p),this.node.active=!0,this.isAllFinish=!1;break}}return t},t}(y)).meshRecs={},te.paramRecs={},C=t((B=te).prototype,"mergeType",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),k=t(B.prototype,"mergeMesh",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=t(B.prototype,"groupNum",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),L=t(B.prototype,"animTime",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 2}}),V=t(B.prototype,"uvArr",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),j=t(B.prototype,"lineSpd",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return m()}}),J=t(B.prototype,"lineFloat",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return m()}}),Q=t(B.prototype,"lineDamping",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return m()}}),Y=t(B.prototype,"rotSpd",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return m()}}),K=t(B.prototype,"rotFloat",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return m()}}),O=t(B.prototype,"rotDamping",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return m()}}),W=t(B.prototype,"initScale",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),X=t(B.prototype,"scaleFloat",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Z=t(B.prototype,"scaleSpd",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),$=t(B.prototype,"opacity",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),ee=t(B.prototype,"opacitySpd",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),U=B))||U));n._RF.pop()}}}));

System.register("chunks:///_virtual/MergeEffectLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalEnum.ts","./EventTypes.ts","./GlobalPool.ts","./BasicLayer.ts","./MergeBasic.ts"],(function(e){"use strict";var t,s,r,f,n,a,i,o,c;return{setters:[function(e){t=e.inheritsLoose},function(e){s=e.cclegacy,r=e._decorator,f=e.v3},function(e){n=e.GlobalEnum},function(e){a=e.EventTypes},function(e){i=e.default},function(e){o=e.BasicLayer},function(e){c=e.MergeBasic}],execute:function(){var l;s._RF.push({},"ca62fnerRZKH4P9VSVa8nK/","MergeEffectLayer",void 0);var g=r.ccclass;r.property,e("MergeEffectLayer",g("MergeEffectLayer")(l=function(e){function s(){for(var t,s=arguments.length,r=new Array(s),a=0;a<s;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this).allMergeEffects={},t.initMergeTypes=[n.MergeEffectType.MergeShadow,n.MergeEffectType.MergePistolBullet,n.MergeEffectType.MergeRocketSmook,n.MergeEffectType.MergeRoleDeath],t._testT=0,t.testCD=1,t.testFrameNum=1,t.testRange=f(5,0,5),t}t(s,e);var r=s.prototype;return r.init=function(){for(var e=0;e<this.initMergeTypes.length;e++){var t=this.initMergeTypes[e];if(!this.allMergeEffects[t]){this.allMergeEffects[t]=[];var s=i.get(t);s.parent=this.node,s.position.set(0,0,0);var r=s.getComponent(c);this.allMergeEffects[t].push(r)}}},r.onEvents=function(){this.on(a.EffectEvents.showMergeEffect,this.onShowMergeEffect,this)},r.setData=function(e){},r.reset=function(){for(var e in this.allMergeEffects){for(var t=this.allMergeEffects[e],s=0;s<t.length;s++)i.put(t[s].node),t[s].reset();delete this.allMergeEffects[e]}this.allMergeEffects={}},r.customUpdate=function(e){for(var t in this.allMergeEffects)for(var s=this.allMergeEffects[t],r=0;r<s.length;r++)s[r].customUpdate(e)},r.customLateUpdate=function(e){for(var t in this.allMergeEffects)for(var s=this.allMergeEffects[t],r=0;r<s.length;r++)s[r].customLateUpdate(e)},r.onShowMergeEffect=function(e,t){var s=!1;this.allMergeEffects[e]||(this.allMergeEffects[e]=[]);for(var r=0;r<this.allMergeEffects[e].length;r++){if(this.allMergeEffects[e][r].showEffect(t)){s=!0;break}}if(!s){var f=i.get(e);f.parent=this.node,f.position.set(0,0,0);var n=f.getComponent(c);n.showEffect(t),this.allMergeEffects[e].push(n)}},r.testUpdate=function(e){if(this._testT+=e,this._testT>=this.testCD){this._testT=0;for(var t=f(),s=0;s<this.testFrameNum;s++)t.x=(2*Math.random()-1)*this.testRange.x,t.y=(2*Math.random()-1)*this.testRange.y,t.z=(2*Math.random()-1)*this.testRange.z,this.onShowMergeEffect(n.MergeEffectType.MergeFrameAnim,{p:t})}},s}(o))||l);s._RF.pop()}}}));

System.register("chunks:///_virtual/MergeFrameAnim.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalEnum.ts","./Tools.ts","./MergeBasic.ts","./MergeFrameGroup.ts","./MergeGroup.ts","./MergeMesh.ts"],(function(e){"use strict";var t,i,r,s,n,a,o,l,u,p,c,h,f,m,g,y,b,d,v,F,_,A;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,r=e.initializerDefineProperty,s=e.assertThisInitialized},function(e){n=e.cclegacy,a=e._decorator,o=e.Enum,l=e.Mesh,u=e.CCInteger,p=e.CCFloat,c=e.v2,h=e.MeshRenderer,f=e.utils,m=e.v4,g=e.v3,y=e.color},function(e){b=e.GlobalEnum},function(e){d=e.default},function(e){v=e.MergeBasic},function(e){F=e.MergeFrameGroup},function(e){_=e.PhyInitParam},function(e){A=e.MergeMesh}],execute:function(){var R,S,M,w,z,x,T,H,C,E,O,D,N,L,P,U,G,I,B,k,X,j,q,Z,J,K,Q,V,W,Y,$,ee,te,ie,re,se,ne,ae,oe,le,ue,pe,ce,he,fe,me,ge,ye;n._RF.push({},"4ee78xLeo5GoqACZseFeava","MergeFrameAnim",void 0);var be=a.ccclass,de=a.property;e("MergeFrameAnim",(R=be("MergeFrameAnim"),S=de({type:o(b.MergeType)}),M=de({type:l,displayName:"合并模型",group:"合并参数"}),w=de({type:u,displayName:"单组数量",step:1,min:1,max:55,group:"合并参数"}),z=de({type:u,displayName:"动画时长",step:.1,group:"合并参数"}),x=de({group:"物理参数"}),T=de({group:"物理参数"}),H=de({group:"物理参数"}),C=de({group:"物理参数"}),E=de({group:"物理参数"}),O=de({group:"物理参数"}),D=de({group:"物理参数"}),N=de({group:"物理参数"}),L=de({group:"物理参数"}),P=de({group:"颜色"}),U=de({group:"颜色"}),G=de({group:"颜色"}),I=de({group:"颜色"}),B=de({type:p,group:"颜色"}),k=de({group:"颜色"}),X=de({group:"帧动画",displayName:"贴图排列"}),j=de({group:"帧动画",displayName:"播放间隔"}),q=de({group:"帧动画",displayName:"是否循环"}),R(((ye=function(e){function t(){for(var t,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return t=e.call.apply(e,[this].concat(n))||this,r(t,"mergeType",K,s(t)),t.meshRenderer=null,t.max=55,r(t,"mergeMesh",Q,s(t)),r(t,"groupNum",V,s(t)),r(t,"animTime",W,s(t)),r(t,"lineSpd",Y,s(t)),r(t,"lineFloat",$,s(t)),r(t,"lineDamping",ee,s(t)),r(t,"rotSpd",te,s(t)),r(t,"rotFloat",ie,s(t)),r(t,"rotDamping",re,s(t)),r(t,"initScale",se,s(t)),r(t,"scaleFloat",ne,s(t)),r(t,"scaleSpd",ae,s(t)),r(t,"opacity",oe,s(t)),r(t,"opacitySpd",le,s(t)),r(t,"initColor",ue,s(t)),r(t,"toColor",pe,s(t)),r(t,"colorSpdRate",ce,s(t)),r(t,"colorLoop",he,s(t)),t.uvArr=[],t.initUvOffset=c(),t.uvOffsetMax=c(1,1),r(t,"uvRange",fe,s(t)),t.uvOffsetStep=c(),r(t,"uvStepTime",me,s(t)),r(t,"uvLoop",ge,s(t)),t.maxFrame=10,t._pass=null,t._trans0Handle=0,t._trans0Arr=[],t._trans1Handle=0,t._trans1Arr=[],t._trans2Handle=0,t._trans2Arr=[],t._trans3Handle=0,t._trans3Arr=[],t.effectRecs=[],t.isAllFinish=!1,t}i(t,e);var n=t.prototype;return n.initSub=function(){this.meshRenderer=this.node.getComponent(h),t.meshRecs[this.mergeType]||(t.meshRecs[this.mergeType]=new A,t.meshRecs[this.mergeType].init(this.mergeMesh,this.max,this.uvArr),console.log("init:",this.node.name)),this.meshRenderer.mesh=f.createMesh(t.meshRecs[this.mergeType].meshData),this.initMats(),this.initPhyParams(),this.initEffects()},n.onEvents=function(){},n.setData=function(e){this.setMat(),this.setEffects()},n.reset=function(){this.resetMat(),this.resetEffects()},n.customUpdate=function(e){this.updateEffects(e),this.updateMats(e)},n.initPhyParams=function(){if(!t.paramRecs[this.mergeType]){var e=new _;e.lineSpd.set(this.lineSpd),e.lineFloat.set(this.lineFloat),e.lineDamping.set(this.lineDamping),e.rotSpd.set(this.rotSpd),e.rotFloat.set(this.rotFloat),e.rotDamping.set(this.rotDamping),e.initScale=this.initScale,e.scaleFloat=this.scaleFloat,e.scaleSpd=this.scaleSpd,e.opacity=this.opacity,e.opacitySpd=this.opacitySpd,e.delayTime=this.animTime,this.maxFrame=this.uvRange.x*this.uvRange.y,this.uvOffsetStep.set(1/this.uvRange.x,1/this.uvRange.y),e.initUvOffset.set(-this.uvOffsetStep.x,-this.uvOffsetStep.y),e.uvOffsetMax.set(this.uvOffsetMax),e.uvOffsetStep.set(this.uvOffsetStep),e.uvStepTime=this.uvStepTime,e.uvLoop=this.uvLoop,e.maxFrame=this.maxFrame,d.getColorRate(this.initColor,e.initColor),d.getColorRate(this.toColor,e.toColor),e.colorSpd=this.colorSpdRate,e.coloLoop=this.colorLoop,t.paramRecs[this.mergeType]=e}},n.initMats=function(){var e=this.meshRenderer.getMaterialInstance(0),t=m(1/this.uvRange.x,1/this.uvRange.y,0,0);e.setProperty("tilingOffset",t),this._pass=e.passes[0],this._trans0Handle=this._pass.getHandle("trans0"),this._trans1Handle=this._pass.getHandle("trans1"),this._trans2Handle=this._pass.getHandle("trans2"),this._trans3Handle=this._pass.getHandle("trans3");for(var i=0;i<this.max;i++)this._trans0Arr.push(m(0,0,0,0)),this._trans1Arr.push(m(0,0,0,0)),this._trans2Arr.push(m(0,0,0,0)),this._trans3Arr.push(m(0,0,0,0))},n.setMat=function(){this.reset()},n.resetMat=function(){for(var e=0;e<this.max;e++)this._trans0Arr[e].set(0,0,0,0),this._trans1Arr[e].set(0,0,0,0),this._trans2Arr[e].set(0,0,0,0),this._trans3Arr[e].set(0,0,0,0);this.applyTrans()},n.applyTrans=function(){this._pass&&(this._pass.setUniformArray(this._trans0Handle,this._trans0Arr),this._pass.setUniformArray(this._trans1Handle,this._trans1Arr),this._pass.setUniformArray(this._trans2Handle,this._trans2Arr),this._pass.setUniformArray(this._trans3Handle,this._trans3Arr))},n.updateMats=function(e){this.applyTrans()},n.initEffects=function(){for(var e=Math.floor(this.max/this.groupNum),i=0,r=0,s=0;s<e;s++){i=this.groupNum*s,r=this.groupNum*(s+1)-1;var n=new F(i,r,t.paramRecs[this.mergeType]);n.init(),this.effectRecs.push(n)}},n.setEffects=function(){for(var e=0;e<this.effectRecs.length;e++){this.effectRecs[e].reset()}this.isAllFinish=!1},n.resetEffects=function(){for(var e=0;e<this.effectRecs.length;e++){this.effectRecs[e].reset()}this.isAllFinish=!1},n.updateEffects=function(e){if(this.isAllFinish)this.node.active=!1;else for(var t=0;t<this.effectRecs.length;t++){var i=this.effectRecs[t];i.update(e);for(var r=i.startIndex,s=0;r<=i.endIndex;r++,s++){var n=i.items[s];this._trans0Arr[r].set(n.pos.x,n.pos.y,n.pos.z,n.scale*n.activeNum),this._trans1Arr[r].set(n.rot.x,n.rot.y,n.rot.z,n.opacity),this._trans2Arr[r].set(n.curUvOffset.x,n.curUvOffset.y,0,0),this._trans3Arr[r].set(n.curColor)}this.isAllFinish=this.isAllFinish&&i.isFinish}},n.showEffect=function(e){for(var t=!1,i=0;i<this.effectRecs.length;i++){var r=this.effectRecs[i];if(r.isFinish){t=!0,r.setActive(!0,e),this.node.active=!0,this.isAllFinish=!1;break}}return t},t}(v)).meshRecs={},ye.paramRecs={},K=t((J=ye).prototype,"mergeType",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Q=t(J.prototype,"mergeMesh",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=t(J.prototype,"groupNum",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),W=t(J.prototype,"animTime",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 2}}),Y=t(J.prototype,"lineSpd",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return g()}}),$=t(J.prototype,"lineFloat",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return g()}}),ee=t(J.prototype,"lineDamping",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return g()}}),te=t(J.prototype,"rotSpd",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return g()}}),ie=t(J.prototype,"rotFloat",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return g()}}),re=t(J.prototype,"rotDamping",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return g()}}),se=t(J.prototype,"initScale",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),ne=t(J.prototype,"scaleFloat",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),ae=t(J.prototype,"scaleSpd",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),oe=t(J.prototype,"opacity",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),le=t(J.prototype,"opacitySpd",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),ue=t(J.prototype,"initColor",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return y().fromHEX("#FFFFFF")}}),pe=t(J.prototype,"toColor",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return y().fromHEX("#FFFFFF")}}),ce=t(J.prototype,"colorSpdRate",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.5}}),he=t(J.prototype,"colorLoop",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),fe=t(J.prototype,"uvRange",[X],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return c()}}),me=t(J.prototype,"uvStepTime",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.1}}),ge=t(J.prototype,"uvLoop",[q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Z=J))||Z));n._RF.pop()}}}));

System.register("chunks:///_virtual/MergeFrameGroup.ts",["cc","./MergeGroup.ts"],(function(t){"use strict";var i,s,e,a,h,r,o,p;return{setters:[function(t){i=t.cclegacy,s=t._decorator,e=t.v3,a=t.v2,h=t.v4,r=t.clamp01,o=t.Vec4},function(t){p=t.PhyParam}],execute:function(){var c;i._RF.push({},"747887kmLFOL47BFlWCQLV7","MergeFrameGroup",void 0);var n=s.ccclass,m=(s.property,function(){function t(t,i){this.index=0,this.isFinish=!0,this.lineSpd=e(),this.rotSpd=e(),this.scaleSpd=0,this.opacitySpd=0,this.pos=e(),this.rot=e(),this.scale=0,this.opacity=0,this.activeNum=0,this.curUvOffset=a(),this.curUvTime=0,this.curFrameIndex=1,this.curUvXCount=0,this.curColor=h(),this.colMixRate=0,this.param=null,this.curt=0,this.tmpP=e(),this.tmpR=e(),this.tmpC1=h(),this.tmpC2=h(),this.param=i,this.index=t}var i=t.prototype;return i.init=function(){this.reset()},i.reset=function(){this.lineSpd.set(this.param.lineSpd),this.rotSpd.set(this.param.rotSpd),this.scaleSpd=this.param.scaleSpd,this.opacitySpd=this.param.opacitySpd,this.pos.set(0,0,0),this.rot.set(0,0,0),this.curUvOffset.set(this.param.initUvOffset),this.curColor.set(this.param.initColor),this.scale=0,this.opacity=0,this.isFinish=!0,this.curt=0,this.curUvTime=0,this.curFrameIndex=1,this.colMixRate=0,this.curUvXCount=0},i.setActive=function(t,i){this.reset(),this.activeNum=t?1:0,this.pos.set(i),this.isFinish=!1,this.scale=this.param.initScale,this.opacity=this.param.opacity},i.update=function(t){this.calParam(t)},i.calParam=function(t){this.isFinish||(this.tmpP.set(this.param.lineDamping).multiplyScalar(t),this.lineSpd.add(this.tmpP),this.tmpP.set(this.lineSpd).multiplyScalar(t),this.pos.add(this.tmpP),this.tmpR.set(this.param.rotDamping).multiplyScalar(t),this.rotSpd.add(this.tmpR),this.tmpR.set(this.rotSpd).multiplyScalar(t),this.rot.add(this.tmpR),this.scale+=this.scaleSpd*t*this.activeNum,this.scale=this.scale<0?0:this.scale,this.opacity=r(this.opacity+this.opacitySpd*t),this.curt+=t,this.curt>=this.param.delayTime&&(this.isFinish=!0),(this.curFrameIndex<this.param.maxFrame||this.curFrameIndex>=this.param.maxFrame&&this.param.uvLoop)&&(this.curUvTime+=t,this.curUvTime>=this.param.uvStepTime&&(this.curUvTime=0,this.curFrameIndex++,this.curUvOffset.x+=this.param.uvOffsetStep.x,this.curUvOffset.x>=this.param.uvOffsetMax.x&&(this.curUvOffset.x=0,this.curUvXCount++),this.curUvOffset.y=this.param.uvOffsetStep.y*this.curUvXCount,this.curUvOffset.y>=this.param.uvOffsetMax.y&&(this.curUvOffset.y=0,this.curUvXCount=0))),this.colMixRate+=this.param.colorSpd*t,this.colMixRate>1&&(this.colMixRate=this.param.coloLoop?0:1),this.tmpC1.set(this.param.initColor).multiplyScalar(1-this.colMixRate),this.tmpC2.set(this.param.toColor).multiplyScalar(this.colMixRate),o.add(this.curColor,this.tmpC1,this.tmpC2))},t}());t("MergeFrameGroup",n("MergeFrameGroup")(c=function(){function t(t,i,s){this.startIndex=0,this.endIndex=0,this.items=[],this.initParam=null,this.isFinish=!0,this.startIndex=t,this.endIndex=i,this.initParam=s;for(var e=this.startIndex;e<=this.endIndex;e++){var a=e,h=this.getPhyParam(s),r=new m(a,h);this.items.push(r)}}var i=t.prototype;return i.getPhyParam=function(t){var i=e(t.lineFloat).multiplyScalar(.5),s=e(t.rotFloat).multiplyScalar(.5),a=.5*t.scaleFloat,h=new p;return h.lineSpd.x=t.lineSpd.x+(2*Math.random()-1)*i.x,h.lineSpd.y=t.lineSpd.y+(2*Math.random()-1)*i.y,h.lineSpd.z=t.lineSpd.z+(2*Math.random()-1)*i.z,h.lineDamping.set(t.lineDamping),h.rotSpd.x=t.rotSpd.x+(2*Math.random()-1)*s.x,h.rotSpd.y=t.rotSpd.y+(2*Math.random()-1)*s.y,h.rotSpd.z=t.rotSpd.z+(2*Math.random()-1)*s.z,h.initScale=t.initScale+(2*Math.random()-1)*a,h.scaleSpd=t.scaleSpd,h.opacity=t.opacity,h.opacitySpd=t.opacitySpd,h.delayTime=t.delayTime,h.uvOffsetMax.set(t.uvOffsetMax),h.uvOffsetStep.set(t.uvOffsetStep),h.uvStepTime=t.uvStepTime,h.initUvOffset.set(t.initUvOffset),h.uvLoop=t.uvLoop,h.maxFrame=t.maxFrame,h.colorSpd=t.colorSpd,h.initColor.set(t.initColor),h.toColor.set(t.toColor),h.coloLoop=t.coloLoop,h},i.setActive=function(t,i){this.isFinish=!1;for(var s=0;s<this.items.length;s++){this.items[s].setActive(t,i)}},i.init=function(){for(var t=0;t<this.items.length;t++){this.items[t].init()}},i.reset=function(){this.isFinish=!0;for(var t=0;t<this.items.length;t++){this.items[t].reset()}},i.update=function(t){for(var i=!0,s=0;s<this.items.length;s++){var e=this.items[s];e.update(t),i=i&&e.isFinish}this.isFinish=i,this.isFinish&&this.reset()},t}())||c);i._RF.pop()}}}));

System.register("chunks:///_virtual/MergeGroup.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var i,s,a,h,e,n,r;return{setters:[function(t){i=t.inheritsLoose},function(t){s=t.cclegacy,a=t._decorator,h=t.v3,e=t.v2,n=t.v4,r=t.clamp01}],execute:function(){var p;s._RF.push({},"b9bc7zLcUhJ1alb9LGWRokX","MergeGroup",void 0);var o=a.ccclass,c=(a.property,function(){function t(t,i){this.index=0,this.isFinish=!0,this.lineSpd=h(),this.rotSpd=h(),this.scaleSpd=0,this.opacitySpd=0,this.pos=h(),this.rot=h(),this.scale=0,this.opacity=0,this.activeNum=0,this.param=null,this.curt=0,this.tmpP=h(),this.tmpR=h(),this.param=i,this.index=t}var i=t.prototype;return i.init=function(){this.reset()},i.reset=function(){this.lineSpd.set(this.param.lineSpd),this.rotSpd.set(this.param.rotSpd),this.scaleSpd=this.param.scaleSpd,this.opacitySpd=this.param.opacitySpd,this.pos.set(0,0,0),this.rot.set(0,0,0),this.scale=0,this.opacity=0,this.isFinish=!0,this.curt=0},i.setActive=function(t,i){this.reset(),this.activeNum=t?1:0,this.pos.set(i),this.isFinish=!1,this.scale=this.param.initScale,this.opacity=this.param.opacity},i.update=function(t){this.calParam(t)},i.calParam=function(t){this.isFinish||(this.tmpP.set(this.param.lineDamping).multiplyScalar(t),this.lineSpd.add(this.tmpP),this.tmpP.set(this.lineSpd).multiplyScalar(t),this.pos.add(this.tmpP),this.tmpR.set(this.param.rotDamping).multiplyScalar(t),this.rotSpd.add(this.tmpR),this.tmpR.set(this.rotSpd).multiplyScalar(t),this.rot.add(this.tmpR),this.scale+=this.scaleSpd*t*this.activeNum,this.scale=this.scale<0?0:this.scale,this.opacity=r(this.opacity+this.opacitySpd*t),this.curt+=t,this.curt>=this.param.delayTime&&(this.isFinish=!0))},t}()),l=(t("MergeGroup",o("MergeGroup")(p=function(){function t(t,i,s){this.startIndex=0,this.endIndex=0,this.items=[],this.initParam=null,this.isFinish=!0,this.startIndex=t,this.endIndex=i,this.initParam=s;for(var a=this.startIndex;a<=this.endIndex;a++){var h=a,e=this.getPhyParam(s),n=new c(h,e);this.items.push(n)}}var i=t.prototype;return i.getPhyParam=function(t){var i=h(t.lineFloat).multiplyScalar(.5),s=h(t.rotFloat).multiplyScalar(.5),a=.5*t.scaleFloat,e=new l;return e.lineSpd.x=t.lineSpd.x+(2*Math.random()-1)*i.x,e.lineSpd.y=t.lineSpd.y+(2*Math.random()-1)*i.y,e.lineSpd.z=t.lineSpd.z+(2*Math.random()-1)*i.z,e.lineDamping.set(t.lineDamping),e.rotSpd.x=t.rotSpd.x+(2*Math.random()-1)*s.x,e.rotSpd.y=t.rotSpd.y+(2*Math.random()-1)*s.y,e.rotSpd.z=t.rotSpd.z+(2*Math.random()-1)*s.z,e.initScale=t.initScale+(2*Math.random()-1)*a,e.scaleSpd=t.scaleSpd,e.opacity=t.opacity,e.opacitySpd=t.opacitySpd,e.delayTime=t.delayTime,e},i.setActive=function(t,i){this.isFinish=!1;for(var s=0;s<this.items.length;s++){this.items[s].setActive(t,i)}},i.init=function(){for(var t=0;t<this.items.length;t++){this.items[t].init()}},i.reset=function(){this.isFinish=!0;for(var t=0;t<this.items.length;t++){this.items[t].reset()}},i.update=function(t){for(var i=!0,s=0;s<this.items.length;s++){var a=this.items[s];a.update(t),i=i&&a.isFinish}this.isFinish=i,this.isFinish&&this.reset()},t}())||p),t("PhyParam",(function(){this.lineSpd=h(),this.lineDamping=h(),this.rotSpd=h(),this.rotDamping=h(),this.initScale=1,this.scaleSpd=0,this.opacity=1,this.opacitySpd=0,this.delayTime=0,this.initUvOffset=e(),this.uvOffsetMax=e(),this.uvOffsetStep=e(),this.uvStepTime=.1,this.uvLoop=!1,this.maxFrame=1,this.initColor=n(),this.toColor=n(),this.colorSpd=.5,this.coloLoop=!1})));t("PhyInitParam",function(t){function s(){var i;return(i=t.call(this)||this).ParamId=0,i.lineFloat=h(),i.rotFloat=h(),i.scaleFloat=0,i.ParamId=s._PhyInitParamId++,i}return i(s,t),s}(l))._PhyInitParamId=0,s._RF.pop()}}}));

System.register("chunks:///_virtual/MergeMesh.ts",["cc","./MergeUtils.ts"],(function(t){"use strict";var s,e,i,r,a;return{setters:[function(t){s=t.cclegacy,e=t._decorator,i=t.v2,r=t.gfx},function(t){a=t.MergeUtils}],execute:function(){var h;s._RF.push({},"0233dV92BZD37gEcBDzI7AR","MergeMesh",void 0);var n=e.ccclass;e.property,t("MergeMesh",n("MergeMesh")(h=function(){function t(){this.meshData=null,this.subMesh=null,this.mergeCount=1,this.uvOffsetArr=[]}var s=t.prototype;return s.init=function(t,s,e){this.meshData||(this.subMesh=t,this.mergeCount=s,this.uvOffsetArr=e||[i(0,0)],this.initMeshData(),this.mergeMeshData())},s.initMeshData=function(){this.meshData={positions:[],normals:[],uvs:[],indices:[],customAttributes:[{attr:{name:"a_animData0",format:r.Format.RGBA32F,isNormalized:!1,stream:0,isInstanced:!1,location:0},values:[]}]}},s.mergeMeshData=function(){for(var t=a.getRiginalMeshData(this.subMesh),s=i(0,0),e=0;e<this.mergeCount;e++){var r=t.positions.length/3,h=this.meshData.positions.length/3;a.copyArr(this.meshData.positions,t.positions),a.copyArr(this.meshData.normals,t.normals),a.copyArr(this.meshData.uvs,t.uvs);for(var n=0,o=t.indices.length;n<o;++n)this.meshData.indices.push(t.indices[n]+h);if(this.uvOffsetArr.length>0){var u=this.uvOffsetArr[Math.floor(Math.random()*this.uvOffsetArr.length)]||s;s.set(u)}for(var c=this.meshData.customAttributes[0].values,m=0;m<r;++m)c.push(s.x,s.y,0,e)}},t}())||h);s._RF.pop()}}}));

System.register("chunks:///_virtual/MergeShadow.ts",["./rollupPluginModLoBabelHelpers.js","cc","./MergeBasic.ts","./MergeMesh.ts"],(function(t){"use strict";var e,s,i,n,a,r,h,c,f,o,l,u;return{setters:[function(t){e=t.applyDecoratedDescriptor,s=t.inheritsLoose,i=t.initializerDefineProperty,n=t.assertThisInitialized},function(t){a=t.cclegacy,r=t._decorator,h=t.Mesh,c=t.MeshRenderer,f=t.utils,o=t.v4},function(t){l=t.MergeBasic},function(t){u=t.MergeMesh}],execute:function(){var p,m,d,v,M,g;a._RF.push({},"eed2biGiV9PorCo4SXKVhQA","MergeShadow",void 0);var _=r.ccclass,A=r.property,y=(t("MergeShadow",(p=_("MergeShadow"),m=A({type:h,displayName:"合并模型"}),p(((g=function(t){function e(){for(var e,s=arguments.length,a=new Array(s),r=0;r<s;r++)a[r]=arguments[r];return(e=t.call.apply(t,[this].concat(a))||this).meshRenderer=null,e.max=110,i(e,"mergeMesh",M,n(e)),e._pass=null,e._trans0Handle=0,e._trans0Arr=[],e.effectRecs=[],e.isAllFinish=!1,e}s(e,t);var a=e.prototype;return a.initSub=function(){this.meshRenderer=this.node.getComponent(c),e.meshData||(e.meshData=new u,e.meshData.init(this.mergeMesh,this.max),console.log("init:",this.node.name)),this.meshRenderer.mesh=f.createMesh(e.meshData.meshData),this.initMats(),this.initEffects()},a.onEvents=function(){},a.setData=function(t){this.setMat(),this.setEffects()},a.reset=function(){this.resetMat(),this.resetEffects()},a.customUpdate=function(t){this.updateEffects(t),this.updateMats(t)},a.customLateUpdate=function(t){this.lateUpdateEffects(t)},a.initMats=function(){this._pass=this.meshRenderer.getMaterialInstance(0).passes[0],this._trans0Handle=this._pass.getHandle("trans0");for(var t=0;t<this.max;t++)this._trans0Arr.push(o(0,0,0,0))},a.setMat=function(){this.reset()},a.resetMat=function(){for(var t=0;t<this.max;t++)this._trans0Arr[t].set(0,0,0,0);this.applyTrans()},a.applyTrans=function(){this._pass&&this._pass.setUniformArray(this._trans0Handle,this._trans0Arr)},a.updateMats=function(t){this.applyTrans()},a.initEffects=function(){for(var t=0;t<this.max;t++){var e=new y(t);e.init(),this.effectRecs.push(e)}},a.setEffects=function(){for(var t=0;t<this.effectRecs.length;t++){this.effectRecs[t].reset()}this.isAllFinish=!1},a.resetEffects=function(){for(var t=0;t<this.effectRecs.length;t++){this.effectRecs[t].reset()}this.isAllFinish=!1},a.updateEffects=function(t){if(this.isAllFinish)this.node.active=!1;else{this.isAllFinish=!0;for(var e=0;e<this.effectRecs.length;e++){var s=this.effectRecs[e];s.param?(this.isAllFinish=!1,this._trans0Arr[s._index].set(s.param.pos.x,s.param.pos.y+.1,s.param.pos.z,s.scale*s.activeNum),s.param.isShow||s.reset()):this._trans0Arr[s._index].set(0,0,0,0)}}},a.lateUpdateEffects=function(t){},a.showEffect=function(t){for(var e=!1,s=0;s<this.effectRecs.length;s++){var i=this.effectRecs[s];if(!i.param){e=!0,i.setActive(t),this.node.active=!0,this.isAllFinish=!1;break}}return e},e}(l)).meshData=null,M=e((v=g).prototype,"mergeMesh",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),d=v))||d)),t("ShadowItem",function(){function t(t){this._index=0,this.scale=0,this.activeNum=0,this.param=null,this._index=t}var e=t.prototype;return e.init=function(){},e.setActive=function(t){this.scale=t.scale,this.activeNum=1,this.param=t},e.reset=function(){this.activeNum=0,this.param=null},t}()));a._RF.pop()}}}));

System.register("chunks:///_virtual/MergeUtils.ts",["cc"],(function(t){"use strict";var e,r,i;return{setters:[function(t){e=t.cclegacy,r=t._decorator,i=t.gfx}],execute:function(){var s;e._RF.push({},"74fc2HBDwxLmJx838PY42bp","MergeUtils",void 0);var a=r.ccclass;r.property,t("MergeUtils",a("MergeUtils")(s=function(){function t(){}return t.getRiginalMeshData=function(t,e){void 0===e&&(e=!1);var r={};return r.positions=t.readAttribute(0,i.AttributeName.ATTR_POSITION),r.normals=t.readAttribute(0,i.AttributeName.ATTR_NORMAL),r.tangents=t.readAttribute(0,i.AttributeName.ATTR_TANGENT),r.uvs=t.readAttribute(0,i.AttributeName.ATTR_TEX_COORD),r.colors=t.readAttribute(0,i.AttributeName.ATTR_COLOR),r.indices=t.readIndices(0),e&&(this.rotatePos(r.positions),this.rotatePos(r.normals),this.rotatePos(r.tangents)),r},t.copyArr=function(t,e){for(var r=0,i=e.length;r<i;++r)t.push(e[r])},t.rotatePos=function(t){for(var e=t.length/3,r=0;r<e;++r){var i=3*r+1,s=t[i];t[i]=t[i+1],t[i+1]=-s}},t}())||s);e._RF.pop()}}}));

System.register("chunks:///_virtual/ModifyPosRotMesh.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var s,o,n,r,e;return{setters:[function(t){s=t.inheritsLoose},function(t){o=t.cclegacy,n=t._decorator,r=t.MeshRenderer,e=t.Component}],execute:function(){var i;o._RF.push({},"9071c4e2TJOWaiJaOIM4/Xm","ModifyPosRotMesh",void 0);var a=n.ccclass;n.property,t("ModifyPosRotMesh",a("ModifyPosRotMesh")(i=function(t){function o(){for(var s,o=arguments.length,n=new Array(o),r=0;r<o;r++)n[r]=arguments[r];return(s=t.call.apply(t,[this].concat(n))||this).msr=null,s.transPos=[0,0,0,0],s._transPos="a_transPos",s.transRot=[0,0,0,0],s._transRot="a_transRot",s}s(o,t);var n=o.prototype;return n.onLoad=function(){this.msr=this.node.getComponent(r),this.msr.mesh&&(delete this.msr.mesh.struct.maxPosition,delete this.msr.mesh.struct.minPosition),this.msr.shadowCastingMode=0},n.setData=function(){},n.setTransData=function(t,s,o){this.msr&&(this.transPos[0]=t.x,this.transPos[1]=t.y,this.transPos[2]=t.z,this.transPos[3]=o,this.transRot[0]=s.x,this.transRot[1]=s.y,this.transRot[2]=s.z,this.msr.setInstancedAttribute(this._transPos,this.transPos),this.msr.setInstancedAttribute(this._transRot,this.transRot))},o}(e))||i);o._RF.pop()}}}));

System.register("chunks:///_virtual/Panels.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalConfig.ts","./GlobalEnum.ts","./GlobalTmpData.ts","./EventTypes.ts","./BasicCollider.ts","./CollisionManager.ts","./BasicProp.ts"],(function(e){"use strict";var t,i,s,n,o,r,l,a,c,h,p,u,d,m,b,y,f,g,v,P,T,M,A;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,s=e.initializerDefineProperty,n=e.assertThisInitialized},function(e){o=e.cclegacy,r=e._decorator,l=e.Enum,a=e.Node,c=e.MeshRenderer,h=e.v4,p=e.v3,u=e.v2,d=e.Tween,m=e.tween,b=e.Vec3,y=e.Intersection2D},function(e){f=e.GlobalConfig},function(e){g=e.GlobalEnum},function(e){v=e.GlobalTmpData},function(e){P=e.EventTypes},function(e){T=e.BasicCollider},function(e){M=e.ColliderGroup},function(e){A=e.BasicProp}],execute:function(){var C,_,w,I,z,D,R,U,E,L,G,x,S;o._RF.push({},"b87a5V6XLxDZJ+FFTrrambX","Panels",void 0);var B=r.ccclass,H=r.property;e("Panels",(C=B("Panels"),_=H({type:l(g.TrapType)}),w=H(a),I=H(a),z=H(c),D=H(c),C((E=t((U=function(e){function t(){for(var t,i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return(t=e.call.apply(e,[this].concat(o))||this).cldGroup=M.PlayerTrigger,s(t,"trapType",E,n(t)),t._panelId=0,t._isMove=!1,s(t,"red",L,n(t)),s(t,"blue",G,n(t)),s(t,"symbolMsr",x,n(t)),s(t,"labelMsr",S,n(t)),t.symbolType=void 0,t.symbolCfg={"+":g.IncreaseType.symbol_Add,"-":g.IncreaseType.symbol_Reduce,x:g.IncreaseType.symbol_Multip,"/":g.IncreaseType.symbol_Division},t.symbolUvZ={"+":0,"-":.25,x:.5,"/":.75},t.num=0,t.tmpV4=h(),t.pos=p(),t._isAnim=!1,t.tmpP=p(),t.isTriggerUsed=!1,t.checkRadius=f.Player.checkRadius,t.tmpP2=u(),t}i(t,e);var o=t.prototype;return o.onEvents=function(){this.on(P.CurLevelEvents.HideIncreaceProp,this.onHidePanel,this)},o.initSub=function(){this.initAnim(),this.initLabel()},o.setData=function(t){e.prototype.setData.call(this,t),this.initAnim(),this.setLabel(t),this._panelId=t.id,this._isMove=t.isMove},o.reset=function(){this.resetAnim(),this.resetLabel(),e.prototype.reset.call(this)},o.customUpdate=function(t){e.prototype.customUpdate.call(this,t),this.updateAnim(t)},o.initLabel=function(){},o.setLabel=function(e){this.blue.active="+"==e.symbol||"x"==e.symbol,this.red.active="-"==e.symbol||"/"==e.symbol,this.symbolType=this.symbolCfg[e.symbol],this.num=e.num;var t=this.symbolMsr.getMaterialInstance(0),i=t.passes[0].getHandle("tilingOffset");this.tmpV4.set(.25,1,this.symbolUvZ[e.symbol],0),t.passes[0].setUniform(i,this.tmpV4);var s,n,o=e.num.toFixed(0);(s=+o[0],this.labelMsr[0].getMaterialInstance(0).setProperty("tilingOffset",h(.1,1,.1*s,0)),this.labelMsr[1].node.active=!1,o.length>1)&&(this.labelMsr[1].node.active=!0,n=+o[1],this.labelMsr[1].getMaterialInstance(0).setProperty("tilingOffset",h(.1,1,.1*n,0)))},o.resetLabel=function(){},o.initAnim=function(){this._isAnim=!1,this.pos.set(this.node.position)},o.resetAnim=function(){this._isAnim=!1},o.updateAnim=function(e){},o.showMoveDownAnim=function(){var e=this;this._isAnim||(this._isAnim=!0,d.stopAllByTarget(this.pos),m(this.pos).to(.5,{y:-3},{onUpdate:function(){e.node&&e.node.setPosition(e.pos)}}).start())},o.setCollider=function(){this.pos.set(this.node.worldPosition),this.collider=new T(this.cldGroup,this,!0),this.tmpP.set(this.cldSize.width,0,this.cldSize.height),b.rotateY(this.tmpP,this.tmpP,b.ZERO,.01745*this.node.eulerAngles.y),this.cldSize.set(Math.abs(this.tmpP.x),Math.abs(this.tmpP.z)),this.collider.setRectSize(this.cldSize),this.collider.setRectPos(this.pos),this.collider.updateGridInfo(!0),this.collider.isCircleCollider=this.isCircleCollider},o.resetCollider=function(){e.prototype.resetCollider.call(this),this.isTriggerUsed=!1},o.checkCollistion=function(){!this.isTriggerUsed&&this.collider&&(this.tmpP.set(v.Player.wpos).add(v.Player.offset),this.tmpP2.set(this.tmpP.x,this.tmpP.z),y.rectCircle(this.collider.selfRect,this.tmpP2,this.checkRadius)&&this.onTriggerEnter())},o.onTriggerEnter=function(){this.isTriggerUsed||(this.isTriggerUsed=!0,this.showMoveDownAnim(),this.emit(P.RoleEvents.AddRoles,this.symbolType,this.num),this.emit(P.CurLevelEvents.HideIncreaceProp,this._panelId))},o.onHidePanel=function(e){e!=this._panelId||this.isTriggerUsed||(this.isTriggerUsed=!0,this.showMoveDownAnim())},t}(A)).prototype,"trapType",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return g.TrapType.Increase}}),L=t(U.prototype,"red",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=t(U.prototype,"blue",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=t(U.prototype,"symbolMsr",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=t(U.prototype,"labelMsr",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),R=U))||R));o._RF.pop()}}}));

System.register("chunks:///_virtual/PathBasic.ts",["cc","./GlobalConfig.ts","./GlobalEnum.ts","./GlobalTmpData.ts","./EventManager.ts","./EventTypes.ts","./GlobalPool.ts","./Tools.ts","./BasicCollider.ts","./CollisionManager.ts","./PropsLayer.ts"],(function(t){"use strict";var e,i,r,s,o,a,n,h,l,c,p,d,u,m,f,P,g,v;return{setters:[function(t){e=t.cclegacy,i=t._decorator,r=t.MeshRenderer,s=t.v3,o=t.size,a=t.rect,n=t.quat},function(t){h=t.GlobalConfig,l=t.TrapCfg},function(t){c=t.GlobalEnum},function(t){p=t.GlobalTmpData},function(t){d=t.default},function(t){u=t.EventTypes},function(t){m=t.default},function(t){f=t.default},function(t){P=t.BasicCollider},function(t){g=t.ColliderGroup},function(t){v=t.PropsLayer}],execute:function(){var y;e._RF.push({},"3debcrZn+9KIZ7dl7bPkisu","PathBasic",void 0);var C=i.ccclass;i.property,t("PathBasic",C("PathBasic")(y=function(){function t(t,e,i,r){this.node=null,this.pathIndex=0,this.pathNode=null,this.decorate=null,this.enemy=null,this.bornPos=null,this.trigger=null,this.propPos=null,this.roadArr=[],this.turnArr=[],this.turnBArr=[],this.turnCArr=[],this.enemyData=null,this.propData=null,this.tmpP=s(),this.cldArr=[],this.cldVSize=o(.3,10),this.cldHSize=o(10,.3),this.cldBoxSize=o(10,10),this.tmpRect=a(),this.tmpQuat=n(),this.tmpR=s(),this.roadCw=4.625,this.isCreateEnemy=!1,this.curTriggerSize=s(1,1),this.isUsed=!1,this.node=e,this.enemyData=i,this.propData=r,this.pathIndex=t,this.pathNode=this.node.getChildByName("path"),this.decorate=this.node.getChildByName("decorate"),this.propPos=this.node.getChildByName("prop"),this.enemy=this.node.getChildByName("enemy"),this.bornPos=this.enemy.getChildByName("bornPos"),this.trigger=this.enemy.getChildByName("trigger");for(var h=0;h<this.node.children.length;h++){var l=this.node.children[h];switch(l.name){case"road":this.roadArr.push(l);break;case"turn":this.turnArr.push(l);break;case"turnB":this.turnBArr.push(l);break;case"turnC":this.turnCArr.push(l)}}}var e=t.prototype;return e.init=function(){},e.reset=function(){this.resetColliders(),f.clearObj(this)},e.update=function(t){this.checkTrigger()},e.getStopPos=function(t){t.set(this.pathNode.children[this.pathNode.children.length-1].worldPosition)},e.getMinMaxPos=function(t,e){for(var i=0;i<this.node.children.length;i++){var s=this.node.children[i];if(s.getComponent(r)){var o=s.worldPosition,a=o.x-12,n=o.x+12,h=o.z-12,l=o.z+12;t.x=Math.min(t.x,a),t.z=Math.min(t.z,h),e.x=Math.max(e.x,n),e.z=Math.max(e.z,l)}}},e.createColliders=function(){this.createDecrateCollider()},e.resetColliders=function(){for(var t=0;t<this.cldArr.length;t++){var e=this.cldArr[t];e&&(e.clearGridInfo(),e.removeFromManager())}this.cldArr=[]},e.createDecrateCollider=function(){for(var t=0;t<this.decorate.children.length;t++){var e=this.decorate.children[t];this.tmpP.set(e.worldPosition);var i=new P(g.Barrier,this,!1);i.setRectSize(this.cldBoxSize),i.setRectPos(this.tmpP),i.updateGridInfo(!0),this.showTestCld(this.tmpP,this.cldBoxSize)}},e.showTestCld=function(t,e){if(h.ShowDebugCld){var i=m.get("testCld");i.parent=this.node.parent,i.setPosition(t),i.setScale(e.x,.5,e.y)}},e.createTriggers=function(){if(this.isCreateEnemy=!!this.enemyData,this.isUsed=!1,this.isCreateEnemy&&h.ShowDebugCld){var t=m.get("testTrigger");t.setWorldPosition(this.trigger.worldPosition),t.setScale(this.curTriggerSize.x,2,this.curTriggerSize.y),t.parent=this.node.parent}},e.checkTrigger=function(){this.isCreateEnemy&&!this.isUsed&&(this.tmpP.set(p.Player.wpos).subtract(this.trigger.worldPosition),this.tmpP.lengthSqr()<2&&(this.createEnemys(),this.isUsed=!0))},e.createEnemys=function(){var t=this;if(!this.isUsed&&this.isCreateEnemy&&this.enemyData)for(var e=0;e<this.enemyData.length;e++)for(var i=this.enemyData[e].split(","),r=i[0],o=i[1],a=+i[2],n=+i[3],h=0;h<r.length;h++){var l=+r[h];if(this.bornPos.children[l])for(var c=function(e){var i=[];t.bornPos.children[l].children.forEach((function(t){i.push(s(t.worldPosition))}));var r=+o[e],h=Math.floor(Math.random()*(n-a)+a),c={type:r,count:h=h<0?0:h,initPathIndex:t.pathIndex,initPath:i};d.emit(u.EnemyEvents.CreateEnemys,c)},p=0;p<o.length;p++)c(p)}},e.createProps=function(){if(this.propData){var t=this.propData[0],e={p:this.propPos.worldPosition,r:this.propPos.worldRotation,d:void 0},i=9,r=0;switch(t){case c.PropType.Weapon:var o=this.propData[3].length,a=this.propData[3];r=i/(o+1);for(var n=v._weaponID++,h=0;h<o;h++)this.tmpP.set((h+1)*r-i/2),this.tmpP.transformMat4(this.propPos.worldMatrix),e.p.set(this.tmpP),e.d={weaponType:+a[h],weaponId:n},d.emit(u.CurLevelEvents.CreateProps,"WeaponProp",e);break;case c.PropType.Trap:var p=this.propData[1],m=l[p].perfab,f=this.propData[2]||1;e.d=this.propData[3],l[p].isMuilty||(f=1),r=(i=9)/(f+1);for(var P=0;P<f;P++)this.tmpP.set((P+1)*r-i/2),this.tmpP.transformMat4(this.propPos.worldMatrix),e.p.set(this.tmpP),d.emit(u.CurLevelEvents.CreateProps,m,e);break;case c.PropType.Increase:var g=v._IncreaceID++,y=this.propData[1],C=this.propData[2],w=!(0==this.propData[3]||y&&C),D=s(-2.25,0,0),b=s(2.25,0,0);y&&(D.transformMat4(this.node.worldMatrix),e.p.set(D),this.showIncreaceProp(y,w,g,e)),C&&(b.transformMat4(this.node.worldMatrix),e.p.set(b),this.showIncreaceProp(C,w,g,e))}}},e.showIncreaceProp=function(t,e,i,r){var s=t[0],o=t,a=+(o=o.slice(1,o.length));r.id=i,r.isMove=e,r.symbol=s,r.num=a,d.emit(u.CurLevelEvents.CreateProps,"Panels",r)},t}())||y);e._RF.pop()}}}));

System.register("chunks:///_virtual/PistolBullet.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var e,o,n,r;return{setters:[function(t){e=t.inheritsLoose},function(t){o=t.cclegacy,n=t._decorator,r=t.Component}],execute:function(){var u;o._RF.push({},"7c4754EaIxFP7XH9d00H/N1","PistolBullet",void 0);var s=n.ccclass;n.property,t("PistolBullet",s("PistolBullet")(u=function(t){function o(){return t.apply(this,arguments)||this}e(o,t);var n=o.prototype;return n.start=function(){},n.update=function(t){},o}(r))||u);o._RF.pop()}}}));

System.register("chunks:///_virtual/PropsLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalConfig.ts","./GlobalEnum.ts","./GlobalTmpData.ts","./EventTypes.ts","./StorageSystem.ts","./GlobalPool.ts","./BasicLayer.ts","./BasicProp.ts","./Drone.ts"],(function(t){"use strict";var e,o,n,s,r,a,i,l,p,c,u,h,f,d,D;return{setters:[function(t){e=t.inheritsLoose},function(t){o=t.cclegacy,n=t._decorator,s=t.v2,r=t.v3,a=t.Vec3},function(t){i=t.GlobalConfig},function(t){l=t.GlobalEnum},function(t){p=t.GlobalTmpData},function(t){c=t.EventTypes},function(t){u=t.StorageSystem},function(t){h=t.default},function(t){f=t.BasicLayer},function(t){d=t.BasicProp},function(t){D=t.Drone}],execute:function(){var P,v;o._RF.push({},"1547dDOG1lDv6TzPL+VORX8","PropsLayer",void 0);var _=n.ccclass;n.property,t("PropsLayer",_("PropsLayer")(((v=function(t){function o(){for(var e,o=arguments.length,n=new Array(o),a=0;a<o;a++)n[a]=arguments[a];return(e=t.call.apply(t,[this].concat(n))||this)._allProps={},e.propSize=s(15,15),e._allDrones={},e._droneCount=0,e.tmpP=r(),e}e(o,t);var n=o.prototype;return n.init=function(){},n.onEvents=function(){this.on(c.CurLevelEvents.CreateProps,this.onCreateProps,this),this.on(c.CurLevelEvents.CreateDrones,this.onCreateDrones,this)},n.setData=function(t){o._IncreaceID=0,o._weaponID=0,this.setDrones()},n.reset=function(){this.resetProps(),this.resetDrones()},n.customUpdate=function(t){this.updateProps(t),this.updateDrones(t)},n.customLateUpdate=function(t){this.lateUpdateProps(t),this.lateUpdateDrones(t)},n.resetProps=function(){for(var t in this._allProps){this._allProps[t].reset()}this._allProps={}},n.createProp=function(t,e){e.parent=this.node;var o=h.get(t,e),n=o.getComponent(d);this._allProps[o.uuid]=n},n.updateProps=function(t){var e=p.Player.wpos,o=.5*this.propSize.x+.5*i.RunPropSize.x,n=.5*this.propSize.y+.5*i.RunPropSize.y;for(var s in this._allProps){var r=this._allProps[s];r&&r.node.active?Math.abs(e.x-r.node.worldPosition.x)<=o&&Math.abs(e.z-r.node.worldPosition.z)<=n?(r.show(),r.customUpdate(t)):r.hide():delete this._allProps[s]}},n.lateUpdateProps=function(t){for(var e in this._allProps){var o=this._allProps[e];o&&o.node.active?o.customLateUpdate(t):delete this._allProps[e]}},n.setDrones=function(){u.getData().userAssets.unlockGoods.indexOf(l.WeaponType.Drone)>=0&&this.createDrone()},n.resetDrones=function(){for(var t in this._allDrones){this._allDrones[t].reset()}this._allDrones={},this._droneCount=0},n.createDrone=function(){var t=h.get("Drone");t.parent=this.node,t.setPosition(a.ZERO),t.eulerAngles=a.ZERO;var e=new D(t);e.init(),this._allDrones[t.uuid]=e,this._droneCount++;var o=10/(this._droneCount+1),n=0;for(var s in this._allDrones){this._allDrones[s].offsetX=(n+1)*o-5,n++}1==this._droneCount&&(e.offsetX=-3)},n.updateDrones=function(t){for(var e in this._allDrones){var o=this._allDrones[e];o&&o.node.active?o.customUpdate(t):delete this._allDrones[e]}},n.lateUpdateDrones=function(t){},n.onCreateProps=function(t,e){this.createProp(t,e)},n.onCreateDrones=function(){this.createDrone()},o}(f))._IncreaceID=0,v._weaponID=0,P=v))||P);o._RF.pop()}}}));

System.register("chunks:///_virtual/RoadLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalClass.ts","./GlobalConfig.ts","./GlobalTmpData.ts","./EventTypes.ts","./GlobalPool.ts","./BasicLayer.ts","./PathBasic.ts"],(function(t){"use strict";var a,e,i,n,o,l,r,s,h,u,c,d,p,g;return{setters:[function(t){a=t.inheritsLoose},function(t){e=t.cclegacy,i=t._decorator,n=t.v3,o=t.quat,l=t.Vec3,r=t.v2},function(t){s=t.PathInfo},function(t){h=t.GlobalConfig},function(t){u=t.GlobalTmpData},function(t){c=t.EventTypes},function(t){d=t.default},function(t){p=t.BasicLayer},function(t){g=t.PathBasic}],execute:function(){var f;e._RF.push({},"88e6bjOBWRIyoH2b4JSnTlc","RoadLayer",void 0);var P=i.ccclass;i.property,t("RoadLayer",P("RoadLayer")(f=function(t){function e(){for(var a,e=arguments.length,i=new Array(e),o=0;o<e;o++)i[o]=arguments[o];return(a=t.call.apply(t,[this].concat(i))||this).tmpP=n(),a.tmpR=n(),a.allPathRec=null,a.allBuilding=null,a.buildingSize=r(12,12),a._normalBuiding=["Decorate_A","Decorate_B","Decorate_C"],a._turnBuiding="Decorate_Turning",a}a(e,t);var i=e.prototype;return i.init=function(){},i.onEvents=function(){},i.setData=function(t){this.setPath(t)},i.reset=function(){this.resetPath()},i.customUpdate=function(t){this.updatePath(t)},i.customLateUpdate=function(t){},i.setPath=function(t){this.allPathRec=[],this.allBuilding=[],u.PathInfo=[];for(var a=n(999999,0,999999),e=n(-999999,0,-999999),i=n(),r=0;r<t.path.length;r++){var h=t.path[r],p=d.get(h);p.parent=this.node,p.setWorldPosition(i);var f=new g(r,p,t.enemy[r],t.prop[r]);f.init(),f.getStopPos(i),this.allPathRec.push(f);var P=new s;P.n=h,P.p.set(p.worldPosition);for(var v=0;v<f.pathNode.children.length;v++){var B=f.pathNode.children[v];P.path.push(n(B.worldPosition))}u.PathInfo.push(P);for(var R=0;R<f.decorate.children.length;R++){var y=f.decorate.children[R];this.allBuilding.push({pos:n(y.worldPosition),rot:o(y.worldRotation),name:y.name,node:null})}f.getMinMaxPos(a,e)}l.subtract(u.MapSize,e,a),l.round(u.MapSize,u.MapSize),this.emit(c.GridMapEvents.CreateMapData,u.MapSize),console.log("# mapSize:",u.MapSize);for(var b=0;b<this.allPathRec.length;b++){var m=this.allPathRec[b];m.createColliders(),m.createTriggers(),m.createProps()}},i.resetPath=function(){for(var t=0;t<this.allPathRec.length;t++){this.allPathRec[t].reset()}this.allPathRec=null;for(var a=0;a<this.allBuilding.length;a++){var e=this.allBuilding[a];e.pos=null,e.node=null}this.allBuilding=null},i.updatePath=function(t){for(var a=0;a<this.allPathRec.length;a++){var e=this.allPathRec[a];e&&e.update(t)}this.showBuilding()},i.showBuilding=function(){for(var t=u.Player.wpos,a=.5*this.buildingSize.x+.5*h.VisibleSize.x,e=.5*this.buildingSize.y+.5*h.VisibleSize.y,i=0;i<this.allBuilding.length;i++){var n=this.allBuilding[i];if(Math.abs(t.x-n.pos.x)<=a&&Math.abs(t.z-n.pos.z)<=e){if(!n.node){var o=void 0;switch(n.name){case"Decorate":o=this._normalBuiding[Math.floor(Math.random()*this._normalBuiding.length)];break;case"Decorate_Turning":o=this._turnBuiding}n.node=d.get(o),n.node.parent=this.node,n.node.setWorldPosition(n.pos),n.node.setWorldRotation(n.rot)}}else d.put(n.node),n.node=null}},e}(p))||f);e._RF.pop()}}}));

System.register("chunks:///_virtual/Rocket.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalConfig.ts","./GlobalEnum.ts","./EventTypes.ts","./AudioEnum.ts","./AudioSystem.ts","./GlobalPool.ts","./CollisionManager.ts","./BasicProp.ts"],(function(t){"use strict";var i,e,o,s,n,r,c,l,a,h,u,p,f,d,k,m,g,y;return{setters:[function(t){i=t.applyDecoratedDescriptor,e=t.inheritsLoose,o=t.initializerDefineProperty,s=t.assertThisInitialized},function(t){n=t.cclegacy,r=t._decorator,c=t.Enum,l=t.Node,a=t.v3,h=t.size},function(t){u=t.TrapCfg},function(t){p=t.GlobalEnum},function(t){f=t.EventTypes},function(t){d=t.AudioEnum},function(t){k=t.AudioSystem},function(t){m=t.default},function(t){g=t.CollisionManager},function(t){y=t.BasicProp}],execute:function(){var b,P,_,C,T,E,v,R;n._RF.push({},"e363endlshO/JDE9YxdSaBu","Rocket",void 0);var A=r.ccclass,S=r.property;t("Rocket",(b=A("Rocket"),P=S({type:c(p.TrapType)}),_=S(l),b((E=i((T=function(t){function i(){for(var i,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return i=t.call.apply(t,[this].concat(n))||this,o(i,"trapType",E,s(i)),o(i,"rocket",v,s(i)),i.initRoketPos=a(),i._roketPos=a(),i._lineVec=a(),i._isRun=!1,i._g=-10,i.tmpP=a(),i.smookData={p:a()},o(i,"boomSize",R,s(i)),i.isTriggerUsed=!1,i}e(i,t);var n=i.prototype;return n.initSub=function(){this.initAnim()},n.setData=function(i){t.prototype.setData.call(this,i)},n.reset=function(){this.resetAnim(),this.resetCollider()},n.customUpdate=function(t){this.updateCollider(t),this.updateAnim(t)},n.customLateUpdate=function(t){this.lateUpdateCollider(t)},n.initAnim=function(){this.rocket.active=!1,this.initRoketPos.set(0,10,0)},n.showAnim=function(){this.rocket.active=!0,this._lineVec.set(0,-10,0),this._roketPos.set(this.initRoketPos),this.rocket.setPosition(this._roketPos),this._isRun=!0},n.resetAnim=function(){this.rocket.active=!1,this._isRun=!1,this.rocket.setPosition(this.initRoketPos)},n.updateAnim=function(t){this._isRun&&(this._lineVec.y+=this._g*t,this.tmpP.set(this._lineVec).multiplyScalar(t),this._roketPos.add(this.tmpP),this.rocket.setPosition(this._roketPos),this.smookData.p.set(this.rocket.children[0].worldPosition),this.emit(f.EffectEvents.showMergeEffect,p.MergeEffectType.MergeRocketSmook,this.smookData),this._roketPos.y<0&&(this._isRun=!1,this.emit(f.EffectEvents.show3DTo2DEffect,{t:p.Effect3dType.Effect_jz_rocketboom,p:this.pos}),this.checkCollistion(),k.playEffect(d.boom),m.put(this.node)))},n.resetCollider=function(){this.isTriggerUsed=!1,t.prototype.resetCollider.call(this)},n.checkTrigger=function(){this.isTriggerUsed||this.collider&&this.collider.checkPosFast(this.pos,this.onTriggerEnter.bind(this))},n.checkCollistion=function(){this.collider&&(this.collider.setRectSize(this.boomSize),this.collider.checkPosCollistion(this.pos,this.onCheckColliderCb.bind(this)))},n.updateCollider=function(t){this.checkTrigger()},n.onTriggerEnter=function(){this.isTriggerUsed=!0,this.showAnim()},n.onCheckColliderCb=function(t){var i=u[this.trapType];for(var e in t)for(var o=t[e],s=0;s<o.length;s++){var n=o[s],r=g.getColilderByColId(n).targetCmp;if(r)r.byHit(i.atk)}},i}(y)).prototype,"trapType",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return p.TrapType.Spininess}}),v=i(T.prototype,"rocket",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=i(T.prototype,"boomSize",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return h()}}),C=T))||C));n._RF.pop()}}}));

System.register("chunks:///_virtual/Role.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalConfig.ts","./GlobalEnum.ts","./GlobalTmpData.ts","./EventManager.ts","./EventTypes.ts","./Tools.ts","./BasicModifyMesh.ts","./BasicCollider.ts","./CollisionManager.ts","./BasicRole.ts","./RoleAnim.ts","./RoleHand.ts","./RoleStates.ts"],(function(t){"use strict";var i,s,e,a,o,h,n,r,c,l,u,d,p,f,R,m,_,S,P,y,v,k,C,D,V,w,M;return{setters:[function(t){i=t.inheritsLoose},function(t){s=t.cclegacy,e=t._decorator,a=t.size,o=t.Vec3,h=t.v3},function(t){n=t.GlobalConfig,r=t.WeaponCfg},function(t){c=t.GlobalEnum},function(t){l=t.GlobalTmpData},function(t){u=t.default},function(t){d=t.EventTypes},function(t){p=t.default},function(t){f=t.BasicModifyMesh},function(t){R=t.BasicCollider},function(t){m=t.ColliderGroup,_=t.CollisionManager},function(t){S=t.BasicRole},function(t){P=t.RoleAnim},function(t){y=t.RoleHand},function(t){v=t.RoleStateType,k=t.RoleIdleState,C=t.RoleMoveState,D=t.RolePassState,V=t.RoleDeathState,w=t.RoleStandShootState,M=t.RoleWinState}],execute:function(){var Y;s._RF.push({},"35d46EUJ/5A0p4Fm4Jgd75+","Role",void 0);var g=e.ccclass;e.property,t("Role",g("Role")(Y=function(t){function s(){for(var i,s=arguments.length,e=new Array(s),a=0;a<s;a++)e[a]=arguments[a];return(i=t.call.apply(t,[this].concat(e))||this).node=null,i.roleAnim=null,i.roleHand=null,i.modfiyMsCmp=null,i.offset=h(),i.followPos=l.Player.wpos,i.centerPos=h(),i.curPos=h(),i.pathLineVec=null,i.lineVec=h(),i.hp=0,i.moveSpd=0,i.atkRate=1,i.curWeapon=0,i.curScale=1,i.isGiant=!1,i.curGiantLv=1,i._shadowData={pos:null,scale:1,isShow:!0},i.tmpP=h(),i.tmpV=h(),i.stepP=h(),i._rotVec=h(),i._toRadianY=0,i._curRadianY=0,i._rotDirec=1,i._rotSpd=2*Math.PI,i.tmpR=h(),i.transData=[0,0,0,0],i.collider=null,i._checkRes={},i._colGroup=[m.Enemy],i.atkData={pos:h(),rot:h(),lineVec:h(),rotSpd:h(),atkRate:1},i.shotBulletRot=[-3,0,3],i.isStand=!1,i._stateRecs={},i._curState=null,i._preState=null,i}i(s,t);var e=s.prototype;return e.init=function(t,i,s,e,a){this.isGiant=a,this.node=t,this.modfiyMsCmp=this.node.getComponent(f),this.modfiyMsCmp.setData(),this.offset.set(s),this.pathLineVec=e,this.centerPos.set(i),this.curPos.set(i),this.roleAnim=new P(this.node),this.roleAnim.init(this),this.initProp(),this.roleHand=this.node.getComponent(y),this.roleHand.init(this.node.parent,this.curPos,this._rotVec,this.curScale),this.roleHand.setWeapon(this.curWeapon),this.initMoveData(),this.setStateData(),this.setCollider(),this.initShadow()},e.reset=function(){this.roleAnim.reset(),this.resetState(),this.resetCollider(),this.roleHand.reset(),this.resetShadow(),p.clearObj(this)},e.update=function(t){this.roleHand,this.roleHand.updateAnim(t),this.updateTransData(t),this.updateState(t),this.updateCollider(t)},e.lateUpdate=function(t){this.lateUpdateCollider(t)},e.initProp=function(){var t=n.Player;this.hp=this.isGiant?t.giantHp:t.hp,this.curScale=this.isGiant?t.giantScale:t.scale,this.atkRate=this.isGiant?t.giantAtkRate:t.atkRate},e.setGiantLv=function(t){this.isGiant&&(this.curGiantLv=t)},e.initShadow=function(){this._shadowData.pos=this.curPos,this._shadowData.isShow=!0,this._shadowData.scale=this.curScale,u.emit(d.EffectEvents.showMergeEffect,c.MergeEffectType.MergeShadow,this._shadowData)},e.resetShadow=function(){this._shadowData.isShow=!1},e.setWeapon=function(t){this.curWeapon!=t&&(this.roleHand.setWeapon(t),this.curWeapon=t,l.Game.isGameRun&&this.playAtkAnim(this.isStand,!0))},e.initMoveData=function(){this.moveSpd=n.Player.moveSpd,this._curRadianY=Math.PI,this._toRadianY=this._curRadianY,this._rotVec.set(0,this._curRadianY,0),this.modfiyMsCmp.setTransData(this.curPos,this._curRadianY,this.curScale)},e.setOffset=function(t){this.offset.set(t)},e.move=function(t){this.tmpP.set(this.centerPos).subtract(this.followPos),this.tmpV.set(this.offset).subtract(this.tmpP),this.tmpV.multiplyScalar(5),this.lineVec.set(this.pathLineVec).add(this.tmpV),this.stepP.set(this.lineVec).multiplyScalar(t),this.centerPos.add(this.stepP),this.tmpP.set(this.centerPos).add(l.Player.offset),this.stepP.set(this.tmpP).subtract(this.curPos),this.checkMove(this.curPos,this.stepP,this.curPos)},e.rotation=function(t){var i=Math.atan2(-this.lineVec.z,this.lineVec.x)+1.57+3.14;if(this.calRotation(i),this._curRadianY!==this._toRadianY){var s=this._rotSpd*t;s>Math.abs(this._curRadianY-this._toRadianY)?this._curRadianY=this._toRadianY:(s*=this._rotDirec,this._curRadianY+=s),this._rotVec.set(0,this._curRadianY,0)}},e.updateTransData=function(t){this.modfiyMsCmp.setTransData(this.curPos,this._curRadianY,this.curScale),this.modfiyMsCmp.updateColor(t)},e.calRotation=function(t){this._toRadianY=t%6.28;var i=Math.PI;this._toRadianY<0&&(this._toRadianY+=2*i),this._curRadianY=this._curRadianY%(2*i),this._curRadianY>2*i?this._toRadianY-=2*i:this._curRadianY<0&&(this._toRadianY+=2*i);var s=this._toRadianY-this._curRadianY;s>i?(this._curRadianY+=2*i,this._rotDirec=-1):s<-i?(this._toRadianY+=2*i,this._rotDirec=1):s>0?this._rotDirec=1:s<0&&(this._rotDirec=-1)},e.setCollider=function(){var t=n.Player.cldRadius;this.collider=new R(m.Player,this,!1),this.collider.setRectSize(a(t,t)),this.collider.setRectPos(this.curPos),this.collider.updateGridInfo(!0),this.collider.isCircleCollider=!0},e.resetCollider=function(){this.collider&&(this.collider.clearGridInfo(),this.collider.removeFromManager(),this.collider=null)},e.checkMove=function(t,i,s){this.collider&&this.collider.checkMoveCollision(t,i,s)},e.checkCollsion=function(){this.collider&&this.collider.checkPosByGroup(this.curPos,this._colGroup,this.onCheckColliderCb.bind(this))},e.onCheckColliderCb=function(t){var i=0;for(var s in t){var e=t[s];switch(+s){case m.Enemy:for(var a=0;a<e.length;a++){var o=e[a],h=_.getColilderByColId(o).targetCmp;if(h&&h.hp>0){i=h.atk,h.byHit(h.hp),this.byHit(i);break}}}}},e.updateCollider=function(t){this.checkCollsion()},e.lateUpdateCollider=function(t){this.collider&&this.collider.lateUpdate(t)},e.onAtk=function(){var t=r[this.curWeapon],i=this._rotVec.y-1.57;switch(this.curWeapon){case c.WeaponType.Shotgun:for(var s=0;s<this.shotBulletRot.length;s++){var e=.01745*this.shotBulletRot[s];this.tmpV.set(1,0,0),o.rotateY(this.tmpV,this.tmpV,o.ZERO,i+e),this.tmpV.multiplyScalar(t.bulletSpd),this.tmpP.set(this.curPos).add3f(0,.5,0),this.atkData.pos.set(this.tmpP),this.atkData.lineVec.set(this.tmpV),this.atkData.rotSpd.set(o.ZERO),this.atkData.atkRate=this.atkRate,u.emit(d.EffectEvents.showMergeEffect,t.bullet,this.atkData)}break;case c.WeaponType.Grenades:this.tmpV.set(1,0,0),o.rotateY(this.tmpV,this.tmpV,o.ZERO,i),this.tmpV.multiplyScalar(t.bulletSpd),this.tmpP.set(this.curPos).add3f(0,.5,0),this.atkData.pos.set(this.tmpP),this.atkData.lineVec.set(this.tmpV),this.atkData.rotSpd.set(o.ZERO),this.atkData.atkRate=this.atkRate,u.emit(d.EffectEvents.showObjs,c.ThrowBullets.grenadesThrow,this.atkData);break;default:this.tmpV.set(1,0,0),o.rotateY(this.tmpV,this.tmpV,o.ZERO,i),this.tmpV.multiplyScalar(t.bulletSpd),this.tmpP.set(this.curPos).add3f(0,.5,0),this.atkData.pos.set(this.tmpP),this.atkData.lineVec.set(this.tmpV),this.atkData.rotSpd.set(o.ZERO),this.atkData.atkRate=this.atkRate,u.emit(d.EffectEvents.showMergeEffect,t.bullet,this.atkData)}},e.byHit=function(t){this.hp<=0||(this.modfiyMsCmp.byHit(),this.hp-=t,this.hp<=0&&(this.hp=0,this.resetCollider(),this.changeState(v.Death)))},e.playAtkAnim=function(t,i){void 0===i&&(i=!0),this.isStand=t;var s=t?c.PlayerClip.standShoot:c.PlayerClip.shootBack;s=t?this.curWeapon==c.WeaponType.Grenades?c.PlayerClip.throwStand:c.PlayerClip.standShoot:this.curWeapon==c.WeaponType.Grenades?c.PlayerClip.throwBack:c.PlayerClip.shootBack;var e=r[this.curWeapon].atkSpd;this.roleAnim.playAnim(s,!0,i,e)},e.setStateData=function(){this._stateRecs[v.Idle]=new k(this),this._stateRecs[v.Move]=new C(this),this._stateRecs[v.Pass]=new D(this),this._stateRecs[v.Death]=new V(this),this._stateRecs[v.StandShoot]=new w(this),this._stateRecs[v.Win]=new M(this),this.changeState(l.Game.isGameRun?v.Move:v.Idle),setTimeout((function(){}),0)},e.resetState=function(){for(var t in this._stateRecs)this._stateRecs[t].offEvents(),this._stateRecs[t].reset();this._stateRecs={},this._curState=null,this._preState=null},e.changeState=function(t,i,s){void 0===s&&(s=!1),(this._curState!==t||s)&&(this._stateRecs[this._curState]&&this._stateRecs[this._curState].exit(),this._stateRecs[t]&&(this._preState=this._curState,this._curState=t,this._stateRecs[this._curState].enter(i)))},e.updateState=function(t){this._stateRecs[this._curState]&&this._stateRecs[this._curState].update(t)},s}(S))||Y);s._RF.pop()}}}));

System.register("chunks:///_virtual/RoleAnim.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalTmpData.ts","./Tools.ts","./BasicSkeleAnim.ts"],(function(t){"use strict";var n,o,i,e,s,l;return{setters:[function(t){n=t.inheritsLoose},function(t){o=t.cclegacy,i=t._decorator},function(t){e=t.GlobalTmpData},function(t){s=t.default},function(t){l=t.BasicSkeleAnim}],execute:function(){var c;o._RF.push({},"d196cKbk95GWbYsu/zZRUyd","RoleAnim",void 0);var r=i.ccclass;i.property,t("RoleAnim",r("RoleAnim")(c=function(t){function o(){for(var n,o=arguments.length,i=new Array(o),e=0;e<o;e++)i[e]=arguments[e];return(n=t.call.apply(t,[this].concat(i))||this).role=null,n}n(o,t);var i=o.prototype;return i.onEvents=function(){this.anim.onAtk=this.onAtk.bind(this)},i.offEvents=function(){this.anim.onAtk=null},i.init=function(n){t.prototype.init.call(this),this.role=n},i.reset=function(){t.prototype.reset.call(this),s.clearObj(this)},i.onAtk=function(){e.Game.isPause||this.role.onAtk()},o}(l))||c);o._RF.pop()}}}));

System.register("chunks:///_virtual/RoleGiant.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalConfig.ts","./StorageSystem.ts","./BasicModifyMesh.ts","./Role.ts"],(function(t){"use strict";var i,s,e,o,a,n,h,c;return{setters:[function(t){i=t.inheritsLoose},function(t){s=t.cclegacy,e=t._decorator,o=t.Vec3},function(t){a=t.GlobalConfig},function(t){n=t.StorageSystem},function(t){h=t.BasicModifyMesh},function(t){c=t.Role}],execute:function(){var r;s._RF.push({},"9c1f4KgFY5AFZZ0V4dkyTxH","RoleGiant",void 0);var d=e.ccclass;e.property,t("RoleGiant",d("RoleGiant")(r=function(t){function s(){for(var i,s=arguments.length,e=new Array(s),o=0;o<s;o++)e[o]=arguments[o];return(i=t.call.apply(t,[this].concat(e))||this).shieldModifyCmp=null,i.modfiyMsCmp=null,i}i(s,t);var e=s.prototype;return e.init=function(i,s,e,o,a){t.prototype.init.call(this,i,s,e,o,a),this.shieldModifyCmp=this.node.getChildByName("shield").getComponent(h),this.shieldModifyCmp.setData()},e.setGiantLv=function(t){if(this.isGiant){this.curGiantLv=t,this.modfiyMsCmp.msrC.node.active=!0,this.modfiyMsCmp.msrB.node.active=!1,2==this.curGiantLv&&(this.modfiyMsCmp.msrB.node.active=!0),this.modfiyMsCmp.msrA.node.active=!1,this.shieldModifyCmp.node.active=!1,3==this.curGiantLv&&(this.modfiyMsCmp.msrA.node.active=!0,this.shieldModifyCmp.node.active=!0);var i=n.getData().levelAssets.curLv,s=Math.round(100*i/10)/100+1,e=a.Player;this.hp=e.giantHp*s,this.atkRate=e.giantAtkRate*s}},e.updateTransData=function(i){t.prototype.updateTransData.call(this,i),this.shieldModifyCmp&&this.shieldModifyCmp.node.active&&(this.tmpP.set(this.shieldModifyCmp.node.position).multiplyScalar(this.curScale),o.rotateY(this.tmpP,this.tmpP,o.ZERO,this._curRadianY),this.tmpP.add(this.curPos),this.shieldModifyCmp.setTransData(this.tmpP,this._curRadianY,this.curScale),this.shieldModifyCmp.updateColor(i))},s}(c))||r);s._RF.pop()}}}));

System.register("chunks:///_virtual/RoleHand.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalConfig.ts","./GlobalPool.ts","./ModifyPosRotMesh.ts"],(function(t){"use strict";var e,s,n,i,o,l,a,r,p,h,u,c,f,d,m,R;return{setters:[function(t){e=t.applyDecoratedDescriptor,s=t.inheritsLoose,n=t.initializerDefineProperty,i=t.assertThisInitialized},function(t){o=t.cclegacy,l=t._decorator,a=t.Node,r=t.v3,p=t.quat,h=t.Tween,u=t.Vec3,c=t.tween,f=t.Component},function(t){d=t.WeaponCfg},function(t){m=t.default},function(t){R=t.ModifyPosRotMesh}],execute:function(){var w,y,P,g,A;o._RF.push({},"392b793xh5PkZRIXhMHN8E/","RoleHand",void 0);var W=l.ccclass,_=l.property,v=(t("RoleHand",(w=W("RoleHand"),y=_(a),w((A=e((g=function(t){function e(){for(var e,s=arguments.length,o=new Array(s),l=0;l<s;l++)o[l]=arguments[l];return e=t.call.apply(t,[this].concat(o))||this,n(e,"hand",A,i(e)),e._parent=null,e.curWeapon=null,e.curType=null,e.weaponMsr=null,e.followPos=null,e.followRot=null,e.roleScale=1,e._scaleAnim=r(),e.tmpR=r(),e.tmpR2=r(),e.tmpP=r(),e.tmpP2=r(),e.tmpQ=p(),e}s(e,t);var o=e.prototype;return o.init=function(t,e,s,n){this._parent=t,this.followPos=e,this.followRot=s,this.roleScale=n},o.reset=function(){m.put(this.curWeapon),h.stopAllByTarget(this._scaleAnim),this.curType=null,this.weaponMsr=null,this.curWeapon=null,this.followPos=null,this.followRot=null},o.setWeapon=function(t){if(this.curType!=t){var e=d[t].perfab;m.put(this.curWeapon),this.curWeapon=m.get(e),this.curWeapon.setPosition(u.ZERO),this.curWeapon.eulerAngles=u.ZERO,this.curWeapon.parent=this._parent,this.weaponMsr=this.curWeapon.getComponent(R),this.curType=t,this.showAnim(),this.setWeaponData();var s=this.hand.children[0];s||((s=new a).parent=this.hand);var n=v[d[this.curType].perfab];s.setPosition(n.p),s.eulerAngles=n.r,s.setScale(n.s,n.s,n.s)}},o.showAnim=function(){h.stopAllByTarget(this._scaleAnim),this._scaleAnim.set(0,0,0),c(this._scaleAnim).to(.2,{x:1},{easing:"backOut"}).start()},o.updateAnim=function(t){this.setWeaponData()},o.setWeaponData=function(){if(this.weaponMsr&&this.followPos){var t=v[d[this.curType].perfab];this.hand.children[0]&&(this.tmpP.set(this.hand.children[0].worldPosition),u.rotateY(this.tmpP,this.tmpP,u.ZERO,this.followRot.y),this.tmpP.add(this.followPos),this.tmpQ.set(this.hand.children[0].worldRotation),this.tmpQ.getEulerAngles(this.tmpR),this.tmpR.add(t.r),this.tmpR.multiplyScalar(.01745),this.tmpR.y+=this.followRot.y),this.weaponMsr.setTransData(this.tmpP,this.tmpR,t.s*this.roleScale*this._scaleAnim.x)}},e}(f)).prototype,"hand",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=g))||P)),t("RoleHandCfg",{Pistol:{p:r(.06,.214,-.01),r:r(-70.233,-97.281,30.254),s:1.5},Shotgun:{p:r(.06,.214,-.01),r:r(-70.233,-97.281,30.254),s:1.2},FireGun:{p:r(.003,.378,-.131),r:r(-70.233,-97.281,30.254),s:1.2},MachineGun:{p:r(.06,.214,-.01),r:r(-70.233,-97.281,30.254),s:1.2},Grenades:{p:r(.066,.132,.129),r:r(-70.233,-97.281,30.254),s:1}}));o._RF.pop()}}}));

System.register("chunks:///_virtual/RoleLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalConfig.ts","./GlobalEnum.ts","./GlobalTmpData.ts","./EventTypes.ts","./AudioEnum.ts","./AudioSystem.ts","./StorageSystem.ts","./UIEnum.ts","./UISystem.ts","./GlobalPool.ts","./BasicLayer.ts","./HorizonTouch.ts","./Enemy.ts","./EnemyBomb.ts","./Role.ts","./RoleGiant.ts","./RoleStates.ts"],(function(t){"use strict";var e,s,a,i,h,n,o,r,l,m,u,c,f,p,d,y,R,P,v,C,E,S,x,b;return{setters:[function(t){e=t.inheritsLoose},function(t){s=t.cclegacy,a=t._decorator,i=t.v3,h=t.clamp,n=t.Vec3},function(t){o=t.GlobalConfig,r=t.WeaponCfg},function(t){l=t.GlobalEnum},function(t){m=t.GlobalTmpData},function(t){u=t.EventTypes},function(t){c=t.AudioEnum},function(t){f=t.AudioSystem},function(t){p=t.StorageSystem},function(t){d=t.UIEnum},function(t){y=t.UISystem},function(t){R=t.default},function(t){P=t.BasicLayer},function(t){v=t.HorizonTouch},function(t){C=t.Enemy},function(t){E=t.EnemyBomb},function(t){S=t.Role},function(t){x=t.RoleGiant},function(t){b=t.RoleStateType}],execute:function(){var O;s._RF.push({},"70845iMlIdKoJmuI8GeWlDZ","RoleLayer",void 0);var g=a.ccclass;a.property,t("RoleLayer",g("RoleLayer")(O=function(t){function s(){for(var e,s=arguments.length,a=new Array(s),h=0;h<s;h++)a[h]=arguments[h];return(e=t.call.apply(t,[this].concat(a))||this).touchObj=null,e.pathWidth=.5*o.RoadWidth,e.followPos=m.Player.wpos,e.pathLineVec=i(),e.pathIndex=0,e.pathSubIndex=0,e.isRotPath=!1,e.isPathEnd=!1,e.isEndMark=!1,e.tmpP=i(),e.tmpO=i(),e.tmpV=i(),e.tmpC=i(),e.cameraPos=i(0,0,0),e.homeCameraPos=i(0,0,12),e.cameraRot=i(-45,0,0),e.initCameraRot=i(-45,0,0),e.homeCameraRot=i(-30,0,0),e.cameraOffset=i(0,18,18),e.homeCameraOffset=i(0,10,10),e.curCameraOffset=i(),e.cameraAddOffset=i(),e.cameraTurnOffset=i(),e.cameraEndOffset=i(),e.tmpR=i(),e.curRot=i(),e.isCloseCamera=!1,e.allRoles={},e.roleSumCount=0,e.normalRoleNum=0,e.curWeapon=l.WeaponType.Pistol,e.isRoleAllStand=!1,e._offsetCd=1,e._curOffsetTime=0,e._isOffsetReady=!1,e.allEnemys={},e.delayCreateRecs=[],e.isEnemyAllDeath=!1,e.tmpPrePre=i(),e.tmpPre=i(),e.tmpNex=i(),e.lerp0=i(),e.lerp1=i(),e.lerp2=i(),e.hasDelayCreate=!1,e.delayCurt=0,e.delayCd=.016,e.delayCreateNum=1,e._prefabRecs={},e._preMaxCfg={player:50,enemyNormal:100,enemyGiant:100,enemyBomb:100,enemyNinja:100,enemyBoss:100},e.createCurt=0,e.createCd=.05,e.symbolArr=["+","-","x","/"],e._audioCdMin=.1,e._curAudioCd=0,e._audioTime=0,e.intervalId=null,e.tmpData={p:i(),s:1},e}e(s,t);var a=s.prototype;return a.init=function(){this.initTouch()},a.onEvents=function(){this.on(u.GameEvents.GameRun,this.onGameRun,this),this.on(u.EnemyEvents.CreateEnemys,this.onCreateEnemys,this),this.on(u.RoleEvents.SetWeapon,this.onSetWeapon,this),this.on(u.RoleEvents.Death,this.onRoleDeath,this),this.on(u.RoleEvents.AddRoles,this.onAddRoles,this),this.on(u.RoleEvents.LvupGaint,this.onLvupGaint,this),this.on(u.CurLevelEvents.ShowHomeCamera,this.onShowHomeCamera,this),this.on(u.RoleEvents.Resurgence,this.onResurgence,this),this.on(u.RoleEvents.CanceResurgence,this.onCanceResurgence,this)},a.setData=function(t){this.setRoles(t),this.setEnemys(t),this.setRoleCenter(t),this.setCameraPos(),this.setPreCreateData(t)},a.reset=function(){this.resetRoles(),this.resetEnemys(),this.resetTouch(),this.resetRoleCenter(),this.resetCameraPos(),this.resetWinEffects()},a.customUpdate=function(t){this.updateTouch(t),this.updateRoleCenter(t),this.updateRoles(t),this.updateEnemys(t),this.updateCameraPos(t),this.updateCreateData(t),this.updateAudio(t)},a.customLateUpdate=function(t){this.lateUpdateRoles(t),this.lateUpdateEnemys(t)},a.initTouch=function(){this.touchObj=new v(i(),-this.pathWidth,this.pathWidth)},a.resetTouch=function(){this.touchObj.reset()},a.updateTouch=function(t){if(m.Game.isGameRun){this.touchObj.update(t);var e=m.Player.formation;this.touchObj.fitMaxX=this.pathWidth-h(e.maxX,0,this.pathWidth),this.touchObj.fitMinX=-this.pathWidth-h(e.minX,-this.pathWidth,0)}},a.setRoleCenter=function(t){this.pathIndex=0,this.pathSubIndex=0},a.resetRoleCenter=function(){this.isPathEnd=!1,this.isEndMark=!1,this.isRotPath=!1,this.pathLineVec.set(0,0,0),this.followPos.set(0,0,0),m.Player.wrotY=0,m.Player.offset=i(),m.Player.lineVec.set(0)},a.updateRoleCenter=function(t){this.calPathLineVec(),this.checkEndMark(),this.moveFollowPos(t)},a.calPathLineVec=function(){if(!this.isPathEnd){var t=m.PathInfo[this.pathIndex];if(!t||0==t.path.length)return this.pathFinished(),void(this.isPathEnd=!0);var e=t.path[this.pathSubIndex],s=h(0,this.pathSubIndex+1,t.path.length-1),a=t.path[s],i=this.tmpP.set(e).subtract(a).lengthSqr();if(this.tmpP.set(this.followPos).subtract(e),this.tmpP.lengthSqr()>=i){if(this.pathSubIndex++,this.pathSubIndex>=t.path.length-1&&(this.pathIndex++,this.pathSubIndex=0,t=m.PathInfo[this.pathIndex],console.log("# path : ",this.pathIndex)),!t||0==t.path.length)return this.pathFinished(),this.isPathEnd=!0,void console.log("Path End");e=t.path[this.pathSubIndex],s=h(0,this.pathSubIndex+1,t.path.length-1),a=t.path[s]}if(Math.abs(e.x-a.x)>.01&&Math.abs(e.z-a.z)>.01){var r=h(this.pathSubIndex-1,0,t.path.length-1),l=1.5705;t.path[r].x==e.x?(this.tmpC.set(a.x,0,e.z),l*=e.x<a.x?-1:1):(this.tmpC.set(e.x,0,a.z),l*=e.x>a.x?-1:1),this.tmpV.set(this.tmpC).subtract(this.followPos).normalize(),n.rotateY(this.tmpV,this.tmpV,n.ZERO,l),this.pathLineVec.set(this.tmpV).multiplyScalar(o.Player.moveSpd),this.isRotPath=!0}else this.isRotPath=!1,this.pathLineVec.set(a).subtract(e).normalize().multiplyScalar(o.Player.moveSpd);m.Player.lineVec.set(this.pathLineVec)}},a.checkEndMark=function(){if(!this.isEndMark){var t=m.PathInfo,e=m.Player;if(this.pathIndex>=t.length-1&&e.endMarkPos.z<=e.formation.maxZ+e.wpos.z){this.isEndMark=!0;var s={num:Object.keys(this.allRoles).length,outPaths:[],outFormation:[]};this.emit(u.CurLevelEvents.GetEndPathInfo,s);var a=0;for(var h in this.allRoles){var n=this.allRoles[h];n&&n.node.active&&n.hp>0&&function(){var t=[];t.push(i(n.curPos)),s.outPaths.forEach((function(e){t.push(i(e))})),t.push(i(s.outFormation[a])),n.changeState(b.Pass,{endPath:t,endRecIndex:a}),m.endFormationRec[a]={p:s.outFormation[a],role:n},a++}()}}}},a.pathFinished=function(){this.isPathEnd},a.moveFollowPos=function(t){this.isPathEnd||(t*=m.Game.isGameRun?1:0,this.tmpP.set(this.pathLineVec).multiplyScalar(t),this.followPos.add(this.tmpP),this.isPathEnd||(m.Player.wrotY=Math.atan2(-this.pathLineVec.z,this.pathLineVec.x),n.rotateY(this.tmpV,this.pathLineVec,n.ZERO,1.5703),this.tmpV.normalize().multiplyScalar(this.touchObj.ctrlPos.x),m.Player.offset.set(this.tmpV)))},a.setCameraPos=function(){this.isCloseCamera=!1,o.ShowDebugCamera?(this.cameraPos.x=this.followPos.x,this.cameraPos.z=this.followPos.z,this.cameraPos.y=o.DebugCameraHeight):(this.cameraPos.set(this.followPos),this.cameraRot.set(this.initCameraRot)),this.curCameraOffset.set(this.cameraOffset),this.curRot.set(0,0,0),this.cameraAddOffset.set(0,0,0),this.cameraTurnOffset.set(this.cameraOffset).normalize().multiplyScalar(15),this.cameraEndOffset.set(this.cameraOffset).normalize().multiplyScalar(10),this.emit(u.CameraEvents.SetFollowPos,this.cameraPos),this.emit(u.CameraEvents.SetCameraSelfOffset,this.curCameraOffset)},a.resetCameraPos=function(){},a.updateCameraPos=function(t){if(o.ShowDebugCamera)return this.cameraPos.x=this.followPos.x,void(this.cameraPos.z=this.followPos.z);if(this.tmpP.set(this.followPos),this.isCloseCamera&&(this.tmpP.z+=this.homeCameraPos.z),this.cameraPos.set(this.tmpP),this.isPathEnd)m.Game.isGameRun&&(this.cameraAddOffset.lerp(this.cameraEndOffset,.03*t*60),this.tmpP.set(this.cameraOffset).add(this.cameraAddOffset),this.curCameraOffset.lerp(this.tmpP,.1*t*60),this.emit(u.CameraEvents.SetCameraSelfOffset,this.curCameraOffset));else{var e=m.Player.wrotY+1.5703;this.curRot.y+=.2*(e-this.curRot.y)*t*60,this.cameraRot.y=57.3*this.curRot.y;var s=this.isCloseCamera?this.homeCameraRot.x:this.initCameraRot.x;this.curRot.x+=.15*(s-this.curRot.x)*t*60,this.cameraRot.x=this.curRot.x,this.emit(u.CameraEvents.SetCameraSelfRot,this.cameraRot),this.tmpP.set(0,0,0),this.isRotPath&&this.tmpP.set(this.cameraTurnOffset),this.cameraAddOffset.lerp(this.tmpP,.03*t*60),this.tmpP.set(this.isCloseCamera?this.homeCameraOffset:this.cameraOffset),this.tmpP.add(this.cameraAddOffset),n.rotateY(this.tmpP,this.tmpP,n.ZERO,this.curRot.y),m.Game.isGameRun?this.curCameraOffset.set(this.tmpP):this.curCameraOffset.lerp(this.tmpP,.1*t*60),this.emit(u.CameraEvents.SetCameraSelfOffset,this.curCameraOffset)}},a.setRoles=function(t){this.roleSumCount=0,this.normalRoleNum=0;var e=p.getData().userAssets;this.curWeapon=e.chooseWeapon;var s=e.props.GiantLv-1,a=Math.floor(s/3),i=s%3,h=0!=i,n=e.props.RoleNumLv;this.createRoles(n),this.createRoles(a,!0,3),h&&this.createRoles(1,!0,i)},a.resetRoles=function(){for(var t in this.allRoles){this.allRoles[t].reset()}this.allRoles={},this.roleSumCount=0,this.normalRoleNum=0,this._isOffsetReady=!0,this.isRoleAllStand=!1},a.createRoles=function(t,e,s){void 0===e&&(e=!1),void 0===s&&(s=1);var a=o.Formation.length;if(this.roleSumCount>=a)console.warn("玩家已达最大数量:",a);else{for(var h=i(),r=i(this.followPos).add(m.Player.offset),l=e?"playerGiant":"player",u=0;u<t;u++){if(this.roleSumCount>=a){console.warn("玩家已达最大数量:",a);break}var c=R.get(l);c.setPosition(n.ZERO),c.parent=this.node;var f=o.Formation[this.roleSumCount];h.set(f.x*o.Scale2DTo3D,0,-f.y*o.Scale2DTo3D).multiplyScalar(o.FormationScale);var p=e?new x:new S;p.init(c,r,h,this.pathLineVec,e),p.setWeapon(this.curWeapon),e&&p.setGiantLv(s),this.allRoles[c.uuid]=p,this.roleSumCount++,e||this.normalRoleNum++}m.normalRoleNum=this.normalRoleNum}},a.reduceNormalRoles=function(t){var e=0;for(var s in this.allRoles){if(e>=t)break;var a=this.allRoles[s];a&&a.node&&a.node.active&&a._curState!=b.Death&&!a.isGiant&&(a.byHit(a.hp),e++)}},a.updateOffset=function(t){this._isOffsetReady||(this._curOffsetTime+=t,this._curOffsetTime>=this._offsetCd&&(this._curOffsetTime=0,this._isOffsetReady=!0))},a.updateRoles=function(t){this.isRoleAllStand=this.isEndMark,this.updateOffset(t);var e=!1;this._isOffsetReady&&(this._isOffsetReady=!1,e=!0);var s=o.Formation,a=0,i=m.Player.formation;for(var h in i.minX=9999,i.minZ=9999,i.maxX=-9999,i.maxZ=-9999,this.allRoles){var n=this.allRoles[h];if(n.node&&n.node.active&&n._curState!=b.Death){if(n._curState!=b.StandShoot&&(this.isRoleAllStand=!1),e&&n._curState!=b.Pass){var r=s[a];this.tmpP.set(r.x,r.y,r.z),this.tmpP.set(r.x*o.Scale2DTo3D,0,-r.y*o.Scale2DTo3D),this.tmpP.multiplyScalar(o.FormationScale),n.setOffset(this.tmpP)}this.tmpP.set(n.offset),i.maxX=Math.max(this.tmpP.x,i.maxX),i.minX=Math.min(this.tmpP.x,i.minX),i.maxZ=Math.max(this.tmpP.z,i.maxZ),i.minZ=Math.min(this.tmpP.z,i.minZ),n.update(t),a++}else R.put(n.node),n.reset(),delete this.allRoles[h]}m.normalRoleNum=this.roleSumCount,m.Player.isPathEnd=this.isPathEnd},a.lateUpdateRoles=function(t){for(var e in this.allRoles){var s=this.allRoles[e];s.node&&s.node.active?s.lateUpdate(t):(s.reset(),delete this.allRoles[e])}},a.setEnemys=function(t){this.isEnemyAllDeath=!1,this.hasDelayCreate=!1},a.resetEnemys=function(){for(var t in this.allEnemys){this.allEnemys[t].reset()}this.allEnemys={},this.delayCreateRecs=[]},a.getEnemyCenterPath=function(t,e,s){for(var a=[],o=0;o<e.length;o++){var r=e[o];a.push(i(r))}for(var l=m.PathInfo,u=t+1;u<l.length;u++)for(var c=l[u],f=1;f<c.path.length;f++){var p=c.path[f];a.push(i(p))}this.tmpV.set(a[1]).subtract(a[0]).normalize().multiplyScalar(5);for(var d=0;d<a.length;d++)if(this.tmpPre.set(a[d]),n.round(this.tmpPre,this.tmpPre),d>1&&d<a.length-1)if(this.tmpNex.set(a[d+1]),n.round(this.tmpNex,this.tmpNex),this.tmpPre.x!=this.tmpNex.x&&this.tmpPre.z!=this.tmpNex.z){this.tmpPrePre.set(a[d-1]),this.tmpV.set(this.tmpPre).subtract(this.tmpPrePre).normalize().multiplyScalar(5),this.tmpC.set(this.tmpPre).add(this.tmpV),this.lerp0.set(this.tmpPre),this.lerp1.set(this.tmpC),this.lerp2.set(this.lerp0);for(var y=1;y<20;y++){var R=h(y/20,.1,.99);this.lerp0.lerp(this.tmpC,R),this.lerp1.lerp(this.tmpNex,R),this.lerp2.set(this.lerp0).lerp(this.lerp1,R),s.push(i(this.lerp2))}}else s.push(i(this.tmpPre));else s.push(i(this.tmpPre))},a.getEnemySinglePath=function(t,e,s){for(var a=0;a<t.length;a++)this.tmpPre.set(t[a]),this.tmpP.set(this.tmpPre).add(e),s.push(i(this.tmpP))},a.createEnemys=function(t){var e=[];this.getEnemyCenterPath(t.initPathIndex,t.initPath,e),this.delayCreateRecs.push({centerPath:e,type:t.type,num:t.count})},a.delayCreateEnemy=function(t){if(this.delayCurt+=t,this.delayCurt>=this.delayCd){this.delayCurt=0;var e=o.EnemyCfg.creatSize;this.hasDelayCreate=!1;for(var s=this.delayCreateRecs.length-1;s>=0;s--){var a=this.delayCreateRecs[s];if(a.num>0){var i=a.num>this.delayCreateNum?this.delayCreateNum:a.num;a.num-=this.delayCreateNum;for(var h=l.EnemyPrefabs[l.EnemyType[a.type]],r=0;r<i;r++){this.tmpP.set(a.centerPath[0]);var m=(2*Math.random()-1)*e.x,u=(2*Math.random()-1)*e.y;this.tmpO.set(m,0,u);var c=[];this.getEnemySinglePath(a.centerPath,this.tmpO,c);var f=R.get(h);f.setPosition(n.ZERO),f.parent=this.node;var p=void 0;switch(a.type){case l.EnemyType.Bomb:p=new E;break;default:p=new C}p.init(f,a.type,c),this.allEnemys[f.uuid]=p}this.hasDelayCreate=!0}else this.delayCreateRecs.splice(s,1)}}},a.updateEnemys=function(t){for(var e in this.allEnemys){var s=this.allEnemys[e];s.node&&s.node.active?s.update(t):(s.reset(),delete this.allEnemys[e])}this.delayCreateEnemy(t),m.EnemyNum=Object.keys(this.allEnemys).length,this.checkEndPathEnemyNum(t)},a.lateUpdateEnemys=function(t){for(var e in this.allEnemys){var s=this.allEnemys[e];s.node&&s.node.active?s.lateUpdate(t):(s.reset(),delete this.allEnemys[e])}},a.checkEndPathEnemyNum=function(t){if(this.isRoleAllStand&&!this.isEnemyAllDeath&&!this.hasDelayCreate){for(var e in this.isEnemyAllDeath=!0,this.allEnemys){var s=this.allEnemys[e];s&&s.curPos.z<=this.followPos.z+15&&(this.isEnemyAllDeath=!1)}this.isEnemyAllDeath&&this.onEnemyAllDeath()}},a.onEnemyAllDeath=function(){this.emit(u.GameEvents.GameOver,!0),this.showWinEffects()},a.killAllEnemys=function(){for(var t in this.allEnemys){var e=this.allEnemys[t];e&&e.byHit(e.hp)}},a.setPreCreateData=function(t){for(var e=0;e<t.enemy.length;e++){var s=t.enemy[e];if(s){var a=s[1],i=l.EnemyPrefabs[l.EnemyType[a]];this._prefabRecs[i]||(this._prefabRecs[i]=0)}}},a.updateCreateData=function(t){if(this.createCurt+=t,this.createCurt>=this.createCd)for(var e in this.createCurt=0,this._prefabRecs)if(this._preMaxCfg[e]&&this._prefabRecs[e]<this._preMaxCfg[e]){var s=R.get(e);R.put(s),this._prefabRecs[e]++}},a.onResurgence=function(){this.setRoles(),this.createRoles(10,!1),this.killAllEnemys(),this.emit(u.GameEvents.GameResume)},a.onCanceResurgence=function(){this.emit(u.GameEvents.GameOver,!1)},a.onShowHomeCamera=function(t){this.isCloseCamera=t},a.onGameRun=function(){for(var t in this.allRoles){var e=this.allRoles[t];e&&e._curState==b.Idle&&e.changeState(b.Move)}this.isCloseCamera=!1},a.onLvupGaint=function(){var t=!1;for(var e in this.allRoles){var s=this.allRoles[e];if(s&&s.isGiant&&s.node.active&&s._curState!=b.Death&&s.curGiantLv<3){s.setGiantLv(s.curGiantLv+1),t=!0;break}}t||this.createRoles(1,!0,1)},a.onAddRoles=function(t,e){if(!(this.roleSumCount<=0)){var s=e;switch(t){case l.IncreaseType.symbol_Add:this.createRoles(e,!1),f.playEffect(c.addRole);break;case l.IncreaseType.symbol_Reduce:this.reduceNormalRoles(e);break;case l.IncreaseType.symbol_Multip:e=e<1?1:e,s=this.normalRoleNum*(e-1),this.createRoles(s,!1),f.playEffect(c.addRole);break;case l.IncreaseType.symbol_Division:s=Math.ceil(this.normalRoleNum/e),this.reduceNormalRoles(s)}console.log(this.symbolArr[t],e)}},a.onRoleDeath=function(t){var e=this;this.allRoles[t]&&(this.roleSumCount--,this.allRoles[t].isGiant||this.normalRoleNum--),0==this.roleSumCount&&setTimeout((function(){e.isRoleAllStand?e.emit(u.GameEvents.GameOver,!1):(e.emit(u.GameEvents.GamePause),y.showUI(d.ResurgenceUI))}),1e3)},a.onCreateEnemys=function(t){this.createEnemys(t)},a.onSetWeapon=function(t){for(var e in this.curWeapon=t,this.allRoles){var s=this.allRoles[e];s&&s.setWeapon(t)}},a.updateAudio=function(t){if(m.Game.isGameRun&&0!=this.roleSumCount){this._audioTime+=t;var e=r[this.curWeapon].atkSpd;if(this._curAudioCd=h(1/(this.roleSumCount*e),this._audioCdMin,10),this._audioTime>=this._curAudioCd)switch(this._audioTime=0,this.curWeapon){case l.WeaponType.FireGun:f.playEffect(c.FireGun);break;case l.WeaponType.Shotgun:f.playEffect(c.shotGun);break;case l.WeaponType.MachineGun:f.playEffect(c.MachineGun);break;case l.WeaponType.Pistol:f.playEffect(c.Pistol);break;case l.WeaponType.Grenades:f.playEffect(c.ShouLiu)}}},a.resetWinEffects=function(){clearInterval(this.intervalId)},a.showWinEffects=function(){},a.showEffect=function(){var t=i(m.Player.wpos);t.z-=5;for(var e=Math.floor(3*Math.random())+3,s=0;s<e;s++)this.tmpData.p.set(t),this.tmpData.p.x+=4*(2*Math.random()-1),this.tmpData.p.z+=4*(2*Math.random()-1),this.tmpData.s=2*Math.random()+1,this.tmpData.p.y+=4*Math.random()+1,this.emit(u.EffectEvents.showObjs,l.Effect3dType.fireWork,this.tmpData)},s}(P))||O);s._RF.pop()}}}));

System.register("chunks:///_virtual/RoleStates.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalEnum.ts","./EventManager.ts","./EventTypes.ts","./BasicState.ts"],(function(t){"use strict";var e,n,i,s,o,c,a,r;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator,s=t.v3},function(t){o=t.GlobalEnum},function(t){c=t.default},function(t){a=t.EventTypes},function(t){r=t.BasicState}],execute:function(){t("RoleStateType",void 0),n._RF.push({},"bb727XER9dDG6linQyQ0QYw","RoleStates",void 0);var h;i.ccclass,i.property;!function(t){t[t.Idle=0]="Idle",t[t.Move=1]="Move",t[t.Pass=2]="Pass",t[t.StandShoot=3]="StandShoot",t[t.Death=4]="Death",t[t.Win=5]="Win"}(h||(h=t("RoleStateType",{})));t("RoleIdleState",function(t){function n(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).offsetDirec=s(),e}e(n,t);var i=n.prototype;return i.enter=function(t){this.cmp.roleAnim.playAnim(o.PlayerClip.idle,!0),this.cmp.curPos.add(this.cmp.offset),this.cmp.updateTransData(0)},i.update=function(t){this.cmp.move(t),this.cmp.lineVec.set(0,0,1),this.cmp.rotation(t)},n}(r)),t("RoleMoveState",function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var i=n.prototype;return i.enter=function(t){this.cmp.playAtkAnim(!1)},i.update=function(t){this.cmp.move(t),this.cmp.rotation(t)},n}(r)),t("RolePassState",function(t){function n(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).endPath=null,e.endIndex=0,e.isMoveEnd=!1,e.endRecIndex=0,e.tmpP=s(),e}e(n,t);var i=n.prototype;return i.enter=function(t){this.endPath=t.endPath,this.endRecIndex=t.endRecIndex,this.endIndex=0,this.isMoveEnd=!1},i.update=function(t){this.calPathDirec(t),this.isMoveEnd&&this.onMoveFinished()},i.calPathDirec=function(t){if(!this.isMoveEnd){var e=this.endPath[this.endIndex],n=this.endIndex+1;if(n<=this.endPath.length-1){var i=this.endPath[n],s=this.tmpP.set(e).subtract(i).lengthSqr();if(this.tmpP.set(this.cmp.curPos).subtract(e),this.tmpP.lengthSqr()>=s){if(this.endIndex++,(n=this.endIndex+1)>this.endPath.length-1)return this.isMoveEnd=!0,void this.cmp.lineVec.set(0,0,0);e=this.endPath[this.endIndex],i=this.endPath[n]}this.cmp.lineVec.set(i).subtract(e).normalize().multiplyScalar(this.cmp.moveSpd)}this.tmpP.set(this.cmp.lineVec).multiplyScalar(t),this.cmp.curPos.add(this.tmpP)}},i.onMoveFinished=function(){this.cmp.changeState(h.StandShoot)},i.exit=function(){},n}(r)),t("RoleStandShootState",function(t){function n(){return t.apply(this,arguments)||this}return e(n,t),n.prototype.enter=function(t){this.cmp.playAtkAnim(!0)},n}(r)),t("RoleDeathState",function(t){function n(){return t.apply(this,arguments)||this}return e(n,t),n.prototype.enter=function(t){var e=s(this.cmp.curPos);e.y+=.5,c.emit(a.EffectEvents.showMergeEffect,o.MergeEffectType.MergeRoleDeath,{p:e}),c.emit(a.RoleEvents.Death,this.cmp.node.uuid)},n}(r)),t("RoleWinState",function(t){function n(){return t.apply(this,arguments)||this}return e(n,t),n.prototype.enter=function(t){},n}(r));n._RF.pop()}}}));

System.register("chunks:///_virtual/Spininess.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalConfig.ts","./GlobalEnum.ts","./CollisionManager.ts","./BasicProp.ts"],(function(t){"use strict";var i,e,n,o,r,s,a,p,l,u,c,h,f,y,m,g;return{setters:[function(t){i=t.applyDecoratedDescriptor,e=t.inheritsLoose,n=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator,a=t.Enum,p=t.Node,l=t.v3,u=t.Tween,c=t.tween},function(t){h=t.TrapCfg},function(t){f=t.GlobalEnum},function(t){y=t.ColliderGroup,m=t.CollisionManager},function(t){g=t.BasicProp}],execute:function(){var d,v,A,T,b,C,w;r._RF.push({},"919ed80OudHr5q6i/jNQxHy","Spininess",void 0);var P=s.ccclass,R=s.property;t("Spininess",(d=P("Spininess"),v=R({type:a(f.TrapType)}),A=R(p),d((C=i((b=function(t){function i(){for(var i,e=arguments.length,r=new Array(e),s=0;s<e;s++)r[s]=arguments[s];return(i=t.call.apply(t,[this].concat(r))||this).cldGroup=y.PlayerTrigger,n(i,"trapType",C,o(i)),n(i,"moveTarget",w,o(i)),i.posAnim=l(),i.isRuning=!1,i}e(i,t);var r=i.prototype;return r.setData=function(i){t.prototype.setData.call(this,i)},r.reset=function(){this.resetAnim(),t.prototype.reset.call(this)},r.customUpdate=function(i){t.prototype.customUpdate.call(this,i),this.updateAnim(i)},r.show=function(){t.prototype.show.call(this),this.isRuning||this.runAnim()},r.hide=function(){t.prototype.hide.call(this),this.isRuning&&this.resetAnim()},r.runAnim=function(){var t=this;this.isRuning=!0,u.stopAllByTarget(this.posAnim),this.posAnim.set(0,-1,0),this.moveTarget.setPosition(this.posAnim),c(this.posAnim).repeatForever(c(this.posAnim).to(.4,{y:0},{easing:"backOut"}).call((function(){t.checkCollistion()})).to(.4,{y:-1}).delay(.6)).start()},r.resetAnim=function(){this.isRuning=!1,u.stopAllByTarget(this.posAnim)},r.updateAnim=function(t){this.moveTarget&&this.moveTarget.setPosition(this.posAnim)},r.updateCollider=function(t){},r.onCheckColliderCb=function(t){var i=h[this.trapType];for(var e in t)for(var n=t[e],o=0;o<n.length;o++){var r=n[o],s=m.getColilderByColId(r).targetCmp;if(s)s.byHit(i.atk)}},i}(g)).prototype,"trapType",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return f.TrapType.Spininess}}),w=i(b.prototype,"moveTarget",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=b))||T));r._RF.pop()}}}));

System.register("chunks:///_virtual/TrailLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventTypes.ts","./ColorLog.ts","./GlobalPool.ts","./BasicLayer.ts","./TrailMesh.ts"],(function(e){"use strict";var t,s,i,r,a,n,o,l;return{setters:[function(e){t=e.inheritsLoose},function(e){s=e.cclegacy,i=e._decorator},function(e){r=e.EventTypes},function(e){a=e.clog},function(e){n=e.default},function(e){o=e.BasicLayer},function(e){l=e.TrailMesh}],execute:function(){var c;s._RF.push({},"b63cevQVDFOg6uDStOAq6LH","TrailLayer",void 0);var h=i.ccclass;i.property,e("TrailLayer",h("TrailLayer")(c=function(e){function s(){for(var t,s=arguments.length,i=new Array(s),r=0;r<s;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).meshRecs={},t.trailCfg={0:{trailLen:3,scale:.7,spd:.1,name:" "}},t}t(s,e);var i=s.prototype;return i.init=function(){},i.onEvents=function(){this.on(r.EffectEvents.ShowTrail,this.onShowTrail,this),this.on(r.EffectEvents.HideTrail,this.onHideTrail,this)},i.setData=function(e){},i.reset=function(){n.putAllChildren(this.node),this.meshRecs={}},i.customUpdate=function(e){for(var t in this.meshRecs)for(var s=this.meshRecs[t],i=0;i<s.length;i++){var r=s[i];r&&r.node.active&&r.customUpdate(e)}},i.customLateUpdate=function(e){},i.createTrailMesh=function(e){this.meshRecs[e]||(this.meshRecs[e]=[]);var t=this.trailCfg[e],s={mergeNum:Math.floor(l.MAX_PARAM_LEN/t.trailLen),trailLen:t.trailLen,scale:t.scale},i=n.get("trailMergeMesh",s);i.parent=this.node;var r=i.getComponent(l);return this.meshRecs[e].push(r),a.warn("#TrailMesh:"+Object.keys(this.meshRecs).length),r},i.onShowTrail=function(e){var t=null;if(this.meshRecs[e.trailType])for(var s=this.meshRecs[e.trailType],i=0;i<s.length;i++){var r=s[i];if(r&&!r.isFull){t=r,r.node.active=!0;break}}t||(t=this.createTrailMesh(e.trailType));var a=this.trailCfg[e.trailType].spd;t.showTrail(e.followPos,e.colorType,a)},i.onHideTrail=function(e){if(this.meshRecs[e.trailType])for(var t=this.meshRecs[e.trailType],s=0;s<t.length;s++){var i=t[s];for(var r in i.trailRecs){var a=i.trailRecs[r];if(a.followPos==e.followPos){a.setReuse();break}}}},s}(o))||c);s._RF.pop()}}}));

System.register("chunks:///_virtual/TrailMesh.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BasicComponet.ts","./TrailRec.ts"],(function(t){"use strict";var s,i,r,a,n,e,o,h,u,l,c,f,m;return{setters:[function(t){s=t.applyDecoratedDescriptor,i=t.inheritsLoose,r=t.initializerDefineProperty,a=t.assertThisInitialized},function(t){n=t.cclegacy,e=t._decorator,o=t.MeshRenderer,h=t.v3,u=t.gfx,l=t.utils,c=t.v4},function(t){f=t.BasicComponet},function(t){m=t.TrailRec}],execute:function(){var p,T,v,y,d,R;n._RF.push({},"b9b787NPElOeKGPiGEYzbyk","TrailMesh",void 0);var D=e.ccclass,M=e.property;e.executeInEditMode,t("TrailMesh",(p=D("TrailMesh"),T=M(o),p(((R=function(t){function s(){for(var s,i=arguments.length,n=new Array(i),e=0;e<i;e++)n[e]=arguments[e];return(s=t.call.apply(t,[this].concat(n))||this).mergeNum=20,s.trailLen=3,r(s,"msr",d,a(s)),s.meshData=null,s.trailRecs={},s.isFull=!1,s.useCount=0,s.bs=h(1,1,1),s.scale=1,s.pass=null,s.uniformTrans=void 0,s.handleTrans=0,s.transDirty=!1,s.handleRotate=0,s.uniformRotate=void 0,s.rotateDirty=!1,s}i(s,t);var n=s.prototype;return n.onEnable=function(){},n.initSub=function(){this.initMats()},n.onEvents=function(){},n.resetSub=function(){this.trailRecs={},this.useCount=0,this.isFull=!1,this.resetTrailRecs(),this.resetMat()},n.setData=function(t){this.mergeNum=t.mergeNum,this.trailLen=t.trailLen,this.scale=t.scale,this.createMesh()},n.customUpdate=function(t){this.updateTrail(t),this.updateMat(t)},n.resetTrailRecs=function(){for(var t in this.trailRecs){this.trailRecs[t].reset()}},n.updateTrail=function(t){for(var s in this.trailRecs){var i=this.trailRecs[s];if(i.isUsed){i.update(t);for(var r=0;r<i.posLen;r++){var a=i.posArr[r],n=r+i.trailId*i.posLen;this.setTrailAllParams(n,a.x,1,a.z,i.rotArr[r].x)}}}},n.showTrail=function(t,s,i){var r=null;for(var a in this.trailRecs){var n=this.trailRecs[a];if(!n.isUsed){r=n;break}}r.setActive(s,t,i),this.useCount++,this.useCount>=this.mergeNum&&(this.isFull=!0)},n.onUnuseTrail=function(t){this.useCount--,this.isFull=!1;for(var s=0;s<t.posLen;s++){var i=t.posArr[s],r=s+t.trailId*t.posLen;this.setTrailAllParams(r,i.x,0,i.z,t.rotArr[s].x)}},n.createMesh=function(){var t=this;this.meshData={positions:[],normals:[],uvs:[],indices:[],customAttributes:[{attr:{name:"a_animData",format:u.Format.RGBA32F,isNormalized:!1,stream:0,isInstanced:!1,location:0,customOffset:0},values:[]}]};h();for(var s=this.node.worldPosition,i=0,r=0;r<this.mergeNum;r++){i=r*(this.trailLen+1),this.createMeshData(i,this.meshData,s,this.trailLen);var a=new m(r,this.trailLen,this);this.trailRecs[r]=a}setTimeout((function(){t.msr.mesh=l.createMesh(t.meshData)}),0)},n.createMeshData=function(t,s,i,r){for(var a=.5*this.bs.x*this.scale,n=i.x,e=i.y,o=i.z,h=1/r,u=0;u<r;u++){var l=s.positions.length/3,c=0*u+o;s.positions.push(n-a,e,c-0,n+a,e,c-0,n+a,e,c+0,n-a,e,c+0),s.normals.push(0,1,0,0,1,0,0,1,0,0,1,0),s.uvs.push(0,h*u,1,h*u,1,h*(u+1),0,h*(u+1)),s.indices.push(l+0,l+3,l+2,l+2,l+1,l+0);var f=t+u,m=.5;s.customAttributes[0].values.push(f,m,0,0,f,m,0,0,f+1,m,0,0,f+1,m,0,0)}},n.initMats=function(){var t=this.msr.getMaterialInstance(0);this.pass=t.passes[0],this.handleTrans=this.pass.getHandle("transData"),this.uniformTrans=[],this.uniformRotate=[];for(var i=s.MAX_PARAM_LEN,r=0;r<i;r++)this.uniformTrans.push(c(0,0,0,0));this.transDirty=!0,this.applyTrans(),this.rotateDirty=!0,this.applyRotate()},n.resetMat=function(){for(var t=0;t<this.uniformTrans.length;t++)this.uniformTrans[t].set(0,0,0,0);this.transDirty=!0,this.applyTrans(),this.rotateDirty=!0,this.applyRotate()},n.updateMat=function(t){this.applyTrans()},n.setTrailAllParams=function(t,s,i,r,a){!this.uniformTrans[t]||this.uniformTrans[t].x==s&&this.uniformTrans[t].y==i&&this.uniformTrans[t].z==r&&this.uniformTrans[t].w==a||(this.uniformTrans[t].x=s,this.uniformTrans[t].y=i,this.uniformTrans[t].z=r,this.uniformTrans[t].w=a,this.transDirty=!0)},n.setTrailPos=function(t,s,i){!this.uniformTrans[t]||this.uniformTrans[t].x==s&&this.uniformTrans[t].z==i||(this.uniformTrans[t].x=s,this.uniformTrans[t].z=i,this.transDirty=!0)},n.setTrailScale=function(t,s){this.uniformTrans[t]&&this.uniformTrans[t].w!=s&&(this.uniformTrans[t].w=s,this.transDirty=!0)},n.setTrailColor=function(t,s){this.uniformTrans[t]&&this.uniformTrans[t].y!=s&&(this.uniformTrans[t].y=s,this.transDirty=!0)},n.setTrailRotate=function(t,s){this.uniformTrans[t]&&this.uniformTrans[t].w!=s&&(this.uniformTrans[t].w=s,this.rotateDirty=!0)},n.applyTrans=function(){this.transDirty&&(this.pass&&this.pass.setUniformArray(this.handleTrans,this.uniformTrans),this.transDirty=!1)},n.applyRotate=function(){},s}(f)).MAX_PARAM_LEN=210,d=s((y=R).prototype,"msr",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=y))||v));n._RF.pop()}}}));

System.register("chunks:///_virtual/TrailRec.ts",["cc"],(function(s){"use strict";var t,i,r,o,h;return{setters:[function(s){t=s.cclegacy,i=s.Vec3,r=s.Vec4,o=s.v3,h=s.v4}],execute:function(){t._RF.push({},"6f361RB5+xIOI3hF4VzOc6q","TrailRec",void 0);s("TrailRec",function(){function s(s,t,i){this.trailId=0,this.colorType=0,this.posLen=0,this.posArr=[],this.rotArr=[],this.spd=.1,this.followPos=null,this.isUsed=!1,this.msCmp=null,this.tmpPos=o(),this.subPos=o(),this.curDirec=o(),this.msCmp=i,this.posLen=t+1;for(var r=0;r<this.posLen;r++)this.posArr.push(o()),this.rotArr.push(h());this.trailId=s}var t=s.prototype;return t.reset=function(){this.isUsed=!1,this.followPos=null;for(var s=0;s<this.posArr.length;s++){this.posArr[s].set(i.ZERO)}for(var t=0;t<this.rotArr.length;t++){this.rotArr[t].set(r.ZERO)}this.colorType=0},t.setActive=function(s,t,i){void 0!==i&&i>0&&(this.spd=i),this.colorType=s||0,this.isUsed=!0,this.followPos=t;for(var r=0;r<this.posLen;r++)this.posArr[r].set(t),this.rotArr[r].set(0)},t.setReuse=function(){this.reset(),this.msCmp.onUnuseTrail(this)},t.update=function(s){if(this.isUsed)if(this.followPos.y<0)this.setReuse();else{this.tmpPos.set(this.followPos);for(var t=0;t<this.posArr.length;t++){var r=this.posArr[t];0==t?(r.set(this.tmpPos),i.subtract(this.subPos,this.posArr[t+1],this.posArr[t])):(r.lerp(this.tmpPos,this.spd),this.posArr[t+1]?i.subtract(this.subPos,this.posArr[t+1],this.posArr[t-1]):i.subtract(this.subPos,this.posArr[t],this.posArr[t-1])),this.rotArr[t].x=Math.atan2(this.subPos.y,this.subPos.x)-1.57,this.tmpPos.set(r)}}},s}());t._RF.pop()}}}));

System.register("chunks:///_virtual/UpperAirNail.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalConfig.ts","./GlobalEnum.ts","./BasicCollider.ts","./CollisionManager.ts","./BasicProp.ts"],(function(i){"use strict";var t,e,s,r,n,o,l,a,c,h,p,u,d,m,f,g;return{setters:[function(i){t=i.applyDecoratedDescriptor,e=i.inheritsLoose,s=i.initializerDefineProperty,r=i.assertThisInitialized},function(i){n=i.cclegacy,o=i._decorator,l=i.Enum,a=i.Node,c=i.v3},function(i){h=i.TrapCfg},function(i){p=i.GlobalEnum},function(i){u=i.BasicCollider},function(i){d=i.ColliderGroup,m=i.CollisionTools,f=i.CollisionManager},function(i){g=i.BasicProp}],execute:function(){var v,y,T,P,_,C,A,R,b;n._RF.push({},"6b893MLqTFILICjNMZKaKEw","UpperAirNail",void 0);var B=o.ccclass,k=o.property;i("UpperAirNail",(v=B("UpperAirNail"),y=k({type:l(p.TrapType)}),T=k(a),P=k(a),v((A=t((C=function(i){function t(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=i.call.apply(i,[this].concat(n))||this).cldGroup=d.PlayerTrigger,s(t,"trapType",A,r(t)),s(t,"moveTargets",R,r(t)),s(t,"pushBtn",b,r(t)),t.initPosArr=null,t._isAnimFinish=!1,t._animRecs=null,t._gravity=-10,t._animTime=0,t.tmpP=c(),t.isTriggerUsed=!1,t.radius=1.2,t.checkGroup=[d.Enemy],t.checkRes=void 0,t}e(t,i);var n=t.prototype;return n.initSub=function(){this.initAnim()},n.setData=function(t){i.prototype.setData.call(this,t)},n.reset=function(){this.resetAnim(),i.prototype.reset.call(this)},n.customUpdate=function(t){i.prototype.customUpdate.call(this,t),this.updateAnim(t)},n.initAnim=function(){this.pushBtn.setPosition(0,.2,0),this.initPosArr=[];for(var i=0;i<this.moveTargets.children.length;i++){var t=this.moveTargets.children[i];this.initPosArr.push(c(t.position))}},n.showAnim=function(){this.pushBtn.setPosition(0,0,0),this._isAnimFinish=!1,this._animTime=0,this._animRecs=[];for(var i=0;i<this.moveTargets.children.length;i++){var t=this.moveTargets.children[i];this._animRecs.push({node:t,p:c(this.initPosArr[i]),v:c(0,-3,0),delay:.1})}},n.resetAnim=function(){for(var i=0;i<this.initPosArr.length;i++){var t=this.initPosArr[i];this.moveTargets.children[i].setPosition(t)}if(this._animRecs)for(var e=0;e<this._animRecs.length;e++){var s=this._animRecs[e];s.node=null,s.p=null,s.v=null}this._animRecs=null,this.pushBtn.setPosition(0,.2,0),this._animTime=0},n.updateAnim=function(i){if(this._animRecs){this._animTime+=i;for(var t=this._animRecs.length-1;t>=0;t--){var e=this._animRecs[t];this._animTime>=e.delay&&(e.v.y+=this._gravity*i,this.tmpP.set(e.v).multiplyScalar(i),e.p.add(this.tmpP),e.node.setPosition(e.p),e.p.y<=.1&&(e.p.y=.1,e.node.setPosition(e.p),this.checkColByPos(e.node.worldPosition),this._animRecs.splice(t,1)))}}},n.setCollider=function(){this.pos.set(this.pushBtn.worldPosition),this.collider=new u(this.cldGroup,this,!0),this.collider.setRectSize(this.cldSize),this.collider.setRectPos(this.pos),this.collider.updateGridInfo(!0),this.collider.isCircleCollider=this.isCircleCollider},n.resetCollider=function(){i.prototype.resetCollider.call(this),this.isTriggerUsed=!1},n.checkCollistion=function(){this.isTriggerUsed||this.collider&&this.collider.checkPosFast(this.pos,this.onTriggerEnter.bind(this))},n.onTriggerEnter=function(){this.isTriggerUsed=!0,this.showAnim()},n.checkColByPos=function(i){if(this.checkRes={},m.getCollInfoByPos(i,this.radius,this.checkRes,this.checkGroup)){var t=h[this.trapType],e=this.radius*this.radius;for(var s in this.checkRes)for(var r=this.checkRes[s],n=0;n<r.length;n++){var o=r[n],l=f.getColilderByColId(o).targetCmp;l&&this.tmpP.set(i).subtract(l.curPos).lengthSqr()<=e&&l.byHit(t.atk)}}},t}(g)).prototype,"trapType",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return p.TrapType.ElectricSaw}}),R=t(C.prototype,"moveTargets",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=t(C.prototype,"pushBtn",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=C))||_));n._RF.pop()}}}));

System.register("chunks:///_virtual/WeaponProp.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalConfig.ts","./GlobalEnum.ts","./GlobalTmpData.ts","./EventManager.ts","./EventTypes.ts","./GlobalPool.ts","./CollisionManager.ts","./BasicProp.ts","./ModifyPosRotMesh.ts"],(function(t){"use strict";var e,i,n,o,s,r,a,p,c,l,u,h,f,d,y,g,T,P;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,n=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){s=t.cclegacy,r=t._decorator,a=t.Enum,p=t.v3},function(t){c=t.GlobalConfig,l=t.WeaponCfg},function(t){u=t.GlobalEnum},function(t){h=t.GlobalTmpData},function(t){f=t.default},function(t){d=t.EventTypes},function(t){y=t.default},function(t){g=t.ColliderGroup},function(t){T=t.BasicProp},function(t){P=t.ModifyPosRotMesh}],execute:function(){var w,m,v,E,b;s._RF.push({},"c5b0cvG9rpFlbLn0L33XU5H","WeaponProp",void 0);var C=r.ccclass,D=r.property;t("WeaponProp",(w=C("WeaponProp"),m=D({type:a(u.TrapType)}),w((b=e((E=function(t){function e(){for(var e,i=arguments.length,s=new Array(i),r=0;r<i;r++)s[r]=arguments[r];return(e=t.call.apply(t,[this].concat(s))||this).cldGroup=g.PlayerTrigger,n(e,"trapType",b,o(e)),e.effect=null,e.curPos=p(),e.rot=p(),e.curScale=1,e.weaponType=0,e.weaponId=-1,e.weapon=null,e.tmpR=p(),e.isTriggerUsed=!1,e.tmpP=p(),e.checkRadius=c.Player.checkRadius,e}i(e,t);var s=e.prototype;return s.initSub=function(){this.initAnim()},s.onEvents=function(){this.on(d.CurLevelEvents.HideWeaponProp,this.onHideWeaponProp,this)},s.setData=function(t){this.curPos.set(t.p),t.r.getEulerAngles(this.rot),this.weaponType=t.d.weaponType,this.weaponId=t.d.weaponId,this.node.parent=t.parent,this.node.setPosition(t.p),this.node.eulerAngles=this.rot,this.setCollider(),this.weapon&&y.put(this.weapon.node);var e=y.get(u.WeaponType[this.weaponType]);e.parent=t.parent,this.weapon=e.getComponent(P),this.curScale=l[this.weaponType].propScale,this.setTransData(),this.effect||(this.effect=y.get("Effect_IS_buff_prop_001"),this.effect.setPosition(p(0,.1,0)),this.effect.setParent(this.node))},s.reset=function(){this.weapon&&y.put(this.weapon.node),this.weapon=null,this.resetAnim(),t.prototype.reset.call(this)},s.customUpdate=function(e){t.prototype.customUpdate.call(this,e),this.updateAnim(e),this.setTransData()},s.setTransData=function(){this.tmpR.set(this.rot).multiplyScalar(.01745),this.curPos.y=.5,this.weapon&&this.weapon.setTransData(this.curPos,this.tmpR,this.curScale)},s.initAnim=function(){},s.resetAnim=function(){},s.updateAnim=function(t){this.rot.y+=-180*t,this.isTriggerUsed&&y.put(this.node)},s.onHideWeaponProp=function(t){this.weaponId!=t||this.isTriggerUsed||(this.isTriggerUsed=!0)},s.setCollider=function(){},s.resetCollider=function(){t.prototype.resetCollider.call(this),this.isTriggerUsed=!1},s.checkCollistion=function(){this.isTriggerUsed||this.tmpP.set(h.Player.wpos).add(h.Player.offset).subtract(this.curPos).lengthSqr()<this.checkRadius*this.checkRadius&&this.onTriggerEnter()},s.onTriggerEnter=function(){switch(this.isTriggerUsed=!0,this.weaponType){case u.WeaponType.Drone:this.emit(d.CurLevelEvents.CreateDrones);break;default:this.emit(d.RoleEvents.SetWeapon,this.weaponType)}f.emit(d.CurLevelEvents.HideWeaponProp,this.weaponId);var t=p(h.Player.wpos).add(h.Player.offset);f.emit(d.EffectEvents.showParticleEffect,u.Effect3dType.Effect_IS_buff_get_001,{p:t})},e}(T)).prototype,"trapType",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return u.TrapType.ElectricSaw}}),v=E))||v));s._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/Game', 'chunks:///_virtual/Game'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});